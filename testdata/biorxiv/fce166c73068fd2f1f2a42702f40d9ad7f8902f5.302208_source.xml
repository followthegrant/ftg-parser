<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/302208</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;302208v3</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;302208</article-id><article-id pub-id-type="other" hwp:sub-type="slug">302208</article-id><article-id pub-id-type="other" hwp:sub-type="atom-slug">302208</article-id><article-id pub-id-type="other" hwp:sub-type="tag">302208</article-id><article-version>1.3</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Bioinformatics" hwp:journal="biorxiv"><subject>Bioinformatics</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">Sparse reduced-rank regression for exploratory visualization of paired multivariate datasets</article-title></title-group><author-notes hwp:id="author-notes-1"><corresp id="cor1" hwp:id="corresp-1" hwp:rev-id="xref-corresp-1-1"><label>✉</label><email hwp:id="email-1">dmitry.kobak@uni-tuebingen.de</email></corresp></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" corresp="yes" hwp:id="contrib-1"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-5639-7209</contrib-id><name name-style="western" hwp:sortable="Kobak Dmitry"><surname>Kobak</surname><given-names>Dmitry</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">1</xref><xref ref-type="corresp" rid="cor1" hwp:id="xref-corresp-1-1" hwp:rel-id="corresp-1">✉</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0002-5639-7209"/></contrib><contrib contrib-type="author" hwp:id="contrib-2"><name name-style="western" hwp:sortable="Bernaerts Yves"><surname>Bernaerts</surname><given-names>Yves</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-1" hwp:rel-id="aff-2">2</xref></contrib><contrib contrib-type="author" hwp:id="contrib-3"><name name-style="western" hwp:sortable="Weis Marissa A."><surname>Weis</surname><given-names>Marissa A.</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-3" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-4"><name name-style="western" hwp:sortable="Scala Federico"><surname>Scala</surname><given-names>Federico</given-names></name><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-1" hwp:rel-id="aff-3">3</xref></contrib><contrib contrib-type="author" hwp:id="contrib-5"><name name-style="western" hwp:sortable="Tolias Andreas"><surname>Tolias</surname><given-names>Andreas</given-names></name><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-2" hwp:rel-id="aff-3">3</xref></contrib><contrib contrib-type="author" hwp:id="contrib-6"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-0199-4727</contrib-id><name name-style="western" hwp:sortable="Berens Philipp"><surname>Berens</surname><given-names>Philipp</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-4" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a4" hwp:id="xref-aff-4-1" hwp:rel-id="aff-4">4</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0002-0199-4727"/></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2 xref-aff-1-3 xref-aff-1-4"><label>1</label><institution hwp:id="institution-1">Institute for Ophthalmic Research, University of Tübingen</institution>, <country>Germany</country></aff><aff id="a2" hwp:id="aff-2" hwp:rev-id="xref-aff-2-1"><label>2</label><institution hwp:id="institution-2">International Max Planck Research School for Intelligent Systems</institution>, <country>Germany</country></aff><aff id="a3" hwp:id="aff-3" hwp:rev-id="xref-aff-3-1 xref-aff-3-2"><label>3</label><institution hwp:id="institution-3">Department of Neuroscience, Baylor College of Medicine</institution>, Houston, Texas, <country>USA</country></aff><aff id="a4" hwp:id="aff-4" hwp:rev-id="xref-aff-4-1"><label>4</label><institution hwp:id="institution-4">Department of Computer Science, University of Tübingen</institution>, <country>Germany</country></aff></contrib-group><pub-date pub-type="epub-original" date-type="pub" publication-format="electronic" hwp:start="2020"><year>2020</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2018-04-16T10:15:10-07:00">
    <day>16</day><month>4</month><year>2018</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2020-04-14T04:45:10-07:00">
    <day>14</day><month>4</month><year>2020</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2018-04-16T10:20:45-07:00">
    <day>16</day><month>4</month><year>2018</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2020-04-14T04:48:38-07:00">
    <day>14</day><month>4</month><year>2020</year>
  </pub-date><elocation-id>302208</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2018-04-16"><day>16</day><month>4</month><year>2018</year></date>
<date date-type="rev-recd" hwp:start="2020-04-14"><day>14</day><month>4</month><year>2020</year></date>
<date date-type="accepted" hwp:start="2020-04-14"><day>14</day><month>4</month><year>2020</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2020, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2020</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/" hwp:id="license-1"><p hwp:id="p-1">This pre-print is available under a Creative Commons License (Attribution-NonCommercial-NoDerivs 4.0 International), CC BY-NC-ND 4.0, as described at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://creativecommons.org/licenses/by-nc-nd/4.0/" ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/" hwp:id="ext-link-1">http://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link></p></license></permissions><self-uri xlink:href="302208.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2020/pdf/302208v3.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="302208.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2020/abstracts/302208v3/302208v3.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2020/fulltext/302208v3/302208v3.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><p hwp:id="p-2">In genomics, transcriptomics, and related biological fields (collectively known as <italic toggle="yes">omics</italic>), it is common to work with <italic toggle="yes">n</italic> ≪ <italic toggle="yes">p</italic> datasets with the dimensionality much larger than the sample size. In recent years, combinations of experimental techniques began to yield multiple sets of features for the same set of biological replicates. One example is Patch-seq, a method combining single-cell RNA sequencing with electrophysiological recordings from the same cells. Here we present a framework based on sparse reduced-rank regression for obtaining an interpretable visualization of the relationship between the transcriptomic and the electrophysiological data. We use an elastic net regularization penalty that yields sparse solutions and allows for an efficient computational implementation. Using several publicly available Patch-seq datasets, we show that sparse reduced-rank regression outperforms both sparse full-rank regression and non-sparse reduced-rank regression in terms of predictive performance, and can outperform existing methods for sparse partial least squares and sparse canonical correlation analysis in terms of out-of-sample correlations. We introduce a <italic toggle="yes">bibiplot</italic> visualization in order to display the dominant factors determining the relationship between transcriptomic and electrophysiological properties of neurons. We believe that sparse reduced-rank regression can provide a valuable tool for the exploration and visualization of paired multivariate datasets, including Patch-seq.</p></abstract><counts><page-count count="16"/></counts><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-1">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta><notes hwp:id="notes-1"><notes notes-type="competing-interest-statement" hwp:id="notes-2"><title hwp:id="title-2">Competing Interest Statement</title><p hwp:id="p-3">The authors have declared no competing interest.</p></notes></notes></front><body><sec id="s1" hwp:id="sec-1"><label>1</label><title hwp:id="title-3">Introduction</title><p hwp:id="p-4">Since the days of Ramón y Cajal, neuroscientists have classified neurons into cell types, which are often considered the fundamental building blocks of neural circuits (<xref ref-type="bibr" rid="c32" hwp:id="xref-ref-32-1" hwp:rel-id="ref-32">Masland, 2004</xref>). Classically, these types have been defined based on their electrophysiology or anatomy, but due to the recent rise of single-cell transcriptomics, a definition of cell types based on genetics is becoming increasingly popular (<xref ref-type="bibr" rid="c35" hwp:id="xref-ref-35-1" hwp:rel-id="ref-35">Poulin et al., 2016</xref>). For example, single-cell RNA sequencing has been used to establish a census of neurons in the retina (<xref ref-type="bibr" rid="c41" hwp:id="xref-ref-41-1" hwp:rel-id="ref-41">Shekhar et al., 2016</xref>; <xref ref-type="bibr" rid="c31" hwp:id="xref-ref-31-1" hwp:rel-id="ref-31">Macosko et al., 2015</xref>), the cortex (<xref ref-type="bibr" rid="c55" hwp:id="xref-ref-55-1" hwp:rel-id="ref-55">Zeisel et al., 2015</xref>; <xref ref-type="bibr" rid="c43" hwp:id="xref-ref-43-1" hwp:rel-id="ref-43">Tasic et al., 2016</xref>, <xref ref-type="bibr" rid="c44" hwp:id="xref-ref-44-1" hwp:rel-id="ref-44">2018</xref>), the whole brain (<xref ref-type="bibr" rid="c38" hwp:id="xref-ref-38-1" hwp:rel-id="ref-38">Saunders et al., 2018</xref>), and the entire nervous system (<xref ref-type="bibr" rid="c56" hwp:id="xref-ref-56-1" hwp:rel-id="ref-56">Zeisel et al., 2018</xref>) of mice. Despite this success, it has proven difficult to integrate the obtained cell type taxonomy based on the transcriptome with information about physiology and anatomy (<xref ref-type="bibr" rid="c46" hwp:id="xref-ref-46-1" hwp:rel-id="ref-46">Tripathy et al., 2017</xref>; <xref ref-type="bibr" rid="c57" hwp:id="xref-ref-57-1" hwp:rel-id="ref-57">Zeng and Sanes, 2017</xref>) and it remains unclear to what extent neural types are discrete or show continuous variation (<xref ref-type="bibr" rid="c57" hwp:id="xref-ref-57-2" hwp:rel-id="ref-57">Zeng and Sanes, 2017</xref>; <xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-1" hwp:rel-id="ref-22">Harris et al., 2018</xref>).</p><p hwp:id="p-5">A recently developed technique called Patch-seq (<xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">Cadwell et al., 2016</xref>, <xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-1" hwp:rel-id="ref-3">2017</xref>; <xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">Fuzik et al., 2016</xref>; <xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">Földy et al., 2016</xref>) allows to isolate and sequence RNA content of cells characterized electrophysiologically and/or morphologically (<xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Figure 1a</xref>), opening the way to relate gene expression patterns to physiological characteristics on the single-cell level. Patch-seq experiments are laborious and low throughput, resulting in multimodal datasets with a particular statistical structure: a few dozen or hundreds of cells are characterized with expression levels of many thousands of genes as well as dozens of electrophysiological measurements (<xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-2" hwp:rel-id="F1">Figure 1a</xref>). Integrating and properly visualizing genetic and physiological information in this <italic toggle="yes">n</italic> ≪ <italic toggle="yes">p</italic> regime requires specialized statistical techniques that could isolate a subset of relevant genes and exploit information about the relationships within both data modalities to increase statistical power.</p><fig id="fig1" position="float" fig-type="figure" orientation="portrait" hwp:id="F1" hwp:rev-id="xref-fig-1-1 xref-fig-1-2 xref-fig-1-3 xref-fig-1-4 xref-fig-1-5 xref-fig-1-6 xref-fig-1-7 xref-fig-1-8 xref-fig-1-9 xref-fig-1-10"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;302208v3/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Figure 1:</label><caption hwp:id="caption-1"><p hwp:id="p-6"><bold>a.</bold> Schematic illustration of a Patch-seq experiment: electrophysiological activity is recorded by patchclamping, followed by RNA extraction and sequencing. Below: data matrices after computational characterization of electrophysiological properties (<bold>Y</bold>) and estimation of gene counts (<bold>X</bold>). <bold>b–e.</bold> Schematic illustrations and loss functions for several regression methods. <bold>b.</bold> Simple regression. <bold>c.</bold> Multivariate regression. <bold>d.</bold> Reduced-rank regression. <bold>e.</bold> Regularized reduced-rank regression. Gray circles denote predictors that are left out of the sparse model.</p></caption><graphic xlink:href="302208v3_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig><p hwp:id="p-7">Here we developed sparse reduced-rank regression based on the elastic net penalty to obtain an interpretable and intuitive visualization of the relationship between high-dimensional single-cell transcriptomes and electro-physiological information obtained using techniques like Patch-seq. We used four existing Patch-seq datasets (<xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-2" hwp:rel-id="ref-14">Fuzik et al., 2016</xref>; <xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-2" hwp:rel-id="ref-2">Cadwell et al., 2016</xref>; <xref ref-type="bibr" rid="c39" hwp:id="xref-ref-39-1" hwp:rel-id="ref-39">Scala et al., 2019</xref>, <xref ref-type="bibr" rid="c40" hwp:id="xref-ref-40-1" hwp:rel-id="ref-40">2020</xref>) with sample sizes ranging from <italic toggle="yes">n</italic> = 44 to <italic toggle="yes">n</italic> = 1213 to demonstrate and validate our method (<xref rid="tbl1" ref-type="table" hwp:id="xref-table-wrap-1-1" hwp:rel-id="T1">Table 1</xref>). Our sparse RRR method extends sparse RRR of <xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-1" hwp:rel-id="ref-5">Chen and Huang (2012)</xref> and, as we show, outperforms it on our data.</p><table-wrap id="tbl1" orientation="portrait" position="float" hwp:id="T1" hwp:rev-id="xref-table-wrap-1-1 xref-table-wrap-1-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;302208v3/TBL1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T1</object-id><object-id pub-id-type="publisher-id">tbl1</object-id><label>Table 1:</label><caption hwp:id="caption-2"><p hwp:id="p-8">Patch-seq datasets used in this study. All recordings were done in the mouse neocortex.</p></caption><graphic xlink:href="302208v3_tbl1" position="float" orientation="portrait" hwp:id="graphic-2"/></table-wrap><p hwp:id="p-9">Our code in Python is available at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/berenslab/patch-seq-rrr" ext-link-type="uri" xlink:href="https://github.com/berenslab/patch-seq-rrr" hwp:id="ext-link-2">https://github.com/berenslab/patch-seq-rrr</ext-link>.</p></sec><sec id="s2" hwp:id="sec-2"><label>2</label><title hwp:id="title-4">Results</title><sec id="s2a" hwp:id="sec-3"><label>2.1</label><title hwp:id="title-5">Patch-seq data</title><p hwp:id="p-10">A Patch-seq experiment yields two paired data matrices (<xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-3" hwp:rel-id="F1">Figure 1a</xref>): an <italic toggle="yes">n × p</italic> matrix <bold>X</bold> containing expression levels of <italic toggle="yes">p</italic> genes for each of the <italic toggle="yes">n</italic> cells, and an <italic toggle="yes">n × q</italic> matrix <bold>Y</bold> containing <italic toggle="yes">q</italic> electrophysiological properties of the same <italic toggle="yes">n</italic> cells. We assume that both matrices are centered, i.e. column means have been subtracted.</p><p hwp:id="p-11">To illustrate the structure of such datasets and motivate the development of sparse RRR for exploratory visualization, we use principal component analysis (PCA) on the M1 dataset, one of the largest existing Patch-seq datasets (<xref ref-type="bibr" rid="c40" hwp:id="xref-ref-40-2" hwp:rel-id="ref-40">Scala et al., 2020</xref>). It contains <italic toggle="yes">n</italic> = 1213 neurons from the primary motor cortex of adult mice and spans all types of neurons, both excitatory and inhibitory (<xref rid="tbl1" ref-type="table" hwp:id="xref-table-wrap-1-2" hwp:rel-id="T1">Table 1</xref>). Each cell was described by <italic toggle="yes">q</italic> = 16 electrophysiological properties and we used the <italic toggle="yes">p</italic> = 1000 most variable genes that were selected in the original publication. Note that there are over 40 thousand coding and non-coding genes in the mouse genome that were detected in at least one cell in this particular data set. It is, however, a common practice to select a smaller set of genes for downstream analysis (<xref ref-type="bibr" rid="c29" hwp:id="xref-ref-29-1" hwp:rel-id="ref-29">Luecken and Theis, 2019</xref>), as most detected genes have low average expression, low variance, and are likely not informative. We log-transformed all gene counts and standardized the columns of <bold>X</bold> and <bold>Y</bold> matrices (see Methods).</p><p hwp:id="p-12">PCA in the transcriptomic space (<xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-1" hwp:rel-id="F2">Figure 2a</xref>) revealed that PC1, in this case, was an experimental artefact largely driven by the variability in the sequencing quality between cells (correlation between PC1 and the log number of detected genes was 0.90), whereas PC2 captured a biologically meaningful difference between the excitatory and the inhibitory cells. In contrast, PCA in the electrophysiological space (<xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-2" hwp:rel-id="F2">Figure 2b</xref>) separated major classes of neurons with different firing properties, such as <italic toggle="yes">Pvalb</italic>- (red), <italic toggle="yes">Sst</italic>- (orange), or <italic toggle="yes">Vip</italic>- (purple) expressing interneurons. Thus, there appears to be no direct relationship between the leading PCs of the two modalities. The aim of reduced-rank regression is to uncover such relationships.</p><fig id="fig2" position="float" fig-type="figure" orientation="portrait" hwp:id="F2" hwp:rev-id="xref-fig-2-1 xref-fig-2-2 xref-fig-2-3 xref-fig-2-4 xref-fig-2-5 xref-fig-2-6 xref-fig-2-7"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;302208v3/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Figure 2:</label><caption hwp:id="caption-3"><p hwp:id="p-13"><bold>a.</bold> Principal component analysis (PCA) of the transcriptomic data in the M1 dataset (<xref ref-type="bibr" rid="c40" hwp:id="xref-ref-40-3" hwp:rel-id="ref-40">Scala et al., 2020</xref>). Color denotes transcriptomic type(cold colors: excitatory neurons; warm colors: inhibitory neurons). Both PCs were standardized. <bold>b.</bold> PCA biplot of the electrophysiological data in the same dataset. Grey lines show correlations of individual electrophysiological features with PC1 and PC2. The circle (<italic toggle="yes">correlation circle</italic>) shows maximal possible correlations. The relative scaling of the scatter plot and the lines/circle is arbitrary. The label positions were automatically adjusted by simulating spring repulsive forces between them until they stopped overlapping.</p></caption><graphic xlink:href="302208v3_fig2" position="float" orientation="portrait" hwp:id="graphic-3"/></fig><p hwp:id="p-14">The visualisation in <xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-3" hwp:rel-id="F2">Figure 2b</xref> is known as <italic toggle="yes">biplot</italic> (<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">Gabriel, 1971</xref>). Lines represent correlations between each electrophysiological property and PC1/PC2: the horizontal coordinate of each line’s tip shows the correlation with PC1 and the vertical coordinate shows the correlation with PC2. The circle, sometimes called <italic toggle="yes">correlation circle</italic>, shows the maximum attainable correlation. The scaling between the scatter plot and the lines/circle is arbitrary. Following <xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-2" hwp:rel-id="ref-15">Gabriel (1971)</xref>, we standardize both PCs and scale the lines/circle by an arbitrary factor of 3 (so that most points in the scatter plot are contained within the circle). We do not show a biplot in the transcriptomic space (<xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-4" hwp:rel-id="F2">Figure 2a</xref>) because the PCA in the gene space is not sparse, making the biplot practically impossible to display and interpret as it would have to show all 1000 genes from <bold>X</bold>. This motivates the sparsity constraint that we impose on RRR.</p></sec><sec id="s2b" hwp:id="sec-4"><label>2.2</label><title hwp:id="title-6">Reduced-rank regression</title><p hwp:id="p-15">To relate gene expression patterns to electrophysiological properties, one could use the transcriptomic data to predict any given electrophysiological property, e.g. action potential threshold. This is a <italic toggle="yes">regression</italic> problem: each gene is a predictor and the action potential threshold is the response variable (<xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-4" hwp:rel-id="F1">Figure 1b</xref>). To predict multiple electrophysiological properties at the same time, one can combine individual regressions into a <italic toggle="yes">multivariate regression</italic> problem where the response is a multivariate vector (<xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-5" hwp:rel-id="F1">Figure 1c</xref>). The loss function of multivariate linear regression (known as ordinary least squares, OLS) is
<disp-formula id="eqn1" hwp:id="disp-formula-1">
<alternatives hwp:id="alternatives-1"><graphic xlink:href="302208v3_eqn1.gif" position="float" orientation="portrait" hwp:id="graphic-4"/></alternatives>
</disp-formula>
and its well-known solution is given by
<disp-formula id="eqn2" hwp:id="disp-formula-2">
<alternatives hwp:id="alternatives-2"><graphic xlink:href="302208v3_eqn2.gif" position="float" orientation="portrait" hwp:id="graphic-5"/></alternatives>
</disp-formula>
Here and below all matrix norms are Frobenius norms. The intercept is omitted because both <bold>X</bold> and <bold>Y</bold> are assumed to be centered.</p><p hwp:id="p-16">Different electrophysiological properties tend to be strongly correlated and so one can construct a more parsimonious model where gene expression is predicting <italic toggle="yes">r &lt; q</italic> latent factors that in turn predict all <italic toggle="yes">q</italic> electro-physiological properties together (<xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-6" hwp:rel-id="F1">Figure 1d</xref>). These latent factors form a bottleneck in the linear mapping and allow exploiting correlations between the predicted elecrophysiological properties to increase statistical power and decrease overfitting. This approach is called <italic toggle="yes">reduced-rank regression</italic> (RRR) (<xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-1" hwp:rel-id="ref-23">Izenman, 1975</xref>; <xref ref-type="bibr" rid="c47" hwp:id="xref-ref-47-1" hwp:rel-id="ref-47">Velu and Reinsel, 2013</xref>). Its loss function is
<disp-formula id="eqn3" hwp:id="disp-formula-3">
<alternatives hwp:id="alternatives-3"><graphic xlink:href="302208v3_eqn3.gif" position="float" orientation="portrait" hwp:id="graphic-6"/></alternatives>
</disp-formula>
where <bold>W</bold> and <bold>V</bold> each have <italic toggle="yes">r</italic> ≤ min(<italic toggle="yes">p, q</italic>) columns. Without loss of generality it is convenient to require that <bold>V</bold><sup>⊤</sup><bold>V</bold> = <bold>I</bold>. The product <bold>WV</bold><sup>⊤</sup> forms the matrix of regression coefficients that has rank <italic toggle="yes">r</italic>.</p><p hwp:id="p-17">This decomposition allows to interpret <bold>W</bold> as a mapping that transforms <bold>X</bold> into <italic toggle="yes">r</italic> latent variables and <bold>V</bold> as a mapping that transforms the latent variables into <bold>Y</bold> (<xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-7" hwp:rel-id="F1">Figure 1e</xref>). As a result, RRR can be viewed not only as a prediction method, but also as a dimensionality reduction method, allowing visualization and exploration of the paired dataset. Latent factors <bold>XW</bold> can be interpreted as capturing low-dimensional genetic variability that is predictive of electrophysiological variability, while <bold>YV</bold> can be interpreted as low-dimensional electrophysiological variability that can be predicted from the genetic variability.</p><p hwp:id="p-18">RRR can be directly solved by applying singular value decomposition (SVD) to the results of multivariate regression. Indeed, the RRR loss can be decomposed into the OLS loss and the low-rank loss:
<disp-formula id="eqn4" hwp:id="disp-formula-4">
<alternatives hwp:id="alternatives-4"><graphic xlink:href="302208v3_eqn4.gif" position="float" orientation="portrait" hwp:id="graphic-7"/></alternatives>
</disp-formula>
The first term corresponds to the variance of <bold>Y</bold> that is unexplainable by any linear model. The minimum of the second term can be obtained by computing the SVD of <inline-formula hwp:id="inline-formula-1"><alternatives hwp:id="alternatives-5"><inline-graphic xlink:href="302208v3_inline1.gif" hwp:id="inline-graphic-1"/></alternatives></inline-formula>. The right singular vectors corresponding to the <italic toggle="yes">r</italic> largest singular values give <inline-formula hwp:id="inline-formula-2"><alternatives hwp:id="alternatives-6"><inline-graphic xlink:href="302208v3_inline2.gif" hwp:id="inline-graphic-2"/></alternatives></inline-formula>, and <inline-formula hwp:id="inline-formula-3"><alternatives hwp:id="alternatives-7"><inline-graphic xlink:href="302208v3_inline3.gif" hwp:id="inline-graphic-3"/></alternatives></inline-formula>.</p><p hwp:id="p-19">Reduced-rank regression with the ridge penalty <italic toggle="yes">λ</italic> ∥<bold>WV</bold> ∥<sup>2</sup> = <italic toggle="yes">λ</italic> ∥<bold>W</bold>∥ <sup>2</sup> has the same analytic solution, but <inline-formula hwp:id="inline-formula-4"><alternatives hwp:id="alternatives-8"><inline-graphic xlink:href="302208v3_inline4.gif" hwp:id="inline-graphic-4"/></alternatives></inline-formula> should be replaced with <inline-formula hwp:id="inline-formula-5"><alternatives hwp:id="alternatives-9"><inline-graphic xlink:href="302208v3_inline5.gif" hwp:id="inline-graphic-5"/></alternatives></inline-formula>.</p></sec><sec id="s2c" hwp:id="sec-5"><label>2.3</label><title hwp:id="title-7">Reduced-rank regression with elastic net penalty</title><p hwp:id="p-20">As there are over 20 thousand genes in a mouse genome (with 1000–5000 typically retained for analysis) while the typical sample size <italic toggle="yes">n</italic> of a Patch-seq dataset is on the order of 100–1000, the regression problems discussed above are in the <italic toggle="yes">n &lt; p</italic> regime and need to be regularized. Here we use elastic net regularization, which combines <italic toggle="yes">ℓ</italic><sub>1</sub> (lasso) and <italic toggle="yes">ℓ</italic><sub>2</sub> (ridge) penalties (<xref ref-type="bibr" rid="c58" hwp:id="xref-ref-58-1" hwp:rel-id="ref-58">Zou and Hastie, 2005</xref>). Elastic net enforces sparsity and performs feature selection: only a small subset of genes are selected into the model while all other genes get zero regression coefficients (<xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-8" hwp:rel-id="F1">Figure 1e</xref>). Our elastic net RRR extends a previously suggested sparse RRR (<xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-2" hwp:rel-id="ref-5">Chen and Huang, 2012</xref>) that used the lasso penalty on its own. The elastic net penalty has well-known advantages compared to the pure lasso penalty, e.g. it allows to select more than <italic toggle="yes">n</italic> predictors and can outperform lasso when predictors are strongly correlated (<xref ref-type="bibr" rid="c58" hwp:id="xref-ref-58-2" hwp:rel-id="ref-58">Zou and Hastie, 2005</xref>).</p><p hwp:id="p-21">The loss function of our regularized RRR is:
<disp-formula id="eqn5" hwp:id="disp-formula-5" hwp:rev-id="xref-disp-formula-5-1">
<alternatives hwp:id="alternatives-10"><graphic xlink:href="302208v3_eqn5.gif" position="float" orientation="portrait" hwp:id="graphic-8"/></alternatives>
</disp-formula>
The <italic toggle="yes">ℓ</italic><sub>2</sub> penalty is only applied to the matrix <bold>W</bold> because <bold>V</bold> is constrained to have a fixed <italic toggle="yes">ℓ</italic><sub>2</sub> norm. Also, following <xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-3" hwp:rel-id="ref-5">Chen and Huang (2012)</xref> we chose not to apply <italic toggle="yes">ℓ</italic><sub>1</sub> penalty to <bold>V</bold> and impose sparsity constraint only on the gene selection (see Discussion). We used the same parametrization of the penalty as in the popular <monospace>glmnet</monospace> library (<xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">Friedman et al., 2010</xref>): <italic toggle="yes">α</italic> controls the trade-off between the lasso (<italic toggle="yes">α</italic> = 1) and the ridge (<italic toggle="yes">α</italic> = 0) while <italic toggle="yes">λ</italic> controls the overall regularization strength. Following <xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-4" hwp:rel-id="ref-5">Chen and Huang (2012)</xref>, the lasso penalty term <inline-formula hwp:id="inline-formula-6"><alternatives hwp:id="alternatives-11"><inline-graphic xlink:href="302208v3_inline6.gif" hwp:id="inline-graphic-6"/></alternatives></inline-formula> computes the sum of <italic toggle="yes">ℓ</italic><sub>2</sub> norms of each row of <bold>W</bold>. This is known as <italic toggle="yes">group lasso</italic> (<xref ref-type="bibr" rid="c54" hwp:id="xref-ref-54-1" hwp:rel-id="ref-54">Yuan and Lin, 2006</xref>), because it is the <italic toggle="yes">ℓ</italic><sub>1</sub> norm of the vector of row <italic toggle="yes">ℓ</italic><sub>2</sub> norms; it encourages the entire rows of <bold>W</bold>, and not just its individual elements, to be zeroed out, corresponding to some of the genes being left out of the model entirely. See Discussion about this choice.</p><p hwp:id="p-22">This optimization problem is biconvex and can be solved with an iterative alternating approach: in turn, we fix <bold>V</bold> and find the optimal <bold>W</bold><sub>opt</sub> and then fix <bold>W</bold> and find the optimal <bold>V</bold><sub>opt</sub> until convergence. For a fixed <bold>V</bold>, the least-squares term can be re-written as
<disp-formula id="eqn6" hwp:id="disp-formula-6">
<alternatives hwp:id="alternatives-12"><graphic xlink:href="302208v3_eqn6.gif" position="float" orientation="portrait" hwp:id="graphic-9"/></alternatives>
</disp-formula>
meaning that for a fixed <bold>V</bold>, the loss is equivalent to
<disp-formula id="eqn7" hwp:id="disp-formula-7" hwp:rev-id="xref-disp-formula-7-1">
<alternatives hwp:id="alternatives-13"><graphic xlink:href="302208v3_eqn7.gif" position="float" orientation="portrait" hwp:id="graphic-10"/></alternatives>
</disp-formula>
This is the loss of multivariate elastic net regression of <bold>YV</bold> on <bold>X</bold>, and so the optimal <bold>W</bold><sub>opt</sub> can be obtained using the <monospace>glmnet</monospace> library (<xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-2" hwp:rel-id="ref-13">Friedman et al., 2010</xref>) (using <monospace>family=“mgaussian”</monospace> option for row-wise lasso penalty) which has readily available interfaces for Matlab, Python, and R.</p><p hwp:id="p-23">For a fixed <bold>W</bold>, the loss does not depend on the penalty terms and the least-squares term can be written as
<disp-formula id="eqn8" hwp:id="disp-formula-8">
<alternatives hwp:id="alternatives-14"><graphic xlink:href="302208v3_eqn8.gif" position="float" orientation="portrait" hwp:id="graphic-11"/></alternatives>
</disp-formula>
This is an example of the orthogonal Procrustes problem (<xref ref-type="bibr" rid="c20" hwp:id="xref-ref-20-1" hwp:rel-id="ref-20">Gower and Dijksterhuis, 2004</xref>). Maximizing tr(<bold>Y</bold><sup>⊤</sup><bold>XWV</bold><sup>⊤</sup>) is achieved by the thin SVD of <bold>Y</bold><sup>⊤</sup><bold>XW</bold>. If the <italic toggle="yes">r</italic> left and right singular vectors are stacked in columns of <bold>L</bold> and <bold>R</bold> respectively (we order them by singular values, in decreasing order), then <bold>V</bold><sub>opt</sub> = <bold>LR</bold><sup>⊤</sup>. We provide a short proof in the Appendix.</p><p hwp:id="p-24">Given that the loss function is biconvex but possibly not jointly convex in <bold>V</bold> and <bold>W</bold>, it can be important to choose a reasonable initialization. We initialized <bold>V</bold> by the <italic toggle="yes">r</italic> leading right singular vectors of <bold>X</bold><sup>⊤</sup><bold>Y</bold> and found this strategy to work well.</p></sec><sec id="s2d" hwp:id="sec-6"><label>2.4</label><title hwp:id="title-8">Relaxed elastic net</title><p hwp:id="p-25">It has been argued that elastic net or even the lasso penalty on its own can lead to an over-shrinkage with non-zero coefficients shrinking too much (<xref ref-type="bibr" rid="c58" hwp:id="xref-ref-58-3" hwp:rel-id="ref-58">Zou and Hastie, 2005</xref>). There have been several suggestions in the literature on how to mitigate this effect (<xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">Efron et al., 2004</xref>; <xref ref-type="bibr" rid="c58" hwp:id="xref-ref-58-4" hwp:rel-id="ref-58">Zou and Hastie, 2005</xref>; <xref ref-type="bibr" rid="c33" hwp:id="xref-ref-33-1" hwp:rel-id="ref-33">Meinshausen, 2007</xref>). <italic toggle="yes">Relaxed lasso</italic> (<xref ref-type="bibr" rid="c33" hwp:id="xref-ref-33-2" hwp:rel-id="ref-33">Meinshausen, 2007</xref>) performs lasso (setting <italic toggle="yes">α</italic> = 1 and <italic toggle="yes">λ</italic> = <italic toggle="yes">λ</italic><sub>1</sub>) and then, using only the terms with non-zero coefficients, performs another lasso with a different penalty (<italic toggle="yes">α</italic> = 1, <italic toggle="yes">λ</italic> = <italic toggle="yes">λ</italic><sub>2</sub>; usually <italic toggle="yes">λ</italic><sub>2</sub> <italic toggle="yes">&lt; λ</italic><sub>1</sub>). If <italic toggle="yes">λ</italic><sub>2</sub> = 0, then this has also been called <italic toggle="yes">LARS-OLS hybrid</italic> (<xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-2" hwp:rel-id="ref-11">Efron et al., 2004</xref>).</p><p hwp:id="p-26">Similar two-stage procedures for the elastic net penalty are not as established. We obtained a strong improvement in predictive performance if — after RRR with elastic net penalty with coefficients <italic toggle="yes">λ</italic> and <italic toggle="yes">α</italic> — we take the genes with non-zero coefficients and run RRR again using <italic toggle="yes">α</italic> = 0 (i.e. pure ridge) and the same value of <italic toggle="yes">λ</italic>. This procedure does not introduce any additional tuning parameters but substantially outperforms pure elastic net RRR on our data, as we show below. We called it <italic toggle="yes">relaxed elastic net</italic>, following the relaxed lasso terminology (<xref ref-type="bibr" rid="c33" hwp:id="xref-ref-33-3" hwp:rel-id="ref-33">Meinshausen, 2007</xref>). The solution of the first round of sparse RRR we call <italic toggle="yes">naïve</italic>, following <xref ref-type="bibr" rid="c58" hwp:id="xref-ref-58-5" hwp:rel-id="ref-58">Zou and Hastie (2005)</xref>.</p><p hwp:id="p-27">A similar approach was used by <xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-1" hwp:rel-id="ref-10">De Mol et al. (2009)</xref> who performed elastic net using <italic toggle="yes">λ</italic> = <italic toggle="yes">λ</italic><sub>1</sub> and some small fixed value of <italic toggle="yes">α</italic> = <italic toggle="yes">α</italic><sub>1</sub>, selected all genes with non-zero coefficients, and did pure ridge (<italic toggle="yes">α</italic> = 0) regression with <italic toggle="yes">λ</italic> = <italic toggle="yes">λ</italic><sub>2</sub> on this gene subset. This approach also has two hyperparameters that need to be selected using cross-validation, but requires a manual choice of <italic toggle="yes">α</italic><sub>1</sub> for the first elastic net. If <italic toggle="yes">α</italic> is also treated as an adjustable hyperparameter, then it becomes a more flexible generalization of our approach with three hyperparameters.</p></sec><sec id="s2e" hwp:id="sec-7"><label>2.5</label><title hwp:id="title-9">Cross-validation</title><p hwp:id="p-28">We used cross-validation (CV) to select the values of <italic toggle="yes">r, λ</italic>, and <italic toggle="yes">α</italic> that maximize the predictive performance of the sparse RRR model. The cross-validation estimates of <italic toggle="yes">R</italic><sup>2</sup> are shown in <xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-1" hwp:rel-id="F3">Figure 3</xref> for the L1, L4, and M1 datasets. We used 10 times repeated 11-fold CV for the L1 data (<italic toggle="yes">n</italic> = 44), 10 times repeated 10-fold CV for the L4 data (<italic toggle="yes">n</italic> = 102), and non-repeated 10-fold CV for the M1 data (<italic toggle="yes">n</italic> = 1321). See Methods for the pre-processing details. The test-set <italic toggle="yes">R</italic><sup>2</sup> for each CV fold was computed as
<disp-formula id="eqn9" hwp:id="disp-formula-9">
<alternatives hwp:id="alternatives-15"><graphic xlink:href="302208v3_eqn9.gif" position="float" orientation="portrait" hwp:id="graphic-12"/></alternatives>
</disp-formula>
where <bold>X</bold><sub>test</sub> and <bold>Y</bold><sub>test</sub> were centered using the corresponding training-set means. We averaged the resulting <italic toggle="yes">R</italic><sup>2</sup> across all folds and repetitions.</p><fig id="fig3" position="float" fig-type="figure" orientation="portrait" hwp:id="F3" hwp:rev-id="xref-fig-3-1 xref-fig-3-2 xref-fig-3-3 xref-fig-3-4 xref-fig-3-5 xref-fig-3-6 xref-fig-3-7 xref-fig-3-8 xref-fig-3-9 xref-fig-3-10 xref-fig-3-11 xref-fig-3-12 xref-fig-3-13"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;302208v3/FIG3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F3</object-id><object-id pub-id-type="publisher-id">fig3</object-id><label>Figure 3:</label><caption hwp:id="caption-4"><p hwp:id="p-29"><bold>a.</bold> Cross-validation performance of sparse RRR with <italic toggle="yes">r</italic> = 2 on the L1 dataset, depending on <italic toggle="yes">α</italic> (color-coded, see legend) and <italic toggle="yes">λ</italic>. Horizontal axis shows the average number of selected genes obtained for each <italic toggle="yes">λ</italic>. Dashed lines: naive sparse RRR. Solid lines: relaxed sparse RRR. The vertical line at 20 selected genes indicates our parameter choice. Thick lines highlight <italic toggle="yes">α</italic> = 0.5. The standard deviation over all CV folds and repetitions at <italic toggle="yes">α</italic> = 0.5 and <italic toggle="yes">λ</italic> value yielding ∼20 genes was 0.05 for the naive and 0.12 for the relaxed estimator (note that each fold had only 4 samples in the test set). <bold>b.</bold> The same for the L4 dataset. The standard deviation over all CV folds and repetitions at <italic toggle="yes">α</italic> = 0.5 and <italic toggle="yes">λ</italic> value yielding ∼20 genes was 0.04 for the naive and 0.07 for the relaxed estimator (here each fold had only ∼10 samples in the test set). <bold>c.</bold> The same for the M1 dataset. Here thick lines highlight <italic toggle="yes">α</italic> = 1. The standard deviation over all CV folds and repetitions at <italic toggle="yes">α</italic> = 1 and <italic toggle="yes">λ</italic> value yielding ∼20 genes was 0.01 for the naive and for the relaxed estimators (here each fold had ∼120 samples in the test set). <bold>d.</bold> Cross-validation performance with <italic toggle="yes">α</italic> = 0.5 depending on the rank (color-coded, see legend) on the L1 dataset. Thick lines highlight <italic toggle="yes">r</italic> = 2. <bold>e.</bold> The same for the L4 dataset. <bold>f.</bold> The same for the M1 dataset (here using <italic toggle="yes">α</italic> = 1).</p></caption><graphic xlink:href="302208v3_fig3" position="float" orientation="portrait" hwp:id="graphic-13"/></fig><p hwp:id="p-30">When using rank <italic toggle="yes">r</italic> = 2 (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-2" hwp:rel-id="F3">Figure 3a–c</xref>), we found that <italic toggle="yes">α</italic> = 0.5 outperformed <italic toggle="yes">α</italic> = 1 on the L1 dataset, suggesting that adding an additional ridge penalty to the sparse RRR model of <xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-5" hwp:rel-id="ref-5">Chen and Huang (2012)</xref> can be helpful. At the same time, <italic toggle="yes">α</italic> = 0.5 and <italic toggle="yes">α</italic> = 1 performed equally well on the L4 dataset, while <italic toggle="yes">α</italic> = 1 outperformed other values on the M1 dataset. Overall, the differences in predictive performance in the <italic toggle="yes">α</italic> ∈ [0.5, 1] range were moderate. For the downstream analysis, we used <italic toggle="yes">α</italic> = 0.5 for the L4 and L1 datasets, and <italic toggle="yes">α</italic> = 1 for the M1 dataset. We recommend <italic toggle="yes">α</italic> = 0.5 as a default setting.</p><p hwp:id="p-31">The optimal <italic toggle="yes">λ</italic> corresponded to ∼30 selected genes for the L1 dataset, ∼15 selected genes for the L4 dataset, and ∼100 selected genes for the M1 dataset (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-3" hwp:rel-id="F3">Figure 3a–c</xref>), but the performance was comparably good in the range of ∼10–100 genes. For the downstream analysis, we always chose the value of <italic toggle="yes">λ</italic> yielding 20 selected genes. Selecting many more genes than that would make visualisation difficult (see below).</p><p hwp:id="p-32">The optimal value of rank was <italic toggle="yes">r</italic> = 2 for the L1 and L4 datasets and <italic toggle="yes">r</italic> ≈ 10 for the M1 dataset (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-4" hwp:rel-id="F3">Figure 3d–f</xref>). Lower ranks had worse performance due to under-fitting, whereas higher ranks led to a drop in performance due to over-fitting. Note that the full rank (<italic toggle="yes">r</italic> = 11, <italic toggle="yes">r</italic> = 13, and <italic toggle="yes">r</italic> = 16 for the L1, L4, and M1 datasets respectively) corresponds to the standard multivariate elastic net regression. We verified that our algorithm yields the same solution as <monospace>glmnet</monospace> does on its own. The much better performance of <italic toggle="yes">r</italic> = 2 compared to the full rank on the L1 and L4 datasets shows that <italic toggle="yes">r</italic> can act as a regularization parameter, making sparse reduced-rank regression outperform sparse full-rank regression. At the same time, for the M1 dataset, there was almost no difference in performance for any <italic toggle="yes">r</italic> ≥ 5 and the full-rank model performed almost as well, suggesting little overfitting due to the larger sample size. Still, even in this case, the RRR framework allows to order individual components by their importance (explained variance) and to make low-dimensional visualizations (see below).</p><p hwp:id="p-33">Finally, in both datasets the relaxed version of sparse RRR strongly outperformed the naive version, at least in the range of 10–50 selected genes, which is the range needed for visualizations (see below). If a high number of genes was selected into the model, the relaxed version performed worse than the naive version, suggesting that the second stage of our relaxed approach was overfitting. For the L1 dataset with the smallest sample size we observed non-monotonic dependency of the relaxed performance on the number of genes (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-5" hwp:rel-id="F3">Figure 3d</xref>), suggesting that the relaxed estimator can occupy different positions on the bias/variance trade-off depending on the <italic toggle="yes">λ</italic>. However, for the low number of selected genes the relaxed version had superior performance across all datasets, all ranks, and all values of <italic toggle="yes">α</italic>.</p><p hwp:id="p-34">Note that sparse RRR of <xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-6" hwp:rel-id="ref-5">Chen and Huang (2012)</xref> corresponds to the naive version with <italic toggle="yes">α</italic> = 1. In the regime when the model selects a few dozen genes, it was strongly outperformed by our relaxed sparse RRR estimator.</p></sec><sec id="s2f" hwp:id="sec-8"><label>2.6</label><title hwp:id="title-10">Bibiplot visualisation</title><p hwp:id="p-35">We applied our sparse RRR approach with <italic toggle="yes">r</italic> = 2 and <italic toggle="yes">λ</italic> chosen to yield 20 selected genes to the L1, L4, and M1 datasets (used <italic toggle="yes">α</italic> values: 0.5, 0.5, and 1.0 respectively). For each of the datasets, we visualized the results with a pair of biplots, a graphical technique that we suggest to call a <italic toggle="yes">bibiplot</italic>.</p><p hwp:id="p-36">To construct a biplot in the transcriptomic space, we use the bottleneck representation <bold>XW</bold> for the scatter plot, and show lines for all genes that are selected by the model (even though other genes can also have non-zero correlations with <bold>XW</bold>). The biplot in the electrophysiological space is constructed using <bold>YV</bold> and shows all available electrophysiological properties. If <italic toggle="yes">R</italic><sup>2</sup> of the model is high, then the two scatter plots will be similar to each other. Comparing the directions of variables between the two biplots can suggest which electrophysiological variables are associated with which genes.</p><p hwp:id="p-37">The L1 dataset encompasses two types of interneurons from layer 1 of mouse cortex: neurogliaform cells (NGC) and single bouqet cells (SBC). Accordingly, the first RRR component captured the difference between the two cell types (<xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-1" hwp:rel-id="F4">Figure 4a,d</xref>). The second RRR component had only one gene strongly associated with it (<xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-2" hwp:rel-id="F4">Figure 4a</xref>) and contributed only a very small increase in cross-validated <italic toggle="yes">R</italic><sup>2</sup>, as one can see comparing the cross-validation curves for <italic toggle="yes">r</italic> = 1 and <italic toggle="yes">r</italic> = 2 (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-6" hwp:rel-id="F3">Figure 3d</xref>). We conclude that the second RRR component in this dataset is only weakly detectable.</p><fig id="fig4" position="float" fig-type="figure" orientation="portrait" hwp:id="F4" hwp:rev-id="xref-fig-4-1 xref-fig-4-2 xref-fig-4-3 xref-fig-4-4 xref-fig-4-5"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;302208v3/FIG4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F4</object-id><object-id pub-id-type="publisher-id">fig4</object-id><label>Figure 4:</label><caption hwp:id="caption-5"><p hwp:id="p-38"><bold>a.</bold> Sparse RRR biplot of the transcriptomic space in the L1 dataset. Color codes cell type (orange: neurogliaform cells, NGC; green: single bouqet cells, SBC). Only 20 genes selected by the model are shown. See <xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-5" hwp:rel-id="F2">Figure 2b</xref> for the details of biplot visualization. As there, label positions were automatically adjusted to prevent overlap. <bold>b.</bold> The same for the L4 dataset. Color denotes cortical area (orange: visual cortex; red: somatosensory cortex). <bold>c.</bold> The same for the M1 dataset. Color denotes transcriptomic type (see <xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-6" hwp:rel-id="F2">Figure 2</xref>). <bold>d–f.</bold> The same in the electrophysiological spaces.</p></caption><graphic xlink:href="302208v3_fig4" position="float" orientation="portrait" hwp:id="graphic-14"/></fig><p hwp:id="p-39">In the L4 dataset (<xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-3" hwp:rel-id="F4">Figure 4b,e</xref>), the most salient feature in the bibiplot is the separation between the cells recorded in the visual and the somatosensory cortices. The selected genes here are pointing in all directions, and indeed the second component contributed a substantial increase in <italic toggle="yes">R</italic><sup>2</sup> (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-7" hwp:rel-id="F3">Figure 3e</xref>). This suggests that both components are biologically meaningful. See <xref ref-type="bibr" rid="c39" hwp:id="xref-ref-39-2" hwp:rel-id="ref-39">Scala et al. (2019)</xref> for a more in-depth analysis using sparse RRR.</p><p hwp:id="p-40">The M1 dataset was much larger than the other two and included a much more diverse selection of neuron types. As a result, the <italic toggle="yes">R</italic><sup>2</sup> values were substantially higher and the model needed to use rank <italic toggle="yes">r</italic> ≥ 5 to reach its optimal performance. Here we nevertheless used <italic toggle="yes">r</italic> = 2 because it allows the same kind of visualization as for the other datasets (<xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-4" hwp:rel-id="F4">Figure 4c,f</xref>). See <xref ref-type="bibr" rid="c40" hwp:id="xref-ref-40-4" hwp:rel-id="ref-40">Scala et al. (2020)</xref> for a more in-depth analysis using sparse RRR with rank <italic toggle="yes">r</italic> = 5. Two-dimensional bibiplot separated major classes of neurons, such as <italic toggle="yes">Pvalb, Sst, Vip</italic>, and <italic toggle="yes">Lamp5</italic> expressing interneurons (red/orange/purple/salmon), and excitatory cells (green). It is worth noting that the RRR biplot in the electrophysiological space (<xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-5" hwp:rel-id="F4">Figure 4f</xref>) was very similar to the PCA biplot (<xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-7" hwp:rel-id="F2">Figure 2b</xref>). This indicates that the sparse RRR model explained the dominant modes of variation among the dependent variables. We observed the same in other datasets analyzed here.</p></sec><sec id="s2g" hwp:id="sec-9"><label>2.7</label><title hwp:id="title-11">Comparison to sparse CCA and PLS</title><p hwp:id="p-41">Reduced-rank regression does not directly aim to maximize the correlation between <bold>Xw</bold> and <bold>Yv</bold>, where <bold>w</bold> and <bold>v</bold> are corresponding columns of <bold>W</bold> and <bold>V</bold>, even though high correlation is needed to achieve high <italic toggle="yes">R</italic><sup>2</sup>. Nevertheless, one can ask what is the cross-validated estimate of this correlation in each pair of RRR components. We used the same cross-validation scheme to measure these out-of-sample correlations (<xref rid="fig5" ref-type="fig" hwp:id="xref-fig-5-1" hwp:rel-id="F5">Figure 5</xref>)<sup><xref ref-type="fn" rid="fn1" hwp:id="xref-fn-1-1" hwp:rel-id="fn-1">1</xref></sup>. With the hyper-parameters used above, the correlations in the L1 dataset were 0.70 for component 1 and 0.37 for component 2 (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-8" hwp:rel-id="F3">Figure 3a</xref>). In the L4 dataset, they were 0.65 and 0.54, respectively (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-9" hwp:rel-id="F3">Figure 3b</xref>). In the M1 dataset, they were 0.89 and 0.73 (<xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-9" hwp:rel-id="F1">Figure 1c</xref>).</p><fig id="fig5" position="float" fig-type="figure" orientation="portrait" hwp:id="F5" hwp:rev-id="xref-fig-5-1 xref-fig-5-2 xref-fig-5-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;302208v3/FIG5</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F5</object-id><object-id pub-id-type="publisher-id">fig5</object-id><label>Figure 5:</label><caption hwp:id="caption-6"><p hwp:id="p-42"><bold>a.</bold> Cross-validation estimates of correlations between the transcriptomic and the electrophyiological RRR components with <italic toggle="yes">r</italic> = 2 in the L1 dataset, depending on <italic toggle="yes">λ</italic>. Horizontal axis shows the average number of selected genes obtained for each <italic toggle="yes">λ</italic>. Here we used <italic toggle="yes">α</italic> = 0.5. Solid blue line: RRR component 1. Dashed blue line: RRR component 2. Solid and dashed orange lines: sparse CCA method of <xref ref-type="bibr" rid="c52" hwp:id="xref-ref-52-1" hwp:rel-id="ref-52">Witten et al. (2009)</xref>, components 1 and 2. Green line: sparse CCA method of <xref ref-type="bibr" rid="c42" hwp:id="xref-ref-42-1" hwp:rel-id="ref-42">Suo et al. (2017)</xref>, component 1. <bold>b.</bold> The same for the L4 dataset. <bold>c.</bold> The same for the M1 dataset.</p></caption><graphic xlink:href="302208v3_fig5" position="float" orientation="portrait" hwp:id="graphic-15"/></fig><p hwp:id="p-43">A statistical method that directly maximizes correlation between <bold>Xw</bold> and <bold>Yv</bold> is called canonical correlation analysis (CCA). A number of different methods for sparse CCA have been suggested in the last decade (Waai-jenborg et al., 2008; <xref ref-type="bibr" rid="c49" hwp:id="xref-ref-49-1" hwp:rel-id="ref-49">Wiesel et al., 2008</xref>; <xref ref-type="bibr" rid="c34" hwp:id="xref-ref-34-1" hwp:rel-id="ref-34">Parkhomenko et al., 2009</xref>; <xref ref-type="bibr" rid="c52" hwp:id="xref-ref-52-2" hwp:rel-id="ref-52">Witten et al., 2009</xref>; <xref ref-type="bibr" rid="c51" hwp:id="xref-ref-51-1" hwp:rel-id="ref-51">Witten and Tibshirani, 2009</xref>; <xref ref-type="bibr" rid="c30" hwp:id="xref-ref-30-1" hwp:rel-id="ref-30">Lykou and Whittaker, 2010</xref>; <xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-1" hwp:rel-id="ref-21">Hardoon and Shawe-Taylor, 2011</xref>; <xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-1" hwp:rel-id="ref-6">Chen et al., 2012b</xref>; <xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">Chu et al., 2013</xref>; <xref ref-type="bibr" rid="c50" hwp:id="xref-ref-50-1" hwp:rel-id="ref-50">Wilms and Croux, 2015</xref>; <xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">Gao et al., 2017</xref>; <xref ref-type="bibr" rid="c42" hwp:id="xref-ref-42-2" hwp:rel-id="ref-42">Suo et al., 2017</xref>), of which the sparse CCA of <xref ref-type="bibr" rid="c52" hwp:id="xref-ref-52-3" hwp:rel-id="ref-52">Witten et al. (2009)</xref> is arguably the most well-known (judging by the number of citations in Google Scholar). We reimplemented the algorithm of Witten et al. in Python and used the cross-validation procedure described above to measure its out-of-sample performance (<xref rid="fig5" ref-type="fig" hwp:id="xref-fig-5-2" hwp:rel-id="F5">Figure 5</xref>, blue lines). We found that it performed noticeably worse than our sparse RRR: correlations for all three datasets and both components (the 1st and the 2nd) were similar or lower than with sparse RRR, at least in the regime of 10–50 selected genes. We also implemented the recently suggested sparse CCA algorithm of <xref ref-type="bibr" rid="c42" hwp:id="xref-ref-42-3" hwp:rel-id="ref-42">Suo et al. (2017)</xref> that directly builds up on the approach of Witten et al. We found that the sparse CCA of Suo et al. performed worse than the sparse CCA of Witten et al. in the L1 dataset but outperformed it in the M1 dataset, where its performance was similar to our sparse RRR (<xref rid="fig5" ref-type="fig" hwp:id="xref-fig-5-3" hwp:rel-id="F5">Figure 5</xref>, green lines).</p><p hwp:id="p-44">It remains beyond the scope of this paper to investigate why our sparse RRR is competitive with or even outperforms these sparse CCA methods in terms of out-of-sample correlations. A likely explanation is that these sparse CCA methods use regularization approaches that are suboptimal for our datasets. To understand this under-/over-regularization, note that RRR maximizes explained variance in <bold>Y</bold>, i.e. correlation between <bold>Xw</bold> and <bold>Yv</bold>, times the standard deviation of <bold>Yv</bold>. Another related method is called partial least squares (PLS): it maximizes the covariance between <bold>Xw</bold> and <bold>Yv</bold>, i.e. correlation, times the standard deviation of <bold>Yv</bold>, times the standard deviation of <bold>Xw</bold>. In some sense, both RRR and PLS can be seen as particular regularized versions of CCA, because they bias <bold>w</bold> and <bold>v</bold> towards the high-variance directions in <bold>X</bold> and <bold>Y</bold>, somewhat similar to the ridge penalty. The method of Witten et al. maximizes covariance (and so could in fact have been called sparse PLS and not sparse CCA), which might provide too strong <italic toggle="yes">ℓ</italic><sub>2</sub> regularization. The method of Suo et al. maximizes correlation and does not use any ridge penalty, which might cause too weak <italic toggle="yes">ℓ</italic><sub>2</sub> regularization.</p></sec><sec id="s2h" hwp:id="sec-10"><label>2.8</label><title hwp:id="title-12">Gene selection stability</title><p hwp:id="p-45">Instability is a general feature of all sparse models, especially when <italic toggle="yes">n</italic> ≪ <italic toggle="yes">p</italic> (<xref ref-type="bibr" rid="c53" hwp:id="xref-ref-53-1" hwp:rel-id="ref-53">Xu et al., 2011</xref>). We used boot-strapping to estimate gene selection stability in our datasets. On each of the 100 iterations, we drew a bootstrap sample of <italic toggle="yes">n</italic> cells with repetitions and fit the sparse RRR model with the same parameters as above. This allows to measure how often each gene is selected into the model.</p><p hwp:id="p-46">As expected, we found that the larger the sample size the more stable the gene selection was. In the L1 dataset (<italic toggle="yes">n</italic> = 44), the most reliably selected gene was selected only 67% of times. In the L4 dataset (<italic toggle="yes">n</italic> = 102), 89% of times. In the M1 dataset (<italic toggle="yes">n</italic> = 1213), there were 10 genes that were selected over 90% of times, with several genes getting into the model on every bootstrap iteration.</p><p hwp:id="p-47">We also found that elastic net with <italic toggle="yes">α</italic> = 0.5 led to a more stable model than the pure lasso with <italic toggle="yes">α</italic> = 1 (with <italic toggle="yes">λ</italic> values appropriately adjusted to select 20 genes). We quantified the overall gene selection stability by computing the mean and the standard deviation of the bootstrap selection fraction across the top 20 most often selected genes. This average stability was 0.24 <italic toggle="yes">±</italic> 0.10 with <italic toggle="yes">α</italic> = 1.0 vs. 0.34 <italic toggle="yes">±</italic> 0.12 with <italic toggle="yes">α</italic> = 0.5 in the L1 dataset; 0.48 <italic toggle="yes">±</italic> 0.12 vs. 0.55 <italic toggle="yes">±</italic> 0.19 in the L4 dataset; and 0.80 <italic toggle="yes">±</italic> 0.20 vs. 0.85 <italic toggle="yes">±</italic> 0.19 in the M1 dataset. The difference was not large, but consistently observed in each dataset. See Discussion for more considerations about model stability.</p></sec><sec id="s2i" hwp:id="sec-11"><label>2.9</label><title hwp:id="title-13">Preprocessing choices</title><p hwp:id="p-48">All of the analysis shown above was done after selecting 1000–3000 most variable genes and standardizing the predictors. Putting these two preprocessing steps inside the cross-validation loop yielded practically the same results (<xref rid="fig6" ref-type="fig" hwp:id="xref-fig-6-1" hwp:rel-id="F6">Figure 6a–c</xref>; magenta lines).</p><fig id="fig6" position="float" fig-type="figure" orientation="portrait" hwp:id="F6" hwp:rev-id="xref-fig-6-1 xref-fig-6-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;302208v3/FIG6</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F6</object-id><object-id pub-id-type="publisher-id">fig6</object-id><label>Figure 6:</label><caption hwp:id="caption-7"><p hwp:id="p-49"><bold>a.</bold> Cross-validated <italic toggle="yes">R</italic><sup>2</sup> in the L1 dataset with <italic toggle="yes">r</italic> = 2, <italic toggle="yes">α</italic> = 0.5, and different values of <italic toggle="yes">λ</italic>. Solid lines: relaxed version, dashed lines: naive version. Colors code different preprocessing choices. Blue: default approach used in other figures. Orange: without standardizing the columns of <bold>X</bold>. Green: without selecting most variable columns of <bold>X</bold>. Red: without either. Purple: gene selection and standardization done within the CV loop on each training set separately (and applied to the test set). <bold>b.</bold> The same for the L4 dataset. <bold>c.</bold> The same for the M1 dataset.</p></caption><graphic xlink:href="302208v3_fig6" position="float" orientation="portrait" hwp:id="graphic-16"/></fig><p hwp:id="p-50">Omitting the gene selection step and performing sparse RRR directly on all detected genes (this number can exceed 40000, counting both coding and non-coding genes) and/or omitting the standardization step led to lower cross-validated <italic toggle="yes">R</italic><sup>2</sup> values in the L1 and L4 datasets but to exactly the same performance in the M1 dataset (<xref rid="fig6" ref-type="fig" hwp:id="xref-fig-6-2" hwp:rel-id="F6">Figure 6</xref>). This suggests that feature selection and standardization can be useful heuristics when the sample is low, but are not needed for larger sample sizes.</p></sec><sec id="s2j" hwp:id="sec-12"><label>2.10</label><title hwp:id="title-14">Sparse RRR with <italic toggle="yes">r</italic> ≠ 2</title><p hwp:id="p-51">For the L1 and L4 datasets, cross-validation suggested <italic toggle="yes">r</italic> = 2 as the optimal rank, conveniently allowing us to use two-dimensional scatter plots for visualization. For the M1 dataset we used <italic toggle="yes">r</italic> = 2 for visualization, despite cross-validation suggesting that a higher rank. In this case, one can show several biplots for different pairs of components, or alternatively perform separate RRR analyses on the subsets of the data. We refer to our parallel publication describing the M1 dataset for further analysis (<xref ref-type="bibr" rid="c40" hwp:id="xref-ref-40-5" hwp:rel-id="ref-40">Scala et al., 2020</xref>).</p><p hwp:id="p-52">We observed an opposite case when we applied sparse RRR to the S1 dataset with <italic toggle="yes">n</italic> = 80 inhibitory (all <italic toggle="yes">Cck</italic> from layers 1/2) and excitatory neurons from mouse somatosensory cortex (<xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-3" hwp:rel-id="ref-14">Fuzik et al., 2016</xref>). The first RRR component strongly separated excitatory and inhibitory neurons (<xref rid="fig7" ref-type="fig" hwp:id="xref-fig-7-1" hwp:rel-id="F7">Figure 7</xref>), which is not surprising given the large differences in gene expression and in firing patterns between these two classes of neurons. However, subsequent RRR components did not carry much signal in this dataset. The RRR model with <italic toggle="yes">r</italic> = 1 and <italic toggle="yes">α</italic> = 0.5 outperformed the model with <italic toggle="yes">r</italic> = 2 for low number of selected genes (<xref rid="fig7" ref-type="fig" hwp:id="xref-fig-7-2" hwp:rel-id="F7">Figure 7a</xref>), while the correlation in the 2nd component pair was close to zero (<xref rid="fig7" ref-type="fig" hwp:id="xref-fig-7-3" hwp:rel-id="F7">Figure 7b</xref>). This suggests effectively a one-dimensional shared subspace in this dataset.</p><fig id="fig7" position="float" fig-type="figure" orientation="portrait" hwp:id="F7" hwp:rev-id="xref-fig-7-1 xref-fig-7-2 xref-fig-7-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;302208v3/FIG7</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F7</object-id><object-id pub-id-type="publisher-id">fig7</object-id><label>Figure 7:</label><caption hwp:id="caption-8"><p hwp:id="p-53"><bold>a.</bold> Cross-validation estimates of <italic toggle="yes">R</italic><sup>2</sup> in sparse RRR with <italic toggle="yes">r</italic> = 1 and <italic toggle="yes">r</italic> = 2 (<italic toggle="yes">α</italic> = 0.5) in the S1 dataset. Horizontal axis shows the average number of selected genes obtained for each <italic toggle="yes">λ</italic>. <bold>b.</bold> Cross-validation estimates of correlations between the transcriptomic and the electrophyiological RRR components with <italic toggle="yes">r</italic> = 2 and <italic toggle="yes">α</italic> = 0.5. <bold>c.</bold> The RRR component using <italic toggle="yes">r</italic> = 1 and <italic toggle="yes">α</italic> = 0.5 in the transcriptomic space (horizontal axis) and in the electrophysiological space (vertical axis). The value of <italic toggle="yes">λ</italic> was chosen to yield 10 selected genes.</p></caption><graphic xlink:href="302208v3_fig7" position="float" orientation="portrait" hwp:id="graphic-17"/></fig></sec></sec><sec id="s3" hwp:id="sec-13"><label>3</label><title hwp:id="title-15">Discussion</title><p hwp:id="p-54">We proposed sparse reduced-rank regression (sRRR) as a tool for interpretable data exploration and visualization of Patch-seq recordings as an example of paired multivariate datasets in general. It allows to visualize the variability across cells in transcriptomic and electrophysiological modalities in a consistent way, and to find a sparse set of genes explaining electrophysiological variability. We used cross-validation to tune the hyper-parameters and to estimate the out-of-sample performance of the model.</p><sec id="s3a" hwp:id="sec-14"><label>3.1</label><title hwp:id="title-16">Comparison to other regression methods</title><p hwp:id="p-55">Our method directly builds up on the sparse RRR of <xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-7" hwp:rel-id="ref-5">Chen and Huang (2012)</xref> who added the lasso penalty to the RRR loss function. We extended this approach by using an elastic net penalty that combines lasso and ridge regularization. This adds flexibility to the method and indeed we showed that in some cases non-zero ridge penalty is beneficial for the predictive performance (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-10" hwp:rel-id="F3">Figure 3</xref>) and for model stability. In addition, we introduced the relaxed elastic net approach to mitigate the over-shrinkage bias associated with naive elastic net or naive lasso solutions (<xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-3" hwp:rel-id="ref-11">Efron et al., 2004</xref>; <xref ref-type="bibr" rid="c58" hwp:id="xref-ref-58-6" hwp:rel-id="ref-58">Zou and Hastie, 2005</xref>; <xref ref-type="bibr" rid="c33" hwp:id="xref-ref-33-4" hwp:rel-id="ref-33">Meinshausen, 2007</xref>; <xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-2" hwp:rel-id="ref-10">De Mol et al., 2009</xref>). The sparse RRR method of <xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-8" hwp:rel-id="ref-5">Chen and Huang (2012)</xref> corresponds to our naive RRR with <italic toggle="yes">α</italic> = 1, which in our experiments performed much worse than the relaxed version (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-11" hwp:rel-id="F3">Figure 3</xref>).</p><p hwp:id="p-56">Furthermore, on some of the datasets sparse reduced-rank regression outperformed sparse full-rank regression (which is directly available e.g. in the popular <monospace>glmnet</monospace> library), suggesting that reduced-rank constraint is not only useful for visualisation but can also provide additional regularization and reduces overfitting.</p><p hwp:id="p-57">Elastic net regularization has two parameters, <italic toggle="yes">α</italic> and <italic toggle="yes">λ</italic>, and cross-validation sometimes indicated that <italic toggle="yes">α</italic> can be varied in some range without affecting the model performance (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-12" hwp:rel-id="F3">Figure 3</xref>). This allows the researcher to control the trade-off between a sparser solution and a more comprehensive gene selection. If there is a set of genes that are highly correlated among each other, then large <italic toggle="yes">α</italic> will tend to select only one of them, whereas small <italic toggle="yes">α</italic> will tend to assign similar weights to all of them. We recommend using <italic toggle="yes">α</italic> = 0.5 as a reasonable default compromise.</p><p hwp:id="p-58">We followed <xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-3" hwp:rel-id="ref-13">Friedman et al. (2010)</xref>, <xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-9" hwp:rel-id="ref-5">Chen and Huang (2012)</xref> and others in imposing sparsity only in the predictor space: the lasso penalty is applied only to <bold>W</bold> but not to <bold>V</bold> and so feature selection only happens on the columns of <bold>X</bold> but not of <bold>Y</bold>. This arguably makes sense for the Patch-seq data considered in this manuscript but may be different for other kinds of datasets. See <xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">Chen et al. (2012a)</xref> for a discussion of sparse reduced-rank regression with sparsity in both <bold>X</bold> and <bold>Y</bold>.</p></sec><sec id="s3b" hwp:id="sec-15"><label>3.2</label><title hwp:id="title-17">Comparison to other dimensionality reduction methods</title><p hwp:id="p-59">Reduced rank-regression is closely related to two other classical dimensionality reduction methods analyzing two paired data matrices (also called <italic toggle="yes">two-view</italic> data): canonical correlation analysis (CCA) and partial least squares (PLS). They can be understood as looking for projections with maximal correlation (CCA) or maximal covariance (PLS) between <bold>X</bold> and <bold>Y</bold>, whereas RRR looks for projections with maximal explained variance in <bold>Y</bold>. In recent years, multiple approaches to sparse CCA (<xref ref-type="bibr" rid="c48" hwp:id="xref-ref-48-1" hwp:rel-id="ref-48">Waaijenborg et al., 2008</xref>; <xref ref-type="bibr" rid="c49" hwp:id="xref-ref-49-2" hwp:rel-id="ref-49">Wiesel et al., 2008</xref>; <xref ref-type="bibr" rid="c34" hwp:id="xref-ref-34-2" hwp:rel-id="ref-34">Parkhomenko et al., 2009</xref>; <xref ref-type="bibr" rid="c52" hwp:id="xref-ref-52-4" hwp:rel-id="ref-52">Witten et al., 2009</xref>; <xref ref-type="bibr" rid="c51" hwp:id="xref-ref-51-2" hwp:rel-id="ref-51">Witten and Tibshirani, 2009</xref>; <xref ref-type="bibr" rid="c30" hwp:id="xref-ref-30-2" hwp:rel-id="ref-30">Lykou and Whittaker, 2010</xref>; <xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-2" hwp:rel-id="ref-21">Hardoon and Shawe-Taylor, 2011</xref>; <xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-2" hwp:rel-id="ref-6">Chen et al., 2012b</xref>; <xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-2" hwp:rel-id="ref-7">Chu et al., 2013</xref>; <xref ref-type="bibr" rid="c50" hwp:id="xref-ref-50-2" hwp:rel-id="ref-50">Wilms and Croux, 2015</xref>; <xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-2" hwp:rel-id="ref-16">Gao et al., 2017</xref>; <xref ref-type="bibr" rid="c42" hwp:id="xref-ref-42-4" hwp:rel-id="ref-42">Suo et al., 2017</xref>) and sparse PLS (<xref ref-type="bibr" rid="c25" hwp:id="xref-ref-25-1" hwp:rel-id="ref-25">Lê Cao et al., 2008</xref>, <xref ref-type="bibr" rid="c27" hwp:id="xref-ref-27-1" hwp:rel-id="ref-27">2011</xref>; Chun and Keleş, 2010) have been suggested in the literature. Here, we chose sparse RRR at the core of our framework, because for the Patch-seq data it seems more meaningful to predict electrophyiological properties from transcriptomic information instead of treating them symmetrically, as genes give rise to physiological function. In addition, sparse RRR allows a mathematically simple formulation for rank <italic toggle="yes">r &gt;</italic> 1 (using group lasso), whereas all sparse PLS/CCA methods cited above are iterative: after extracting the <italic toggle="yes">k</italic>-th component, matrices <bold>X</bold> and <bold>Y</bold> are deflated and the algorithm is repeated to extract the (<italic toggle="yes">k</italic> + 1)-th component, resulting in a cumbersome procedure that is often difficult to analyze mathematically.</p><p hwp:id="p-60">That said, by comparing our sparse RRR method with sparse PLS/CCA methods of <xref ref-type="bibr" rid="c52" hwp:id="xref-ref-52-5" hwp:rel-id="ref-52">Witten et al. (2009)</xref> and <xref ref-type="bibr" rid="c42" hwp:id="xref-ref-42-5" hwp:rel-id="ref-42">Suo et al. (2017)</xref>, we unexpectedly found that our method is competitive as a CCA variant. This suggests that there is room for new sparse CCA methods that would be more appropriate at least for the kind of datasets studied here.</p><p hwp:id="p-61">Sparse (and non-sparse) CCA and PLS have been applied to biological datasets in order to integrate multiomics data (<xref ref-type="bibr" rid="c25" hwp:id="xref-ref-25-2" hwp:rel-id="ref-25">Lê Cao et al., 2008</xref>, <xref ref-type="bibr" rid="c26" hwp:id="xref-ref-26-1" hwp:rel-id="ref-26">2009</xref>; <xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">González et al., 2008</xref>, <xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-1" hwp:rel-id="ref-18">2009</xref>, <xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-1" hwp:rel-id="ref-19">2012</xref>), with the recent mixOmics package for R providing a convenient implementation for several of these methods (<xref ref-type="bibr" rid="c37" hwp:id="xref-ref-37-1" hwp:rel-id="ref-37">Rohart et al., 2017</xref>). We believe that our sparse RRR can be a useful addition to this array of multi-omics statistical techniques.</p><p hwp:id="p-62">This series of multi-omics papers always used two separate plots for visualizing the CCA/PLS results within each modality: a <italic toggle="yes">sample plot</italic>, also called a <italic toggle="yes">units plot</italic> (in our case this would be a scatter plot of Patch-seq cells), and a <italic toggle="yes">variable plot</italic>, also called a <italic toggle="yes">correlation circle plot</italic> (in our case this would be a scatter plot of selected genes or electrophysiological properties, together with the correlation circle). We found it convenient to combine these two plots into a single biplot (<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-3" hwp:rel-id="ref-15">Gabriel, 1971</xref>). This allows to use two biplots (what we called a bibiplot) instead of four separate plots.</p><p hwp:id="p-63">In ecology, reduced-rank regression has been long used for dimensionality reduction and data visualization, under the name of redundancy analysis (RDA) (Ter <xref ref-type="bibr" rid="c45" hwp:id="xref-ref-45-1" hwp:rel-id="ref-45">Braak, 1994</xref>; <xref ref-type="bibr" rid="c36" hwp:id="xref-ref-36-1" hwp:rel-id="ref-36">Ramette, 2007</xref>). This field uses biplots similar to the ones developed in this manuscript (<xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">Braak and Looman, 1994</xref>), sometimes combining both biplots into one figure. A recently suggested sparse RDA (<xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">Csala et al., 2017</xref>) has similar aim to our work; their method can be seen as a variant of sparse PLS.</p></sec><sec id="s3c" hwp:id="sec-16"><label>3.3</label><title hwp:id="title-18">Limitations and outlook</title><p hwp:id="p-64">Following <xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-4" hwp:rel-id="ref-13">Friedman et al. (2010)</xref> and <xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-10" hwp:rel-id="ref-5">Chen and Huang (2012)</xref>, we used group lasso that induces row-wise sparsity in <bold>W</bold>. This means that the same set of genes is selected for all RRR components. For <italic toggle="yes">r</italic> = 2, as used in this manuscript, the same set of genes influences the 1st and the 2nd component, which has both advantages and disadvantages. Our sparse RRR algorithm is easy to modify for the standard lasso case: using Σ∥<italic toggle="yes">W</italic><sub><italic toggle="yes">i·</italic></sub>∥<sub>1</sub> in <xref ref-type="disp-formula" rid="eqn5" hwp:id="xref-disp-formula-5-1" hwp:rel-id="disp-formula-5">Eq. (5)</xref> instead of Σ∥<italic toggle="yes">W</italic><sub><italic toggle="yes">i·</italic></sub>∥<sub>2</sub> would induce element-wise sparsity. In this case the loss in <xref ref-type="disp-formula" rid="eqn7" hwp:id="xref-disp-formula-7-1" hwp:rel-id="disp-formula-7">Eq. (7)</xref> can be minimized separately for each column of <bold>W</bold> (e.g. also using <monospace>glmnet</monospace>). Using this approach, different sets can be selected for different RRR components and the same value of <italic toggle="yes">λ</italic> can yield different number of selected genes for different components. However, when using relaxed elastic net and performing RRR again, all components will get nonzero contributions from all selected genes. Further work would be needed to formulate a relaxed version of the element-wise sparse RRR that would preserve element-wise sparsity. Empirically, we found that for the datasets considered here, the performance of the element-wise sparse RRR without relaxation was similar to the performance of the naive row-wise sparse RRR but worse than the performance of the relaxed row-wise sparse RRR.</p><p hwp:id="p-65">One important caveat is that the list of selected genes should not be interpreted as definite. There are two reasons for that. First, the model performance (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-13" hwp:rel-id="F3">Figure 3</xref>) was unaffected in some range of parameters corresponding to selecting from ∼10 to ∼50 genes, meaning that the choice of regularization strength in this interval remains an analyst’s call. Second, even for fixed regularization parameters, a somewhat different set of genes may be selected every time the experiment is repeated. We used bootstrapping to directly estimate gene selection stability of sparse RRR, and found that the larger the sample size, the more stable the model was. There is an interplay between these two factors. Stronger <italic toggle="yes">ℓ</italic><sub>1</sub> regularization leads to a sparser model with less selection reliability. Weaker <italic toggle="yes">ℓ</italic><sub>1</sub> regularization leads to a less sparse model with higher selection reliability. We stress that such instability is an inherent feature of <italic toggle="yes">all</italic> sparse methods (<xref ref-type="bibr" rid="c53" hwp:id="xref-ref-53-2" hwp:rel-id="ref-53">Xu et al., 2011</xref>). We used bootstrapping to confirm that sparse CCA of Witten et al. had similar levels of selection instability.</p><p hwp:id="p-66">In principle, it would be possible to generalize our regression framework to nonlinear mappings, using e.g. a neural network with a bottleneck instead of the low-rank linear mapping shown in <xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-10" hwp:rel-id="F1">Figure 1e</xref>. This can be an interesting direction for future research, but fitting such models would require sample sizes at least as high as in the M1 dataset.</p><p hwp:id="p-67">In conclusion, we believe that sparse RRR can be a valuable tool for exploration and visualization of paired datasets. We expect that our method can be relevant beyond the scope of Patch-seq data. For example, spatial transcriptomics (<xref ref-type="bibr" rid="c28" hwp:id="xref-ref-28-1" hwp:rel-id="ref-28">Lein et al., 2017</xref>) combined with two-photon imaging may allow characterizing the transcriptome and physiology of individual cells in the intact tissue, yielding large multi-modal datasets. Similarly, other types of multi-omics data where single-cell or bulk transcriptomic data are combined with some other type of measurements (e.g. chemical, medical, or even behavioural), may benefit from interpretable visualization techniques such as the one introduced here.</p></sec></sec><sec id="s4" hwp:id="sec-17"><label>4</label><title hwp:id="title-19">Methods</title><sec id="s4a" hwp:id="sec-18"><label>4.1</label><title hwp:id="title-20">Data preprocessing</title><sec id="s4a1" hwp:id="sec-19"><title hwp:id="title-21">L1 dataset</title><p hwp:id="p-68">We used read count table from the original publication (<xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-3" hwp:rel-id="ref-2">Cadwell et al., 2016</xref>). In this dataset there are <italic toggle="yes">n</italic> = 51 interneurons (from 53 sequenced interneurons, 2 were excluded in the original publication as contaminated), <italic toggle="yes">p</italic> = 15 074 genes identified by the authors as detected, and <italic toggle="yes">q</italic> = 11 electrophysiological properties. We excluded all cells for which at least one electrophysiological property was not estimated, resulting in <italic toggle="yes">n</italic> = 44. We restricted the gene pool to the <italic toggle="yes">p</italic> = 3000 most variable genes, the same ones identified in the original publication. We used the expert classification of cells into two classes performed in the original publication for annotating cell types. Out of <italic toggle="yes">n</italic> = 44 cells, only 35 cells were classified unambiguously (score 1 or score 5 on the scale from 1 to 5); the remaining 9 cells received intermediate scores. When performing cross-validation with gene selection in the CV loop, we used the gene selection procedure from <xref ref-type="bibr" rid="c24" hwp:id="xref-ref-24-1" hwp:rel-id="ref-24">Kobak and Berens (2019)</xref>.</p></sec><sec id="s4a2" hwp:id="sec-20"><title hwp:id="title-22">S1 dataset</title><p hwp:id="p-69">We used UMI counts table from the original publication (<xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-4" hwp:rel-id="ref-14">Fuzik et al., 2016</xref>). In this dataset there are <italic toggle="yes">n</italic> = 83 cells, <italic toggle="yes">p</italic> = 24 378 genes after excluding ERCC spike-ins, and <italic toggle="yes">q</italic> = 89 electrophysiological properties. Out of 83 sequenced cells, we were only able to match <italic toggle="yes">n</italic> = 80 to the electrophysiological data. We used only <italic toggle="yes">q</italic> = 80 electrophysiological properties for which the data were available for all these cells (the fact that <italic toggle="yes">n</italic> = <italic toggle="yes">q</italic> = 80 is coincidental). We selected <italic toggle="yes">p</italic> = 1 384 genes with average expression above 0.5 (before standardization) for the RRR analysis.</p></sec><sec id="s4a3" hwp:id="sec-21"><title hwp:id="title-23">L4 dataset</title><p hwp:id="p-70">We used read counts table from the original publication (<xref ref-type="bibr" rid="c39" hwp:id="xref-ref-39-3" hwp:rel-id="ref-39">Scala et al., 2019</xref>). In this dataset there are <italic toggle="yes">n</italic> = 110 Patch-seq neurons; we used the same <italic toggle="yes">n</italic> = 102 as in the original publication (after excluding low quality cells). We used the same <italic toggle="yes">p</italic> = 1000 genes selected in the original publication, and the same <italic toggle="yes">q</italic> = 13 electrophysiological properties.</p></sec><sec id="s4a4" hwp:id="sec-22"><title hwp:id="title-24">M1 dataset</title><p hwp:id="p-71">We used read counts table from the original publication (<xref ref-type="bibr" rid="c40" hwp:id="xref-ref-40-6" hwp:rel-id="ref-40">Scala et al., 2020</xref>). In this dataset there are <italic toggle="yes">n</italic> = 1320 Patch-seq neurons; we used the same <italic toggle="yes">n</italic> = 1213 as in the original publication (after excluding low quality cells). We used the same <italic toggle="yes">p</italic> = 1000 genes selected in the original publication, and the same <italic toggle="yes">q</italic> = 16 electrophysiological properties.</p></sec><sec id="s4a5" hwp:id="sec-23"><title hwp:id="title-25">Preprocessing</title><p hwp:id="p-72">For the full-length datasets (L1, L4, M1) we performed sequencing depth normalization by converting the counts to counter per million (CPM). For the UMI-based dataset (S1) we divided the values for each cell by the cell sum over all genes (sequencing depth) and multiplying the result by the median sequencing depth size across all cells. In both cases we then log-transformed the data using log2(<italic toggle="yes">x</italic> + 1) transformation. Finally, we standardized all gene expression values and all electrophysiological properties to zero mean and unit variance.</p></sec></sec><sec id="s5" hwp:id="sec-24"><label>4.2</label><title hwp:id="title-26">Data availability</title><p hwp:id="p-73">All datasets were either downloaded from the original publications or provided by the authors. All of them can be found at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/berenslab/patch-seq-rrr" ext-link-type="uri" xlink:href="https://github.com/berenslab/patch-seq-rrr" hwp:id="ext-link-3">https://github.com/berenslab/patch-seq-rrr</ext-link>. Our full analysis code in Python is also available there.</p></sec></sec></body><back><app-group hwp:id="app-group-1"><app id="app1" hwp:id="app-1"><label>5 Appendix.</label><title hwp:id="title-27">Procrustes problem</title><p hwp:id="p-74">Given <bold>A</bold>, the Procrustes problem is to maximize tr(<bold>AV</bold><sup>⊤</sup>) subject to <bold>V</bold><sup>⊤</sup><bold>V</bold> = <bold>I</bold> (<xref ref-type="bibr" rid="c20" hwp:id="xref-ref-20-2" hwp:rel-id="ref-20">Gower and Dijksterhuis, 2004</xref>). Let us denote by <inline-formula hwp:id="inline-formula-7"><alternatives hwp:id="alternatives-16"><inline-graphic xlink:href="302208v3_inline7.gif" hwp:id="inline-graphic-7"/></alternatives></inline-formula> the thin and the full SVD of <bold>A</bold>. Now we have:
<disp-formula id="ueqn1" hwp:id="disp-formula-10">
<alternatives hwp:id="alternatives-17"><graphic xlink:href="302208v3_ueqn1.gif" position="float" orientation="portrait" hwp:id="graphic-18"/></alternatives>
</disp-formula></p><p hwp:id="p-75">Here <inline-formula hwp:id="inline-formula-8"><alternatives hwp:id="alternatives-18"><inline-graphic xlink:href="302208v3_inline8.gif" hwp:id="inline-graphic-8"/></alternatives></inline-formula> is a matrix with orthonormal rows as can be verified directly, and so it must have all its elements not larger than one. It follows that the whole trace is not larger than the sum of singular values of <bold>A</bold>. Using <bold>V</bold> = <bold>LR</bold><sup>⊤</sup> yields exactly this value of the trace, hence it is the optimum.</p></app></app-group><sec id="s6" hwp:id="sec-25"><title hwp:id="title-28">Authors’ contributions</title><p hwp:id="p-76">PB and DK conceptualized the project, DK developed the statistical method and wrote the software, DK, YB, and MW performed computational experiments, FS performed Patch-seq experiments under the supervision of AT and helped analyzing the data, PB supervised the project. DK and PB wrote the paper with input from all authors.</p></sec><ack hwp:id="ack-1"><title hwp:id="title-29">Acknowledgements</title><p hwp:id="p-77">We thank Rickard Sandberg, Cathryn Cadwell, and Jiaolong Xiang for discussions, Cathryn Cadwell, Janos Fuzik and their co-authors for making their data available and Shreejoy Tripathy for comments and help with data processing. This work was funded by the German Ministry of Education and Research (FKZ 01GQ1601), the German Research Foundation (EXC 2064 project number 390727645, BE5601/4-1) and the National Institute Of Mental Health of the National Institutes of Health under Award Number U19MH114830. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health.</p></ack><ref-list hwp:id="ref-list-1"><title hwp:id="title-30">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.1" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Braak Cajo JF Ter"><given-names>Cajo JF Ter</given-names> <surname>Braak</surname></string-name> and <string-name name-style="western" hwp:sortable="Looman Caspar WN"><given-names>Caspar WN</given-names> <surname>Looman</surname></string-name>. <article-title hwp:id="article-title-2">Biplots in reduced-rank regression</article-title>. <source hwp:id="source-1">Biometrical Journal</source>, <volume>36</volume>(<issue>8</issue>): <fpage>983</fpage>–<lpage>1003</lpage>, <year>1994</year>.</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1 xref-ref-2-2 xref-ref-2-3"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="Cadwell Cathryn R"><given-names>Cathryn R</given-names> <surname>Cadwell</surname></string-name>, <string-name name-style="western" hwp:sortable="Palasantza Athanasia"><given-names>Athanasia</given-names> <surname>Palasantza</surname></string-name>, <string-name name-style="western" hwp:sortable="Jiang Xiaolong"><given-names>Xiaolong</given-names> <surname>Jiang</surname></string-name>, <string-name name-style="western" hwp:sortable="Berens Philipp"><given-names>Philipp</given-names> <surname>Berens</surname></string-name>, <string-name name-style="western" hwp:sortable="Deng Qiaolin"><given-names>Qiaolin</given-names> <surname>Deng</surname></string-name>, <string-name name-style="western" hwp:sortable="Yilmaz Marlene"><given-names>Marlene</given-names> <surname>Yilmaz</surname></string-name>, <string-name name-style="western" hwp:sortable="Reimer Jacob"><given-names>Jacob</given-names> <surname>Reimer</surname></string-name>, <string-name name-style="western" hwp:sortable="Shen Shan"><given-names>Shan</given-names> <surname>Shen</surname></string-name>, <string-name name-style="western" hwp:sortable="Bethge Matthias"><given-names>Matthias</given-names> <surname>Bethge</surname></string-name>, <string-name name-style="western" hwp:sortable="Tolias Kimberley F"><given-names>Kimberley F</given-names> <surname>Tolias</surname></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-3">Electrophysiological, transcriptomic and morphologic profiling of single neurons using patch-seq</article-title>. <source hwp:id="source-2">Nature Biotechnology</source>, <volume>34</volume>(<issue>2</issue>):<fpage>199</fpage>, <year>2016</year>.</citation></ref><ref id="c3" hwp:id="ref-3" hwp:rev-id="xref-ref-3-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.3" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Cadwell Cathryn R"><given-names>Cathryn R</given-names> <surname>Cadwell</surname></string-name>, <string-name name-style="western" hwp:sortable="Scala Federico"><given-names>Federico</given-names> <surname>Scala</surname></string-name>, <string-name name-style="western" hwp:sortable="Li Shuang"><given-names>Shuang</given-names> <surname>Li</surname></string-name>, <string-name name-style="western" hwp:sortable="Livrizzi Giulia"><given-names>Giulia</given-names> <surname>Livrizzi</surname></string-name>, <string-name name-style="western" hwp:sortable="Shen Shan"><given-names>Shan</given-names> <surname>Shen</surname></string-name>, <string-name name-style="western" hwp:sortable="Sandberg Rickard"><given-names>Rickard</given-names> <surname>Sandberg</surname></string-name>, <string-name name-style="western" hwp:sortable="Jiang Xiaolong"><given-names>Xiaolong</given-names> <surname>Jiang</surname></string-name>, and <string-name name-style="western" hwp:sortable="Tolias Andreas S"><given-names>Andreas S</given-names> <surname>Tolias</surname></string-name>. <article-title hwp:id="article-title-4">Multimodal profiling of single-cell morphology, electrophysiology, and gene expression using Patch-seq</article-title>. <source hwp:id="source-3">Nature Protocols</source>, <volume>12</volume>(<issue>12</issue>):<fpage>2531</fpage>, <year>2017</year>.</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.4" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Chen Kun"><given-names>Kun</given-names> <surname>Chen</surname></string-name>, <string-name name-style="western" hwp:sortable="Chan Kung-Sik"><given-names>Kung-Sik</given-names> <surname>Chan</surname></string-name>, and <string-name name-style="western" hwp:sortable="Stenseth Nils Chr"><given-names>Nils Chr</given-names> <surname>Stenseth</surname></string-name>. <article-title hwp:id="article-title-5">Reduced rank stochastic regression with a sparse singular value decomposition</article-title>. <source hwp:id="source-4">Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>, <volume>74</volume>(<issue>2</issue>):<fpage>203</fpage>–<lpage>221</lpage>, <year>2012a</year>.</citation></ref><ref id="c5" hwp:id="ref-5" hwp:rev-id="xref-ref-5-1 xref-ref-5-2 xref-ref-5-3 xref-ref-5-4 xref-ref-5-5 xref-ref-5-6 xref-ref-5-7 xref-ref-5-8 xref-ref-5-9 xref-ref-5-10"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.5" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Chen Lisha"><given-names>Lisha</given-names> <surname>Chen</surname></string-name> and <string-name name-style="western" hwp:sortable="Huang Jianhua Z"><given-names>Jianhua Z</given-names> <surname>Huang</surname></string-name>. <article-title hwp:id="article-title-6">Sparse reduced-rank regression for simultaneous dimension reduction and variable selection</article-title>. <source hwp:id="source-5">Journal of the American Statistical Association</source>, <volume>107</volume>(<issue>500</issue>):<fpage>1533</fpage>–<lpage>1545</lpage>, <year>2012</year>.</citation></ref><ref id="c6" hwp:id="ref-6" hwp:rev-id="xref-ref-6-1 xref-ref-6-2"><citation publication-type="other" citation-type="journal" ref:id="302208v3.6" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Chen Xi"><given-names>Xi</given-names> <surname>Chen</surname></string-name>, <string-name name-style="western" hwp:sortable="Han Liu"><given-names>Liu</given-names> <surname>Han</surname></string-name>, and <string-name name-style="western" hwp:sortable="Carbonell Jaime"><given-names>Jaime</given-names> <surname>Carbonell</surname></string-name>. <chapter-title>Structured sparse canonical correlation analysis</chapter-title>. <source hwp:id="source-6">In Artificial Intelligence and Statistics</source>, pages <fpage>199</fpage>–<lpage>207</lpage>, <year>2012b</year>.</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1 xref-ref-7-2"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.7" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Chu Delin"><given-names>Delin</given-names> <surname>Chu</surname></string-name>, <string-name name-style="western" hwp:sortable="Liao Li-Zhi"><given-names>Li-Zhi</given-names> <surname>Liao</surname></string-name>, <string-name name-style="western" hwp:sortable="Ng Michael K"><given-names>Michael K</given-names> <surname>Ng</surname></string-name>, and <string-name name-style="western" hwp:sortable="Zhang Xiaowei"><given-names>Xiaowei</given-names> <surname>Zhang</surname></string-name>. <article-title hwp:id="article-title-7">Sparse canonical correlation analysis: New formulation and algorithm</article-title>. <source hwp:id="source-7">IEEE Transactions on Pattern Analysis and Machine Intelligence</source>, <volume>35</volume>(<issue>12</issue>):<fpage>3050</fpage>–<lpage>3065</lpage>, <year>2013</year>.</citation></ref><ref id="c8" hwp:id="ref-8"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Chun Hyonho"><given-names>Hyonho</given-names> <surname>Chun</surname></string-name> and <string-name name-style="western" hwp:sortable="Keles Sündüz"><given-names>Sündüz</given-names> <surname>Keles</surname></string-name>. <article-title hwp:id="article-title-8">Sparse partial least squares regression for simultaneous dimension reduction and variable selection</article-title>. <source hwp:id="source-8">Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>, <volume>72</volume>(<issue>1</issue>):<fpage>3</fpage>–<lpage>25</lpage>, <year>2010</year>.</citation></ref><ref id="c9" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.9" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Csala Attila"><given-names>Attila</given-names> <surname>Csala</surname></string-name>, <string-name name-style="western" hwp:sortable="Voorbraak Frans PJM"><given-names>Frans PJM</given-names> <surname>Voorbraak</surname></string-name>, <string-name name-style="western" hwp:sortable="Zwinderman Aeilko H"><given-names>Aeilko H</given-names> <surname>Zwinderman</surname></string-name>, and <string-name name-style="western" hwp:sortable="Hof Michel H"><given-names>Michel H</given-names> <surname>Hof</surname></string-name>. <article-title hwp:id="article-title-9">Sparse redundancy analysis of high-dimensional genetic and genomic data</article-title>. <source hwp:id="source-9">Bioinformatics</source>, <volume>33</volume>(<issue>20</issue>):<fpage>3228</fpage>–<lpage>3234</lpage>, <year>2017</year>.</citation></ref><ref id="c10" hwp:id="ref-10" hwp:rev-id="xref-ref-10-1 xref-ref-10-2"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="De Mol Christine"><given-names>Christine</given-names> <surname>De Mol</surname></string-name>, <string-name name-style="western" hwp:sortable="Mosci Sofia"><given-names>Sofia</given-names> <surname>Mosci</surname></string-name>, <string-name name-style="western" hwp:sortable="Traskine Magali"><given-names>Magali</given-names> <surname>Traskine</surname></string-name>, and <string-name name-style="western" hwp:sortable="Verri Alessandro"><given-names>Alessandro</given-names> <surname>Verri</surname></string-name>. <article-title hwp:id="article-title-10">A regularized method for selecting nested groups of relevant genes from microarray data</article-title>. <source hwp:id="source-10">Journal of Computational Biology</source>, <volume>16</volume>(<issue>5</issue>):<fpage>677</fpage>–<lpage>690</lpage>, <year>2009</year>.</citation></ref><ref id="c11" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1 xref-ref-11-2 xref-ref-11-3"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.11" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="Efron Bradley"><given-names>Bradley</given-names> <surname>Efron</surname></string-name>, <string-name name-style="western" hwp:sortable="Hastie Trevor"><given-names>Trevor</given-names> <surname>Hastie</surname></string-name>, <string-name name-style="western" hwp:sortable="Johnstone Iain"><given-names>Iain</given-names> <surname>Johnstone</surname></string-name>, <string-name name-style="western" hwp:sortable="Tibshirani Robert"><given-names>Robert</given-names> <surname>Tibshirani</surname></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-11">Least angle regression</article-title>. <source hwp:id="source-11">The Annals of Statistics</source>, <volume>32</volume>(<issue>2</issue>):<fpage>407</fpage>–<lpage>499</lpage>, <year>2004</year>.</citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.12" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Földy Csaba"><given-names>Csaba</given-names> <surname>Földy</surname></string-name>, <string-name name-style="western" hwp:sortable="Darmanis Spyros"><given-names>Spyros</given-names> <surname>Darmanis</surname></string-name>, <string-name name-style="western" hwp:sortable="Aoto Jason"><given-names>Jason</given-names> <surname>Aoto</surname></string-name>, <string-name name-style="western" hwp:sortable="Malenka Robert C"><given-names>Robert C</given-names> <surname>Malenka</surname></string-name>, <string-name name-style="western" hwp:sortable="Quake Stephen R"><given-names>Stephen R</given-names> <surname>Quake</surname></string-name>, and <string-name name-style="western" hwp:sortable="Südhof Thomas C"><given-names>Thomas C</given-names> <surname>Südhof</surname></string-name>. <article-title hwp:id="article-title-12">Single-cell rnaseq reveals cell adhesion molecule profiles in electrophysiologically defined neurons</article-title>. <source hwp:id="source-12">Proceedings of the National Academy of Sciences</source>, <volume>113</volume>(<issue>35</issue>):<fpage>E5222</fpage>–<lpage>E5231</lpage>, <year>2016</year>.</citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1 xref-ref-13-2 xref-ref-13-3 xref-ref-13-4"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.13" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="Friedman Jerome"><given-names>Jerome</given-names> <surname>Friedman</surname></string-name>, <string-name name-style="western" hwp:sortable="Hastie Trevor"><given-names>Trevor</given-names> <surname>Hastie</surname></string-name>, and <string-name name-style="western" hwp:sortable="Tibshirani Rob"><given-names>Rob</given-names> <surname>Tibshirani</surname></string-name>. <article-title hwp:id="article-title-13">Regularization paths for generalized linear models via coordinate descent</article-title>. <source hwp:id="source-13">Journal of Statistical Software</source>, <volume>33</volume>(<issue>1</issue>):<fpage>1</fpage>, <year>2010</year>.</citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1 xref-ref-14-2 xref-ref-14-3 xref-ref-14-4"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.14" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Fuzik János"><given-names>János</given-names> <surname>Fuzik</surname></string-name>, <string-name name-style="western" hwp:sortable="Zeisel Amit"><given-names>Amit</given-names> <surname>Zeisel</surname></string-name>, <string-name name-style="western" hwp:sortable="Máté Zoltán"><given-names>Zoltán</given-names> <surname>Máté</surname></string-name>, <string-name name-style="western" hwp:sortable="Calvigioni Daniela"><given-names>Daniela</given-names> <surname>Calvigioni</surname></string-name>, <string-name name-style="western" hwp:sortable="Yanagawa Yuchio"><given-names>Yuchio</given-names> <surname>Yanagawa</surname></string-name>, <string-name name-style="western" hwp:sortable="Szabó Gábor"><given-names>Gábor</given-names> <surname>Szabó</surname></string-name>, <string-name name-style="western" hwp:sortable="Linnarsson Sten"><given-names>Sten</given-names> <surname>Linnarsson</surname></string-name>, and <string-name name-style="western" hwp:sortable="Harkany Tibor"><given-names>Tibor</given-names> <surname>Harkany</surname></string-name>. <article-title hwp:id="article-title-14">Integration of electrophysiological recordings with single-cell RNA-seq data identifies neuronal subtypes</article-title>. <source hwp:id="source-14">Nature Biotechnology</source>, <volume>34</volume>(<issue>2</issue>):<fpage>175</fpage>, <year>2016</year>.</citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1 xref-ref-15-2 xref-ref-15-3"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.15" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Gabriel Karl Ruben"><given-names>Karl Ruben</given-names> <surname>Gabriel</surname></string-name>. <article-title hwp:id="article-title-15">The biplot graphic display of matrices with application to principal component analysis</article-title>. <source hwp:id="source-15">Biometrika</source>, <volume>58</volume>(<issue>3</issue>):<fpage>453</fpage>–<lpage>467</lpage>, <year>1971</year>.</citation></ref><ref id="c16" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1 xref-ref-16-2"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.16" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Gao Chao"><given-names>Chao</given-names> <surname>Gao</surname></string-name>, <string-name name-style="western" hwp:sortable="Ma Zongming"><given-names>Zongming</given-names> <surname>Ma</surname></string-name>, <string-name name-style="western" hwp:sortable="Zhou Harrison H"><given-names>Harrison H</given-names> <surname>Zhou</surname></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-16">Sparse CCA: Adaptive estimation and computational barriers</article-title>. <source hwp:id="source-16">The Annals of Statistics</source>, <volume>45</volume>(<issue>5</issue>):<fpage>2074</fpage>–<lpage>2101</lpage>, <year>2017</year>.</citation></ref><ref id="c17" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1 xref-ref-17-2"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.17" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="González Ignacio"><given-names>Ignacio</given-names> <surname>González</surname></string-name>, <string-name name-style="western" hwp:sortable="Déjean Sébastien"><given-names>Sébastien</given-names> <surname>Déjean</surname></string-name>, <string-name name-style="western" hwp:sortable="Martin Pascal GP"><given-names>Pascal GP</given-names> <surname>Martin</surname></string-name>, <string-name name-style="western" hwp:sortable="Baccini Alain"><given-names>Alain</given-names> <surname>Baccini</surname></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-17">CCA: An R package to extend canonical correlation analysis</article-title>. <source hwp:id="source-17">Journal of Statistical Software</source>, <volume>23</volume>(<issue>12</issue>):<fpage>1</fpage>–<lpage>14</lpage>, <year>2008</year>.</citation></ref><ref id="c18" hwp:id="ref-18" hwp:rev-id="xref-ref-18-1 xref-ref-18-2"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.18" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-18"><string-name name-style="western" hwp:sortable="González Ignacio"><given-names>Ignacio</given-names> <surname>González</surname></string-name>, <string-name name-style="western" hwp:sortable="Déjean Sébastien"><given-names>Sébastien</given-names> <surname>Déjean</surname></string-name>, <string-name name-style="western" hwp:sortable="Martin Pascal GP"><given-names>Pascal GP</given-names> <surname>Martin</surname></string-name>, <string-name name-style="western" hwp:sortable="Gonçalves Olivier"><given-names>Olivier</given-names> <surname>Gonçalves</surname></string-name>, <string-name name-style="western" hwp:sortable="Besse Philippe"><given-names>Philippe</given-names> <surname>Besse</surname></string-name>, and <string-name name-style="western" hwp:sortable="Baccini Alain"><given-names>Alain</given-names> <surname>Baccini</surname></string-name>. <article-title hwp:id="article-title-18">Highlighting relationships between heterogeneous biological data through graphical displays based on regularized canonical correlation analysis</article-title>. <source hwp:id="source-18">Journal of Biological Systems</source>, <volume>17</volume>(<issue>02</issue>):<fpage>173</fpage>–<lpage>199</lpage>, <year>2009</year>.</citation></ref><ref id="c19" hwp:id="ref-19" hwp:rev-id="xref-ref-19-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.19" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-19"><string-name name-style="western" hwp:sortable="González Ignacio"><given-names>Ignacio</given-names> <surname>González</surname></string-name>, <string-name name-style="western" hwp:sortable="Cao Kim-Anh Lê"><given-names>Kim-Anh Lê</given-names> <surname>Cao</surname></string-name>, <string-name name-style="western" hwp:sortable="Davis Melissa J"><given-names>Melissa J</given-names> <surname>Davis</surname></string-name>, and <string-name name-style="western" hwp:sortable="Déjean Sébastien"><given-names>Sébastien</given-names> <surname>Déjean</surname></string-name>. <article-title hwp:id="article-title-19">Visualising associations between paired ‘omics’ data sets</article-title>. <source hwp:id="source-19">BioData Mining</source>, <volume>5</volume>(<issue>1</issue>):<fpage>19</fpage>, <year>2012</year>.</citation></ref><ref id="c20" hwp:id="ref-20" hwp:rev-id="xref-ref-20-1 xref-ref-20-2"><citation publication-type="book" citation-type="book" ref:id="302208v3.20" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-20"><string-name name-style="western" hwp:sortable="Gower John C"><given-names>John C</given-names> <surname>Gower</surname></string-name> and <string-name name-style="western" hwp:sortable="Dijksterhuis Garmt B"><given-names>Garmt B</given-names> <surname>Dijksterhuis</surname></string-name>. <source hwp:id="source-20">Procrustes problems</source>, volume <volume>30</volume>. <publisher-name>Oxford University Press on Demand</publisher-name>, <year>2004</year>.</citation></ref><ref id="c21" hwp:id="ref-21" hwp:rev-id="xref-ref-21-1 xref-ref-21-2"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.21" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-21"><string-name name-style="western" hwp:sortable="Hardoon David R"><given-names>David R</given-names> <surname>Hardoon</surname></string-name> and <string-name name-style="western" hwp:sortable="Shawe-Taylor John"><given-names>John</given-names> <surname>Shawe-Taylor</surname></string-name>. <article-title hwp:id="article-title-20">Sparse canonical correlation analysis</article-title>. <source hwp:id="source-21">Machine Learning</source>, <volume>83</volume>(<issue>3</issue>): <fpage>331</fpage>–<lpage>353</lpage>, <year>2011</year>.</citation></ref><ref id="c22" hwp:id="ref-22" hwp:rev-id="xref-ref-22-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.22" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-22"><string-name name-style="western" hwp:sortable="Harris Kenneth D"><given-names>Kenneth D</given-names> <surname>Harris</surname></string-name>, <string-name name-style="western" hwp:sortable="Hochgerner Hannah"><given-names>Hannah</given-names> <surname>Hochgerner</surname></string-name>, <string-name name-style="western" hwp:sortable="Skene Nathan G"><given-names>Nathan G</given-names> <surname>Skene</surname></string-name>, <string-name name-style="western" hwp:sortable="Magno Lorenza"><given-names>Lorenza</given-names> <surname>Magno</surname></string-name>, <string-name name-style="western" hwp:sortable="Katona Linda"><given-names>Linda</given-names> <surname>Katona</surname></string-name>, <string-name name-style="western" hwp:sortable="Gonzales Carolina Bengtsson"><given-names>Carolina Bengtsson</given-names> <surname>Gonzales</surname></string-name>, <string-name name-style="western" hwp:sortable="Somogyi Peter"><given-names>Peter</given-names> <surname>Somogyi</surname></string-name>, <string-name name-style="western" hwp:sortable="Kessaris Nicoletta"><given-names>Nicoletta</given-names> <surname>Kessaris</surname></string-name>, <string-name name-style="western" hwp:sortable="Linnarsson Sten"><given-names>Sten</given-names> <surname>Linnarsson</surname></string-name>, and <string-name name-style="western" hwp:sortable="Hjerling-Leffler Jens"><given-names>Jens</given-names> <surname>Hjerling-Leffler</surname></string-name>. <article-title hwp:id="article-title-21">Classes and continua of hippocampal CA1 inhibitory neurons revealed by single-cell transcriptomics</article-title>. <source hwp:id="source-22">PLoS Biology</source>, <volume>16</volume>(<issue>6</issue>):<fpage>e2006387</fpage>, <year>2018</year>.</citation></ref><ref id="c23" hwp:id="ref-23" hwp:rev-id="xref-ref-23-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.23" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-23"><string-name name-style="western" hwp:sortable="Izenman Alan Julian"><given-names>Alan Julian</given-names> <surname>Izenman</surname></string-name>. <article-title hwp:id="article-title-22">Reduced-rank regression for the multivariate linear model</article-title>. <source hwp:id="source-23">Journal of Multivariate Analysis</source>, <volume>5</volume>(<issue>2</issue>):<fpage>248</fpage>–<lpage>264</lpage>, <year>1975</year>.</citation></ref><ref id="c24" hwp:id="ref-24" hwp:rev-id="xref-ref-24-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.24" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-24"><string-name name-style="western" hwp:sortable="Kobak Dmitry"><given-names>Dmitry</given-names> <surname>Kobak</surname></string-name> and <string-name name-style="western" hwp:sortable="Berens Philipp"><given-names>Philipp</given-names> <surname>Berens</surname></string-name>. <article-title hwp:id="article-title-23">The art of using t-SNE for single-cell transcriptomics</article-title>. <source hwp:id="source-24">Nature Communications</source>, <volume>10</volume>:<fpage>5416</fpage>, <year>2019</year>.</citation></ref><ref id="c25" hwp:id="ref-25" hwp:rev-id="xref-ref-25-1 xref-ref-25-2"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.25" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-25"><string-name name-style="western" hwp:sortable="Cao Kim-Anh Lê"><given-names>Kim-Anh Lê</given-names> <surname>Cao</surname></string-name>, <string-name name-style="western" hwp:sortable="Rossouw Debra"><given-names>Debra</given-names> <surname>Rossouw</surname></string-name>, <string-name name-style="western" hwp:sortable="Robert-Granié Christele"><given-names>Christele</given-names> <surname>Robert-Granié</surname></string-name>, and <string-name name-style="western" hwp:sortable="Besse Philippe"><given-names>Philippe</given-names> <surname>Besse</surname></string-name>. <article-title hwp:id="article-title-24">A sparse PLS for variable selection when integrating omics data</article-title>. <source hwp:id="source-25">Statistical Applications in Genetics and Molecular Biology</source>, <volume>7</volume>(<issue>1</issue>), <year>2008</year>.</citation></ref><ref id="c26" hwp:id="ref-26" hwp:rev-id="xref-ref-26-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.26" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-26"><string-name name-style="western" hwp:sortable="Cao Kim-Anh Lê"><given-names>Kim-Anh Lê</given-names> <surname>Cao</surname></string-name>, <string-name name-style="western" hwp:sortable="Martin Pascal GP"><given-names>Pascal GP</given-names> <surname>Martin</surname></string-name>, <string-name name-style="western" hwp:sortable="Robert-Granié Christèle"><given-names>Christèle</given-names> <surname>Robert-Granié</surname></string-name>, and <string-name name-style="western" hwp:sortable="Besse Philippe"><given-names>Philippe</given-names> <surname>Besse</surname></string-name>. <article-title hwp:id="article-title-25">Sparse canonical methods for biological data integration: application to a cross-platform study</article-title>. <source hwp:id="source-26">BMC Bioinformatics</source>, <volume>10</volume>(<issue>1</issue>):<fpage>34</fpage>, <year>2009</year>.</citation></ref><ref id="c27" hwp:id="ref-27" hwp:rev-id="xref-ref-27-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.27" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-27"><string-name name-style="western" hwp:sortable="Cao Kim-Anh Lê"><given-names>Kim-Anh Lê</given-names> <surname>Cao</surname></string-name>, <string-name name-style="western" hwp:sortable="Boitard Simon"><given-names>Simon</given-names> <surname>Boitard</surname></string-name>, and <string-name name-style="western" hwp:sortable="Besse Philippe"><given-names>Philippe</given-names> <surname>Besse</surname></string-name>. <article-title hwp:id="article-title-26">Sparse PLS discriminant analysis: biologically relevant feature selection and graphical displays for multiclass problems</article-title>. <source hwp:id="source-27">BMC Bioinformatics</source>, <volume>12</volume>(<issue>1</issue>):<fpage>253</fpage>, <year>2011</year>.</citation></ref><ref id="c28" hwp:id="ref-28" hwp:rev-id="xref-ref-28-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.28" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-28"><string-name name-style="western" hwp:sortable="Lein Ed"><given-names>Ed</given-names> <surname>Lein</surname></string-name>, <string-name name-style="western" hwp:sortable="Borm Lars E"><given-names>Lars E</given-names> <surname>Borm</surname></string-name>, and <string-name name-style="western" hwp:sortable="Linnarsson Sten"><given-names>Sten</given-names> <surname>Linnarsson</surname></string-name>. <article-title hwp:id="article-title-27">The promise of spatial transcriptomics for neuroscience in the era of molecular cell typing</article-title>. <source hwp:id="source-28">Science</source>, <volume>358</volume>(<issue>6359</issue>):<fpage>64</fpage>–<lpage>69</lpage>, <year>2017</year>.</citation></ref><ref id="c29" hwp:id="ref-29" hwp:rev-id="xref-ref-29-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.29" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-29"><string-name name-style="western" hwp:sortable="Luecken Malte D"><given-names>Malte D</given-names> <surname>Luecken</surname></string-name> and <string-name name-style="western" hwp:sortable="Theis Fabian J"><given-names>Fabian J</given-names> <surname>Theis</surname></string-name>. <article-title hwp:id="article-title-28">Current best practices in single-cell RNA-seq analysis: a tutorial</article-title>. <source hwp:id="source-29">Molecular Systems Biology</source>, <volume>15</volume>(<issue>6</issue>), <year>2019</year>.</citation></ref><ref id="c30" hwp:id="ref-30" hwp:rev-id="xref-ref-30-1 xref-ref-30-2"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.30" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-30"><string-name name-style="western" hwp:sortable="Lykou Anastasia"><given-names>Anastasia</given-names> <surname>Lykou</surname></string-name> and <string-name name-style="western" hwp:sortable="Whittaker Joe"><given-names>Joe</given-names> <surname>Whittaker</surname></string-name>. <article-title hwp:id="article-title-29">Sparse CCA using a lasso with positivity constraints</article-title>. <source hwp:id="source-30">Computational Statistics &amp; Data Analysis</source>, <volume>54</volume>(<issue>12</issue>):<fpage>3144</fpage>–<lpage>3157</lpage>, <year>2010</year>.</citation></ref><ref id="c31" hwp:id="ref-31" hwp:rev-id="xref-ref-31-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.31" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-31"><string-name name-style="western" hwp:sortable="Macosko Evan Z"><given-names>Evan Z</given-names> <surname>Macosko</surname></string-name>, <string-name name-style="western" hwp:sortable="Basu Anindita"><given-names>Anindita</given-names> <surname>Basu</surname></string-name>, <string-name name-style="western" hwp:sortable="Satija Rahul"><given-names>Rahul</given-names> <surname>Satija</surname></string-name>, <string-name name-style="western" hwp:sortable="Nemesh James"><given-names>James</given-names> <surname>Nemesh</surname></string-name>, <string-name name-style="western" hwp:sortable="Shekhar Karthik"><given-names>Karthik</given-names> <surname>Shekhar</surname></string-name>, <string-name name-style="western" hwp:sortable="Goldman Melissa"><given-names>Melissa</given-names> <surname>Goldman</surname></string-name>, <string-name name-style="western" hwp:sortable="Tirosh Itay"><given-names>Itay</given-names> <surname>Tirosh</surname></string-name>, <string-name name-style="western" hwp:sortable="Bialas Allison R"><given-names>Allison R</given-names> <surname>Bialas</surname></string-name>, <string-name name-style="western" hwp:sortable="Kamitaki Nolan"><given-names>Nolan</given-names> <surname>Kamitaki</surname></string-name>, <string-name name-style="western" hwp:sortable="Martersteck Emily M"><given-names>Emily M</given-names> <surname>Martersteck</surname></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-30">Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>. <source hwp:id="source-31">Cell</source>, <volume>161</volume>(<issue>5</issue>):<fpage>1202</fpage>–<lpage>1214</lpage>, <year>2015</year>.</citation></ref><ref id="c32" hwp:id="ref-32" hwp:rev-id="xref-ref-32-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.32" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-32"><string-name name-style="western" hwp:sortable="Masland Richard H"><given-names>Richard H</given-names> <surname>Masland</surname></string-name>. <article-title hwp:id="article-title-31">Neuronal cell types</article-title>. <source hwp:id="source-32">Current Biology</source>, <volume>14</volume>(<issue>13</issue>):<fpage>R497</fpage>–<lpage>R500</lpage>, <year>2004</year>.</citation></ref><ref id="c33" hwp:id="ref-33" hwp:rev-id="xref-ref-33-1 xref-ref-33-2 xref-ref-33-3 xref-ref-33-4"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.33" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-33"><string-name name-style="western" hwp:sortable="Meinshausen Nicolai"><given-names>Nicolai</given-names> <surname>Meinshausen</surname></string-name>. <article-title hwp:id="article-title-32">Relaxed lasso</article-title>. <source hwp:id="source-33">Computational Statistics &amp; Data Analysis</source>, <volume>52</volume>(<issue>1</issue>):<fpage>374</fpage>–<lpage>393</lpage>, <year>2007</year>.</citation></ref><ref id="c34" hwp:id="ref-34" hwp:rev-id="xref-ref-34-1 xref-ref-34-2"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.34" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-34"><string-name name-style="western" hwp:sortable="Parkhomenko Elena"><given-names>Elena</given-names> <surname>Parkhomenko</surname></string-name>, <string-name name-style="western" hwp:sortable="Tritchler David"><given-names>David</given-names> <surname>Tritchler</surname></string-name>, and <string-name name-style="western" hwp:sortable="Beyene Joseph"><given-names>Joseph</given-names> <surname>Beyene</surname></string-name>. <article-title hwp:id="article-title-33">Sparse canonical correlation analysis with application to genomic data integration</article-title>. <source hwp:id="source-34">Statistical Applications in Genetics and Molecular Biology</source>, <volume>8</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>34</lpage>, <year>2009</year>.</citation></ref><ref id="c35" hwp:id="ref-35" hwp:rev-id="xref-ref-35-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.35" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-35"><string-name name-style="western" hwp:sortable="Poulin Jean-Francois"><given-names>Jean-Francois</given-names> <surname>Poulin</surname></string-name>, <string-name name-style="western" hwp:sortable="Tasic Bosiljka"><given-names>Bosiljka</given-names> <surname>Tasic</surname></string-name>, <string-name name-style="western" hwp:sortable="Hjerling-Leffler Jens"><given-names>Jens</given-names> <surname>Hjerling-Leffler</surname></string-name>, <string-name name-style="western" hwp:sortable="Trimarchi Jeffrey M"><given-names>Jeffrey M</given-names> <surname>Trimarchi</surname></string-name>, and <string-name name-style="western" hwp:sortable="Awatramani Rajeshwar"><given-names>Rajeshwar</given-names> <surname>Awatramani</surname></string-name>. <article-title hwp:id="article-title-34">Disentangling neural cell diversity using single-cell transcriptomics</article-title>. <source hwp:id="source-35">Nature Neuroscience</source>, <volume>19</volume>(<issue>9</issue>):<fpage>1131</fpage>, <year>2016</year>.</citation></ref><ref id="c36" hwp:id="ref-36" hwp:rev-id="xref-ref-36-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.36" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-36"><string-name name-style="western" hwp:sortable="Ramette Alban"><given-names>Alban</given-names> <surname>Ramette</surname></string-name>. <article-title hwp:id="article-title-35">Multivariate analyses in microbial ecology</article-title>. <source hwp:id="source-36">FEMS Microbiology Ecology</source>, <volume>62</volume>(<issue>2</issue>):<fpage>142</fpage>–<lpage>160</lpage>, <year>2007</year>.</citation></ref><ref id="c37" hwp:id="ref-37" hwp:rev-id="xref-ref-37-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.37" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-37"><string-name name-style="western" hwp:sortable="Rohart Florian"><given-names>Florian</given-names> <surname>Rohart</surname></string-name>, <string-name name-style="western" hwp:sortable="Gautier Benoit"><given-names>Benoit</given-names> <surname>Gautier</surname></string-name>, <string-name name-style="western" hwp:sortable="Singh Amrit"><given-names>Amrit</given-names> <surname>Singh</surname></string-name>, and <string-name name-style="western" hwp:sortable="Cao Kim-Anh Lê"><given-names>Kim-Anh Lê</given-names> <surname>Cao</surname></string-name>. <article-title hwp:id="article-title-36">mixOmics: An R package for ‘omics feature selection and multiple data integration</article-title>. <source hwp:id="source-37">PLoS Computational Biology</source>, <volume>13</volume>(<issue>11</issue>):<fpage>e1005752</fpage>, <year>2017</year>.</citation></ref><ref id="c38" hwp:id="ref-38" hwp:rev-id="xref-ref-38-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.38" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-38"><string-name name-style="western" hwp:sortable="Saunders Arpiar"><given-names>Arpiar</given-names> <surname>Saunders</surname></string-name>, <string-name name-style="western" hwp:sortable="Macosko Evan Z"><given-names>Evan Z</given-names> <surname>Macosko</surname></string-name>, <string-name name-style="western" hwp:sortable="Wysoker Alec"><given-names>Alec</given-names> <surname>Wysoker</surname></string-name>, <string-name name-style="western" hwp:sortable="Goldman Melissa"><given-names>Melissa</given-names> <surname>Goldman</surname></string-name>, <string-name name-style="western" hwp:sortable="Krienen Fenna M"><given-names>Fenna M</given-names> <surname>Krienen</surname></string-name>, <string-name name-style="western" hwp:sortable="de Rivera Heather"><given-names>Heather</given-names> <surname>de Rivera</surname></string-name>, <string-name name-style="western" hwp:sortable="Bien Elizabeth"><given-names>Elizabeth</given-names> <surname>Bien</surname></string-name>, <string-name name-style="western" hwp:sortable="Baum Matthew"><given-names>Matthew</given-names> <surname>Baum</surname></string-name>, <string-name name-style="western" hwp:sortable="Bortolin Laura"><given-names>Laura</given-names> <surname>Bortolin</surname></string-name>, <string-name name-style="western" hwp:sortable="Wang Shuyu"><given-names>Shuyu</given-names> <surname>Wang</surname></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-37">Molecular diversity and specializations among the cells of the adult mouse brain</article-title>. <source hwp:id="source-38">Cell</source>, <volume>174</volume>(<issue>4</issue>):<fpage>1015</fpage>–<lpage>1030</lpage>, <year>2018</year>.</citation></ref><ref id="c39" hwp:id="ref-39" hwp:rev-id="xref-ref-39-1 xref-ref-39-2 xref-ref-39-3"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.39" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-39"><string-name name-style="western" hwp:sortable="Scala Federico"><given-names>Federico</given-names> <surname>Scala</surname></string-name>, <string-name name-style="western" hwp:sortable="Kobak Dmitry"><given-names>Dmitry</given-names> <surname>Kobak</surname></string-name>, <string-name name-style="western" hwp:sortable="Shan Shen"><given-names>Shen</given-names> <surname>Shan</surname></string-name>, <string-name name-style="western" hwp:sortable="Bernaerts Yves"><given-names>Yves</given-names> <surname>Bernaerts</surname></string-name>, <string-name name-style="western" hwp:sortable="Laturnus Sophie"><given-names>Sophie</given-names> <surname>Laturnus</surname></string-name>, <string-name name-style="western" hwp:sortable="Cadwell Cathryn Rene"><given-names>Cathryn Rene</given-names> <surname>Cadwell</surname></string-name>, <string-name name-style="western" hwp:sortable="Hartmanis Leonard"><given-names>Leonard</given-names> <surname>Hartmanis</surname></string-name>, <string-name name-style="western" hwp:sortable="Froudarakis Emmanouil"><given-names>Emmanouil</given-names> <surname>Froudarakis</surname></string-name>, <string-name name-style="western" hwp:sortable="Castro Jesus Ramon"><given-names>Jesus Ramon</given-names> <surname>Castro</surname></string-name>, <string-name name-style="western" hwp:sortable="Tan Zheng Huan"><given-names>Zheng Huan</given-names> <surname>Tan</surname></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-38">Layer 4 of mouse neocortex differs in cell types and circuit organization between sensory areas</article-title>. <source hwp:id="source-39">Nature Communications</source>, <volume>10</volume>:<fpage>4174</fpage>, <year>2019</year>.</citation></ref><ref id="c40" hwp:id="ref-40" hwp:rev-id="xref-ref-40-1 xref-ref-40-2 xref-ref-40-3 xref-ref-40-4 xref-ref-40-5 xref-ref-40-6"><citation publication-type="other" citation-type="journal" ref:id="302208v3.40" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-40"><string-name name-style="western" hwp:sortable="Scala Federico"><given-names>Federico</given-names> <surname>Scala</surname></string-name>, <string-name name-style="western" hwp:sortable="Kobak Dmitry"><given-names>Dmitry</given-names> <surname>Kobak</surname></string-name>, <string-name name-style="western" hwp:sortable="Bernabucci Matteo"><given-names>Matteo</given-names> <surname>Bernabucci</surname></string-name>, <string-name name-style="western" hwp:sortable="Bernaerts Yves"><given-names>Yves</given-names> <surname>Bernaerts</surname></string-name>, <string-name name-style="western" hwp:sortable="Cadwell Cathryn R"><given-names>Cathryn R</given-names> <surname>Cadwell</surname></string-name>, <string-name name-style="western" hwp:sortable="Castro Jesus R"><given-names>Jesus R</given-names> <surname>Castro</surname></string-name>, <string-name name-style="western" hwp:sortable="Hartmanis Leonard"><given-names>Leonard</given-names> <surname>Hartmanis</surname></string-name>, <string-name name-style="western" hwp:sortable="Jiang Xiaolong"><given-names>Xiaolong</given-names> <surname>Jiang</surname></string-name>, <string-name name-style="western" hwp:sortable="Laturnus Sophie R"><given-names>Sophie R</given-names> <surname>Laturnus</surname></string-name>, <string-name name-style="western" hwp:sortable="Miranda Elanine"><given-names>Elanine</given-names> <surname>Miranda</surname></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-39">Phenotypic variation within and across transcriptomic cell types in mouse motor cortex</article-title>. <source hwp:id="source-40">bioRxiv</source>, <year>2020</year>.</citation></ref><ref id="c41" hwp:id="ref-41" hwp:rev-id="xref-ref-41-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.41" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-41"><string-name name-style="western" hwp:sortable="Shekhar Karthik"><given-names>Karthik</given-names> <surname>Shekhar</surname></string-name>, <string-name name-style="western" hwp:sortable="Lapan Sylvain W"><given-names>Sylvain W</given-names> <surname>Lapan</surname></string-name>, <string-name name-style="western" hwp:sortable="Whitney Irene E"><given-names>Irene E</given-names> <surname>Whitney</surname></string-name>, <string-name name-style="western" hwp:sortable="Tran Nicholas M"><given-names>Nicholas M</given-names> <surname>Tran</surname></string-name>, <string-name name-style="western" hwp:sortable="Macosko Evan Z"><given-names>Evan Z</given-names> <surname>Macosko</surname></string-name>, <string-name name-style="western" hwp:sortable="Kowalczyk Monika"><given-names>Monika</given-names> <surname>Kowalczyk</surname></string-name>, <string-name name-style="western" hwp:sortable="Adiconis Xian"><given-names>Xian</given-names> <surname>Adiconis</surname></string-name>, <string-name name-style="western" hwp:sortable="Levin Joshua Z"><given-names>Joshua Z</given-names> <surname>Levin</surname></string-name>, <string-name name-style="western" hwp:sortable="Nemesh James"><given-names>James</given-names> <surname>Nemesh</surname></string-name>, <string-name name-style="western" hwp:sortable="Goldman Melissa"><given-names>Melissa</given-names> <surname>Goldman</surname></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-40">Comprehensive classification of retinal bipolar neurons by single-cell transcriptomics</article-title>. <source hwp:id="source-41">Cell</source>, <volume>166</volume>(<issue>5</issue>):<fpage>1308</fpage>–<lpage>1323</lpage>, <year>2016</year>.</citation></ref><ref id="c42" hwp:id="ref-42" hwp:rev-id="xref-ref-42-1 xref-ref-42-2 xref-ref-42-3 xref-ref-42-4 xref-ref-42-5"><citation publication-type="other" citation-type="journal" ref:id="302208v3.42" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-42"><string-name name-style="western" hwp:sortable="Suo Xiaotong"><given-names>Xiaotong</given-names> <surname>Suo</surname></string-name>, <string-name name-style="western" hwp:sortable="Minden Victor"><given-names>Victor</given-names> <surname>Minden</surname></string-name>, <string-name name-style="western" hwp:sortable="Nelson Bradley"><given-names>Bradley</given-names> <surname>Nelson</surname></string-name>, <string-name name-style="western" hwp:sortable="Tibshirani Robert"><given-names>Robert</given-names> <surname>Tibshirani</surname></string-name>, and <string-name name-style="western" hwp:sortable="Saunders Michael"><given-names>Michael</given-names> <surname>Saunders</surname></string-name>. <article-title hwp:id="article-title-41">Sparse canonical correlation analysis</article-title>. <source hwp:id="source-42">arXiv</source>, <year>2017</year>.</citation></ref><ref id="c43" hwp:id="ref-43" hwp:rev-id="xref-ref-43-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.43" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-43"><string-name name-style="western" hwp:sortable="Tasic Bosiljka"><given-names>Bosiljka</given-names> <surname>Tasic</surname></string-name>, <string-name name-style="western" hwp:sortable="Menon Vilas"><given-names>Vilas</given-names> <surname>Menon</surname></string-name>, <string-name name-style="western" hwp:sortable="Nguyen Thuc Nghi"><given-names>Thuc Nghi</given-names> <surname>Nguyen</surname></string-name>, <string-name name-style="western" hwp:sortable="Kim Tae Kyung"><given-names>Tae Kyung</given-names> <surname>Kim</surname></string-name>, <string-name name-style="western" hwp:sortable="Jarsky Tim"><given-names>Tim</given-names> <surname>Jarsky</surname></string-name>, <string-name name-style="western" hwp:sortable="Yao Zizhen"><given-names>Zizhen</given-names> <surname>Yao</surname></string-name>, <string-name name-style="western" hwp:sortable="Levi Boaz"><given-names>Boaz</given-names> <surname>Levi</surname></string-name>, <string-name name-style="western" hwp:sortable="Gray Lucas T"><given-names>Lucas T</given-names> <surname>Gray</surname></string-name>, <string-name name-style="western" hwp:sortable="Sorensen Staci A"><given-names>Staci A</given-names> <surname>Sorensen</surname></string-name>, <string-name name-style="western" hwp:sortable="Dolbeare Tim"><given-names>Tim</given-names> <surname>Dolbeare</surname></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-42">Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</article-title>. <source hwp:id="source-43">Nature Neuroscience</source>, <volume>19</volume>(<issue>2</issue>):<fpage>335</fpage>, <year>2016</year>.</citation></ref><ref id="c44" hwp:id="ref-44" hwp:rev-id="xref-ref-44-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.44" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-44"><string-name name-style="western" hwp:sortable="Tasic Bosiljka"><given-names>Bosiljka</given-names> <surname>Tasic</surname></string-name>, <string-name name-style="western" hwp:sortable="Yao Zizhen"><given-names>Zizhen</given-names> <surname>Yao</surname></string-name>, <string-name name-style="western" hwp:sortable="Graybuck Lucas T"><given-names>Lucas T</given-names> <surname>Graybuck</surname></string-name>, <string-name name-style="western" hwp:sortable="Smith Kimberly A"><given-names>Kimberly A</given-names> <surname>Smith</surname></string-name>, <string-name name-style="western" hwp:sortable="Nguyen Thuc Nghi"><given-names>Thuc Nghi</given-names> <surname>Nguyen</surname></string-name>, <string-name name-style="western" hwp:sortable="Bertagnolli Darren"><given-names>Darren</given-names> <surname>Bertagnolli</surname></string-name>, <string-name name-style="western" hwp:sortable="Goldy Jeff"><given-names>Jeff</given-names> <surname>Goldy</surname></string-name>, <string-name name-style="western" hwp:sortable="Garren Emma"><given-names>Emma</given-names> <surname>Garren</surname></string-name>, <string-name name-style="western" hwp:sortable="Economo Michael N"><given-names>Michael N</given-names> <surname>Economo</surname></string-name>, <string-name name-style="western" hwp:sortable="Viswanathan Sarada"><given-names>Sarada</given-names> <surname>Viswanathan</surname></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-43">Shared and distinct transcriptomic cell types across neocortical areas</article-title>. <source hwp:id="source-44">Nature</source>, <volume>563</volume>(<issue>7729</issue>):<fpage>72</fpage>, <year>2018</year>.</citation></ref><ref id="c45" hwp:id="ref-45" hwp:rev-id="xref-ref-45-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.45" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-45"><string-name name-style="western" hwp:sortable="Braak Cajo JF Ter"><given-names>Cajo JF Ter</given-names> <surname>Braak</surname></string-name>. <article-title hwp:id="article-title-44">Canonical community ordination. part i: Basic theory and linear methods</article-title>. <source hwp:id="source-45">Ecoscience</source>, <volume>1</volume> (<issue>2</issue>):<fpage>127</fpage>–<lpage>140</lpage>, <year>1994</year>.</citation></ref><ref id="c46" hwp:id="ref-46" hwp:rev-id="xref-ref-46-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.46" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-46"><string-name name-style="western" hwp:sortable="Tripathy Shreejoy J"><given-names>Shreejoy J</given-names> <surname>Tripathy</surname></string-name>, <string-name name-style="western" hwp:sortable="Toker Lilah"><given-names>Lilah</given-names> <surname>Toker</surname></string-name>, <string-name name-style="western" hwp:sortable="Li Brenna"><given-names>Brenna</given-names> <surname>Li</surname></string-name>, <string-name name-style="western" hwp:sortable="Crichlow Cindy-Lee"><given-names>Cindy-Lee</given-names> <surname>Crichlow</surname></string-name>, <string-name name-style="western" hwp:sortable="Tebaykin Dmitry"><given-names>Dmitry</given-names> <surname>Tebaykin</surname></string-name>, <string-name name-style="western" hwp:sortable="Mancarci B Ogan"><given-names>B Ogan</given-names> <surname>Mancarci</surname></string-name>, and <string-name name-style="western" hwp:sortable="Pavlidis Paul"><given-names>Paul</given-names> <surname>Pavlidis</surname></string-name>. <article-title hwp:id="article-title-45">Transcriptomic correlates of neuron electrophysiological diversity</article-title>. <source hwp:id="source-46">PLoS Computational Biology</source>, <volume>13</volume> (<issue>10</issue>):<fpage>e1005814</fpage>, <year>2017</year>.</citation></ref><ref id="c47" hwp:id="ref-47" hwp:rev-id="xref-ref-47-1"><citation publication-type="book" citation-type="book" ref:id="302208v3.47" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-47"><string-name name-style="western" hwp:sortable="Velu Raja"><given-names>Raja</given-names> <surname>Velu</surname></string-name> and <string-name name-style="western" hwp:sortable="Reinsel Gregory C"><given-names>Gregory C</given-names> <surname>Reinsel</surname></string-name>. <source hwp:id="source-47">Multivariate reduced-rank regression: theory and applications</source>, volume <volume>136</volume>. <publisher-name>Springer Science &amp; Business Media</publisher-name>, <year>2013</year>.</citation></ref><ref id="c48" hwp:id="ref-48" hwp:rev-id="xref-ref-48-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.48" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-48"><string-name name-style="western" hwp:sortable="Waaijenborg Sandra"><given-names>Sandra</given-names> <surname>Waaijenborg</surname></string-name>, <string-name name-style="western" hwp:sortable="Hamer Philip C Verselewel de Witt"><given-names>Philip C Verselewel de Witt</given-names> <surname>Hamer</surname></string-name>, and <string-name name-style="western" hwp:sortable="Zwinderman Aeilko H"><given-names>Aeilko H</given-names> <surname>Zwinderman</surname></string-name>. <article-title hwp:id="article-title-46">Quantifying the association between gene expressions and DNA-markers by penalized canonical correlation analysis</article-title>. <source hwp:id="source-48">Statistical Applications in Genetics and Molecular Biology</source>, <volume>7</volume>(<issue>1</issue>), <year>2008</year>.</citation></ref><ref id="c49" hwp:id="ref-49" hwp:rev-id="xref-ref-49-1 xref-ref-49-2"><citation publication-type="other" citation-type="journal" ref:id="302208v3.49" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-49"><string-name name-style="western" hwp:sortable="Wiesel Ami"><given-names>Ami</given-names> <surname>Wiesel</surname></string-name>, <string-name name-style="western" hwp:sortable="Kliger Mark"><given-names>Mark</given-names> <surname>Kliger</surname></string-name>, and <string-name name-style="western" hwp:sortable="Hero Alfred O III."><given-names>Alfred O</given-names> <surname>Hero</surname> <suffix>III.</suffix></string-name> <article-title hwp:id="article-title-47">A greedy approach to sparse canonical correlation analysis</article-title>. <source hwp:id="source-49">arXiv</source>, <year>2008</year>.</citation></ref><ref id="c50" hwp:id="ref-50" hwp:rev-id="xref-ref-50-1 xref-ref-50-2"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.50" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-50"><string-name name-style="western" hwp:sortable="Wilms Ines"><given-names>Ines</given-names> <surname>Wilms</surname></string-name> and <string-name name-style="western" hwp:sortable="Croux Christophe"><given-names>Christophe</given-names> <surname>Croux</surname></string-name>. <article-title hwp:id="article-title-48">Sparse canonical correlation analysis from a predictive point of view</article-title>. <source hwp:id="source-50">Biometrical Journal</source>, <volume>57</volume>(<issue>5</issue>):<fpage>834</fpage>–<lpage>851</lpage>, <year>2015</year>.</citation></ref><ref id="c51" hwp:id="ref-51" hwp:rev-id="xref-ref-51-1 xref-ref-51-2"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.51" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-51"><string-name name-style="western" hwp:sortable="Witten Daniela M"><given-names>Daniela M</given-names> <surname>Witten</surname></string-name> and <string-name name-style="western" hwp:sortable="Tibshirani Robert J"><given-names>Robert J</given-names> <surname>Tibshirani</surname></string-name>. <article-title hwp:id="article-title-49">Extensions of sparse canonical correlation analysis with applications to genomic data</article-title>. <source hwp:id="source-51">Statistical Applications in Genetics and Molecular Biology</source>, <volume>8</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>27</lpage>, <year>2009</year>.</citation></ref><ref id="c52" hwp:id="ref-52" hwp:rev-id="xref-ref-52-1 xref-ref-52-2 xref-ref-52-3 xref-ref-52-4 xref-ref-52-5"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.52" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-52"><string-name name-style="western" hwp:sortable="Witten Daniela M"><given-names>Daniela M</given-names> <surname>Witten</surname></string-name>, <string-name name-style="western" hwp:sortable="Tibshirani Robert"><given-names>Robert</given-names> <surname>Tibshirani</surname></string-name>, and <string-name name-style="western" hwp:sortable="Hastie Trevor"><given-names>Trevor</given-names> <surname>Hastie</surname></string-name>. <article-title hwp:id="article-title-50">A penalized matrix decomposition, with applications to sparse principal components and canonical correlation analysis</article-title>. <source hwp:id="source-52">Biostatistics</source>, <volume>10</volume>(<issue>3</issue>):<fpage>515</fpage>–<lpage>534</lpage>, <year>2009</year>.</citation></ref><ref id="c53" hwp:id="ref-53" hwp:rev-id="xref-ref-53-1 xref-ref-53-2"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.53" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-53"><string-name name-style="western" hwp:sortable="Xu Huan"><given-names>Huan</given-names> <surname>Xu</surname></string-name>, <string-name name-style="western" hwp:sortable="Caramanis Constantine"><given-names>Constantine</given-names> <surname>Caramanis</surname></string-name>, and <string-name name-style="western" hwp:sortable="Mannor Shie"><given-names>Shie</given-names> <surname>Mannor</surname></string-name>. <article-title hwp:id="article-title-51">Sparse algorithms are not stable: A no-free-lunch theorem</article-title>. <source hwp:id="source-53">IEEE Transactions on Pattern Analysis and Machine Intelligence</source>, <volume>34</volume>(<issue>1</issue>):<fpage>187</fpage>–<lpage>193</lpage>, <year>2011</year>.</citation></ref><ref id="c54" hwp:id="ref-54" hwp:rev-id="xref-ref-54-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.54" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-54"><string-name name-style="western" hwp:sortable="Yuan Ming"><given-names>Ming</given-names> <surname>Yuan</surname></string-name> and <string-name name-style="western" hwp:sortable="Lin Yi"><given-names>Yi</given-names> <surname>Lin</surname></string-name>. <article-title hwp:id="article-title-52">Model selection and estimation in regression with grouped variables</article-title>. <source hwp:id="source-54">Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>, <volume>68</volume>(<issue>1</issue>):<fpage>49</fpage>–<lpage>67</lpage>, <year>2006</year>.</citation></ref><ref id="c55" hwp:id="ref-55" hwp:rev-id="xref-ref-55-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.55" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-55"><string-name name-style="western" hwp:sortable="Zeisel Amit"><given-names>Amit</given-names> <surname>Zeisel</surname></string-name>, <string-name name-style="western" hwp:sortable="Muñoz-Manchado Ana B"><given-names>Ana B</given-names> <surname>Muñoz-Manchado</surname></string-name>, <string-name name-style="western" hwp:sortable="Codeluppi Simone"><given-names>Simone</given-names> <surname>Codeluppi</surname></string-name>, <string-name name-style="western" hwp:sortable="Lönnerberg Peter"><given-names>Peter</given-names> <surname>Lönnerberg</surname></string-name>, <string-name name-style="western" hwp:sortable="Manno Gioele La"><given-names>Gioele La</given-names> <surname>Manno</surname></string-name>, <string-name name-style="western" hwp:sortable="Juréus Anna"><given-names>Anna</given-names> <surname>Juréus</surname></string-name>, <string-name name-style="western" hwp:sortable="Marques Sueli"><given-names>Sueli</given-names> <surname>Marques</surname></string-name>, <string-name name-style="western" hwp:sortable="Munguba Hermany"><given-names>Hermany</given-names> <surname>Munguba</surname></string-name>, <string-name name-style="western" hwp:sortable="He Liqun"><given-names>Liqun</given-names> <surname>He</surname></string-name>, <string-name name-style="western" hwp:sortable="Betsholtz Christer"><given-names>Christer</given-names> <surname>Betsholtz</surname></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-53">Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>. <source hwp:id="source-55">Science</source>, <volume>347</volume>(<issue>6226</issue>):<fpage>1138</fpage>–<lpage>1142</lpage>, <year>2015</year>.</citation></ref><ref id="c56" hwp:id="ref-56" hwp:rev-id="xref-ref-56-1"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.56" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-56"><string-name name-style="western" hwp:sortable="Zeisel Amit"><given-names>Amit</given-names> <surname>Zeisel</surname></string-name>, <string-name name-style="western" hwp:sortable="Hochgerner Hannah"><given-names>Hannah</given-names> <surname>Hochgerner</surname></string-name>, <string-name name-style="western" hwp:sortable="Lonnerberg Peter"><given-names>Peter</given-names> <surname>Lonnerberg</surname></string-name>, <string-name name-style="western" hwp:sortable="Johnsson Anna"><given-names>Anna</given-names> <surname>Johnsson</surname></string-name>, <string-name name-style="western" hwp:sortable="Memic Fatima"><given-names>Fatima</given-names> <surname>Memic</surname></string-name>, <string-name name-style="western" hwp:sortable="van der Zwan Job"><given-names>Job</given-names> <surname>van der Zwan</surname></string-name>, <string-name name-style="western" hwp:sortable="Haring Martin"><given-names>Martin</given-names> <surname>Haring</surname></string-name>, <string-name name-style="western" hwp:sortable="Braun Emelie"><given-names>Emelie</given-names> <surname>Braun</surname></string-name>, <string-name name-style="western" hwp:sortable="Borm Lars"><given-names>Lars</given-names> <surname>Borm</surname></string-name>, <string-name name-style="western" hwp:sortable="Manno Gioele La"><given-names>Gioele La</given-names> <surname>Manno</surname></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-54">Molecular architecture of the mouse nervous system</article-title>. <source hwp:id="source-56">Cell</source>, <volume>174</volume>(<issue>4</issue>):<fpage>999</fpage>–<lpage>1014</lpage>, <year>2018</year>.</citation></ref><ref id="c57" hwp:id="ref-57" hwp:rev-id="xref-ref-57-1 xref-ref-57-2"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.57" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-57"><string-name name-style="western" hwp:sortable="Zeng Hongkui"><given-names>Hongkui</given-names> <surname>Zeng</surname></string-name> and <string-name name-style="western" hwp:sortable="Sanes Joshua R"><given-names>Joshua R</given-names> <surname>Sanes</surname></string-name>. <article-title hwp:id="article-title-55">Neuronal cell-type classification: challenges, opportunities and the path forward</article-title>. <source hwp:id="source-57">Nature Reviews Neuroscience</source>, <volume>18</volume>(<issue>9</issue>):<fpage>530</fpage>, <year>2017</year>.</citation></ref><ref id="c58" hwp:id="ref-58" hwp:rev-id="xref-ref-58-1 xref-ref-58-2 xref-ref-58-3 xref-ref-58-4 xref-ref-58-5 xref-ref-58-6"><citation publication-type="journal" citation-type="journal" ref:id="302208v3.58" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-58"><string-name name-style="western" hwp:sortable="Zou Hui"><given-names>Hui</given-names> <surname>Zou</surname></string-name> and <string-name name-style="western" hwp:sortable="Hastie Trevor"><given-names>Trevor</given-names> <surname>Hastie</surname></string-name>. <article-title hwp:id="article-title-56">Regularization and variable selection via the elastic net</article-title>. <source hwp:id="source-58">Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>, <volume>67</volume>(<issue>2</issue>):<fpage>301</fpage>–<lpage>320</lpage>, <year>2005</year>.</citation></ref></ref-list><fn-group hwp:id="fn-group-1"><fn id="fn1" hwp:id="fn-1" hwp:rev-id="xref-fn-1-1"><label><sup>1</sup></label><p hwp:id="p-78">In some related previous work (<xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-2" hwp:rel-id="ref-17">González et al., 2008</xref>, <xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-2" hwp:rel-id="ref-18">2009</xref>), cross-validated correlations were computed by pooling test set points across all cross-validation splits. We observed that this procedure can sometimes yield biased results; we compute test-set correlation within each test set, and then average across CV splits.</p></fn></fn-group></back></article>
