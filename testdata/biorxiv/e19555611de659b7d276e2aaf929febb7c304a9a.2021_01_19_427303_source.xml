<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/2021.01.19.427303</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;2021.01.19.427303v3</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;2021.01.19.427303</article-id><article-id pub-id-type="other" hwp:sub-type="slug">2021.01.19.427303</article-id><article-id pub-id-type="other" hwp:sub-type="atom-slug">2021.01.19.427303</article-id><article-id pub-id-type="other" hwp:sub-type="tag">2021.01.19.427303</article-id><article-version>1.3</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Bioinformatics" hwp:journal="biorxiv"><subject>Bioinformatics</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">Discovering Rare Cell Types through Information-based Dimensionality Reduction</article-title></title-group><author-notes hwp:id="author-notes-1"><corresp id="cor1" hwp:id="corresp-1" hwp:rev-id="xref-corresp-1-1"><label>*</label>Correspondence: <email hwp:id="email-1">bab@mit.edu</email></corresp></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><name name-style="western" hwp:sortable="DeMeo Benjamin"><surname>DeMeo</surname><given-names>Benjamin</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-1" hwp:rel-id="aff-2">2</xref><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-1" hwp:rel-id="aff-3">3</xref></contrib><contrib contrib-type="author" corresp="yes" hwp:id="contrib-2"><name name-style="western" hwp:sortable="Berger Bonnie"><surname>Berger</surname><given-names>Bonnie</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-2" hwp:rel-id="aff-3">3</xref><xref ref-type="corresp" rid="cor1" hwp:id="xref-corresp-1-1" hwp:rel-id="corresp-1">*</xref></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2"><label>1</label><institution hwp:id="institution-1">Computer Science and Artificial Intelligence Laboratory, MIT</institution>, Cambridge, MA 02139, <country>USA</country></aff><aff id="a2" hwp:id="aff-2" hwp:rev-id="xref-aff-2-1"><label>2</label><institution hwp:id="institution-2">Department of Biomedical Informatics, Harvard University</institution>, Cambridge, MA 02138, <country>USA</country></aff><aff id="a3" hwp:id="aff-3" hwp:rev-id="xref-aff-3-1 xref-aff-3-2"><label>3</label><institution hwp:id="institution-3">Department of Mathematics, MIT</institution>, Cambridge, MA 02139, <country>USA</country></aff></contrib-group><pub-date pub-type="epub-original" date-type="pub" publication-format="electronic" hwp:start="2021"><year>2021</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2021-01-20T00:15:45-08:00">
    <day>20</day><month>1</month><year>2021</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2021-10-26T19:09:24-07:00">
    <day>26</day><month>10</month><year>2021</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2021-01-20T00:18:54-08:00">
    <day>20</day><month>1</month><year>2021</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2021-10-26T19:15:26-07:00">
    <day>26</day><month>10</month><year>2021</year>
  </pub-date><elocation-id>2021.01.19.427303</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2021-01-19"><day>19</day><month>1</month><year>2021</year></date>
<date date-type="rev-recd" hwp:start="2021-10-26"><day>26</day><month>10</month><year>2021</year></date>
<date date-type="accepted" hwp:start="2021-10-26"><day>26</day><month>10</month><year>2021</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2021, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2021</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/" hwp:id="license-1"><p hwp:id="p-1">This pre-print is available under a Creative Commons License (Attribution-NonCommercial-NoDerivs 4.0 International), CC BY-NC-ND 4.0, as described at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://creativecommons.org/licenses/by-nc-nd/4.0/" ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/" hwp:id="ext-link-1">http://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link></p></license></permissions><self-uri xlink:href="427303.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/change-list" xlink:role="change-list" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/external-links" xlink:role="external-links" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2021/pdf/2021.01.19.427303v3.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="427303.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2021/abstracts/2021.01.19.427303v3/2021.01.19.427303v3.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2021/fulltext/2021.01.19.427303v3/2021.01.19.427303v3.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><p hwp:id="p-2">Dimensionality reduction is crucial to summarizing the complex transcriptomic landscape of single cell datasets for downstream analyses. However, current dimensionality reduction approaches favor large cellular populations defined by many genes, at the expense of smaller and more subtly-defined populations. Here, we present Shannon component analysis (SCA), a technique that leverages the information-theoretic notion of <italic toggle="yes">surprisal</italic> for dimensionality reduction, and demonstrate its ability to improve the representation of clinically important populations that are indistinguishable using existing pipelines. For example, in cytotoxic T-cell data, SCA cleanly separates the gamma-delta and MAIT cell subpopulations, which are not detectable via PCA, ICA, scVI, or a wide array of specialized rare cell recovery tools. We also show that SCA improves downstream imputation to more accurately restore dropouts and recover important gene-gene relationships. SCA’s information-theoretic paradigm opens the door to more meaningful signal extraction, with broad applications to the study of complex biological tissues in health and disease.</p></abstract><counts><page-count count="31"/></counts><custom-meta-wrap><custom-meta hwp:id="custom-meta-1"><meta-name>special-property</meta-name><meta-value>contains-inline-supplementary-material</meta-value></custom-meta></custom-meta-wrap><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-2">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta><notes hwp:id="notes-1"><notes notes-type="competing-interest-statement" hwp:id="notes-2"><title hwp:id="title-2">Competing Interest Statement</title><p hwp:id="p-3">The authors have declared no competing interest.</p></notes><fn-group content-type="summary-of-updates" hwp:id="fn-group-1"><title hwp:id="title-3">Summary of Updates:</title><fn fn-type="update" hwp:id="fn-1"><p hwp:id="p-4">Updated and expanded benchmarks; added robustness analysis; added imputation results; added additional figures; added algorithm boxes; improved memory efficiency; improved clarity; added comprehensive documentation.</p></fn></fn-group><fn-group content-type="external-links" hwp:id="fn-group-2"><fn fn-type="dataset" hwp:id="fn-2"><p hwp:id="p-5">
<ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/bendemeo/sca" ext-link-type="uri" xlink:href="https://github.com/bendemeo/sca" hwp:id="ext-link-2">https://github.com/bendemeo/sca</ext-link>
</p></fn><fn fn-type="dataset" hwp:id="fn-3"><p hwp:id="p-6">
<ext-link l:rel="related" l:ref-type="uri" l:ref="https://shannonca.readthedocs.io" ext-link-type="uri" xlink:href="https://shannonca.readthedocs.io" hwp:id="ext-link-3">https://shannonca.readthedocs.io</ext-link>
</p></fn><fn fn-type="dataset" hwp:id="fn-4"><p hwp:id="p-7">
<ext-link l:rel="related" l:ref-type="uri" l:ref="https://cb.csail.mit.edu/cb/sca/" ext-link-type="uri" xlink:href="https://cb.csail.mit.edu/cb/sca/" hwp:id="ext-link-4">https://cb.csail.mit.edu/cb/sca/</ext-link>
</p></fn></fn-group></notes></front><body><sec id="s1" hwp:id="sec-1"><title hwp:id="title-4">Introduction</title><p hwp:id="p-8">Single-cell RNA sequencing (scRNA-seq) produces transcript counts for individual cells, enabling fine-grained analyses of biological tissues. In particular, single-cell datasets can uncover cellular populations that play critical roles in biological and pathological phenomena [<xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">1</xref>, <xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">2</xref>], and identifying and characterizing these populations is a key motivator of many single-cell experiments.</p><p hwp:id="p-9">However, the size, high dimensionality, and noisiness of single-cell data complicates this task. Modern experiments profile tens of thousands of genes per cell, often with high dropout levels and technical noise. Consequently, dimensionality reduction, whereby the data is represented in a lower-dimensional space with enriched signal, has become a cornerstone of modern scRNA-seq analysis pipelines. For example, Principal Component Analysis (PCA) projects the data to a lower-dimensional linear subspace such that the total variance of the projected data is maximized. Independent Component Analysis (ICA) instead aims to identify non-Gaussian combinations of features. Both have found widespread use in single-cell studies [<xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-1" hwp:rel-id="ref-3">3</xref>, <xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">4</xref>, <xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-1" hwp:rel-id="ref-5">5</xref>, <xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-1" hwp:rel-id="ref-6">6</xref>]. A more recent method, scVI [<xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">7</xref>], models transcript counts using a zero-inflated negative-binomial distribution, and performs variational inference to non-linearly embed each cell into a low-dimensional parameter space. scVI’s non-linearity supports more complex functions between a cell’s transcripts and its identity, but the dimensions of the latent space are harder to interpret than those of PCA and ICA.</p><p hwp:id="p-10">While these approaches are effective, they often fail to capture the full cellular diversity of complex tissues for two reasons. First, rare cell types, by definition, account for a small fraction of the observations, and therefore contribute little to a dataset’s global structure. Second, many distinctions between cellular populations hinge on just a few of the thousands of genes measured. For instance, gamma-delta T-cells are distinguished from ordinary cytotoxic T-cells by the presence of just a few gamma and delta T-receptors; we call such populations <italic toggle="yes">subtly-defined</italic>. Whereas PCA and ICA both compute features that optimize objective functions over the entire dataset – total variance and non-Gaussianity – rare cell populations thwart both strategies, since the genes defining them may be noisy or unexpressed over much of the data. Subtly-defined populations present an additional challenge, since the few discriminative genes may be masked by many irrelevant genes. Similarly, scVI uses the evidence lower bound (ELBO) loss function to evaluate and refine its latent encoding. Since ELBO takes each recorded transcript into account, rare and subtly-defined cell types may not impact it much, leading to underrepresentation. Real cellular populations may fall into one or both of these categories, and thus these challenges are significant roadblocks to realizing scRNA-seq’s full potential.</p><p hwp:id="p-11">Here, we introduce SCA (Shannon component analysis), an information-theoretic dimensionality reduction method that identifies statistically informative signals in transcriptional data to enable deeper insight into complex tissues (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Figure 1a</xref>). SCA leverages the notion of <italic toggle="yes">surprisal</italic>, whereby less probable events are more informative when they occur, to assign an <italic toggle="yes">information score</italic> to each transcript in each cell. In doing so, SCA enables dimensionality reduction that better preserves information from rare and subtly-defined cell types, uncovering them where existing methods cannot.</p><fig id="fig1" position="float" orientation="portrait" fig-type="figure" hwp:id="F1" hwp:rev-id="xref-fig-1-1 xref-fig-1-2 xref-fig-1-3 xref-fig-1-4 xref-fig-1-5 xref-fig-1-6 xref-fig-1-7"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;2021.01.19.427303v3/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Figure 1:</label><caption hwp:id="caption-1"><p hwp:id="p-12"><bold>a</bold>: Illustration of SCA’s main conceptual advance. The vertical axis separates a small cellular population (top) from a larger one (bottom). The two horizontal axes have higher variance, but cannot separate the two populations. The leading Principal Components align with the higher-variance horizontal axes align with the higher-variance horizontal axes, and fail to separate the populations. The leading Shannon component aligns with the more informative vertical axis, allowing downstream separation. <bold>b</bold>: Construction of information scores from gene expression data. For each cell, we compare the gene’s expression in a local neighborhood of the cell to the gene’s global expression using the Wilcoxon rank-sum test. The resulting <italic toggle="yes">p</italic>-values are negative log-transformed to give the surprisal of the observed over- or under-expression, and given a positive sign for over-expression and a negative sign for under-expression. <bold>c:</bold> Example information scores of the <italic toggle="yes">ITGAL</italic> gene over a set of PBMCs profiled via Smart-seq 3 [<xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-1" hwp:rel-id="ref-19">19</xref>]. Scores are positive where the gene is locally enriched, near zero where it represents noise, and negative where it is conspicuously absent. <bold>d:</bold> Construction of Shannon Components. Singular value decomposition of the information scores over all genes yields <italic toggle="yes">D</italic> loading vectors capturing informative axes in the data. We then linearly project the input data to these axes, producing a D-dimensional representation of each cell for downstream analysis.</p></caption><graphic xlink:href="427303v3_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig><p hwp:id="p-13">To demonstrate the utility of our approach, we ran SCA on real and simulated data with rare and subtly-defined cellular populations, and assessed our ability to recover these populations downstream. For comparison, we also tested PCA, ICA, scVI, and six rare cell type discovery tools: RaceID [<xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-1" hwp:rel-id="ref-8">8</xref>], GiniClust [<xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">9</xref>], CellSIUS [<xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-1" hwp:rel-id="ref-10">10</xref>], FiRE [<xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">11</xref>], GeoSketch [<xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">12</xref>], and Hopper [<xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">13</xref>]. We show that SCA enables detection of small populations, such as gamma-delta T-cells and Mucosal-associated Invariant T (MAIT) cells, which are invisible to existing pipelines and yet critical to the study of tumor immunology [<xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-2" hwp:rel-id="ref-1">1</xref>, <xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-2" hwp:rel-id="ref-2">2</xref>]. At the same time, SCA reductions better capture larger-scale differences between more common cell types, enabling multi-resolution analysis without the need for re-clustering [<xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">14</xref>]. Beyond rare cell type recovery, we found that SCA more accurately recovers gene-gene relationships and restores dropouts when used as a basis for MAGIC imputation [<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">15</xref>].</p><p hwp:id="p-14">SCA is broadly applicable, requiring no information aside from the transcript counts, and generalizes to data composed of discrete cell types or continuous trajectories. The output components have a clear linear relationship with the original transcripts, facilitating straightforward biological verification and interpretation. More broadly, we believe that SCA’s information-theoretic approach is a mathematically justified and empirically useful approach to signal extraction in high-dimensional data.</p></sec><sec id="s2" hwp:id="sec-2"><title hwp:id="title-5">Results</title><sec id="s2a" hwp:id="sec-3"><title hwp:id="title-6">Overview of SCA</title><p hwp:id="p-15">Like PCA and ICA, SCA projects the input data to a linear subspace spanned by a set of basis vectors, which we call <italic toggle="yes">Shannon components</italic>. SCA’s key conceptual advance is its novel approach to finding <italic toggle="yes">informative</italic> axes of variation, where an informative axis is one that separates cell types or captures biologically meaningful variation (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-2" hwp:rel-id="F1">Figure 1a</xref>). Past single-cell experiments have shown that the presence or absence of a small number of genes can determine a cell’s phenotype [<xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-2" hwp:rel-id="ref-5">5</xref>, <xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">16</xref>, <xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">17</xref>]. The key challenge, then, is to find and isolate these signals for each cell.</p><p hwp:id="p-16">To this end, SCA first quantifies the importance of each transcript in each cell by converting transcript counts into <italic toggle="yes">information scores</italic> (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-3" hwp:rel-id="F1">Figure 1b</xref>, <xref ref-type="fig" rid="alg1" hwp:id="xref-statement-1-1" hwp:rel-id="statement-1">Algorithm 1</xref>). To determine the score of a given transcript in a given cell, we compare its expression distribution among the cell’s <italic toggle="yes">k</italic> nearest neighbors to its global expression, i.e. to the expected distribution of the transcript among a set of <italic toggle="yes">k</italic> cells randomly chosen from the entire dataset. A transcript whose local expression deviates strongly from its global expression is more likely to inform the cell’s location in relation to other cells, and therefore its identity. We quantify this deviation through a Wilcoxon rank-sum test, which produces a <italic toggle="yes">p</italic>-value representing the probability of the observed deviation in a random set of <italic toggle="yes">k</italic> cells. Following Shannon’s definition [<xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-1" hwp:rel-id="ref-18">18</xref>], the <italic toggle="yes">surprisal</italic> or <italic toggle="yes">self-information</italic> of the observed deviation is then defined as the negative logarithm of this its probability, i.e. as −log(<italic toggle="yes">p</italic>). This is a positive number which measures how surprising the transcript’s local expression is, in units of nats when the logarithm is natural (changing the base only scales the scores by a constant factor, which does not affect SCA’s output). To distinguish over-from under-expression, we flip the sign for under-expressed transcripts (Methods). The resulting scores are compiled into an <italic toggle="yes">information score matrix</italic> with the same dimensionality as the input data.</p><p hwp:id="p-17">This strategy gives genes high positive scores where they are markers (genes that distinguish a cell type from the rest), scores near zero where they represent noise, and low negative scores where they are conspicuously absent (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-4" hwp:rel-id="F1">Figure 1c</xref>). For example, consider a marker gene for a rare population. The gene is unexpressed over much of the data, but highly expressed in cells belonging to the population. Thus, for these rare cells, the local expression is far higher than would be expected by chance, so the gene receives a high score for these cells. Likewise, a gene expressed everywhere <italic toggle="yes">except</italic> on a rare population receives low scores on members of the population. On the other hand, a noisy gene with no bearing on cellular identity receives low scores everywhere, since its distribution on /-neighborhoods resembles that of random sets of <italic toggle="yes">k</italic> cells.</p><p hwp:id="p-18">We next seek to distill the signal captured by the information score matrix into a low-dimensional representation (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-5" hwp:rel-id="F1">Figure 1d</xref>, <xref ref-type="fig" rid="alg2" hwp:id="xref-statement-2-1" hwp:rel-id="statement-2">Algorithm 2</xref>). As shown in the Methods and in Supplementary Note 1, the righteigenvectors of the Information score matrix represent highly informative linear combinations of genes, which we call <italic toggle="yes">Shannon Components</italic> (SCs). The first <italic toggle="yes">D</italic> right-eigenvectors, which we denote <italic toggle="yes">υ</italic><sub>1</sub>,…, <italic toggle="yes">υ<sub>D</sub></italic>, then span a linear subspace onto which we project the input matrix <italic toggle="yes">X</italic>. The resulting <italic toggle="yes">N</italic> × <italic toggle="yes">D</italic> matrix is the output of SCA. We emphasize that while the construction of the information score matrix and of <italic toggle="yes">υ</italic><sub>1</sub>,…, <italic toggle="yes">υ<sub>D</sub></italic> is nonlinear, SCA’s output is a linear projection of its input to their span. This places SCA in the category of linear dimensionality reduction methods, together with PCA and ICA. In particular, this means that each of the output features is a weighted sum of the input features, enabling straightforward interpretation.</p><p hwp:id="p-19">In summary, SCA accepts a transcript matrix and sets of <italic toggle="yes">k</italic>-nearest neighbors for each cell, finds transcripts that inform each cell’s locality, and distills this information into a smaller set of features. This process amplifies the locality signal of the input <italic toggle="yes">k</italic>-nearest neighbor data. For example, even if only 10% of a cell’s neighbors belong to the same population, this is still highly significant when the population comprises only 1% of the sample. SCA’s information scores would reflect this, and the resulting components would better separate the rare cells, as we verify. The input neighborhoods can be specified arbitrarily, but by default SCA computes them via Euclidean distance on a PCA representation.</p><p hwp:id="p-20">This signal-boosting step can be repeated: from an initial SCA reduction, we can compute <italic toggle="yes">k</italic>-neighborhoods using the Euclidean metric, use these neighborhoods to compute an information score matrix, and perform singular value decomposition to compute another SCA reduction. As we show in both real and simulated data, this often improves the representation of rare and subtly-defined cell types (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-1" hwp:rel-id="F2">Figure 2b</xref> and <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-1" hwp:rel-id="F3">3f</xref>). Intuitively, we begin with a weak notion of locality (provided by PCA) and continually refine it. In our experiments, we have found that performance usually stabilizes after 3-5 iterations and remains stable thereafter (<xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-2" hwp:rel-id="F3">Figure 3f</xref>, Supplementary Figure S2). Note that regardless of the number of iterations, SCA’s output remains a linear projection of its input – iteration simply refines the subspace onto which SCA projects.</p><fig id="fig2" position="float" orientation="portrait" fig-type="figure" hwp:id="F2" hwp:rev-id="xref-fig-2-1 xref-fig-2-2 xref-fig-2-3 xref-fig-2-4 xref-fig-2-5 xref-fig-2-6 xref-fig-2-7 xref-fig-2-8 xref-fig-2-9 xref-fig-2-10 xref-fig-2-11"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;2021.01.19.427303v3/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Figure 2:</label><caption hwp:id="caption-2"><p hwp:id="p-21"><bold>a:</bold> Illustration of synthetic dataset with 1,020 genes and 500 cells. 20 “marker genes” mark a set of 25 “rare” cells with a 10% dropout rate. The remaining 1,000 “noise” genes are expressed in a random 20% of the cells. To add further noise, each marker gene is also expressed in a random 15% of the remaining cells. Nonzero gene expression values are drawn randomly from the nonzero log-TPM gene expression values of a cytotoxic T-cell dataset profiled using Smart-seq 3 [<xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-2" hwp:rel-id="ref-19">19</xref>]. <bold>b:</bold> Silhouette scores for the two populations embedded via 20-dimensional SCA reductions computed with various neighborhood sizes and numbers of iterations. Performance is stable across neighborhood sizes up to 60, and improves with more iterations. <bold>c:</bold> Scatter plots of UMAP coordinates (top) and leading components (bottom) for PCA, ICA, scVI, and SCA (with 5 iterations). Top PCs, ICs, and scVI latent embedding dimensions do not separate the two populations. On the other hand, the leading Shannon component (SC) strongly separates the two populations, yielding complete separation in the downstream UMAP plot and a higher silhouette score. <bold>d:</bold> Performance of RaceID (top) and FiRE (bottom) on this dataset. RaceID clusters do not separate the populations, and FiRE scores are not higher for the rare cells.</p></caption><graphic xlink:href="427303v3_fig2" position="float" orientation="portrait" hwp:id="graphic-2"/></fig></sec><sec id="s2b" hwp:id="sec-4"><title hwp:id="title-7">SCA recovers rare populations from noisy synthetic data</title><p hwp:id="p-22">To test SCA’s power to recover rare cell populations in the presence of noise, we generated a synthetic dataset with 500 cells and 1,020 genes (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-2" hwp:rel-id="F2">Figure 2a</xref>). The genes are split into 20 “marker” genes and 1,000 “noise” genes, and the cells are split into 25 “common” cells and 475 “rare” cells. Each marker gene is expressed with 90% frequency in the rare cells, and 15% frequency in the common cells. Each noise gene is expressed uniformly at random throughout the data with frequency 20%. The nonzero expression levels are chosen at random from the nonzero log-TPM (transcripts per million) values of the cytotoxic T-cell dataset analyzed in <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-3" hwp:rel-id="F3">Figure 3</xref> [<xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-3" hwp:rel-id="ref-19">19</xref>], mimicking the erratic capture efficiency of real single-cell technologies. This dataset was designed to mimic a challenging biological scenario with a rare and subtly defined population and unreliable marker genes.</p><fig id="fig3" position="float" orientation="portrait" fig-type="figure" hwp:id="F3" hwp:rev-id="xref-fig-3-1 xref-fig-3-2 xref-fig-3-3 xref-fig-3-4 xref-fig-3-5 xref-fig-3-6 xref-fig-3-7 xref-fig-3-8 xref-fig-3-9 xref-fig-3-10 xref-fig-3-11 xref-fig-3-12 xref-fig-3-13 xref-fig-3-14"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;2021.01.19.427303v3/FIG3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F3</object-id><object-id pub-id-type="publisher-id">fig3</object-id><label>Figure 3:</label><caption hwp:id="caption-3"><p hwp:id="p-23">SCA recovers fine-grained cellular populations from a set of 307 cytotoxic T-cells profiled using Smart-seq 3 [<xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-4" hwp:rel-id="ref-19">19</xref>]. <bold>a:</bold> UMAP embedding computed from a 20-dimensional SCA representation using Euclidean nearest neighbors, with Leiden clusterings (left) and inferred cell types (right). Gamma-delta, MAIT, and T-helper populations cleanly separate. <bold>b:</bold> Scatter plots of leading Principal, Independent, and Shannon components, colored by log-TPM expression of key marker genes: the delta-receptor TRDV2 marks gamma-delta T cells [<xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-1" hwp:rel-id="ref-23">23</xref>], and SLC4A10 marks MAIT cells [<xref ref-type="bibr" rid="c24" hwp:id="xref-ref-24-1" hwp:rel-id="ref-24">24</xref>]. The leading Shannon components cleanly separate the gamma-delta and MAIT subpopulations, whereas the leading PCs and ICs blur these distinctions. <bold>c:</bold> Heatmap of gene expression percentages of key marker gene groups in each SCA-derived Leiden cluster. Gamma-delta, MAIT, and T-helper cells are clearly discernible. <bold>d:</bold> UMAP plots derived from 20-dimensional PCA, ICA, scVI, and SCA representations of the data, all using Euclidean nearest neighbors, colored by expression of key marker genes. CD8 T-cells, CD4+ T-helper cells, TRDV2+ gamma-delta T-cells, and SLC4A10+ MAIT cells form distinct regions of the SCA-derived UMAP plot, even though the other embeddings do not separate them. <bold>e:</bold> F1 scores for recovery of major T-cell populations by various clustering schemes (Methods). For PCA, ICA, and SCA, we assess Leiden clusters from the Euclidean 15-nearest neighbors graph with resolution 1. Leiden clusterings computed on the SCA representation consistently capture these cell types with superior accuracy. <bold>f:</bold> Robustness analysis for cell type recovery with respect to the size of the neighborhoods used to compute SCA’s information scores, and the number of iteratrions. Performance improves with more iterations, and is stable across a wide range of neighborhood sizes.</p></caption><graphic xlink:href="427303v3_fig3" position="float" orientation="portrait" hwp:id="graphic-3"/></fig><p hwp:id="p-24">We reduced this dataset using 20-dimensional PCA; 20-dimensional ICA; scVI with a 20-dimensional latent space; and 20-dimensional SCA with 1-5 iterations (Methods). For each reduction, we assessed separation visually using UMAP coordinates [<xref ref-type="bibr" rid="c20" hwp:id="xref-ref-20-1" hwp:rel-id="ref-20">20</xref>], and quantitatively by assessing the silhouette score [<xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-1" hwp:rel-id="ref-21">21</xref>]. We found that the PCA, ICA and scVI representations collapsed the two populations, as indicated by very low silhouette scores (&lt; 0.1) and poor separation in UMAP plots produced downstream of the Euclidean 15-nearest neighbors graph (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-3" hwp:rel-id="F2">Figure 2c</xref>). SCA produces increasingly better separations with successive iterations, and after 5 iterations achieves a silhouette score of 0.355, with a cleanly visible separation in the downstream UMAP plot (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-4" hwp:rel-id="F2">Figures 2b</xref> and <xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-5" hwp:rel-id="F2">2c</xref>). This improvement is due to SCA correctly identifying the marker genes as having high information, and thus giving them higher impact on the final reduction; indeed, the first Shannon component clearly separates the two clusters, whereas the leading Principal and Independent components do not (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-6" hwp:rel-id="F2">Figure 2c</xref>, bottom). SCA’s performance is stable across a wide range of sizes of the <italic toggle="yes">k</italic>-nearest neighborhoods used to compute the information score matrix, with a drop in performance only when the neighborhood size greatly exceeds the size of the rare population (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-7" hwp:rel-id="F2">Figure 2b</xref>).</p><p hwp:id="p-25">For further comparison, we also tested four methods specifically designed for rare cell type recovery: GiniClust3 [<xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-2" hwp:rel-id="ref-9">9</xref>], CellSIUS [<xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-2" hwp:rel-id="ref-10">10</xref>], RaceID [<xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-2" hwp:rel-id="ref-8">8</xref>] and FiRE [<xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-2" hwp:rel-id="ref-11">11</xref>]. Neither RaceID’s clustering nor FiRE’s rarity scores separated the two clusters (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-8" hwp:rel-id="F2">Figure 2d</xref>). GiniClust3 did not identify any of the marker genes as having significantly high Gini index; consequently, it combined all cells into a single cluster. Similarly, CellSIUS did not identify any genes with bimodal distribution, and did not generate a clustering.</p></sec><sec id="s2c" hwp:id="sec-5"><title hwp:id="title-8">SCA reveals the landscape of cytotoxic T-cell subtypes</title><p hwp:id="p-26">Novel therapies increasingly leverage the immune system to fight disease, and the complexity and cellular diversity of immunological tissues makes them ideal targets for scRNA-seq [<xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-1" hwp:rel-id="ref-22">22</xref>, <xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-3" hwp:rel-id="ref-5">5</xref>, <xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-2" hwp:rel-id="ref-17">17</xref>]. However, these tissues also challenge the technology in a variety of ways: they contain diverse cell types with rare but clinically important sub-types, and the expression of individual surface receptors has outsize effects on phenotype [<xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-3" hwp:rel-id="ref-17">17</xref>, <xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-2" hwp:rel-id="ref-22">22</xref>]. We therefore examined whether SCA can find and distill these signals to reveal a richer landscape of immune cell types.</p><p hwp:id="p-27">To this end, we obtained a collection of 307 cytotoxic T-cells profiled using Smart-seq 3 (SS3) [<xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-5" hwp:rel-id="ref-19">19</xref>], and computed 20-dimensional reductions using PCA, ICA, and SCA. For SCA, we perform up to 5 iterations with a neighborhood size of 15. We followed each reduction with standard downstream steps: 15-nearest neighbor graph construction using the Euclidean metric, UMAP embedding, and Leiden clustering.</p><p hwp:id="p-28">The PCA and SCA reductions both suggest that the data is homogeneous: the UMAP visualizations are globular, with no distinct clusters, and there is no obvious structure in the leading components (<xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-4" hwp:rel-id="F3">Figure 3b</xref> and <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-5" hwp:rel-id="F3">3d</xref>). On the other hand, SCA’s embedding reveals several clearly-separated populations, summarized by 9 Leiden clusters (<xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-6" hwp:rel-id="F3">Figure 3a</xref>). Differential gene expression analysis shows that these correspond neatly to well-documented biological cell types (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-6" hwp:rel-id="F1">Figure 1c</xref>). For example, clusters 1 and 2 contain Gamma-delta T-cells, as indicated by expression of the gamma- and delta-receptors <italic toggle="yes">TRGV9</italic> and <italic toggle="yes">TRDV2</italic> [<xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-2" hwp:rel-id="ref-23">23</xref>]. Cluster 4 uniquely expresses <italic toggle="yes">SLC4A10, TRAV1-2</italic>, and <italic toggle="yes">LTK</italic>, strongly suggesting MAIT cells [<xref ref-type="bibr" rid="c24" hwp:id="xref-ref-24-2" hwp:rel-id="ref-24">24</xref>, <xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-3" hwp:rel-id="ref-2">2</xref>]. CD4+ T-helper cells group neatly in cluster 9, whereas high <italic toggle="yes">TIGIT</italic> levels in Cluster 7 suggest a T-regulatory phenotype [<xref ref-type="bibr" rid="c25" hwp:id="xref-ref-25-1" hwp:rel-id="ref-25">25</xref>, <xref ref-type="bibr" rid="c26" hwp:id="xref-ref-26-1" hwp:rel-id="ref-26">26</xref>]. Clusters 3 and 8 express standard cytotoxic effector genes like granzymes and perforins, whereas clusters 5 and 6 express CD8 but have low granzyme expression, suggesting recently-activated CD8 T-cells.</p><p hwp:id="p-29">As shown in <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-7" hwp:rel-id="F3">Figure 3d</xref>, the UMAP plots derived from the PCA and ICA representations do not separate cells based on key immunological markers, whereas the SCA-derived UMAP plot does. To quantify this and see how it affects <italic toggle="yes">de novo</italic> population discovery, we assessed whether the Leiden clusters computed downstream of each representation were concordant with a marker-based classification. We defined CD8+ T-cells as those expressing <italic toggle="yes">CD8A;</italic> CD4+ T-cells as those expressing <italic toggle="yes">CD4</italic>, gamma-delta T-cells as those expressing at least two of <italic toggle="yes">TRGV9, TRDV2</italic>, and <italic toggle="yes">TRDC</italic>; and MAIT cells as those expressing at least two of <italic toggle="yes">SLC4A10, TRAV1-2</italic>, and <italic toggle="yes">LTK</italic>. For each Leiden clustering, we identified the set of clusters whose union is most concordant with each marker-based class, and computed the F1 score (Methods). For further comparison, we do the same for clusterings output by CellSIUS, RaceID, GiniClust, GeoSketch, and Hopper. To produce clusterings using Hopper, we perform Leiden-clustering on a 50-point Hopper sketch of the data, then assign each cell the cluster label of its nearest subsampled cell. For GeoSketch, we project the data to 20-dimensional PCA coordinates computed from a 50-point sketch, and then compute Leiden clusters. For FiRE, which assigns a continuous rarity score to each cell, we consider sets containing the top <italic toggle="yes">k</italic> highest-scoring cells for all values of <italic toggle="yes">k</italic> ranging from 1 to the full size of the dataset, and report the highest F1 score obtained by any such set. SCA consistently outperforms the other methods in identifying these immunological classes (F<xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-8" hwp:rel-id="F3">igure 3e</xref>).</p><p hwp:id="p-30">For completeness, we performed robustness analysis to see how SCA’s performance varies under different choices of neighborhood size <italic toggle="yes">k</italic>, and different numbers of iterations (<xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-9" hwp:rel-id="F3">Figure 3f</xref>). As in the synthetic dataset, running more iterations often improves the representation; notably, the CD4+ sub-type is not consistently well-captured until at least the third iteration. After 3, 4, or 5 iterations, SCA performs well on all sub-types over a wide range of neighborhood sizes. Very small neighborhood sizes (&lt; 5) do not perform as well, likely due to a lack of statistical power. Based on this and the synthetic data performance, we suggest choosing a neighborhood size small enough to be contained in the rarest population, but large enough to guarantee statistical power. We have found the default size of 15 to be suitable for many datasets.</p></sec><sec id="s2d" hwp:id="sec-6"><title hwp:id="title-9">SCA distinguishes known cell types profiled by CITE-seq</title><p hwp:id="p-31">We next sought to test whether SCA’s reductions better detect known populations of cells in a larger-scale immmunological single-cell dataset. We obtained a CITE-seq dataset from Hao et al. [<xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-4" hwp:rel-id="ref-5">5</xref>], in which hundreds of thousands of PBMCs from 8 human donors were subjected in parallel to transcriptomic profiling and to surface receptor profiling with a panel of 228 antibodies. The authors use both modalities, and input from human experts, to produce a cell type classification, which we take as a ground truth. Notably, the classification includes some T-cell populations which the authors were not able to detect through analysis of the transcriptomic data alone, such as gamma-delta and MAIT cells, offering a good challenge for SCA. We subset the data to T-cells, yielding 73,000 cells across all donors. To circumvent batch effects, we separate the data by donor and assess performance in each donor individually.</p><p hwp:id="p-32">UMAP plots computed from each representation are shown for Patient 1 in <xref ref-type="fig" rid="fig4" hwp:id="xref-fig-4-1" hwp:rel-id="F4">Figure 4a</xref>, and similar UMAP plots for the remaining patients are provided in Supplementary Figure S4. Compared to PCA and ICA, SCA consistently generates more structured UMAP plots downstream, with clearer visual separation between cell types. We observe similar improvements when plotting the first two components of each reduction against each other (Figure S5). We hypothesized that this separation leads to more accurate clusterings downstream. To test this, we performed Leiden clustering [<xref ref-type="bibr" rid="c27" hwp:id="xref-ref-27-1" hwp:rel-id="ref-27">27</xref>] on each representation with resolution 1.0, and computed the adjusted mutual information (AMI) between the Leiden clusters and the true cell labels [<xref ref-type="bibr" rid="c28" hwp:id="xref-ref-28-1" hwp:rel-id="ref-28">28</xref>]. For comparison, we also computed AMIs for Leiden clusterings computed from scVI’s embedding, clusterings based on both GeoSketch and Hopper reductions, and clusterings returned by GiniClust3 [<xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-3" hwp:rel-id="ref-9">9</xref>], CellSIUS [<xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-3" hwp:rel-id="ref-10">10</xref>], and RaceID [<xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-3" hwp:rel-id="ref-8">8</xref>]. Across all patients, the SCA-derived Leiden clusterings achieved the highest AMI with the true cell labels (<xref ref-type="fig" rid="fig4" hwp:id="xref-fig-4-2" hwp:rel-id="F4">Figure 4b</xref>). Thus, SCA representations enable more accurate downstream recovery of cellular populations in a sample.</p><fig id="fig4" position="float" orientation="portrait" fig-type="figure" hwp:id="F4" hwp:rev-id="xref-fig-4-1 xref-fig-4-2 xref-fig-4-3 xref-fig-4-4"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;2021.01.19.427303v3/FIG4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F4</object-id><object-id pub-id-type="publisher-id">fig4</object-id><label>Figure 4:</label><caption hwp:id="caption-4"><p hwp:id="p-33"><bold>a</bold>: UMAP plots computed from PCA, ICA, and SCA reductions of T-cell scRNA-seq data for Patient 1 from Hao et al. [<xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-5" hwp:rel-id="ref-5">5</xref>]. Cell type labels were determined via parallel screening of 228 antibodies using CITE-seq. SCA produces better separation between the annotated cell types, enabling their discovery from transcriptomic data alone. <bold>b</bold>: Adjusted Mutual Information (AMI) of true cell labels with clusters output by each of the nine methods tested in each patient. (FiRE does not output a clustering but a rareness score, and thus is not amenable to AMI analysis.) For PCA, ICA, SCA, and scVI, we perform Leiden clustering with resolution 1.0 after reduction. SCA-based clusterings consistently have higher AMI with the true labels. <bold>c</bold>: F1 scores for recovery of all T-cell subtypes across all 8 patients of the dataset from Hao et al., from PCA, ICA, and SCA followed by Leiden clustering with resolution 1.0, and from seven other methods. For each clustering and cell type, the set of clusters best identifying that cell type was selected, and the F1 score reported. SCA recovers nearly all cell types with superior accuracy, and newly enables discovery of some types (e.g. CD4 cytotoxic T-lymphocytes and MAIT cells) which are poorly distinguished by other methods. Thus, SCA facilitates <italic toggle="yes">de novo</italic> discovery of these clinically relevant subpopulations.</p></caption><graphic xlink:href="427303v3_fig4" position="float" orientation="portrait" hwp:id="graphic-4"/></fig><p hwp:id="p-34">We next assessed the accuracy with which SCA and other methods detect each of the known cellular populations, using the F1 score measure described above and in Methods. Across all donors, we find that clusterings derived from SCA recover most cell types with superior accuracy, with many cell types recoverable only by SCA (<xref ref-type="fig" rid="fig4" hwp:id="xref-fig-4-3" hwp:rel-id="F4">Figure 4c</xref>). For example, in Patient 1, SCA recovers CD4 cytotoxic T-lymphocytes (CD4 CTL) with F1 score 0.97, whereas no other method achieves a score higher than 0.61. We observe similar improvements across all patients, with SCA often recovering rare cell types (e.g. MAIT cells, Gamma-delta T-cells, and CD4+ Effector Memory T-cells) where existing methods do not. As notable exceptions, CellSIUS and GiniClust perform exceptionally well on the CD4 proliferating population, with CellSIUS also outperforming other methods on the CD8 proliferating and double-negative T populations. We suspect that the Leiden clusterings under-perform here due to theoretical limitations of community-detection algorithms to detect very small populations, as discussed in Kumpula et al. [<xref ref-type="bibr" rid="c29" hwp:id="xref-ref-29-1" hwp:rel-id="ref-29">29</xref>].</p></sec><sec id="s2e" hwp:id="sec-7"><title hwp:id="title-10">SCA improves graph-based imputation</title><p hwp:id="p-35">Dropouts and technical noise often obscure gene-gene relationships in single-cell data. Imputation aims to recover lost transcripts and restore these relationships. MAGIC [<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-2" hwp:rel-id="ref-15">15</xref>] tackles imputation by constructing a diffusion operator to share information across similar cells. By default, MAGIC computes cellular similarity using the Euclidean distance in PCA space. Since SCA better separates biological cell types, we pursued the intuition that using Euclidean distance in an SCA reduction would allow MAGIC to build a better diffusion operator resulting in more accurate imputation. We therefore formulated <italic toggle="yes">SCA-MAGIC</italic>, which performs diffusion over an SCA embedding instead of a PCA embedding (Methods).</p><p hwp:id="p-36">To test the ability of each method to recover dropouts from the 500-cell synthetic dataset, we performed imputation using MAGIC and SCA-MAGIC, and measured the Pearson correlation between the imputed values and a ground-truth marker gene with no dropouts. The marker genes identifying the rare cell type population for the synthetic dataset each have a dropout rate of 10%. As shown in <xref ref-type="fig" rid="fig5" hwp:id="xref-fig-5-1" hwp:rel-id="F5">Figure 5a</xref>, SCA-MAGIC achieves significantly higher correlation between imputed marker genes and the ground-truth marker gene.</p><p hwp:id="p-37">To assess recovery of gene-gene relationships, we ran MAGIC and SCA-MAGIC on the cytotoxic T-cells from [<xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-6" hwp:rel-id="ref-19">19</xref>]. We find that SCA-MAGIC better recovers the complimentary relationship between CD8 expression and CD4 expression among alpha-beta T-cells, with T-helper cells having high CD4 levels and gamma-delta T-cells expressing neither surface receptor, consistent with the literature [<xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-3" hwp:rel-id="ref-23">23</xref>, <xref ref-type="bibr" rid="c30" hwp:id="xref-ref-30-1" hwp:rel-id="ref-30">30</xref>] (<xref ref-type="fig" rid="fig5" hwp:id="xref-fig-5-2" hwp:rel-id="F5">Figure 5b</xref>, top). Both MAGIC and SCA-MAGIC report an inverse relationship between the expression levels of Granzyme B and Granzyme K. However, SCA-based MAGIC assigns the T-helper cells lower Granzyme B levels than the other populations. This is concordant with flow-cytometry results, which indicate that CD8+ T-cells are the primary secretors of granzyme B [<xref ref-type="bibr" rid="c31" hwp:id="xref-ref-31-1" hwp:rel-id="ref-31">31</xref>].</p><fig id="fig5" position="float" orientation="portrait" fig-type="figure" hwp:id="F5" hwp:rev-id="xref-fig-5-1 xref-fig-5-2 xref-fig-5-3 xref-fig-5-4"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;2021.01.19.427303v3/FIG5</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F5</object-id><object-id pub-id-type="publisher-id">fig5</object-id><label>Figure 5:</label><caption hwp:id="caption-5"><p hwp:id="p-38">Imputation performance of MAGIC using PCA and using SCA. <bold>a:</bold> Recovery of marker genes on the 500-cell dataset analyzed in <xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-9" hwp:rel-id="F2">Figure 2</xref>. For each method, we measure the average correlation between the imputed marker genes and an indicator vector for the rare cells. Our version, SCA-MAGIC, achieves significantly higher correlation. <bold>b:</bold> Visualizing gene-gene relationships in cytotoxic T-cell data after imputation using MAGIC and SCA-MAGIC. SCA-MAGIC better recovers the inverse relationships between CD8 and CD4 and between Granzyme B and Granzyme K, with gamma-delta T-cells expressing neither CD8 nor CD4 and lower Granzyme expression for T-helper cells. <bold>c:</bold> Scatter plot showing dropout recovery in the cytotoxic T-cell dataset at various dropout rates. A fixed percentage of nonzero transcript measurements were set to zero, and the mean imputed values of these removed transcripts were assessed for each gene. While MAGIC and SCA-MAGIC perform similarly on most genes, SCA-MAGIC consistently performs better on a subset of them. <bold>d:</bold> A closer look at the genes where SCA-MAGIC significantly outperforms MAGIC in recovering dropouts at the 90% dropout rate. They include many key marker genes, like <italic toggle="yes">CD8A, CD8B, CD4</italic>, emphTIGIT, and <italic toggle="yes">TRDV2</italic>.</p></caption><graphic xlink:href="427303v3_fig5" position="float" orientation="portrait" hwp:id="graphic-5"/></fig><p hwp:id="p-39">To compare dropout recovery on real data, we created low-coverage versions of the cytotoxic T-cell dataset by setting 10%, 30%, 50%, or 90% of the nonzero transcript counts to zero, and examined the values of these dropped-out transcripts after imputation. Higher imputed values indicate better transcript recovery. For most genes, SCA-MAGIC and MAGIC perform similarly (<xref ref-type="fig" rid="fig5" hwp:id="xref-fig-5-3" hwp:rel-id="F5">Figure 5c</xref>). However, SCA-MAGIC outperforms MAGIC on a small set of key marker genes, including <italic toggle="yes">CD8A, CD8B, CD4, TIGIT, KLRC1</italic>, and the gammadelta marker genes <italic toggle="yes">TRDV2</italic> and <italic toggle="yes">TRGV9</italic> (<xref ref-type="fig" rid="fig5" hwp:id="xref-fig-5-4" hwp:rel-id="F5">Figure 5d</xref>). Since these genes define important T-cell subclasses, this improvement is consequential.</p></sec><sec id="s2f" hwp:id="sec-8"><title hwp:id="title-11">SCA scales to large datasets</title><p hwp:id="p-40">As improving technologies generate ever larger datasets, the computational tools used to analyze these datasets must scale accordingly. SCA meets this need with fast runtimes and modest memory overhead.</p><p hwp:id="p-41">Asymptotically, SCA’s runtime and memory overhead are both linear in the size of the input dataset (Supplementary Note 2, Figure S1). To test this empirically, we measured runtime and peak memory usage for one iteration of SCA on data of varying sizes (Figure S1). We produced test datasets by taking random subsets of Patient 1’s T-cell data from Hao et al. [<xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-6" hwp:rel-id="ref-5">5</xref>] with varying numbers of cells and genes. For all tests, we use a neighborhood size of 15. As expected, we find SCA’s runtime and memory performance scale linearly with increasing numbers of cells. On a subset with 9,000 cells and over 20,000 genes, SCA takes 3 minutes and 15 seconds to run with a peak allocation of 561 MB. This is only slightly slower than PCA, which finishes in 2 minutes and 10 seconds and allocates 179MB. (ICA is somewhat more computationally demanding, requiring 266 seconds and allocating over 4GB). SCA’s linear scaling makes it tractable even on the very largest single-cell datasets; for example, on a mouse brain dataset from Saunders et al. with 939,489 cells and 20,658 genes [<xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-2" hwp:rel-id="ref-3">3</xref>], SCA runs in 5.5 hours and allocates a maximum of about 29GB, well within the range of most modern day computers. Sub-sampling techniques that preserve rare cell types, such as Hopper [<xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-2" hwp:rel-id="ref-13">13</xref>] and Geosketch [<xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-2" hwp:rel-id="ref-12">12</xref>], may be combined with SCA to enable fine-grained analyses of these massive datasets even on a laptop. We can also reduce the memory overhead further by processing the data in chunks containing a certain number of genes (Methods).</p></sec></sec><sec id="s3" hwp:id="sec-9"><title hwp:id="title-12">Discussion</title><p hwp:id="p-42">SCA offers an information-theoretic approach to measuring and compressing salient transcriptional signals in single-cell data, enabling downstream analyses at unprecedented resolution. By iteratively boosting the locality-specific signal of individual transcripts, SCA uncovers clinically-relevant immunological populations that are invisible to existing approaches.</p><p hwp:id="p-43">A variety of approaches have arisen that are specifically tailored to the problem of rare cell type recovery. However, we find that these methods have limiting assumptions [<xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-4" hwp:rel-id="ref-9">9</xref>, <xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-3" hwp:rel-id="ref-11">11</xref>] or rely on potentially inaccurate or ill-defined clustering procedures [<xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-4" hwp:rel-id="ref-10">10</xref>, <xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-4" hwp:rel-id="ref-8">8</xref>] that limit performance. GiniClust [<xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-5" hwp:rel-id="ref-9">9</xref>] assumes that genes with high Gini index are the most important; however, we demonstrated that this is not always the case (e.g. the marker genes in the synthetic dataset were not marked as having high-Gini index by the algorithm). RaceID and CellSIUS both compute initial clusterings which are then individually refined. However, an accurate initial clustering may be difficult to obtain when cell types of interest are rare or subtly-defined, and cluster-based approaches are unsuitable when cells form more continuous transcriptional structures, such as developmental trajectories, which do not neatly partition [<xref ref-type="bibr" rid="c32" hwp:id="xref-ref-32-1" hwp:rel-id="ref-32">32</xref>]. FiRE [<xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-4" hwp:rel-id="ref-11">11</xref>] sidesteps the limitations of clustering by assigning each cell a rarity score according to its degree of isolation, but the notion of isolation in turn relies on a meaningful cell-to-cell distance metric, which is not readily derived. Hopper [<xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-3" hwp:rel-id="ref-13">13</xref>] reduces the data in the hopes of increasing the proportion of rare cells, but its approach requires a reliable distance metric, and requires getting rid of potentially valuable data. For the latter two methods, one might improve performance by using Euclidean distance in an SCA representation as a distance metric. Our work suggests that the right dimensionality reduction can enable recovery of even rare and subtly-defined populations.</p><p hwp:id="p-44">SCA’s information scores are similar in principle to the Inverse Document Frequency (IDF) transform, a normalization approach widely used in text processing and in some single-cell applications, whereby each feature (gene) is weighted by the logarithm of its inverse frequency [<xref ref-type="bibr" rid="c33" hwp:id="xref-ref-33-1" hwp:rel-id="ref-33">33</xref>]. Like SCA, IDF gives rarely-seen features more weight; however, it does not consider the locality-specific context of each feature measurement, so it lacks the statistical power to detect locally-enriched signals. By incorporating counts from local neighborhoods of each cell, SCA allows genes to have variable scores across the dataset, achieving high-magnitude scores where they are discriminative and near-zero scores where they are noise (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-7" hwp:rel-id="F1">Figure 1c</xref>). Our approach reflects true biology, where genes may be expressed sporadically across the entire dataset but mark informative distinctions only within a small subpopulation.</p><p hwp:id="p-45">SCA is also conceptually similar to surprisal analysis [<xref ref-type="bibr" rid="c34" hwp:id="xref-ref-34-1" hwp:rel-id="ref-34">34</xref>], which compares observed data to a precomputed balance state to identify meaningful deviations. Originally developed for thermodynamics, these methods have recently found use in <italic toggle="yes">bulk</italic> transcriptomic analysis of biological systems in flux, such as cancer cells undergoing epithelial-to-mesenchymal transition and carcinogenesis [<xref ref-type="bibr" rid="c35" hwp:id="xref-ref-35-1" hwp:rel-id="ref-35">35</xref>, <xref ref-type="bibr" rid="c36" hwp:id="xref-ref-36-1" hwp:rel-id="ref-36">36</xref>, <xref ref-type="bibr" rid="c37" hwp:id="xref-ref-37-1" hwp:rel-id="ref-37">37</xref>, <xref ref-type="bibr" rid="c38" hwp:id="xref-ref-38-1" hwp:rel-id="ref-38">38</xref>]. For example, Gross et al. [<xref ref-type="bibr" rid="c35" hwp:id="xref-ref-35-2" hwp:rel-id="ref-35">35</xref>] perform singular value decomposition on a surprisal matrix derived from time series micro-arrays to identify bulk transcriptomic signatures that predict eventual malignancy. In their work, the surprisal of a transcript is defined by the negative logarithmic fold change of the transcript from its value in the balance state. We generalized this idea to single-cell data by treating each cell as a separate time point, and computing surprisals as negative log-fold changes between observed transcript counts and transcript expression means across all cells. However, we show this extended notion of surprisal is under-powered and inaccurate for single-cell data (Supplementary Note 5, figure S6), because individual transcript counts are themselves noisy. For example, on the cytotoxic T-cell dataset, this approach fails to separate CD8 from CD4 T-cells (Figure S6). SCA’s novel approach of testing expression in <italic toggle="yes">neighborhoods</italic> of cells instead of individual cells lends statistical power and limits the impact of noise and dropouts, especially in combination with the robust Wilcoxon test.</p><p hwp:id="p-46">Data visualization, which features prominently in many single-cell pipelines [<xref ref-type="bibr" rid="c39" hwp:id="xref-ref-39-1" hwp:rel-id="ref-39">39</xref>, <xref ref-type="bibr" rid="c20" hwp:id="xref-ref-20-2" hwp:rel-id="ref-20">20</xref>], differs from dimensionality reduction, on which we focus. Whereas visualization aims to produce a two-dimensional rendering of the data, dimensionality reduction produces a smaller, but still many-dimensional representation which is then analyzed further downstream. Thus, data visualization tools compliment dimensionality reduction rather than substitute for it. Indeed, visualizations are often built on dimensionality-reduced data; for example, UMAP plots in existing literature are often computed on PCA or ICA reductions [<xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-3" hwp:rel-id="ref-3">3</xref>, <xref ref-type="bibr" rid="c40" hwp:id="xref-ref-40-1" hwp:rel-id="ref-40">40</xref>]. SCA complements existing visualization tools to facilitate exploratory analysis (<xref ref-type="fig" rid="fig4" hwp:id="xref-fig-4-4" hwp:rel-id="F4">Figure 4a</xref>, <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-10" hwp:rel-id="F3">3a</xref>, and S4).</p><p hwp:id="p-47">SCA also combines well with <italic toggle="yes">sketching</italic> techniques, such as Geosketch [<xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-3" hwp:rel-id="ref-12">12</xref>] and Hopper [<xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-4" hwp:rel-id="ref-13">13</xref>], which generate subsamples of cells that retain transcriptional diversity; SCA can in principle be run on the subsamples from these methods to allow massive single-cell analysis on a laptop, thus democratizing single-cell analysis. In turn, these sketching techniques rely on a low-dimensional representation of cells, which SCA may provide. As motivation for the latter, we have shown that SCA is better at identifying rare cell types than these sketching techniques.</p><p hwp:id="p-48">Although the process that generates the Shannon components is nonlinear, requiring nearest-neighbor graphs and Wilcoxon score computation, SCA’s output is a linear projection of its input. This places SCA, firmly in the linear category, together with PCA and ICA; indeed, for fixed dimension <italic toggle="yes">D</italic>, the coordinate systems defined by SCA and by these methods are related by rotation in the original high-dimensional space. Intuitively, SCA changes the “perspective” from which the data is viewed. It is remarkable, then, that SCA’s ¦ reductions look so different in downstream analyses from those of PCA and ICA (e.g. <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-11" hwp:rel-id="F3">Figure 3a</xref>). This is possible because high-dimensional space offers a far wider variety of perspectives than the three-dimensional space we often think in, giving linear methods more richness than they are usually credited for.</p><p hwp:id="p-49">Dimensionality reduction addresses the underlying goal of nearly all single-cell analytic pipelines – to determine which cells are phenotypically similar to one another, or in mathematical terms, to derive a biologically meaningful metric between cells. If we could meet this goal perfectly, we could immediately obtain perfect clusterings of single-cell data (each cluster would be a connected component of the <italic toggle="yes">k</italic>-nearest neighbor graph), perform perfect batch correction (by integrating cells based on phenotypic similarity), and substantially improve trajectory inference (by connecting similar cells along a continuous path). Dimensionality reduction represents single-cell data in a lower-dimensional Euclidean space, which inherits natural metrics (e.g. the standard Euclidean distance). SCA provides an embedding based on Shannon information where</p><p hwp:id="p-50">Euclidean distance better captures biological similarity, causing cells with similar phenotypes to cluster together.</p><sec id="s3a" hwp:id="sec-10"><title hwp:id="title-13">Software availability</title><p hwp:id="p-51">SCA is implemented in Python, installed on PyPi (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://pypi.org/project/shannonca/" ext-link-type="uri" xlink:href="https://pypi.org/project/shannonca/" hwp:id="ext-link-5">https://pypi.org/project/shannonca/</ext-link>) for ease of use, and offers integration with scanpy, a popular scRNA processing framework. It is freely available at <monospace>github.com/bendemeo/shannonca</monospace>, and fully documented at <monospace>shannonca.readthedocs.io</monospace>.</p></sec></sec><sec id="s4" hwp:id="sec-11"><title hwp:id="title-14">Methods</title><sec id="s4a" hwp:id="sec-12"><title hwp:id="title-15">Synthetic Data Experiments</title><p hwp:id="p-52">The synthetic dataset analyzed in <xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-10" hwp:rel-id="F2">Figure 2</xref> was generated using numpy [<xref ref-type="bibr" rid="c41" hwp:id="xref-ref-41-1" hwp:rel-id="ref-41">41</xref>] and scanpy [<xref ref-type="bibr" rid="c42" hwp:id="xref-ref-42-1" hwp:rel-id="ref-42">42</xref>]. Nonzero expression values are drawn randomly with replacement from the nonzero log-TPM expression values of the cytotoxic T-cell dataset from [<xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-7" hwp:rel-id="ref-19">19</xref>], which is analyzed in <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-12" hwp:rel-id="F3">Figure 3</xref> and described below.</p><p hwp:id="p-53">The locations of the nonzero expression values are chosen to noisily divide the data into a “common” population of 475 cells and a “rare” population of 25 cells (5% of the total). 20 “marker” genes are expressed with frequency 90% in the rare population, and 15% in the common population. The remaining 1,000 “noise” genes are expressed uniformly at random, with each cell having a 20% chance of expressing each noise gene.</p><p hwp:id="p-54">For PCA representations, we compute 50 PCs using scanpy’s <monospace>pca</monospace> function [<xref ref-type="bibr" rid="c42" hwp:id="xref-ref-42-2" hwp:rel-id="ref-42">42</xref>], which in turn uses the implementation of <monospace>scikit-learn</monospace> [<xref ref-type="bibr" rid="c43" hwp:id="xref-ref-43-1" hwp:rel-id="ref-43">43</xref>], with default parameters. We performed ICA using the <monospace>scikit-learn</monospace> implementation of <monospace>fastICA</monospace> [<xref ref-type="bibr" rid="c43" hwp:id="xref-ref-43-2" hwp:rel-id="ref-43">43</xref>, <xref ref-type="bibr" rid="c44" hwp:id="xref-ref-44-1" hwp:rel-id="ref-44">44</xref>]. We ran SCA with a neighborhood size of 15 for 1-4 iterations with 20 components, and an automatically-determined multiple testing correction factor of 301 (see below and Algorithm S1). In each representation, we computed the 15-nearest-neighbor graph using the Euclidean distance metric. The resulting neighborhood graphs were then used to generate the UMAP plots shown in <xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-11" hwp:rel-id="F2">Figure 2b</xref>, using <monospace>scanpy</monospace>’s implementation with default parameters [<xref ref-type="bibr" rid="c42" hwp:id="xref-ref-42-3" hwp:rel-id="ref-42">42</xref>, <xref ref-type="bibr" rid="c20" hwp:id="xref-ref-20-3" hwp:rel-id="ref-20">20</xref>]. Silhouette scores were computed using the <monospace>silhouette_score</monospace> method from <monospace>scikit-learn</monospace> [<xref ref-type="bibr" rid="c43" hwp:id="xref-ref-43-3" hwp:rel-id="ref-43">43</xref>, <xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-2" hwp:rel-id="ref-21">21</xref>].</p></sec><sec id="s4b" hwp:id="sec-13"><title hwp:id="title-16">T-cell data from Hao et al</title><p hwp:id="p-55">We obtained transcriptomic data from the authors’ website at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://atlas.fredhutch.org/nygc/multimodal-pbmc/" ext-link-type="uri" xlink:href="https://atlas.fredhutch.org/nygc/multimodal-pbmc/" hwp:id="ext-link-6">https://atlas.fredhutch.org/nygc/multimodal-pbmc/</ext-link>. The log-transformed count data was subset to T-cells using the authors’ annotations, yielding 73,259 T-cells and 20,729 genes across all 8 patients. We then split by patient into 8 donor-specific datasets. For each donor, we computed an SCA reduction using 50 components and 5 iterations, with a neighborhood size of 100 (a larger neighborhood size than that used for the cytotoxic T-cell data is appropriate, because the input data is larger). 50 principal components were computed using scanpy’s <monospace>pca</monospace> function, and 50 independent components were computed with the <monospace>FastICA</monospace> implementation provided by <monospace>scikit-learn</monospace> [<xref ref-type="bibr" rid="c44" hwp:id="xref-ref-44-2" hwp:rel-id="ref-44">44</xref>, <xref ref-type="bibr" rid="c43" hwp:id="xref-ref-43-4" hwp:rel-id="ref-43">43</xref>]. To ensure convergence of <monospace>FastICA</monospace>, we raised the maximum number of iterations to 500 from the default of 200. We ran scVI with default parameters (learning rate 0.001, 400 warmup epochs for KL divergence term), and a 50-dimensional latent embedding space to match the dimensionality of the PCA, ICA, and SCA embeddings. We computed 15-nearest-neighbor graphs in each representation using the Euclidean distance metric, then ran UMAP [<xref ref-type="bibr" rid="c20" hwp:id="xref-ref-20-4" hwp:rel-id="ref-20">20</xref>] and Leiden clustering [<xref ref-type="bibr" rid="c27" hwp:id="xref-ref-27-2" hwp:rel-id="ref-27">27</xref>] on the resulting neighborhood graphs. For Leiden clustering, we use the default resolution of 1.0.</p><p hwp:id="p-56">We used the following procedure to identify a subset <italic toggle="yes">S</italic> of clusters achieving high F1 score for each target population <italic toggle="yes">P</italic>, from a set of <italic toggle="yes">T</italic> clusters <italic toggle="yes">c</italic><sub>1</sub>,…, <italic toggle="yes">c<sub>T</sub></italic>.
<list list-type="order" hwp:id="list-1"><list-item hwp:id="list-item-1"><p hwp:id="p-57">Rank all clusters by the degree of overlap with <italic toggle="yes">P</italic>, i.e. by <inline-formula hwp:id="inline-formula-1"><alternatives hwp:id="alternatives-1"><inline-graphic xlink:href="427303v3_inline1.gif" hwp:id="inline-graphic-1"/></alternatives></inline-formula>. Ties may be handled arbitrarily. Assume without loss of generality that the indexing <italic toggle="yes">c</italic><sub>1</sub>,…, <italic toggle="yes">c<sub>T</sub></italic> ranks the clusters in this way. Initialize <italic toggle="yes">S</italic> to be empty.</p></list-item><list-item hwp:id="list-item-2"><p hwp:id="p-58">for <italic toggle="yes">i</italic> in 1,2,…,<italic toggle="yes">T</italic>:
<list list-type="alpha-lower" hwp:id="list-2"><list-item hwp:id="list-item-3"><p hwp:id="p-59">Measure the F1 score of <italic toggle="yes">S</italic> ∪ <italic toggle="yes">c<sub>i</sub></italic> with respect to <italic toggle="yes">P</italic>.</p></list-item><list-item hwp:id="list-item-4"><p hwp:id="p-60">If this F1 score is higher than that of <italic toggle="yes">S</italic>, add <italic toggle="yes">c<sub>i</sub></italic> to <italic toggle="yes">S</italic>. Otherwise, stop and return the current F1 score of <italic toggle="yes">S</italic> with respect to <italic toggle="yes">P</italic>.</p></list-item></list></p></list-item><list-item hwp:id="list-item-5"><p hwp:id="p-61">Return the F1 score of <italic toggle="yes">S</italic> (if not already returned above).</p></list-item></list></p><p hwp:id="p-62">If the target population is a union of clusters, this procedure is guaranteed to find it; otherwise, it finds a set of clusters which approximates <italic toggle="yes">P</italic>.</p></sec><sec id="s4c" hwp:id="sec-14"><title hwp:id="title-17">Cytotoxic T-cell Population Discovery</title><p hwp:id="p-63">We extracted all cytotoxic T-cells from the SS3 dataset in [<xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-8" hwp:rel-id="ref-19">19</xref>] using the authors’ cell type annotations, obtaining 307 cells in total. For PCA, we used scanpy’s <monospace>pca</monospace> function with 20 components. For ICA, we used the <monospace>FastICA</monospace> function of <monospace>sklearn</monospace> [<xref ref-type="bibr" rid="c43" hwp:id="xref-ref-43-5" hwp:rel-id="ref-43">43</xref>, <xref ref-type="bibr" rid="c44" hwp:id="xref-ref-44-3" hwp:rel-id="ref-44">44</xref>], again with 20 components. For SCA, we ran five iterations with 20 components each, starting with the PCA representation. We ran scVI with default parameters on the top 4000 most variable genes (we observed little difference in performance when running on all genes). 15-nearest neighbors graphs were computed in each representation using Euclidean distance, and the results were used to generate the UMAP plots in <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-13" hwp:rel-id="F3">Figure 3</xref>. Leiden clusters in each representation were computed with the default resolution of 1.0. Matrix plots to show expression of key marker genes were generated using scanpy’s <monospace>matrixplot</monospace> function.</p><sec id="s4c1" hwp:id="sec-15"><title hwp:id="title-18">Imputation using MAGIC</title><p hwp:id="p-64">To create SCA-MAGIC, we use the <monospace>graphtools</monospace> package to build a diffusion operator based on a 20-dimensional SCA reduction, with default parameters inherited from MAGIC (<italic toggle="yes">knn=5, knn_max=15, decay=1, thresh=0.0001</italic>). We use the same parameters to construct an analogous operator from a 20-dimensional PCA embedding. We then build <monospace>MAGIC</monospace> instances from these two operators, with time parameter <italic toggle="yes">t=5</italic>, and compare performance on various datasets.</p><p hwp:id="p-65">To generate artificial dropouts in the cytotoxic T-cell data, we replaced a random subset of the pooled nonzero transcript measurements with zeros, comprising either 10%, 30%, 50%, or 90% of the total nonzero measurements. After performing imputation, we re-examined the transcripts that had been eliminated, and checked whether they had been restored. High imputed values indicate well-restored transcripts.</p></sec></sec><sec id="s4d" hwp:id="sec-16"><title hwp:id="title-19">Details of the SCA Algorithm</title><sec id="s4d1" hwp:id="sec-17"><title hwp:id="title-20">Information score matrix computation (<xref ref-type="fig" rid="alg1" hwp:id="xref-statement-1-2" hwp:rel-id="statement-1">Algorithm 1</xref>)</title><p hwp:id="p-66">Given the input data <italic toggle="yes">X</italic> with <italic toggle="yes">N</italic> cells and <italic toggle="yes">M</italic> genes, a target dimensionality <italic toggle="yes">D</italic>, and a neighborhood size <italic toggle="yes">k</italic>, we first compute a <italic toggle="yes">D</italic>-dimensional PCA reduction of <italic toggle="yes">X</italic>. Using Euclidean distance in this PCA space, we compute for each cell <italic toggle="yes">c</italic> a neighborhood <italic toggle="yes">N<sub>k</sub></italic>(<italic toggle="yes">c</italic>) containing the <italic toggle="yes">k</italic> nearest cells. Alternatively, the user may specify neighborhoods manually as lists of indices.</p><p hwp:id="p-67">For each gene <italic toggle="yes">g</italic> and cell <italic toggle="yes">c</italic>, we then assess the significance of <italic toggle="yes">g</italic>’s expression in <italic toggle="yes">N<sub>k</sub></italic>(<italic toggle="yes">c</italic>) as compared to its global expression. Under the null hypothesis, where <italic toggle="yes">g</italic> is randomly expressed, the local distribution <italic toggle="yes">N<sub>k</sub></italic>(<italic toggle="yes">c</italic>) should be similar to the global expression. Using a Wilcoxon rank-sum test, we obtain a two-sided <italic toggle="yes">p</italic>-value <italic toggle="yes">p<sub>c,g</sub></italic> representing the probability of the observed difference under this null hypothesis. We also offer two alternative <italic toggle="yes">p</italic>-values based on different models: a t-test, and a binomial test using only the binarized counts. We strongly recommend the Wilcoxon model for its flexibility to a wide range of data distributions, and robustness to different pre-processing protocols.</p><p hwp:id="p-68">Small <italic toggle="yes">p</italic>-values indicate very unlikely events under the null hypothesis, leading to high surprisal. However, since tens of thousands of genes are often measured for each cell, we would expect <italic toggle="yes">p<sub>c,g</sub></italic> to be very low for some cell-gene combinations even in the absence of true biological signal. We therefore adjust for multiple-testing within each cell using a family-wise error rate correction. If we assume that genes are uncorrelated, this correction takes the form
<disp-formula hwp:id="disp-formula-1">
<alternatives hwp:id="alternatives-2"><graphic xlink:href="427303v3_ueqn1.gif" position="float" orientation="portrait" hwp:id="graphic-6"/></alternatives>
</disp-formula>
where <italic toggle="yes">M</italic> is the number of genes. The corrected value <inline-formula hwp:id="inline-formula-2"><alternatives hwp:id="alternatives-3"><inline-graphic xlink:href="427303v3_inline2.gif" hwp:id="inline-graphic-2"/></alternatives></inline-formula> represents the probability that <italic toggle="yes">any</italic> gene has the observed deviation from the null distribution in <italic toggle="yes">c</italic>’s neighborhood. However, in real single-cell data, genes are often highly correlated, so the effective number of independent features is far fewer than <italic toggle="yes">M</italic>. As detailed in Supplementary Note 4 and Algorithm S1, we can identify a reasonable exponent <italic toggle="yes">N<sub>t</sub></italic> by sampling many random sets of <italic toggle="yes">k</italic> cells from <italic toggle="yes">X</italic>, computing <italic toggle="yes">p</italic>-values from these random neighborhoods, and observing the distribution of these <italic toggle="yes">p</italic>-values. This provides a background model for contextualizing the <italic toggle="yes">p<sub>c,g</sub></italic> values computed from the actual locally derived <italic toggle="yes">k</italic>-nearest neighborhoods, and leads to the correction
<disp-formula hwp:id="disp-formula-2">
<alternatives hwp:id="alternatives-4"><graphic xlink:href="427303v3_ueqn2.gif" position="float" orientation="portrait" hwp:id="graphic-7"/></alternatives>
</disp-formula>
where <italic toggle="yes">N<sub>t</sub></italic> is often far less than <italic toggle="yes">M</italic>. When <italic toggle="yes">N<sub>t</sub></italic> is computed as in Supplementary Note 4, SCA does not produce erroneous clusters on negative control datasets which lack intrinsic structure, and randomly-generated neighborhoods yield scores clustered around zero (Supplementary Note 3, Supplementary Figure S3). SCA computes <italic toggle="yes">N<sub>t</sub></italic> in this way by default; however, users may also manually define <italic toggle="yes">N<sub>t</sub></italic> to adjust the balance between sensitivity and specificity.</p><p hwp:id="p-69">We next convert the corrected <italic toggle="yes">p</italic>-values <inline-formula hwp:id="inline-formula-3"><alternatives hwp:id="alternatives-5"><inline-graphic xlink:href="427303v3_inline3.gif" hwp:id="inline-graphic-3"/></alternatives></inline-formula> into information scores <italic toggle="yes">I</italic>(<italic toggle="yes">c, g</italic>). Shannon [<xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-2" hwp:rel-id="ref-18">18</xref>] defines the <italic toggle="yes">surprisal</italic> or <italic toggle="yes">self-information</italic> of an event with probability <italic toggle="yes">p</italic> as −log(<italic toggle="yes">p</italic>). Intuitively, less probable events are more informative when they occur. For a given cell <italic toggle="yes">c</italic> and gene <italic toggle="yes">g</italic>, <inline-formula hwp:id="inline-formula-4"><alternatives hwp:id="alternatives-6"><inline-graphic xlink:href="427303v3_inline4.gif" hwp:id="inline-graphic-4"/></alternatives></inline-formula> is the probability of the event that that one of <italic toggle="yes">c</italic>’s genes has a local distribution at least as extreme as the observed distribution of <italic toggle="yes">g</italic>, under the null hypothesis of random gene expression. Thus, <inline-formula hwp:id="inline-formula-5"><alternatives hwp:id="alternatives-7"><inline-graphic xlink:href="427303v3_inline5.gif" hwp:id="inline-graphic-5"/></alternatives></inline-formula> is the surprisal of this event, and defines the magnitude of <italic toggle="yes">I</italic>(<italic toggle="yes">c, g</italic>).</p><p hwp:id="p-70">To distinguish over-expression from under-expression, we give <italic toggle="yes">I</italic>(<italic toggle="yes">c, g</italic>) a positive sign if <italic toggle="yes">g</italic> is over-expressed in <italic toggle="yes">c</italic>’s neighborhood and a negative sign if it is under-expressed. Under the Wilcoxon model, over- or underexpression is determined by the sum of the ranks of <italic toggle="yes">g</italic>’s values in the <italic toggle="yes">k</italic>-neighborhood of <italic toggle="yes">c</italic> among all values <italic toggle="yes">g</italic> takes, which we denote ranksum(<italic toggle="yes">g, N<sub>k</sub></italic>(<italic toggle="yes">c</italic>)). Under the null hypothesis, this quantity follows a normal distribution with mean <inline-formula hwp:id="inline-formula-6"><alternatives hwp:id="alternatives-8"><inline-graphic xlink:href="427303v3_inline6.gif" hwp:id="inline-graphic-6"/></alternatives></inline-formula>. Thus, we obtain
<disp-formula hwp:id="disp-formula-3">
<alternatives hwp:id="alternatives-9"><graphic xlink:href="427303v3_ueqn3.gif" position="float" orientation="portrait" hwp:id="graphic-8"/></alternatives>
</disp-formula></p></sec><sec id="s4d2" hwp:id="sec-18"><title hwp:id="title-21">Computing Shannon components (<xref ref-type="fig" rid="alg2" hwp:id="xref-statement-2-2" hwp:rel-id="statement-2">Algorithm 2</xref>)</title><p hwp:id="p-71">From the information scores <italic toggle="yes">I</italic>(<italic toggle="yes">c, g</italic>), SCA next seeks to generate an informative linear combination of genes. For a given combination defined by
<disp-formula hwp:id="disp-formula-4">
<alternatives hwp:id="alternatives-10"><graphic xlink:href="427303v3_ueqn4.gif" position="float" orientation="portrait" hwp:id="graphic-9"/></alternatives>
</disp-formula>
we say that <inline-formula hwp:id="inline-formula-7"><alternatives hwp:id="alternatives-11"><inline-graphic xlink:href="427303v3_inline7.gif" hwp:id="inline-graphic-7"/></alternatives></inline-formula> has <italic toggle="yes">loadings α</italic><sub>1</sub>,…, <italic toggle="yes">α<sub>n</sub></italic>. For a fixed cell <italic toggle="yes">c</italic>, we formulate the information score of <inline-formula hwp:id="inline-formula-8"><alternatives hwp:id="alternatives-12"><inline-graphic xlink:href="427303v3_inline8.gif" hwp:id="inline-graphic-8"/></alternatives></inline-formula> as
<disp-formula hwp:id="disp-formula-5">
<alternatives hwp:id="alternatives-13"><graphic xlink:href="427303v3_ueqn5.gif" position="float" orientation="portrait" hwp:id="graphic-10"/></alternatives>
</disp-formula></p><p hwp:id="p-72">We then define the overall overall information score of <inline-formula hwp:id="inline-formula-9"><alternatives hwp:id="alternatives-14"><inline-graphic xlink:href="427303v3_inline9.gif" hwp:id="inline-graphic-9"/></alternatives></inline-formula> by taking the norm over all cells:
<disp-formula hwp:id="disp-formula-6">
<alternatives hwp:id="alternatives-15"><graphic xlink:href="427303v3_ueqn6.gif" position="float" orientation="portrait" hwp:id="graphic-11"/></alternatives>
</disp-formula>
or, in matrix notation,
<disp-formula hwp:id="disp-formula-7">
<alternatives hwp:id="alternatives-16"><graphic xlink:href="427303v3_ueqn7.gif" position="float" orientation="portrait" hwp:id="graphic-12"/></alternatives>
</disp-formula>
where <bold>S</bold> denotes the information score matrix and <italic toggle="yes">α</italic> = 〈<italic toggle="yes">α</italic><sub>1</sub>,…, <italic toggle="yes">α<sub>M</sub></italic>〉.</p><p hwp:id="p-73">We now seek the metagene <inline-formula hwp:id="inline-formula-10"><alternatives hwp:id="alternatives-17"><inline-graphic xlink:href="427303v3_inline10.gif" hwp:id="inline-graphic-10"/></alternatives></inline-formula>, defined by the loadings <italic toggle="yes">α</italic><sub>1</sub>,…, <italic toggle="yes">α<sub>N</sub></italic>, that maximizes <inline-formula hwp:id="inline-formula-11"><alternatives hwp:id="alternatives-18"><inline-graphic xlink:href="427303v3_inline11.gif" hwp:id="inline-graphic-11"/></alternatives></inline-formula>. Since we can achieve arbitrarily large values of <inline-formula hwp:id="inline-formula-12"><alternatives hwp:id="alternatives-19"><inline-graphic xlink:href="427303v3_inline12.gif" hwp:id="inline-graphic-12"/></alternatives></inline-formula> by scaling the coefficients, we constrain the loading coefficients to have norm 1, that is:
<disp-formula hwp:id="disp-formula-8">
<alternatives hwp:id="alternatives-20"><graphic xlink:href="427303v3_ueqn8.gif" position="float" orientation="portrait" hwp:id="graphic-13"/></alternatives>
</disp-formula></p><p hwp:id="p-74">It is a standard linear algebra result that this maximum is realized by the leading right-eigenvector of <bold>S</bold> (proof in Supplementary Note 1 and [<xref ref-type="bibr" rid="c45" hwp:id="xref-ref-45-1" hwp:rel-id="ref-45">45</xref>]). Thus, the first Shannon component loading vector is simply the first right eigenvector of <bold>S</bold>, which we denote <bold>v</bold><sub>1</sub>. To obtain additional Shannon components, we repeat the optimization with the constraint
<disp-formula hwp:id="disp-formula-9">
<alternatives hwp:id="alternatives-21"><graphic xlink:href="427303v3_ueqn9.gif" position="float" orientation="portrait" hwp:id="graphic-14"/></alternatives>
</disp-formula></p><p hwp:id="p-75">It is straightforward to see (Supplementary Note 1) that this yields the second principal component loading vector <bold>v</bold><sub>2</sub> of <bold>S</bold>. Continuing, we see that the loading vectors for Shannon components are simply the right eigenvectors of <bold>S</bold>.</p><p hwp:id="p-76">SCA next computes the values of the first <italic toggle="yes">D</italic> Shannon components over the <italic toggle="yes">input</italic> data (not the information scores). That is,
<disp-formula hwp:id="disp-formula-10">
<alternatives hwp:id="alternatives-22"><graphic xlink:href="427303v3_ueqn10.gif" position="float" orientation="portrait" hwp:id="graphic-15"/></alternatives>
</disp-formula></p><p hwp:id="p-77">Note that the Shannon components are linear functions of the input data, despite the nonlinear construction of <bold>S</bold>. Although the loadings are computed on <bold>S</bold>, the values of the components are computed by applying these loadings to <bold>X</bold>.</p><p hwp:id="p-78">If desired, we can now use the resulting <italic toggle="yes">D</italic>-dimensional representation of <italic toggle="yes">X</italic> to compute a Euclidean <italic toggle="yes">k</italic>-nearest neighbor graph, compute a new information score matrix from these neighborhoods, and perform SCA on this new matrix to produce another <italic toggle="yes">D</italic>-dimensional representation of <italic toggle="yes">X</italic>. This can be repeated arbitrarily many times, and often improves performance up to 3-4 iterations (<xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-14" hwp:rel-id="F3">Figure 3f</xref>, Figure S2).</p><sec id="s4d2a" hwp:id="sec-19"><title hwp:id="title-22">Time and memory optimizations</title><p hwp:id="p-79">Computing the information scores <italic toggle="yes">I</italic>(<italic toggle="yes">c, g</italic>) for all cells <italic toggle="yes">c</italic> and genes <italic toggle="yes">g</italic> requires <italic toggle="yes">NM</italic> Wilcoxon rank-sum tests. However, we can rapidly produce all of the rank-sum statistics with minimal memory overhead as follows:
<list list-type="order" hwp:id="list-3"><list-item hwp:id="list-item-6"><p hwp:id="p-80">Divide the genes into chunks of a user-specified size <italic toggle="yes">C</italic>, depending on memory constraints (default 1000). Let <italic toggle="yes">G</italic><sub>1</sub> = {<italic toggle="yes">g</italic><sub>1</sub>,…, <italic toggle="yes">g<sub>C</sub></italic>}, <italic toggle="yes">G</italic><sub>2</sub> = {<italic toggle="yes">g</italic><sub><italic toggle="yes">C</italic>+1</sub>,…., <italic toggle="yes">g</italic><sub>2<italic toggle="yes">C</italic></sub>}, and so on.</p></list-item><list-item hwp:id="list-item-7"><p hwp:id="p-81">For each gene chunk <italic toggle="yes">G<sub>i</sub></italic>:
<list list-type="alpha-lower" hwp:id="list-4"><list-item hwp:id="list-item-8"><p hwp:id="p-82">Subset <italic toggle="yes">X</italic> to genes in <italic toggle="yes">G<sub>i</sub></italic>, obtaining a reduced dataset <italic toggle="yes">X<sub>i</sub></italic></p></list-item><list-item hwp:id="list-item-9"><p hwp:id="p-83">rank each column of <italic toggle="yes">X<sub>i</sub></italic> to obtain a rank matrix <italic toggle="yes">R<sub>i</sub></italic></p></list-item><list-item hwp:id="list-item-10"><p hwp:id="p-84">Multiply the adjacency matrix <italic toggle="yes">A</italic> with <italic toggle="yes">R<sub>i</sub></italic>, yielding a rank-sum matrix over neighborhoods, denoted <italic toggle="yes">S<sub>i</sub></italic>, overwriting <italic toggle="yes">R<sub>i</sub></italic></p></list-item><list-item hwp:id="list-item-11"><p hwp:id="p-85">Convert these rank-sums into <italic toggle="yes">p</italic>-values under to the null model, overwriting <italic toggle="yes">S<sub>i</sub></italic> with a <italic toggle="yes">p</italic>-value matrix <italic toggle="yes">P<sub>i</sub></italic></p></list-item><list-item hwp:id="list-item-12"><p hwp:id="p-86">Convert these <italic toggle="yes">p</italic>-values into Information scores, as described in <xref ref-type="fig" rid="alg1" hwp:id="xref-statement-1-3" hwp:rel-id="statement-1">Algorithm 1</xref>, overwriting <italic toggle="yes">P<sub>i</sub></italic> with information scores <italic toggle="yes">S<sub>i</sub></italic>.</p></list-item><list-item hwp:id="list-item-13"><p hwp:id="p-87">Sparsify <italic toggle="yes">S<sub>i</sub></italic> and record it. (<italic toggle="yes">S<sub>i</sub></italic> is frequently quite sparse).</p></list-item></list></p></list-item><list-item hwp:id="list-item-14"><p hwp:id="p-88">Concatenate the matrices <italic toggle="yes">S<sub>i</sub></italic> horizontally to obtain the information score matrix <italic toggle="yes">S</italic>.</p></list-item></list></p><p hwp:id="p-89">Using this approach, we only need to compute ranks for each gene once, and we avoid storing dense matrices of size larger than <italic toggle="yes">N</italic> × <italic toggle="yes">C</italic>. Since <italic toggle="yes">A</italic> has at most <italic toggle="yes">k</italic> nonzero elements per row, the sparse matrix multiplication in step 2c requires only O(kNC) time. The remaining steps are easily accomplished with vectorized functions from scipy [<xref ref-type="bibr" rid="c46" hwp:id="xref-ref-46-1" hwp:rel-id="ref-46">46</xref>] and <monospace>numpy</monospace> [<xref ref-type="bibr" rid="c41" hwp:id="xref-ref-41-2" hwp:rel-id="ref-41">41</xref>].</p><p hwp:id="p-90">With these improvements, SCA is nearly as fast as ICA and PCA, and uses significantly less memory than ICA. For example, running SCA on Patient 1 from the Hao et al. dataset ( 9,000 cells and 20,000 genes) finishes in about 5 minutes and allocates about 500MB of RAM (Figure S1). We include more in-depth time and memory benchmarks in Supplementary Note 2 and Figure S1.</p></sec></sec></sec></sec><sec sec-type="supplementary-material" hwp:id="sec-20"><title hwp:id="title-23">Supporting information</title><supplementary-material position="float" orientation="portrait" hwp:id="DC1"><object-id pub-id-type="other" hwp:sub-type="slug">DC1</object-id><label>Supplementary Notes and Figures</label><media xlink:href="supplements/427303_file02.pdf" position="float" orientation="portrait" hwp:id="media-1"/></supplementary-material></sec></body><back><ack hwp:id="ack-1"><title hwp:id="title-24">Acknowledgements</title><p hwp:id="p-91">The authors are grateful to Ashwin Narayan, Brian Hie, Hyunghoon Cho, Sarah Nyquist, Rohit Singh, Ellen Zhong, and other members of the Berger lab for their continual support and helpful feedback. We also thank Josh Peters, Bryan Bryson, and Cheng-Zhong Zhang for helpful conversations on SCA’s applications and valuable suggestions for biological applications. This work was supported by the National Institutes of Health U01CA250554 [to B.B.].</p></ack><sec hwp:id="sec-21"><statement id="alg1" hwp:id="statement-1" hwp:rev-id="xref-statement-1-1 xref-statement-1-2 xref-statement-1-3"><label>Algorithm 1:</label><title hwp:id="title-25">InfoScore</title><p hwp:id="p-92"><fig id="alg1a" position="float" fig-type="figure" orientation="portrait" hwp:id="F6"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;2021.01.19.427303v3/ALG1A</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F6</object-id><object-id pub-id-type="publisher-id">alg1a</object-id><graphic xlink:href="427303v3_ufig1" position="float" orientation="portrait" hwp:id="graphic-16"/></fig></p></statement><statement id="alg2" hwp:id="statement-2" hwp:rev-id="xref-statement-2-1 xref-statement-2-2"><label>Algorithm 2:</label><title hwp:id="title-26">SCA</title><p hwp:id="p-93"><fig id="alg2a" position="float" fig-type="figure" orientation="portrait" hwp:id="F7"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;2021.01.19.427303v3/ALG2A</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F7</object-id><object-id pub-id-type="publisher-id">alg2a</object-id><graphic xlink:href="427303v3_ufig2" position="float" orientation="portrait" hwp:id="graphic-17"/></fig></p></statement></sec><ref-list hwp:id="ref-list-1"><title hwp:id="title-27">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1 xref-ref-1-2"><label>[1]</label><citation publication-type="other" citation-type="journal" ref:id="2021.01.19.427303v3.1" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Park J. H."><surname>Park</surname>, <given-names>J. H.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Lee H. K."><surname>Lee</surname>, <given-names>H. K.</given-names></string-name> <article-title hwp:id="article-title-2">Function of <italic toggle="yes">γδ</italic> t cells in tumor immunology and their application to cancer therapy</article-title>. <source hwp:id="source-1">Experimental &amp; Molecular Medicine</source> <fpage>1</fpage>–<lpage>10</lpage> (<year>2021</year>).</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1 xref-ref-2-2 xref-ref-2-3"><label>[2]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.2" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="Parrot T."><surname>Parrot</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-3">Expansion of donor-unrestricted mait cells with enhanced cytolytic function suitable for tcr redirection</article-title>. <source hwp:id="source-2">JCI insight</source> <volume>6</volume> (<year>2021</year>).</citation></ref><ref id="c3" hwp:id="ref-3" hwp:rev-id="xref-ref-3-1 xref-ref-3-2 xref-ref-3-3"><label>[3]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.3" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Saunders A."><surname>Saunders</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-4">Molecular diversity and specializations among the cells of the adult mouse brain</article-title>. <source hwp:id="source-3">Cell</source> <volume>174</volume>, <fpage>1015</fpage>–<lpage>1030</lpage> (<year>2018</year>).</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1"><label>[4]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.4" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Zheng G. X."><surname>Zheng</surname>, <given-names>G. X.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-5">Massively parallel digital transcriptional profiling of single cells</article-title>. <source hwp:id="source-4">Nature communications</source> <volume>8</volume>, <fpage>1</fpage>–<lpage>12</lpage> (<year>2017</year>).</citation></ref><ref id="c5" hwp:id="ref-5" hwp:rev-id="xref-ref-5-1 xref-ref-5-2 xref-ref-5-3 xref-ref-5-4 xref-ref-5-5 xref-ref-5-6"><label>[5]</label><citation publication-type="other" citation-type="journal" ref:id="2021.01.19.427303v3.5" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Hao Y."><surname>Hao</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-6">Integrated analysis of multimodal single-cell data</article-title>. <source hwp:id="source-5">bioRxiv</source> (<year>2020</year>).</citation></ref><ref id="c6" hwp:id="ref-6" hwp:rev-id="xref-ref-6-1"><label>[6]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.6" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Nascimento M."><surname>Nascimento</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-7">Independent component analysis (ica) based-clustering of temporal rna-seq data</article-title>. <source hwp:id="source-6">PloS one</source> <volume>12</volume>, <fpage>e0181195</fpage> (<year>2017</year>).</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1"><label>[7]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.7" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Lopez R."><surname>Lopez</surname>, <given-names>R.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Regier J."><surname>Regier</surname>, <given-names>J.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Cole M. B."><surname>Cole</surname>, <given-names>M. B.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Jordan M. I."><surname>Jordan</surname>, <given-names>M. I.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Yosef N."><surname>Yosef</surname>, <given-names>N.</given-names></string-name> <article-title hwp:id="article-title-8">Deep generative modeling for single-cell transcriptomics</article-title>. <source hwp:id="source-7">Nature methods</source> <volume>15</volume>, <fpage>1053</fpage>–<lpage>1058</lpage> (<year>2018</year>).</citation></ref><ref id="c8" hwp:id="ref-8" hwp:rev-id="xref-ref-8-1 xref-ref-8-2 xref-ref-8-3 xref-ref-8-4"><label>[8]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Wen L."><surname>Wen</surname>, <given-names>L.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Tang F."><surname>Tang</surname>, <given-names>F.</given-names></string-name> <article-title hwp:id="article-title-9">How to catch rare cell types</article-title>. <source hwp:id="source-8">Nature</source> <volume>525</volume>, <fpage>197</fpage>–<lpage>198</lpage> (<year>2015</year>).</citation></ref><ref id="c9" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1 xref-ref-9-2 xref-ref-9-3 xref-ref-9-4 xref-ref-9-5"><label>[9]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.9" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Dong R."><surname>Dong</surname>, <given-names>R.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Yuan G.-C."><surname>Yuan</surname>, <given-names>G.-C.</given-names></string-name> <article-title hwp:id="article-title-10">Giniclust3: a fast and memory-efficient tool for rare cell type identification</article-title>. <source hwp:id="source-9">BMC bioinformatics</source> <volume>21</volume>, <fpage>1</fpage>–<lpage>7</lpage> (<year>2020</year>).</citation></ref><ref id="c10" hwp:id="ref-10" hwp:rev-id="xref-ref-10-1 xref-ref-10-2 xref-ref-10-3 xref-ref-10-4"><label>[10]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="Wegmann R."><surname>Wegmann</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-11">Cellsius provides sensitive and specific detection of rare cell populations from complex single-cell RNA-seq data</article-title>. <source hwp:id="source-10">Genome biology</source> <volume>20</volume>, <fpage>1</fpage>–<lpage>21</lpage> (<year>2019</year>).</citation></ref><ref id="c11" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1 xref-ref-11-2 xref-ref-11-3 xref-ref-11-4"><label>[11]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.11" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="Jindal A."><surname>Jindal</surname>, <given-names>A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gupta P."><surname>Gupta</surname>, <given-names>P.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Sengupta D."><surname>Sengupta</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-12">Discovery of rare cells from voluminous single cell expression data</article-title>. <source hwp:id="source-11">Nature communications</source> <volume>9</volume>, <fpage>1</fpage>–<lpage>9</lpage> (<year>2018</year>).</citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1 xref-ref-12-2 xref-ref-12-3"><label>[12]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.12" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Hie B."><surname>Hie</surname>, <given-names>B.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Cho H."><surname>Cho</surname>, <given-names>H.</given-names></string-name>, <string-name name-style="western" hwp:sortable="DeMeo B."><surname>DeMeo</surname>, <given-names>B.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Bryson B."><surname>Bryson</surname>, <given-names>B.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Berger B."><surname>Berger</surname>, <given-names>B.</given-names></string-name> <article-title hwp:id="article-title-13">Geometric sketching compactly summarizes the single-cell transcriptomic landscape</article-title>. <source hwp:id="source-12">Cell systems</source> <volume>8</volume>, <fpage>483</fpage>–<lpage>493</lpage> (<year>2019</year>).</citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1 xref-ref-13-2 xref-ref-13-3 xref-ref-13-4"><label>[13]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.13" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="DeMeo B."><surname>DeMeo</surname>, <given-names>B.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Berger B."><surname>Berger</surname>, <given-names>B.</given-names></string-name> <article-title hwp:id="article-title-14">Hopper: a mathematically optimal algorithm for sketching biological data</article-title>. <source hwp:id="source-13">Bioinformatics</source> <volume>36</volume>, <fpage>i236</fpage>–<lpage>i241</lpage> (<year>2020</year>).</citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1"><label>[14]</label><citation publication-type="other" citation-type="journal" ref:id="2021.01.19.427303v3.14" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Hie B."><surname>Hie</surname>, <given-names>B.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-15">Computational methods for single-cell RNA sequencing</article-title>. <source hwp:id="source-14">Annual Review of Biomedical Data Science</source> (<year>2020</year>).</citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1 xref-ref-15-2"><label>[15]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.15" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Van Dijk D."><surname>Van Dijk</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-16">Recovering gene interactions from single-cell data using data diffusion</article-title>. <source hwp:id="source-15">Cell</source> <volume>174</volume>, <fpage>716</fpage>–<lpage>729</lpage> (<year>2018</year>).</citation></ref><ref id="c16" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1"><label>[16]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.16" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Wilk A. J."><surname>Wilk</surname>, <given-names>A. J.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-17">A single-cell atlas of the peripheral immune response in patients with severe covid-19</article-title>. <source hwp:id="source-16">Nature medicine</source> <volume>26</volume>, <fpage>1070</fpage>–<lpage>1076</lpage> (<year>2020</year>).</citation></ref><ref id="c17" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1 xref-ref-17-2 xref-ref-17-3"><label>[17]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.17" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="Andreatta M."><surname>Andreatta</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-18">Interpretation of t cell states from single-cell transcriptomics data using reference atlases</article-title>. <source hwp:id="source-17">Nature communications</source> <volume>12</volume>, <fpage>1</fpage>–<lpage>19</lpage> (<year>2021</year>).</citation></ref><ref id="c18" hwp:id="ref-18" hwp:rev-id="xref-ref-18-1 xref-ref-18-2"><label>[18]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.18" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-18"><string-name name-style="western" hwp:sortable="Shannon C. E."><surname>Shannon</surname>, <given-names>C. E.</given-names></string-name> <article-title hwp:id="article-title-19">A mathematical theory of communication</article-title>. <source hwp:id="source-18">The Bell system technical journal</source> <volume>27</volume>, <fpage>379</fpage>–<lpage>423</lpage> (<year>1948</year>).</citation></ref><ref id="c19" hwp:id="ref-19" hwp:rev-id="xref-ref-19-1 xref-ref-19-2 xref-ref-19-3 xref-ref-19-4 xref-ref-19-5 xref-ref-19-6 xref-ref-19-7 xref-ref-19-8"><label>[19]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.19" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-19"><string-name name-style="western" hwp:sortable="Hagemann-Jensen M."><surname>Hagemann-Jensen</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-20">Single-cell RNA counting at allele and isoform resolution using smart-seq3</article-title>. <source hwp:id="source-19">Nature Biotechnology</source> <volume>38</volume>, <fpage>708</fpage>–<lpage>714</lpage> (<year>2020</year>).</citation></ref><ref id="c20" hwp:id="ref-20" hwp:rev-id="xref-ref-20-1 xref-ref-20-2 xref-ref-20-3 xref-ref-20-4"><label>[20]</label><citation publication-type="other" citation-type="journal" ref:id="2021.01.19.427303v3.20" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-20"><string-name name-style="western" hwp:sortable="McInnes L."><surname>McInnes</surname>, <given-names>L.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Healy J."><surname>Healy</surname>, <given-names>J.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Melville J."><surname>Melville</surname>, <given-names>J.</given-names></string-name> <article-title hwp:id="article-title-21">Umap: Uniform manifold approximation and projection for dimension reduction</article-title>. <source hwp:id="source-20">arXiv preprint</source> arXiv:1802.03426 (<year>2018</year>).</citation></ref><ref id="c21" hwp:id="ref-21" hwp:rev-id="xref-ref-21-1 xref-ref-21-2"><label>[21]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.21" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-21"><string-name name-style="western" hwp:sortable="Rousseeuw P. J."><surname>Rousseeuw</surname>, <given-names>P. J.</given-names></string-name> <article-title hwp:id="article-title-22">Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>. <source hwp:id="source-21">Journal of computational and applied mathematics</source> <volume>20</volume>, <fpage>53</fpage>–<lpage>65</lpage> (<year>1987</year>).</citation></ref><ref id="c22" hwp:id="ref-22" hwp:rev-id="xref-ref-22-1 xref-ref-22-2"><label>[22]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.22" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-22"><string-name name-style="western" hwp:sortable="Xu G."><surname>Xu</surname>, <given-names>G.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-23">Dissecting the human immune system with single cell rna sequencing technology</article-title>. <source hwp:id="source-22">Journal of leukocyte biology</source> <volume>107</volume>, <fpage>613</fpage>–<lpage>623</lpage> (<year>2020</year>).</citation></ref><ref id="c23" hwp:id="ref-23" hwp:rev-id="xref-ref-23-1 xref-ref-23-2 xref-ref-23-3"><label>[23]</label><citation publication-type="book" citation-type="book" ref:id="2021.01.19.427303v3.23" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-23"><string-name name-style="western" hwp:sortable="Holtmeier W."><surname>Holtmeier</surname>, <given-names>W.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Kabelitz D."><surname>Kabelitz</surname>, <given-names>D.</given-names></string-name> <chapter-title><italic toggle="yes">γδ</italic> t cells link innate and adaptive immune responses</chapter-title>. In <source hwp:id="source-23">Mechanisms of epithelial defense</source>, vol. <volume>86</volume>, <fpage>151</fpage>–<lpage>183</lpage> (<publisher-name>Karger Publishers</publisher-name>, <year>2005</year>).</citation></ref><ref id="c24" hwp:id="ref-24" hwp:rev-id="xref-ref-24-1 xref-ref-24-2"><label>[24]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.24" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-24"><string-name name-style="western" hwp:sortable="Treiner E."><surname>Treiner</surname>, <given-names>E.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-24">Selection of evolutionarily conserved mucosal-associated invariant t cells by mr1</article-title>. <source hwp:id="source-24">Nature</source> <volume>422</volume>, <fpage>164</fpage>–<lpage>169</lpage> (<year>2003</year>).</citation></ref><ref id="c25" hwp:id="ref-25" hwp:rev-id="xref-ref-25-1"><label>[25]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.25" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-25"><string-name name-style="western" hwp:sortable="Joller N."><surname>Joller</surname>, <given-names>N.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-25">Treg cells expressing the coinhibitory molecule tigit selectively inhibit proinflammatory th1 and th17 cell responses</article-title>. <source hwp:id="source-25">Immunity</source> <volume>40</volume>, <fpage>569</fpage>–<lpage>581</lpage> (<year>2014</year>).</citation></ref><ref id="c26" hwp:id="ref-26" hwp:rev-id="xref-ref-26-1"><label>[26]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.26" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-26"><string-name name-style="western" hwp:sortable="Kunicki M. A."><surname>Kunicki</surname>, <given-names>M. A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Hernandez L. C. A."><surname>Hernandez</surname>, <given-names>L. C. A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Davis K. L."><surname>Davis</surname>, <given-names>K. L.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Bacchetta R."><surname>Bacchetta</surname>, <given-names>R.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Roncarolo M.-G."><surname>Roncarolo</surname>, <given-names>M.-G.</given-names></string-name> <article-title hwp:id="article-title-26">Identity and diversity of human peripheral th and t regulatory cells defined by single-cell mass cytometry</article-title>. <source hwp:id="source-26">The Journal of Immunology</source> <volume>200</volume>, <fpage>336</fpage>–<lpage>346</lpage> (<year>2018</year>).</citation></ref><ref id="c27" hwp:id="ref-27" hwp:rev-id="xref-ref-27-1 xref-ref-27-2"><label>[27]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.27" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-27"><string-name name-style="western" hwp:sortable="Traag V. A."><surname>Traag</surname>, <given-names>V. A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Waltman L."><surname>Waltman</surname>, <given-names>L.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="van Eck N. J."><surname>van Eck</surname>, <given-names>N. J.</given-names></string-name> <article-title hwp:id="article-title-27">From louvain to leiden: guaranteeing well-connected communities</article-title>. <source hwp:id="source-27">Scientific reports</source> <volume>9</volume>, <fpage>1</fpage>–<lpage>12</lpage> (<year>2019</year>).</citation></ref><ref id="c28" hwp:id="ref-28" hwp:rev-id="xref-ref-28-1"><label>[28]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.28" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-28"><string-name name-style="western" hwp:sortable="Vinh N. X."><surname>Vinh</surname>, <given-names>N. X.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Epps J."><surname>Epps</surname>, <given-names>J.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Bailey J."><surname>Bailey</surname>, <given-names>J.</given-names></string-name> <article-title hwp:id="article-title-28">Information theoretic measures for clusterings comparison: Variants, properties, normalization and correction for chance</article-title>. <source hwp:id="source-28">The Journal of Machine Learning Research</source> <volume>11</volume>, <fpage>2837</fpage>–<lpage>2854</lpage> (<year>2010</year>).</citation></ref><ref id="c29" hwp:id="ref-29" hwp:rev-id="xref-ref-29-1"><label>[29]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.29" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-29"><string-name name-style="western" hwp:sortable="Kumpula J. M."><surname>Kumpula</surname>, <given-names>J. M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Saramäki J."><surname>Saramäki</surname>, <given-names>J.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kaski K."><surname>Kaski</surname>, <given-names>K.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Kertész J."><surname>Kertész</surname>, <given-names>J.</given-names></string-name> <article-title hwp:id="article-title-29">Limited resolution in complex network community detection with potts model approach</article-title>. <source hwp:id="source-29">The European Physical Journal B</source> <volume>56</volume>, <fpage>41</fpage>–<lpage>45</lpage> (<year>2007</year>).</citation></ref><ref id="c30" hwp:id="ref-30" hwp:rev-id="xref-ref-30-1"><label>[30]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.30" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-30"><string-name name-style="western" hwp:sortable="Zhu J."><surname>Zhu</surname>, <given-names>J.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Paul W. E."><surname>Paul</surname>, <given-names>W. E.</given-names></string-name> <article-title hwp:id="article-title-30">Heterogeneity and plasticity of t helper cells</article-title>. <source hwp:id="source-30">Cell research</source> <volume>20</volume>, <fpage>4</fpage>–<lpage>12</lpage> (<year>2010</year>).</citation></ref><ref id="c31" hwp:id="ref-31" hwp:rev-id="xref-ref-31-1"><label>[31]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.31" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-31"><string-name name-style="western" hwp:sortable="Lin L."><surname>Lin</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-31">Granzyme b secretion by human memory cd4 t cells is less strictly regulated compared to memory cd8 t cells</article-title>. <source hwp:id="source-31">BMC immunology</source> <volume>15</volume>, <fpage>1</fpage>–<lpage>15</lpage> (<year>2014</year>).</citation></ref><ref id="c32" hwp:id="ref-32" hwp:rev-id="xref-ref-32-1"><label>[32]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.32" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-32"><string-name name-style="western" hwp:sortable="Tritschler S."><surname>Tritschler</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-32">Concepts and limitations for learning developmental trajectories from single cell genomics</article-title>. <source hwp:id="source-32">Development</source> <volume>146</volume> (<year>2019</year>).</citation></ref><ref id="c33" hwp:id="ref-33" hwp:rev-id="xref-ref-33-1"><label>[33]</label><citation publication-type="other" citation-type="journal" ref:id="2021.01.19.427303v3.33" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-33"><string-name name-style="western" hwp:sortable="Jones K. S."><surname>Jones</surname>, <given-names>K. S.</given-names></string-name> <article-title hwp:id="article-title-33">A statistical interpretation of term specificity and its application in retrieval</article-title>. <source hwp:id="source-33">Journal of documentation</source> (<year>1972</year>).</citation></ref><ref id="c34" hwp:id="ref-34" hwp:rev-id="xref-ref-34-1"><label>[34]</label><citation publication-type="book" citation-type="book" ref:id="2021.01.19.427303v3.34" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-34"><string-name name-style="western" hwp:sortable="Levine R. D."><surname>Levine</surname>, <given-names>R. D.</given-names></string-name> <source hwp:id="source-34">Molecular reaction dynamics</source> (<publisher-name>Cambridge University Press</publisher-name>, <year>2009</year>).</citation></ref><ref id="c35" hwp:id="ref-35" hwp:rev-id="xref-ref-35-1 xref-ref-35-2"><label>[35]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.35" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-35"><string-name name-style="western" hwp:sortable="Gross A."><surname>Gross</surname>, <given-names>A.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Levine R. D."><surname>Levine</surname>, <given-names>R. D.</given-names></string-name> <article-title hwp:id="article-title-34">Surprisal analysis of transcripts expression levels in the presence of noise: A reliable determination of the onset of a tumor phenotype</article-title>. <source hwp:id="source-35">PLoS One</source> <volume>8</volume>, <fpage>e61554</fpage> (<year>2013</year>).</citation></ref><ref id="c36" hwp:id="ref-36" hwp:rev-id="xref-ref-36-1"><label>[36]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.36" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-36"><string-name name-style="western" hwp:sortable="Zadran S."><surname>Zadran</surname>, <given-names>S.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Arumugam R."><surname>Arumugam</surname>, <given-names>R.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Herschman H."><surname>Herschman</surname>, <given-names>H.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Phelps M. E."><surname>Phelps</surname>, <given-names>M. E.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Levine R."><surname>Levine</surname>, <given-names>R.</given-names></string-name> <article-title hwp:id="article-title-35">Surprisal analysis characterizes the free energy time course of cancer cells undergoing epithelial-to-mesenchymal transition</article-title>. <source hwp:id="source-36">Proceedings of the National Academy of Sciences</source> <volume>111</volume>, <fpage>13235</fpage>–<lpage>13240</lpage> (<year>2014</year>).</citation></ref><ref id="c37" hwp:id="ref-37" hwp:rev-id="xref-ref-37-1"><label>[37]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.37" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-37"><string-name name-style="western" hwp:sortable="Remacle F."><surname>Remacle</surname>, <given-names>F.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kravchenko-Balasha N."><surname>Kravchenko-Balasha</surname>, <given-names>N.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Levitzki A."><surname>Levitzki</surname>, <given-names>A.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Levine R. D."><surname>Levine</surname>, <given-names>R. D.</given-names></string-name> <article-title hwp:id="article-title-36">Information-theoretic analysis of phenotype changes in early stages of carcinogenesis</article-title>. <source hwp:id="source-37">Proceedings of the National Academy of Sciences</source> <volume>107</volume>, <fpage>10324</fpage>–<lpage>10329</lpage> (<year>2010</year>).</citation></ref><ref id="c38" hwp:id="ref-38" hwp:rev-id="xref-ref-38-1"><label>[38]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.38" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-38"><string-name name-style="western" hwp:sortable="Kravchenko-Balasha N."><surname>Kravchenko-Balasha</surname>, <given-names>N.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-37">On a fundamental structure of gene networks in living cells</article-title>. <source hwp:id="source-38">Proceedings of the National Academy of Sciences</source> <volume>109</volume>, <fpage>4702</fpage>–<lpage>4707</lpage> (<year>2012</year>).</citation></ref><ref id="c39" hwp:id="ref-39" hwp:rev-id="xref-ref-39-1"><label>[39]</label><citation publication-type="other" citation-type="journal" ref:id="2021.01.19.427303v3.39" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-39"><string-name name-style="western" hwp:sortable="Narayan A."><surname>Narayan</surname>, <given-names>A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Berger B."><surname>Berger</surname>, <given-names>B.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Cho H."><surname>Cho</surname>, <given-names>H.</given-names></string-name> <article-title hwp:id="article-title-38">Assessing single-cell transcriptomic variability through densitypreserving data visualization</article-title>. <source hwp:id="source-39">Nature Biotechnology</source> <fpage>1</fpage>–<lpage>10</lpage> (<year>2021</year>).</citation></ref><ref id="c40" hwp:id="ref-40" hwp:rev-id="xref-ref-40-1"><label>[40]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.40" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-40"><string-name name-style="western" hwp:sortable="Schaum N."><surname>Schaum</surname>, <given-names>N.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-39">Single-cell transcriptomics of 20 mouse organs creates a tabula muris: The tabula muris consortium</article-title>. <source hwp:id="source-40">Nature</source> <volume>562</volume>, <fpage>367</fpage> (<year>2018</year>).</citation></ref><ref id="c41" hwp:id="ref-41" hwp:rev-id="xref-ref-41-1 xref-ref-41-2"><label>[41]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.41" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-41"><string-name name-style="western" hwp:sortable="Harris C. R."><surname>Harris</surname>, <given-names>C. R.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-40">Array programming with NumPy</article-title>. <source hwp:id="source-41">Nature</source> <volume>585</volume>, <fpage>357</fpage>–<lpage>362</lpage> (<year>2020</year>).</citation></ref><ref id="c42" hwp:id="ref-42" hwp:rev-id="xref-ref-42-1 xref-ref-42-2 xref-ref-42-3"><label>[42]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.42" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-42"><string-name name-style="western" hwp:sortable="Wolf F. A."><surname>Wolf</surname>, <given-names>F. A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Angerer P."><surname>Angerer</surname>, <given-names>P.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Theis F. J."><surname>Theis</surname>, <given-names>F. J.</given-names></string-name> <article-title hwp:id="article-title-41">SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source hwp:id="source-42">Genome biology</source> <volume>19</volume>, <fpage>15</fpage> (<year>2018</year>).</citation></ref><ref id="c43" hwp:id="ref-43" hwp:rev-id="xref-ref-43-1 xref-ref-43-2 xref-ref-43-3 xref-ref-43-4 xref-ref-43-5"><label>[43]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.43" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-43"><string-name name-style="western" hwp:sortable="Pedregosa F."><surname>Pedregosa</surname>, <given-names>F.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-42">Scikit-learn: Machine learning in python</article-title>. <source hwp:id="source-43">Journal of machine learning research</source> <volume>12</volume>, <fpage>2825</fpage>–<lpage>2830</lpage> (<year>2011</year>).</citation></ref><ref id="c44" hwp:id="ref-44" hwp:rev-id="xref-ref-44-1 xref-ref-44-2 xref-ref-44-3"><label>[44]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.44" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-44"><string-name name-style="western" hwp:sortable="Oja E."><surname>Oja</surname>, <given-names>E.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Hyvarinen A."><surname>Hyvarinen</surname>, <given-names>A.</given-names></string-name> <article-title hwp:id="article-title-43">Independent component analysis: algorithms and applications</article-title>. <source hwp:id="source-44">Neural networks</source> <volume>13</volume>, <fpage>411</fpage>–<lpage>430</lpage> (<year>2000</year>).</citation></ref><ref id="c45" hwp:id="ref-45" hwp:rev-id="xref-ref-45-1"><label>[45]</label><citation publication-type="website" citation-type="web" ref:id="2021.01.19.427303v3.45" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-45">(<ext-link l:rel="related" l:ref-type="uri" l:ref="https://math.stackexchange.com/users/22857/martinargerami" ext-link-type="uri" xlink:href="https://math.stackexchange.com/users/22857/martinargerami" hwp:id="ext-link-7">https://math.stackexchange.com/users/22857/martinargerami</ext-link>), <source hwp:id="source-45">M. A. What vector x will maximize the norm of ||ax||2/||x||2 (norm 2). Mathematics Stack Exchange</source>. URL <ext-link l:rel="related" l:ref-type="uri" l:ref="https://math.stackexchange.com/q/3112310" ext-link-type="uri" xlink:href="https://math.stackexchange.com/q/3112310" hwp:id="ext-link-8">https://math.stackexchange.com/q/3112310</ext-link>. URL: <ext-link l:rel="related" l:ref-type="uri" l:ref="https://math.stackexchange.com/q/3112310" ext-link-type="uri" xlink:href="https://math.stackexchange.com/q/3112310" hwp:id="ext-link-9">https://math.stackexchange.com/q/3112310</ext-link> (version: 2021-0126), <ext-link l:rel="related" l:ref-type="uri" l:ref="https://math.stackexchange.com/q/3112310" ext-link-type="uri" xlink:href="https://math.stackexchange.com/q/3112310" hwp:id="ext-link-10">https://math.stackexchange.com/q/3112310</ext-link>.</citation></ref><ref id="c46" hwp:id="ref-46" hwp:rev-id="xref-ref-46-1"><label>[46]</label><citation publication-type="journal" citation-type="journal" ref:id="2021.01.19.427303v3.46" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-46"><string-name name-style="western" hwp:sortable="Virtanen P."><surname>Virtanen</surname>, <given-names>P.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-44">SciPy 1.0: Fundamental algorithms for scientific computing in Python</article-title>. <source hwp:id="source-46">Nature Methods</source> <volume>17</volume>, <fpage>261</fpage>–<lpage>272</lpage> (<year>2020</year>).</citation></ref></ref-list></back></article>
