<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/2021.09.07.459263</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;2021.09.07.459263v2</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;2021.09.07.459263</article-id><article-id pub-id-type="other" hwp:sub-type="slug">2021.09.07.459263</article-id><article-id pub-id-type="other" hwp:sub-type="atom-slug">2021.09.07.459263</article-id><article-id pub-id-type="other" hwp:sub-type="tag">2021.09.07.459263</article-id><article-version>1.2</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Bioinformatics" hwp:journal="biorxiv"><subject>Bioinformatics</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">Interpretable deep learning for chromatin-informed inference of transcriptional programs driven by somatic alterations across cancers</article-title></title-group><author-notes hwp:id="author-notes-1"><fn id="n1" fn-type="equal" hwp:id="fn-1" hwp:rev-id="xref-fn-1-1 xref-fn-1-2"><label>+</label><p hwp:id="p-1">Contributions, These authors contributed equally: Y.T., X.M.</p></fn><corresp id="cor1" hwp:id="corresp-1" hwp:rev-id="xref-corresp-1-1"><label>*</label>Corresponding author, Correspondence to: Hatice Ulku Osmanbeyoglu (<email hwp:id="email-1">osmanbeyogluhu@pitt.edu</email>)</corresp></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-5076-0081</contrib-id><name name-style="western" hwp:sortable="Tao Yifeng"><surname>Tao</surname><given-names>Yifeng</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">1</xref><xref ref-type="fn" rid="n1" hwp:id="xref-fn-1-1" hwp:rel-id="fn-1">+</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0001-5076-0081"/></contrib><contrib contrib-type="author" hwp:id="contrib-2"><name name-style="western" hwp:sortable="Ma Xiaojun"><surname>Ma</surname><given-names>Xiaojun</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-1" hwp:rel-id="aff-2">2</xref><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-1" hwp:rel-id="aff-3">3</xref><xref ref-type="fn" rid="n1" hwp:id="xref-fn-1-2" hwp:rel-id="fn-1">+</xref></contrib><contrib contrib-type="author" hwp:id="contrib-3"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-9205-8258</contrib-id><name name-style="western" hwp:sortable="Laliotis Georgios I."><surname>Laliotis</surname><given-names>Georgios I.</given-names></name><xref ref-type="aff" rid="a4" hwp:id="xref-aff-4-1" hwp:rel-id="aff-4">4</xref><xref ref-type="aff" rid="a5" hwp:id="xref-aff-5-1" hwp:rel-id="aff-5">5</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0001-9205-8258"/></contrib><contrib contrib-type="author" hwp:id="contrib-4"><name name-style="western" hwp:sortable="Zuniga Adler Guerrero"><surname>Zuniga</surname><given-names>Adler Guerrero</given-names></name><xref ref-type="aff" rid="a4" hwp:id="xref-aff-4-2" hwp:rel-id="aff-4">4</xref><xref ref-type="aff" rid="a5" hwp:id="xref-aff-5-2" hwp:rel-id="aff-5">5</xref></contrib><contrib contrib-type="author" hwp:id="contrib-5"><name name-style="western" hwp:sortable="Palmer Drake"><surname>Palmer</surname><given-names>Drake</given-names></name><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-2" hwp:rel-id="aff-3">3</xref></contrib><contrib contrib-type="author" hwp:id="contrib-6"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-8974-9792</contrib-id><name name-style="western" hwp:sortable="Toska Eneda"><surname>Toska</surname><given-names>Eneda</given-names></name><xref ref-type="aff" rid="a4" hwp:id="xref-aff-4-3" hwp:rel-id="aff-4">4</xref><xref ref-type="aff" rid="a5" hwp:id="xref-aff-5-3" hwp:rel-id="aff-5">5</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0002-8974-9792"/></contrib><contrib contrib-type="author" hwp:id="contrib-7"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-4970-2252</contrib-id><name name-style="western" hwp:sortable="Schwartz Russell"><surname>Schwartz</surname><given-names>Russell</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a6" hwp:id="xref-aff-6-1" hwp:rel-id="aff-6">6</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0002-4970-2252"/></contrib><contrib contrib-type="author" hwp:id="contrib-8"><name name-style="western" hwp:sortable="Lu Xinghua"><surname>Lu</surname><given-names>Xinghua</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-2" hwp:rel-id="aff-2">2</xref><xref ref-type="aff" rid="a7" hwp:id="xref-aff-7-1" hwp:rel-id="aff-7">7</xref></contrib><contrib contrib-type="author" corresp="yes" hwp:id="contrib-9"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-4972-4347</contrib-id><name name-style="western" hwp:sortable="Osmanbeyoglu Hatice Ulku"><surname>Osmanbeyoglu</surname><given-names>Hatice Ulku</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-3" hwp:rel-id="aff-2">2</xref><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-3" hwp:rel-id="aff-3">3</xref><xref ref-type="aff" rid="a8" hwp:id="xref-aff-8-1" hwp:rel-id="aff-8">8</xref><xref ref-type="corresp" rid="cor1" hwp:id="xref-corresp-1-1" hwp:rel-id="corresp-1">*</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0002-4972-4347"/></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2"><label>1</label><institution hwp:id="institution-1">Computational Biology Department, School of Computer Science, Carnegie Mellon University</institution>, Pittsburgh, <country>USA</country></aff><aff id="a2" hwp:id="aff-2" hwp:rev-id="xref-aff-2-1 xref-aff-2-2 xref-aff-2-3"><label>2</label><institution hwp:id="institution-2">Department of Biomedical Informatics, School of Medicine, University of Pittsburgh</institution>, Pittsburgh, <country>USA</country></aff><aff id="a3" hwp:id="aff-3" hwp:rev-id="xref-aff-3-1 xref-aff-3-2 xref-aff-3-3"><label>3</label><institution hwp:id="institution-3">UPMC Hillman Cancer Center, University of Pittsburgh</institution>, Pittsburgh, <country>USA</country></aff><aff id="a4" hwp:id="aff-4" hwp:rev-id="xref-aff-4-1 xref-aff-4-2 xref-aff-4-3"><label>4</label><institution hwp:id="institution-4">Department of Oncology, Sidney Kimmel Cancer Center, Johns Hopkins University School of Medicine</institution>, Baltimore, MD, <country>USA</country></aff><aff id="a5" hwp:id="aff-5" hwp:rev-id="xref-aff-5-1 xref-aff-5-2 xref-aff-5-3"><label>5</label><institution hwp:id="institution-5">Department of Biochemistry and Molecular Biology, Johns Hopkins School of Public Health</institution>, Baltimore, MD, <country>USA</country></aff><aff id="a6" hwp:id="aff-6" hwp:rev-id="xref-aff-6-1"><label>6</label><institution hwp:id="institution-6">Department of Biological Sciences, Carnegie Mellon University</institution>, Pittsburgh, <country>USA</country></aff><aff id="a7" hwp:id="aff-7" hwp:rev-id="xref-aff-7-1"><label>7</label><institution hwp:id="institution-7">Department of Pharmaceutical Science, School of Medicine, University of Pittsburgh</institution>, Pittsburgh, <country>USA</country></aff><aff id="a8" hwp:id="aff-8" hwp:rev-id="xref-aff-8-1"><label>8</label><institution hwp:id="institution-8">Department of Bioengineering, School of Engineering, University of Pittsburgh</institution>, Pittsburgh, <country>USA</country></aff></contrib-group><pub-date pub-type="epub-original" date-type="pub" publication-format="electronic" hwp:start="2021"><year>2021</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2021-09-09T07:30:13-07:00">
    <day>9</day><month>9</month><year>2021</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2021-10-26T18:27:13-07:00">
    <day>26</day><month>10</month><year>2021</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2021-09-09T07:35:27-07:00">
    <day>9</day><month>9</month><year>2021</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2021-10-26T18:33:18-07:00">
    <day>26</day><month>10</month><year>2021</year>
  </pub-date><elocation-id>2021.09.07.459263</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2021-09-07"><day>07</day><month>9</month><year>2021</year></date>
<date date-type="rev-recd" hwp:start="2021-10-26"><day>26</day><month>10</month><year>2021</year></date>
<date date-type="accepted" hwp:start="2021-10-26"><day>26</day><month>10</month><year>2021</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2021, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2021</copyright-year><license hwp:id="license-1"><p hwp:id="p-2">The copyright holder for this pre-print is the author. All rights reserved. The material may not be redistributed, re-used or adapted without the author's permission.</p></license></permissions><self-uri xlink:href="459263.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/change-list" xlink:role="change-list" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2021/pdf/2021.09.07.459263v2.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="459263.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2021/abstracts/2021.09.07.459263v2/2021.09.07.459263v2.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2021/fulltext/2021.09.07.459263v2/2021.09.07.459263v2.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><p hwp:id="p-3">Cancer is a disease of gene dysregulation, where cells acquire somatic and epigenetic alterations that drive aberrant cellular signaling. These alterations adversely impact transcriptional programs and cause profound changes in gene expression. Ultimately, interpreting patient somatic alterations within context-specific regulatory programs will facilitate personalized therapeutic decisions for each individual. Towards this goal, we develop a partially interpretable neural network model with encoder-decoder architecture, called <bold>C</bold>hromatin-informed <bold>I</bold>nference of <bold>T</bold>ranscriptional <bold>R</bold>egulators <bold>U</bold>sing <bold>S</bold>elf-attention mechanism (CITRUS), to model the impact of somatic alterations on cellular states and further onto downstream gene expression programs. The encoder module employs a self-attention mechanism to model the contextual impact of somatic alterations in a tumor-specific manner. Furthermore, the model uses a layer of hidden nodes to explicitly represent the state of transcription factors (TFs), and the decoder learns the relationships between TFs and their target genes guided by the sparse prior based on TF binding motifs in the open chromatin regions of tumor samples. We apply CITRUS to genomic, mRNA sequencing, and ATAC-seq data from tumors of 17 cancer types profiled by The Cancer Genome Atlas. Our computational framework enables us to share information across tumors to learn patient-specific TF activities, revealing regulatory program similarities and differences between and within tumor types. We show that CITRUS not only outperforms the competing models in predicting RNA expression but also yields biological insights in delineating TFs associated with somatic alterations in individual tumors. We also validate the differential activity of TFs associated with mutant <italic toggle="yes">PIK3CA</italic> in breast cancer cell line and xenograft models using a panel of PI3K pathway inhibitors.</p></abstract><counts><page-count count="21"/></counts><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-1">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta><notes hwp:id="notes-1"><notes notes-type="competing-interest-statement" hwp:id="notes-2"><title hwp:id="title-2">Competing Interest Statement</title><p hwp:id="p-4">The authors have declared no competing interest.</p></notes><fn-group content-type="summary-of-updates" hwp:id="fn-group-1"><title hwp:id="title-3">Summary of Updates:</title><fn fn-type="update" hwp:id="fn-2"><p hwp:id="p-5">We add additional experimental validation results</p></fn></fn-group></notes></front><body><sec id="s1" hwp:id="sec-1"><title hwp:id="title-4">Introduction</title><p hwp:id="p-6">Interplay between complex signaling inputs and genomic transcriptional responses dictates important cellular functions. Dysregulation of this interplay leads to development and progression of disease, most clearly delineated in the context of certain cancers. Cancer cells acquire somatic alterations that drive aberrant signaling which adversely impacts transcriptional programs and cause profound changes in gene expression. We still lack a complete understanding of the transcriptional programs and how disruptions in this code affect cellular function in cancer. Interpreting patient somatic alterations within context-specific transcriptional programs can facilitate therapeutic decisions for each individual.</p><p hwp:id="p-7">In the last decade, a monumental effort to molecularly profile tumors was undertaken by consortia such as The Cancer Genome Atlas (TCGA) and the International Cancer Genome Consortium (ICGC)<sup><xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">1</xref>,<xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">2</xref></sup>. These multimodal datasets including gene expression and somatic alterations such as recurrent mutations and copy number variations (CNVs) have enabled the integration of transcriptional states with upstream signaling pathways. Several methods have been developed to connect somatic alterations to a prior network or to gene expression<sup><xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-1" hwp:rel-id="ref-3">3</xref>–<xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">9</xref></sup>. More recently, the Genomic Data Analysis Network generated assay for transposase-accessible chromatin with high-throughput sequencing (ATAC-seq) data for the subset of TCGA samples (~500 patients)<sup><xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-1" hwp:rel-id="ref-10">10</xref></sup>. However, so far methods for linking somatic alterations to transcriptional programs across cancers have not incorporated tumor chromatin profiling to encode context-dependent and/or non-linear impacts of transcription factors (TFs) on gene expression. Incorporating DNA sequence information at promoter, intronic and intergenic enhancers using TF motif analysis from tumor ATAC-seq profiles will improve the modeling of transcriptional regulation and delineate the impact of somatic alterations on transcriptional programs.</p><p hwp:id="p-8">Deep learning (DL) is a powerful tool for capturing non-linearity. Attention mechanism is a deep learning module that has been widely used in computer vision and natural language processing. In contrast to normal deep learning units, the self-attention mechanism considers the contextual effort of all the input features to each other and assigns different weights of attention to these inputs<sup><xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">11</xref></sup>. In general, the attention mechanism can improve the performance of the DL models or increase the interpretability of the models. More recently, attention mechanisms have also been applied to cancer genomics, including cancer driver detection<sup><xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">12</xref></sup>, drug response prediction<sup><xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">13</xref></sup> and predicting base editing outcomes<sup><xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">14</xref></sup>. The genomic impact transformer (GIT) model utilizes the self-attention mechanism to encode the effects of somatic alterations in cancer and uses multi-layer perceptrons to predict differentially expressed genes as the output of the model<sup><xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-2" hwp:rel-id="ref-12">12</xref></sup>. The attention mechanism enables it to select the likely driver mutations that lead to downstream phenotypes, such as transcriptome expression levels. However, the GIT model lacks interpretability in the sense it does not model the intermediate TFs during the signaling from somatic alterations to gene expression programs.</p><p hwp:id="p-9">In this work, we present <bold>C</bold>hromatin-informed <bold>I</bold>nference of <bold>T</bold>ranscriptional <bold>R</bold>egulators <bold>U</bold>sing <bold>S</bold>elf-attention mechanism (CITRUS), a partially interpretable neural network (NN) model with encoder-decoder architecture, to link somatic alterations to transcriptional programs through modeling the statistical relationships between mutations, CNVs, gene expression and TF-target gene prior information (based on TF binding motif analysis in the open chromatin regions based on tumor ATAC-seq profiling). CITRUS explicitly includes the transcriptional programs in the model, with external knowledge of TF:target-gene priors based on ATAC-seq data. We showed that CITRUS not only outperforms competing models in predicting mRNA expression, but also yields important biological insights in finding dysregulated TFs in individual tumors. We next performed a systematic knock-out <italic toggle="yes">in silico</italic> approach to associate frequent somatic alterations with changes in inferred TF activities in each cancer type. This analysis identified key regulators associated with the major somatic alterations. In particular, we associated <italic toggle="yes">PIK3CA</italic> activating mutations with altered activities of distinct sets of TFs in different cancers. Notably, in cell line and xenograft models of breast cancer, we validated the altered activity of several TFs in the presence of mutant <italic toggle="yes">PIK3CA</italic> with PI3K pathway inhibitors by measuring promoter occupancy and expression of target genes, confirming the context-specific predictions of our model. These proof-of-principle results suggest a computational strategy for personalized deployment of targeted therapeutics in a pan-cancer setting.</p></sec><sec id="s2" hwp:id="sec-2"><title hwp:id="title-5">Results</title><sec id="s2a" hwp:id="sec-3"><title hwp:id="title-6">Pan-cancer modeling of regulatory programs</title><p hwp:id="p-10">To systematically interpret somatic alterations (SAs) within context-specific transcriptional programs and identify disrupted TFs that drive tumor-specific gene expression patterns across multiple cancer types, we developed CITRUS computational framework (<bold><xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Fig. 1</xref></bold>). The CITRUS model mimics the biological processing of signaling pathways from SAs to the signaling pathways, to TFs, and finally to the target gene expressions (mRNA levels). Therefore, the model follows an overall encoder-decoder architecture (<bold><xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-2" hwp:rel-id="F1">Fig. 1</xref></bold>). The encoder module compresses the input SAs into a latent vector variable called a tumor embedding. Then the decoder part first predicts the TF activities from the tumor embedding, and further predicts the TF target-gene expression. We used sparse TF-target gene priors based on tumor ATAC-seq data. Briefly, we started with an atlas of chromatin accessible events derived from the tumor types to be analyzed, using ATAC-seq profiling data (“Methods” section). We represented every gene by its feature vector of TF-binding scores, where motif information was summarized across all promoter, intronic, and intergenic chromatin accessible sites assigned to the gene (see the “Methods” section).</p><fig id="fig1" position="float" orientation="portrait" fig-type="figure" hwp:id="F1" hwp:rev-id="xref-fig-1-1 xref-fig-1-2 xref-fig-1-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;2021.09.07.459263v2/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Fig. 1:</label><caption hwp:id="caption-1"><title hwp:id="title-7">Overview of CITRUS algorithm: the attention-based model with TF:target-gene priors.</title><p hwp:id="p-11">The input to our framework includes somatic alteration and copy number variation, assay for transposase-accessible chromatin with high-throughput sequencing (ATAC-seq), tumor expression datasets and TF recognition motifs. CITRUS takes somatic alteration and copy number variation data as input and encodes them as a tumor embedding using a self-attention mechanism. Additional cancer type information is used for stratifying the confounding factor of tissue type. The middle layer further transforms the tumor embeddings into TF layer, which represents the inferred activities of 320 TFs. Finally, the gene expression levels are predicted from the TF activities through a TF:target-gene priors constrained sparse layer based on ATAC-seq.</p></caption><graphic xlink:href="459263v2_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig><p hwp:id="p-12">The application of our approach to 17 tumors from TCGA identified key TFs associated with SAs. Our dataset included samples from seventeen different tumor types for which mRNA, somatic mutation, copy number variation and ATAC-seq data were available: bladder urothelial carcinoma (BLCA, n=371), breast cancer (BRCA, n=719), cervical squamous cell carcinoma and endocervical adenocarcinoma (CESC, n=267), colorectal adenocarcinoma (COAD, n=271), esophageal carcinoma (ESCA, n=170), glioblastoma multiforme (GBM, n=143), head and neck squamous carcinoma (HNSC, n=475), kidney renal cell-clear carcinoma (KIRC, n=357), kidney renal papillary cell carcinoma (KIRP, n=272), liver hepatocellular carcinoma (LIHC, n=336), lung adenocarcinoma (LUAD, n=459), lung squamous cell carcinoma (LUSC, n=430), pheochromocytoma and paraganglioma (PCPG, n=109), prostate cancer (PRAD, n=449), stomach adenocarcinoma (STAD, n=373), thyroid carcinoma (THCA, n=216), and uterine corpus endometrial carcinoma (UCEC, n=361).</p><p hwp:id="p-13">For statistical evaluation, we computed the mean Spearman correlation between predicted and measured gene expression profiles on held-out samples (see Methods). We obtained significantly better performance than a regularized bilinear regression algorithm called affinity regression (AR)<sup><xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">15</xref>–<xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">17</xref></sup> that was trained independently for each cancer type and explains gene expression across tumors in terms of SA status and presence of TF binding sites based on pan-cancer ATAC-seq atlas (<bold><xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-1" hwp:rel-id="F2">Fig. 2A</xref></bold>).</p><fig id="fig2" position="float" orientation="portrait" fig-type="figure" hwp:id="F2" hwp:rev-id="xref-fig-2-1 xref-fig-2-2 xref-fig-2-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;2021.09.07.459263v2/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Fig. 2:</label><caption hwp:id="caption-2"><title hwp:id="title-8">CITRUS models impact of somatic alterations on gene expression programs.</title><p hwp:id="p-14"><bold>(A)</bold> Performance of the CITRUS models for each cancer type compared to regularized bilinear regression method, affinity regression (Affreg). Boxplots showing mean Spearman correlations between predicted and actual gene expression using the CITRUS model (orange) and Affreg (light blue) for TCGA data each cancer-type. Both CITRUS and Affreg are tuned on the training and validation sets, and evaluated on the same held-out test set. <bold>(B)</bold> Somatic alteration frequencies and CITRUS-inferred attention weights of genes. We show cumulated results in Pan-cancer and individual BRCA, and HNSC. See <bold>Supplementary Fig. 1</bold> for full compilation of each cancer type. <bold>(C)</bold> Principal components analysis (PCA) of TF activity colored by cancer type.</p></caption><graphic xlink:href="459263v2_fig2" position="float" orientation="portrait" hwp:id="graphic-2"/></fig><p hwp:id="p-15">To identify the SAs that have an impact on gene expression programs, we compared the relationship of overall attention weights (inferred by CITRUS) and the frequencies of SAs (used as the control group) across all cancer types and within a cancer type (<bold><xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-2" hwp:rel-id="F2">Fig 2B</xref> and Supplementary Fig. 1</bold>). In general, the attention weights are correlated with the alteration frequencies of genes. For example, the top altered genes <italic toggle="yes">TP53</italic> and <italic toggle="yes">PIK3CA</italic> had high attention weights. However, our self-attention mechanism assigned low attention weights to many highly frequently altered genes, indicating these genes can be cancer passengers. Indeed, we found genes with high attention weights were enriched for known cancer drivers from the IntOGen<sup><xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-2" hwp:rel-id="ref-9">9</xref></sup> database. We first grouped all the genes into two parts with the threshold of 2 (log(attention+1) &gt;= 2 as the more attended group, and log(attention+1) &lt; 2 as the less attended group). Using the Fisher exact test, we found known cancer drivers were enriched in the highly attended group (<italic toggle="yes">P</italic> = 4.48 × 10<sup>−41</sup>) for pan-cancer analysis. We also observed for some less frequently altered genes got high attention weights. For example, the H3K4 methyltransferase KMT2C had a high attention weight in BRCA but a lower frequency. Indeed, <italic toggle="yes">KMT2C</italic> has been shown to be a key regulator of ERα activity and anti-estrogen response<sup><xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-1" hwp:rel-id="ref-18">18</xref>,<xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-1" hwp:rel-id="ref-19">19</xref></sup>.</p><p hwp:id="p-16">Next, we used CITRUS across tumor types to learn patient-specific TF activities. Clustering of tumors by inferred TF activities as derived from the model largely recovered the distinction between the major tumor types (<bold><xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-3" hwp:rel-id="F2">Fig. 2C</xref></bold>). In particular, samples with squamous morphology components (BLCA, CESC, ESCA, HNSC, and LUSC) were grouped together. Similarly, tumors with tissue or organ similarities or proximity were also grouped together. These included neuroendocrine and glioma tumors (GBM and PCPG), clear cell and papillary renal carcinomas (KIRC and KIRP), a gastrointestinal group (COAD, and STAD), breast and endometrial cancer (BRCA and UCEC). We also observed similar clustering with tumor embeddings (<bold>Supplementary Fig 2</bold>).</p><p hwp:id="p-17">Next, we assessed TF-tumor type associations by t-test and compare inferred TF activities between samples in a given tumor type vs. those in all other tumor types. We corrected for FDR across TFs and identified significant shared and cancer-specific TFs and the results are shown in <bold>Supplementary Data 1</bold>. <bold><xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-1" hwp:rel-id="F3">Fig. 3</xref></bold> shows the average TF activity and significance of cancer-specific TFs across cancer types. For clarity, only the union of the 4 top significant TFs per cancer are shown. FUBP1, which regulates <italic toggle="yes">c-Myc</italic> gene transcription, had significantly higher inferred activity in many cancer types including LIHC, HNSC, BLCA, ESCA, CESC, LUSC, PRAD, BRCA, and UCEC. Moreover, in agreement with previous reports, IRF3 activity was significantly higher in GBM<sup><xref ref-type="bibr" rid="c20" hwp:id="xref-ref-20-1" hwp:rel-id="ref-20">20</xref></sup>; KLF8 had decreased activity in GBM, LIHC and KIRC, consistent with its role in suppressing cell apoptosis during tumor progression<sup><xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-1" hwp:rel-id="ref-21">21</xref></sup>; YY1, which regulates various processes of development<sup><xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-1" hwp:rel-id="ref-22">22</xref></sup> and had increased activity in CESC and COAD.</p><fig id="fig3" position="float" orientation="portrait" fig-type="figure" hwp:id="F3" hwp:rev-id="xref-fig-3-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;2021.09.07.459263v2/FIG3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F3</object-id><object-id pub-id-type="publisher-id">fig3</object-id><label>Fig. 3:</label><caption hwp:id="caption-3"><title hwp:id="title-9">CITRUS identifies regulatory features of tumor types.</title><p hwp:id="p-18">Dotplot shows the mean inferred TF activity differences between samples in a given tumor type vs. those in all other tumor types by t-test. We corrected for FDR across TFs for each such pairwise comparison and identified significant TF regulators and the results are shown in <bold>Supplementary Data 1</bold>.The dot size indicates −log10(FDR). For clarity, the union of the top 4 significant TFs in each cancer type is shown.</p></caption><graphic xlink:href="459263v2_fig3" position="float" orientation="portrait" hwp:id="graphic-3"/></fig></sec><sec id="s2b" hwp:id="sec-4"><title hwp:id="title-10">CITRUS-inferred TF-activity based cancer subtypes and somatic alteration landscape</title><p hwp:id="p-19">Next, we asked whether our method could identify TF activity based subtypes associated with SAs. We conducted <italic toggle="yes">k</italic>-means clustering on inferred TF activities for each cancer type to get subtypes, and then conducted hierarchical clustering for both the cancer subtypes and TF activities. <bold><xref ref-type="fig" rid="fig4" hwp:id="xref-fig-4-1" hwp:rel-id="F4">Fig. 4</xref></bold> shows the clustering of subtypes by CITRUS-inferred mean TF activities and corresponding SA associations (see Methods). We observed major variations in mean TF activities across different cancer types, and less but significant variations within each cancer type. These variations within a cancer type may be explained by the distinct mutation or copy number alteration profiles of different subgroups. For example, clustering by TF activities revealed subclasses of endocervical adenocarcinoma (CESC) enriched with <italic toggle="yes">KRAS</italic>; kidney renal cell-clear carcinoma (KIRC) enriched with <italic toggle="yes">VHL</italic>, <italic toggle="yes">BAP1</italic>, <italic toggle="yes">PBRM1</italic> and <italic toggle="yes">TP53</italic>; liver hepatocellular carcinoma (LIHC) enriched with <italic toggle="yes">CTNNB1</italic>, <italic toggle="yes">BAP1</italic> and <italic toggle="yes">TP53</italic>; thyroid carcinoma (THCA) enriched with <italic toggle="yes">NRAS</italic>, <italic toggle="yes">HRAS</italic> and <italic toggle="yes">BRAF</italic> status; pheochromocytoma and paraganglioma (PCPG) enriched with <italic toggle="yes">HRAS</italic> status.</p><fig id="fig4" position="float" orientation="portrait" fig-type="figure" hwp:id="F4" hwp:rev-id="xref-fig-4-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;2021.09.07.459263v2/FIG4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F4</object-id><object-id pub-id-type="publisher-id">fig4</object-id><label>Fig. 4:</label><caption hwp:id="caption-4"><title hwp:id="title-11">Landscape of somatic alterations and inferred TF activities.</title><p hwp:id="p-20"><bold>(A)</bold> Top heatmap shows tumor subtypes clustered by the mean TF inferred activity. Color scale is proportional to TF activity. The heat map shows −log10 FDR values multipled by the direction derived by Fisher exact test for <bold>(B)</bold> mutations and <bold>(C)</bold> copy number variations.</p></caption><graphic xlink:href="459263v2_fig4" position="float" orientation="portrait" hwp:id="graphic-4"/></fig><p hwp:id="p-21">We next developed a systematic statistical approach for modeling the impact of SAs on TF activity, with the eventual goal of deciphering cancer-specific downstream effects of targeted therapies and potentially discovering secondary targets for combination drug strategies. We implemented a knock-out <italic toggle="yes">in silico</italic> approach that removes a specific somatic mutation (or copy number variation) <italic toggle="yes">g</italic> from all the tumor samples that carry it to identify a set of TFs predicted to be significantly dysregulated by each SA in each TCGA cancer study (see Methods section). <bold><xref ref-type="fig" rid="fig5" hwp:id="xref-fig-5-1" hwp:rel-id="F5">Fig. 5A</xref></bold> shows the TF activities associated with SAs in UCEC. Our model identified mutations in <italic toggle="yes">PIK3CA</italic>, <italic toggle="yes">PTEN</italic>, <italic toggle="yes">KRAS</italic>, <italic toggle="yes">TP53</italic>, and <italic toggle="yes">CTNNB1</italic> as significantly associated with various TF activities across UCEC tumors (~66% of tumors have <italic toggle="yes">PTEN</italic> inactivating mutations, ~50% have <italic toggle="yes">PIK3CA</italic> activating mutations, ~38% have <italic toggle="yes">TP53</italic> mutations, ~26% have <italic toggle="yes">CTNNB1</italic>, and ~20% have <italic toggle="yes">KRAS</italic>). UCEC samples with <italic toggle="yes">PTEN</italic> mutations are mutually exclusive with <italic toggle="yes">TP53</italic>, <italic toggle="yes">CTNNB1</italic> and <italic toggle="yes">KRAS</italic> showed distinct patterns of TF activities. Mutations in <italic toggle="yes">PTEN</italic>, which inactivate its phosphatase activity, increase PI3K signaling. TFs associated with <italic toggle="yes">PTEN</italic> mutations involved in cell cycle and differentiation including E2F5, TP63, ELF3, DBP, ZKSCAN3, LHX2, HOXB6, SOX9, DBP, MYLB1, and GLIS1. Whereas, TFs associated with <italic toggle="yes">CTNNB1</italic> mutant status were involved in WNT and TGF-beta signaling including TCF7, TCF7L2, TCF7L1, FOXH1, EMX1, and MYBL1.</p><fig id="fig5" position="float" orientation="portrait" fig-type="figure" hwp:id="F5" hwp:rev-id="xref-fig-5-1 xref-fig-5-2 xref-fig-5-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;2021.09.07.459263v2/FIG5</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F5</object-id><object-id pub-id-type="publisher-id">fig5</object-id><label>Fig. 5:</label><caption hwp:id="caption-5"><title hwp:id="title-12">Somatic alterations are associated with dysregulated TF activity.</title><p hwp:id="p-22">Impact of SAs on individual TFs based on knock out <italic toggle="yes">in silico</italic> experiments in TCGA <bold>(A)</bold> UCEC and <bold>(B)</bold> BRCA. The dotplot shows mean TF activity and dot size indicates −log10(FDR). See <bold>Supplementary Fig. 3</bold> for full list of cancer types. <bold>(C)</bold> Inferred ETS2 activity in TCGA studies and impact of <italic toggle="yes">TP53</italic> mutations. Tumors with mutant <italic toggle="yes">TP53</italic> have significantly higher activity of ETS2 than WT tumors (<italic toggle="yes">P</italic> &lt; 0.01, t-test). This association is not significant using mRNA levels of ETS2 (<bold>Supplementary Fig. 5)</bold>. Box edges represent the upper and lower quantile with median value shown as bold line in the middle of the box. Whiskers represent 1.5 times the quantile.</p></caption><graphic xlink:href="459263v2_fig5" position="float" orientation="portrait" hwp:id="graphic-5"/></fig><p hwp:id="p-23">Similarly, <bold><xref ref-type="fig" rid="fig5" hwp:id="xref-fig-5-2" hwp:rel-id="F5">Fig. 5B</xref></bold> shows the TF activities associated with SAs in BRCA. Our model identified mutations in <italic toggle="yes">PIK3CA, PTEN, MAP2K4, GATA3, TP53</italic>, and <italic toggle="yes">CDH1</italic> as significantly associated with various TF activities across tumors. In BRCA, ~36% of tumors have <italic toggle="yes">PIK3CA</italic> activating mutations, ~35% have <italic toggle="yes">TP53</italic>, ~15% have <italic toggle="yes">GATA3</italic>, ~15% have <italic toggle="yes">CDH1</italic>, ~10% have <italic toggle="yes">PTEN</italic>, and ~7% have <italic toggle="yes">MAP2K4</italic> mutations. Activating mutations in <italic toggle="yes">PIK3CA</italic> often occur in one of three hotspot locations (E545K, E542K and H1047R) and promote constitutive signaling through the pathway. TFs associated with <italic toggle="yes">PIK3CA</italic> mutations involved in WNT signaling, epithelial–mesenchymal transition and cancer stem cell transition including ELF3, TFEC, STAT4, STAT5B, NFATC1, GLIS1, CDC5L and AR. BRCA samples with <italic toggle="yes">PIK3CA</italic> and <italic toggle="yes">TP53</italic> mutations are mutually exclusive. Our knock-out <italic toggle="yes">in silico</italic> analysis associated different TFs with these mutations. <italic toggle="yes">TP53</italic> mutant tumors are associated with increased activity of TFs that have roles in pro-growth such as ETS2 and FOSB, growth modulatory such as THAP1, CREB3L1, and CEBPZ and development MEF2C/D, MEOX1, MSX1. We also performed similar analyses for other cancer types (<bold>Supplementary Fig. 3</bold>).</p><p hwp:id="p-24">We found <italic toggle="yes">TP53</italic> mutation associated with similar TFs across different cancer types (<bold>Supplementary Fig. 4</bold>). <italic toggle="yes">TP53</italic> is one of the most frequently inactivated tumor suppressor genes that suffers from missense mutations in human cancer. These missense mutations express a mutant form of p53 protein. Therefore, the cells retain and express a mutant form of the p53 protein that can either disable other tumor suppressors (e.g., p63 and p73) or enable oncogenes such as ETS2, an ETS family member<sup><xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-1" hwp:rel-id="ref-23">23</xref></sup>. Indeed, inferred TF activity of ETS2 was increased in mutant versus WT <italic toggle="yes">TP53</italic> tumors across cancers (<bold><xref ref-type="fig" rid="fig5" hwp:id="xref-fig-5-3" hwp:rel-id="F5">Fig. 5C</xref></bold>); these differences are not as significant at the gene expression level (<bold>Supplementary Fig. 5</bold>).</p></sec><sec id="s2c" hwp:id="sec-5"><title hwp:id="title-13">Experimental validation of oncogenic mutant PI3K-driven TF activity in breast cancer</title><p hwp:id="p-25">The PI3K pathway controls proliferation, metabolism, survival and motility and is frequently activated in many cancers, often via mutations in the gene coding for the alpha subunit of the PI3K<italic toggle="yes">, PIK3CA<sup><xref ref-type="bibr" rid="c24" hwp:id="xref-ref-24-1" hwp:rel-id="ref-24">24</xref></sup></italic>. The PI3K inhibitor alpelisib was recently approved in metastatic estrogen receptor positive/PIK3CA mutant breast cancer<sup><xref ref-type="bibr" rid="c25" hwp:id="xref-ref-25-1" hwp:rel-id="ref-25">25</xref></sup>. Our analysis associated mutant <italic toggle="yes">PIK3CA</italic> with STAT4, and NFATC1 transcriptional activity in breast cancer tumors. To validate the effect of the oncogenic PI3K in the activity of these TFs, we utilized quantitative PCR (qPCR) to measure the expression of canonical target genes in parental and <italic toggle="yes">PIK3CA</italic><sup>H1047R</sup> knock-in MCF10a cells and in MCF7 (<italic toggle="yes">PIK3CA</italic><sup>E545K</sup>) breast cancer cells treated with a panel of PI3K/AKT inhibitor (the PI3Kα specific inhibitors alpelisib and GDC0077, the PI3Kα/γ/δ inhibitor GDC0032/Taselisib, the pan-AKT inhibitor GDC0068) and the mTOR inhibitor RAD001/Everolimus. First, we examined the efficacy of the inhibitor treatment by measuring the levels of p-AKT and p-S6, well-characterized outputs of the PI3K pathway, by western blotting. The results revealed that the induction of p-AKT and p-S6 levels in the <italic toggle="yes">PIK3CA</italic> mutant cells was reversed by all tested inhibitors, with the exemption of GDC0068 (AKTi) which locks AKT in a phosphorylated state. (<bold>Supplementary Fig. 6A, 6B</bold>). Gene expression analysis revealed altered expression of canonical STAT4 and NFATC1 target genes in mutant <italic toggle="yes">PIK3CA</italic> cells (<bold><xref ref-type="fig" rid="fig6" hwp:id="xref-fig-6-1" hwp:rel-id="F6">Fig. 6A, 6B</xref></bold>). Notably, the expression changes were reversed upon treatment with PI3K/AKT inhibitors (<bold><xref ref-type="fig" rid="fig6" hwp:id="xref-fig-6-2" hwp:rel-id="F6">Fig. 6A, 6B</xref></bold>), but not mTOR, in both cell lines, suggesting the differential regulation of the transcriptional program of STAT4 and NFATC1 by the PI3K/AKT/mTOR pathway. Furthermore, chromatin immunoprecipitation (ChIP)-qPCR experiments confirmed STAT4 and NFATC1 binding to all target gene promoters in <italic toggle="yes">PIK3CA</italic> mutant MCF10a cells, which was significantly reversed upon PIK3α inhibition (<bold><xref ref-type="fig" rid="fig6" hwp:id="xref-fig-6-3" hwp:rel-id="F6">Fig. 6C, 6D</xref></bold>). We also validated these findings by performing tissue ChIP-qPCR in MCF7-derived xenograft tumors treated with vehicle or alpelisib (see Methods section), with consistent results for the expression of the canonical STAT4 and NFATC1 targets. (<bold><xref ref-type="fig" rid="fig6" hwp:id="xref-fig-6-4" hwp:rel-id="F6">Fig. 6E</xref></bold>). Similarly, western blot analysis of tumor lysates confirmed the reduction of p-AKT and p-S6 levels upon alpelisib treatment relative to vehicle-treated tumors (<bold>Supplementary Fig. 6</bold>) Altogether, these data suggest that the oncogenic PI3K regulates the transcriptional activity of STAT4 and NFATC1 and their downstream transcriptional program in cells and breast cancer tumors.</p><fig id="fig6" position="float" orientation="portrait" fig-type="figure" hwp:id="F6" hwp:rev-id="xref-fig-6-1 xref-fig-6-2 xref-fig-6-3 xref-fig-6-4"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;2021.09.07.459263v2/FIG6</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F6</object-id><object-id pub-id-type="publisher-id">fig6</object-id><label>Fig. 6:</label><caption hwp:id="caption-6"><title hwp:id="title-14">Experimental validation of the PIK3CA-driven TF in breast cancer.</title><p hwp:id="p-26"><bold>(A)</bold> Validation of canonical target genes of STAT4, and NFATC1 in MCF10A parental and <italic toggle="yes">PIK3CA</italic><sup>H1047R</sup> cells treated with DMSO or a panel of PI3K/AKT inhibitors (alpelisib 1μM, GDC0077 100nM, GDC0032 100nM, GDC0068 1μM, Everolimus 100nM) in starvation media for 4 hours, using qPCR. Expression levels were normalized to ACTIN. Circles represent independent experiments. The efficiency of inhibitors’ treatement in shown in Supplementary Figure 6. <bold>(B)</bold> Similar analysis of expression of target genes in MCF7 (<italic toggle="yes">PIK3CA</italic><sup>E545K</sup>) was performed as in A. <bold>(C)</bold> ChIP-qPCR assays for the occupancy of STAT4 (left) and NFATC1 (right) in the indicated gene promoters, using the same cells as in A, treated with alpelisib 1μM for 4h. Error bars show SD (n=3). *p&lt;0.05, **p&lt;0.01, ***p&lt;0.001, ****p&lt;0.0001. (one-side unpaired t-test). <bold>(D)</bold> ChIP-qPCR assays for the occupancy of STAT4 and NFATC1 in MCF7 cells as in C. <bold>(E)</bold> Validation of the same target genes as in <bold>A</bold>, in MCF7-derived xenograft tumors treated with Vehicle or Alpelisib (for details see Methods). Expression levels were normalized on ACTIN. Circles represent independent experiments. Error bars show SED (n=2). *p&lt;0.05, **p&lt;0.01, ***p&lt;0.001, ****p&lt;0.0001. (one-side unpaired t-test).</p></caption><graphic xlink:href="459263v2_fig6" position="float" orientation="portrait" hwp:id="graphic-6"/></fig></sec></sec><sec id="s3" hwp:id="sec-6"><title hwp:id="title-15">Discussion</title><p hwp:id="p-27">Tumor data sets are a challenging case for regulatory network analysis due to the complexity of cancer genomes (e.g. alterations such as aneuploidy, CNVs, structural variation, and mutations) confounding epigenomic and regulatory sequence analysis. Our method provides a systematic framework for integrating resources on regulatory genomics with tumor expression and mutation and CNV data to better understand expression programs driven by SAs in cancers and infer patient-specific TF activities. Our method uses a deep learning framework called a self-attention mechanism to capture the complex contextual interactions between somatic alterations. For a more accurate representation of TF:target-genes relationship, we leveraged ATAC-seq tumor data from patients. Our model is designed to capture the flow of information from altered genes (e.g. signaling proteins) to TFs to target genes; the knock out <italic toggle="yes">in silico</italic> analysis is likely to identify causal impacts of SAs. Joint modeling across different tumor types also reveals patient subgroups associated with SAs. We validated CITRUS-predicted TF activity associated with activating <italic toggle="yes">PIK3CA</italic> mutation in BRCA, using vitro and <italic toggle="yes">vivo</italic> models giving a proof-of-principle for the potential therapeutic application of our approach. We showed that for TFs associated with <italic toggle="yes">PIK3CA</italic> mutation, TF target gene expression changed after PI3K inhibitor treatment. In cases where a SA is associated with the activity of a targetable TF or their upstream/downstream component, our analysis may suggest combination therapies.</p><p hwp:id="p-28">One limitation of the TF binding motif search approach is that TFs of the same family often share a similar motif and thus are difficult to disambiguate. Therefore, TF motifs encompass the individual activities of multiple TFs. Moreover, co-binding TF binding patterns (e.g., AP-1-IRF complexes) can be biologically more important for fine tuning of gene expression. We will also investigate representing these composite elements as features in our models. Furthermore, we do not represent directionality in the TF:target-gene priors (i.e., whether a gene is activated or repressed by a TF). Hence, negative values of inferred TF activities can be meaningfully interpreted by prior knowledge of whether the TF is acting as an activator or as a repressor. These limitations may confound the interpretation of activities of TFs with context-specific activator and repressor roles. Further, tumor data sets are also a challenging case for regulatory network analysis due to the presence of stromal/immune cells within the tumor and the heterogeneity of cancer cells themselves. However, our framework can be extended to modeling of single-cell RNA-seq or deconvoluted RNA-seq by computational methods as we will report elsewhere.</p><p hwp:id="p-29">Despite these limitations, modeling the impact of SAs on transcriptional programs may ultimately enable the development of individualized therapies, aid in understanding mechanisms of drug resistance, and allow the identification of biomarkers of response. We anticipate that computational modeling of transcriptional regulation across different tumor types will emerge as an important tool in precision oncology, aiding in the eventual goal of choosing the best therapeutic option for each individual patient.</p></sec><sec id="s4" hwp:id="sec-7"><title hwp:id="title-16">Methods</title><sec id="s4a" hwp:id="sec-8"><title hwp:id="title-17">Data preprocessing</title><p hwp:id="p-30">We downloaded the RNA-seq data for each of the 17 tumor types from the Genomic Data Commons (GDC) portal (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://gdc.cancer.gov/about-data/publications/pancanatlas" ext-link-type="uri" xlink:href="https://gdc.cancer.gov/about-data/publications/pancanatlas" hwp:id="ext-link-1">https://gdc.cancer.gov/about-data/publications/pancanatlas</ext-link>). The RNA-seq expression data have been log2-transformed into RSEM values. We first identified the set of 2,500 genes that varied most across samples within a cancer type. We then took union across cancer types. The final geneset included 5541 genes.</p><p hwp:id="p-31">We obtained processed gene-level somatic alterations of each cancer patient from Cai et al.<sup><xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">4</xref></sup> Briefly, the value in the tumor for that gene was set to 1 if it hosts a non-synonymous mutation, small insert/deletion, or somatic copy number alteration (deletion or amplification), and otherwise, the value was set to 0. We removed genes that were not present in at least 4% of samples for each cancer type.</p><p hwp:id="p-32">We downloaded the ATAC-seq pancancer peak set from the GDC portal (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://gdc.cancer.gov/about-data/publications/ATACseq-AWG" ext-link-type="uri" xlink:href="https://gdc.cancer.gov/about-data/publications/ATACseq-AWG" hwp:id="ext-link-2">https://gdc.cancer.gov/about-data/publications/ATACseq-AWG</ext-link>)10. Using the MEME<sup><xref ref-type="bibr" rid="c24" hwp:id="xref-ref-24-2" hwp:rel-id="ref-24">24</xref></sup> curated Cis-BP<sup><xref ref-type="bibr" rid="c25" hwp:id="xref-ref-25-2" hwp:rel-id="ref-25">25</xref></sup> TF-binding motif reference, we scanned pancancer ATAC-seq peak atlas with FIMO<sup><xref ref-type="bibr" rid="c26" hwp:id="xref-ref-26-1" hwp:rel-id="ref-26">26</xref></sup> to find peaks likely to contain each motif (<italic toggle="yes">P</italic> &lt;10<sup>−5</sup>). The final set contained 320 motifs. We associated each peak to its nearest gene in the human genome using the ChIPpeakAnno package<sup><xref ref-type="bibr" rid="c27" hwp:id="xref-ref-27-1" hwp:rel-id="ref-27">27</xref></sup>. ATAC-seq peaks located in the body of the transcription unit, together with the 100 kb regions upstream of the transcription start site (TSS) and downstream of the 3’ end, were assigned to the gene. TF-binding site identification was used to turn each gene’s set of assigned ATAC peaks into a feature vector of binding signals by assigning the maximum score of each motif across all peaks to a gene. Then, we created a matrix C ∈ {0,1}<sup>kxl</sup> that defines a candidate set of associations between TFs and target genes. C<sub>i,j</sub> = 1 when there is a connection from TF <sub><italic toggle="yes">j</italic></sub> to the gene/RNA <italic toggle="yes">i</italic>; (red lines connecting the TF layer and Exp layer in <bold><xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-3" hwp:rel-id="F1">Fig. 1</xref></bold>).</p></sec><sec id="s4b" hwp:id="sec-9"><title hwp:id="title-18">CITRUS model</title><p hwp:id="p-33">Formally, given a specific tumor <italic toggle="yes">t</italic>, with the cancer type <italic toggle="yes">s</italic>, we have a set of SAs in the tumor <inline-formula hwp:id="inline-formula-1"><alternatives hwp:id="alternatives-1"><inline-graphic xlink:href="459263v2_inline1.gif" hwp:id="inline-graphic-1"/></alternatives></inline-formula> where <italic toggle="yes">m</italic> is number of mutant genes. The encoder module first maps each gene <italic toggle="yes">g</italic> (it is <italic toggle="yes">g<sub>u</sub></italic> here, but we omit the subscript for the simplicity of notation) into its corresponding gene vector <italic toggle="yes">e<sub>g</sub></italic>;. Then the encoder utilizes the multi-head self-attention mechanism to calculate the weighted sum of the both gene embeddings and cancer type embedding:
<disp-formula hwp:id="disp-formula-1">
<alternatives hwp:id="alternatives-2"><graphic xlink:href="459263v2_ueqn1.gif" position="float" orientation="portrait" hwp:id="graphic-7"/></alternatives>
</disp-formula>
</p><p hwp:id="p-34">The self-attention mechanism takes input of gene embeddings of all the mutated/altered genes, and output the attention weights <inline-formula hwp:id="inline-formula-2"><alternatives hwp:id="alternatives-3"><inline-graphic xlink:href="459263v2_inline2.gif" hwp:id="inline-graphic-2"/></alternatives></inline-formula> through a sub-neural network. Such attention mechanism captures the contextual impact of co-existing SAs and their complex interactions instead of simpler models. Interested readers can find the mathematical details in the reference<sup><xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-3" hwp:rel-id="ref-12">12</xref></sup>.</p><p hwp:id="p-35">The decoder part first infers the TF activities from the encoded tumor embedding <italic toggle="yes">e<sub>t</sub></italic>:
<disp-formula hwp:id="disp-formula-2">
<alternatives hwp:id="alternatives-4"><graphic xlink:href="459263v2_ueqn2.gif" position="float" orientation="portrait" hwp:id="graphic-8"/></alternatives>
</disp-formula>
</p><p hwp:id="p-36">We used the tanh activation instead of ReLU operation, which is more widely used in deep learning because it has similar performance to that of ReLU in our model and generates more biologically meaningful results, e.g., distribution of TFs <italic toggle="yes">e<sub>f</sub></italic>. Finally CITRUS predicts the cancer type specific mRNA expressions from the TF activities:
<disp-formula hwp:id="disp-formula-3">
<alternatives hwp:id="alternatives-5"><graphic xlink:href="459263v2_ueqn3.gif" position="float" orientation="portrait" hwp:id="graphic-9"/></alternatives>
</disp-formula>
where <italic toggle="yes">W</italic> corresponds to the sparse TF:target-gene matrix constrained by the prior <italic toggle="yes">C</italic> ∈ {0,1}<sup>k×l</sup>. More specifically, in order to integrate priors into our model, <italic toggle="yes">W</italic> share the same shape with prior <italic toggle="yes">C</italic>, and <italic toggle="yes">W<sub>j,j</sub></italic> is allowed to be nonzero only when C<italic toggle="yes"><sub>i,j</sub></italic> = 1, and W<sub>i,j</sub> is constrained to be non-negative value. The loss function to be optimized is thus: <italic toggle="yes">MSE</italic>(<italic toggle="yes">y</italic>,<italic toggle="yes">ŷ</italic>).</p><p hwp:id="p-37">One might use other common approaches to integrate the priors of <italic toggle="yes">C</italic> into the <italic toggle="yes">W</italic>, i.e., by applying a Gaussian prior to the <italic toggle="yes">W</italic>, which is equivalent to adding an additional penalty to the loss function <inline-formula hwp:id="inline-formula-3"><alternatives hwp:id="alternatives-6"><inline-graphic xlink:href="459263v2_inline3.gif" hwp:id="inline-graphic-3"/></alternatives></inline-formula>. However, this “soft” constraint tends to generate less stable TF layers across different runs of training compared to the “hard” constraints shown in our present work.</p><p hwp:id="p-38">We introduced additional dropout operations with dropout rate of 0.2 after the input layer, activated tumor embedding layer, and activated TF layer to increase the model robustness to noise and prevent overfitting.</p></sec><sec id="s4c" hwp:id="sec-10"><title hwp:id="title-19">Training and evaluation</title><p hwp:id="p-39">We implemented the CITRUS through the PyTorch package (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://pytorch.org/" ext-link-type="uri" xlink:href="https://pytorch.org/" hwp:id="ext-link-3">https://pytorch.org/</ext-link>) and trained through Adam optimizer with default parameters except the learning rate<sup><xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-2" hwp:rel-id="ref-15">15</xref></sup> and weight decay. We set learning rate to be 1 × 10<sup>−3</sup>, and weight decay to be 1 × 10<sup>−5</sup>. For each fold of training, we used early stopping with patience of 30 steps to stop training.</p><p hwp:id="p-40">For statistical evaluation, we computed the mean Spearman correlation (ρ) between predicted and measured gene expression profiles on held-out patients for each tumor type. We splitted the dateset into training (40%), validation (20%) and test sets (20%). For CITRUS model, we utilized the training and validation sets to tune hyperparameters such as learning rate and training steps, and then evaluated on the held-out test sets. For affinity regression (see below), we seperated datasets by cancer type, and conducted 5-fold cross-validation to tune hyperparameters for each type on training and validation sets, and then applied the trained model with selected hyperparameters to the test set for performance evaluation. In order to increase the stability for the analysis of inferred TF activities, we ensembled multiple CITRUS models with different random seeds, by bootstrapping the model for 10 times, and integrate the TF layer by taking the average of 10 trials to increase the stability of inference.</p><sec id="s4c1" hwp:id="sec-11"><title hwp:id="title-20">Process of parameter selection</title><p hwp:id="p-41">There are more than 10 hyperparameters (check the following paragraphs for their effects on the model) in CITRUS that were tuned to generate optimal performance on the validation set. The ideal way of performing hyperparameter optimization is the grid search on all parameters. However, this is not practical due to the tremendous computational cost. For example, 3 options for each parameter will lead to 3^10 possible combinations for 10 parameters in total. In addition, we usually need to guide the performance metric by k-fold cross-validation, and the total experiments will reach up to 5*3^10 (k=5) runs. Therefore, our hyperparameter turning strategy combines automatic as well as manual tuning. First, we set up the empirical setting for each parameter and began with a random search that selects from 100 random combinations. We utilized the best-performed setting as the guidance to narrow down the preliminary setting space and correlation among parameters. Then we tuned parameters independently or in a sub-group and fine-tuned them with manual setting or grid search.</p></sec><sec id="s5c2" hwp:id="sec-12"><title hwp:id="title-21">Model robustness against a variety of parameters</title><p hwp:id="p-42">As we know learning rate is perhaps the most important hyperparameter in neural network training. We first tested the learing_rate in a range setting [1e-5, 1e-4, 1e-3, 1e-2…], started from the lowest setting, and increased to a large value until the loss of the validation started to diverge. We found that if the learning rate was too small, overfitting occurred and picked up the noise of the input. Fewer driver genes were covered in the attention_weight analysis when the model overfit. If the learning rate was too big, however, the model could not converge to the optima which yielded higher test loss. After we determined the learning rate as 1e-3 or 1e-4, we added on the weight_decay to see how the penalty weight regulates with the learning rate to get optimal results. We set the range of weight_decay from 1e-6 to 1e-4 to tune together with the predetermined learning rate using grid search. We finalized the optimal setting with learning_rate=1e-3, weight_decay=1e-5. Choosing a large batch size may potentially enable us to increase the learning rate, which speeds up the training process. But from our experiments, the learning rate of 1e-3 is the largest value we can go without significantly losing the validation accuracy when tested on the batch size setting as [16, 64, 100, 300] (300 is the maximum value we could run in GPU). We found larger batch size tends to have a slightly higher gene-wise correlation at the cost of longer training time. To balance the execution time, we choose 100 as our optimal value for batch size. The early stopping patience setting was much related to the learning rate and batch size, where a higher learning rate and larger batch size need smaller patience to stop training, which otherwise may cause overfitting. Under our learing_rate and batch_size settings, the patience of 30 is generally good to keep the training process going forward without stopping too early (underfitting) due to the fluctuation, and also not stopping too far away from the optima (overfitting). We validated the setting by comparing it with the overtraining case. We picked the lowest loss point in the overfitted training, and checked how far it was from our stopped epoch with early stopping. During the early stage of training, the model tends to have some inconsistency: the validation performance went down before it turned up. So we skipped early stopping at the first 180 test steps.</p><p hwp:id="p-43">For testing the attention mechanism, we created the mesh grid for atteintion_size = [256, 128], attention_head=[32, 16, 8, 4], and performed an exhaustive search on these hyperparameter spaces. Based on the prediction performance incorporating attention, we chose the optimal values as attentioin_size=256 and attention_head=8.</p><p hwp:id="p-44">We finally fine-tuned our model with different dropout_rates.Since we have used the weight decay as regularization, the dropout is considered the secondary regularization for our model. Besides hidden layer dropout, we applied dropout to our input as well to reduce the input noise and network redundancy to generate a more stabilized hidden TF layer. We found that having the same input_dropout_rate with hidden layer dropout_rate got the best results. We tested the dropout_rate in the sequence of [0.1, 0.2, 0.3, 0.4, 0.5]. The performances on the test set are all above 0.9 of average sample correlation. We determined the optimal value (0.2) mainly based on the driver coverage in self-attention analysis.</p><p hwp:id="p-45">Since we used the early stopping mechanism, We just set max_iteration parameter to a very big value as 1000 (training process either stopped once patience setting was satisfied or reached max_iteration). This parameter was being used frequently as a setting to 1 in code testing for a quick run.</p><p hwp:id="p-46">We tried the activation function of ‘ReLU’ and ‘tanh’. They performed quite similarly, but ‘tanh’ tends to generate more biologically meaningful results. We tested l2, minimax, and standard normalization(scale) to the gene expression, the scale normalization generates the best prediction accuracy for our model setting.</p></sec></sec><sec id="s4d" hwp:id="sec-13"><title hwp:id="title-22">Training the affinity regression (AR) models</title><p hwp:id="p-47">AR is an algorithm for efficiently solving a regularized bilinear regression problem<sup><xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-3" hwp:rel-id="ref-15">15</xref>,<xref ref-type="bibr" rid="c28" hwp:id="xref-ref-28-1" hwp:rel-id="ref-28">28</xref></sup>, defined here as follows. For a data set of <italic toggle="yes">M</italic> tumor samples profiled using RNA-seq with <italic toggle="yes">N</italic> genes, we let <bold>Y</bold>∈<italic toggle="yes">R<sup>N×M</sup></italic> be the log 10 gene expression profiles of tumor samples. Each column of <bold>Y</bold> corresponds to an RNA-seq experiment for a cancer type. We define each gene’s TF attributes in a matrix <bold>D</bold>∈<italic toggle="yes">R<sup>N×Q</sup></italic>, where each row represents a gene and each column represent the hit vector for a TF, that is, the bit vector indicating whether there is binding site for the TF of each gene based on ATAC-seq data. We define the SA attributes of tumor samples as a matrix <bold>P</bold> ∈ <italic toggle="yes">R<sup>M×S</sup></italic> where each row represents a tumor sample and each column represents the somatic alteration status for the tumor sample. We set up a bilinear regression problem to learn the weight matrix <bold>W</bold> ∈ <italic toggle="yes">R<sup>Q×S</sup></italic> on paired of TF and SA features:
<disp-formula hwp:id="disp-formula-4">
<alternatives hwp:id="alternatives-7"><graphic xlink:href="459263v2_ueqn4.gif" position="float" orientation="portrait" hwp:id="graphic-10"/></alternatives>
</disp-formula>
</p><p hwp:id="p-48">We can transform the system to an equivalent system of equations by reformulating the matrix products as Kronecker products
<disp-formula hwp:id="disp-formula-5">
<alternatives hwp:id="alternatives-8"><graphic xlink:href="459263v2_ueqn5.gif" position="float" orientation="portrait" hwp:id="graphic-11"/></alternatives>
</disp-formula>
where ⊗ is a Kronecker product and vec(.) is a vectorizing operator that stacks a matrix and produces a vector, yielding a standard (if large-scale) regression problem. Full details and a derivation of the reduced optimization problem are provided elsewhere<sup><xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-4" hwp:rel-id="ref-15">15</xref></sup>.</p></sec><sec id="s4e" hwp:id="sec-14"><title hwp:id="title-23">Contextual impact of somatic alterations with knock out <italic toggle="yes">in silico</italic> analysis</title><p hwp:id="p-49">We implemented a knock out <italic toggle="yes">in silico</italic> approach that removes a specific somatic mutation (or copy number variation) <italic toggle="yes">g</italic> from all the tumor samples that carry it. The new knocked-out SA profiles and CITRUS-inferred TF activities generate the “wild type” corpus that does not contain this alteration <italic toggle="yes">g</italic>. In contrast, all the original samples containing the alteration <italic toggle="yes">g</italic> serve as the “mutant/altered” group. We finally conducted the t-test between the mutant group and wild type group to evaluate the contextual impact of mutation <italic toggle="yes">g</italic>. The knockout <italic toggle="yes">in silico</italic> is different from the normal t-test, since it captures contextual effects of mutations through the non-linear attention module of CITRUS, and provides a perfect experiment/control setting where all mutations are the same but mutation <italic toggle="yes">g</italic>. For a complex genotype, the model explains TF regulator activity across tumors. We then corrected for multiple hypotheses across regulator models, treating inferred TF activities as separate groups of tests.</p></sec><sec id="s4f" hwp:id="sec-15"><title hwp:id="title-24">Selection of TF targets for validation experiments</title><p hwp:id="p-50">The selection of the canonical target genes for each TF, was performed using the Cistrome Cancer Transcription Factor targets tool for BRCA, in the Cistrome project browser<sup><xref ref-type="bibr" rid="c29" hwp:id="xref-ref-29-1" hwp:rel-id="ref-29">29</xref></sup>.</p></sec><sec id="s4g" hwp:id="sec-16"><title hwp:id="title-25">Cell lines and PI3K/AKT/mTOR inhibitors</title><p hwp:id="p-51">MCF10A Isogenic parental and <italic toggle="yes">PIK3CA</italic><sup>H1047R</sup> heterozygous mutants were purchased from Horizon. MCF-10A cells were maintained in DF-12 media supplemented with 5% filtered horse serum (Invitrogen), EGF (20 ng/μL) (Sigma), hydrocortisone (0.5 mg/mL) (Sigma), cholera toxin (100 mg/mL) (Sigma), insulin (10 μg/mL) (Sigma), and 1% penicillin/streptomycin. Cells were used at low passages and were incubated at 37°C in 5% CO2. MCF10A parental and mutant cells were seeded in 6-multiwell plates in regular culture conditions to allow correct attachment and ensure ~75% confluency at harvesting day. 24 hours after seeding, cells were washed twice with PBS before adding the starvation media (without serum, EGF and insulin). Where indicated, cells were treated with DMSO as control or alpelisib (1μM), taselisib (100nM), GDC0077 (100nM), GDC0068/ipatasertib (1μM) or RAD001/everolimus (100nM) for 4h.</p><p hwp:id="p-52">MCF7 were purchased from ATCC (ATCC HTB-22) and grown in DMEM/F12 supplemented with 10% FBS, penicillin/ streptomycin 1% under standard conditions. The PI3Ka-specific inhibitors alpelisib and GDC0077, the PI3Kα/γ/δ taselisib, the pan-AKT inhibitor GDC0068/ipatasertib, the mTORC1 inhibitor RAD001/everolimus were purchased (Selleckchem). All the cells were tested regularly for mycoplasma, to ensure experiments in mycoplasma-free cultures.</p></sec><sec id="s4h" hwp:id="sec-17"><title hwp:id="title-26">In vivo studies</title><p hwp:id="p-53">For the MCF7 xenograft study, 0.18 mg/90d-release oestrogen pellets were implanted into 6-week-old female NOD <italic toggle="yes">scid</italic> gamma mice 3 days prior to the tumor cell transplantation. Ten million MCF7 cells per mouse were subcutaneously transplanted.</p></sec><sec id="s4i" hwp:id="sec-18"><title hwp:id="title-27">RNA extraction and RT–qPCR</title><p hwp:id="p-54">RNA was isolated using the QIAGEN RNeasy Kit and retrotranscription was performed using the iScript cDNA synthesis kit from Bio-Rad, following manufacturer’s instructions. cDNA was amplified by real time quantitative PCR in a Applied Biosystems Real-Time PCR system, using SYBR Select Master Mix from Applied Biosystems. Each sample was run in technical triplicates and each experiment was performed in triplicate.</p></sec><sec id="s4j" hwp:id="sec-19"><title hwp:id="title-28">Statistical analysis</title><p hwp:id="p-55">Statistical tests were performed with the R statistical environment and <italic toggle="yes">Python</italic>. For population comparisons of inferred TF activities, we performed Student’s t-test and determined the direction of shifts by comparing the mean of two populations. We corrected raw P-values for multiple hypothesis testing based on two methods: Bonferroni and false discovery rate (BH method).</p><p hwp:id="p-56">Association score between TF activity subtypes and frequent SAs. For each somatic mutation or copy number variation, we calculated the <italic toggle="yes">p</italic>-value of its frequency in a cancer subtype is different from that in other subtypes using Fisher’s exact test. The <italic toggle="yes">p</italic>-value was further adjusted through FDR across subtypes. To identify the relative frequency of a SA in a subtype, we defined the association score, which is the product of relative frequency direction and −log<sub>10</sub>FDR.</p></sec></sec></body><back><sec hwp:id="sec-20"><title hwp:id="title-29">Data Availability</title><p hwp:id="p-57">ATAC-seq data is available in a public repository from Genomic Data Commons (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://gdc.cancer.gov/about-data/publications/ATACseq-AWG" ext-link-type="uri" xlink:href="https://gdc.cancer.gov/about-data/publications/ATACseq-AWG" hwp:id="ext-link-4">https://gdc.cancer.gov/about-data/publications/ATACseq-AWG</ext-link>). RNA-seq gene expression data, somatic mutation, copy number variation data and clinical data are available in a public repository from TCGA’s Firehose data run (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://confluence.broadinstitute.org/display/GDAC/Dashboard-Stddata" ext-link-type="uri" xlink:href="https://confluence.broadinstitute.org/display/GDAC/Dashboard-Stddata" hwp:id="ext-link-5">https://confluence.broadinstitute.org/display/GDAC/Dashboard-Stddata</ext-link>). Only the samples ‘whitelisted’ by TCGA for the Pan-Cancer Analysis Working Group were used in the study. For our analysis, we restricted to samples with parallel RNA-seq, somatic mutation and GISTIC copy number data. Processed infut data files and output files have been made available the supplementary website for the paper: <ext-link l:rel="related" l:ref-type="uri" l:ref="http://www.pitt.edu/~xim33/CITRUS" ext-link-type="uri" xlink:href="http://www.pitt.edu/~xim33/CITRUS" hwp:id="ext-link-6">http://www.pitt.edu/~xim33/CITRUS</ext-link>.</p></sec><sec hwp:id="sec-21"><title hwp:id="title-30">Code Availability</title><p hwp:id="p-58">The software for CITRUS is available from <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/osmanbeyoglulab/CITRUS" ext-link-type="uri" xlink:href="https://github.com/osmanbeyoglulab/CITRUS" hwp:id="ext-link-7">https://github.com/osmanbeyoglulab/CITRUS</ext-link></p></sec><ref-list hwp:id="ref-list-1"><title hwp:id="title-31">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1"><label>1</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.1" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-1"><collab hwp:id="collab-1">Consortium, I. T. P.-C. A. o. W. G.</collab> <article-title hwp:id="article-title-2">Pan-cancer analysis of whole genomes</article-title>. <source hwp:id="source-1">Nature</source> <volume>578</volume>, <fpage>82</fpage>–<lpage>93</lpage>, doi:<pub-id pub-id-type="doi">10.1038/s41586-020-1969-6</pub-id> (<year>2020</year>).</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1"><label>2</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><collab hwp:id="collab-2">Cancer Genome Atlas Research, N.</collab> <etal>et al.</etal> <article-title hwp:id="article-title-3">The Cancer Genome Atlas Pan-Cancer analysis project</article-title>. <source hwp:id="source-2">Nat Genet</source> <volume>45</volume>, <fpage>1113</fpage>–<lpage>1120</lpage>, doi:<pub-id pub-id-type="doi">10.1038/ng.2764</pub-id> (<year>2013</year>).</citation></ref><ref id="c3" hwp:id="ref-3" hwp:rev-id="xref-ref-3-1"><label>3</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.3" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Wang Z."><surname>Wang</surname>, <given-names>Z.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-4">Cancer driver mutation prediction through Bayesian integration of multi-omic data</article-title>. <source hwp:id="source-3">PLoS One</source> <volume>13</volume>, <fpage>e0196939</fpage>, doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0196939</pub-id> (<year>2018</year>).</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1"><label>4</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.4" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Cai C."><surname>Cai</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-5">Systematic discovery of the functional impact of somatic genome alterations in individual tumors through tumor-specific causal inference</article-title>. <source hwp:id="source-4">PLoS Comput Biol</source> <volume>15</volume>, <fpage>e1007088</fpage>, doi:<pub-id pub-id-type="doi">10.1371/journal.pcbi.1007088</pub-id> (<year>2019</year>).</citation></ref><ref id="c5" hwp:id="ref-5"><label>5</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.5" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Hofree M."><surname>Hofree</surname>, <given-names>M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Shen J. P."><surname>Shen</surname>, <given-names>J. P.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Carter H."><surname>Carter</surname>, <given-names>H.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gross A."><surname>Gross</surname>, <given-names>A.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Ideker T."><surname>Ideker</surname>, <given-names>T.</given-names></string-name> <article-title hwp:id="article-title-6">Network-based stratification of tumor mutations</article-title>. <source hwp:id="source-5">Nat Methods</source> <volume>10</volume>, <fpage>1108</fpage>–<lpage>1115</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nmeth.2651</pub-id> (<year>2013</year>).</citation></ref><ref id="c6" hwp:id="ref-6"><label>6</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.6" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Paull E. O."><surname>Paull</surname>, <given-names>E. O.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-7">Discovering causal pathways linking genomic events to transcriptional states using Tied Diffusion Through Interacting Events (TieDIE)</article-title>. <source hwp:id="source-6">Bioinformatics</source> <volume>29</volume>, <fpage>2757</fpage>–<lpage>2764</lpage>, doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btt471</pub-id> (<year>2013</year>).</citation></ref><ref id="c7" hwp:id="ref-7"><label>7</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.7" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Basha O."><surname>Basha</surname>, <given-names>O.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Mauer O."><surname>Mauer</surname>, <given-names>O.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Simonovsky E."><surname>Simonovsky</surname>, <given-names>E.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Shpringer R."><surname>Shpringer</surname>, <given-names>R.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Yeger-Lotem E."><surname>Yeger-Lotem</surname>, <given-names>E.</given-names></string-name> <article-title hwp:id="article-title-8">ResponseNet v.3: revealing signaling and regulatory pathways connecting your proteins and genes across human tissues</article-title>. <source hwp:id="source-7">Nucleic Acids Res</source> <volume>47</volume>, <fpage>W242</fpage>–<lpage>W247</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkz421</pub-id> (<year>2019</year>).</citation></ref><ref id="c8" hwp:id="ref-8"><label>8</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Bashashati A."><surname>Bashashati</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-9">DriverNet: uncovering the impact of somatic driver mutations on transcriptional networks in cancer</article-title>. <source hwp:id="source-8">Genome Biol</source> <volume>13</volume>, <fpage>R124</fpage>, doi:<pub-id pub-id-type="doi">10.1186/gb-2012-13-12-r124</pub-id> (<year>2012</year>).</citation></ref><ref id="c9" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1 xref-ref-9-2"><label>9</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.9" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Ng S."><surname>Ng</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-10">PARADIGM-SHIFT predicts the function of mutations in multiple cancers using pathway impact analysis</article-title>. <source hwp:id="source-9">Bioinformatics</source> <volume>28</volume>, <fpage>i640</fpage>–<lpage>i646</lpage>, doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/bts402</pub-id> (<year>2012</year>).</citation></ref><ref id="c10" hwp:id="ref-10" hwp:rev-id="xref-ref-10-1"><label>10</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="Corces M. R."><surname>Corces</surname>, <given-names>M. R.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-11">The chromatin accessibility landscape of primary human cancers</article-title>. <source hwp:id="source-10">Science</source> <volume>362</volume>, doi:<pub-id pub-id-type="doi">10.1126/science.aav1898</pub-id> (<year>2018</year>).</citation></ref><ref id="c11" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1"><label>11</label><citation publication-type="other" citation-type="journal" ref:id="2021.09.07.459263v2.11" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="Vaswani A."><surname>Vaswani</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> in <source hwp:id="source-11">Advances in neural information processing systems</source> <fpage>5998</fpage>–<lpage>6008</lpage> (<year>2017</year>).</citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1 xref-ref-12-2 xref-ref-12-3"><label>12</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.12" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Tao Y."><surname>Tao</surname>, <given-names>Y.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Cai C."><surname>Cai</surname>, <given-names>C.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Cohen W. W."><surname>Cohen</surname>, <given-names>W. W.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Lu X."><surname>Lu</surname>, <given-names>X.</given-names></string-name> <article-title hwp:id="article-title-12">From genome to phenome: Predicting multiple cancer phenotypes based on somatic genomic alterations via the genomic impact transformer</article-title>. <source hwp:id="source-12">Pac Symp Biocomput</source> <volume>25</volume>, <fpage>79</fpage>–<lpage>90</lpage> (<year>2020</year>).</citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1"><label>13</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.13" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="Cadow J."><surname>Cadow</surname>, <given-names>J.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Born J."><surname>Born</surname>, <given-names>J.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Manica M."><surname>Manica</surname>, <given-names>M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Oskooei A."><surname>Oskooei</surname>, <given-names>A.</given-names></string-name> &amp; Rodriguez <string-name name-style="western" hwp:sortable="Martinez M."><surname>Martinez</surname>, <given-names>M.</given-names></string-name> <article-title hwp:id="article-title-13">PaccMann: a web service for interpretable anticancer compound sensitivity prediction</article-title>. <source hwp:id="source-13">Nucleic Acids Res</source> <volume>48</volume>, <fpage>W502</fpage>–<lpage>W508</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkaa327</pub-id> (<year>2020</year>).</citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1"><label>14</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.14" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Marquart K. F."><surname>Marquart</surname>, <given-names>K. F.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-14">Predicting base editing outcomes with an attention-based deep learning algorithm trained on high-throughput target library screens</article-title>. <source hwp:id="source-14">Nat Commun</source> <volume>12</volume>, <fpage>5114</fpage>, doi:<pub-id pub-id-type="doi">10.1038/s41467-021-25375-z</pub-id> (<year>2021</year>).</citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1 xref-ref-15-2 xref-ref-15-3 xref-ref-15-4"><label>15</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.15" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Pelossof R."><surname>Pelossof</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-15">Affinity regression predicts the recognition code of nucleic acid-binding proteins</article-title>. <source hwp:id="source-15">Nat Biotechnol</source> <volume>33</volume>, <fpage>1242</fpage>–<lpage>1249</lpage>, doi:<pub-id pub-id-type="doi">10.1038/nbt.3343</pub-id> (<year>2015</year>).</citation></ref><ref id="c16" hwp:id="ref-16"><label>16</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.16" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Osmanbeyoglu H. U."><surname>Osmanbeyoglu</surname>, <given-names>H. U.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Toska E."><surname>Toska</surname>, <given-names>E.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Chan C."><surname>Chan</surname>, <given-names>C.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Baselga J."><surname>Baselga</surname>, <given-names>J.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Leslie C. S."><surname>Leslie</surname>, <given-names>C. S.</given-names></string-name> <article-title hwp:id="article-title-16">Pancancer modelling predicts the context-specific impact of somatic mutations on transcriptional programs</article-title>. <source hwp:id="source-16">Nat Commun</source> <volume>8</volume>, <fpage>14249</fpage>, doi:<pub-id pub-id-type="doi">10.1038/ncomms14249</pub-id> (<year>2017</year>).</citation></ref><ref id="c17" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1"><label>17</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.17" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="Ma X."><surname>Ma</surname>, <given-names>X.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-17">SPaRTAN, a computational framework for linking cell-surface receptors to transcriptional regulators</article-title>. <source hwp:id="source-17">Nucleic Acids Res</source> <volume>49</volume>, <fpage>9633</fpage>–<lpage>9647</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkab745</pub-id> (<year>2021</year>).</citation></ref><ref id="c18" hwp:id="ref-18" hwp:rev-id="xref-ref-18-1"><label>18</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.18" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-18"><string-name name-style="western" hwp:sortable="Gala K."><surname>Gala</surname>, <given-names>K.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-18">KMT2C mediates the estrogen dependence of breast cancer through regulation of ERalpha enhancer function</article-title>. <source hwp:id="source-18">Oncogene</source> <volume>37</volume>, <fpage>4692</fpage>–<lpage>4710</lpage>, doi:<pub-id pub-id-type="doi">10.1038/s41388-018-0273-5</pub-id> (<year>2018</year>).</citation></ref><ref id="c19" hwp:id="ref-19" hwp:rev-id="xref-ref-19-1"><label>19</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.19" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-19"><string-name name-style="western" hwp:sortable="Jozwik K. M."><surname>Jozwik</surname>, <given-names>K. M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Chernukhin I."><surname>Chernukhin</surname>, <given-names>I.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Serandour A. A."><surname>Serandour</surname>, <given-names>A. A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Nagarajan S."><surname>Nagarajan</surname>, <given-names>S.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Carroll J. S."><surname>Carroll</surname>, <given-names>J. S.</given-names></string-name> <article-title hwp:id="article-title-19">FOXA1 Directs H3K4 Monomethylation at Enhancers via Recruitment of the Methyltransferase MLL3</article-title>. <source hwp:id="source-19">Cell Rep</source> <volume>17</volume>, <fpage>2715</fpage>–<lpage>2723</lpage>, doi:<pub-id pub-id-type="doi">10.1016/j.celrep.2016.11.028</pub-id> (<year>2016</year>).</citation></ref><ref id="c20" hwp:id="ref-20" hwp:rev-id="xref-ref-20-1"><label>20</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.20" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-20"><string-name name-style="western" hwp:sortable="Tarassishin L."><surname>Tarassishin</surname>, <given-names>L.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Lee S. C."><surname>Lee</surname>, <given-names>S. C.</given-names></string-name> <article-title hwp:id="article-title-20">Interferon regulatory factor 3 alters glioma inflammatory and invasive properties</article-title>. <source hwp:id="source-20">J Neurooncol</source> <volume>113</volume>, <fpage>185</fpage>–<lpage>194</lpage>, doi:<pub-id pub-id-type="doi">10.1007/s11060-013-1109-3</pub-id> (<year>2013</year>).</citation></ref><ref id="c21" hwp:id="ref-21" hwp:rev-id="xref-ref-21-1"><label>21</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.21" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-21"><string-name name-style="western" hwp:sortable="Wang M. D."><surname>Wang</surname>, <given-names>M. D.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-21">A novel role of Kruppel-like factor 8 as an apoptosis repressor in hepatocellular carcinoma</article-title>. <source hwp:id="source-21">Cancer Cell Int</source> <volume>20</volume>, <fpage>422</fpage>, doi:<pub-id pub-id-type="doi">10.1186/s12935-020-01513-3</pub-id> (<year>2020</year>).</citation></ref><ref id="c22" hwp:id="ref-22" hwp:rev-id="xref-ref-22-1"><label>22</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.22" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-22"><string-name name-style="western" hwp:sortable="Zhang Q."><surname>Zhang</surname>, <given-names>Q.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Stovall D. B."><surname>Stovall</surname>, <given-names>D. B.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Inoue K."><surname>Inoue</surname>, <given-names>K.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Sui G."><surname>Sui</surname>, <given-names>G.</given-names></string-name> <article-title hwp:id="article-title-22">The oncogenic role of Yin Yang 1</article-title>. <source hwp:id="source-22">Crit Rev Oncog</source> <volume>16</volume>, <fpage>163</fpage>–<lpage>197</lpage>, doi:<pub-id pub-id-type="doi">10.1615/critrevoncog.v16.i3-4.30</pub-id> (<year>2011</year>).</citation></ref><ref id="c23" hwp:id="ref-23" hwp:rev-id="xref-ref-23-1"><label>23</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.23" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-23"><string-name name-style="western" hwp:sortable="Martinez L. A."><surname>Martinez</surname>, <given-names>L. A.</given-names></string-name> <article-title hwp:id="article-title-23">Mutant p53 and ETS2, a Tale of Reciprocity</article-title>. <source hwp:id="source-23">Front Oncol</source> <volume>6</volume>, <fpage>35</fpage>, doi:<pub-id pub-id-type="doi">10.3389/fonc.2016.00035</pub-id> (<year>2016</year>).</citation></ref><ref id="c24" hwp:id="ref-24" hwp:rev-id="xref-ref-24-1 xref-ref-24-2"><label>24</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.24" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-24"><string-name name-style="western" hwp:sortable="Bailey T. L."><surname>Bailey</surname>, <given-names>T. L.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-24">MEME SUITE: tools for motif discovery and searching</article-title>. <source hwp:id="source-24">Nucleic Acids Res</source> <volume>37</volume>, <fpage>W202</fpage>–<lpage>208</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gkp335</pub-id> (<year>2009</year>).</citation></ref><ref id="c25" hwp:id="ref-25" hwp:rev-id="xref-ref-25-1 xref-ref-25-2"><label>25</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.25" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-25"><string-name name-style="western" hwp:sortable="Weirauch M. T."><surname>Weirauch</surname>, <given-names>M. T.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-25">Determination and inference of eukaryotic transcription factor sequence specificity</article-title>. <source hwp:id="source-25">Cell</source> <volume>158</volume>, <fpage>1431</fpage>–<lpage>1443</lpage>, doi:<pub-id pub-id-type="doi">10.1016/j.cell.2014.08.009</pub-id> (<year>2014</year>).</citation></ref><ref id="c26" hwp:id="ref-26" hwp:rev-id="xref-ref-26-1"><label>26</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.26" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-26"><string-name name-style="western" hwp:sortable="Grant C. E."><surname>Grant</surname>, <given-names>C. E.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Bailey T. L."><surname>Bailey</surname>, <given-names>T. L.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Noble W. S."><surname>Noble</surname>, <given-names>W. S.</given-names></string-name> <article-title hwp:id="article-title-26">FIMO: scanning for occurrences of a given motif</article-title>. <source hwp:id="source-26">Bioinformatics</source> <volume>27</volume>, <fpage>1017</fpage>–<lpage>1018</lpage>, doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btr064</pub-id> (<year>2011</year>).</citation></ref><ref id="c27" hwp:id="ref-27" hwp:rev-id="xref-ref-27-1"><label>27</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.27" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-27"><string-name name-style="western" hwp:sortable="Zhu L. J."><surname>Zhu</surname>, <given-names>L. J.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-27">ChIPpeakAnno: a Bioconductor package to annotate ChIP-seq and ChIP-chip data</article-title>. <source hwp:id="source-27">BMC Bioinformatics</source> <volume>11</volume>, <fpage>237</fpage>, doi:<pub-id pub-id-type="doi">10.1186/1471-2105-11-237</pub-id> (<year>2010</year>).</citation></ref><ref id="c28" hwp:id="ref-28" hwp:rev-id="xref-ref-28-1"><label>28</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.28" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-28"><string-name name-style="western" hwp:sortable="Osmanbeyoglu H. U."><surname>Osmanbeyoglu</surname>, <given-names>H. U.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Pelossof R."><surname>Pelossof</surname>, <given-names>R.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Bromberg J. F."><surname>Bromberg</surname>, <given-names>J. F.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Leslie C. S."><surname>Leslie</surname>, <given-names>C. S.</given-names></string-name> <article-title hwp:id="article-title-28">Linking signaling pathways to transcriptional programs in breast cancer</article-title>. <source hwp:id="source-28">Genome Res</source> <volume>24</volume>, <fpage>1869</fpage>–<lpage>1880</lpage>, doi:<pub-id pub-id-type="doi">10.1101/gr.173039.114</pub-id> (<year>2014</year>).</citation></ref><ref id="c29" hwp:id="ref-29" hwp:rev-id="xref-ref-29-1"><label>29</label><citation publication-type="journal" citation-type="journal" ref:id="2021.09.07.459263v2.29" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-29"><string-name name-style="western" hwp:sortable="Zheng R."><surname>Zheng</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-29">Cistrome Data Browser: expanded datasets and new tools for gene regulatory analysis</article-title>. <source hwp:id="source-29">Nucleic Acids Res</source> <volume>47</volume>, <fpage>D729</fpage>–<lpage>D735</lpage>, doi:<pub-id pub-id-type="doi">10.1093/nar/gky1094</pub-id> (<year>2019</year>).</citation></ref></ref-list><ack hwp:id="ack-1"><title hwp:id="title-32">Acknowledgements</title><p hwp:id="p-59">The results published here are in whole or part based on data generated by The Cancer Genome Atlas project established by the NCI and NHGRI (accession number: phs000178.v7p6). Information about TCGA and the investigators and institutions that constitute the TCGA research network can be found at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://cancergenome.nih.gov/" ext-link-type="uri" xlink:href="http://cancergenome.nih.gov/" hwp:id="ext-link-8">http://cancergenome.nih.gov/</ext-link>. We thank Jacob Stewart-Ornstein for helpful discussions. This work was supported by NIH award from R00CA207871. Y.T. was partially supported by Center for Machine Learning and Health Fellowship in Digital Health from Carnegie Mellon University. R.S. was partially supported by NIH award R21CA216452, by the National Human Genome Research Institute of the National Institutes of Health under award number R01HG010589, by the Pennsylvania Dept. of Health under award FP00003273, and by the Mario Lemieux Foundation. This work was was also partially supported by the AWS Machine Learning Research Awards granted to R.S. The content does not necessarily represent the official views of the above funding agencies. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health. The Pennsylvania Department of Health specifically disclaims responsibility for any analyses, interpretations or conclusions.</p></ack><sec hwp:id="sec-22"><title hwp:id="title-33">Ethics declarations</title><p hwp:id="p-60">Competing interests</p><p hwp:id="p-61">The authors declare no competing financial interests.</p></sec><sec hwp:id="sec-23"><title hwp:id="title-34">Author contributions</title><p hwp:id="p-62">H.U.O. conceived general ideas, supervised implementation, planned validation, and interpreted results. X.M. developed novel machine learning models and implemented validation experiments. Y.T. developed novel machine learning models and planned validation experiments. D.P. collected and preprocessed ATAC-seq data of the study. X.L. and R.S. helped to conceive general ideas, and interprete results. G.L. and A.G.Z performed the experimental validation and wrote the experimental validation section. E.T. supervised the experimental validation. H.U.O. and Y.T. wrote the manuscript. X.M., X.L. and R.S. contributed to reviewing, and editing the manuscript.</p></sec></back></article>
