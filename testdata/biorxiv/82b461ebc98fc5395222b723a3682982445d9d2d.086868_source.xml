<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/086868</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;086868v2</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;086868</article-id><article-id pub-id-type="other" hwp:sub-type="slug">086868</article-id><article-id pub-id-type="other" hwp:sub-type="tag">086868</article-id><article-version>1.2</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Synthetic Biology" hwp:journal="biorxiv"><subject>Synthetic Biology</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">Millstone: Software for Multiplex Microbial Genome Analysis and Engineering</article-title></title-group><author-notes hwp:id="author-notes-1"><fn id="n1" fn-type="equal" hwp:id="fn-1" hwp:rev-id="xref-fn-1-1 xref-fn-1-2"><label>6</label><p hwp:id="p-1">These authors contributed equally to this work.</p></fn><corresp id="cor1" hwp:id="corresp-1" hwp:rev-id="xref-corresp-1-1"><label>7</label>Correspondence should be addressed to G.M.C. (<email hwp:id="email-1">gchurch@genetics.med.harvard.edu</email>).</corresp></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><name name-style="western" hwp:sortable="Goodman Daniel B."><surname>Goodman</surname><given-names>Daniel B.</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-1" hwp:rel-id="aff-2">2</xref><xref ref-type="author-notes" rid="n1" hwp:id="xref-fn-1-1" hwp:rel-id="fn-1">6</xref></contrib><contrib contrib-type="author" hwp:id="contrib-2"><name name-style="western" hwp:sortable="Kuznetsov Gleb"><surname>Kuznetsov</surname><given-names>Gleb</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-2" hwp:rel-id="aff-2">2</xref><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-1" hwp:rel-id="aff-3">3</xref><xref ref-type="author-notes" rid="n1" hwp:id="xref-fn-1-2" hwp:rel-id="fn-1">6</xref></contrib><contrib contrib-type="author" hwp:id="contrib-3"><name name-style="western" hwp:sortable="Lajoie Marc J."><surname>Lajoie</surname><given-names>Marc J.</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-3" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-3" hwp:rel-id="aff-2">2</xref></contrib><contrib contrib-type="author" hwp:id="contrib-4"><name name-style="western" hwp:sortable="Ahern Brian W."><surname>Ahern</surname><given-names>Brian W.</given-names></name><xref ref-type="aff" rid="a5" hwp:id="xref-aff-5-1" hwp:rel-id="aff-5">5</xref></contrib><contrib contrib-type="author" hwp:id="contrib-5"><name name-style="western" hwp:sortable="Napolitano Michael G."><surname>Napolitano</surname><given-names>Michael G.</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-4" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-4" hwp:rel-id="aff-2">2</xref><xref ref-type="aff" rid="a4" hwp:id="xref-aff-4-1" hwp:rel-id="aff-4">4</xref></contrib><contrib contrib-type="author" hwp:id="contrib-6"><name name-style="western" hwp:sortable="Chen Kevin Y."><surname>Chen</surname><given-names>Kevin Y.</given-names></name><xref ref-type="aff" rid="a5" hwp:id="xref-aff-5-2" hwp:rel-id="aff-5">5</xref></contrib><contrib contrib-type="author" hwp:id="contrib-7"><name name-style="western" hwp:sortable="Chen Changping"><surname>Chen</surname><given-names>Changping</given-names></name><xref ref-type="aff" rid="a5" hwp:id="xref-aff-5-3" hwp:rel-id="aff-5">5</xref></contrib><contrib contrib-type="author" corresp="yes" hwp:id="contrib-8"><name name-style="western" hwp:sortable="Church George M."><surname>Church</surname><given-names>George M.</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-5" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-5" hwp:rel-id="aff-2">2</xref><xref ref-type="corresp" rid="cor1" hwp:id="xref-corresp-1-1" hwp:rel-id="corresp-1">7</xref></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2 xref-aff-1-3 xref-aff-1-4 xref-aff-1-5"><label>1</label><institution hwp:id="institution-1">Department of Genetics, Harvard Medical School</institution>, Boston, Massachusetts, <country>USA</country></aff><aff id="a2" hwp:id="aff-2" hwp:rev-id="xref-aff-2-1 xref-aff-2-2 xref-aff-2-3 xref-aff-2-4 xref-aff-2-5"><label>2</label><institution hwp:id="institution-2">Wyss Institute for Biologically Inspired Engineering, Harvard Medical School</institution>, Boston, Massachusetts, <country>USA</country></aff><aff id="a3" hwp:id="aff-3" hwp:rev-id="xref-aff-3-1"><label>3</label><institution hwp:id="institution-3">Program in Biophysics, Harvard University</institution>, Boston, Massachusetts, <country>USA</country></aff><aff id="a4" hwp:id="aff-4" hwp:rev-id="xref-aff-4-1"><label>4</label><institution hwp:id="institution-4">Biological and Biomedical Sciences, Harvard Medical School</institution>, Boston, Massachusetts, <country>USA</country></aff><aff id="a5" hwp:id="aff-5" hwp:rev-id="xref-aff-5-1 xref-aff-5-2 xref-aff-5-3"><label>5</label><institution hwp:id="institution-5">Massachusetts Institute of Technology</institution>, Cambridge, Massachusetts, <country>USA</country></aff></contrib-group><pub-date pub-type="epub-original" hwp:start="2016"><year>2016</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2016-11-10T07:33:38-08:00">
    <day>10</day><month>11</month><year>2016</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2016-12-15T11:51:22-08:00">
    <day>15</day><month>12</month><year>2016</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2016-11-10T07:50:24-08:00">
    <day>10</day><month>11</month><year>2016</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2016-12-15T12:05:29-08:00">
    <day>15</day><month>12</month><year>2016</year>
  </pub-date><elocation-id>086868</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2016-11-09"><day>09</day><month>11</month><year>2016</year></date>
<date date-type="accepted" hwp:start="2016-12-15"><day>15</day><month>12</month><year>2016</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2016, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2016</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/" hwp:id="license-1"><p hwp:id="p-2">This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" hwp:id="ext-link-1">http://creativecommons.org/licenses/by/4.0/</ext-link></p></license></permissions><self-uri xlink:href="086868.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2019/pdf/086868v2.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="086868.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2019/abstracts/086868v2/086868v2.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2019/fulltext/086868v2/086868v2.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><p hwp:id="p-3">Inexpensive DNA sequencing and advances in genome editing have made computational analysis a major rate-limiting step in adaptive laboratory evolution and microbial genome engineering. We describe Millstone, a web-based platform which automates genotype comparison and visualization for projects with up to hundreds of genomic samples. To enable iterative genome engineering, Millstone allows users to design oligonucleotide libraries and create successive versions of reference genomes. Millstone is open source and easily deployable to a cloud platform, local cluster, or desktop, making it a scalable solution for any lab.</p></abstract><kwd-group kwd-group-type="author" hwp:id="kwd-group-1"><title hwp:id="title-2">Keywords</title><kwd hwp:id="kwd-1">Synthetic Biology</kwd><kwd hwp:id="kwd-2">Bioinformatics</kwd><kwd hwp:id="kwd-3">Synthetic Genomics</kwd><kwd hwp:id="kwd-4">Genome Engineering</kwd><kwd hwp:id="kwd-5">Microbial Evolution</kwd><kwd hwp:id="kwd-6">Whole Genome Sequencing</kwd><kwd hwp:id="kwd-7">Laboratory Evolution</kwd><kwd hwp:id="kwd-8">Experimental Evolution</kwd></kwd-group><counts><page-count count="26"/></counts><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-1">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta></front><body><sec id="s1" hwp:id="sec-1"><title hwp:id="title-3">Background</title><p hwp:id="p-4">Microbial populations can harbor a staggering amount of genomic diversity, enabling them to evolve and adapt to diverse environments. Adaptive laboratory evolution uses this process to generate strains that are useful for biotechnology or for answering fundamental biological questions (<xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">Dragosits and Mattanovich 2013</xref>). In addition to harnessing natural variation, biologists can generate targeted genomic diversity in a population of cells and then screen or select for phenotypes of interest (<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">Wang et al. 2009</xref>). The decreasing cost of reading and writing microbial genomes has made it possible to generate billions of combinatorial genomic variants per day at specific loci (<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-2" hwp:rel-id="ref-16">Wang et al. 2009</xref>; <xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">Isaacs et al. 2011</xref>; <xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-1" hwp:rel-id="ref-8">Jiang et al. 2013</xref>) and to sequence entire <italic toggle="yes">E. coli</italic> genomes for less than 25 USD per sample (<xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">Baym et al. 2015</xref>; <xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">Shapland et al. 2015</xref>) (<bold><xref ref-type="sec" rid="s5" hwp:id="xref-sec-18-1" hwp:rel-id="sec-18">Supplementary Note 1</xref></bold>).</p><p hwp:id="p-5">Computational analysis is increasingly a bottleneck when mapping whole-genome data to phenotypes across many samples. Going from raw DNA sequencing reads to annotated variants requires the integration of a large number of disparate tools, usually assembled into an <italic toggle="yes">ad hoc</italic> pipeline by individual labs and followed by time-intensive manual confirmation of variants. There remains a critical need for an integrated solution capable of comparative analysis among multiple genomes and supporting interactive querying and data visualization, collaboration, genome versioning, and the design of additional mutations or reversions (<bold>Supplementary <xref rid="tbls1" ref-type="table" hwp:id="xref-table-wrap-1-1" hwp:rel-id="T1">Table 1</xref>, <xref ref-type="sec" rid="s6" hwp:id="xref-sec-21-1" hwp:rel-id="sec-21">Supplementary Note 2</xref></bold>).</p><p hwp:id="p-6">To address this need, we developed Millstone, a web-based software platform that supports an iterative process of multiplex mutation analysis and genome engineering. Millstone automates read alignment and variant calling using a hybrid reference-based and <italic toggle="yes">de novo</italic> assembly approach, then allows researchers to explore and compare mutations among genomic samples, and finally creates updated reference genomes and designs new genomic edits for subsequent rounds of experiments (<bold><xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Fig. 1a</xref></bold>). Serving as both a genomics pipeline and a platform for exploring whole-genome sequencing data, Millstone provides a powerful user-friendly interface that allows researchers to investigate individual variants through interactive filtering and alignment visualization (<bold><xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-2" hwp:rel-id="F1">Fig. 1b</xref></bold>).</p><fig id="fig1" position="float" orientation="portrait" fig-type="figure" hwp:id="F1" hwp:rev-id="xref-fig-1-1 xref-fig-1-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;086868v2/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Figure 1:</label><caption hwp:id="caption-1"><title hwp:id="title-4">Millstone enables rapid iterative multiplex genome analysis and engineering.</title><p hwp:id="p-7">(<bold>a</bold>) To use Millstone, a researcher uploads a reference genome and next-generation sequencing reads for many individual genomic clones, for example from long-term evolution or targeted genome editing. Millstone performs alignment and variant calling for both single nucleotide variants and structural variation and then assigns predicted effects based on reference genome annotations. A unified data model stores sample genotype, phenotype, and variant annotation data. Variants can then be queried, filtered, and grouped into sets for export, triage, and analysis. These variant sets can be used to design oligonucleotides to recreate or revert mutations of interest, or used to generate new versions of the reference genome. (<bold>b</bold>) A combined screenshot of the Millstone analysis and alignment visualization views (condensed and cropped for clarity). A custom query language allows searching and filtering over the data. As variant calls sometimes require visual inspection and comparison, Millstone’s variant analysis view provides programmatically-generated links to visualizations of the relevant read alignments in JBrowse (<xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">Skinner et al. 2009</xref>).</p></caption><graphic xlink:href="086868_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig></sec><sec id="s2" hwp:id="sec-2"><title hwp:id="title-5">Results</title><p hwp:id="p-8">Millstone was built in response to challenges encountered during the construction of the genomically recoded organism (GRO) <italic toggle="yes">C</italic>321. Δ<italic toggle="yes">A</italic> (<xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">Lajoie et al. 2013</xref>), a strain of <italic toggle="yes">E. coli</italic> in which all 321 UAG stop codons were replaced with a synonymous UAA. Multiplex automated genome engineering (<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-3" hwp:rel-id="ref-16">Wang et al. 2009</xref>) (MAGE) was used to introduce sets of 10 mutations into 32 strains and conjugative assembly genome engineering (<xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-2" hwp:rel-id="ref-7">Isaacs et al. 2011</xref>) (CAGE) was used to hierarchically combine redesigned regions into a chromosome with all 321 UAGs recoded (<bold><xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-1" hwp:rel-id="F2">Fig. 2a</xref></bold>, green). We sequenced 68 intermediate clones to confirm the designed changes but our initial analyses were slow, error-prone, and lacked the ability to visualize and compare evidence for mutations among samples. Millstone solved these issues, allowing us to identify and track the 3127 designed and off-target mutations across all strains. Finally, by iteratively applying mutations directly to the initial reference genome and re-aligning reads, Millstone allowed us to generate a new <italic toggle="yes">C</italic>321.Δ<italic toggle="yes">A</italic> reference sequence which incorporated 355 additional off-target mutations that had accumulated during strain construction. (<bold><xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-2" hwp:rel-id="F2">Fig. 2a</xref></bold>, green and orange).</p><p hwp:id="p-9">Millstone’s ability to rapidly generate clonal genotypes from whole genome sequencing reads enabled a follow-up project to improve the fitness of the GRO. The final strain from Lajoie et al. demonstrated incorporation of proteins containing non-standard amino acids, but suffered from an impaired growth phenotype, which we hypothesized was due to a subset of the 355 off-target mutations. We developed an iterative method for systematically optimizing strain fitness through predictive modeling and multiplex testing of reversions (<italic toggle="yes">Kuznetsov et al., submitted</italic>). Millstone was used throughout this process: first, to rank high-effect candidates for reversion, then to design oligonucleotides for MAGE, and finally to report variants from whole genome sequencing of 96 edited clones (<bold><xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-3" hwp:rel-id="F2">Fig. 2a</xref></bold>, orange). Once the final subset of effective reversions was identified and used to construct a faster-growing GRO, Millstone was also used to produce a final reference genome for the improved strain.</p><fig id="fig2" position="float" orientation="portrait" fig-type="figure" hwp:id="F2" hwp:rev-id="xref-fig-2-1 xref-fig-2-2 xref-fig-2-3 xref-fig-2-4 xref-fig-2-5 xref-fig-2-6"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;086868v2/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Figure 2:</label><caption hwp:id="caption-2"><title hwp:id="title-6">Millstone accurately detects genomic variants and can iteratively version genomes.</title><p hwp:id="p-10">(<bold>a</bold>) Millstone was used to analyze genomic clones involved in generating and rationally optimizing a genomically recoded organism. MAGE (<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-4" hwp:rel-id="ref-16">Wang et al. 2009</xref>) and CAGE (<xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-3" hwp:rel-id="ref-7">Isaacs et al. 2011</xref>) were used to generate the <italic toggle="yes">C</italic>321.Δ<italic toggle="yes">A</italic> strain of <italic toggle="yes">E. coli</italic> (<xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-2" hwp:rel-id="ref-9">Lajoie et al. 2013</xref>). With sequencing data from these strains, Millstone confirmed the designed mutations, identified and annotated off-target mutations, and generated a new reference genome. Further reversion of variants was performed with MAGE to improve the strain’s fitness (<italic toggle="yes">Kuznetsov et al., submitted</italic>), and a final reference genome was generated. (<bold>b</bold>) Analysis of 11 escapee clones from a biocontainment selection with a synthetic non-standard amino acid (nsAA) auxotrophy (<xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">Mandell et al. 2015</xref>) identified two escape mechanisms, either mutation of <italic toggle="yes">tyrS</italic> or disruption of <italic toggle="yes">lon</italic>. (<bold>c</bold>) Millstone can also be used for Adaptive Laboratory Evolution studies. We employed Millstone to analyze mutations across 115 clones in the Tenaillon et al.(<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">Tenaillon et al. 2012</xref>) high temperature evolution experiment. Millstone was used to create a new reference genome for the ancestral strain from REL606, the closest available reference genome, and called variants against this new reference. Millstone reports 99.2% of SNVs, deletions, and mobile elements found by the Tenaillon pipeline, as well some not identified in the original study (<bold>Supplementary <xref rid="tbls2" ref-type="table" hwp:id="xref-table-wrap-2-1" hwp:rel-id="T2">Table 2</xref></bold>).</p></caption><graphic xlink:href="086868_fig2" position="float" orientation="portrait" hwp:id="graphic-2"/></fig><p hwp:id="p-11">Millstone’s <italic toggle="yes">de novo</italic> assembly and genotype comparison features were crucial in a project to engineer a biocontained version of the GRO which is dependent on a non-standard amino acid (nsAA) for survival (<xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-2" hwp:rel-id="ref-11">Mandell et al. 2015</xref>). A major challenge in engineering biocontainment, and in selection more generally, is diagnosis of escape mechanisms. In <italic toggle="yes">Mandell et al</italic>., plating of early versions of the biocontained GRO on non-permissive media revealed individual clones that could survive without the essential nsAA. We performed whole genome sequencing on 11 escapee clones and several controls and used Millstone to identify loci enriched for mutations across escapees. This led to the discovery and validation of two primary mechanisms of escape: a single off-target nonsynonymous mutation in the redesigned <italic toggle="yes">tyrS</italic> gene occurring in 4/11 clones and disruption of the <italic toggle="yes">lon</italic> protease in the remaining 7 clones. Millstone revealed several modes of <italic toggle="yes">lon</italic> disruption: a frameshift (1/7), nonsynonymous substitution (1/7), and insertion of a mobile element upstream of the gene (5/7) (<bold><xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-4" hwp:rel-id="F2">Fig. 2b</xref></bold>). To identify and precisely map these mobile elements and other structural variants, Millstone combines a local <italic toggle="yes">de novo</italic> re-assembly approach with coverage-based deletion calling (<bold>Supplementary <xref rid="figs3" ref-type="fig" hwp:id="xref-fig-5-1" hwp:rel-id="F5">Fig. 3</xref></bold>). Rapid analysis of escapee clones allowed us to identify and validate the key mechanisms of escape from biocontainment, so that further modifications lowered escape rates by at least 5 orders of magnitude (undetectable escape with detection limit 2.2e-12 escapees per c.f.u.).(<xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-3" hwp:rel-id="ref-11">Mandell et al. 2015</xref>).</p><p hwp:id="p-12">Millstone can also be used to analyze genomic variation in samples undergoing adaptive laboratory evolution (ALE). In Tenaillon <italic toggle="yes">et al</italic>. (<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-2" hwp:rel-id="ref-15">Tenaillon et al. 2012</xref>), 115 lines of <italic toggle="yes">E. coli</italic> were grown at 42<italic toggle="yes"><sup>°</sup></italic>C in parallel for over 2,000 generations in an attempt to identify convergent evolutionary responses to this environmental challenge (<bold><xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-5" hwp:rel-id="F2">Fig. 2c</xref></bold>). This impressive effort required a custom sequencing analysis pipeline consisting of over half a dozen tools, followed by manual validation and visual confirmation of all 1331 variants. We reanalyzed the raw data from this project in Millstone and identified 99.7% of SNVs and 98.9% of structural variants and mobile element insertions. Millstone further discovered 8 SNVs, 4 large deletions, and 2 mobile element insertions that were not reported in the original work (<bold><xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-6" hwp:rel-id="F2">Fig. 2d</xref>, Supplementary <xref rid="tbls2" ref-type="table" hwp:id="xref-table-wrap-2-2" hwp:rel-id="T2">Table 2</xref></bold>). On an Amazon Web Services EC2 instance, the entire process from sample upload to variant triage across all 115 strains took a single day (<bold>Supplementary <xref rid="tbls3" ref-type="table" hwp:id="xref-table-wrap-3-1" hwp:rel-id="T3">Table 3</xref></bold>).</p></sec><sec id="s3" hwp:id="sec-3"><title hwp:id="title-7">Discussion</title><p hwp:id="p-13">New technologies for constructing, screening, and selecting microbial genomes now allow for increasingly complex functional genomics studies and bioengineering endeavors. As the sequence constraints of the genome come into focus, the promise of designing new organisms to address medical and material challenges is becoming a reality (<xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-1" hwp:rel-id="ref-5">Haimovich, Muir, and Isaacs 2015</xref>). The path forward requires rapid construction and characterization of successive versions of redesigned genomes (<xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-1" hwp:rel-id="ref-6">Hutchison et al. 2016</xref>; <xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">Ostrov et al. 2016</xref>), and computational genome design and analysis tools will increasingly become integral to this process. Researchers who already have raw sequencing data can use Millstone to identify and explore mutations. We have reduced the barrier for other labs to use Millstone by making the software deployable on Amazon Web Services (AWS). Documentation and an online demo are available at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://churchlab.github.io/millstone" ext-link-type="uri" xlink:href="http://churchlab.github.io/millstone" hwp:id="ext-link-2">http://churchlab.github.io/millstone</ext-link>.</p></sec><sec id="s4" hwp:id="sec-4"><title hwp:id="title-8">Methods</title><sec id="s4a" hwp:id="sec-5"><title hwp:id="title-9">Software availability and documentation</title><p hwp:id="p-14">Millstone source code is available at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/churchlab/millstone" ext-link-type="uri" xlink:href="https://github.com/churchlab/millstone" hwp:id="ext-link-3">https://github.com/churchlab/millstone</ext-link>. Documentation is available at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://millstone.readthedocs.io/" ext-link-type="uri" xlink:href="http://millstone.readthedocs.io/" hwp:id="ext-link-4">http://millstone.readthedocs.io/</ext-link>.</p></sec><sec id="s4b" hwp:id="sec-6"><title hwp:id="title-10">Deployment via Amazon Web Services (AWS)</title><p hwp:id="p-15">Using Millstone via AWS is the recommended option for most users. We have pre-configured a Millstone installation as an Amazon Machine Image (AMI), allowing users to sidestep all dependency installation and configuration steps. Researchers can provision a fully-configured private instance of Millstone running on AWS in minutes and can specify compute, memory, and disk requirements to match project needs. AWS allows resizing a machine without losing data. For most projects and benchmarking, we use a 32-core r3.8xlarge instance type for alignment and variant calling, and then resize the machine to the 2-core c3.large or c4.large instance type for data exploration. Academic labs can apply for the AWS Cloud Credits for Research program (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://aws.amazon.com/grants/" ext-link-type="uri" xlink:href="https://aws.amazon.com/grants/" hwp:id="ext-link-5">https://aws.amazon.com/grants/</ext-link>).</p></sec><sec id="s4c" hwp:id="sec-7"><title hwp:id="title-11">Analysis pipeline</title><p hwp:id="p-16">Millstone provides a user interface that guides a researcher through uploading a reference genome (Genbank or FASTA) and Illumina sequencing reads (FASTQ). The Millstone analysis pipeline then performs alignment, variant-calling, and annotation of called variants. Millstone aligns reads using BWA-MEM (<xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-1" hwp:rel-id="ref-10">Li and Durbin 2010</xref>), parallelizing across available cores. Millstone calls single nucleotide variants (SNV) using Freebayes and structural variants (SV) using a custom contig assembly-based method (see De Novo Assembly Pipeline below) and a custom coverage-based method. A diagram of the pipeline and the parallelization scheme is shown in <bold>Supplemental <xref rid="figs1" ref-type="fig" hwp:id="xref-fig-3-1" hwp:rel-id="F3">Fig. 1</xref></bold>. Even though Millstone was primarily designed for haploid bacterial genomes, the default and recommended mode for calling SNVs in Millstone is diploid. This allows for marginal calls that are neither clean wild-type nor clean mutant alleles, indicated as “heterozygous” under the GT TYPE field (GT in VCF format). If the user-provided reference genome is annotated (i.e. Genbank format), the Millstone analysis pipeline can annotate variants with predicted effect using SnpEff (<xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">Cingolani et al. 2012</xref>).</p></sec><sec id="s4d" hwp:id="sec-8"><title hwp:id="title-12">Variant exploration view</title><p hwp:id="p-17">Millstone provides an interactive user interface for exploring mutations and comparing genomes. Two primary data view modes, <italic toggle="yes">cast</italic> and <italic toggle="yes">melted</italic>, allow exploring data with samples aggregated by mutation or by individual mutation-sample relationships, respectively. Each mutation row includes icons that link to the relevant view of aligned reads in JBrowse. This is useful for performing visual quality control (QC) on aligned regions to verify that reads are properly aligned around a variant or to diagnose complex structural events. Visual QC is particularly important for inspecting marginal variant calls (see Analysis Pipeline), where only a fraction of aligned reads show a SNV. These can indicate regional duplication, non-unique mapping of reads, or non-clonality.</p><p hwp:id="p-18">A query language allows filtering variants according to fields such as read depth, evidence quality, gene affected, predicted impact (Online Documentation). The filter key GT TYPE is particularly important with respect to identifying mutant alleles and distinguishing them from marginal calls. GT TYPE can take on values of 0 (strong evidence wild-type allele), 1 (marginal call), or 2 (strong evidence mutant allele). The query language allows for boolean combinations of key-value statements. For example, the following query filters the displayed variants down to only well-supported mutants that have a moderate to strong affect on some gene:
<preformat position="float" orientation="portrait" xml:space="preserve" hwp:id="preformat-1">GT TYPE = 2 &amp; (INFO EFF IMPACT = HIGH | INFO EFF IMPACT = MODERATE)</preformat></p><p hwp:id="p-19">Further information and examples of queries can be found in the Online Documentation (<ext-link l:rel="related" l:ref-type="uri" l:ref="http://millstone.readthedocs.io/" ext-link-type="uri" xlink:href="http://millstone.readthedocs.io/" hwp:id="ext-link-6">http://millstone.readthedocs.io/</ext-link>).</p></sec><sec id="s4e" hwp:id="sec-9"><title hwp:id="title-13">Visualizing alignments</title><p hwp:id="p-20">Millstone uses JBrowse (<xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-2" hwp:rel-id="ref-14">Skinner et al. 2009</xref>) to visualize read alignments, enabling manual quality control and verification of complex structural events. For each called variant, Millstone programatically generates a link that brings up JBrowse at the affected locus showing the relevant alignment tracks. In the <italic toggle="yes">cast</italic> view, multiple JBrowse tracks will be shown simultaneously if the variant is present in multiple samples.</p></sec><sec id="s4f" hwp:id="sec-10"><title hwp:id="title-14">Variant sets</title><p hwp:id="p-21">Variant sets are an important unit of operation in Millstone that allow grouping variants after filtering. Millstone’s analysis pipeline also allocates variants to several common variant sets by default, including sets indicating insufficient coverage, no coverage, greater than expected coverage, or poor mapping quality (corresponding perhaps to regions that are non-unique).</p><p hwp:id="p-22">Variant sets can also be used to generate oligonucleotides targeting or reverting the mutations in the set, via an integrated python implementation of optMAGE (<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-5" hwp:rel-id="ref-16">Wang et al. 2009</xref>) (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/churchlab/optmage" ext-link-type="uri" xlink:href="https://github.com/churchlab/optmage" hwp:id="ext-link-7">https://github.com/churchlab/optmage</ext-link>). Millstone’s Genome Versioning feature allows for variant sets to be used to generate a new version of reference genome containing those variants as ‘ref’ alleles. In particular, we show the use of this feature to generate updated reference genomes for the C321. A strain and its improved version, C321. A.opt.</p></sec><sec id="s4g" hwp:id="sec-11"><title hwp:id="title-15">De novo assembly pipeline</title><p hwp:id="p-23">After Illumina sequencing reads are aligned to the genome, Millstone identifies candidate reads that may indicate structural variants, including unmapped, clipped, and split reads, as well as their pairs. These reads may indicate the presence of complex structural events such as deletions, novel sequence insertions, and translocations of mobile elements. Velvet (<xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">Zerbino and Birney 2008</xref>) is used to assemble these reads into <italic toggle="yes">de novo</italic> contigs.</p><p hwp:id="p-24">Once the reads are assembled into contigs by Velvet, those contigs over a size threshold are aligned back to the reference genome using BWA-MEM (<xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-2" hwp:rel-id="ref-10">Li and Durbin 2010</xref>). These contig-to-reference alignments are used by Millstone to generate a graph whose nodes are contigs and reference sequence fragments and whose edges are alignments. Individual contigs and their reference junctions can be browsed and downloaded by the user. The contig sequences can also be downloaded as FASTA records and blasted individually by the user. Contigs whose edges map to annotated mobile elements are also labelled in the user interface. Novel sequence and mobile element insertions consist of multiple graph edges (two edges for novel sequence, four for mobile element insertions, <bold>Supplemental <xref rid="figs3" ref-type="fig" hwp:id="xref-fig-5-2" hwp:rel-id="F5">Fig. 3b</xref></bold>). These variants are identified by a graph-traversal algorithm and converted into VCF records that are added to the variant database.</p></sec><sec id="s4h" hwp:id="sec-12"><title hwp:id="title-16">Tenaillon et al. Variant Comparison</title><p hwp:id="p-25">Raw data for Tenaillon et al. (<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-3" hwp:rel-id="ref-15">Tenaillon et al. 2012</xref>) was downloaded from <ext-link l:rel="related" l:ref-type="uri" l:ref="http://wfitch.bio.uci.edu/~tdlong/PapersRawData/Tenaillon.rawdata.tar.gz" ext-link-type="uri" xlink:href="http://wfitch.bio.uci.edu/~tdlong/PapersRawData/Tenaillon.rawdata.tar.gz" hwp:id="ext-link-8">http://wfitch.bio.uci.edu/~tdlong/PapersRawData/Tenaillon.rawdata.tar.gz</ext-link>. Using the strain metadata provided with the sequencing data, we generated a targets file containing fitness ratios, line labels, and paths to read files for all 115 samples.</p><p hwp:id="p-26">We first used Millstone to align the Ancestor strain (Line 0) to the REL606 reference genome (NCBI accession <ext-link l:rel="related" l:ref-type="genbank" l:ref="CP000819" ext-link-type="gen" xlink:href="CP000819" hwp:id="ext-link-9">CP000819</ext-link>). This found a 6.93kb deletion in <italic toggle="yes">scgB</italic> (3,894,998 bp) and an IS186 insertion near <italic toggle="yes">fimA</italic> (4,517,603 bp). We used Millstone’s Reference Genome Versioning feature to generate the REL1206 reference genome by applying these strucutral events to REL606.</p><p hwp:id="p-27">Finally, all 115 samples (including the Ancestor strain) were realigned to the new REL1206 genome using Millstone. The data were exported to CSV format for comparison with the variants called by Tenaillon et. al. For a list of mutation discrepancies between Millstone and Tenaillon, see <bold>Supplementary <xref rid="tbls2" ref-type="table" hwp:id="xref-table-wrap-2-3" hwp:rel-id="T2">Table 2</xref></bold>.</p></sec><sec id="s4i" hwp:id="sec-13"><title hwp:id="title-17">Optimizing Genomically Recoded Organism C321</title><p hwp:id="p-28">Δ<bold>A</bold> Millstone was used to create a new reference genome for the final C321. A strain. Mutations called by Millstone were triaged based on quality and added to a variant set. Then, from the variant set view, the ‘Generate New Reference Genome’ feature was used to create the new genome. This process was iterated two additional times until there were no structural or single nucleotide variants called against the new final reference genome. 205</p><p hwp:id="p-29">Millstone includes SnpEff (<xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-2" hwp:rel-id="ref-2">Cingolani et al. 2012</xref>) integration that allows annotating mutations with predicted effects. We used Millstone to generated 127 MAGE oligos to revert mutations predicted to have strong fitness effects.</p><p hwp:id="p-30">After sequencing 96 clones which underwent from 5 to 50 cycles of MAGE with subsets of these 127 oligos, Millstone was used to align and call variants across all clones. This process took 3 hours on a 32 core machine (<bold>Supplementary <xref rid="tbls3" ref-type="table" hwp:id="xref-table-wrap-3-2" hwp:rel-id="T3">Table 3</xref></bold>). Millstone generated a .csv file reporting evidence for variants, and this was combined with per-strain doubling time measurements to generate a regularized linear model (Kuznetsov et al., submitted). Additionally, during modeling and iterative testing we returned to Millstone to use the JBrowse view to visually validate and compare marginal variant calls among samples.</p><p hwp:id="p-31">Finally, Millstone was used to align, call variants, and produce a reference sequence for the final optimized strain, which contained 6 reverted alleles and 9 de novo mutations relative to the starting C321. A strain.</p></sec><sec id="s4j" hwp:id="sec-14"><title hwp:id="title-18">Mandell et al. Variant Comparison</title><p hwp:id="p-32">We obtained sequencing reads from the authors and uploaded and aligned them to the C321. A genome (described above). In addition to the 11 escapee genomes on the adk.d8 and tyrS.d6 strain backgrounds, we also sequenced control clones for each background which remained dependent on the non-standard amino acid bipA, and some additional escapee clones on other nsAA-dependent backgrounds.</p><p hwp:id="p-33">To identify the SNVs, including the <italic toggle="yes">lon</italic> and <italic toggle="yes">tyrS</italic> A70V mutations, we used Millstone to look for non-designed mutations which occurred only in the escapee strains and not in the bipA-dependent strains. To exhaustively identify transposon insertions where only partial alignment support was available, we additionally downloaded the raw contig list from Millstone and looked for contigs with graph edges mapping from mobile elements to other genome locations. We identified junction contigs which bridge the IS186 mobile element and the <italic toggle="yes">lon</italic> gene in 5 strains (<bold>Supplemental <xref rid="figs3" ref-type="fig" hwp:id="xref-fig-5-3" hwp:rel-id="F5">Fig. 3</xref></bold>).</p></sec><sec id="s4k" hwp:id="sec-15"><title hwp:id="title-19">Data representation</title><p hwp:id="p-34">Millstone stores variant, experiment sample, and evidence data across several tables in a PostgreSQL database (<bold>Supplemental <xref rid="figs2" ref-type="fig" hwp:id="xref-fig-4-1" hwp:rel-id="F4">Fig. 2</xref></bold>). Returning results for user queries from the variant exploration view requires a ‘join’ operation among multiple tables, which is expensive and does not scale well. To address this, we use PostgreSQL’s Materialized View feature to compute and store a single denormalized table with all variant-sample evidence. Subsequent queries can then be performed directly against this table. Benchmarking on an AWS EC2 c3.large (2-core, 3.75gb RAM), a dataset with 100 samples and 2500 variants required 1 min 44 seconds to compute a materialized view and typical queries required less than 1 seconds. The Millstone database only recomputes the materialized view when underlying data has changed.</p></sec></sec></body><back><ref-list hwp:id="ref-list-1"><title hwp:id="title-20">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1 xref-ref-1-2"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.1" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Baym Michael"><surname>Baym</surname>, <given-names>Michael</given-names></string-name> <etal>et al.</etal> (<year>2015</year>). “<article-title hwp:id="article-title-2">Inexpensive Multiplexed Library Preparation for Megabase-Sized Genomes</article-title>”. In: <source hwp:id="source-1">bioRxiv</source>, p. <fpage>013771</fpage>.</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1 xref-ref-2-2"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="Cingolani Pablo"><surname>Cingolani</surname>, <given-names>Pablo</given-names></string-name> <etal>et al.</etal> (<year>2012</year>). “<article-title hwp:id="article-title-3">A program for annotating and predicting the effects of single nucleotide polymorphisms, SnpEff: SNPs in the genome of Drosophila melanogaster strain w1118; iso-2; iso-3</article-title>”. In: <source hwp:id="source-2">Fly</source> <volume>6</volume>.<issue>2</issue>, pp. <fpage>80</fpage>–<lpage>92</lpage>.</citation></ref><ref id="c3" hwp:id="ref-3" hwp:rev-id="xref-ref-3-1"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.3" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Deatherage"><surname>Deatherage</surname></string-name>, <string-name name-style="western" hwp:sortable="Daniel E"><surname>Daniel</surname> <given-names>E</given-names></string-name> and <string-name name-style="western" hwp:sortable="Barrick Jeffrey E"><given-names>Jeffrey E</given-names> <surname>Barrick</surname></string-name> (<year>2014</year>). “<article-title hwp:id="article-title-4">Identification of mutations in laboratory-evolved microbes from next-generation sequencing data using breseq</article-title>”. In: <source hwp:id="source-3">Engineering and Analyzing Multicellular Systems: Methods and Protocols</source>, pp. <fpage>165</fpage>–<lpage>188</lpage>.</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.4" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Dragosits Martin"><surname>Dragosits</surname>, <given-names>Martin</given-names></string-name> and <string-name name-style="western" hwp:sortable="Mattanovich Diethard"><given-names>Diethard</given-names> <surname>Mattanovich</surname></string-name> (<year>2013</year>). “<article-title hwp:id="article-title-5">Adaptive laboratory evolution – principles and applications for biotechnology</article-title>.” In: <source hwp:id="source-4">Microbial cell factories</source> <volume>12</volume>.<issue>1</issue>, p. <fpage>64</fpage>. doi: <pub-id pub-id-type="doi">10.1186/1475-2859-12-64</pub-id>.</citation></ref><ref id="c5" hwp:id="ref-5" hwp:rev-id="xref-ref-5-1"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.5" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Haimovich Adrian D"><surname>Haimovich</surname>, <given-names>Adrian D</given-names></string-name>, <string-name name-style="western" hwp:sortable="Muir Paul"><given-names>Paul</given-names> <surname>Muir</surname></string-name>, and <string-name name-style="western" hwp:sortable="Isaacs Farren J"><given-names>Farren J</given-names> <surname>Isaacs</surname></string-name> (<year>2015</year>). “<article-title hwp:id="article-title-6">Genomes by design</article-title>”. In: <source hwp:id="source-5">Nature Reviews Genetics</source> <volume>16</volume>.<issue>9</issue>, pp. <fpage>501</fpage>–<lpage>516</lpage>.</citation></ref><ref id="c6" hwp:id="ref-6" hwp:rev-id="xref-ref-6-1"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.6" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Hutchison Clyde A"><surname>Hutchison</surname>, <given-names>Clyde A</given-names></string-name>. <etal>et al.</etal> (<year>2016</year>). “<article-title hwp:id="article-title-7">Design and synthesis of a minimal bacterial genome</article-title>”. In: <source hwp:id="source-6">Science</source> <volume>351</volume>.<issue>6280</issue>. issn: <issn>0036-8075</issn>. doi: <pub-id pub-id-type="doi">10.1126/science.aad6253</pub-id>.</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1 xref-ref-7-2 xref-ref-7-3"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.7" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Isaacs Farren J"><surname>Isaacs</surname>, <given-names>Farren J</given-names></string-name> <etal>et al.</etal> (<year>2011</year>). “<article-title hwp:id="article-title-8">Precise manipulation of chromosomes in vivo enables genome-wide codon replacement</article-title>.” In: <source hwp:id="source-7">Science (New York, NY)</source> <volume>333</volume>.<issue>6040</issue>, pp. <fpage>348</fpage>–<lpage>353</lpage>.</citation></ref><ref id="c8" hwp:id="ref-8" hwp:rev-id="xref-ref-8-1"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Jiang Wenyan"><surname>Jiang</surname>, <given-names>Wenyan</given-names></string-name> <etal>et al.</etal> (<year>2013</year>). “<article-title hwp:id="article-title-9">RNA-guided editing of bacterial genomes using CRISPR-Cas systems</article-title>”. In: <source hwp:id="source-8">Nature Biotechnology</source> <volume>31</volume>.<issue>3</issue>, pp. <fpage>233</fpage>–<lpage>239</lpage>.</citation></ref><ref id="c9" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1 xref-ref-9-2 xref-ref-9-3"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.9" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Lajoie Marc J"><surname>Lajoie</surname>, <given-names>Marc J</given-names></string-name> <etal>et al.</etal> (<year>2013</year>). “<article-title hwp:id="article-title-10">Genomically recoded organisms expand biological functions</article-title>”. In: <source hwp:id="source-9">Science (New York, NY)</source> <volume>342</volume>.<issue>6156</issue>, pp. <fpage>357</fpage>–<lpage>360</lpage>.</citation></ref><ref id="c10" hwp:id="ref-10" hwp:rev-id="xref-ref-10-1 xref-ref-10-2 xref-ref-10-3"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="Li Heng"><surname>Li</surname>, <given-names>Heng</given-names></string-name> and <string-name name-style="western" hwp:sortable="Durbin Richard"><given-names>Richard</given-names> <surname>Durbin</surname></string-name> (<year>2010</year>). “<article-title hwp:id="article-title-11">Fast and accurate long-read alignment with Burrows–Wheeler transform</article-title>”. In: <source hwp:id="source-10">Bioinformatics</source> <volume>26</volume>.<issue>5</issue>, pp. <fpage>589</fpage>–<lpage>595</lpage>.</citation></ref><ref id="c11" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1 xref-ref-11-2 xref-ref-11-3 xref-ref-11-4"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.11" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="Mandell Daniel J"><surname>Mandell</surname>, <given-names>Daniel J</given-names></string-name> <etal>et al.</etal> (<year>2015</year>). “<article-title hwp:id="article-title-12">Biocontainment of genetically modified organisms by synthetic protein design</article-title>”. In: <source hwp:id="source-11">Nature</source> <volume>518</volume>.<issue>7537</issue>, pp. <fpage>55</fpage>–<lpage>60</lpage>.</citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.12" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Ostrov Nili"><surname>Ostrov</surname>, <given-names>Nili</given-names></string-name> <etal>et al.</etal> (<year>2016</year>). “<article-title hwp:id="article-title-13">Design, synthesis, and testing toward a 57-codon genome</article-title>”. In: <source hwp:id="source-12">Science</source> <volume>353</volume>.<issue>6301</issue>, pp. <fpage>819</fpage>–<lpage>822</lpage>. issn: <issn>0036-8075</issn>. doi: <pub-id pub-id-type="doi">10.1126/science.aaf3639</pub-id>.</citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.13" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="Shapland Elaine B"><surname>Shapland</surname>, <given-names>Elaine B</given-names></string-name> <etal>et al.</etal> (<year>2015</year>). “<article-title hwp:id="article-title-14">Low-Cost, High-Throughput Sequencing of DNA Assemblies Using a Highly Multiplexed Nextera Process</article-title>.” In: <source hwp:id="source-13">ACS Synthetic Biology</source> <volume>4</volume>.<issue>7</issue>, pp. <fpage>860</fpage>–<lpage>866</lpage>.</citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1 xref-ref-14-2"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.14" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Skinner Mitchell E"><surname>Skinner</surname>, <given-names>Mitchell E</given-names></string-name> <etal>et al.</etal> (<year>2009</year>). “<article-title hwp:id="article-title-15">JBrowse: a next-generation genome browser</article-title>.” In: <source hwp:id="source-14">Genome Research</source> <volume>19</volume>.<issue>9</issue>, pp. <fpage>1630</fpage>–<lpage>1638</lpage>. doi: <pub-id pub-id-type="doi">10.1101/gr.094607.109</pub-id>.</citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1 xref-ref-15-2 xref-ref-15-3 xref-ref-15-4"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.15" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Tenaillon O"><surname>Tenaillon</surname>, <given-names>O</given-names></string-name> <etal>et al.</etal> (<year>2012</year>). “<article-title hwp:id="article-title-16">The Molecular Diversity of Adaptive Convergence</article-title>”. In: <source hwp:id="source-15">Science (New York, NY)</source> <volume>335</volume>.<issue>6067</issue>, pp. <fpage>457</fpage>–<lpage>461</lpage>.</citation></ref><ref id="c16" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1 xref-ref-16-2 xref-ref-16-3 xref-ref-16-4 xref-ref-16-5"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.16" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Wang Harris H"><surname>Wang</surname>, <given-names>Harris H</given-names></string-name> <etal>et al.</etal> (<year>2009</year>). “<article-title hwp:id="article-title-17">Programming cells by multiplex genome engineering and accelerated evolution</article-title>”. In: <source hwp:id="source-16">Nature</source> <volume>460</volume>.<issue>7257</issue>, pp. <fpage>894</fpage>–<lpage>898</lpage>.</citation></ref><ref id="c17" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1 xref-ref-17-2"><citation publication-type="journal" citation-type="journal" ref:id="086868v2.17" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="Zerbino Daniel R"><surname>Zerbino</surname>, <given-names>Daniel R</given-names></string-name> and <string-name name-style="western" hwp:sortable="Birney Ewan"><given-names>Ewan</given-names> <surname>Birney</surname></string-name> (<year>2008</year>). “<article-title hwp:id="article-title-18">Velvet: algorithms for de novo short read assembly using de Bruijn graphs</article-title>”. In: <source hwp:id="source-17">Genome research</source> <volume>18</volume>.<issue>5</issue>, pp. <fpage>821</fpage>–<lpage>829</lpage>.</citation></ref></ref-list><ack hwp:id="ack-1"><title hwp:id="title-21">Acknowledgements</title><p hwp:id="p-35">We thanks members of the Church Lab for comments. Funding for this work was provided by U.S Department of Energy grant DE-FG02-02ER63445. G.K. and M.J.L. were supported by DOD NDSEG Fellowships. D.B.G. was supported by an NSF Graduate Research Fellowship. Computational resources for this work were provided by the AWS Cloud Credits for Research Program.</p></ack><sec hwp:id="sec-16"><title hwp:id="title-22">Author Contributions</title><p hwp:id="p-36">D.B.G., G.K., and M.J.L. conceived of and designed the software. G.K., D.B.G., B.W.A., K.Y.C., and C.C. wrote the software. D.B.G., G.K., M.J.L., and M.G.N. tested, debugged, designed individual features, and wrote documentation. D.B.G. and G.K. wrote the manuscript with input and edits from all authors. G.M.C. supervised the project.</p></sec><sec hwp:id="sec-17"><title hwp:id="title-23">Conflict of Interest</title><p hwp:id="p-37">G.M.C. is a founder of Enevolv Inc., Joule Unlimited and Gen9bio. Other potentially relevant financial interests are listed at <ext-link l:rel="related" l:ref-type="uri" l:ref="arep.med.harvard.edu/gmc/tech.html" ext-link-type="uri" xlink:href="arep.med.harvard.edu/gmc/tech.html" hwp:id="ext-link-10">arep.med.harvard.edu/gmc/tech.html</ext-link>.</p></sec><sec id="s5" sec-type="supplementary-material" hwp:id="sec-18" hwp:rev-id="xref-sec-18-1"><title hwp:id="title-24">Supplementary Note 1: Cost of Multiplexed Genome Library Preparation and Sequencing</title><fig id="figs1" position="float" orientation="portrait" fig-type="figure" hwp:id="F3" hwp:rev-id="xref-fig-3-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;086868v2/FIGS1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F3</object-id><object-id pub-id-type="publisher-id">figs1</object-id><label>Figure S1:</label><caption hwp:id="caption-3"><title hwp:id="title-25">Millstone Analysis Pipeline.</title><p hwp:id="p-38">The analysis pipeline efficiently automates the process of identifying single nucleotide variants (SNVs) and structural variants (SVs) from user sample data and storing the information in a data model representation that can be explored using Millstone’s variant exploration UI. Once sample FASTQs and a reference genome are uploaded, Millstone uses BWA (<xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-3" hwp:rel-id="ref-10">Li and Durbin 2010</xref>) to align samples to the reference, parallelizing alignments across available processor cores. Once all alignments are complete, Freebayes performs SNV-detection on all .bam files simultaneously, parallelizing across regions of the genome. SVs are identified in parallel in individual samples using two methods: 1) Deletions are detected using sequencing read coverage and 2) novel junctions that indicate insertions and rearrangements are identified using <italic toggle="yes">de novo</italic> assembly of unmapped reads using Velvet (<xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-2" hwp:rel-id="ref-17">Zerbino and Birney 2008</xref>) followed by a custom graph-walking algorithm to combine assembled contigs and alignment with BWA to place contigs in the genome. All variant callers report their data in the Variant Call Format (VCF) and Millstone parses the VCFs into a single data model representation. Millstone further uses read coverage to identify regions of the genome with poor mapping quality and automatically adds variants that fall into such regions to appropriate VariantSets.</p></caption><graphic xlink:href="086868_figs1" position="float" orientation="portrait" hwp:id="graphic-3"/></fig><fig id="figs2" position="float" orientation="portrait" fig-type="figure" hwp:id="F4" hwp:rev-id="xref-fig-4-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;086868v2/FIGS2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F4</object-id><object-id pub-id-type="publisher-id">figs2</object-id><label>Figure S2:</label><caption hwp:id="caption-4"><title hwp:id="title-26">Millstone Data Model.</title><p hwp:id="p-39">Millstone’s data model was designed to enable project organization, data storage, and to support researcher operations including uploading data, running analysis pipelines, exploring the resulting data, and generating actionable outputs. Users upload <italic toggle="yes">ReferenceGenomes</italic> (e.g. Genbank or FASTA genome sequences) and <italic toggle="yes">ExperimentSamples</italic> (e.g. FASTQ) to a Project. The <italic toggle="yes">AlignmentGroup</italic> model stores data from an alignment of multiple <italic toggle="yes">ExperimentSamples</italic> against a specific <italic toggle="yes">ReferenceGenome</italic>. <italic toggle="yes">Variants</italic> represent both user-specified designed mutations and those emprically identified by variant callers. <italic toggle="yes">Variants</italic> are the most important primitive in Millstone, and serve as the unit of operation for analysis and design tasks. <italic toggle="yes">Variants</italic> are defined relative to a specific <italic toggle="yes">ReferenceGenome</italic>. The <italic toggle="yes">VariantCallerCommonData</italic> model relates a given Variant to any <italic toggle="yes">AlignmentGroups</italic> the mutation was called in and stores metadata provided by the variant calling tool (e.g. Freebayes). The <italic toggle="yes">VariantEvidence</italic> model further stores evidence for the occurrence of a specific Variant in a specific ExperimentSample. <italic toggle="yes">VariantSets</italic> allow the user to group Variants and take actions on groups. The VariantSet concept is very similar to tags in other software contexts and a Variant can belong to more than one VariantSet. Operations enabled by VariantSets include filtering in the exploration view, exporting subsets of variants, printing MAGE oligos, and generating new versions of reference genomes. The full data model is declared in the source code: <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/churchlab/millstone/blob/master/genome_designer/main/models.py" ext-link-type="uri" xlink:href="https://github.com/churchlab/millstone/blob/master/genome_designer/main/models.py" hwp:id="ext-link-11">https://github.com/churchlab/millstone/blob/master/genome_designer/main/models.py</ext-link>.</p></caption><graphic xlink:href="086868_figs2" position="float" orientation="portrait" hwp:id="graphic-4"/></fig><fig id="figs3" position="float" orientation="portrait" fig-type="figure" hwp:id="F5" hwp:rev-id="xref-fig-5-1 xref-fig-5-2 xref-fig-5-3 xref-fig-5-4"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;086868v2/FIGS3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F5</object-id><object-id pub-id-type="publisher-id">figs3</object-id><label>Figure S3:</label><caption hwp:id="caption-5"><title hwp:id="title-27">Millstone uses <italic toggle="yes">de novo</italic> assembly to identify a mobile element insertion at the <italic toggle="yes">lon</italic> locus across 5 escapee clones from Mandell <italic toggle="yes">et al</italic>.</title><p hwp:id="p-40"><bold>(a)</bold> Millstone’s integration with JBrowse shows evidence for a disruption upstream of the <italic toggle="yes">lon</italic> gene for 5 escapee strains. Each colored line represents a single read and the read alignments are grouped by sample. A wild-type strain is shown at the bottom for comparison. Darker reads map to the forward strand and lighter reads map to the reverse strand. Properly paired reads are green, reads with an unmapped mate are blue, and reads with improperly paired mates are orange. The dark blue vertical lines denote split reads, indicating a disrupted read alignment. <bold>(b)</bold> Millstone performs <italic toggle="yes">de novo</italic> assembly followed by alignment of assembled contigs back to the reference, and then uses a graph traversal algorithm to identify large insertions. Two example cases are shown where either one or two contigs are identified. These contigs are composed of reads that map to the <italic toggle="yes">lon</italic> locus and IS186 mobile element, indicating insertion of IS186 element at the <italic toggle="yes">lon</italic> locus. Finally, Millstone generates an updated reference genome reflecting the insertion. <bold>(c)</bold> A table of contigs, their sizes, and multiple reference alignments for each of the 5 samples with an IS186 insertion. <bold>(d)</bold> A new JBrowse view with the updated reference. The split and mismapping reads are gone, revealing a clean alignment in the region with the inserted IS element. The dark region indicates reads which map to multiple IS186 paralogs across the genome.</p></caption><graphic xlink:href="086868_figs3" position="float" orientation="portrait" hwp:id="graphic-5"/></fig><table-wrap id="tbls1" orientation="portrait" position="float" hwp:id="T1" hwp:rev-id="xref-table-wrap-1-1 xref-table-wrap-1-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;086868v2/TBLS1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T1</object-id><object-id pub-id-type="publisher-id">tbls1</object-id><label>Table S1:</label><caption hwp:id="caption-6"><p hwp:id="p-41"><bold>Comparison between Millstone and Other Tools</bold>. A tabular comparison of features among different whole-genome sequencing tools, with a focus on those that are meant for use with haploid microbial genomes and are scalable to large datasets. All tools listed here are free and open-source. A more detailed description of the differences between the features and limitations of each is provided in <bold><xref ref-type="sec" rid="s6" hwp:id="xref-sec-21-2" hwp:rel-id="sec-21">Supplementary Note 2</xref></bold>. <italic toggle="yes">Effect Prediction</italic>: Prediction of variant effects based on genome annotation. <italic toggle="yes">Variant visualization</italic>: can visualize read alignments for individual variants built into the tool. <italic toggle="yes">Multiple Sample Comparison</italic>: can compare the evidence for and presence/absence of a variant across multiple samples within the tool. <italic toggle="yes">Interactive Querying</italic>: can interactively search and subset variant list based on genomic position, gene, quality, mutation type, etc. within the tool. <italic toggle="yes">Structural Variant Detection</italic>: Supports detection of longer variants not normally detected by SNV callers like Freebayes and GATK Unified Genotyper, such as insertions, deletions, and translocations longer than 50-100 bp in length. <italic toggle="yes">Genome Versioning</italic>: Capable of generating an updated reference genome based on a subset of variants found in an initial reference genome. <italic toggle="yes">Easy Deployment/Install</italic>: Can be used without command-line compilation or scripting. <italic toggle="yes">Genome Editing</italic>: Generates designs for iterative editing/reversion of selected variants. <italic toggle="yes">Sharing/Collaboration</italic>: Built-in data-sharing via the web among teams of multiple users. <italic toggle="yes">Supports Paired-End Data</italic>: Utilizes paired-end read information to generate alignments and identify structural variants. <italic toggle="yes">Modular Pipeline</italic>: Capable of custom pipelines using different user-specified modules.</p></caption><graphic xlink:href="086868_tbls1" position="float" orientation="portrait" hwp:id="graphic-6"/></table-wrap><table-wrap id="tbls2" orientation="portrait" position="float" hwp:id="T2" hwp:rev-id="xref-table-wrap-2-1 xref-table-wrap-2-2 xref-table-wrap-2-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;086868v2/TBLS2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T2</object-id><object-id pub-id-type="publisher-id">tbls2</object-id><label>Table S2:</label><caption hwp:id="caption-7"><p hwp:id="p-42"><bold>Variant differences between Millstone and the original analysis performed by Tenaillon et al</bold>. We compared variants found by <italic toggle="yes">Tenaillon et al</italic>. to those found automatically Millstone, focusing on Type II errors. Here we split discrepancies into 5 classes, including 3 short nucleotide variant (SNV) classes - short Deletions, Insertions, and Point Mutations, and 2 structural variant classes - Large Deletions and Mobile Element insertions. The final two columns describe ‘True Positive’ variants which were found by only one of the two pipelines. To identify these, we examined the read evidence using Millstone’s JBrowse visualization feature and determined whether the variant was correct as called by either pipeline.</p></caption><graphic xlink:href="086868_tbls2" position="float" orientation="portrait" hwp:id="graphic-7"/></table-wrap><table-wrap id="tbls3" orientation="portrait" position="float" hwp:id="T3" hwp:rev-id="xref-table-wrap-3-1 xref-table-wrap-3-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;086868v2/TBLS3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T3</object-id><object-id pub-id-type="publisher-id">tbls3</object-id><label>Table S3:</label><caption hwp:id="caption-8"><p hwp:id="p-43"><bold>Benchmarking</bold>. Millstone’s analysis pipeline was executed on datasets of various size from four different projects: Biocontainment (<xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-4" hwp:rel-id="ref-11">Mandell et al. 2015</xref>), GRO (<xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-3" hwp:rel-id="ref-9">Lajoie et al. 2013</xref>), Improving GRO Fitness (<italic toggle="yes">Kuznetsov et al., submitted</italic>), and Tenaillon (<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-4" hwp:rel-id="ref-15">Tenaillon et al. 2012</xref>). Average query time was calculated using no filter and a simple filter for strong alt calls: <monospace>GT TYPE = 2</monospace>. All benchmarking was performed on Amazon Web Services (AWS) Elastic Cloud Compute (EC2) instances r3.8xlarge (32 cores, 244 Gb memory).</p></caption><graphic xlink:href="086868_tbls3" position="float" orientation="portrait" hwp:id="graphic-8"/></table-wrap><sec id="s5a" hwp:id="sec-19"><title hwp:id="title-28">Sample Preparation</title><p hwp:id="p-44">Low-cost high-throughput sample preparation workflows for Illumina sequencing based on transposon insertion and fluorescent dye-based sample quantification can reduce the cost of preparation to below $15 USD per sample and be performed in approximately 5 hours per 96-well plate (<xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-2" hwp:rel-id="ref-1">Baym et al. 2015</xref>).</p></sec><sec id="s5b" hwp:id="sec-20"><title hwp:id="title-29">Multiplexed Illumina Sequencing</title><p hwp:id="p-45">For accurate discovery of structural variants, 20-30x coverage is ideal per sample. For the 4.6 megabase <italic toggle="yes">Escherichia coli K12 MG1655</italic> genome at 30x coverage, this is approximately 1 million 150 bp reads. The cost per read for Illumina sequencing can vary widely depending on the platform (NexSeq, MiSeq, HiSeq, etc). As a conservative estimate, a whole HiSeq 2500 lane in Rapid Run mode can produce 250 million paired end reads of 150 base pairs for a cost of approximately $2500 USD, or approximately $10 dollars per bacterial genome. Paired-end 150bp sequencing in Rapid Run mode takes approximately 40 hours. Larger-scale sequencing formats are generally cheaper, but longer to run, and smaller formats, like the MiSeq, are faster, but more expensive per genome.</p></sec></sec><sec id="s6" sec-type="supplementary-material" hwp:id="sec-21" hwp:rev-id="xref-sec-21-1 xref-sec-21-2"><title hwp:id="title-30">Supplementary Note 2: Comparison of Millstone to Other Tools</title><p hwp:id="p-46">While other packages exist to solve the integration and automation of whole genome resequencing and annotation, most of these tools are built for large diploid genomes, such as <italic toggle="yes">Homo sapiens</italic>. Here we compare features and performance between Millstone and a few other related automated genome re-sequencing tools (see also <bold>Supplementary <xref rid="tbls1" ref-type="table" hwp:id="xref-table-wrap-1-2" hwp:rel-id="T1">Table 1</xref></bold>).</p><sec id="s6a" hwp:id="sec-22"><title hwp:id="title-31">Galaxy</title><p hwp:id="p-47">Some tools, like Galaxy, allow users to create their own custom pipelines without bash scripting, and do support the creation of pipelines for microbial genomes. However, Galaxy requires that the user to understand and optimize settings for each individual tool. Galaxy also does not allow visualization or interactive querying of the output, and cannot generate new reference genomes or use the output of one round of sequencing to inform the next round. Finally, because of Galaxy’s one-size-fits-all nature, optimizing pipeline performance (for example, via inline compression and piping of input and output streams) is challenging.</p></sec><sec id="s6b" hwp:id="sec-23"><title hwp:id="title-32">SPANDx</title><p hwp:id="p-48">Another recent tool, SPANDx, can also perform genome resequencing for multiple strains simultaneously, but its widespread use is limited because it can only be run on UNIX computing clusters using the venerable and closed-source commercial PBS job scheduling system. SPANDx has no user interface or interactive components, and so users are required to gather the data manually and run the pipeline using a command line interface. Because we could not readily locate a PBS system to test the pipeline on, we were not able to compare the output between SPANDx and Millstone.</p></sec><sec id="s6c" hwp:id="sec-24"><title hwp:id="title-33">breseq</title><p hwp:id="p-49"><italic toggle="yes">breseq</italic> is purpose-built to perform haploid genome resequencing, and has become a standard tool for Adaptive Laboratory Evolution experiments. (<xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-1" hwp:rel-id="ref-3">Deatherage and Barrick 2014</xref>). <italic toggle="yes">breseq</italic> reports SNV and SV events for single genomes and provides a visualization of raw read evidence for the event. An advantage of Millstone is its ability to perform variant calling on hundreds of genomes in parallel, facilitating analysis of mutation frequency across a population of clones. Millstone’s JBrowse integration, data model, and querying features allow researchers to interactively filter, view, and compare genome alignments and variant data (as in <bold>Supplementary <xref rid="figs3" ref-type="fig" hwp:id="xref-fig-5-4" hwp:rel-id="F5">Fig. 3</xref></bold>).</p><p hwp:id="p-50">Both <italic toggle="yes">breseq</italic> and Millstone use a default variant detection threshold that works well in most cases, and Millstone complements this with an interactive search feature that allows researchers to filter variants after the variant calling pipeline has been run according to characteristics including read depth, number of samples with the variant, or predicted variant effect.</p><p hwp:id="p-51">Millstone further supports paired-end reads, allowing for enhanced detection of structural variation, whereas <italic toggle="yes">breseq</italic> treats paired-end reads as single reads. Millstone can further assemble and place <italic toggle="yes">de novo</italic> contigs onto existing reference genomes. Millstone can be used pre-configured on Amazon Web Services (AWS) and so does not require proficiency with UNIX nor the manual installation of dependencies. Mill-stone’s user interface also automates the process of copying potentially large amounts of whole-genome data to the remote server.</p></sec></sec></back></article>
