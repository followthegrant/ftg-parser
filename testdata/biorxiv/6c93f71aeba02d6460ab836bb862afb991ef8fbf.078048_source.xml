<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/078048</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;078048v3</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;078048</article-id><article-id pub-id-type="other" hwp:sub-type="slug">078048</article-id><article-id pub-id-type="other" hwp:sub-type="tag">078048</article-id><article-version>1.3</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Bioinformatics" hwp:journal="biorxiv"><subject>Bioinformatics</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">pyMAP: a Python package for small and large scale analysis of Illumina 450k methylation platform</article-title></title-group><author-notes hwp:id="author-notes-1"><fn id="n1" hwp:id="fn-1" hwp:rev-id="xref-fn-1-1"><label>*</label><p hwp:id="p-1"><email hwp:id="email-1">amin.mahpour@roswellpark.org</email></p></fn></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-5885-1340</contrib-id><name name-style="western" hwp:sortable="Mahpour Amin"><surname>Mahpour</surname><given-names>Amin</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">1</xref><xref ref-type="author-notes" rid="n1" hwp:id="xref-fn-1-1" hwp:rel-id="fn-1">*</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0001-5885-1340"/></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1"><label>1</label><institution hwp:id="institution-1">Cancer Genetics Department, Roswell Park Cancer Institute</institution>, Buffalo NY 14263, <country>USA</country></aff></contrib-group><pub-date pub-type="epub-original" hwp:start="2017"><year>2017</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2016-09-28T18:33:30-07:00">
    <day>28</day><month>9</month><year>2016</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2017-06-06T12:53:47-07:00">
    <day>6</day><month>6</month><year>2017</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2016-09-28T18:50:24-07:00">
    <day>28</day><month>9</month><year>2016</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2017-06-06T13:01:04-07:00">
    <day>6</day><month>6</month><year>2017</year>
  </pub-date><elocation-id>078048</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2016-09-27"><day>27</day><month>9</month><year>2016</year></date>
<date date-type="rev-recd" hwp:start="2017-06-06"><day>06</day><month>6</month><year>2017</year></date>
<date date-type="accepted" hwp:start="2017-06-06"><day>06</day><month>6</month><year>2017</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2017</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nd/4.0/" hwp:id="license-1"><p hwp:id="p-2">This pre-print is available under a Creative Commons License (Attribution-NoDerivs 4.0 International), CC BY-ND 4.0, as described at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://creativecommons.org/licenses/by-nd/4.0/" ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nd/4.0/" hwp:id="ext-link-1">http://creativecommons.org/licenses/by-nd/4.0/</ext-link></p></license></permissions><self-uri xlink:href="078048.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2019/pdf/078048v3.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="078048.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2019/abstracts/078048v3/078048v3.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2019/fulltext/078048v3/078048v3.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><p hwp:id="p-3">PyMAP is a native python module for analysis of 450k methylation platform and is freely available for public use. The package can be easily deployed to cloud platforms that support python scripting language for large-scale methylation studies. By implementing fast parsing functionality, this module can be used to analyze large scale methylation datasets. Additionally, command-line executables shipped with the module can be used to perform common analysis tasks on personal computers.</p><p hwp:id="p-4">Availability and implementation: PyMAP is implemented in Python and the source code is available under GPL v2 license from <ext-link l:rel="related" l:ref-type="uri" l:ref="http://aminmahpour.github.io/PyMAP/" ext-link-type="uri" xlink:href="http://aminmahpour.github.io/PyMAP/" hwp:id="ext-link-2">http://aminmahpour.github.io/PyMAP/</ext-link>.</p></abstract><counts><page-count count="3"/></counts><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-1">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta></front><body><sec id="s1" hwp:id="sec-1"><title hwp:id="title-2">Introduction</title><p hwp:id="p-5">Illumina Infinium 450k BeadChip platform has been critical for methylation analysis of human cells. Indeed, this platform has been largely used in The Cancer Genome Atlas (TCGA) to assess the methylation status of many different type of tumors [<xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">1</xref>]. Since methylation study of genomes in normal and neoplastic conditions are usually performed in large scale clinical studies, a powerful yet simple tool is needed to organize, parse and analyze the resulting methylation datasets. This tool should also implemented to be extensible. Here, we describe Python package for Methylation Analysis of Probes(PyMAP) to analyze data generated from the 450k platform. This package will significantly reduce the hassle associated with parsing and analyzing the methylation profile of large scale projects. Importantly, as a free and open-sourced project, this package could be further modified to fulfill the need of special research and clinical projects.</p></sec><sec id="s2" hwp:id="sec-2"><title hwp:id="title-3">Implementation</title><p hwp:id="p-6">PyMAP is implemented in pure and fast python code and does not require any prerequisite package to parse and analyze methylation data. In contrast, existing R packages are dependent on other packages and therefore are very difficult to deploy on personal and lab workstations [<xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">2</xref>]. This package fully supports Python 3.4 and the latest version 3.5 and is also backward compatible with legacy python version of 2.7.</p><p hwp:id="p-7">Multi-tasking of certain processes is also supported to reduce the processing time associated with large studies. Therefore, we think efficient use of processing power and memory usage contributes to better user experience and reasonable requirements for computational resources.</p><p hwp:id="p-8">PyMAP contains two essential sub-modules of Core and Annotations along with others for a typical analysis pipeline. Core module implements parse functions that can efficiently process single, or in batch form, multiple methylation data files that are exported from Illumina GenomeStudio Methylation software. Our performance testing showed that the package can parse 60 data samples in less than 20 seconds with extremely low memory footprint on a Unix workstation. In addition, Annotation module fully supports Illumina probes and associated information. We have also added the ability to filter probes that are associated with Single Nucleotide Polymorphisms. Additionally, this module allows customized filtering of probes for regions of interests in genome. In other words, probes that are associated with a certain location, gene, feature or CpG site in the genome can be retrieved easily and in combination with core module, methylation data can be analyzed.</p><p hwp:id="p-9">The advantage of implementing this package in pure python is manifold. Python allows broad scalability and fast deployment to workstation and cloud services [<xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-1" hwp:rel-id="ref-3">3</xref>]. Indeed, well known cloud processing services such as Galaxy bioinformatics platform and Amazon Web Services already support python and therefore setting up large scale analysis is far more convenient in these powerful platforms. Additionally, the code base also allows efficient consumption of the module in other modules and standalone python applications.</p></sec><sec id="s3" hwp:id="sec-3"><title hwp:id="title-4">Features</title><p hwp:id="p-10">Streamlined extraction of probes that are associated with a genomic feature and associated methylation beta values are extremely important and we implemented this functionality in a way that is intuitive. The extracted probes can be used to fetch the methylation values of samples and generate methylation profile associated with a certain genomic feature. Fast parsing of methylation data through Core module stores all methylation information necessary for analysis of large methylation dataset. For preprocessing, PyMAP can remove SNP associated probes which is a common process for differential methylation analysis in human samples [<xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">4</xref>]. PyMAP also supports differential methylation analysis of probes using Student t-test statistics method. However, due to the modular pipeline, other methods for differential analysis can also implemented to the current pipeline.</p><p hwp:id="p-11">In addition, PyMAP supports extraction of the methylation data into formatted BED files that can be visualized in UCSC genome browser or any other genome browser that support genomics BED files as specified on UCSC genome browser website. Additionally, by implementing convenient functions, large scale generation of BED files for multiple sample is also feasible. In addition, these exported BED files can be used with Circos program for genome-wide visualization of the methylation data. Also, we have created fully documented and easy to use executable command-line scripts to perform common analysis and designed specifically for use of researchers who are not familiar with the python script.</p><p hwp:id="p-12">We also have added a plotting module to plot the methylation values of desired probes from selected samples. This is particularly useful if the user would like to visually inspect the methylation values of a filtered probe list associated with a feature or genomic region.</p></sec><sec id="s4" hwp:id="sec-4"><title hwp:id="title-5">Documentation</title><p hwp:id="p-13">PyMAP is developed with added emphasis on public availability and contains an easy to follow documentation. The code is also highly documented to encourage customization by end users. The project full documentation is available at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://pymap.readthedocs.org" ext-link-type="uri" xlink:href="http://pymap.readthedocs.org" hwp:id="ext-link-3">http://pymap.readthedocs.org</ext-link>.</p></sec><sec id="s5" hwp:id="sec-5"><title hwp:id="title-6">Future directions</title><p hwp:id="p-14">PyMAP, as a script module, provides a complete pipeline for analysis of a large scale methylation dataset. However, we have intentions to develop an interactive Graphical User Interface(GUI) in near future that consumes full PyMAP functionality in a graphically rich environment. The standalone application would further simplify the analysis and visualization of the methylation data for scientists.</p></sec></body><back><ref-list hwp:id="ref-list-1"><title hwp:id="title-7">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1"><label>1.</label><citation publication-type="journal" citation-type="journal" ref:id="078048v3.1" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-1"><collab hwp:id="collab-1">Network Cancer Genome Atlas Research</collab>, <string-name name-style="western" hwp:sortable="Weinstein J. N."><given-names>J. N.</given-names> <surname>Weinstein</surname></string-name>, <string-name name-style="western" hwp:sortable="Collisson E. A."><given-names>E. A.</given-names> <surname>Collisson</surname></string-name>, <string-name name-style="western" hwp:sortable="Mills G. B."><given-names>G. B.</given-names> <surname>Mills</surname></string-name>, <string-name name-style="western" hwp:sortable="Shaw K. R."><given-names>K. R.</given-names> <surname>Shaw</surname></string-name>, <string-name name-style="western" hwp:sortable="Ozenberger B. A."><given-names>B. A.</given-names> <surname>Ozenberger</surname></string-name>, <string-name name-style="western" hwp:sortable="Ellrott K."><given-names>K.</given-names> <surname>Ellrott</surname></string-name>, <string-name name-style="western" hwp:sortable="Shmulevich I."><given-names>I.</given-names> <surname>Shmulevich</surname></string-name>, <string-name name-style="western" hwp:sortable="Sander C."><given-names>C.</given-names> <surname>Sander</surname></string-name>, and <string-name name-style="western" hwp:sortable="Stuart J. M."><given-names>J. M.</given-names> <surname>Stuart</surname></string-name>. <article-title hwp:id="article-title-2">The cancer genome atlas pan-cancer analysis project</article-title>. <source hwp:id="source-1">Nat Genet</source>, <volume>45</volume>(<issue>10</issue>):<fpage>1113</fpage>–<lpage>20</lpage>, <year>2013</year>.</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1"><label>2.</label><citation publication-type="journal" citation-type="journal" ref:id="078048v3.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="Morris T. J."><given-names>T. J.</given-names> <surname>Morris</surname></string-name> and <string-name name-style="western" hwp:sortable="Beck S."><given-names>S.</given-names> <surname>Beck</surname></string-name>. <article-title hwp:id="article-title-3">Analysis pipelines and packages for infinium humanmethylation450 beadchip (450k) data</article-title>. <source hwp:id="source-2">Methods</source>, <volume>72</volume>:<fpage>3</fpage>–<lpage>8</lpage>, <year>2015</year>.</citation></ref><ref id="c3" hwp:id="ref-3" hwp:rev-id="xref-ref-3-1"><label>3.</label><citation publication-type="journal" citation-type="journal" ref:id="078048v3.3" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Cock P. J."><given-names>P. J.</given-names> <surname>Cock</surname></string-name>, <string-name name-style="western" hwp:sortable="Antao T."><given-names>T.</given-names> <surname>Antao</surname></string-name>, <string-name name-style="western" hwp:sortable="Chang J. T."><given-names>J. T.</given-names> <surname>Chang</surname></string-name>, <string-name name-style="western" hwp:sortable="Chapman B. A."><given-names>B. A.</given-names> <surname>Chapman</surname></string-name>, <string-name name-style="western" hwp:sortable="Cox C. J."><given-names>C. J.</given-names> <surname>Cox</surname></string-name>, <string-name name-style="western" hwp:sortable="Dalke A."><given-names>A.</given-names> <surname>Dalke</surname></string-name>, <string-name name-style="western" hwp:sortable="Friedberg I."><given-names>I.</given-names> <surname>Friedberg</surname></string-name>, <string-name name-style="western" hwp:sortable="Hamelryck T."><given-names>T.</given-names> <surname>Hamelryck</surname></string-name>, <string-name name-style="western" hwp:sortable="Kauff F."><given-names>F.</given-names> <surname>Kauff</surname></string-name>, <string-name name-style="western" hwp:sortable="Wilczynski B."><given-names>B.</given-names> <surname>Wilczynski</surname></string-name>, and <string-name name-style="western" hwp:sortable="de Hoon M. J."><given-names>M. J.</given-names> <surname>de Hoon</surname></string-name>. <article-title hwp:id="article-title-4">Biopython: freely available python tools for computational molecular biology and bioinformatics</article-title>. <source hwp:id="source-3">Bioinformatics</source>, <volume>25</volume>(<issue>11</issue>):<fpage>1422</fpage>–<lpage>3</lpage>, <year>2009</year>.</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1"><label>4.</label><citation publication-type="journal" citation-type="journal" ref:id="078048v3.4" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Wang D."><given-names>D.</given-names> <surname>Wang</surname></string-name>, <string-name name-style="western" hwp:sortable="Yan L."><given-names>L.</given-names> <surname>Yan</surname></string-name>, <string-name name-style="western" hwp:sortable="Hu Q."><given-names>Q.</given-names> <surname>Hu</surname></string-name>, <string-name name-style="western" hwp:sortable="Sucheston L. E."><given-names>L. E.</given-names> <surname>Sucheston</surname></string-name>, <string-name name-style="western" hwp:sortable="Higgins M. J."><given-names>M. J.</given-names> <surname>Higgins</surname></string-name>, <string-name name-style="western" hwp:sortable="Ambrosone C. B."><given-names>C. B.</given-names> <surname>Ambrosone</surname></string-name>, <string-name name-style="western" hwp:sortable="Johnson C. S."><given-names>C. S.</given-names> <surname>Johnson</surname></string-name>, <string-name name-style="western" hwp:sortable="Smiraglia D. J."><given-names>D. J.</given-names> <surname>Smiraglia</surname></string-name>, and <string-name name-style="western" hwp:sortable="Liu S."><given-names>S.</given-names> <surname>Liu</surname></string-name>. <article-title hwp:id="article-title-5">Ima: an r package for high-throughput analysis of illumina's 450k infinium methylation data</article-title>. <source hwp:id="source-4">Bioinformatics</source>, <volume>28</volume>(<issue>5</issue>):<fpage>729</fpage>–<lpage>30</lpage>, <year>2012</year>.</citation></ref></ref-list></back></article>
