<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/022046</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;022046v1</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;022046</article-id><article-id pub-id-type="other" hwp:sub-type="slug">022046</article-id><article-id pub-id-type="other" hwp:sub-type="tag">022046</article-id><article-version>1.1</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Neuroscience" hwp:journal="biorxiv"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">A New method to detect Event-Related Potentials based on Pearson’s Correlation</article-title></title-group><author-notes hwp:id="author-notes-1"><corresp id="cor1" hwp:id="corresp-1">Corresponding author: Patrizio Tressoldi, Dipartimento di Psicologia Generale-Università di Padova, Via Venezia 8, 35131 PADOVA-ITALY, Tel+390498276500 Fax+390498276600 Email: <email hwp:id="email-1">patrizio.tressoldi@unipd.it</email></corresp></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><name name-style="western" hwp:sortable="Giroldini William"><surname>Giroldini</surname><given-names>William</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">*</xref></contrib><contrib contrib-type="author" hwp:id="contrib-2"><name name-style="western" hwp:sortable="Pederzoli Luciano"><surname>Pederzoli</surname><given-names>Luciano</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">*</xref></contrib><contrib contrib-type="author" hwp:id="contrib-3"><name name-style="western" hwp:sortable="Bilucaglia Marco"><surname>Bilucaglia</surname><given-names>Marco</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-3" hwp:rel-id="aff-1">*</xref></contrib><contrib contrib-type="author" hwp:id="contrib-4"><name name-style="western" hwp:sortable="Melloni Simone"><surname>Melloni</surname><given-names>Simone</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-4" hwp:rel-id="aff-1">*</xref></contrib><contrib contrib-type="author" corresp="yes" hwp:id="contrib-5"><name name-style="western" hwp:sortable="Tressoldi Patrizio"><surname>Tressoldi</surname><given-names>Patrizio</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-1" hwp:rel-id="aff-2">○</xref></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2 xref-aff-1-3 xref-aff-1-4"><label>*</label><institution hwp:id="institution-1">EvanLab, Via dei Ricci</institution>, 22 - 50023 Impruneta, 50023 Firenze, <country>Italy</country></aff><aff id="a2" hwp:id="aff-2" hwp:rev-id="xref-aff-2-1"><label>○</label><institution hwp:id="institution-2">Dipartimento di Psicologia Generale, Università di Padova</institution>, via Venezia, 8, 35131 Padova, <country>Italy</country></aff></contrib-group><pub-date pub-type="epub-original" hwp:start="2015"><year>2015</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2015-07-06T09:03:12-07:00">
    <day>6</day><month>7</month><year>2015</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2015-07-06T09:03:12-07:00">
    <day>6</day><month>7</month><year>2015</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2015-07-06T09:25:45-07:00">
    <day>6</day><month>7</month><year>2015</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2015-07-06T09:25:45-07:00">
    <day>6</day><month>7</month><year>2015</year>
  </pub-date><elocation-id>022046</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2015-07-06"><day>06</day><month>7</month><year>2015</year></date>
<date date-type="accepted" hwp:start="2015-07-06"><day>06</day><month>7</month><year>2015</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2015, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2015</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/" hwp:id="license-1"><p hwp:id="p-1">This pre-print is available under a Creative Commons License (Attribution-NonCommercial-NoDerivs 4.0 International), CC BY-NC-ND 4.0, as described at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://creativecommons.org/licenses/by-nc-nd/4.0/" ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/" hwp:id="ext-link-1">http://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link></p></license></permissions><self-uri xlink:href="022046.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2019/pdf/022046v1.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="022046.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2019/abstracts/022046v1/022046v1.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2019/fulltext/022046v1/022046v1.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><sec hwp:id="sec-1"><title hwp:id="title-2">Background</title><p hwp:id="p-2">Event-Related Potentials (ERPs) are widely used in Brain Computer Interfaces applications and in neurology and psychology for the study of cognitive process, mental disorders, attention deficit, schizophrenia, autism, etc. Because the spontaneous noisy EEG activity is uncorrelated with the ERP waveform, the noise will decrease in the order of 1/√(N) (inverse of square root of N), where N is the number of averaged epochs. Since the background EEG activity has a higher amplitude than ERPs waveform, the averaging technique highlights ERPs and attenuates the noise. This is the easiest strategy currently used to detect ERPs.</p></sec><sec hwp:id="sec-2"><title hwp:id="title-3">New Method</title><p hwp:id="p-3">In this paper, a new method is proposed, called GW6, in order to calculate the ERP using a mathematical routine based only on Pearson’s Correlation.</p></sec><sec hwp:id="sec-3"><title hwp:id="title-4">Results</title><p hwp:id="p-4">The result is a graphic with the same time-resolution of the classic ERP that shows positive peaks representing the increase of correlation of the EEG signal in correspondence to the stimuli.</p></sec><sec hwp:id="sec-4"><title hwp:id="title-5">Comparison with Existing Methods</title><p hwp:id="p-5">the GW6 method allows highlighting other components of ERP response, usually hidden in the standard and simple method based on the averaging of all the phase and time-locked epochs. For this reason, this new method could be very helpful to investigate these hidden components of the ERP response and to develop applications for medical purposes.</p></sec><sec hwp:id="sec-5"><title hwp:id="title-6">Conclusions</title><p hwp:id="p-6">The method we are proposing can be directly used in the form of software written in Visual Basic and easily and quickly implemented in any other programming language.</p></sec><sec hwp:id="sec-6"><title hwp:id="title-7">Highlights</title><list list-type="bullet" hwp:id="list-1"><list-item hwp:id="list-item-1"><p hwp:id="p-7">a new method is proposed, called GW6, in order to calculate the ERP (Event-Related Potential) using a mathematical routine based only on Pearson’s Correlation</p></list-item><list-item hwp:id="list-item-2"><p hwp:id="p-8">The result is a graphic with the same time-resolution of the classic ERP that shows positive peaks representing the increase of correlation of the EEG signal in correspondence to the stimuli</p></list-item><list-item hwp:id="list-item-3"><p hwp:id="p-9">The method we are proposing can be directly used in the form of software written in Visual Basic and easily and quickly implemented in any other programming language.</p></list-item></list></sec></abstract><kwd-group kwd-group-type="author" hwp:id="kwd-group-1"><title hwp:id="title-8">Keywords</title><kwd hwp:id="kwd-1">Event-Related Potentials</kwd><kwd hwp:id="kwd-2">Brain-Computer-Interfaces</kwd><kwd hwp:id="kwd-3">Pearson’s correlation</kwd></kwd-group><counts><page-count count="23"/></counts><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-1">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta></front><body><sec id="s1" hwp:id="sec-7"><title hwp:id="title-9">Introduction</title><p hwp:id="p-10">The Event-Related Potential (ERP) is an electroencephalographic (EEG) signal recorded from multiple brain areas, in response to a single short stimulus such as visual, auditory, or muscle movement (<xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-1" hwp:rel-id="ref-8">Linden, 2005</xref>; <xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">Sanei and Chambers, 2013</xref>; <xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">Aydin, 2008</xref>).</p><p hwp:id="p-11">ERPs are widely used in Brain Computer Interfaces (BCIs) applications and in neurology and psychology for the study of cognitive process, mental disorders, attention deficit, schizophrenia, autism, etc.</p><p hwp:id="p-12">ERPs are weak signals in comparison with the spontaneous EEG activity, with very low signal-to-noise ratio (SNR) (<xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-2" hwp:rel-id="ref-8">Linden, 2005</xref>; <xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">Croft and Barry, 2000</xref>), and are typically constituted by two to four waves of low amplitude (4-10 microvolts) with a characteristic positive wave called P300, which occurs with a latency of about 300 milliseconds in response to the stimulus. The detection of ERPs is an important problem and several methods exist to distinguish these weak signals. Indeed, ERP analysis has become a major part of brain research today, especially in the design and development of BCIs (<xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">Sano and Bakardjian, 2009</xref>).</p><p hwp:id="p-13">Since ERP is considered a reproducible response to a stimulus, with relatively stable amplitude, waveform and latency, the standard method to extract ERPs is based on the repeated presentation of the stimulus for about 80-100 times, with a random inter-stimulus time of few seconds. This strategy allows calculating the ERPs averaging several epochs that are time-locked and phase-locked.</p><p hwp:id="p-14">Because the spontaneous noisy EEG activity is uncorrelated with the ERP waveform, the noise will decrease in the order of 1/SQR(N) (inverse of square root of N), where N is the number of averaged epochs. Since the background EEG activity has a higher amplitude than ERPs waveform, the averaging technique highlights ERPs and attenuates the noise. This is the easiest strategy currently used to detect ERPs.</p><p hwp:id="p-15">In this paper, we are going to illustrate a new method to detect ERPs, also in particularly noisy signals and with significant variations of the latency, known as “latency jitter”.</p><p hwp:id="p-16">Our method, named GW6, is less restrictive regarding the issue of jitter. It also allows detecting an ERP when the standard approach, based on the average, fails or gives unsatisfactory result.</p><p hwp:id="p-17">Yet the GW6 method do not reproduce the typical biphasic waveform of the ERP but rather an always-positive waveform. For this reason, this procedure is useful together with the classic averaging technique, rather as an alternative to the latter.</p><p hwp:id="p-18">In general, to calculate ERPs by the averaging method, essentially three conditions or hypotheses must be satisfied:</p><list list-type="order" hwp:id="list-2"><list-item hwp:id="list-item-4"><p hwp:id="p-19">The signal is time-locked and waveform-locked.</p></list-item><list-item hwp:id="list-item-5"><p hwp:id="p-20">The noise is uncorrelated with the signal.</p></list-item><list-item hwp:id="list-item-6"><p hwp:id="p-21">The latency is relatively stable (low jitter).</p></list-item></list><p hwp:id="p-22">The GW6 method uses extensively the Pearson’s Correlation among all EEG signals recorded by a multichannel EEG device. By using the averaging method, it is possible to work also with a single EEG channel, while the GW6 method works with a multichannel EEG device, from a minimum of 10 channels. It is also possible to calculate successively the ERP of each channel.</p><p hwp:id="p-23">We are going to describe also a useful signal preprocessing method, named Artefacts Reduction (by means of) Standard Deviation (ARSD).</p></sec><sec id="s2" hwp:id="sec-8"><title hwp:id="title-10">The EEG preprocessing</title><p hwp:id="p-24">The average of epochs is nevertheless only the last step of ERPs calculation. Several preprocessing stages are usually necessary because strong artifacts very easily affect the EEG signals, due to eye movements, the heartbeat (ECG artifacts), head movements, bad electrode-skin contacts, etc. All these artifacts can be several times larger (also 10-20 times or more) than the underlying ERPs, therefore they are able to destroy every average with random waves and peaks which can hide the true ERP waveform.</p><p hwp:id="p-25">The first preprocessing step includes the use of a band-pass filter in the range of 1 to 20 Hz obtained with a digital filter, which <italic toggle="yes">must not change the phase of signals.</italic> The Reverse Fourier Transform is suitable for this purpose, among other methods. Many researchers have suggested that the P300 component is primarily formed by transient oscillatory events in delta, theta and alpha band and therefore a 1 to 14 Hz band-pass could be sufficient (<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">Wastell, 1977</xref>). In our analysis, we used a 1 to 20 Hz band-pass filtration.</p><p hwp:id="p-26">The successive step includes a variety of methods: among the most used, it is included the Independent Component Analysis (ICA) algorithm (<xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">Makeig, 1996</xref>; <xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">Vorobyov and Cichocki, 2002</xref>), which allows separating true EEG signal from its undesirable components (twitch, heartbeat, etc.). In general, this method requires a decision-making on what signal component (after separation) is considered undesirable and what should not.</p><p hwp:id="p-27">Blind Source Separation (<xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">Joyce, Gorodnitsky and Kutas, 2004</xref>) is a technique based on the hypothesis that the observed signals from a multichannel recording are generated from a mixture of several distinct source signals. Using this method, it is possible to isolate the original source signal by applying some kind of complex transform to the set of observed signals.</p><p hwp:id="p-28">Discrete Wavelet Transform is another method that can be used to analyze the temporal and spectral properties of non-stationary signals (<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">Wang, MaierLeopold, Logothetis and Liang, 2007</xref>; <xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-1" hwp:rel-id="ref-10">Quiroga and Garcia, 2003</xref>; <xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-1" hwp:rel-id="ref-6">Hu et al., 2011</xref>).</p><p hwp:id="p-29">The artificial neural network, known as Adaptive Neuro-Fuzzy Inference System, was described for P300 detection (<xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">Ramírez-Cortes, Alarcon-Aquino, Rosas-Cholula, Gomez-Gil and Escamilla-Ambrosio, 2010</xref>). Moreover, the Adaptive Noise Canceller (<xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">Ahirwal, Kumar and Singh, 2014</xref>) can detects ERPs. You should note that these algorithms are generally very complicated.</p><p hwp:id="p-30">The so-called winsorization is a routine which reduces the effects due to eye blinks, voluntary and involuntary eye movements, muscle activity, or subject’s movements, that can cause large amplitude outliers in the recorded signal. To reduce the effects of such artifacts, the data from each channel are elaborated and the amplitude values exceeding a lower and an higher percentile threshold, are replaced respectively by the lower and upper percentile (<xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-1" hwp:rel-id="ref-5">Dixon and Tukey, 1968</xref>).</p><p hwp:id="p-31">In our software, we used two fast and uncomplicated routines that are:</p><list list-type="bullet" hwp:id="list-3"><list-item hwp:id="list-item-7"><p hwp:id="p-32">Normalization of signals (see <xref ref-type="app" rid="app1" hwp:id="xref-app-2-1" hwp:rel-id="app-2">Appendix 1</xref>, in the final section of this paper), which reduces the effects due to EEG signal’s strong fluctuations and artifacts. A useful variant is the ARSD routine also described in the same section. With our experimental data, the ARSD routine followed by Normalization obtains the best results, but normalization, in general, is sufficient.</p></list-item><list-item hwp:id="list-item-8"><p hwp:id="p-33">Exclusion from the average of all epochs with an amplitude which overcomes a fixed threshold, for example a threshold of 80 microvolts. A drawback of this technique is that a large number of signals could be discarded and consequently the average could be calculated on insufficient data.</p></list-item></list></sec><sec id="s3" hwp:id="sec-9"><title hwp:id="title-11">Materials and Methods</title><p hwp:id="p-34">In this paper, the GW6 method is described using a routine written in Visual Basic language. Finally the method is applied to true EEG signals recorded using a low-cost EEG device, the Emotiv EPOC® EEG Neuroheadset. This headset is wireless and consists of 14 electrodes and two reference electrodes, located and labeled according to the international 10-20 system. Channel names are: AF3, F7, F3, FC5, T7, P7, O1, O2, P8, T8, FC6, F4, F8 and AF4. The acquired EEG signals are transmitted wirelessly to the computer by means of weak radio signals in the 2.4 GHz frequency band. The Emotiv’s sampling frequency is 128 Hz for every channel and the signals are encoded with a 14-bit definition.</p><p hwp:id="p-35">Moreover, the Emotiv hardware operates on the signals with a preliminary band-pass filter in the 0.1 to 43 Hz band, consequently the output signals are relatively free from the 50 Hz power-line frequency, but they are often rich in artifacts.</p><p hwp:id="p-36">The Emotiv EPOC® headset was successfully used to record ERPs (<xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-1" hwp:rel-id="ref-3">Badcock, 2013</xref>) although it is not considered a medical-grade device.</p><p hwp:id="p-37">We collected and recorded the raw signals from the Emotiv EPOC® headset using a homemade software and a special data-type format based on the.CSV format. The same homemade software was used to give the necessary auditory and/or visual stimulus to the subject.</p><p hwp:id="p-38">ERPs were induced by an auditory stimulus (pure 500 Hz sine wave), and a contemporary light flash given using an array of 16 red high-efficiency LEDs. The stimulus length was of 1 second, and the stimuli were repeated from 100 up to 128 times.</p><p hwp:id="p-39">Participants were all healthy volunteers, preliminarily informed about the experimentation’s purpose. Each participant granted a written consensus. Using the native EEG reference electrode of Emotiv EPOC® headset, we recorded a first set of ERPs. Another set of EEG files, of better quality, were recorded with the reference electrodes connected to the earlobes, a variant that assures better quality of the signals, rather than in the standard configuration of Emotiv EPOC® headset, where the reference electrodes are located in an active zone of the head.</p></sec><sec id="s4" hwp:id="sec-10"><title hwp:id="title-12">The new algorithm</title><p hwp:id="p-40">In many papers describing a mathematical method to analyze something, complex mathematical formulas are usually given, which must be successively translated in a computer-language, for example C, C++, Visual Basic, Java, Python, or else. This step could be very complicated and limit the diffusion and application of some useful methods. In this paper, we will describe this new algorithm directly in an easy and simple well know language, Visual Basic 6, in order to facilitate its application.</p><p hwp:id="p-41">We describe the basic idea of this new method in <xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Fig. 1</xref> and <xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-1" hwp:rel-id="F2">2</xref>:</p><fig id="fig1" position="float" fig-type="figure" orientation="portrait" hwp:id="F1" hwp:rev-id="xref-fig-1-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;022046v1/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Fig. 1:</label><caption hwp:id="caption-1"><p hwp:id="p-42">The upper tracks represents the raw signals of two EEG channels, in time-locked epochs, whereas the lower track is the average of a sufficient number (about 100) of epochs for each channel (ERP is not in scale). The figure shows a positive peak about 300 ms after the stimulus onset (P300 wave). The ERP has typically a length of about 300-500 ms, depending on the kind of stimulus and band-pass filtering of the signal.</p></caption><graphic xlink:href="022046_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig><fig id="fig2" position="float" fig-type="figure" orientation="portrait" hwp:id="F2" hwp:rev-id="xref-fig-2-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;022046v1/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Fig. 2:</label><caption hwp:id="caption-2"><p hwp:id="p-43">The data-windows of length L is shifted progressively along the two tracks, and the corresponding Pearson’s Correlation is calculated and stored in the vector R(x)</p></caption><graphic xlink:href="022046_fig2" position="float" orientation="portrait" hwp:id="graphic-2"/></fig><p hwp:id="p-44">Let us now consider the data-window of length L (about 270 ms) centered in the point X of the signal. We can calculate the Linear Pearson’s Correlation between these two data-segments and the result will be a number <italic toggle="yes">r</italic> represented by the vector R(x), which can be calculated for every point X simply by shifting progressively the windows of one unity of sample (running windows). In general, the averaged value of R(x) will change from the pre-stimulus zone to the stimulus zone because the (auditory or/and visual) stimulus changes the correlation between the two EEG signals, which represent the activity of different parts of the brain. An interval about 270 ms long was selected because it represents the typical delay for a conscious response corresponding to the P300 wave.</p><p hwp:id="p-45">This change of correlation can appear or as an increase or a decrease with respect to the baseline (the zone preceding the stimulus). Let us consider a true example, based on the Emotiv EPOC®, where the number of channels is NC = 14, the sampling frequency is 128 samples/second, the stimulus length is one second, and the epoch length is 3 seconds. In this case, it is possible to calculate the vector R(x) in a number of pair combinations Nt = NC<sub>*</sub>(NC - 1)/2 = 91.</p><p hwp:id="p-46">The result could be expressed using an array R(I, X) where I = 1… 91, and X = 1… 384. This last number arises from an epoch of 3-seconds length and 128 samples/second, with the stimulus given at sample number 128, and stopped at sample number 256, after one second. In general, we can represent the raw signals as a time-locked array of V(C, X, J) type, where C = 1… 14 are the EEG channels, X = 1… 384 are the samples along 3 seconds, and J is the number of stimulations given to the subject, usually about 100. The entire GW6 procedure is better described in the Visual Basic routine (see <xref ref-type="app" rid="app3" hwp:id="xref-app-4-1" hwp:rel-id="app-4">Appendix 3</xref>).</p><p hwp:id="p-47">The following are the stages of elaboration based on the Emotiv EPOC® device, but not limited to this specific device (the numbers here described are only examples):</p><list list-type="bullet" hwp:id="list-4"><list-item hwp:id="list-item-9"><p hwp:id="p-48"><bold>Stage 1</bold>: collection of the raw EEG data in a time-locked way, V(C, X, J); C = 1… 14, J = 1… 100 is the typical number of stimulation, X = 1… 384 are the samples. Our customized software collects the raw signals and performs this stage.</p></list-item><list-item hwp:id="list-item-10"><p hwp:id="p-49"><bold>Stage 2</bold>: filtration in a selected band (example: 1-20 Hz, and Normalization or ARSD or both, see Appendix) giving the filtered array: V(C, X, J) + filtration → W(C, X, J).</p></list-item><list-item hwp:id="list-item-11"><p hwp:id="p-50"><bold>Stage 3</bold>: calculus of the simple average of W(C, X, J) among all epochs, giving the final array Ev(C, X), where: C= 1… 14 and X= 1… 384, which is the simple and classic ERP for each channel.</p></list-item><list-item hwp:id="list-item-12"><p hwp:id="p-51"><bold>Stage 4</bold>: calculus of all the Pearson’s Correlations combinations using a running-window 270 ms long. The result is the array R(I, X), I = 1..91, which is already the average of all stimuli.</p></list-item><list-item hwp:id="list-item-13"><p hwp:id="p-52"><bold>Stage 5</bold>: calculus of the mean value of baseline for each Nt combination (baseline is balanced and calculated as average from X=1 to 128 + average from X=257 to 384), and subtraction of this baseline from the array R(I, X) taking the absolute value R’(I, X) = Abs[R(I, X – Baseline)].</p></list-item><list-item hwp:id="list-item-14"><p hwp:id="p-53"><bold>Stage 6</bold>: average along all the Nt combinations (and all the stimulation), giving the final array Sync1(X), which represents the global variation of the EEG correlations during an epoch of 3 seconds. It is also possible to calculate an equivalent array Sync2(C, X) for each channel C.</p></list-item></list><p hwp:id="p-54">The global array Sync1(X) and also Sync2(C, X) will show a positive peak in ERP’s zone, as represented in <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-1" hwp:rel-id="F3">Fig. 3</xref>. These peaks are examples of the typical results provided by this method:</p><fig id="fig3" position="float" fig-type="figure" orientation="portrait" hwp:id="F3" hwp:rev-id="xref-fig-3-1 xref-fig-3-2 xref-fig-3-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;022046v1/FIG3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F3</object-id><object-id pub-id-type="publisher-id">fig3</object-id><label>Fig. 3:</label><caption hwp:id="caption-3"><p hwp:id="p-55">In these pictures, given as example, on the left is shown the classic ERP (amplitude in microvolts). On the right is shown the corresponding GW6 graphic; the result is expressed as R-Pearson value multiplied by 100. All these graphics are the global average of 14 EEG channels and about 120 stimuli; the EEG data were filtered in the band 1-20 Hz and submitted to the routines Normalization or ARSD, or both. In all cases a positive peak is observed in coincidence with the P300 maximum peak, but in several cases, the majority, the positive peak of GW6 graphic is larger than the corresponding classic ERP (see, for example, cases B, C and D).</p></caption><graphic xlink:href="022046_fig3" position="float" orientation="portrait" hwp:id="graphic-3"/></fig><p hwp:id="p-56">In order to better inquire the properties of GW6 routine, we wrote an emulation software. In this software, a simple artificial ERP’s waveform was added to a random noise, and suitably filtered (low-pass filter) in order to reproduce the typical frequency distribution of the EEG signal. The artificial ERP signal was mixed with a variable amount of this random signal and submitted both to the classic average and to the GW6 routines (<xref ref-type="fig" rid="fig4" hwp:id="xref-fig-4-1" hwp:rel-id="F4">Fig. 4</xref>).</p><fig id="fig4" position="float" fig-type="figure" orientation="portrait" hwp:id="F4" hwp:rev-id="xref-fig-4-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;022046v1/FIG4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F4</object-id><object-id pub-id-type="publisher-id">fig4</object-id><label>Fig. 4:</label><caption hwp:id="caption-4"><p hwp:id="p-57">Artificial ERP signal mixed with a variable amount of a random signal and submitted both to the classic average and to the GW6 routines</p></caption><graphic xlink:href="022046_fig4" position="float" orientation="portrait" hwp:id="graphic-4"/></fig><p hwp:id="p-58"><xref ref-type="fig" rid="fig5" hwp:id="xref-fig-5-1" hwp:rel-id="F5">Fig.5</xref> shows the results of the classical Average routine and of the GW6 routine for a progressive increase of the noise-to-signal ratio, average of 100 ERPs on a single channel. Whereas the final amplitude of the ERP waveform do not change, but becomes progressively noisier, the GW6 graphic amplitude (red curve) drops progressively but with stable residual noise. Very interesting is the emulation of these two routines in presence of the so called “latency jitter”, which is an unstable ERP time latency that in some cases could affect the ERPs.</p><fig id="fig5" position="float" fig-type="figure" orientation="portrait" hwp:id="F5" hwp:rev-id="xref-fig-5-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;022046v1/FIG5</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F5</object-id><object-id pub-id-type="publisher-id">fig5</object-id><label>Fig. 5.</label><caption hwp:id="caption-5"><p hwp:id="p-59">Example of the ERP + Random signal emulation for 4 levels of noise-to-signal ratio.</p></caption><graphic xlink:href="022046_fig5" position="float" orientation="portrait" hwp:id="graphic-5"/><graphic xlink:href="022046_fig5a" position="float" orientation="portrait" hwp:id="graphic-6"/></fig><p hwp:id="p-60">When the ERP latency is stable (<xref ref-type="fig" rid="fig6" hwp:id="xref-fig-6-1" hwp:rel-id="F6">Fig. 6</xref>, left picture), also its average is stable and shows the maximum amplitude. Nevertheless, if latency jitter is present (due to some physiological cause) the corresponding average decreases because each ERP do not combine with the same phase and consequently ERPs show the tendency to cancel reciprocally. This effect is more pronounced as the jitter is increasing.</p><fig id="fig6" position="float" fig-type="figure" orientation="portrait" hwp:id="F6" hwp:rev-id="xref-fig-6-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;022046v1/FIG6</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F6</object-id><object-id pub-id-type="publisher-id">fig6</object-id><label>Fig. 6:</label><caption hwp:id="caption-6"><p hwp:id="p-61">ERP stable latency on the left and with latency jiitter on the right</p></caption><graphic xlink:href="022046_fig6" position="float" orientation="portrait" hwp:id="graphic-7"/></fig><p hwp:id="p-62">In the software emulation of <xref ref-type="fig" rid="fig7" hwp:id="xref-fig-7-1" hwp:rel-id="F7">Fig. 7</xref> a stable noise-to-signal ratio (3 / 1) was used, but with a random jitter progressively incremented. Moreover, the jitter was random between the ERPs, but was constant for all the channels in each ERP. The results show that the GW6 routine is more resistant to jitter than the simple classic average.</p><fig id="fig7" position="float" fig-type="figure" orientation="portrait" hwp:id="F7" hwp:rev-id="xref-fig-7-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;022046v1/FIG7</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F7</object-id><object-id pub-id-type="publisher-id">fig7</object-id><label>Fig. 7:</label><caption hwp:id="caption-7"><p hwp:id="p-63">A stable noise-to-signal ratio (3/1) but with a random jitter progressively incremented.</p></caption><graphic xlink:href="022046_fig7" position="float" orientation="portrait" hwp:id="graphic-8"/></fig><p hwp:id="p-64">Whereas the classic ERP waveform disappears rapidly increasing the jitter, the GW6 routine gives a result still identifiable (the red curve), where the amplitude is decreasing but not so rapidly, and the width of the curve is increasing.</p><p hwp:id="p-65">This interesting property is very important, because suggests some other possibility about the large GW6 peaks observed in <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-2" hwp:rel-id="F3">Fig. 3</xref>, in particular in B, C and D cases.</p><p hwp:id="p-66">Following an intuition, we added a new and simple routine in our software used to analyze the true ERP with the classic and the GW6 routine. At the end of the elaboration, which gives the typical result shown in <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-3" hwp:rel-id="F3">Fig. 3</xref>, we created another routine where to the set of EEG signals W(C, X, J), the classic ERP average was subtracted (see the routine SWXX in Appendix) giving a new array : W’(C, X, J) = W(C, X, J) - Ev(C, X), then this new data-set was submitted to the stages 3, 4, 5 and 6 previously described. Including this strange operation in our emulation software, and successively performing the same 3, 4, 5 and 6 stages, as a result no any ERP appears, and no any significant GW6 peak appears. This is obvious because we have canceled from the random noise the ERP component, and consequently nothing is waiting to appear, but that is true only if jitter is zero (<xref ref-type="fig" rid="fig8" hwp:id="xref-fig-8-1" hwp:rel-id="F8">Fig. 8</xref> and <xref ref-type="fig" rid="fig9" hwp:id="xref-fig-9-1" hwp:rel-id="F9">Fig. 9</xref>).</p><fig id="fig8" position="float" fig-type="figure" orientation="portrait" hwp:id="F8" hwp:rev-id="xref-fig-8-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;022046v1/FIG8</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F8</object-id><object-id pub-id-type="publisher-id">fig8</object-id><label>Fig. 8</label><caption hwp:id="caption-8"><p hwp:id="p-67">Case 1. Left: W(C, X, J) from ERP pure wave + random noise, Jitter = 0, average of 100 ERPs. Right: with the same elaboration of the corresponding W’(C,X,J) array both graphics disappear.</p></caption><graphic xlink:href="022046_fig8" position="float" orientation="portrait" hwp:id="graphic-9"/></fig><fig id="fig9" position="float" fig-type="figure" orientation="portrait" hwp:id="F9" hwp:rev-id="xref-fig-9-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;022046v1/FIG9</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F9</object-id><object-id pub-id-type="publisher-id">fig9</object-id><label>Fig. 9</label><caption hwp:id="caption-9"><p hwp:id="p-68">Case 2. Left: W(C, X, J) from ERP pure wave + random noise, Jitter = 78ms (from 0 to 78 ms, random), average of 100 ERPs. Right: with the same elaboration of the corresponding W’(C,X,J) array only the classic ERP disappears. In presence of Jitter, the GW6 routine always shows an ERP.</p></caption><graphic xlink:href="022046_fig9" position="float" orientation="portrait" hwp:id="graphic-10"/></fig><p hwp:id="p-69">We performed a new variant in the emulation software: beside the pure ERP wave + random signal, we added also a random common signal (RCS) to every channel only in a limited zone near the ERP, <italic toggle="yes">but this RCS is random among the ERPs.</italic> In this variant of emulation, we hypothesized that the stimulus given to the subject could cause not only a simple brain response based on a stable waveform with low jitter (the classic ERP) <italic toggle="yes">but also a non-stable waveform very similar or identical in all the EEG channels.</italic> The simple average does not reveal this kind of electric response, because waveform is near random, but it is easily revealed by the GW6 routine, <italic toggle="yes">which is based on the computation of the variation of correlation among all the EEG channels during the stimulus.</italic></p><fig id="fig10" position="float" fig-type="figure" orientation="portrait" hwp:id="F10"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;022046v1/FIG10</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F10</object-id><object-id pub-id-type="publisher-id">fig10</object-id><label>Fig. 10</label><caption hwp:id="caption-10"><p hwp:id="p-70">Case 3. Left: W(C, X, J) from ERP pure wave + random noise, Jitter = 0, CRS width about 400 ms, average of 100 ERPs. Right: with the same elaboration of the W’(C,X,J) array only the classic ERP disappears, not that due to CRS.</p></caption><graphic xlink:href="022046_fig10" position="float" orientation="portrait" hwp:id="graphic-11"/></fig><fig id="fig11" position="float" fig-type="figure" orientation="portrait" hwp:id="F11" hwp:rev-id="xref-fig-11-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;022046v1/FIG11</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F11</object-id><object-id pub-id-type="publisher-id">fig11</object-id><label>Fig. 11</label><caption hwp:id="caption-11"><p hwp:id="p-71">Case 4. Left: W(C, X, J) from ERP pure wave + random noise, Jitter = 78 ms, CRS width about 400 ms, average of 100 ERPs. Right: with the same elaboration of the W’(C,X,J) array now both peaks are visible.</p></caption><graphic xlink:href="022046_fig11" position="float" orientation="portrait" hwp:id="graphic-12"/></fig><fig id="fig12" position="float" fig-type="figure" orientation="portrait" hwp:id="F12" hwp:rev-id="xref-fig-12-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;022046v1/FIG12</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F12</object-id><object-id pub-id-type="publisher-id">fig12</object-id><label>Fig. 12</label><caption hwp:id="caption-12"><p hwp:id="p-72">Case 5. Left: W(C, X, J) from ERP pure wave + random noise, Jitter =78ms, CRS width about 860 ms, average of 100 ERPs. Right: with the same elaboration of the W’(C,X,J) array now both peaks are overlapped and visible.</p></caption><graphic xlink:href="022046_fig12" position="float" orientation="portrait" hwp:id="graphic-13"/></fig><p hwp:id="p-73">We suggest that the two last cases (4 - <xref ref-type="fig" rid="fig11" hwp:id="xref-fig-11-1" hwp:rel-id="F11">Fig. 11</xref> and 5 - <xref ref-type="fig" rid="fig12" hwp:id="xref-fig-12-1" hwp:rel-id="F12">Fig. 12</xref>) are the most representative of the true experimental ERPs. It is easily possible to calculate a great number of combinations and situations using our demonstrative software, which can be freely downloaded at the address <ext-link l:rel="related" l:ref-type="uri" l:ref="http://www.evanlab/org/" ext-link-type="uri" xlink:href="http://www.evanlab/org/" hwp:id="ext-link-2">www.evanlab/org/</ext-link>.</p><p hwp:id="p-74">Now, if we submit our true experimental ERPs to the same procedure, i.e. analysis of the W(C, X, J) data followed by the transform into the W’(C, X, J) data-set and a new analysis, we obtain these typical results (<xref ref-type="fig" rid="fig13" hwp:id="xref-fig-13-1" hwp:rel-id="F13">Fig.13</xref>):</p><fig id="fig13" position="float" fig-type="figure" orientation="portrait" hwp:id="F13" hwp:rev-id="xref-fig-13-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;022046v1/FIG13</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F13</object-id><object-id pub-id-type="publisher-id">fig13</object-id><label>Fig. 13</label><caption hwp:id="caption-13"><p hwp:id="p-75">Results of the analysis of the true experimental ERPs analysis of the W(C, X, J) data followed by the transform into the W’(C, X, J) data-set.</p></caption><graphic xlink:href="022046_fig13" position="float" orientation="portrait" hwp:id="graphic-14"/></fig><p hwp:id="p-76">In the greater part of cases, after the subtraction of the classic ERP waveform from the EEG data, the GW6 routine (red graphic) shows a reduction in amplitude in correspondence with the standard ERP wave, but other peaks are little changed, and in several cases, the entire graphic is not much changed.</p></sec><sec id="s5" hwp:id="sec-11"><title hwp:id="title-13">Conclusions</title><p hwp:id="p-77">This result could mean that there is some amount of jitter in coincidence with the classic ERP, and/or also other non-phase-locked components, like those hypothesized in the emulation software, both under the classic ERP peak and in other zones of the graphic.</p><p hwp:id="p-78">The purpose of this paper nevertheless in not to inquire accurately about the EEG response to a stimulus, but only to propose a new routine for the ERPs’ detection, that could become very important for future research about the nature, origin and characteristic of ERPs, on the light of the preliminary result here presented.</p><p hwp:id="p-79">In particular, this new method could be very useful to inquire about the hidden components of the ERP response, with possible important application for medical purposes.</p><p hwp:id="p-80">Moreover, we emphasize also the choice to give the routines directly in a simple programming language, together with a demonstrative software complete of its source code.</p></sec></body><back><ack hwp:id="ack-1"><title hwp:id="title-14">Acknowledgments:</title><p hwp:id="p-81">this study was partially supported by the research grant n. 124/12 of Bial Foundation. We thank Elena Prati and Claudia Evangelista for English revision.</p></ack><ref-list hwp:id="ref-list-1"><title hwp:id="title-15">REFERENCES</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1"><citation publication-type="journal" citation-type="journal" ref:id="022046v1.1" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Ahirwal M. K."><surname>Ahirwal</surname>, <given-names>M. K.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kumar A."><surname>Kumar</surname>, <given-names>A.</given-names></string-name>, &amp; <string-name name-style="western" hwp:sortable="Singh G. K."><surname>Singh</surname>, <given-names>G. K.</given-names></string-name> (<year>2014</year>). <article-title hwp:id="article-title-2">Adaptive filtering of EEG/ERP through noise cancellers using an improved PSO algorithm</article-title>. <source hwp:id="source-1">Swarm and Evolutionary Computation</source>, <volume>14</volume>, <fpage>76</fpage>–<lpage>91</lpage>.</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1"><citation publication-type="journal" citation-type="journal" ref:id="022046v1.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="Aydin S."><surname>Aydin</surname>, <given-names>S.</given-names></string-name> (<year>2008</year>). <article-title hwp:id="article-title-3">Comparison of basic linear filters in extracting auditory evoked potentials</article-title>. <source hwp:id="source-2">Turkish Journal of Electrical Engineering &amp; Computer Sciences</source>, <volume>16</volume>(<issue>2</issue>), <fpage>111</fpage>–<lpage>123</lpage>.</citation></ref><ref id="c3" hwp:id="ref-3" hwp:rev-id="xref-ref-3-1"><citation publication-type="journal" citation-type="journal" ref:id="022046v1.3" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Badcock N. A."><surname>Badcock</surname>, <given-names>N. A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Mousikou P."><surname>Mousikou</surname>, <given-names>P.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Mahajan Y."><surname>Mahajan</surname>, <given-names>Y.</given-names></string-name>, <string-name name-style="western" hwp:sortable="de Lissa P."><surname>de Lissa</surname>, <given-names>P.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Thie J."><surname>Thie</surname>, <given-names>J.</given-names></string-name>, &amp; <string-name name-style="western" hwp:sortable="McArthur G."><surname>McArthur</surname>, <given-names>G.</given-names></string-name> (<year>2013</year>). <article-title hwp:id="article-title-4">Validation of the Emotiv EPOC(r) (r) EEG gaming system for measuring research quality auditory ERPs</article-title>. <source hwp:id="source-3">PeerJ</source>, <volume>1</volume>, <fpage>e38</fpage>.</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1"><citation publication-type="journal" citation-type="journal" ref:id="022046v1.4" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Croft R. J."><surname>Croft</surname>, <given-names>R. J.</given-names></string-name>, &amp; <string-name name-style="western" hwp:sortable="Barry R. J."><surname>Barry</surname>, <given-names>R. J.</given-names></string-name> (<year>2000</year>). <article-title hwp:id="article-title-5">Removal of ocular artifact from the EEG: a review</article-title>. <source hwp:id="source-4">Neurophysiologie Clinique/Clinical Neurophysiology</source>, <volume>30</volume>(<issue>1</issue>), <fpage>5</fpage>–<lpage>19</lpage>.</citation></ref><ref id="c5" hwp:id="ref-5" hwp:rev-id="xref-ref-5-1"><citation publication-type="journal" citation-type="journal" ref:id="022046v1.5" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Dixon W. J."><surname>Dixon</surname>, <given-names>W. J.</given-names></string-name>, &amp; <string-name name-style="western" hwp:sortable="Tukey J. W."><surname>Tukey</surname>, <given-names>J. W.</given-names></string-name> (<year>1968</year>). <article-title hwp:id="article-title-6">Approximate behavior of the distribution of Winsorized t (Trimming/Winsorization 2</article-title>). <source hwp:id="source-5">Technometrics</source>, <volume>10</volume>(<issue>1</issue>), <fpage>83</fpage>–<lpage>98</lpage>.</citation></ref><ref id="c6" hwp:id="ref-6" hwp:rev-id="xref-ref-6-1"><citation publication-type="journal" citation-type="journal" ref:id="022046v1.6" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Hu L."><surname>Hu</surname>, <given-names>L.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Liang M."><surname>Liang</surname>, <given-names>M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Mouraux A."><surname>Mouraux</surname>, <given-names>A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Wise R. G."><surname>Wise</surname>, <given-names>R. G.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Hu Y."><surname>Hu</surname>, <given-names>Y.</given-names></string-name>, &amp; <string-name name-style="western" hwp:sortable="Iannetti G. D."><surname>Iannetti</surname>, <given-names>G. D.</given-names></string-name> (<year>2011</year>). <article-title hwp:id="article-title-7">Taking into account latency, amplitude, and morphology: improved estimation of single-trial ERPs by wavelet filtering and multiple linear regression</article-title>. <source hwp:id="source-6">Journal of Neurophysiology</source>, <volume>106</volume>(<issue>6</issue>), <fpage>3216</fpage>–<lpage>3229</lpage>.</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1"><citation publication-type="journal" citation-type="journal" ref:id="022046v1.7" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Joyce C. A."><surname>Joyce</surname>, <given-names>C. A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gorodnitsky I. F."><surname>Gorodnitsky</surname>, <given-names>I. F.</given-names></string-name>, &amp; <string-name name-style="western" hwp:sortable="Kutas M."><surname>Kutas</surname>, <given-names>M.</given-names></string-name> (<year>2004</year>). <article-title hwp:id="article-title-8">Automatic removal of eye movement and blink artifacts from EEG data using blind component separation</article-title>. <source hwp:id="source-7">Psychophysiology</source>, <volume>41</volume>(<issue>2</issue>), <fpage>313</fpage>–<lpage>325</lpage>.</citation></ref><ref id="c8" hwp:id="ref-8" hwp:rev-id="xref-ref-8-1 xref-ref-8-2"><citation publication-type="journal" citation-type="journal" ref:id="022046v1.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Linden D. E."><surname>Linden</surname>, <given-names>D. E.</given-names></string-name> (<year>2005</year>). <article-title hwp:id="article-title-9">The P300: where in the brain is it produced and what does it tell us?</article-title>. <source hwp:id="source-8">The Neuroscientist</source>, <volume>11</volume>(<issue>6</issue>), <fpage>563</fpage>–<lpage>576</lpage>.</citation></ref><ref id="c9" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1"><citation publication-type="journal" citation-type="journal" ref:id="022046v1.9" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Makeig S."><surname>Makeig</surname>, <given-names>S.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Bell A. J."><surname>Bell</surname>, <given-names>A. J.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Jung T. P."><surname>Jung</surname>, <given-names>T. P.</given-names></string-name>, &amp; <string-name name-style="western" hwp:sortable="Sejnowski T. J."><surname>Sejnowski</surname>, <given-names>T. J.</given-names></string-name> (<year>1996</year>). <article-title hwp:id="article-title-10">Independent component analysis of electroencephalographic data</article-title>. <source hwp:id="source-9">Advances in neural information processing systems</source>, <fpage>145</fpage>–<lpage>151</lpage>.</citation></ref><ref id="c10" hwp:id="ref-10" hwp:rev-id="xref-ref-10-1"><citation publication-type="journal" citation-type="journal" ref:id="022046v1.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="Quiroga R. Q."><surname>Quiroga</surname>, <given-names>R. Q.</given-names></string-name>, &amp; <string-name name-style="western" hwp:sortable="Garcia H."><surname>Garcia</surname>, <given-names>H.</given-names></string-name> (<year>2003</year>). <article-title hwp:id="article-title-11">Single-trial event-related potentials with wavelet denoising</article-title>. <source hwp:id="source-10">Clinical Neurophysiology</source>, <volume>114</volume>(<issue>2</issue>), <fpage>376</fpage>–<lpage>390</lpage>.</citation></ref><ref id="c11" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1"><citation publication-type="book" citation-type="book" ref:id="022046v1.11" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="Ramírez-Cortes J. M."><surname>Ramírez-Cortes</surname>, <given-names>J. M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Alarcon-Aquino V."><surname>Alarcon-Aquino</surname>, <given-names>V.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Rosas-Cholula G."><surname>Rosas-Cholula</surname>, <given-names>G.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gomez-Gil P."><surname>Gomez-Gil</surname>, <given-names>P.</given-names></string-name>, &amp; <string-name name-style="western" hwp:sortable="Ambrosio Escamilla-"><given-names>Escamilla-</given-names> <surname>Ambrosio</surname></string-name>, J. (<year>2010</year>). <chapter-title>P-300 rhythm detection using ANFIS algorithm and wavelet feature extraction in EEG signals. In <italic toggle="yes">Proceedings of the World Congress on Engineering and Computer Science</italic> (Vol</chapter-title>. <volume>1</volume>, pp. <fpage>963</fpage>–<lpage>968</lpage>). <publisher-name>San Francisco: International Association of Engineers</publisher-name>.</citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1"><citation publication-type="book" citation-type="book" ref:id="022046v1.12" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Sanei S."><surname>Sanei</surname>, <given-names>S.</given-names></string-name>, &amp; <string-name name-style="western" hwp:sortable="Chambers J. A."><surname>Chambers</surname>, <given-names>J. A.</given-names></string-name> (<year>2013</year>). <source hwp:id="source-11">EEG signal processing</source>. <publisher-name>John Wiley &amp; Sons</publisher-name>.</citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1"><citation publication-type="journal" citation-type="journal" ref:id="022046v1.13" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="Sano A."><surname>Sano</surname>, <given-names>A.</given-names></string-name>, &amp; <string-name name-style="western" hwp:sortable="Bakardjian H."><surname>Bakardjian</surname>, <given-names>H.</given-names></string-name> (<year>2009</year>). <article-title hwp:id="article-title-12">Movement-related cortical evoked potentials using four-limb imagery</article-title>. <source hwp:id="source-12">International Journal of Neuroscience</source>, <volume>119</volume>(<issue>5</issue>), <fpage>639</fpage>–<lpage>663</lpage>.</citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1"><citation publication-type="journal" citation-type="journal" ref:id="022046v1.14" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Vorobyov S."><surname>Vorobyov</surname>, <given-names>S.</given-names></string-name>, &amp; <string-name name-style="western" hwp:sortable="Cichocki A."><surname>Cichocki</surname>, <given-names>A.</given-names></string-name> (<year>2002</year>). <article-title hwp:id="article-title-13">Blind noise reduction for multisensory signals using ICA and subspace filtering, with application to EEG analysis</article-title>. <source hwp:id="source-13">Biological Cybernetics</source>, <volume>86</volume>(<issue>4</issue>), <fpage>293</fpage>–<lpage>303</lpage>.</citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1"><citation publication-type="journal" citation-type="journal" ref:id="022046v1.15" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Wang Z."><surname>Wang</surname>, <given-names>Z.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Maier A."><surname>Maier</surname>, <given-names>A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Leopold D. A."><surname>Leopold</surname>, <given-names>D. A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Logothetis N. K."><surname>Logothetis</surname>, <given-names>N. K.</given-names></string-name>, &amp; <string-name name-style="western" hwp:sortable="Liang H."><surname>Liang</surname>, <given-names>H.</given-names></string-name> (<year>2007</year>). <article-title hwp:id="article-title-14">Single-trial evoked potential estimation using wavelets</article-title>. <source hwp:id="source-14">Computers in Biology and Medicine</source>, <volume>37</volume>(<issue>4</issue>), <fpage>463</fpage>–<lpage>473</lpage>.</citation></ref><ref id="c16" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1"><citation publication-type="journal" citation-type="journal" ref:id="022046v1.16" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Wastell D. G."><surname>Wastell</surname>, <given-names>D. G.</given-names></string-name> (<year>1977</year>). <article-title hwp:id="article-title-15">Statistical detection of individual evoked responses: an evaluation of Woody’s adaptive filter</article-title>. <source hwp:id="source-15">Electroencephalography and Clinical Neurophysiology</source>, <volume>42</volume>(<issue>6</issue>), <fpage>835</fpage>–<lpage>839</lpage>.</citation></ref></ref-list><app-group hwp:id="app-group-1"><title hwp:id="title-16">APPENDIX</title><app id="app0" hwp:id="app-1"><title hwp:id="title-17">Routines of data elaboration written in VB6 language.</title><p hwp:id="p-82">Note: the symbol ‘:’ represents the separation between two successive instructions, the declarations about arrays and variables are sometime omitted (in general, they are of Currency or Integer type). Several instructions are written on the same line for compactness reasons.</p><p hwp:id="p-83">Now suppose that the W(C, X, J) array represents all the data to be analyzed, where C is the number of channels (14 in the Emotiv Epoc), X the samples from X = 1 to 384, equivalent to 3 seconds at 128 samples/second, J = 1 to Ns is the number of stimulus given to the subject (usually Ns = 100). Moreover, we suppose that the stimulus is given at X = 128 and stops at X = 256 (duration: 1 second).</p><p hwp:id="p-84">Some other support array and variables are used in this routine. Data in the W(C, X, J) array must be with zero-average (easy to implement, here omitted). The unity of the W(C, X, J) data could be in microvolts, or raw data at 10, 12, 16 bit, etc.</p></app><app id="app1" hwp:id="app-2" hwp:rev-id="xref-app-2-1"><label>Appendix 1:</label><title hwp:id="title-18">preprocessing of EEG data with the method here called “Normalization”</title><preformat preformat-type="dialog" position="float" orientation="portrait" xml:space="preserve" hwp:id="preformat-1">
Private Sub Normalize()
Dim A As Currency, Sd As Currency, X As Integer, C As Integer, J As Integer
'This normalization step create epochs with a shape identical to that of the original EEG
'signal but transformed into a uniform scale to allow epochs to be easy combined and analyzed
'across the subjects. Moreover, the original signal amplitude is recovered using a constant K
'where K is the Standard Deviation of a good quality signal, experimentally found with the
'specific instrument used. Here the number K = 20 is used.
'The array W(C, X, J) must be at zero-average in each channel. See the <xref ref-type="app" rid="app2" hwp:id="xref-app-3-1" hwp:rel-id="app-3">Appendix 2</xref>.
N1 = 384 : NC = 14 : Ns = 100 'definition of the value of data
For J = 1 To Ns
   For C = 1 To NC : A = 0 : Sd = 0
     For X = 1 To N1 : A = A + W(C, X, J) : Next X
    A = A / N1 'average of signal
       For X = 1 To N1 : Sd = Sd + (W(C, X, J) - A) ^ 2 : Next X
      Sd = Sd / N1 : Sd = Sqr(Sd) 'standard deviation of each channel
      If Sd = 0 Then Sd = 1
     For X = 1 To N1 : W(C, X, J) = 20 * (W(C, X, J) - A) / Sd : Next X
   Next C
Next J
End Sub
</preformat></app><app id="app2" hwp:id="app-3" hwp:rev-id="xref-app-3-1"><label>Appendix 2:</label><title hwp:id="title-19">preprocessing of EEG data with the method named “ARSD”</title><preformat preformat-type="dialog" position="float" orientation="portrait" xml:space="preserve" hwp:id="preformat-2">
Private Sub ArtefARSD()
Dim A As Currency, B As Currency, Pm(20) As Single
Dim Iter As Integer, Fux As Integer, X As Integer, C As Integer, J As Integer
'This routine works like the Normalization but with some differences. In several cases it
'works better or is very similar to Normalization. This routine reduces big artifacts
'to smaller artifacts. Good quality signals are unchanged.
'The best is to use the ARSD, followed by Normalization.
N1 = 384 : NC = 14 : Ns = 100 'definition of the data-value
'first step: zero average of all the EEG channel, could be omitted if already done.
For J = 1 To Ns
  For C = 1 To NC : A = 0
    For X = 1 To N1 : A = A + W(C, X, J) : Next X
    A = A / N1
    For X = 1 To N1 : W(C, X, J) = W(C, X, J) – A : Next X
  Next C
Next J
For J = 1 To Ns
    For C = 1 To NC
       For Iter = 1 To 20
       A = 0 : B = 0 : Pm(C) = 0
       For X = 1 To N1 : A = A + W(C, X, J) : Next X
      A = A / N1 : B = 0
      For X = 1 To N1 : B = B + (W(C, X, J) - A) ^ 2 : Next X
      B = B / N1 : Pm(C) = Sqr(B) 'Standard Deviation for each channel
'the original data are corrected until a threshold &lt;= 34 where the number 34
'is about 1.7* Sd (Standard Deviation) of a good signal experimentally found with
'the device used. In our device, good Sd is 20 and then 1.7*20 = 34
      Fux = 0
      If Pm(C) &gt; 34 Then
          Fux = 1
          For X = 1 To N1
          If Abs(W(C, X, J)) &gt;= Pm(C) Then W(C, X, J) = 0.7 * W(C, X, J)
          Next X
       End If
      If Fux = 0 Then Exit For
      Next Iter
      'the resulting signal is amplified by the factor 1.4 to recover the correct amplitude For X = 1 To N1 : W(C, X, J) = 1.4 * W(C, X, J) : Next X
    Next C
Next J
End Sub
</preformat><p hwp:id="p-85">Observation: The use of ARSD + Normalization (in this order) greatly reduces the artifacts in the EEG signals without changing the phase and with a minimum change in the frequency distribution. This combination is very fast, efficient and easy to implement in any software language</p></app><app id="app3" hwp:id="app-4" hwp:rev-id="xref-app-4-1"><label>Appendix 3:</label><title hwp:id="title-20">the essential core of the GW6 routine</title><p hwp:id="p-86">Note: in this routine we must suppose that the W(C, X, J) array previously described, should have data also in the range from X= - 30 to (N1 + 30), so the precedent routines should be modified in order to fill the entire set of data.</p><preformat preformat-type="dialog" position="float" orientation="portrait" xml:space="preserve" hwp:id="preformat-3">
Private Sub GW6()
Dim V1(800) As Single, V2(800) As Single, A1(800) As Single
Dim F1 As Single, F2 As Single, F3 As Single, I As Integer, J As Integer Dim XM As Single, YM As Single, R As Single, X As Integer
Dim Ax As Integer, Bx As Integer, Np As Integer, C As Integer Dim Nz As Integer, A As Integer, A2(200) As Single, U As Integer
'the array Cm(92, 800) and the variable Nt should be declared in the Option Explicit of VB6
'moreover each element of the array Cm(92, 800) must be put to zero before this routine
N1 = 384 : NC = 14 : Ns = 100 'definition of the value of data
Np = 34 ' 34 is a windows of about 270 ms, at 128 samples/s, could be changed
Nt = (NC ^ 2 - NC) / 2 'Nt = 91 in our case is the number of combination with 14 channels
For J = 1 To Ns 'for all the stimuli given
 U = 0 : I = 0
 For Ax = 1 To (NC - 1)
   For Bx = (Ax + 1) To NC
   I = I + 1 'counter of the progressive combinations of two channels
    For U = 1 To N1
    X1 = U - (Np / 2) : X2 = U + (Np / 2) : A = 0
    For X = X1 To X2 : A = A + 1
    V1(A) = W(Ax, X, J) : V2(A) = W(Bx, X, J) : Next X
    Nz = A
    GoSub Correlas
    A1(U) = R : A = 0
    Next U
    For X = 1 To N1 : Cm(I, X) = Cm(I, X) + A1(X) : Next X
   Next Bx
  Next Ax
Next J
For I = 1 To Nt 'averaging along all the Ns stimuli
For X = 1 To N1 : Cm(I, X) = Cm(I, X) /Ns : Next X
Next I
'now we have the array of output Cm(I, X) where I = 1…91, X = 1…384
'This array could be submitted to some low-pass filtration, see the routine ClassicERP Exit Sub
Correlas: ‘Pearson’s correlation
F1 = 0 : F2 = 0 : F3 = 0 : XM = 0 : YM = 0
For X = 1 To Nz : XM = XM + V1(X) : YM = YM + V2(X) : Next X
XM = XM / Nz : YM = YM / Nz
For X = 1 To Nz : F1 = F1 + (V1(X) - XM) * (V2(X) - YM) F2 = F2 + (V1(X) - XM) ^2 : F3 = F3 + (V2(X) - YM) ^ 2
Next X
F1 = F1 / Nz : F2 = F2 / Nz : F3 = F3 / Nz
If F2 = 0 Or F3 = 0 Then R = 0 : Return
R = 100 * F1 / Sqr(F2 * F3) ‘the r of Pearson is multiplied by 100
Return
End Sub
</preformat></app><app id="app4" hwp:id="app-5"><label>Appendix 4:</label><title hwp:id="title-21">successive elaboration of the GW6 output array Cm(I, X)</title><preformat preformat-type="dialog" position="float" orientation="portrait" xml:space="preserve" hwp:id="preformat-4">
Private Sub FinalElab()
Dim Bs(100) As Single, B1 As Single, B2 As Single, C As Integer, J As Integer,
Dim X As Integer, I As Integer
'The array Sync1(X) and Sync2(C, X) should be defined in the Option Explicit section of VB6
'Nt = 91 is defined in the previous routine, this variable should be declared in Option Explicit B1= 128 : B2 = B1+ 128 : N1 = 384
'the values B1 and B2 are the definition of the zone for balanced baseline calculation
'in particular, the first zone is the pre-stimulus (from X=1 to B1, a second zone is
'the post-stimulus zone, it is important for good results to calculate baseline from both zones.
'each element of the array Sync1(X) and Sync2(C,X) are put to zero
For X = 1 To N1 : Sync1(X) = 0 : Next X
For C = 1 To NC
    For X = 1 To N1 : Sync2(C, X) = 0 : Next X
Next C
For J = 1 To Nt : Bs(J)=0 : A=0
   For X = 1 To B1 : A = A + 1 : Bs(J) = Bs(J) + Cm(J, X) : Next X
   For X = B2 To N1 : A = A + 1 : Bs(j) = Bs(J) + Cm(J, X) : Next X
   Bs(J) = Bs(J) / A ' baseline for each combination
Next J
For J = 1 To Nt
  For X = 1 To N1 : Sync1(X) = Sync1(X) + Abs(Cm(J, X) - Bs(J)) : Next X
Next J
For X = 1 To N1 : Sync1(X) = Sync1(X) / Nt : Next X
'Now the array Sync1(X) is the average (global average) of Correlation in all the Nt combinations
'and for all the Ns number of ERPs
'Calculus of the array Sync2(C, X) for each channel
I = 0
For Ax = 1 To (NC – 1)
    For Bx = (Ax + 1) To NC
      I = I + 1 'counter of all the combinations of the channels
      For U = 1 To NC
     If (U = X) Or (U = Bx) Then
          For X = 1 To N1 : Sync2(U, X) = Sync2(U, X) + Abs(Cm(J, X) – Bs(J)) : Next X
     End If
     Next U
  Next Bx
Next Ax
For C = 1 To NC
    For X = 1 To N1 : Sync2(C, X) = Sync2(C, X) / (NC-1) : Next X
Next C
'Now the array Sync2(C, X) is the Correlation for each channel.
'Each channel is the average of (NC-1) data.
End Sub
</preformat></app><app id="app5" hwp:id="app-6"><label>Appendix 5:</label><title hwp:id="title-22">classic calculus of ERP by simple averaging, from the array W(C, X, J)</title><preformat preformat-type="dialog" position="float" orientation="portrait" xml:space="preserve" hwp:id="preformat-5">
Private Sub ClassicERP()
Dim J As Integer, C As Integer, X As Integer, K As Single
'The array Ev(C,X) should be declared in the Option Explicit section of VB6
For C = 1 To NC
  For X = 1 To N1 : Ev(C, X) = 0 : Next X
Next C
For J = 1 To Ns 'for all the stimuli
   For C = 1 To NC 'for all the chanels
       For X = 1 To N1 : Ev(C, X) = Ev(C, X) + W(C, X, J) : Next X
   Next C
Next J
For C = 1 To NC
   For X = 1 To N1 : Ev(C, X) = Ev(C, X) / Ns : Next X
Next C
'Now the array Ev(C, X) is the classic ERP ; this array could be also submitted to some low-pass
'filter like this here described: the value 0.5 is arbitrary, more higher, more lower-pass filtered.
K = 0.5
For C = 1 To NC : Ev(C, 0) = Ev(C, 1) : Ev(C, N1+1) = Ev(C, N1)
   For X = 1 To N1
   Ev(C, X) = (Ev(C, X) + K*Ev(C, X-1) + K*Ev(C, X + 1)) / (1 + 2*K)
  Next X
Next C
End Sub
</preformat></app><app id="app6" hwp:id="app-7"><label>Appendix 6:</label><title hwp:id="title-23">subtraction of the classic ERP from the array W(C, X, J)</title><p hwp:id="p-87">(described only for research purpose, this routine is not to be used normally with the GW6)</p><preformat preformat-type="dialog" position="float" orientation="portrait" xml:space="preserve" hwp:id="preformat-6">
Private Sub SWXX()
Dim X As Integer, J As Integer, C As Integer
'very simple routine to subtract the classic ERP component from the EEG data
For J = 1 To Ns 'all the erps
   For C = 1 To NC 'all the channels
       For X = 1 To N1 : W’(C, X, J) = W(C, X, J) - Ev(C, X) : Next X
   Next C
Next J
End Sub
</preformat></app></app-group></back></article>
