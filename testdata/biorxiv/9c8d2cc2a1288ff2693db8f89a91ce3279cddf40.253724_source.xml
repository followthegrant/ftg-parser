<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/253724</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;253724v3</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;253724</article-id><article-id pub-id-type="other" hwp:sub-type="slug">253724</article-id><article-id pub-id-type="other" hwp:sub-type="atom-slug">253724</article-id><article-id pub-id-type="other" hwp:sub-type="tag">253724</article-id><article-version>1.3</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Bioinformatics" hwp:journal="biorxiv"><subject>Bioinformatics</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">High-throughput microcolony growth analysis from suboptimal low-magnification micrographs</article-title></title-group><author-notes hwp:id="author-notes-1"><corresp id="cor1" hwp:id="corresp-1" hwp:rev-id="xref-corresp-1-1"><label>‡</label>Corresponding author: <email hwp:id="email-1">eugene.plavskin@nyu.edu</email></corresp><fn id="n1" fn-type="equal" hwp:id="fn-1" hwp:rev-id="xref-fn-1-1 xref-fn-1-2"><label>*</label><p hwp:id="p-1">These authors contributed equally to this work</p></fn></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" corresp="yes" hwp:id="contrib-1"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-6911-3009</contrib-id><name name-style="western" hwp:sortable="Plavskin Yevgeniy"><surname>Plavskin</surname><given-names>Yevgeniy</given-names></name><xref ref-type="fn" rid="n1" hwp:id="xref-fn-1-1" hwp:rel-id="fn-1">*</xref><xref ref-type="corresp" rid="cor1" hwp:id="xref-corresp-1-1" hwp:rel-id="corresp-1">‡</xref><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-1" hwp:rel-id="aff-2">2</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0002-6911-3009"/></contrib><contrib contrib-type="author" hwp:id="contrib-2"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-4658-9765</contrib-id><name name-style="western" hwp:sortable="Li Shuang"><surname>Li</surname><given-names>Shuang</given-names></name><xref ref-type="fn" rid="n1" hwp:id="xref-fn-1-2" hwp:rel-id="fn-1">*</xref><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-2" hwp:rel-id="aff-2">2</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0003-4658-9765"/></contrib><contrib contrib-type="author" hwp:id="contrib-3"><name name-style="western" hwp:sortable="Jung Hyun"><surname>Jung</surname><given-names>Hyun</given-names></name><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-1" hwp:rel-id="aff-3">3</xref></contrib><contrib contrib-type="author" hwp:id="contrib-4"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-0873-6920</contrib-id><name name-style="western" hwp:sortable="Sartori Federica M. O."><surname>Sartori</surname><given-names>Federica M. O.</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-3" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-3" hwp:rel-id="aff-2">2</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0003-0873-6920"/></contrib><contrib contrib-type="author" hwp:id="contrib-5"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-2866-9526</contrib-id><name name-style="western" hwp:sortable="Buzby Cassandra"><surname>Buzby</surname><given-names>Cassandra</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-4" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-4" hwp:rel-id="aff-2">2</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0003-2866-9526"/></contrib><contrib contrib-type="author" hwp:id="contrib-6"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-6158-2732</contrib-id><name name-style="western" hwp:sortable="Müller Heiko"><surname>Müller</surname><given-names>Heiko</given-names></name><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-2" hwp:rel-id="aff-3">3</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0002-6158-2732"/></contrib><contrib contrib-type="author" hwp:id="contrib-7"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-1299-5335</contrib-id><name name-style="western" hwp:sortable="Ziv Naomi"><surname>Ziv</surname><given-names>Naomi</given-names></name><xref ref-type="aff" rid="a4" hwp:id="xref-aff-4-1" hwp:rel-id="aff-4">4</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0003-1299-5335"/></contrib><contrib contrib-type="author" hwp:id="contrib-8"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-0923-1636</contrib-id><name name-style="western" hwp:sortable="Levy Sasha F."><surname>Levy</surname><given-names>Sasha F.</given-names></name><xref ref-type="aff" rid="a5" hwp:id="xref-aff-5-1" hwp:rel-id="aff-5">5</xref><xref ref-type="aff" rid="a6" hwp:id="xref-aff-6-1" hwp:rel-id="aff-6">6</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0002-0923-1636"/></contrib><contrib contrib-type="author" hwp:id="contrib-9"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-6930-2988</contrib-id><name name-style="western" hwp:sortable="Siegal Mark L."><surname>Siegal</surname><given-names>Mark L.</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-5" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-5" hwp:rel-id="aff-2">2</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0001-6930-2988"/></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2 xref-aff-1-3 xref-aff-1-4 xref-aff-1-5"><label>1</label><institution hwp:id="institution-1">Center for Genomics and Systems Biology, New York University</institution>, New York, 10003, <country>USA</country></aff><aff id="a2" hwp:id="aff-2" hwp:rev-id="xref-aff-2-1 xref-aff-2-2 xref-aff-2-3 xref-aff-2-4 xref-aff-2-5"><label>2</label><institution hwp:id="institution-2">Department of Biology, New York University</institution>, New York, 10003, <country>USA</country></aff><aff id="a3" hwp:id="aff-3" hwp:rev-id="xref-aff-3-1 xref-aff-3-2"><label>3</label><institution hwp:id="institution-3">Center for Data Science, New York University</institution>, New York, 10003, <country>USA</country></aff><aff id="a4" hwp:id="aff-4" hwp:rev-id="xref-aff-4-1"><label>4</label><institution hwp:id="institution-4">Department of Microbiology and Immunology, University of California</institution>, San Francisco, California, 94158, <country>USA</country></aff><aff id="a5" hwp:id="aff-5" hwp:rev-id="xref-aff-5-1"><label>5</label><institution hwp:id="institution-5">Joint Initiative for Metrology in Biology</institution>, Stanford, California, 94305, <country>USA</country></aff><aff id="a6" hwp:id="aff-6" hwp:rev-id="xref-aff-6-1"><label>6</label><institution hwp:id="institution-6">SLAC National Accelerator Lab</institution>, Menlo Park, California 94025, <country>USA</country></aff></contrib-group><pub-date pub-type="epub-original" date-type="pub" publication-format="electronic" hwp:start="2021"><year>2021</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2018-01-25T00:57:15-08:00">
    <day>25</day><month>1</month><year>2018</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2021-06-21T14:03:13-07:00">
    <day>21</day><month>6</month><year>2021</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2018-01-25T01:04:11-08:00">
    <day>25</day><month>1</month><year>2018</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2021-06-21T14:08:02-07:00">
    <day>21</day><month>6</month><year>2021</year>
  </pub-date><elocation-id>253724</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2018-01-24"><day>24</day><month>1</month><year>2018</year></date>
<date date-type="rev-recd" hwp:start="2021-06-20"><day>20</day><month>6</month><year>2021</year></date>
<date date-type="accepted" hwp:start="2021-06-21"><day>21</day><month>6</month><year>2021</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2021, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2021</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/" hwp:id="license-1"><p hwp:id="p-2">This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" hwp:id="ext-link-1">http://creativecommons.org/licenses/by/4.0/</ext-link></p></license></permissions><self-uri xlink:href="253724.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/change-list" xlink:role="change-list" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2021/pdf/253724v3.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="253724.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2021/abstracts/253724v3/253724v3.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2021/fulltext/253724v3/253724v3.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><p hwp:id="p-3">New technological advances have enabled high-throughput phenotyping at the single-cell level, yet analyzing the large amount of data generated by high throughput phenotyping experiments automatically and accurately is a considerable challenge. Here we introduce Processing Images Easily (PIE), software that automatically tracks growth of microbial colonies in low-magnification brightfield images by combining adaptive object-center recognition with gradient-based object-outline recognition. PIE recognizes colony outlines very robustly and accurately across a wide range of image brightnesses, focal depths, and organisms. Beyond accurate colony recognition, PIE is designed to easily integrate with complex experiments, allowing colony tracking across multiple experimental phases and classification based on fluorescence intensity. We show that PIE can be used to accurately measure the growth rates of large numbers (&gt;90,000) of bacterial or yeast microcolonies in a single-time-lapse experiment, allowing calculation of population-wide growth properties. Finally, PIE is able to track individual colonies across multiple experimental phases, measuring both growth and fluorescence properties of the microcolonies.</p><sec hwp:id="sec-1"><title hwp:id="title-2">Author Summary</title><p hwp:id="p-4">High-throughput microscopy has enabled automated collection of large amounts of growth and gene-expression data in microbes. Computational methods that can precisely recognize and track organisms in images are essential to performing measurements at scale using automated microscopy. We have developed PIE, software that automatically recognizes microbial colonies in microscopy images, tracks them in imaging time-series, and performs measurements of growth and, potentially, gene expression. PIE is highly effective on low-resolution images, outperforming current state-of-the-art approaches in both speed and accuracy, and works well in microbes of varying shapes and sizes. In addition, PIE allows tracking microcolonies across arbitrary sequences of experimental phases, each collecting data in different modalities. We show that PIE allows measurement of growth and fluorescence properties in tens of thousands of microbial colonies in a single experiment, and that in turn the scale of these measurements can lead to important insights about interindividual differences in growth and stress response. PIE is available as a Python package (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://doi.org/10.5281/zenodo.4987127" ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.4987127" hwp:id="ext-link-2">https://doi.org/10.5281/zenodo.4987127</ext-link>) with documentation currently at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://pie-image.readthedocs.io/" ext-link-type="uri" xlink:href="https://pie-image.readthedocs.io/" hwp:id="ext-link-3">https://pie-image.readthedocs.io/</ext-link>; users can also run analysis on individual images or time-series without the need to install PIE by using our web application, currently available at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://pie.hpc.nyu.edu/" ext-link-type="uri" xlink:href="http://pie.hpc.nyu.edu/" hwp:id="ext-link-4">http://pie.hpc.nyu.edu/</ext-link>.</p></sec></abstract><counts><page-count count="36"/></counts><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-1">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta><notes hwp:id="notes-1"><notes notes-type="competing-interest-statement" hwp:id="notes-2"><title hwp:id="title-3">Competing Interest Statement</title><p hwp:id="p-5">The authors have declared no competing interest.</p></notes><fn-group content-type="summary-of-updates" hwp:id="fn-group-1"><title hwp:id="title-4">Summary of Updates:</title><fn fn-type="update" hwp:id="fn-2"><p hwp:id="p-6">Software has been re-written and updated to include microcolony tracking in time-series and analysis of microcolony colony growth, with the help of additional authors, and links to software, documentation, and web application have been included; benchmarking has been performed against published algorithms; examples of colony recognition in diverse microbes have been added; examples of experiments tracking microbial growth across time and in multiple experimental stages, as well as fluorescence-based classification, have been added.</p></fn></fn-group></notes></front><body><sec id="s1" hwp:id="sec-2"><title hwp:id="title-5">Introduction</title><p hwp:id="p-7">The development of new technologies for high-throughput phenotyping has allowed increasingly precise measurements of many traits through vastly increased sample sizes, as well as the ability to explore previously intractable traits, such as the extent to which genetically identical individuals raised in the same environment vary [<xref rid="c1" ref-type="bibr" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">1</xref>]. Automated microscopy of immobilized organisms can produce large amounts of data on cell shape, internal structure, and growth patterns [<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">2</xref>–<xref rid="c4" ref-type="bibr" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">4</xref>]. However, subsequent data analysis often presents a significant challenge, as machine-vision approaches must be applied to automatically extract useful data from the large number of images created.</p><p hwp:id="p-8">One particularly important phenotype is the rate of cell growth. In multicellular organisms, cell growth is key to normal development and to disease processes such as tumorigenesis. In microbes, growth rate is closely related to fitness. High-throughput imaging allows population growth rate to be measured as a function of the growth of individual colonies [<xref rid="c5" ref-type="bibr" hwp:id="xref-ref-5-1" hwp:rel-id="ref-5">5</xref>] or microcolonies (e.g. [<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-2" hwp:rel-id="ref-2">2</xref>,<xref rid="c6" ref-type="bibr" hwp:id="xref-ref-6-1" hwp:rel-id="ref-6">6</xref>–<xref rid="c9" ref-type="bibr" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">9</xref>]) or the growth and division times of individual cells (e.g. [<xref rid="c10" ref-type="bibr" hwp:id="xref-ref-10-1" hwp:rel-id="ref-10">10</xref>–<xref rid="c12" ref-type="bibr" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">12</xref>]) rather than a single population-wide average. Individual measurements, in turn, allow exploration of important properties of the growth-rate distribution within a population, such as dispersion and skewness. For example, in the budding yeast <italic toggle="yes">Saccharomyces cerevisiae</italic>, the distribution of microcolony growth rates differs among strains and tends to have a heavy tail of slower-growing microcolonies [<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-3" hwp:rel-id="ref-2">2</xref>,<xref rid="c8" ref-type="bibr" hwp:id="xref-ref-8-1" hwp:rel-id="ref-8">8</xref>,<xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">13</xref>]. Heterogeneity is especially well-measured in microcolony approaches because of the small number of cells per colony and the large scale of experiments possible.</p><p hwp:id="p-9">To automatically measure microcolony growth rates from microscope-based images, two computational problems need to be solved: recognition of colonies and tracking of colonies through subsequent time points. Brightfield microscopy requires the least specialized equipment (unlike e.g. phase-contrast microscopy) and no specially marked strains (unlike fluorescent microscopy), but segmentation of cells and microcolonies can often be most difficult from brightfield images. CellProfiler identifies, segments, and tracks cells in images (Carpenter et al., 2006). However, optimization of object-recognition algorithm parameters for CellProfiler can make this approach time consuming to customize and test for each application. Dedicated software exists that addresses the problem of cell recognition in brightfield images (e.g. YeastSpotter for <italic toggle="yes">S. cerevisae</italic>, Cellpose for diverse cell types [<xref rid="c14" ref-type="bibr" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">14</xref>,<xref rid="c15" ref-type="bibr" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">15</xref>]), but these applications do not allow for tracking microcolonies across time, and were trained primarily on high-resolution micrographs, potentially limiting their effectiveness on lower-resolution images.</p><p hwp:id="p-10">We aimed to develop a method to perform automated recognition and tracking of brightfield microbial microcolonies. Such a method must be robust to imaging variation both across and within experiments, needs to allow flexibility in experimental setup, and ideally would be easily adaptable to different species. Here, we introduce Processing Images Easily (PIE), an algorithm for tracking growing microbial microcolonies in low-resolution brightfield and phase-contrast images. Our image-processing procedure combines adaptive object-center recognition based on relative brightness with gradient-based object-outline recognition, resulting in a high level of robustness to image brightness and focal depth while minimizing the number of user-supplied parameters. PIE’s colony tracking is both more robust and &gt;10x faster than previously published methods, allowing for fast, accurate colony tracking from large-scale microscopy experiments.</p><p hwp:id="p-11">The colony-tracking procedure then joins tracked colonies across sequential time points, and calculates growth rates and pre-growth lag times, as well as simultaneous tracking of other colony properties (e.g. fluorescence) over time. We show that PIE can be used to collect data on the distributions of growth parameters across entire populations of cells in microbial species with diverse cell shapes and sizes. Finally, we provide an example of using PIE to track microcolony growth and fluorescence across multiple phases of an experiment, allowing properties of tens of thousands of individual microcolonies to be measured before and after administration of a stress.</p></sec><sec id="s2" hwp:id="sec-3"><title hwp:id="title-6">Results</title><sec id="s2a" hwp:id="sec-4"><title hwp:id="title-7">Software implementation</title><sec id="s2a1" hwp:id="sec-5"><title hwp:id="title-8">Procedure Overview</title><p hwp:id="p-12">The growth-rate measurement algorithm described here consists of two stages: colony recognition, followed by colony tracking through time series (or sequential phases). Key colony parameters for each time point are recorded for growth-rate estimation and downstream analyses.</p><p hwp:id="p-13">Colony recognition is divided into three substages (<bold><xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Fig 1</xref></bold>). First, an automated threshold on relative image brightness identifies ‘cell center’ objects within an image. Next, the image is split into ‘gradient change’ objects whose edges coincide with gradient direction changes in the image. Finally, each colony is identified as the union of contiguous gradient-change objects overlapping a cell center. An optional recursive ‘cleanup’ step removes spurious gradient-change objects that result from brightness fluctuations in the backgrounds of some images.</p><fig id="fig1" position="float" fig-type="figure" orientation="portrait" hwp:id="F1" hwp:rev-id="xref-fig-1-1 xref-fig-1-2 xref-fig-1-3 xref-fig-1-4 xref-fig-1-5 xref-fig-1-6 xref-fig-1-7 xref-fig-1-8 xref-fig-1-9 xref-fig-1-10 xref-fig-1-11"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;253724v3/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Fig 1.</label><caption hwp:id="caption-1"><title hwp:id="title-9">Steps of colony recognition by Processing Images Easily (PIE).</title><p hwp:id="p-14">(A) Raw brightfield image. To display each colony object clearly, only a representative part of the image is shown; scale bar is 10 µm. (B) Top-hat filtered image. (C) Smoothed log-frequency histogram of the top-hat image with its two-Gaussian fit. Vertical axis is the density of the log frequencies of pixel intensities. Blue solid curve shows the smoothed log-frequency histogram of the top-hat image; green dashed curves are the two Gaussian fits; red solid curve is the fit combining the two Gaussians; purple vertical line is the automatically calculated threshold for cell centers in the top-hat image. (D) Cell centers after thresholding the top-hat image. (E) Combination of four gradient-changes of the raw brightfield image. Four gradient-changes are: decreasing in x (left-to-right) and increasing in y (top-to-bottom) (quadrant I, light blue); increasing in x and increasing in y (quadrant II, purple); increasing in x and decreasing in y (quadrant III, yellow); and decreasing in x and decreasing in y (quadrant IV, dark blue). (F) Gradient-change objects from (E) that overlap with cell centers (arrowheads) from (D). Color code is the same as in (E). (G) Segmentation (yellow shading and lines) of final colony objects recognized by PIE overlaid on raw brightfield image.</p></caption><graphic xlink:href="253724v3_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig><p hwp:id="p-15">During the colony tracking stage (<bold><xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-1" hwp:rel-id="F2">Fig 2</xref></bold>), sequential pairs of images are aligned, and colonies are tracked forward through time to identify which colony or colonies in a preceding time point’s image spatially overlap with each colony in the current time point’s image [<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-4" hwp:rel-id="ref-2">2</xref>]. Colony fusion and splitting events are identified. In the case of fusion, tracking ends for both fused colonies. In the case of splitting, colony areas are calculated by including both the major colony and the components that have split off. After tracking colony identities between images, colony areas and other properties called for by the experiment (e.g. colony fluorescence level in corresponding fluorescent-channel images) are then recorded for each time point.</p><fig id="fig2" position="float" fig-type="figure" orientation="portrait" hwp:id="F2" hwp:rev-id="xref-fig-2-1 xref-fig-2-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;253724v3/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Figure 2.</label><caption hwp:id="caption-2"><title hwp:id="title-10">Colony tracking algorithm.</title><p hwp:id="p-16">(A-B) Two images of the same position from sequential time points, time point 1 and time point 2 (tp1 and tp2), with numbered recognized colonies in each. Note that the colonies are not perfectly aligned between these two images (top left). (C) The optimal affine transformation (translation + rotation) between the images in tp1 and tp2 is found, and tp1 colony positions are transformed to align them with tp2 colonies (shown in the image are tp1 colony outlines and centers overlaid on tp2 image; original positions are in faint colors, tp2-registered positions are in bright colors.) (D) Overlaps between each colony’s bounding boxes from tp1 and tp2 are calculated; colony centers indicated as crosses. (E) Matches are tabulated for any colony whose center in one time point is within the bounding box of a colony from the other time point. Note the ‘split’ event, in which a colony from tp1 (colony 2) matches two colonies in tp2 (colonies 14, 15); of these, only the largest will continue to be followed as the “main” colony. Also note the ‘merge’ event, in which two colonies in tp1 (colonies 6, 7) match a single colony in tp2 (19). Note that some colonies may remain unmatched (e.g. colony 12 in tp2, top left). (F) Any colonies with no match to the previous timepoint (including smaller colonies in split events) are assigned as ‘satellites’ to their larger ‘parent’ colony if their center falls within a size-dependent radius around a matched colony, as detailed in the text (here, colony 14 becomes counted as part of colony 15 for purposes of future tracking and area calculation). (G) Any colonies resulting from a merge (and their satellites) are removed from tp2 (here, colony 19 has been removed) (H) Identities of any matched colonies are propagated from tp1 to tp2, and the process is repeated between tp2 and the subsequent time point. Scale bar is 10 µm.</p></caption><graphic xlink:href="253724v3_fig2" position="float" orientation="portrait" hwp:id="graphic-2"/></fig></sec><sec id="s2a2" hwp:id="sec-6"><title hwp:id="title-11">Cell center recognition</title><p hwp:id="p-17">Cell centers are recognized by identifying an appropriate intensity threshold on a locally background-corrected image. An original image (<bold><xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-2" hwp:rel-id="F1">Fig 1A</xref></bold>) is first subjected to a top-hat filter [<xref rid="c16" ref-type="bibr" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">16</xref>] to correct for uneven illumination, thereby reducing background and making it more uniform while preserving the brightest parts of the image, which correspond to cell bodies (<bold><xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-3" hwp:rel-id="F1">Fig 1B</xref></bold>). The appropriate threshold for cell-center recognition is identified using a smoothed histogram representing the log frequencies of pixel intensities of the top-hat-filtered image. Where possible, the histogram bin centers are set to the unique pixel intensity values in the image. However, if the number of unique pixel intensity values exceeds a heuristic image size-dependent value, evenly spaced bins are used. In this case, a bin number is selected such that there are no peaks in the log frequency histogram autocorrelation (this autocorrelation check is necessary to avoid the poor and discontinuous binning that often results from using evenly spaced bins on images). The log-frequency histogram is then smoothed by applying the Savitzky-Golay filter [<xref rid="c17" ref-type="bibr" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">17</xref>], which fits successive windows of adjacent data points to low-degree polynomials. This step eliminates small spiky peaks of the histogram, which would otherwise introduce error in threshold selection.</p><p hwp:id="p-18">In a typical brightfield image of cells, the smoothed log-frequency histogram of the top-hat image resembles a truncated mixture of two Gaussian curves (<bold><xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-4" hwp:rel-id="F1">Fig 1C</xref></bold>): one Gaussian curve corresponds to background pixels, which have lower pixel intensities, and one corresponds to bright cell bodies, which have higher pixel intensities. A good threshold to capture cell centers will sit in between the peaks of the two Gaussian curves. (In rare cases, phase-contrast images require three Gaussians to be fit, and users can select to perform thresholding this way; in that case, the ideal threshold rests between the peaks of the first and second Gaussian.) Because cell bodies appear as an intensity gradient, with the center being the brightest, and because cell outline recognition does not depend on the exact outline of the cell center detected here, a range of thresholds will produce satisfactory results.</p><p hwp:id="p-19">Automated threshold identification is implemented on the smoothed log-frequency histogram of the top-hat image by one of two methods: by either fitting a mixture of Gaussians or applying a sliding circle to identify the peak-separating threshold. Our algorithm first attempts to fit a mixture of Gaussians to the smoothed log-frequency histogram of the top-hat image (<bold><xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-5" hwp:rel-id="F1">Fig 1C</xref>, red curve</bold>). The smoothed log-frequency histogram of the top-hat image is first fit, by non-linear least squares, to a two- (or three-)Gaussian mixture model with one Gaussian constrained to have mean greater than 0. A number of log-frequency histogram quality controls and the starting parameter values of the distribution fitting are important to achieve this initial good fit, and are described in detail in the PIE code.</p><p hwp:id="p-20">In all test images tried, the approach described above resulted in a good fit of the curve to the smoothed log-frequency histogram (adjusted R<sup>2</sup> &gt; 0.85), producing an acceptable threshold value. However, it is possible that this method would fail to produce a satisfactory fit in images in which the pixel intensity distribution differed drastically from our test images. To prevent thresholding failure in unforeseen imaging conditions, we have built in alternatives to capture the pixel distributions possible with a two-Gaussian fit. As described in <bold><xref ref-type="fig" rid="figS1" hwp:id="xref-fig-8-1" hwp:rel-id="F8">S1</xref>-<xref ref-type="fig" rid="figS2" hwp:id="xref-fig-9-1" hwp:rel-id="F9">S2 Figs</xref></bold>, these alternate approaches are tried sequentially by PIE until a satisfactory fit to the smoothed log-frequency histogram is found. If all the Gaussian fitting methods fail to produce a satisfactory fit, a more time-consuming sliding-circle approach is used to identify a threshold separating the peak representing background pixels from the one representing bright cell center pixels.</p><p hwp:id="p-21">To identify cell centers, the determined threshold is applied to the top-hat-filtered image (<bold><xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-6" hwp:rel-id="F1">Fig 1D</xref></bold>), resulting in a binary mask that mostly corresponds to the central regions of cells.</p></sec><sec id="s2a3" hwp:id="sec-7"><title hwp:id="title-12">Colony outline recognition</title><p hwp:id="p-22">To detect colony outlines, PIE uses a gradient-based approach that is robust to differences in image brightness and, to some degree, image focal position. We first divide images into objects whose outlines correspond to shifts in gradient direction. Objects that do not overlap the cell centers identified above are then removed, leaving microcolony objects.</p><p hwp:id="p-23">To split the image based on gradient direction, a Sobel gradient filter [<xref rid="c16" ref-type="bibr" hwp:id="xref-ref-16-2" hwp:rel-id="ref-16">16</xref>] is applied to the image separately in the x and y directions; a threshold of 0 is then applied to the negative and positive versions of each of the gradient images, and pairs of resulting images are multiplied elementwise. The result is a set of four binary images, with objects representing each possible combination of gradient directions in each image: increasing in x and increasing in y, increasing in x and decreasing in y, decreasing in x and increasing in y, and decreasing in x and decreasing in y. For an object with a bright center and a dark outline, such as a slightly defocused image of a cell, this procedure results in objects in four quadrants resembling pie pieces (<bold><xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-7" hwp:rel-id="F1">Fig 1E</xref></bold>). To identify these pie-piece-shaped objects belonging to cells, any objects not overlapping a cell center identified in the previous section are removed (<bold><xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-8" hwp:rel-id="F1">Fig 1F</xref></bold>). This leaves only those objects that belong to cells. Contiguous “pie piece” quadrants are then merged into colony objects; as a result, any cells that are touching are considered to be part of a single colony (such as the mother cell and bud cell on the bottom left of <bold><xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-9" hwp:rel-id="F1">Fig 1F</xref></bold>). Internal holes smaller than an optional user-specified parameter are filled to create the final colony objects (<bold><xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-10" hwp:rel-id="F1">Fig 1G</xref></bold>).</p><p hwp:id="p-24">We find that in some imaging routines, microcolonies are surrounded by bright areas of background. The cell center-finding algorithm described above identifies the cell-adjacent bright background regions as cell centers, and as a result, pie pieces in the background are incorrectly identified as microcolonies. Our procedure allows for an optional recursive ‘<italic toggle="yes">cleanup</italic>’ procedure for sets of images in which this problem occurs frequently (<bold><xref ref-type="fig" rid="figS3" hwp:id="xref-fig-10-1" hwp:rel-id="F10">S3A Fig</xref></bold>). This cleanup is optional because it substantially extends runtimes and could result in inconsistent tracking of small cells, especially at early time points (<bold><xref ref-type="fig" rid="figS3" hwp:id="xref-fig-10-2" hwp:rel-id="F10">S3B Fig</xref></bold>).</p><p hwp:id="p-25">The cleanup procedure has two steps. The first step is based on the observation that, unlike most true pie pieces corresponding to cells, the spurious background pie pieces are often irregularly shaped and have long, exposed edges that are not in contact with neighboring pie pieces. The cleanup procedure takes advantage of this observation by removing any pie pieces for which the proportion of the perimeter pixels not in contact with another center-overlapping pie piece is less than 0.75 (although this value can be adjusted by the user). The second step in the cleanup procedure takes advantage of the fact that, for an object with a bright center and dark edges (such as a cell), the gradient should radiate from the center out, meaning that the pie pieces that compose the cell should be in a predictable arrangement. Specifically, a negative x gradient and positive y gradient in the upper right quadrant should neighbor a negative x gradient and negative y gradient in the bottom right quadrant, and a positive x gradient and positive y gradient in the upper left quadrant, etc (<bold><xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-11" hwp:rel-id="F1">Fig 1F</xref></bold>). Any center-overlapping pie pieces whose neighbors do not have the expected gradient direction are removed. The two cleanup steps are performed recursively, until no more pieces are removed.</p><p hwp:id="p-26">Finally, rare failures in thresholding (for example, in images with backgrounds consisting of two distinct intensities) can result in identification of a very large number of spurious colony objects, causing incorrect colony identification and taking up significant computational resources to analyze. PIE therefore removes any images in which the number of detected colonies exceeds an optional user-defined parameter, treating those images as blank.</p></sec><sec id="s2a4" hwp:id="sec-8"><title hwp:id="title-13">Fluorescence Measurements</title><p hwp:id="p-27">For any fluorescent channels, PIE reports the mean, median, and upper quartile of fluorescence values for each colony, as well as for the local ‘background’ area around the colony. To calculate fluorescence inside the colony, the binary colony mask is eroded with a circular structure element with a radius of 2 to make the mask slightly smaller than the recognized colony area. The eroded mask is then used to retrieve fluorescence intensity statistics from each channel. The use of an eroded mask makes fluorescence measurements more robust to slight errors in colony-outline recognition and to inconsistencies in fluorescence at cell edges. Although this approach would be problematic for fluorescent markers of the cell wall or cell membrane, the underlying scripts can be modified to include the eroded border pixels in the fluorescence calculation. PIE also reports the local background fluorescence in each channel, measured within an area of the colony bounding box (the smallest rectangle containing the identified colony) extended by 5 pixels in all four directions but outside of the colony area itself, or of any other colony within the extended bounding box. The resulting background mask is eroded with a disk structure element with a radius of 2 for the same reason as the colony mask. Reporting both colony and background fluorescence intensity values in this way allows the user to perform local colony background correction.</p></sec><sec id="s2a5" hwp:id="sec-9"><title hwp:id="title-14">Colony tracking through time and between experimental phases</title><p hwp:id="p-28">Colony tracking is summarized in <bold><xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-2" hwp:rel-id="F2">Fig 2</xref></bold>. Colony identities and properties, such as area, centroid, pixel-coordinate list and bounding box are processed for all images at a given imaging position. Brute force matching of colony centroid coordinates in sequential images is used to identify the ‘match’ candidate centroid locations from one image to the next; only those matches where the best-matched centroid is &lt; 0.75 times the distance to the second-best centroid are retained [<xref rid="c18" ref-type="bibr" hwp:id="xref-ref-18-1" hwp:rel-id="ref-18">18</xref>,<xref rid="c19" ref-type="bibr" hwp:id="xref-ref-19-1" hwp:rel-id="ref-19">19</xref>]. The resulting list of matching locations between sequential images is used to estimate a best-fit affine transform matrix. This matrix is then used to register the image at the first time point to the image at the subsequent time point, aligning the colony locations. This image registration is important because it allows colonies to continue to be tracked even if the imaging field shifts between two time points, which often happens as a result of microplate thermal expansion or when treatments are applied to the cells mid-experiment; however, users have the option of turning off image registration.</p><p hwp:id="p-29">After image registration, colonies are connected between sequential images. If the x and y distances between the centroids of two colonies in the current and the subsequent image are less than half the current or the subsequent bounding box width and height, then the two colonies are considered connected between these two time points. A colony may be connected to more than one colony in the previous image, meaning multiple colonies have merged; or one colony may split into several pieces, often creating ‘satellites’. All colonies that are connected to at least one other colony in a subsequent time point are classified as connected objects.</p><p hwp:id="p-30">Merging colonies are treated differently than splitting colonies. Upon colony merging, tracking stops; that is, only properties before merging are recorded. When a colony splits the largest colony in the later time point is selected as the tracked colony object. This selection helps sustain tracking if a cell or small number of cells breaks off from a larger colony. Untracked colonies (including the smaller fragments of a split colony) that are close to an existing tracked colony are declared ‘satellite’ colonies. In our experience, defining satellites as being closer than 70% of the tracked colony’s long axis length produces robust tracking [<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-5" hwp:rel-id="ref-2">2</xref>,<xref rid="c6" ref-type="bibr" hwp:id="xref-ref-6-2" hwp:rel-id="ref-6">6</xref>–<xref rid="c9" ref-type="bibr" hwp:id="xref-ref-9-2" hwp:rel-id="ref-9">9</xref>]. Importantly, merges between a satellite and its tracked parent colony do not result in a cessation of tracking, which means that PIE can continue tracking colonies when cells split off and land nearby, or when small colony recognition errors separate a single cell from its parent colony at a single timepoint.</p><p hwp:id="p-31">If a satellite colony is identified, its area is added to its corresponding tracked colony at that particular time point. All other properties, such as centroids and fluorescent intensities, are still determined only based on the corresponding tracked colony. For fluorescent intensities, satellites are not included because the risk of counting brightly autofluorescent debris as a satellite outweighs the benefit of having a small number of additional cells from which to measure a colony’s overall per-pixel fluorescence (e.g., by the mean, median or upper-quartile fluorescence). If the satellites of a split colony fail to be identified as such, a significant drop in apparent colony area over time might result. However, we apply an optional filter during the growth rate analysis step to remove colonies whose areas dip significantly in successive time points, thus eliminating any split colonies in which satellite assignment was not successful.</p></sec><sec id="s2a6" hwp:id="sec-10"><title hwp:id="title-15">Growth rate and lag calculation and data filtration</title><p hwp:id="p-32">Although the colony recognition in PIE is robust across a range of imaging conditions, colony tracking failures still occasionally occur with large amounts of data. As a result, we use user-defined parameters to perform a number of filtration steps before and after growth rate and lag calculation.</p><p hwp:id="p-33">First, PIE removes any tracked objects outside a range of acceptable colony area sizes that can be defined by the user based on knowledge of the study organism and imaging conditions. This filter can help prevent debris from being considered a colony. To remove colonies poorly tracked by PIE, user-defined filters can also be applied based on the maximum allowed decrease in pixel number and the maximum allowed fold decrease and increase in area between subsequent time points.</p><p hwp:id="p-34">Growth rates and lag durations in PIE are calculated using a sliding-window approach similar to the method previously described [<xref rid="c9" ref-type="bibr" hwp:id="xref-ref-9-3" hwp:rel-id="ref-9">9</xref>]. A user-defined parameter defines the number of time points to be used per growth-calculation window; a colony must be tracked at every time point within the window (i.e. time points in which the colony was filtered out for any of the reasons described above, or for which an image is missing, may not be part of the window). For each tracked colony, a linear model is fit to the log of colony areas as a function of time (in hours). The slope of this regression line is the growth rate for the window. The lag duration is estimated based on the intersection of the regression line with a horizontal line determined by the area of the microcolony at the first time point at which it is tracked; the time between this intersection point and the start of imaging is the lag for the window. Finally, the linear model’s coefficient of determination (R<sup>2</sup>) and the fold increase in area are recorded for each growth window.</p><p hwp:id="p-35">One growth window is chosen as the one from which the colony’s growth rate and lag duration are recorded. A growth window is removed from consideration if it fails to pass a minimum optional user-defined fold increase in area (which can be used to remove dead cells and debris from analysis), or if its R<sup>2</sup> value is below an optional user-defined threshold; we recommend care when applying this threshold, as it will result in exclusion of colonies with growth rates close to 0. For any colonies that still have multiple growth windows after these filters, the window corresponding to the largest growth rate is selected. This selection decreases the chance that reported growth rates and lags will be based on growth windows that include either the colony’s lag period or the period after which the colony ceases to grow in two dimensions, when the change in colony area no longer reflects the full growth rate.</p><p hwp:id="p-36">To prevent tracking of cells that come loose from existing colonies (but are not close enough to the parent colony to be counted as ‘satellites’), any colonies that do not appear in the first time point are removed. In addition, any colonies that are not tracked for a user-defined minimum of timepoints are optionally removed; this allows users to require colonies be tracked for longer than the number of time points used to calculate growth rate, or can serve to prevent transitory tracked objects from later resulting in removal of nearby objects due to minimal distance restrictions (see below).</p><p hwp:id="p-37">A final optional filter removes growth-rate measurement biases introduced by colony density. Fast-growing neighboring colonies are more likely to merge with each other early in the experiment (i.e. before sufficient time points are collected for a growth window) than slow-growing colonies, resulting in more slow-growing colonies being counted, especially when cells are densely plated [<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-6" hwp:rel-id="ref-2">2</xref>]. PIE therefore removes any colonies whose centroid falls within the user-provided minimum distance of another colony’s centroid at any point during the colony’s growth.</p></sec><sec id="s2a7" hwp:id="sec-11"><title hwp:id="title-16">Multiphase experiments</title><p hwp:id="p-38">PIE allows users to perform experiments in which microcolonies are tracked over multiple experimental phases, for example before and after a heat shock [<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-7" hwp:rel-id="ref-2">2</xref>,<xref rid="c7" ref-type="bibr" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">7</xref>]. Each phase is initially treated as a separate experiment, with microcolony properties (e.g. growth rates, lags, and fluorescence intensities) calculated independently; user-specified filtration parameters and imaging parameters (e.g. fluorescent channels) can all differ between experimental phases, although data must be collected from the same imaging x-y positions in all phases of the experiment. For each phase, PIE performs temporal tracking of each colony within the phase, and in addition tracks colonies from the final time point of each phase to the first time point of the subsequent phase (see “Colony tracking through time and between experimental phases”). Colonies are assigned both within-phase and cross-phase tracking IDs, and colony properties such as growth rate are reported for each colony in each phase in which it was tracked.</p></sec><sec id="s2a8" hwp:id="sec-12"><title hwp:id="title-17">Fluorescence-based classification</title><p hwp:id="p-39">PIE is also capable of supporting experiments in which multiple fluorescent protein-marked strains are co-cultured in a single well, allowing classification of colonies based on mean colony fluorescence intensity at a single time point after growth rate data are collected. Users can specify an experimental phase for classification that consists of fluorescent imaging and has a ‘linked’ growth-rate phase; the fluorescent images from the classification phase are used in conjunction with colony outlines detected in the linked phase to assign a fluorescence value to each colony in each imaged channel. Binary classification is then performed for all colonies in each fluorescence channel: after the brightest 0.01% of colonies are removed, PIE fits a bimodal logistic distribution to the colony fluorescence data. PIE next identifies two thresholds: a ‘background’ threshold, and a ‘fluorescent’ threshold; colonies below the background threshold are classified as fluorescence-negative, colonies above the fluorescent threshold are classified as fluorescence-positive, and colonies between the thresholds are not classified. Each threshold is selected in such a way that the proportion of colonies that are misidentified as ‘background’ or ‘fluorescent’ is ∼0.1%, assuming that colony fluorescence values are drawn from the two logistic distributions estimated earlier.</p></sec></sec><sec id="s2b" hwp:id="sec-13"><title hwp:id="title-18">Robust colony recognition across focal planes and illuminations</title><p hwp:id="p-40">To determine how accurately PIE recognizes microbes in low-resolution microscopy images, we first benchmarked the accuracy of PIE recognition of <italic toggle="yes">Saccharomyces cerevisiae</italic> microcolonies against three other approaches: a ‘naive’ approach consisting of automated ‘Maximum Entropy’ thresholding followed by a Hough Transform in Fiji [<xref rid="c20" ref-type="bibr" hwp:id="xref-ref-20-1" hwp:rel-id="ref-20">20</xref>–<xref rid="c22" ref-type="bibr" hwp:id="xref-ref-22-1" hwp:rel-id="ref-22">22</xref>], and two machine learning-based approaches: YeastSpotter, which was developed specifically for the task of detecting yeast cells in microscopy images [<xref rid="c14" ref-type="bibr" hwp:id="xref-ref-14-2" hwp:rel-id="ref-14">14</xref>], and CellPose, a general cell segmentation algorithm [<xref rid="c15" ref-type="bibr" hwp:id="xref-ref-15-2" hwp:rel-id="ref-15">15</xref>]. YeastSpotter and CellPose have both been shown to perform well on high-resolution cell images. We sought to determine whether these off-the-shelf approaches could robustly detect cells in low-resolution images, and to compare their performance to PIE’s. Colony recognition by all four methods was compared to a manually traced reference colony mask. To allow for direct comparisons between PIE (which recognizes microcolonies) and YeastSpotter and CellPose (which recognize individual cells and did not successfully segment multiple cells in large microcolonies in tested images), we benchmarked these methods on a set of microcolonies that had recently started growing and consisted primarily of one or two cells.</p><p hwp:id="p-41">In comparing these approaches, we are concerned with both the accuracy of a colony’s outline given that the colony has been recognized, as well as the accuracy of recognizing colony objects in the first place. We therefore use two measures commonly used in image recognition studies: Intersection over Union (IoU) (<bold>Materials and Methods, <xref ref-type="disp-formula" rid="eqn1" hwp:id="xref-disp-formula-1-1" hwp:rel-id="disp-formula-1">Eqtn 1</xref></bold>), which provides an estimate of the accuracy of colony outline recognition; and the F<sub>1</sub> score (<bold>Materials and Methods, <xref ref-type="disp-formula" rid="eqn2" hwp:id="xref-disp-formula-2-1" hwp:rel-id="disp-formula-2">Eqtn 2</xref></bold>), which reports the accuracy of recognizing colony objects. An optimal method will maximize both IoU and the F<sub>1</sub> score. We therefore assessed overall accuracy across a range of IoU thresholds, by eliminating colonies that did not surpass the threshold (those that overlapped insufficiently with the benchmarking reference) and then computing the F1 score for the remaining colonies.</p><p hwp:id="p-42">Assessing the F<sub>1</sub> score across a range of IoU cutoff values shows superior performance for PIE (<bold><xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-1" hwp:rel-id="F3">Fig 3A</xref></bold>). Although the Hough Transform-based and CellPose methods match more colonies than PIE at low IoU cutoff values, the number of matches swiftly decreases as the IoU requirement becomes more stringent. The reason for this decrease is apparent in <bold><xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-2" hwp:rel-id="F3">Fig 3C</xref></bold>, which shows recognition results for a small subset of colonies in our test image: both CellPose and the Hough Transform method fail to recognize the entire cell in the image, instead recognizing only a bright area near the cell center. YeastSpotter, on the other hand, tends to include additional area around the cell in its mask, and occasionally misses cells. PIE generally recognizes most colonies in the image with an accurate cell outline, as reflected in the high F<sub>1</sub> score across a wide range of IoU values.</p><fig id="fig3" position="float" fig-type="figure" orientation="portrait" hwp:id="F3" hwp:rev-id="xref-fig-3-1 xref-fig-3-2 xref-fig-3-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;253724v3/FIG3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F3</object-id><object-id pub-id-type="publisher-id">fig3</object-id><label>Fig 3.</label><caption hwp:id="caption-3"><title hwp:id="title-19">Benchmarking PIE performance on yeast cell recognition</title><p hwp:id="p-43">(A) PIE achieves a high accuracy of microcolony recognition (F<sub>1</sub> score) even at stringent requirements for accuracy of microcolony outline recognition (IoU); by contrast, the other methods only detect the majority of colonies with relaxed requirements for accuracy of microcolony outline recognition. (B) A subsection of the image used for benchmarking algorithms in (<italic toggle="yes">A</italic>) and (<italic toggle="yes">C</italic>). (C) Performance of the four algorithms overlaid on the image shown in (<italic toggle="yes">B</italic>). PIE accurately identified microcolony outlines; YeastSpotter failed to identify some colonies, and generally determined the cell outline to be outside of the bounds of the microcolony, resulting in low IoU values for many cells. While CellPose and Hough Transform methods detected most microcolonies, microcolony outline recognition is very poor, with the methods primarily recognizing a small region in the center of the cells. Scale bar is 10 µm.</p></caption><graphic xlink:href="253724v3_fig3" position="float" orientation="portrait" hwp:id="graphic-3"/></fig><p hwp:id="p-44">For images acquired by high-throughput microscopy, focal and illumination differences are prevalent within a single experiment. For example, in experiments in which microbes are imaged in a glass-bottom microplate [<xref rid="c23" ref-type="bibr" hwp:id="xref-ref-23-1" hwp:rel-id="ref-23">23</xref>], focal-plane variation exists across the plate and even within one well or field. In addition, illumination of the fields in a well’s center is more uniform than in its corners. Illumination unevenness also exists within single imaging fields, both spatially and temporally. It is therefore critical that an effective image-analysis algorithm should be able to: 1) identify objects even under non-optimal focus or brightness, and 2) perform consistent recognition and measurement of the same object across a range of focal planes and illuminations.</p><p hwp:id="p-45">To assess the degree to which PIE is robust to this technical noise in colony measurements associated with variability in image illumination and focal plane, we compared the accuracy of microcolony outline recognition (IoU) by PIE and the other cell recognition methods across a range of illumination levels and focal planes of the same imaging position. PIE not only performed consistently in colony identification across both a wide range of focal planes (∼7 µm, equivalent to ∼2 cell diameters) and image brightnesses, but also accurately identified virtually all colonies within the images (<bold><xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-1" hwp:rel-id="F4">Fig 4</xref></bold>). The other methods displayed lower accuracy in colony recognition than PIE at most focal planes and all exposure times tested.</p><fig id="fig4" position="float" fig-type="figure" orientation="portrait" hwp:id="F4" hwp:rev-id="xref-fig-4-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;253724v3/FIG4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F4</object-id><object-id pub-id-type="publisher-id">fig4</object-id><label>Fig 4.</label><caption hwp:id="caption-4"><title hwp:id="title-20">PIE performance across focal plane and illumination conditions</title><p hwp:id="p-46">(A-B) Median IoU values across a range of focal planes (<italic toggle="yes">A</italic>) and exposure values (<italic toggle="yes">B)</italic>, with corresponding images of PIE-generated colony outlines for a representative portion of the image tested, (C) and (D) respectively. The top panel of C and D shows the original image, and the bottom panel shows the image with PIE segmentation overlaid. PIE consistently maintains accurate colony outline recognition in highly underexposed or overexposed images. Although the precise outline detected by PIE varies somewhat across focal planes, PIE detects colonies with an IoU of &gt;0.7 across ∼2 cell diameters’ range of focal planes. Note that the middle panel in (C) and (D) (0.0 µm, 12 ms) is identical to the PIE panel in <bold><xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-3" hwp:rel-id="F3">Fig 3B</xref></bold>, and included only for ease of comparison. Scale bar is 10 µm.</p></caption><graphic xlink:href="253724v3_fig4" position="float" orientation="portrait" hwp:id="graphic-4"/></fig><p hwp:id="p-47">Finally, PIE is significantly faster than alternative methods. We benchmarked average image processing speed on a CPU for PIE against YeastSpotter and CellPose. Average time to analyze a single 5.5-megapixel image on an Intel Platinum 8268 CPU with 8 Gb RAM was 205 seconds using CellPose, 24 seconds using YeastSpotter, and 2 seconds for PIE (13 when PIE was run with cleanup).</p><p hwp:id="p-48">We have demonstrated that PIE performs yeast cell recognition more accurately than a ‘naive’ approach with commonly used image analysis software, and both more accurately and significantly faster than two existing deep learning-based approaches trained on high-resolution cell images. PIE-based image recognition is also robust to variation in image brightness and focal plane, making it applicable to real-world high-throughput imaging applications.</p></sec><sec id="s2c" hwp:id="sec-14"><title hwp:id="title-21">PIE allows population-level measurements of growth properties in diverse microbes</title><p hwp:id="p-49">We next assessed the effectiveness of PIE in recognizing growing microcolonies from a wide range of organisms and microscopy platforms. We ran PIE on images of large <italic toggle="yes">S. cerevisiae</italic> microcolonies, as well as either microcolonies or individual cells (for non-colonial microbes) of six additional species: a fungus (<italic toggle="yes">Schizosaccharomyces pombe</italic>), two protists (<italic toggle="yes">Seminavis robusta</italic> and <italic toggle="yes">Trichomonas vaginalis</italic>), a green alga (<italic toggle="yes">Chlorella sorokiniana</italic>) and three bacteria (<italic toggle="yes">Escherichia coli, Pseudomonas aeruginosa</italic>, and <italic toggle="yes">Staphylococcus aureus</italic>) (<bold><xref rid="fig5" ref-type="fig" hwp:id="xref-fig-5-1" hwp:rel-id="F5">Fig 5</xref></bold>). Colony outlines of all seven are effectively recognized, indicating that PIE can be used for automated cell or microcolony recognition in high-throughput experiments across a wide range of microbes.</p><fig id="fig5" position="float" fig-type="figure" orientation="portrait" hwp:id="F5" hwp:rev-id="xref-fig-5-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;253724v3/FIG5</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F5</object-id><object-id pub-id-type="publisher-id">fig5</object-id><label>Figure 5.</label><caption hwp:id="caption-5"><title hwp:id="title-22">PIE successfully recognizes cell or microcolony outlines across a wide range of microbes.</title><p hwp:id="p-50">(A-B) Brightfield images of <italic toggle="yes">S. cerevisiae</italic> and <italic toggle="yes">S. pombe</italic> microcolonies, respectively. (C-D) Brightfield images of individuals of <italic toggle="yes">S. robusta and T. vaginalis</italic>, respectively (E) Brightfield image of <italic toggle="yes">Chlorella sorokiniana</italic> microcolony (F) Phase-contrast image of co-cultured microcolonies of <italic toggle="yes">P. aeruginosa</italic> and <italic toggle="yes">S. aureus</italic> microcolonies. (G-H) Brightfield and phase-contrast images, respectively, of <italic toggle="yes">E. coli</italic> cells and microcolony.</p><p hwp:id="p-51">Scale bar is 10 µm. Images in (C) from Luke Noble and Matthew Rockman; (D) from Sally Warring and Jane Carlton; (E) from Dietrich Kohlheyer [<xref rid="c24" ref-type="bibr" hwp:id="xref-ref-24-1" hwp:rel-id="ref-24">24</xref>]; (F) from Dominique Limoli and Kaitlin Yarrington [<xref rid="c25" ref-type="bibr" hwp:id="xref-ref-25-1" hwp:rel-id="ref-25">25</xref>] (H) from Jeffrey Carey and Mark Goulian [<xref rid="c26" ref-type="bibr" hwp:id="xref-ref-26-1" hwp:rel-id="ref-26">26</xref>], used with authors’ permission.</p></caption><graphic xlink:href="253724v3_fig5" position="float" orientation="portrait" hwp:id="graphic-5"/></fig><p hwp:id="p-52">Robust automated recognition of microcolonies allows large-scale quantification of microbial growth properties by tracking many colonies across a timeseries. We therefore applied PIE to time-lapse microbial imaging to estimate microbial growth rates. PIE calculates the area of each tracked colony and then uses the change in colony area over time to calculate growth rate and pre-growth lag time (<bold><xref rid="fig6" ref-type="fig" hwp:id="xref-fig-6-1" hwp:rel-id="F6">Fig 6A</xref></bold>,<bold>C</bold>,<bold>E</bold>). We imaged tens of thousands of clonal <italic toggle="yes">S. cerevisiae</italic> (<bold><xref rid="fig6" ref-type="fig" hwp:id="xref-fig-6-2" hwp:rel-id="F6">Fig 6B</xref></bold>), <italic toggle="yes">S. pombe</italic> (<bold><xref rid="fig6" ref-type="fig" hwp:id="xref-fig-6-3" hwp:rel-id="F6">Fig 6D</xref></bold>), and <italic toggle="yes">E. coli</italic> (<bold><xref rid="fig6" ref-type="fig" hwp:id="xref-fig-6-4" hwp:rel-id="F6">Fig 6F</xref></bold>) microcolonies founded by single cells and grown in media while adhered to the bottom of a 96-well microscope plate over the course of 10-15 hours, and analyzed the resulting images with PIE. After filtration (see <bold>Software Implementation</bold>), PIE returned growth rates and pre-growth lag values for ∼81,000 <italic toggle="yes">S. cerevisiae</italic> colonies, ∼17,000 <italic toggle="yes">S. pombe</italic> colonies, and ∼46,000 <italic toggle="yes">E. coli</italic> colonies (the difference in sample sizes is primarily the result of differences in cell plating density and the number of imaged fields between the three experiments, and not an organism-specific feature of the assay). In defined SC media, <italic toggle="yes">S. cerevisiae</italic> grows faster than <italic toggle="yes">S. pombe</italic> (median growth rates of 0.40/hr and 0.22/hr, respectively), although both experienced similar lag times (2.1 hrs and 2.2 hrs); the difference in growth rates is likely related to the fact that the SC media used was not optimal for <italic toggle="yes">S. pombe</italic>. As expected, <italic toggle="yes">E. coli</italic> grow faster than either yeast species, with a median growth rate of 0.74/hr and a median lag of 1.0 hrs (of note, we included a PIE filtration requirement for this analysis to remove colonies whose R<sup>2</sup> for growth rate fit was below 0.9; for <italic toggle="yes">E. coli</italic>, this resulted in the removal of ∼26,000 colonies with growth rates very close to 0).</p><fig id="fig6" position="float" fig-type="figure" orientation="portrait" hwp:id="F6" hwp:rev-id="xref-fig-6-1 xref-fig-6-2 xref-fig-6-3 xref-fig-6-4"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;253724v3/FIG6</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F6</object-id><object-id pub-id-type="publisher-id">fig6</object-id><label>Figure 6.</label><caption hwp:id="caption-6"><title hwp:id="title-23">Distributions of individual microcolony growth rates in large populations</title><p hwp:id="p-53">Growth of a single representative microcolony from each species, and distribution of growth rates of individual microcolonies of (A, B) <italic toggle="yes">S. cerevisiae</italic>, n = 80,753, (C,D) <italic toggle="yes">S. pombe</italic>, n = 16,625, and (E,F) <italic toggle="yes">E. coli</italic>, n = 46,087. In panels on the left, colony area as determined by PIE is shaded, and the change in <italic toggle="yes">ln(area)</italic> over time used to calculate growth rate and lag is shown in the inset graph, with solid and dotted lines representing best fits for growth rate and lag, respectively. Scale bar is 5 µm.</p></caption><graphic xlink:href="253724v3_fig6" position="float" orientation="portrait" hwp:id="graphic-6"/></fig><p hwp:id="p-54">In addition to generating precise average growth rates, the individual microcolony growth parameters reported by PIE allow exploration of full distributions of growth rates. The three microbe species differ not only in their median growth rates but also in the shapes of their growth-rate distributions. As previously reported [<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-8" hwp:rel-id="ref-2">2</xref>,<xref rid="c7" ref-type="bibr" hwp:id="xref-ref-7-2" hwp:rel-id="ref-7">7</xref>], we found that the distribution of growth rates of <italic toggle="yes">S. cerevisiae</italic> is left skewed (skewness = −1.3), with a small subpopulation of slow-growing cells. We observed a similar skew in the microcolony growth rates of <italic toggle="yes">S. pombe</italic> (skewness = −2.1) and, to a smaller degree, <italic toggle="yes">E. coli</italic> (skewness = −0.7). However, the distributions of microcolony growth rates of <italic toggle="yes">S. cerevisiae</italic> and <italic toggle="yes">E. coli</italic> were much more dispersed than that of <italic toggle="yes">S. pombe</italic> (CV of 0.24, 0.15, and 0.25 for <italic toggle="yes">S. cerevisiae, S. pombe</italic>, and <italic toggle="yes">E. coli</italic>, respectively). These observations reveal the utility of PIE in exploring the non-genetic differences among individual microbes within a population.</p></sec><sec id="s2d" hwp:id="sec-15"><title hwp:id="title-24">Measurement of individual microcolony-level response to stress using PIE</title><p hwp:id="p-55">In addition to tracking individual colonies through time, PIE allows data to be collected in multiple ‘phases’, each with its own imaging regime and analysis parameters; colonies are then tracked across these phases, with growth properties calculated separately for each phase. The effects of perturbations on the growth of individual microcolonies can therefore be tracked, and juxtaposed with each colony’s pre-perturbation properties.</p><p hwp:id="p-56">To assess PIE’s utility in tracking multiple colonies before and after an experimental perturbation, we performed an experiment to assess the effect of UV stress on yeast growth. Mutations in the gene encoding histone H2A variant Htz1 have previously been shown to sensitize yeast to UV stress [<xref rid="c27" ref-type="bibr" hwp:id="xref-ref-27-1" hwp:rel-id="ref-27">27</xref>]. Furthermore, <italic toggle="yes">htz1-</italic> deletion strains have higher variance of growth rates, and thus a higher proportion of slow-growing cells, than wild type yeast [<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-9" hwp:rel-id="ref-2">2</xref>]. Slow-growing members of clonal yeast populations have been shown to be resistant to heat shock stress [<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-10" hwp:rel-id="ref-2">2</xref>,<xref rid="c7" ref-type="bibr" hwp:id="xref-ref-7-3" hwp:rel-id="ref-7">7</xref>]. We therefore sought to use high-throughput imaging in combination with PIE to investigate whether (1) there is a relationship between growth rate and resistance to UV stress, and (2) whether the UV stress response is modulated by Htz1.</p><p hwp:id="p-57">As discussed in <bold>Software Implementation</bold>, PIE can use fluorescence data to classify colonies co-cultured in a single well. A reference strain can therefore be included in each well of an experiment, increasing statistical power for detecting differences between test strain(s) and the reference. Here, we used a strain expressing a transgene encoding GFP-tagged histone H2B, <italic toggle="yes">Htb2-GFP</italic>, as the wildtype in-well control strain to which <italic toggle="yes">htz1-</italic> colonies were compared. The strains were grown together for ∼3.5 hours while being imaged in brightfield, then a single image in the GFP channel was collected at each position for colony classification (∼40 minutes), and the cells were subjected to a 45-minute UV stress. Following the UV stress, the cells were placed back on the microscope and brightfield imaging continued for ∼9 hours (<bold><xref rid="fig7" ref-type="fig" hwp:id="xref-fig-7-1" hwp:rel-id="F7">Fig 7A</xref></bold>).</p><fig id="fig7" position="float" fig-type="figure" orientation="portrait" hwp:id="F7" hwp:rev-id="xref-fig-7-1 xref-fig-7-2 xref-fig-7-3 xref-fig-7-4 xref-fig-7-5 xref-fig-7-6"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;253724v3/FIG7</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F7</object-id><object-id pub-id-type="publisher-id">fig7</object-id><label>Figure 7.</label><caption hwp:id="caption-7"><title hwp:id="title-25">Using multi-phase PIE analysis to study stress response in microcolonies of multiple co-cultured strains</title><p hwp:id="p-58">(A) Growth of two colonies over time; left panels are before UV stress, right panels after UV stress. The bottom left panel shows GFP expression (white) overlaid with colony outlines from the previous brightfield image, which are used to calculate per-colony GFP channel pixel intensity. The bottom right panel shows log(colony area) over the two phases of the experiment, with solid and dotted lines representing best fits for growth rate and lag, respectively. The break in datapoints ∼3.5-5 hrs into the experiment was due to collection of GFP fluorescence data and a 45-minute UV treatment; circles denote ln(area) in the pre-stress experiment phase, and triangles in the post-stress experiment phase. Scale bar in images is 10 µm. (B) Histogram (in gray) of mean per-pixel colony GFP fluorescence values, with fitted logistic probability density functions to GFP-negative (<italic toggle="yes">htz1-</italic>, magenta) and GFP-positive (HTB2-GFP, green) colonies, n ∼ 51,000 colonies. Dotted lines represent threshold values used for calling each GFP category; colonies between the thresholds were not assigned to either category. (C-E) Distributions of colony growth rates before and after UV stress, and lag times after UV stress. <italic toggle="yes">htz1</italic>-colonies grow slower than HTB2-GFP colonies both before and after stress, and have a longer post-stress lag period. (F-G) Growth rate and lag after UV stress as a function of each colony’s pre-stress growth rate, with lines denoting the LOESS regression for each strain. n ∼ 12,000 colonies.</p></caption><graphic xlink:href="253724v3_fig7" position="float" orientation="portrait" hwp:id="graphic-7"/></fig><p hwp:id="p-59">To test the ability of PIE to discriminate between the GFP-marked strain and the non-fluorescent <italic toggle="yes">htz1-</italic> strain, we performed our experiment both with wells in which the two strains were co-cultured, and with wells in which only a single one of the strains was present. The results of PIE’s GFP classification can be seen in <bold><xref rid="fig7" ref-type="fig" hwp:id="xref-fig-7-2" hwp:rel-id="F7">Fig 7B</xref></bold> and <bold><xref rid="tbl1" ref-type="table" hwp:id="xref-table-wrap-1-1" hwp:rel-id="T1">Table 1</xref></bold>. To classify colonies, PIE uses data from all wells to identify two thresholds, an upper threshold for the fluorescence-negative colonies, and a lower threshold for the fluorescence-positive colonies (see <bold>Software Implementation</bold>). By using colonies from wells with a single known strain, we can assess the specificity and sensitivity of PIE (<bold><xref rid="tbl1" ref-type="table" hwp:id="xref-table-wrap-1-2" hwp:rel-id="T1">Table 1</xref></bold>). We find that 15%-17% colonies are not classified (i.e. they fall between the thresholds), and only a fraction of a percent of colonies (0.4% for <italic toggle="yes">Htb2-GFP</italic>, 0.1% for <italic toggle="yes">htz1-</italic>) are misclassified into the wrong fluorescence category. The vast majority of colonies (&gt;83%) are classified as their true fluorescence category. It is important to note that, whereas the proportion of misclassified colonies is hardwired in PIE and unlikely to deviate strongly from the values observed here, the proportion of unclassified colonies is highly dependent on the properties of the colony fluorescence distribution, with the lowest percent of unclassified colonies in pairs of strains whose fluorescence levels are maximally separable.</p><table-wrap id="tbl1" orientation="portrait" position="float" hwp:id="T1" hwp:rev-id="xref-table-wrap-1-1 xref-table-wrap-1-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;253724v3/TBL1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T1</object-id><object-id pub-id-type="publisher-id">tbl1</object-id><label>Table 1.</label><caption hwp:id="caption-8"><title hwp:id="title-26">GFP-based classification of colonies of a known genotype</title><p hwp:id="p-60">For each genotype, 15-17% cells were not classified, and &lt; 0.5% of cells were misclassified.</p></caption><graphic xlink:href="253724v3_tbl1" position="float" orientation="portrait" hwp:id="graphic-8"/></table-wrap><p hwp:id="p-61">We next examined the pre-and post-UV stress microcolony growth rates of both genotypes, as well as the post-UV stress lag times (<bold><xref rid="fig7" ref-type="fig" hwp:id="xref-fig-7-3" hwp:rel-id="F7">Fig 7C-E</xref>)</bold>. As previously reported [<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-11" hwp:rel-id="ref-2">2</xref>], growth rates were slower and more variable in <italic toggle="yes">htz1</italic>-mutants. UV stress resulted in a protracted lag period, during which colonies did not grow: ∼1.9 hours post-stress lag for <italic toggle="yes">Htb2-GFP</italic> and ∼2.3 hours for <italic toggle="yes">htz1-</italic> colonies. When UV-stressed colonies started growing, growth rates of both genotypes decreased: 22.3% (95% CI: 21.6%-23.0%) in <italic toggle="yes">Htb2-GFP</italic>, and 23.4% (22.5%-24.3%) in <italic toggle="yes">htz1-</italic>. By contrast, in colonies that experienced a mock stress, growth rates increased by a small amount: 3.0% for <italic toggle="yes">Htb2-GFP</italic> (95% CI: 2.3%-3.7%), and 10.8% (10.0%-11.6%) for <italic toggle="yes">htz1-</italic>. The small increase in the mock condition is likely an artifact of the fact that in this experiment, we chose to perform an extended growth phase after UV stress. Because the time window with the maximum growth rate is selected to report the growth rate by our algorithm, the reported growth rate can only increase if additional time points are added. As a result, the absolute growth rate measurement in the longer second stage may appear elevated. This dependence of estimated growth rate on the number of time points is not an issue when relative growth rates of colonies during the same growth phase are compared, but should be considered if absolute growth rates are to be compared across experimental phases. Lag time after mock stress treatment was minimal (0.2 and 0.5 hours for <italic toggle="yes">Htb2-GFP</italic> and <italic toggle="yes">htz1-</italic>, respectively) (<bold><xref ref-type="fig" rid="figS4" hwp:id="xref-fig-11-1" hwp:rel-id="F11">S4 Fig</xref></bold>); the presence of a short lag phase after mock treatment might be the result of a temporary drop in temperature (from 30 °C to room temperature) over the course of the treatment.</p><p hwp:id="p-62">In both yeast and bacteria, the growth rate of an individual colony can affect its tolerance of stress [<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-12" hwp:rel-id="ref-2">2</xref>,<xref rid="c7" ref-type="bibr" hwp:id="xref-ref-7-4" hwp:rel-id="ref-7">7</xref>,<xref rid="c28" ref-type="bibr" hwp:id="xref-ref-28-1" hwp:rel-id="ref-28">28</xref>]. Because PIE allows colonies to be tracked across multiple phases of a single experiment, we can ask how the growth rates of colonies before stress correlated with the post-stress lag and growth rates of those same colonies (<bold><xref rid="fig7" ref-type="fig" hwp:id="xref-fig-7-4" hwp:rel-id="F7">Fig 7F-G</xref></bold>). Although growth rates of slow-growing cells appear to be positively correlated between the pre- and post-stress phase, growth rates of medium- and fast-growing cells are uncorrelated between phases; these relationships hold for both the <italic toggle="yes">htz1-</italic> and <italic toggle="yes">Htb2-GFP</italic> strains (<bold><xref rid="fig7" ref-type="fig" hwp:id="xref-fig-7-5" hwp:rel-id="F7">Fig 7F</xref></bold>). Post-stress lag also appears uncorrelated with pre-stress growth in medium- and fast-growing cells; most stressed cells that quickly exit lag after stress are found among slow-growing HTB2-GFP colonies (<bold><xref rid="fig7" ref-type="fig" hwp:id="xref-fig-7-6" hwp:rel-id="F7">Fig 7G</xref></bold>). Although these results do not suggest that slow growth confers a strong protective effect against UV stress — as it does against acute heat stress [<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-13" hwp:rel-id="ref-2">2</xref>,<xref rid="c7" ref-type="bibr" hwp:id="xref-ref-7-5" hwp:rel-id="ref-7">7</xref>] — they do suggest that growth heterogeneity contributes to heterogeneity in response to UV stress, particularly in the exit from UV-induced growth arrest.</p></sec></sec><sec id="s3" hwp:id="sec-16"><title hwp:id="title-27">Discussion</title><p hwp:id="p-63">Here we describe PIE, software that can perform microcolony growth-rate measurements on time-lapse brightfield or phase-contrast images and, if needed, simultaneous measurements of colony fluorescence. PIE combines adaptive cell-center recognition and gradient-based edge detection to recognize outlines of microbial colonies in low-resolution brightfield images and track colonies through time. As we have shown, PIE’s colony recognition is robust to variation in image brightness and focal plane. On low-resolution brightfield images, PIE outperforms existing machine learning-based methods of cell segmentation in both speed and accuracy. The software is highly flexible in terms of experimental setup, allowing multiple phases that might include tracking of growing microcolonies, stress administration and cell classification. PIE is available as a Python package, with full documentation currently at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://pie-image.readthedocs.io/" ext-link-type="uri" xlink:href="https://pie-image.readthedocs.io/" hwp:id="ext-link-5">https://pie-image.readthedocs.io/</ext-link>, and we have developed an online application to quickly test analysis of individual images or timeseries, which is currently available at pie.hpc.nyu.edu [<xref rid="c29" ref-type="bibr" hwp:id="xref-ref-29-1" hwp:rel-id="ref-29">29</xref>]. Users of the web application may choose to share images they upload with us. While our data suggests that this method generalizes well to a wide range of microbes imaged across diverse conditions, we hope that images shared with us via the web application will allow us to continue to improve PIE.</p><p hwp:id="p-64">The ability of PIE to accurately segment cells in low-resolution brightfield and phase-contrast images provides significant advantages over existing approaches to cell recognition in microscopy. The use of brightfield images obviates the requirement for engineered, fluorescent reporter-expressing cells. In addition, no single fluorescence channel is required to be set aside for cell recognition. Furthermore, PIE’s ability to accurately track colonies in low-resolution images vastly increases the potential sample size of any experiment. For example, for the <italic toggle="yes">S. cerevisiae</italic> growth rate data described here, we tracked colonies at 1-hr resolution and measured growth rates for &gt;80,000 colonies in a single experiment. Such sample sizes would not be possible using algorithms that require high resolution (i.e. higher magnification) images.</p><p hwp:id="p-65">PIE also does not require any user input into tunable parameters in the colony recognition portion of the algorithm, although advanced users can choose to modify certain default features, e.g. by running the algorithm in ‘cleanup’ mode. In images analyzed for this paper, only three colony recognition parameters were adjusted: whether cleanup was performed, the maximum size of the empty spaces between cells that were considered to belong to the colony, and (for the <italic toggle="yes">P. aeruginosa</italic>/<italic toggle="yes">S. aureus</italic> coculture data) the number of distinct cell body intensities in the image. We include guidelines on all optional image analysis parameters, as well as optional filters used during growth rate calculation, in the PIE documentation. For the latter, the single required filtration parameter is the number of time points in the window used to calculate growth rate. It is designed to allow PIE to select a set of time points for growth rate fitting that includes times when the microcolony is growing, but not points when it is stationary. As a result, if this value is set too high, it will require PIE to include lagging time points in the growth calculation, deflating both the lag and growth rate measurements; if it is set too low, growth rate estimates will be noisy and inflated. In addition, users are encouraged to carefully consider filtration of colonies with a low R<sup>2</sup> of growth rate fit to area over time; care is required as this filter necessarily also removes colonies with growth rates close to 0.</p><p hwp:id="p-66">By providing a simple platform for performing automated simultaneous measurements on microbial growth, PIE opens up opportunities to analyze new and intriguing questions at the single-cell level within large populations. Here, we have highlighted how this software can be used to assess the effect of pre-stress growth parameters on stress resistance. Beyond this example case, PIE reports a wealth of other data, including founder cell size and shape, fluorescence measurements, and colony shape, that can be harnessed to investigate the relationships between gene expression, growth, and stress resistance (e.g. [<xref rid="c7" ref-type="bibr" hwp:id="xref-ref-7-6" hwp:rel-id="ref-7">7</xref>]). The variabilities of these traits and their relationships within populations would be especially difficult to measure without an automated image-analytical tool.</p><p hwp:id="p-67">We hope that PIE’s ease of use, along with its robustness to experimental variation and the very high sample sizes it affords, encourages others, including those without image-analysis expertise, to use PIE to integrate high-throughput image-based growth assays into their work.</p></sec><sec id="s4" hwp:id="sec-17"><title hwp:id="title-28">Materials and Methods</title><sec id="s4a" hwp:id="sec-18"><title hwp:id="title-29">Software development and availability</title><p hwp:id="p-68">PIE was developed in Python 3.7 [<xref rid="c30" ref-type="bibr" hwp:id="xref-ref-30-1" hwp:rel-id="ref-30">30</xref>], and is available on GitHub (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/Siegallab/PIE" ext-link-type="uri" xlink:href="https://github.com/Siegallab/PIE" hwp:id="ext-link-6">https://github.com/Siegallab/PIE</ext-link>); documentation for PIE is available at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://pie-image.readthedocs.io/" ext-link-type="uri" xlink:href="https://pie-image.readthedocs.io/" hwp:id="ext-link-7">https://pie-image.readthedocs.io/</ext-link> [<xref rid="c29" ref-type="bibr" hwp:id="xref-ref-29-2" hwp:rel-id="ref-29">29</xref>].</p><p hwp:id="p-69">Image analysis in PIE is implemented primarily using the OpenCV [<xref rid="c31" ref-type="bibr" hwp:id="xref-ref-31-1" hwp:rel-id="ref-31">31</xref>] and Numpy [<xref rid="c32" ref-type="bibr" hwp:id="xref-ref-32-1" hwp:rel-id="ref-32">32</xref>] software packages. Curve-fitting steps make use of SciPy [<xref rid="c33" ref-type="bibr" hwp:id="xref-ref-33-1" hwp:rel-id="ref-33">33</xref>]. Pandas [<xref rid="c34" ref-type="bibr" hwp:id="xref-ref-34-1" hwp:rel-id="ref-34">34</xref>] is used for growth rate filtration and output table compilation steps. Pillow [<xref rid="c35" ref-type="bibr" hwp:id="xref-ref-35-1" hwp:rel-id="ref-35">35</xref>] and PlotNine [<xref rid="c36" ref-type="bibr" hwp:id="xref-ref-36-1" hwp:rel-id="ref-36">36</xref>] are used for visualization. Click [<xref rid="c37" ref-type="bibr" hwp:id="xref-ref-37-1" hwp:rel-id="ref-37">37</xref>] is used for the command-line interface.</p><p hwp:id="p-70">An online application for PIE is available at pie.hpc.nyu.edu so that users may quickly test PIE’s analysis of their own images (both individually and in time series) [<xref rid="c29" ref-type="bibr" hwp:id="xref-ref-29-3" hwp:rel-id="ref-29">29</xref>]. The online application is implemented using Flask [<xref rid="c38" ref-type="bibr" hwp:id="xref-ref-38-1" hwp:rel-id="ref-38">38</xref>].</p></sec><sec id="s4b" hwp:id="sec-19"><title hwp:id="title-30">Microscopy</title><p hwp:id="p-71">To test PIE’s ability to identify and measure colonies at various focal planes and illumination levels, brightfield images of growing cells were acquired using a Nikon Ti Eclipse inverted microscope with Perfect Focus System, which automatically corrects drifts and fluctuations in the Z axis during long-term imaging. Yeast images were acquired with a 10x objective and 1.5x magnifier; bacterial images were acquired with a 40x objective and no additional magnifier. Images were acquired with NIS-Elements software with gain set to 4 and saved as 11-bit .<italic toggle="yes">tif</italic> files. Each well of a 96-well microscope plate (clear bottom MatriPlates, 0.17 mm bottom glass thickness, catalog number MGB096-1-2-LG-L, Brooks Life Science Systems) was filled with 400 μL medium and seeded with cells (as previously described in [<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-14" hwp:rel-id="ref-2">2</xref>,<xref rid="c9" ref-type="bibr" hwp:id="xref-ref-9-4" hwp:rel-id="ref-9">9</xref>,<xref rid="c23" ref-type="bibr" hwp:id="xref-ref-23-2" hwp:rel-id="ref-23">23</xref>]).</p></sec><sec id="s4c" hwp:id="sec-20"><title hwp:id="title-31">Colony outline comparison across cell recognition programs</title><p hwp:id="p-72">Two major potential sources of image-recognition error were considered: image brightness and focus. The optimal focal plane (corresponding to slightly defocused cells) and exposure are manually determined to correspond to slightly defocused images where cells have a bright center and a dark outline. Two additional sets of images were taken at the same position as the ‘optimal’ image. One set had the optimal focal plane but varied in brightness (exposure time 2–16 ms), which spans more than the typical image brightness variation across one plate. The other set of images had the optimal brightness (exposure time of 12 ms for this experiment) but varied in focal planes (ranging between −6 µm and +4 µm relative to the optimal focal plane), which spans more than the typical range of focal-plane differences within one experiment. PIE code without cleanup was applied to process these images. The same images were also analyzed using YeastSpotter [<xref rid="c14" ref-type="bibr" hwp:id="xref-ref-14-3" hwp:rel-id="ref-14">14</xref>], CellPose [<xref rid="c15" ref-type="bibr" hwp:id="xref-ref-15-3" hwp:rel-id="ref-15">15</xref>], and a custom ‘naive’ Hough Transform-based analysis.</p><p hwp:id="p-73">For CellPose and YeastSpotter, a median filter was applied to all images before analysis to improve cell recognition by these algorithms, as cell recognition on large raw images was very poor prior to filter application. In CellPose, cytoplasmic recognition using the pre-trained model failed to correctly recognize cells, so nuclear recognition using that model was applied instead and yielded better results.</p><p hwp:id="p-74">Hough Transform analysis was performed in Fiji [<xref rid="c20" ref-type="bibr" hwp:id="xref-ref-20-2" hwp:rel-id="ref-20">20</xref>–<xref rid="c22" ref-type="bibr" hwp:id="xref-ref-22-2" hwp:rel-id="ref-22">22</xref>]. Background subtraction was performed with a rolling radius of 10, followed by Maximum Entropy thresholding, automated edge detection, and Hough Transform with a threshold of 0.65 and minimum and maximum radii of 3 and 7 pixels, respectively.</p><p hwp:id="p-75">To calculate F<sub>1</sub> scores and IoU (Intersection over Union) values (<bold><xref ref-type="disp-formula" rid="eqn1" hwp:id="xref-disp-formula-1-2" hwp:rel-id="disp-formula-1">Eqtn 1</xref></bold> and <bold><xref ref-type="disp-formula" rid="eqn2" hwp:id="xref-disp-formula-2-2" hwp:rel-id="disp-formula-2">Eqtn 2</xref></bold> below), masks created by each method were compared to a hand-traced reference colony mask based on the image with the optimal focal plane and exposure. Before IoU and F<sub>1</sub> calculation, image registration was performed to align each colony mask to the reference mask; this registration was necessary because the positions of the colonies in the image shifted slightly as the image focal plane was shifted. IoU was calculated based on the number of pixels in each colony and overlap of colonies between the masks. Reference colonies with no matching colony in a given method were assigned an IoU value of 0.
<disp-formula id="eqn1" hwp:id="disp-formula-1" hwp:rev-id="xref-disp-formula-1-1 xref-disp-formula-1-2">
<alternatives hwp:id="alternatives-1"><graphic xlink:href="253724v3_eqn1.gif" position="float" orientation="portrait" hwp:id="graphic-9"/></alternatives>
</disp-formula>
<disp-formula id="eqn2" hwp:id="disp-formula-2" hwp:rev-id="xref-disp-formula-2-1 xref-disp-formula-2-2">
<alternatives hwp:id="alternatives-2"><graphic xlink:href="253724v3_eqn2.gif" position="float" orientation="portrait" hwp:id="graphic-10"/></alternatives>
</disp-formula>
To compare image analysis speed, CellPose, YeastSpotter, and PIE (with and without cleanup) were all run in series on a single Intel Platinum 8268 CPU of a dedicated node on the NYU high-performance cluster, with Turbo mode disabled. For CellPose and PIE, the time to process each individual image was recorded, and values were averaged; for YeastSpotter, images were all processed in a single run, and the process time was divided by the number of images analyzed.</p></sec><sec id="s4d" hwp:id="sec-21"><title hwp:id="title-32">Strains and Media</title><p hwp:id="p-76">For growth rate distribution experiments, <italic toggle="yes">Saccharomyces cerevisiae</italic> of the prototrophic haploid strain FY4 (Winston et al., 1995) were grown to saturation in Synthetic Complete (SC) media, and imaged once per hour in SC media during microscopy. <italic toggle="yes">Schizosaccharomyces pombe</italic> strain 972h-was grown to saturation in Edinburgh Minimal Media (EMM), and imaged once every 30 minutes in SC media during microscopy (because EMM media interferes with ConA immobilization); SC is not optimal for <italic toggle="yes">S. pombe</italic>, and may confer mild stress, but sufficed for the experiments presented here. <italic toggle="yes">Escherichia coli</italic> strain MG1655-F3, a derivative of MG1655 background, containing knockouts of the <italic toggle="yes">fliC</italic> flagellin gene to impair motility and of the <italic toggle="yes">fimA</italic> and <italic toggle="yes">flu</italic> genes to prevent cell aggregation [<xref rid="c39" ref-type="bibr" hwp:id="xref-ref-39-1" hwp:rel-id="ref-39">39</xref>] was shared by the Kussell lab. <italic toggle="yes">E. coli</italic> was pre-cultured to saturation in LB media, and imaged every 20 minutes in M9 media during microscopy. For yeast experiments, microscope plates were pre-treated with Concanavalin A (ConA) as previously described [<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-15" hwp:rel-id="ref-2">2</xref>,<xref rid="c23" ref-type="bibr" hwp:id="xref-ref-23-3" hwp:rel-id="ref-23">23</xref>]; <italic toggle="yes">E. coli</italic> were plated on plates in wells treated for 1 hr with 6.6 µL Cell-Tak (Corning, CB402-40) + 53.4 µL 0.1 M sodium bicarbonate, pH 8.0. The demonstration of the successful ‘cleanup’ procedure used haploid strains derived from DBY4974/DBY4975 [<xref rid="c40" ref-type="bibr" hwp:id="xref-ref-40-1" hwp:rel-id="ref-40">40</xref>–<xref rid="c42" ref-type="bibr" hwp:id="xref-ref-42-1" hwp:rel-id="ref-42">42</xref>]. For the light stress experiment, we used a haploid <italic toggle="yes">htz1-</italic> BY4743 YKO magic marker-derived strain [<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-16" hwp:rel-id="ref-2">2</xref>,<xref rid="c43" ref-type="bibr" hwp:id="xref-ref-43-1" hwp:rel-id="ref-43">43</xref>], and a HTB2-GFP strain from the yeast GFP collection [<xref rid="c44" ref-type="bibr" hwp:id="xref-ref-44-1" hwp:rel-id="ref-44">44</xref>].</p></sec><sec id="s4e" hwp:id="sec-22"><title hwp:id="title-33">Light Stress Experiment</title><p hwp:id="p-77">The experiment testing the effects of light stress was performed by growing <italic toggle="yes">HTB2-GFP</italic> and <italic toggle="yes">htz1-</italic> cells to late log phase and plated on ConA-coated plates at 2000 cells/well as described [<xref rid="c23" ref-type="bibr" hwp:id="xref-ref-23-4" hwp:rel-id="ref-23">23</xref>]. Wells contained either only one of the two strains or both strains together. Yeast were imaged every 40 mins for 4 hours while growing at 30°C, followed by a single imaging step in the GFP channel to collect fluorescence data. The plate was then immediately placed on a UV transilluminator (Fisherbrand FB-TIV-614A), elevated 3 mm above the transilluminator surface to prevent heating. Half the plate was covered with foil-wrapped cardboard to prevent exposure as a mock stress, and the other half was illuminated with UV on the highest setting for 45 minutes. After the UV treatment, the microplate was placed back on the microscope and the second imaging phase was initiated.</p><p hwp:id="p-78">To test the relationship between pre-stress growth rate and post-stress growth rate and lag, we filtered the data, removing the colonies that fell into the upper or lower 0.5% quantile for any growth property (for this analysis, we did not include a filter on minimal R<sup>2</sup> value of growth rate fit, which results in a very small number of colonies with unrealistically large or small lag/gr values). To model the effects of stress (or mock stress) exposure on each strain, we split data by strain and UV exposure status, and used the <italic toggle="yes">lme4</italic> package in R [<xref rid="c45" ref-type="bibr" hwp:id="xref-ref-45-1" hwp:rel-id="ref-45">45</xref>] to fit a linear mixed effect model of growth rate as a function of phase for each subset of the data, accounting for random effects from individual colonies and wells:
<disp-formula id="eqn3" hwp:id="disp-formula-3">
<alternatives hwp:id="alternatives-3"><graphic xlink:href="253724v3_eqn3.gif" position="float" orientation="portrait" hwp:id="graphic-11"/></alternatives>
</disp-formula>
where σ<sub>W</sub><sup>2</sup> and σ<sub>C</sub><sup>2</sup> are the standard deviation of growth rate across wells and colonies, respectively.</p><p hwp:id="p-79">We modeled the post-stress lag in each strain as follows:
<disp-formula id="eqn4" hwp:id="disp-formula-4">
<alternatives hwp:id="alternatives-4"><graphic xlink:href="253724v3_eqn4.gif" position="float" orientation="portrait" hwp:id="graphic-12"/></alternatives>
</disp-formula>
where σ<sub>W</sub><sup>2</sup> and σ<sub>C</sub><sup>2</sup> are the standard deviation of post-stress lag across wells and colonies, respectively, and µ<sub>i</sub> is the mean post-stress lag of strain <italic toggle="yes">i</italic>.</p></sec></sec></body><back><sec id="s5" hwp:id="sec-23"><title hwp:id="title-34">Data availability</title><p hwp:id="p-80">Data and code used in this project is available at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://osf.io/6g9n5/?view_only=eb963022aa51416e9dbe0893d04905ef" ext-link-type="uri" xlink:href="https://osf.io/6g9n5/?view_only=eb963022aa51416e9dbe0893d04905ef" hwp:id="ext-link-8">https://osf.io/6g9n5/?view_only=eb963022aa51416e9dbe0893d04905ef</ext-link></p></sec><ack hwp:id="ack-1"><title hwp:id="title-35">Acknowledgments</title><p hwp:id="p-81">We thank Luke Noble, Matthew Rockman, Sally Warring, Jane Carlton, Kaitlin Yarrington, Dominique Limoli, Bastian Wollenhaupt, Dietrich Kohlheyer, Jeffrey Carey, and Mark Goulian for sharing microbial images; Edo Kussell and Dan Pollack for sharing the <italic toggle="yes">E. coli</italic> strain used in this study; Fei Li and Josephine Ban for sharing the <italic toggle="yes">S. pombe</italic> strain used in this study; NYU’s Data Science and Software Services and High-Performance Computing, especially Eric Borenstein and Flannon Jackson, for their assistance in setting up the PIE web application and software package; and Shenglong Wang for his extensive help testing and benchmarking PIE throughout the development process.</p><p hwp:id="p-82">This work was supported by National Institutes of Health grants R35GM118170 (to MLS) and R01HG008354 (to SFL), the NYU Moore Sloan Data Science Environment (to HM and HJ), and the Google Cloud Research Credits Program. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p></ack><ref-list hwp:id="ref-list-1"><title hwp:id="title-36">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1"><label>1.</label><citation publication-type="other" citation-type="journal" ref:id="253724v3.1" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Geiler-Samerotte K"><surname>Geiler-Samerotte</surname> <given-names>K</given-names></string-name>, <string-name name-style="western" hwp:sortable="Bauer C"><surname>Bauer</surname> <given-names>C</given-names></string-name>, <string-name name-style="western" hwp:sortable="Li S"><surname>Li</surname> <given-names>S</given-names></string-name>, <string-name name-style="western" hwp:sortable="Ziv N"><surname>Ziv</surname> <given-names>N</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gresham D"><surname>Gresham</surname> <given-names>D</given-names></string-name>, <string-name name-style="western" hwp:sortable="Siegal M."><surname>Siegal</surname> <given-names>M.</given-names></string-name> <article-title hwp:id="article-title-2">The details in the distributions: why and how to study phenotypic variability</article-title>. <source hwp:id="source-1">Curr Opin Biotechnol</source>. <year>2013</year>.</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1 xref-ref-2-2 xref-ref-2-3 xref-ref-2-4 xref-ref-2-5 xref-ref-2-6 xref-ref-2-7 xref-ref-2-8 xref-ref-2-9 xref-ref-2-10 xref-ref-2-11 xref-ref-2-12 xref-ref-2-13 xref-ref-2-14 xref-ref-2-15 xref-ref-2-16"><label>2.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="Levy SF"><surname>Levy</surname> <given-names>SF</given-names></string-name>, <string-name name-style="western" hwp:sortable="Ziv N"><surname>Ziv</surname> <given-names>N</given-names></string-name>, <string-name name-style="western" hwp:sortable="Siegal ML"><surname>Siegal</surname> <given-names>ML</given-names></string-name>. <article-title hwp:id="article-title-3">Bet hedging in yeast by heterogeneous, age-correlated expression of a stress protectant</article-title>. <source hwp:id="source-2">PLoS Biol</source>. <year>2012</year>;<volume>10</volume>: <fpage>e1001325</fpage>.</citation></ref><ref id="c3" hwp:id="ref-3"><label>3.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.3" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Ohya Y"><surname>Ohya</surname> <given-names>Y</given-names></string-name>, <string-name name-style="western" hwp:sortable="Sese J"><surname>Sese</surname> <given-names>J</given-names></string-name>, <string-name name-style="western" hwp:sortable="Yukawa M"><surname>Yukawa</surname> <given-names>M</given-names></string-name>, <string-name name-style="western" hwp:sortable="Sano F"><surname>Sano</surname> <given-names>F</given-names></string-name>, <string-name name-style="western" hwp:sortable="Nakatani Y"><surname>Nakatani</surname> <given-names>Y</given-names></string-name>, <string-name name-style="western" hwp:sortable="Saito TL"><surname>Saito</surname> <given-names>TL</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-4">High-dimensional and large-scale phenotyping of yeast mutants</article-title>. <source hwp:id="source-3">Proc Natl Acad Sci USA</source>. <year>2005</year>;<volume>102</volume>: <fpage>19015</fpage>–<lpage>19020</lpage>.</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1"><label>4.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.4" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Rusconi R"><surname>Rusconi</surname> <given-names>R</given-names></string-name>, <string-name name-style="western" hwp:sortable="Garren M"><surname>Garren</surname> <given-names>M</given-names></string-name>, <string-name name-style="western" hwp:sortable="Stocker R."><surname>Stocker</surname> <given-names>R.</given-names></string-name> <article-title hwp:id="article-title-5">Microfluidics expanding the frontiers of microbial ecology</article-title>. <source hwp:id="source-4">Annu Rev Biophys</source>. <year>2014</year>;<volume>43</volume>: <fpage>65</fpage>–<lpage>91</lpage>.</citation></ref><ref id="c5" hwp:id="ref-5" hwp:rev-id="xref-ref-5-1"><label>5.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.5" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Levin-Reisman I"><surname>Levin-Reisman</surname> <given-names>I</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gefen O"><surname>Gefen</surname> <given-names>O</given-names></string-name>, <string-name name-style="western" hwp:sortable="Fridman O"><surname>Fridman</surname> <given-names>O</given-names></string-name>, <string-name name-style="western" hwp:sortable="Ronin I"><surname>Ronin</surname> <given-names>I</given-names></string-name>, <string-name name-style="western" hwp:sortable="Shwa D"><surname>Shwa</surname> <given-names>D</given-names></string-name>, <string-name name-style="western" hwp:sortable="Sheftel H"><surname>Sheftel</surname> <given-names>H</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-6">Automated imaging with ScanLag reveals previously undetectable bacterial growth phenotypes</article-title>. <source hwp:id="source-5">Nat Methods</source>. <year>2010</year>;<volume>7</volume>: <fpage>737</fpage>–<lpage>739</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.1485</pub-id></citation></ref><ref id="c6" hwp:id="ref-6" hwp:rev-id="xref-ref-6-1 xref-ref-6-2"><label>6.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.6" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Bauer CR"><surname>Bauer</surname> <given-names>CR</given-names></string-name>, <string-name name-style="western" hwp:sortable="Li S"><surname>Li</surname> <given-names>S</given-names></string-name>, <string-name name-style="western" hwp:sortable="Siegal ML"><surname>Siegal</surname> <given-names>ML</given-names></string-name>. <article-title hwp:id="article-title-7">Essential gene disruptions reveal complex relationships between phenotypic robustness, pleiotropy, and fitness</article-title>. <source hwp:id="source-6">Mol Syst Biol</source>. <year>2015</year>;<volume>11</volume>: <fpage>773</fpage>.</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1 xref-ref-7-2 xref-ref-7-3 xref-ref-7-4 xref-ref-7-5 xref-ref-7-6"><label>7.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.7" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Li S"><surname>Li</surname> <given-names>S</given-names></string-name>, <string-name name-style="western" hwp:sortable="Giardina DM"><surname>Giardina</surname> <given-names>DM</given-names></string-name>, <string-name name-style="western" hwp:sortable="Siegal ML"><surname>Siegal</surname> <given-names>ML</given-names></string-name>. <article-title hwp:id="article-title-8">Control of nongenetic heterogeneity in growth rate and stress tolerance of Saccharomyces cerevisiae by cyclic AMP-regulated transcription factors</article-title>. <source hwp:id="source-7">PLoS Genet</source>. <year>2018</year>;<volume>14</volume>: <fpage>e1007744</fpage>.</citation></ref><ref id="c8" hwp:id="ref-8" hwp:rev-id="xref-ref-8-1"><label>8.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Ziv N"><surname>Ziv</surname> <given-names>N</given-names></string-name>, <string-name name-style="western" hwp:sortable="Shuster BM"><surname>Shuster</surname> <given-names>BM</given-names></string-name>, <string-name name-style="western" hwp:sortable="Siegal ML"><surname>Siegal</surname> <given-names>ML</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gresham D."><surname>Gresham</surname> <given-names>D.</given-names></string-name> <article-title hwp:id="article-title-9">Resolving the Complex Genetic Basis of Phenotypic Variation and Variability of Cellular Growth</article-title>. <source hwp:id="source-8">Genetics</source>. <year>2017</year>;<volume>206</volume>: <fpage>1645</fpage>–<lpage>1657</lpage>.</citation></ref><ref id="c9" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1 xref-ref-9-2 xref-ref-9-3 xref-ref-9-4"><label>9.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.9" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Ziv N"><surname>Ziv</surname> <given-names>N</given-names></string-name>, <string-name name-style="western" hwp:sortable="Siegal ML"><surname>Siegal</surname> <given-names>ML</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gresham D."><surname>Gresham</surname> <given-names>D.</given-names></string-name> <article-title hwp:id="article-title-10">Genetic and nongenetic determinants of cell growth variation assessed by high-throughput microscopy</article-title>. <source hwp:id="source-9">Mol Biol Evol</source>. <year>2013</year>;<volume>30</volume>: <fpage>2568</fpage>–<lpage>2578</lpage>.</citation></ref><ref id="c10" hwp:id="ref-10" hwp:rev-id="xref-ref-10-1"><label>10.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="Cadart C"><surname>Cadart</surname> <given-names>C</given-names></string-name>, <string-name name-style="western" hwp:sortable="Monnier S"><surname>Monnier</surname> <given-names>S</given-names></string-name>, <string-name name-style="western" hwp:sortable="Grilli J"><surname>Grilli</surname> <given-names>J</given-names></string-name>, <string-name name-style="western" hwp:sortable="Sáez PJ"><surname>Sáez</surname> <given-names>PJ</given-names></string-name>, <string-name name-style="western" hwp:sortable="Srivastava N"><surname>Srivastava</surname> <given-names>N</given-names></string-name>, <string-name name-style="western" hwp:sortable="Attia R"><surname>Attia</surname> <given-names>R</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-11">Size control in mammalian cells involves modulation of both growth rate and cell cycle duration</article-title>. <source hwp:id="source-10">Nature Communications</source>. <year>2018</year>;<volume>9</volume>: <fpage>3275</fpage>. doi:<pub-id pub-id-type="doi">10.1038/s41467-018-05393-0</pub-id></citation></ref><ref id="c11" hwp:id="ref-11"><label>11.</label><citation publication-type="other" citation-type="journal" ref:id="253724v3.11" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="Cerulus B"><surname>Cerulus</surname> <given-names>B</given-names></string-name>, <string-name name-style="western" hwp:sortable="New AM"><surname>New</surname> <given-names>AM</given-names></string-name>, <string-name name-style="western" hwp:sortable="Pougach K"><surname>Pougach</surname> <given-names>K</given-names></string-name>, <string-name name-style="western" hwp:sortable="Verstrepen KJ"><surname>Verstrepen</surname> <given-names>KJ</given-names></string-name>. <article-title hwp:id="article-title-12">Noise and Epigenetic Inheritance of Single-Cell Division Times Influence Population Fitness</article-title>. <source hwp:id="source-11">Curr Biol</source>. <year>2016; 1–11</year>.</citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1"><label>12.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.12" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Di Talia S"><surname>Di Talia</surname> <given-names>S</given-names></string-name>, <string-name name-style="western" hwp:sortable="Skotheim JM"><surname>Skotheim</surname> <given-names>JM</given-names></string-name>, <string-name name-style="western" hwp:sortable="Bean JM"><surname>Bean</surname> <given-names>JM</given-names></string-name>, <string-name name-style="western" hwp:sortable="Siggia ED"><surname>Siggia</surname> <given-names>ED</given-names></string-name>, <string-name name-style="western" hwp:sortable="Cross FR"><surname>Cross</surname> <given-names>FR</given-names></string-name>. <article-title hwp:id="article-title-13">The effects of molecular noise and size control on variability in the budding yeast cell cycle</article-title>. <source hwp:id="source-12">Nature</source>. <year>2007</year>;<volume>448</volume>: <fpage>947</fpage>–<lpage>951</lpage>.</citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1"><label>13.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.13" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="Dhar R"><surname>Dhar</surname> <given-names>R</given-names></string-name>, <string-name name-style="western" hwp:sortable="Missarova AM"><surname>Missarova</surname> <given-names>AM</given-names></string-name>, <string-name name-style="western" hwp:sortable="Lehner B"><surname>Lehner</surname> <given-names>B</given-names></string-name>, <string-name name-style="western" hwp:sortable="Carey LB"><surname>Carey</surname> <given-names>LB</given-names></string-name>. <article-title hwp:id="article-title-14">Single cell functional genomics reveals the importance of mitochondria in cell-to-cell phenotypic variation</article-title>. <person-group person-group-type="editor" hwp:id="person-group-1"><string-name name-style="western" hwp:sortable="Barkai N"><surname>Barkai</surname> <given-names>N</given-names></string-name></person-group>, editor. <source hwp:id="source-13">eLife</source>. <year>2019</year>;<volume>8</volume>: <fpage>e38904</fpage>. doi:<pub-id pub-id-type="doi">10.7554/eLife.38904</pub-id></citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1 xref-ref-14-2 xref-ref-14-3"><label>14.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.14" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Lu AX"><surname>Lu</surname> <given-names>AX</given-names></string-name>, <string-name name-style="western" hwp:sortable="Zarin T"><surname>Zarin</surname> <given-names>T</given-names></string-name>, <string-name name-style="western" hwp:sortable="Hsu IS"><surname>Hsu</surname> <given-names>IS</given-names></string-name>, <string-name name-style="western" hwp:sortable="Moses AM"><surname>Moses</surname> <given-names>AM</given-names></string-name>. <article-title hwp:id="article-title-15">YeastSpotter: accurate and parameter-free web segmentation for microscopy images of yeast cells</article-title>. <source hwp:id="source-14">Bioinformatics</source>. <year>2019</year>;<volume>35</volume>: <fpage>4525</fpage>–<lpage>4527</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btz402</pub-id></citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1 xref-ref-15-2 xref-ref-15-3"><label>15.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.15" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Stringer C"><surname>Stringer</surname> <given-names>C</given-names></string-name>, <string-name name-style="western" hwp:sortable="Wang T"><surname>Wang</surname> <given-names>T</given-names></string-name>, <string-name name-style="western" hwp:sortable="Michaelos M"><surname>Michaelos</surname> <given-names>M</given-names></string-name>, <string-name name-style="western" hwp:sortable="Pachitariu M."><surname>Pachitariu</surname> <given-names>M.</given-names></string-name> <article-title hwp:id="article-title-16">Cellpose: a generalist algorithm for cellular segmentation</article-title>. <source hwp:id="source-15">Nature Methods</source>. <year>2021</year>;<volume>18</volume>: <fpage>100</fpage>–<lpage>106</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41592-020-01018-x</pub-id></citation></ref><ref id="c16" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1 xref-ref-16-2"><label>16.</label><citation publication-type="book" citation-type="book" ref:id="253724v3.16" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Solomon C"><surname>Solomon</surname> <given-names>C</given-names></string-name>, <string-name name-style="western" hwp:sortable="Breckon T."><surname>Breckon</surname> <given-names>T.</given-names></string-name> <source hwp:id="source-16">Fundamentals of Digital Image Processing: A Practical Approach with Examples in Matlab. 1st edition. Chichester, West Sussex</source>; <publisher-loc>Hoboken, NJ</publisher-loc>: <publisher-name>Wiley</publisher-name>; <year>2011</year>.</citation></ref><ref id="c17" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1"><label>17.</label><citation publication-type="book" citation-type="book" ref:id="253724v3.17" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="Orfanidis SJ"><surname>Orfanidis</surname> <given-names>SJ</given-names></string-name>. <source hwp:id="source-17">Introduction to Signal Processing. US Ed edition</source>. <publisher-loc>Englewood Cliffs, N.J</publisher-loc>: <publisher-name>Prentice Hall</publisher-name>; <year>1995</year>.</citation></ref><ref id="c18" hwp:id="ref-18" hwp:rev-id="xref-ref-18-1"><label>18.</label><citation publication-type="website" citation-type="web" ref:id="253724v3.18" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-18"><collab hwp:id="collab-1">Feature Matching —</collab> <source hwp:id="source-18">OpenCV-Python Tutorials 1 documentation</source>. [cited 21 Mar 2021]. Available: <ext-link l:rel="related" l:ref-type="uri" l:ref="https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_feature2d/py_matcher/py_matcher.html" ext-link-type="uri" xlink:href="https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_feature2d/py_matcher/py_matcher.html" hwp:id="ext-link-9">https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_feature2d/py_matcher/py_matcher.html</ext-link></citation></ref><ref id="c19" hwp:id="ref-19" hwp:rev-id="xref-ref-19-1"><label>19.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.19" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-19"><string-name name-style="western" hwp:sortable="Lowe DG"><surname>Lowe</surname> <given-names>DG</given-names></string-name>. <article-title hwp:id="article-title-17">Distinctive Image Features from Scale-Invariant Keypoints</article-title>. <source hwp:id="source-19">International Journal of Computer Vision</source>. <year>2004</year>;<volume>60</volume>: <fpage>91</fpage>–<lpage>110</lpage>. doi:<pub-id pub-id-type="doi">10.1023/B:VISI.0000029664.99615.94</pub-id></citation></ref><ref id="c20" hwp:id="ref-20" hwp:rev-id="xref-ref-20-1 xref-ref-20-2"><label>20.</label><citation publication-type="other" citation-type="journal" ref:id="253724v3.20" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-20"><string-name name-style="western" hwp:sortable="Collins TJ"><surname>Collins</surname> <given-names>TJ</given-names></string-name>. <article-title hwp:id="article-title-18">ImageJ for microscopy</article-title>. <source hwp:id="source-20">Biotechniques</source>. <year>2007</year>.</citation></ref><ref id="c21" hwp:id="ref-21"><label>21.</label><citation publication-type="website" citation-type="web" ref:id="253724v3.21" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-21"><string-name name-style="western" hwp:sortable="Smith B."><surname>Smith</surname> <given-names>B.</given-names></string-name> <article-title hwp:id="article-title-19">Hough Circle Transform</article-title>. In: <source hwp:id="source-21">ImageJ [Internet]</source>. [cited 21 Mar 2021]. Available: <ext-link l:rel="related" l:ref-type="uri" l:ref="https://imagej.net/Hough_Circle_Transform" ext-link-type="uri" xlink:href="https://imagej.net/Hough_Circle_Transform" hwp:id="ext-link-10">https://imagej.net/Hough_Circle_Transform</ext-link></citation></ref><ref id="c22" hwp:id="ref-22" hwp:rev-id="xref-ref-22-1 xref-ref-22-2"><label>22.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.22" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-22"><string-name name-style="western" hwp:sortable="Schindelin J"><surname>Schindelin</surname> <given-names>J</given-names></string-name>, <string-name name-style="western" hwp:sortable="Arganda-Carreras I"><surname>Arganda-Carreras</surname> <given-names>I</given-names></string-name>, <string-name name-style="western" hwp:sortable="Frise E"><surname>Frise</surname> <given-names>E</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kaynig V"><surname>Kaynig</surname> <given-names>V</given-names></string-name>, <string-name name-style="western" hwp:sortable="Longair M"><surname>Longair</surname> <given-names>M</given-names></string-name>, <string-name name-style="western" hwp:sortable="Pietzsch T"><surname>Pietzsch</surname> <given-names>T</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-20">Fiji: an open-source platform for biological-image analysis</article-title>. <source hwp:id="source-22">Nature Methods</source>. <year>2012</year>;<volume>9</volume>: <fpage>676</fpage>–<lpage>682</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.2019</pub-id></citation></ref><ref id="c23" hwp:id="ref-23" hwp:rev-id="xref-ref-23-1 xref-ref-23-2 xref-ref-23-3 xref-ref-23-4"><label>23.</label><citation publication-type="other" citation-type="journal" ref:id="253724v3.23" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-23"><string-name name-style="western" hwp:sortable="Sartori FMO"><surname>Sartori</surname> <given-names>FMO</given-names></string-name>, <string-name name-style="western" hwp:sortable="Buzby C"><surname>Buzby</surname> <given-names>C</given-names></string-name>, <string-name name-style="western" hwp:sortable="Plavskin Y"><surname>Plavskin</surname> <given-names>Y</given-names></string-name>, <string-name name-style="western" hwp:sortable="Siegal ML"><surname>Siegal</surname> <given-names>ML</given-names></string-name>. <article-title hwp:id="article-title-21">High-Throughput Live Imaging of Microcolonies to Measure Heterogeneity in Growth and Gene Expression</article-title>. <source hwp:id="source-23">JoVE (Journal of Visualized Experiments)</source>. <year>2021</year>; <fpage>e62038</fpage>. doi:<pub-id pub-id-type="doi">10.3791/62038</pub-id></citation></ref><ref id="c24" hwp:id="ref-24" hwp:rev-id="xref-ref-24-1"><label>24.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.24" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-24"><string-name name-style="western" hwp:sortable="Westerwalbesloh C"><surname>Westerwalbesloh</surname> <given-names>C</given-names></string-name>, <string-name name-style="western" hwp:sortable="Brehl C"><surname>Brehl</surname> <given-names>C</given-names></string-name>, <string-name name-style="western" hwp:sortable="Weber S"><surname>Weber</surname> <given-names>S</given-names></string-name>, <string-name name-style="western" hwp:sortable="Probst C"><surname>Probst</surname> <given-names>C</given-names></string-name>, <string-name name-style="western" hwp:sortable="Widzgowski J"><surname>Widzgowski</surname> <given-names>J</given-names></string-name>, <string-name name-style="western" hwp:sortable="Grünberger A"><surname>Grünberger</surname> <given-names>A</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-22">A microfluidic photobioreactor for simultaneous observation and cultivation of single microalgal cells or cell aggregates</article-title>. <source hwp:id="source-24">PLOS ONE</source>. <year>2019</year>;<volume>14</volume>: <fpage>e0216093</fpage>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0216093</pub-id></citation></ref><ref id="c25" hwp:id="ref-25" hwp:rev-id="xref-ref-25-1"><label>25.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.25" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-25"><string-name name-style="western" hwp:sortable="Limoli DH"><surname>Limoli</surname> <given-names>DH</given-names></string-name>, <string-name name-style="western" hwp:sortable="Warren EA"><surname>Warren</surname> <given-names>EA</given-names></string-name>, <string-name name-style="western" hwp:sortable="Yarrington KD"><surname>Yarrington</surname> <given-names>KD</given-names></string-name>, <string-name name-style="western" hwp:sortable="Donegan NP"><surname>Donegan</surname> <given-names>NP</given-names></string-name>, <string-name name-style="western" hwp:sortable="Cheung AL"><surname>Cheung</surname> <given-names>AL</given-names></string-name>, <string-name name-style="western" hwp:sortable="O’Toole GA"><surname>O’Toole</surname> <given-names>GA</given-names></string-name>. <article-title hwp:id="article-title-23">Interspecies interactions induce exploratory motility in Pseudomonas aeruginosa. Newman DK, Storz G, Wolfgang M, editors</article-title>. <source hwp:id="source-25">eLife</source>. <year>2019</year>;<volume>8</volume>: <fpage>e47365</fpage>. doi:<pub-id pub-id-type="doi">10.7554/eLife.47365</pub-id></citation></ref><ref id="c26" hwp:id="ref-26" hwp:rev-id="xref-ref-26-1"><label>26.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.26" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-26"><string-name name-style="western" hwp:sortable="Carey JN"><surname>Carey</surname> <given-names>JN</given-names></string-name>, <string-name name-style="western" hwp:sortable="Mettert EL"><surname>Mettert</surname> <given-names>EL</given-names></string-name>, <string-name name-style="western" hwp:sortable="Roggiani M"><surname>Roggiani</surname> <given-names>M</given-names></string-name>, <string-name name-style="western" hwp:sortable="Myers KS"><surname>Myers</surname> <given-names>KS</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kiley PJ"><surname>Kiley</surname> <given-names>PJ</given-names></string-name>, <string-name name-style="western" hwp:sortable="Goulian M."><surname>Goulian</surname> <given-names>M.</given-names></string-name> <article-title hwp:id="article-title-24">Regulated Stochasticity in a Bacterial Signaling Network Permits Tolerance to a Rapid Environmental Change</article-title>. <source hwp:id="source-26">Cell</source>. <year>2018</year>;<volume>173</volume>: <fpage>196</fpage>-<lpage>207</lpage>.e14. doi:<pub-id pub-id-type="doi">10.1016/j.cell.2018.02.005</pub-id></citation></ref><ref id="c27" hwp:id="ref-27" hwp:rev-id="xref-ref-27-1"><label>27.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.27" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-27"><string-name name-style="western" hwp:sortable="Yu Y"><surname>Yu</surname> <given-names>Y</given-names></string-name>, <string-name name-style="western" hwp:sortable="Deng Y"><surname>Deng</surname> <given-names>Y</given-names></string-name>, <string-name name-style="western" hwp:sortable="Reed SH"><surname>Reed</surname> <given-names>SH</given-names></string-name>, <string-name name-style="western" hwp:sortable="Millar CB"><surname>Millar</surname> <given-names>CB</given-names></string-name>, <string-name name-style="western" hwp:sortable="Waters R."><surname>Waters</surname> <given-names>R.</given-names></string-name> <article-title hwp:id="article-title-25">Histone variant Htz1 promotes histone H3 acetylation to enhance nucleotide excision repair in Htz1 nucleosomes</article-title>. <source hwp:id="source-27">Nucleic Acids Research</source>. <year>2013</year>;<volume>41</volume>: <fpage>9006</fpage>–<lpage>9019</lpage>. doi:<pub-id pub-id-type="doi">10.1093/nar/gkt688</pub-id></citation></ref><ref id="c28" hwp:id="ref-28" hwp:rev-id="xref-ref-28-1"><label>28.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.28" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-28"><string-name name-style="western" hwp:sortable="Balaban NQ"><surname>Balaban</surname> <given-names>NQ</given-names></string-name>, <string-name name-style="western" hwp:sortable="Merrin J"><surname>Merrin</surname> <given-names>J</given-names></string-name>, <string-name name-style="western" hwp:sortable="Chait R"><surname>Chait</surname> <given-names>R</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kowalik L"><surname>Kowalik</surname> <given-names>L</given-names></string-name>, <string-name name-style="western" hwp:sortable="Leibler S."><surname>Leibler</surname> <given-names>S.</given-names></string-name> <article-title hwp:id="article-title-26">Bacterial persistence as a phenotypic switch</article-title>. <source hwp:id="source-28">Science</source>. <year>2004</year>;<volume>305</volume>: <fpage>1622</fpage>–<lpage>1625</lpage>.</citation></ref><ref id="c29" hwp:id="ref-29" hwp:rev-id="xref-ref-29-1 xref-ref-29-2 xref-ref-29-3"><label>29.</label><citation publication-type="other" citation-type="journal" ref:id="253724v3.29" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-29"><string-name name-style="western" hwp:sortable="Plavskin Y"><surname>Plavskin</surname> <given-names>Y</given-names></string-name>, <string-name name-style="western" hwp:sortable="Li S"><surname>Li</surname> <given-names>S</given-names></string-name>, <string-name name-style="western" hwp:sortable="Jung H"><surname>Jung</surname> <given-names>H</given-names></string-name>, <string-name name-style="western" hwp:sortable="Sartori FMO"><surname>Sartori</surname> <given-names>FMO</given-names></string-name>, <string-name name-style="western" hwp:sortable="Buzby C"><surname>Buzby</surname> <given-names>C</given-names></string-name>, <string-name name-style="western" hwp:sortable="Mueller H"><surname>Mueller</surname> <given-names>H</given-names></string-name>, <etal>et al.</etal> <source hwp:id="source-29">PIE</source>. <year>2021</year>. Available: <ext-link l:rel="related" l:ref-type="uri" l:ref="http://doi.org/10.5281/zenodo.4987127" ext-link-type="uri" xlink:href="http://doi.org/10.5281/zenodo.4987127" hwp:id="ext-link-11">doi.org/10.5281/zenodo.4987127</ext-link></citation></ref><ref id="c30" hwp:id="ref-30" hwp:rev-id="xref-ref-30-1"><label>30.</label><citation publication-type="website" citation-type="web" ref:id="253724v3.30" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-30"><collab hwp:id="collab-2">The Python Language Reference</collab>. [cited 24 May 2021]. Available: <ext-link l:rel="related" l:ref-type="uri" l:ref="https://docs.python.org/3.7/reference/" ext-link-type="uri" xlink:href="https://docs.python.org/3.7/reference/" hwp:id="ext-link-12">https://docs.python.org/3.7/reference/</ext-link></citation></ref><ref id="c31" hwp:id="ref-31" hwp:rev-id="xref-ref-31-1"><label>31.</label><citation publication-type="other" citation-type="journal" ref:id="253724v3.31" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-31"><string-name name-style="western" hwp:sortable="Bradski G."><surname>Bradski</surname> <given-names>G.</given-names></string-name> <article-title hwp:id="article-title-27">The OpenCV Library</article-title>. <source hwp:id="source-30">Dr Dobb’s Journal of Software Tools</source>. <year>2000</year>.</citation></ref><ref id="c32" hwp:id="ref-32" hwp:rev-id="xref-ref-32-1"><label>32.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.32" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-32"><string-name name-style="western" hwp:sortable="Harris CR"><surname>Harris</surname> <given-names>CR</given-names></string-name>, <string-name name-style="western" hwp:sortable="Millman KJ"><surname>Millman</surname> <given-names>KJ</given-names></string-name>, <string-name name-style="western" hwp:sortable="van der Walt SJ"><surname>van der Walt</surname> <given-names>SJ</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gommers R"><surname>Gommers</surname> <given-names>R</given-names></string-name>, <string-name name-style="western" hwp:sortable="Virtanen P"><surname>Virtanen</surname> <given-names>P</given-names></string-name>, <string-name name-style="western" hwp:sortable="Cournapeau D"><surname>Cournapeau</surname> <given-names>D</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-28">Array programming with NumPy</article-title>. <source hwp:id="source-31">Nature</source>. <year>2020</year>;<volume>585</volume>: <fpage>357</fpage>–<lpage>362</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id></citation></ref><ref id="c33" hwp:id="ref-33" hwp:rev-id="xref-ref-33-1"><label>33.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.33" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-33"><string-name name-style="western" hwp:sortable="Virtanen P"><surname>Virtanen</surname> <given-names>P</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gommers R"><surname>Gommers</surname> <given-names>R</given-names></string-name>, <string-name name-style="western" hwp:sortable="Oliphant TE"><surname>Oliphant</surname> <given-names>TE</given-names></string-name>, <string-name name-style="western" hwp:sortable="Haberland M"><surname>Haberland</surname> <given-names>M</given-names></string-name>, <string-name name-style="western" hwp:sortable="Reddy T"><surname>Reddy</surname> <given-names>T</given-names></string-name>, <string-name name-style="western" hwp:sortable="Cournapeau D"><surname>Cournapeau</surname> <given-names>D</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-29">SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>. <source hwp:id="source-32">Nature Methods</source>. <year>2020</year>;<volume>17</volume>: <fpage>261</fpage>–<lpage>272</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id></citation></ref><ref id="c34" hwp:id="ref-34" hwp:rev-id="xref-ref-34-1"><label>34.</label><citation publication-type="other" citation-type="journal" ref:id="253724v3.34" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-34"><string-name name-style="western" hwp:sortable="McKinney W."><surname>McKinney</surname> <given-names>W.</given-names></string-name> <article-title hwp:id="article-title-30">Data Structures for Statistical Computing in Python</article-title>. <source hwp:id="source-33">Proceedings of the 9th Python in Science Conference</source>. <year>2010; 56–61</year>. doi:<pub-id pub-id-type="doi">10.25080/Majora-92bf1922-00a</pub-id></citation></ref><ref id="c35" hwp:id="ref-35" hwp:rev-id="xref-ref-35-1"><label>35.</label><citation publication-type="website" citation-type="web" ref:id="253724v3.35" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-35"><string-name name-style="western" hwp:sortable="Clark A."><surname>Clark</surname> <given-names>A.</given-names></string-name> <source hwp:id="source-34">Pillow — Pillow documentation</source>. [cited 24 May 2021]. Available: <ext-link l:rel="related" l:ref-type="uri" l:ref="https://pillow.readthedocs.io/en/stable/index.html" ext-link-type="uri" xlink:href="https://pillow.readthedocs.io/en/stable/index.html" hwp:id="ext-link-13">https://pillow.readthedocs.io/en/stable/index.html</ext-link></citation></ref><ref id="c36" hwp:id="ref-36" hwp:rev-id="xref-ref-36-1"><label>36.</label><citation publication-type="other" citation-type="journal" ref:id="253724v3.36" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-36"><string-name name-style="western" hwp:sortable="Kibirige Hassan"><given-names>Hassan</given-names> <surname>Kibirige</surname></string-name>, <string-name name-style="western" hwp:sortable="Lamp Greg"><given-names>Greg</given-names> <surname>Lamp</surname></string-name>, <string-name name-style="western" hwp:sortable="Katins Jan"><given-names>Jan</given-names> <surname>Katins</surname></string-name>, <collab hwp:id="collab-3">gdowding, austin, matthias-k</collab>, <etal>et al.</etal> <source hwp:id="source-35">has2k1/plotnine: v0.8.0. Zenodo; 2021</source>. doi:<pub-id pub-id-type="doi">10.5281/zenodo.4636791</pub-id></citation></ref><ref id="c37" hwp:id="ref-37" hwp:rev-id="xref-ref-37-1"><label>37.</label><citation publication-type="website" citation-type="web" ref:id="253724v3.37" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-37"><collab hwp:id="collab-4">Welcome to Click — Click Documentation (8.0.x)</collab>. [cited 24 May 2021]. Available: <ext-link l:rel="related" l:ref-type="uri" l:ref="https://click.palletsprojects.com/en/8.0.x/" ext-link-type="uri" xlink:href="https://click.palletsprojects.com/en/8.0.x/" hwp:id="ext-link-14">https://click.palletsprojects.com/en/8.0.x/</ext-link></citation></ref><ref id="c38" hwp:id="ref-38" hwp:rev-id="xref-ref-38-1"><label>38.</label><citation publication-type="website" citation-type="web" ref:id="253724v3.38" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-38"><collab hwp:id="collab-5">Welcome to Flask — Flask Documentation (2.0.x</collab>). [cited 24 May 2021]. Available: <ext-link l:rel="related" l:ref-type="uri" l:ref="https://flask.palletsprojects.com/en/2.0.x/" ext-link-type="uri" xlink:href="https://flask.palletsprojects.com/en/2.0.x/" hwp:id="ext-link-15">https://flask.palletsprojects.com/en/2.0.x/</ext-link></citation></ref><ref id="c39" hwp:id="ref-39" hwp:rev-id="xref-ref-39-1"><label>39.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.39" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-39"><string-name name-style="western" hwp:sortable="Lambert G"><surname>Lambert</surname> <given-names>G</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kussell E."><surname>Kussell</surname> <given-names>E.</given-names></string-name> <article-title hwp:id="article-title-31">Memory and Fitness Optimization of Bacteria under Fluctuating Environments</article-title>. <source hwp:id="source-36">PLOS Genetics</source>. <year>2014</year>;<volume>10</volume>: <fpage>e1004556</fpage>. doi:<pub-id pub-id-type="doi">10.1371/journal.pgen.1004556</pub-id></citation></ref><ref id="c40" hwp:id="ref-40" hwp:rev-id="xref-ref-40-1"><label>40.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.40" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-40"><string-name name-style="western" hwp:sortable="Geiler-Samerotte KA"><surname>Geiler-Samerotte</surname> <given-names>KA</given-names></string-name>, <string-name name-style="western" hwp:sortable="Zhu YO"><surname>Zhu</surname> <given-names>YO</given-names></string-name>, <string-name name-style="western" hwp:sortable="Goulet BE"><surname>Goulet</surname> <given-names>BE</given-names></string-name>, <string-name name-style="western" hwp:sortable="Hall DW"><surname>Hall</surname> <given-names>DW</given-names></string-name>, <string-name name-style="western" hwp:sortable="Siegal ML"><surname>Siegal</surname> <given-names>ML</given-names></string-name>. <article-title hwp:id="article-title-32">Selection Transforms the Landscape of Genetic Variation Interacting with Hsp90</article-title>. <source hwp:id="source-37">PLoS Biol</source>. <year>2016</year>;<volume>14</volume>: <fpage>e2000465</fpage>.</citation></ref><ref id="c41" hwp:id="ref-41"><label>41.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.41" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-41"><string-name name-style="western" hwp:sortable="Joseph SB"><surname>Joseph</surname> <given-names>SB</given-names></string-name>, <string-name name-style="western" hwp:sortable="Hall DW"><surname>Hall</surname> <given-names>DW</given-names></string-name>. <article-title hwp:id="article-title-33">Spontaneous mutations in diploid Saccharomyces cerevisiae: more beneficial than expected</article-title>. <source hwp:id="source-38">Genetics</source>. <year>2004</year>;<volume>168</volume>: <fpage>1817</fpage>–<lpage>1825</lpage>.</citation></ref><ref id="c42" hwp:id="ref-42" hwp:rev-id="xref-ref-42-1"><label>42.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.42" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-42"><string-name name-style="western" hwp:sortable="Richardson JB"><surname>Richardson</surname> <given-names>JB</given-names></string-name>, <string-name name-style="western" hwp:sortable="Uppendahl LD"><surname>Uppendahl</surname> <given-names>LD</given-names></string-name>, <string-name name-style="western" hwp:sortable="Traficante MK"><surname>Traficante</surname> <given-names>MK</given-names></string-name>, <string-name name-style="western" hwp:sortable="Levy SF"><surname>Levy</surname> <given-names>SF</given-names></string-name>, <string-name name-style="western" hwp:sortable="Siegal ML"><surname>Siegal</surname> <given-names>ML</given-names></string-name>. <article-title hwp:id="article-title-34">Histone variant HTZ1 shows extensive epistasis with, but does not increase robustness to, new mutations</article-title>. <source hwp:id="source-39">PLoS Genet</source>. <year>2013</year>;<volume>9</volume>: <fpage>e1003733</fpage>.</citation></ref><ref id="c43" hwp:id="ref-43" hwp:rev-id="xref-ref-43-1"><label>43.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.43" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-43"><string-name name-style="western" hwp:sortable="Pan X"><surname>Pan</surname> <given-names>X</given-names></string-name>, <string-name name-style="western" hwp:sortable="Yuan DS"><surname>Yuan</surname> <given-names>DS</given-names></string-name>, <string-name name-style="western" hwp:sortable="Xiang D"><surname>Xiang</surname> <given-names>D</given-names></string-name>, <string-name name-style="western" hwp:sortable="Wang X"><surname>Wang</surname> <given-names>X</given-names></string-name>, <string-name name-style="western" hwp:sortable="Sookhai-Mahadeo S"><surname>Sookhai-Mahadeo</surname> <given-names>S</given-names></string-name>, <string-name name-style="western" hwp:sortable="Bader JS"><surname>Bader</surname> <given-names>JS</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-35">A Robust Toolkit for Functional Profiling of the Yeast Genome</article-title>. <source hwp:id="source-40">Molecular Cell</source>. <year>2004</year>;<volume>16</volume>: <fpage>487</fpage>–<lpage>496</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.molcel.2004.09.035</pub-id></citation></ref><ref id="c44" hwp:id="ref-44" hwp:rev-id="xref-ref-44-1"><label>44.</label><citation publication-type="journal" citation-type="journal" ref:id="253724v3.44" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-44"><string-name name-style="western" hwp:sortable="Huh W-K"><surname>Huh</surname> <given-names>W-K</given-names></string-name>, <string-name name-style="western" hwp:sortable="Falvo JV"><surname>Falvo</surname> <given-names>JV</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gerke LC"><surname>Gerke</surname> <given-names>LC</given-names></string-name>, <string-name name-style="western" hwp:sortable="Carroll AS"><surname>Carroll</surname> <given-names>AS</given-names></string-name>, <string-name name-style="western" hwp:sortable="Howson RW"><surname>Howson</surname> <given-names>RW</given-names></string-name>, <string-name name-style="western" hwp:sortable="Weissman JS"><surname>Weissman</surname> <given-names>JS</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-36">Global analysis of protein localization in budding yeast</article-title>. <source hwp:id="source-41">Nature</source>. <year>2003</year>;<volume>425</volume>: <fpage>686</fpage>–<lpage>691</lpage>.</citation></ref><ref id="c45" hwp:id="ref-45" hwp:rev-id="xref-ref-45-1"><label>45.</label><citation publication-type="other" citation-type="journal" ref:id="253724v3.45" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-45"><string-name name-style="western" hwp:sortable="Bates D"><surname>Bates</surname> <given-names>D</given-names></string-name>, <string-name name-style="western" hwp:sortable="Mächler M"><surname>Mächler</surname> <given-names>M</given-names></string-name>, <string-name name-style="western" hwp:sortable="Bolker B"><surname>Bolker</surname> <given-names>B</given-names></string-name>, <string-name name-style="western" hwp:sortable="Walker S."><surname>Walker</surname> <given-names>S.</given-names></string-name> <article-title hwp:id="article-title-37">Fitting linear mixed-effects models using lme4</article-title>. <source hwp:id="source-42">arXiv</source>. <year>2014</year>.</citation></ref></ref-list><sec id="s6" hwp:id="sec-24"><title hwp:id="title-37">Supplementary Figures</title><fig id="figS1" position="float" fig-type="figure" orientation="portrait" hwp:id="F8" hwp:rev-id="xref-fig-8-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;253724v3/FIGS1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F8</object-id><object-id pub-id-type="publisher-id">figS1</object-id><label>S1 Fig.</label><caption hwp:id="caption-9"><title hwp:id="title-38">Flowchart of automated threshold identification for cell center recognition.</title><p hwp:id="p-83">Core threshold-identification algorithm steps are shown with white background; supplemental algorithm steps are shown with gray background. Fit and refit of the data with the two-Gaussian model are denoted with yellow outline. Steps that yield the final threshold are denoted with blue outlines. Example figures for selected steps and all flags for suspect threshold calculation are denoted in parentheses at specific steps. Parameters (with subscript 1 or 2 corresponding to each of the two Gaussians) are: weighting coefficient (amplitude), a; mean, µ; standard deviation, s.</p><p hwp:id="p-84">Ideally, both distributions have positive means that are clearly distinguished (<bold><xref ref-type="fig" rid="figS2" hwp:id="xref-fig-9-2" hwp:rel-id="F9">S2A Fig</xref></bold>), but this situation may not always hold. To improve the robustness of automated threshold identification, we developed a supplemental algorithm to which images are passed if they fail to produce an adequate fit to the two-Gaussian mixture model with one mean constrained to be positive (adjusted R<sup>2</sup> ≤ 0.85). To do this, we considered all possible shapes of the smoothed log-frequency histogram of the top-hat image, and subjected a wide range of problematic images to testing.</p><p hwp:id="p-85">The supplemental algorithm first tests the source of the poor fit. If the ‘background’ Gaussian distribution is a good fit for the histogram (i.e., the major Gaussian distribution has a similar amplitude and mean to the highest point in the histogram), then the low R<sup>2</sup> is only caused by a poor fit to pixels corresponding to cell bodies. In this case, the backgroundGaussian distribution’s parameter values are used to determine a threshold, as this Gaussian is a good fit for the background pixels, and this is the only needed part for setting the proper threshold. Otherwise, the two-Gaussian model is refit with no constraints on the means. When this fit is very good (adjusted R<sup>2</sup> &gt; 0.85), the algorithm attempts to identify which Gaussian corresponds to background pixels by simple comparisons of the two Gaussian distributions’ parameter values. In some cases, neither Gaussian can confidently be called the background-pixel distribution. In those cases, a sliding-circle method described below is applied to the fit model for threshold determination. If the fit to the two-Gaussian model with unconstrained means is inadequate (adjusted R<sup>2</sup> ≤ 0.85), then the sliding-circle method is applied not to the fit model but to the Savitzky-Golay filter-smoothed data for threshold determination.</p><p hwp:id="p-86">The sliding-circle method aims to find the nadir of the valley between the two peaks. To do this, it applies a circle mask that glides with its center moving along the smoothed data or fit model. At each position, the ratio of the area within the circle that falls below the curve to that above the curve is calculated. The threshold is determined as the position where this ratio, summed across a given position and two of its neighbours on each side, is maximized. Including neighbour points here reduces the impact of random noise in the pixel-intensity values on threshold determination. Because this sliding-circle method is more time-consuming than the curve-fitting method described above, it is only applied when the two-Gaussian fitting procedures fail. Full details of the fitting and threshold-calculation procedure can be found in the commented code.</p></caption><graphic xlink:href="253724v3_figS1" position="float" orientation="portrait" hwp:id="graphic-13"/></fig><fig id="figS2" position="float" fig-type="figure" orientation="portrait" hwp:id="F9" hwp:rev-id="xref-fig-9-1 xref-fig-9-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;253724v3/FIGS2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F9</object-id><object-id pub-id-type="publisher-id">figS2</object-id><label>S2 Fig.</label><caption hwp:id="caption-10"><title hwp:id="title-39">Examples of various approaches to image thresholding</title><p hwp:id="p-87">Left panel: Overlays (yellow) of final colony objects recognized by PIE overlaid on a single brightfield image thresholded in different ways. (Inset: Zoomed-in view of the 130×100-pixel region indicated by white rectangle, to show representative colonies and corresponding recognized outlines.) Scale bar = 25 µm. Right panel: Vertical axis is the density of the log count of pixel intensities of the tophat-filtered image. Blue solid curve shows the smoothed log-frequency histogram of the top-hat image; green dashed curves are the two Gaussian fits; red solid curve is the fit combining the two Gaussians; purple vertical line is the calculated threshold for cell centers in the top-hat image. (A) Default two-gaussian thresholding for which both Gaussian fits have positive means and one mean is far away from the highest point of the smoothed data curve; here, the left-most gaussian represents the ‘background’ pixels. (B) Thresholding performed by applying the sliding-circle method to the two-gaussian fit in (A). (C) Thresholding using the sliding-circle method, which is applied to the smoothed log-frequency histogram of the top-hat image directly (note different smoothing window size used here compared to A and B). Note that despite different thresholds identified in A-C, the resulting colony mask is nearly identical, as a result of gradient-based colony edge detection.</p></caption><graphic xlink:href="253724v3_figS2" position="float" orientation="portrait" hwp:id="graphic-14"/></fig><fig id="figS3" position="float" fig-type="figure" orientation="portrait" hwp:id="F10" hwp:rev-id="xref-fig-10-1 xref-fig-10-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;253724v3/FIGS3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F10</object-id><object-id pub-id-type="publisher-id">figS3</object-id><label>S3 Fig.</label><caption hwp:id="caption-11"><title hwp:id="title-40">Example images with and without cleanup procedure</title><p hwp:id="p-88">(A) An image in which colony outline recognition is improved by the cleanup procedure and (B) an image in which colony outline recognition with the cleanup procedure results in partial loss of colony area from tracking. Magenta, outline without cleanup; green, outline with cleanup; white, overlap. Scale bar = 10 µm.</p></caption><graphic xlink:href="253724v3_figS3" position="float" orientation="portrait" hwp:id="graphic-15"/></fig><fig id="figS4" position="float" fig-type="figure" orientation="portrait" hwp:id="F11" hwp:rev-id="xref-fig-11-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;253724v3/FIGS4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F11</object-id><object-id pub-id-type="publisher-id">figS4</object-id><label>S4 Fig.</label><caption hwp:id="caption-12"><title hwp:id="title-41">Growth rates and lag times in mock UV-treated yeast</title><p hwp:id="p-89">(A-C) Distributions of colony growth rates before and after mock UV stress, and lag times after mock UV stress. <italic toggle="yes">htz1</italic>-colonies grow slower than HTB2-GFP colonies, but the change in mean growth rate after the mock treatment is small, and lag is minimal (D-E) Growth rate and lag after mock UV stress as a function of each colony’s pre-mock stress growth rate, with lines denoting the LOESS regression for each strain. N ∼ 11,000 colonies.</p></caption><graphic xlink:href="253724v3_figS4" position="float" orientation="portrait" hwp:id="graphic-16"/></fig></sec></back></article>
