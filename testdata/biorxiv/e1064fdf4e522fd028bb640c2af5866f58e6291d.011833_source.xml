<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/011833</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;011833</article-id><article-id pub-id-type="other" hwp:sub-type="slug">011833</article-id><article-id pub-id-type="other" hwp:sub-type="tag">011833</article-id><article-version>1.3</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Bioinformatics" hwp:journal="biorxiv"><subject>Bioinformatics</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">SubClonal Hierarchy Inference from Somatic Mutations: automatic reconstruction of cancer evolutionary trees from multi-region next generation sequencing</article-title></title-group><author-notes hwp:id="author-notes-1"><fn id="n1" hwp:id="fn-1" hwp:rev-id="xref-fn-1-1"><label>*</label><p hwp:id="p-1">E-mail: <email hwp:id="email-1">karchin@jhu.edu</email></p></fn></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><name name-style="western" hwp:sortable="Niknafs Noushin"><surname>Niknafs</surname><given-names>Noushin</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-2"><name name-style="western" hwp:sortable="Beleva-Guthrie Violeta"><surname>Beleva-Guthrie</surname><given-names>Violeta</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-3"><name name-style="western" hwp:sortable="Naiman Daniel Q."><surname>Naiman</surname><given-names>Daniel Q.</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-1" hwp:rel-id="aff-2">2</xref></contrib><contrib contrib-type="author" hwp:id="contrib-4"><name name-style="western" hwp:sortable="Karchin Rachel"><surname>Karchin</surname><given-names>Rachel</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-3" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-1" hwp:rel-id="aff-3">3</xref><xref ref-type="author-notes" rid="n1" hwp:id="xref-fn-1-1" hwp:rel-id="fn-1">*</xref></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2 xref-aff-1-3"><label>1</label><institution hwp:id="institution-1">Department of Biomedical Engineering and Institute for Computational Medicine, Johns Hopkins University</institution>, Baltimore, MD, <country>USA</country></aff><aff id="a2" hwp:id="aff-2" hwp:rev-id="xref-aff-2-1"><label>2</label><institution hwp:id="institution-2">Department of Applied Math and Statistics, Johns Hopkins University</institution>, Baltimore, MD, <country>USA</country></aff><aff id="a3" hwp:id="aff-3" hwp:rev-id="xref-aff-3-1"><label>3</label><institution hwp:id="institution-3">Department of Oncology, Johns Hopkins Medical Institutions</institution>, Baltimore, MD, <country>USA</country></aff></contrib-group><pub-date pub-type="epub-original" hwp:start="2015"><year>2015</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2014-11-26T07:54:17-08:00">
    <day>26</day><month>11</month><year>2014</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2015-07-01T09:27:12-07:00">
    <day>1</day><month>7</month><year>2015</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2014-11-26T08:30:25-08:00">
    <day>26</day><month>11</month><year>2014</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2015-07-01T09:40:16-07:00">
    <day>1</day><month>7</month><year>2015</year>
  </pub-date><elocation-id>011833</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2014-11-25"><day>25</day><month>11</month><year>2014</year></date>
<date date-type="accepted" hwp:start="2015-07-01"><day>01</day><month>7</month><year>2015</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2015, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2015</copyright-year><license hwp:id="license-1"><p hwp:id="p-2">The copyright holder for this pre-print is the author. All rights reserved. The material may not be redistributed, re-used or adapted without the author's permission.</p></license></permissions><self-uri xlink:href="011833.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2019/pdf/011833v3.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="011833.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2019/abstracts/011833v3/011833v3.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2019/fulltext/011833v3/011833v3.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><p hwp:id="p-3">Recent improvements in next-generation sequencing of tumor samples and the ability to identify somatic mutations at low allelic fractions have opened the way for new approaches to model the evolution of individual cancers. The power and utility of these models is increased when tumor samples from multiple sites are sequenced. Temporal ordering of the samples may provide insight into the etiology of both primary and metastatic lesions and rationalizations for tumor recurrence and therapeutic failures. Additional insights may be provided by temporal ordering of evolving subclones – cellular subpopulations with unique mutational profiles. Current methods for subclone hierarchy inference tightly couple the problem of temporal ordering with that of estimating the fraction of cancer cells harboring each mutation. We present a new framework that includes a rigorous statistical hypothesis test and a collection of tools that make it possible to decouple these problems, which we believe will enable substantial progress in the field of subclone hierarchy inference. The methods presented here can be flexibly combined with methods developed by others addressing either of these problems. We provide tools to interpret hypothesis test results, which inform phylogenetic tree construction, and we introduce the first genetic algorithm designed for this purpose. The utility of our framework is systematically demonstrated in simulations. For most tested combinations of tumor purity, sequencing coverage, and tree complexity, good power (≥ 0.8) can be achieved and Type 1 error is well controlled when at least three tumor samples are available from a patient. Using data from three published multi-region tumor sequencing studies of (murine) small cell lung cancer, acute myeloid leukemia, and chronic lymphocytic leukemia, in which the authors reconstructed subclonal phylogenetic trees by manual expert curation, we show how different configurations of our tools can identify either a single tree in agreement with the authors, or a small set of trees, which include the authors’ preferred tree. Our results have implications for improved modeling of tumor evolution and the importance of multi-region tumor sequencing.</p><sec hwp:id="sec-1"><title hwp:id="title-2">Author Summary</title><p hwp:id="p-4">Cancer is a genetic disease, driven by DNA mutations. Each tumor is composed of millions of cells with differing genetic profiles that compete with each other for resources in a process similar to Darwinian evolution. We describe a computational framework to model tumor evolution on the cellular level, using next-generation sequencing. The framework is the first to apply a rigorous statistical hypothesis test designed to inform a new search algorithm. Both the test and the algorithm are based on evolutionary principles. The utility of the framework is shown in computer simulations and by automated reconstruction of the cellular evolution underlying murine small cell lung cancers, acute myeloid leukemias and chronic lymophocytic leukemias, from three recent published studies.</p></sec></abstract><counts><page-count count="39"/></counts><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-1">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta></front><body><sec id="s1" hwp:id="sec-2"><title hwp:id="title-3">Introduction</title><p hwp:id="p-5">The clonal evolution hypothesis in cancer states that cancer genomes are shaped by numerous rounds of cellular diversification, selection and clonal expansion [<xref rid="c1" ref-type="bibr" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">1</xref>, <xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">2</xref>]. Recent methods to characterize tumor clonal evolution can be divided into two broad classes – sample tree reconstruction and subclone tree reconstruction. The first class of methods models the history of clonal evolution in an individual as a phylogenetic tree with leaves being the individual’s tumor samples, yielding a relative temporal ordering and estimate of divergence between the samples [<xref rid="c3" ref-type="bibr" hwp:id="xref-ref-3-1" hwp:rel-id="ref-3">3</xref>, <xref rid="c4" ref-type="bibr" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">4</xref>, <xref rid="c5" ref-type="bibr" hwp:id="xref-ref-5-1" hwp:rel-id="ref-5">5</xref>]. The second class aims at reconstructing the history of clonal evolution as a tree, which summarizes lineage relationships between cellular subpopulations [<xref rid="c6" ref-type="bibr" hwp:id="xref-ref-6-1" hwp:rel-id="ref-6">6</xref>, <xref rid="c7" ref-type="bibr" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">7</xref>, <xref rid="c8" ref-type="bibr" hwp:id="xref-ref-8-1" hwp:rel-id="ref-8">8</xref>, <xref rid="c9" ref-type="bibr" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">9</xref>].</p><p hwp:id="p-6">Until single-cell sequencing data is widely available, accurate high resolution modeling of tumor evolution [<xref rid="c10" ref-type="bibr" hwp:id="xref-ref-10-1" hwp:rel-id="ref-10">10</xref>] will likely remain exceedingly difficult, if not impossible. On the other hand, the coverage depth of current next generation sequencing experiments limits the number of cellular subpopulations or <italic toggle="yes">subclones</italic> detectable in tumor samples to a few (approximately 5-10) that have undergone signficant clonal expansions[<xref rid="c11" ref-type="bibr" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">11</xref>, <xref rid="c4" ref-type="bibr" hwp:id="xref-ref-4-2" hwp:rel-id="ref-4">4</xref>, <xref rid="c12" ref-type="bibr" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">12</xref>, <xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">13</xref>, <xref rid="c14" ref-type="bibr" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">14</xref>]. Each of these subclones emerge from a parental population of cells by acquiring additional somatic mutations, and cells within each subclone can be assumed to be homogeneous. Modeling of subclone evolution often involves estimating the fraction of cancer cells harboring each somatic mutation <italic toggle="yes">i.e.</italic>, somatic mutation <italic toggle="yes">cellularity</italic>, which can be inferred from next generation sequencing read count data. For example, PyClone [<xref rid="c15" ref-type="bibr" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">15</xref>] employs a Markov Chain Monte Carlo method to identify groups of mutations with similar cellularities, and SciClone [<xref rid="c16" ref-type="bibr" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">16</xref>] uses variational Bayes mixture models to cluster somatic mutations by their read count frequencies, which can be a proxy for cellularities.</p><p hwp:id="p-7">Most recently, methods that couple the problems of somatic mutation clustering and phylogenetic reconstruction have emerged. PhyloSub applies a tree-structured stick breaking process that introduces tree-compatible cellularity values for mutation clusters [<xref rid="c6" ref-type="bibr" hwp:id="xref-ref-6-2" hwp:rel-id="ref-6">6</xref>]. A combinatoric approach based on an approximation algorithm for binary tree paritions [<xref rid="c7" ref-type="bibr" hwp:id="xref-ref-7-2" hwp:rel-id="ref-7">7</xref>] and a mixture deconvolution algorithm [<xref rid="c8" ref-type="bibr" hwp:id="xref-ref-8-2" hwp:rel-id="ref-8">8</xref>] have also been developed. However to our knowledge, most recently published studies of multi-region tumor sequencing continue to employ manual curation to construct a subclone phylogeny, after mutation cellularity has been estimated computationally [<xref rid="c12" ref-type="bibr" hwp:id="xref-ref-12-2" hwp:rel-id="ref-12">12</xref>, <xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-2" hwp:rel-id="ref-13">13</xref>, <xref rid="c14" ref-type="bibr" hwp:id="xref-ref-14-2" hwp:rel-id="ref-14">14</xref>].</p><p hwp:id="p-8">We propose that progress in methods to reconstruct subclonal phylogenies will be substantially enabled by decoupling the problems of temporal ordering of subclones from that of mutation cellularity estimation. The SubClonal Hierarchy Inference from Somatic Mutations (SCHISM) framework described here can incorporate a variety of methods to estimate the cellularity of individual mutations, the cellularity of mutation clusters, and to build phylogenetic trees. First, we derive a novel mathematical formulation of assumptions about lineage precedence and lineage divergence in tumor evolution that have been fundamental to other subclone tree reconstruction methods [<xref rid="c8" ref-type="bibr" hwp:id="xref-ref-8-3" hwp:rel-id="ref-8">8</xref>, <xref rid="c6" ref-type="bibr" hwp:id="xref-ref-6-3" hwp:rel-id="ref-6">6</xref>, <xref rid="c7" ref-type="bibr" hwp:id="xref-ref-7-3" hwp:rel-id="ref-7">7</xref>, <xref rid="c9" ref-type="bibr" hwp:id="xref-ref-9-2" hwp:rel-id="ref-9">9</xref>]. Lineage precedence is modeled in terms of a statistical hypothesis test, based on a generalized likelihood ratio. Hypothesis test results are combined with lineage divergence assumptions and formulated as a fitness function that can be used to rank tree topologies, generated by a phylogenetic algorithm. In this work, we designed an implementation of genetic algorithms to build phylogenetic trees. However, the fitness function can also be combined with other approaches to phylogenetic tree reconstruction. The hypothesis test can be combined with any method to estimate mutation or cluster cellularities to infer their temporal orderings.</p><p hwp:id="p-9">We use simulations to evaluate the power of the hypothesis test and show that for many combinations of tumor purity, sequencing coverage, and phylogenetic tree complexity, the hypothesis test has good power (≥ 0.8) and Type 1 error is well controlled, when at least three samples from a patient are available. The simulations also confirm that the problem of subclonal phylogenetic tree reconstruction is underdetermined in many settings when the tumor sample count per individual is smaller than the number of subclones <italic toggle="yes">i.e</italic>, nodes in the phylogenetic tree. In these cases, we may see that the genetic algorithm identifies multiple equally plausible phylogenetic trees. However, when the problem is sufficiently determined, in general when the number of samples equals or exceeds the tumor sample count, the genetic algorithm reliably reconstructs the true tree, in most combinations listed above.</p><p hwp:id="p-10">Using data from three published multi-region tumor sequencing studies of murine small cell lung cancer [<xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-3" hwp:rel-id="ref-13">13</xref>], acute myeloid leukemia [<xref rid="c12" ref-type="bibr" hwp:id="xref-ref-12-3" hwp:rel-id="ref-12">12</xref>] and chronic lymophocytic leukemia [<xref rid="c14" ref-type="bibr" hwp:id="xref-ref-14-3" hwp:rel-id="ref-14">14</xref>], we show how SCHISM can be configured with a variety of inputs. For all samples in these three studies, SCHISM identified either a single tree in agreement with the tree reconstructed manually by the authors, or a small set of trees, which include the authors’ published tree.</p></sec><sec id="s2" hwp:id="sec-3"><title hwp:id="title-4">Results</title><sec id="s2a" hwp:id="sec-4"><title hwp:id="title-5">Simulations</title><sec id="s2a1" hwp:id="sec-5"><title hwp:id="title-6">Generalized likelihood ratio hypothesis test</title><p hwp:id="p-11">The hypothesis test yielded good power on average and Type 1 error was well controlled (<xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Fig. 1</xref>). Power improved as the number of samples per individual increased. As the number of nodes in the subclone tree increased, yielding a more complex tree, more samples were required to achieve the same level of power. Even at the lowest purity level (50%) included in our experiments, good power (<italic toggle="yes">≥</italic> 0.8) was achieved with 1000X coverage and three or more samples.</p><fig id="fig1" position="float" orientation="portrait" fig-type="figure" hwp:id="F1" hwp:rev-id="xref-fig-1-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Figure 1.</label><caption hwp:id="caption-1"><title hwp:id="title-7">Power and Type 1 error of hypothesis test on simulated data.</title><p hwp:id="p-12">For each combination of coverage and purity, results are shown for trees with node counts from three to eight. Each curve was computed by taking the mean over all <italic toggle="yes">instances</italic> and all replicates for each node count. Curves with circular marks show power and curves with triangular marks show Type 1 error. Transparent coloring indicates <italic toggle="yes">±</italic>1<italic toggle="yes">SE</italic>. Dotted line indicates power=0.8.</p></caption><graphic xlink:href="011833_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig></sec><sec id="s2a2" hwp:id="sec-6"><title hwp:id="title-8">Automated subclone tree reconstruction</title><p hwp:id="p-13">The performance of the genetic algorithm (GA) used for tree reconstruction varied substantially, depending on the simulation inputs: number of tumor samples, node count and topology of the true tree, mutation cluster cellularity values, tumor purity, and sequencing coverage (<xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-1" hwp:rel-id="F2">Fig. 2</xref>). Given sample count exceeding or equal to node count, the GA most frequently (with probability ≥ 0.5) identified the true tree or a pair of maximum fitness trees that included the true tree. This probability increased to ≥ 0.75 at high purity (0.9) and coverage (1000X). As expected, simpler trees, <italic toggle="yes">e.g.</italic>, 3- or 4-node trees, were frequently identified even when the sample count was small. As trees grew more complex, a larger sample count was required, and even the most complex trees in the simulation, which had 8 nodes, were identified frequently when 10 samples were available. However, we also identified combinations of inputs for which the GA had limited success in finding the true tree. We decomposed the performance of the GA into two stages. In Stage 1, we assessed whether the tree reconstruction problem was sufficiently determined by our inputs, meaning that a single maximum fitness tree or a pair of two maximum fitness trees was identified. The GA was more likely to fail in Stage 1 when sample count was smaller than node count (<xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-2" hwp:rel-id="F2">Fig. 2</xref> A1,B1). Furthermore, the settings of purity and sequencing coverage used in our simulations had less of an effect on Stage 1 success than sample count and tree node count. In Stage 2, we assessed whether the single maximum fitness or pair of maximum fitness trees included the true tree. Samples counts ≥ 5 had the most stable Stage 2 success rates, and the correct tree was recovered with increasing frequency, given higher sample counts, coverage, and purity. As expected, probability of Stage 2 success was higher for trees with smaller node counts. Our estimates of Stage 2 success were noisy when sample count was small and node count high. This behavior was a result of higher failure rates at Stage 1 under these conditions (<xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-3" hwp:rel-id="F2">Fig. 2</xref> A2,B2).</p><fig id="fig2" position="float" orientation="portrait" fig-type="figure" hwp:id="F2" hwp:rev-id="xref-fig-2-1 xref-fig-2-2 xref-fig-2-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Figure 2.</label><caption hwp:id="caption-2"><title hwp:id="title-9">Performance of the genetic algorithm evaluated in two stages.</title><p hwp:id="p-14">Stage 1: Fraction of simulation runs where the genetic algorithm’s fitness function identified either a single maximum fitness tree (A1) or two maximum fitness trees (B1). Stage 2: Given success in stage 1, fraction of simulation runs where the correct tree was either the single maximum fitness tree (A2) or one of the top two maximum fitness trees (B2). For each combination of coverage and purity, results are shown for trees with node counts from three to eight. Simulations where (sample count) ≥ (node count) are marked by a double circle.</p></caption><graphic xlink:href="011833_fig2" position="float" orientation="portrait" hwp:id="graphic-2"/></fig></sec></sec><sec id="s2b" hwp:id="sec-7"><title hwp:id="title-10">Multi-sample sequencing studies</title><p hwp:id="p-15">Recent studies of small cell lung cancer (SCLC) in mice [<xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-4" hwp:rel-id="ref-13">13</xref>], acute myeloid leukemia (AML) [<xref rid="c12" ref-type="bibr" hwp:id="xref-ref-12-4" hwp:rel-id="ref-12">12</xref>], and chronic lymphocytic leukemia (CLL) [<xref rid="c14" ref-type="bibr" hwp:id="xref-ref-14-4" hwp:rel-id="ref-14">14</xref>] attempted to infer the subclonal phylogeny underlying tumor progression, based on sequencing of multiple tumor samples. All of the studies applied computational methods to cluster somatic mutations. In some cases mutation cluster cellularities were provided, while in others read counts or cluster mean variant allele fraction was provided. The authors did not use computational methods to reconstruct the subclonal phylogenies.</p><p hwp:id="p-16">We applied SCHISM to these datasets, using a variety of configurations. In cases where mutation cluster cellularities were available [<xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-5" hwp:rel-id="ref-13">13</xref>], we used the hypothesis test on pairs of mutation clusters. If mean variant allele fraction for clusters was available [<xref rid="c12" ref-type="bibr" hwp:id="xref-ref-12-5" hwp:rel-id="ref-12">12</xref>], we inferred cellularity as described in (<xref rid="eqnS4" ref-type="disp-formula" hwp:id="xref-disp-formula-37-1" hwp:rel-id="disp-formula-37">Eq. S4</xref>) and used the hypothesis test on pairs of mutation clusters. When only read counts and mutation cluster assignments were available [<xref rid="c12" ref-type="bibr" hwp:id="xref-ref-12-6" hwp:rel-id="ref-12">12</xref>, <xref rid="c14" ref-type="bibr" hwp:id="xref-ref-14-5" hwp:rel-id="ref-14">14</xref>], we used our own naive estimator to derive cellularity values, and applied the hypothesis test to pairs of mutations. For all configurations, we constructed a precedence order violation matrix for all pairs of mutations (<italic toggle="yes">POV matrix</italic>) or all pairs of mutation clusters (<italic toggle="yes">CPOV matrix</italic>) and ran the genetic algorithm. This approach consistently identified phylogenies identical to those manually constructed by the authors as either the single maximum fitness tree or among a small set trees tied for the maximum fitness, in underdetermined cases. In the AML study, the authors did not construct phylogenies for three out of eight patients, but they predicted which of two general clonal evolution models best explained relapse in these three patients. For two of these patients, our phylogenies were in agreement with the authors’ clonal evolution model. For the third patient, our phylogenies suggested that either of the two clonal evolution models might explain relapse. Methods details are all described in Methods (sections on Hypothesis test, Precedence Order Violation Matrix, Application to mutation clusters, Vote Aggregation and Subclonse size estimation) and Supplementary Methods (sections on Naive mutation cellularity estimate and Cluster cellularity estimation).</p><sec id="s2b1" hwp:id="sec-8"><title hwp:id="title-11">Murine small cell lung carcinoma</title><p hwp:id="p-17">This study sequenced small cell lung cancer (SCLC) tumor samples from a cohort of transgenic mice with lung-specific Trp53 and Rb1 compound deletion. The full study included whole exome sequencing (WES) (150X coverage) of 27 primary tumors and metastases from six individual animals [<xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-6" hwp:rel-id="ref-13">13</xref>]. The authors applied ABSOLUTE to call copy number alterations, combine them with mutation read counts, and estimate cellularity values of each mutation. Mutation clusters were defined by clustering mutations with similar cellularity values. For three of these animals (with identifiers 3588, 3151, 984), the authors manually built subclonal phylogenetic trees.</p><p hwp:id="p-18">Using the hypothesis test on the ABSOLUTE cluster mean cellularities (<xref rid="fig5" ref-type="fig" hwp:id="xref-fig-5-1" hwp:rel-id="F5">Fig. 5</xref> in [<xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-7" hwp:rel-id="ref-13">13</xref>]), we generated a cluster-level precedence order violation matrix (CPOV) and a cluster cellularity by sample matrix for each mouse.</p><p hwp:id="p-19">Animals 3588 and 3151 had data available for one primary and two metatastic tumors. For animal 3588, SCHISM identified an 8-node single maximum fitness tree and that tree (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-1" hwp:rel-id="F3">Fig. 3A</xref>) was identical to the authors’ manually built tree. For animal 3151, SCHISM identified six 9-node maximum fitness trees, and one of these trees was identical to the authors’ tree. While the problem was insufficiently determined, interestingly the trees shared a significant number of lineage relationships, and the main discrepancies among trees were the parental lineage for Clone3 and Clone2b (using notation from [<xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-8" hwp:rel-id="ref-13">13</xref>]) (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-2" hwp:rel-id="F3">Fig. 3B</xref>). For animal 984, data was available for one primary one metastatic tumor. SCHISM identified six 7-node maximum fitness trees (<italic toggle="yes">i.e.,</italic> underdetermined problem), and one of these trees was identical to the authors’ tree (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-3" hwp:rel-id="F3">Fig. 3C</xref>).</p><fig id="fig3" position="float" orientation="portrait" fig-type="figure" hwp:id="F3" hwp:rev-id="xref-fig-3-1 xref-fig-3-2 xref-fig-3-3 xref-fig-3-4"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/FIG3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F3</object-id><object-id pub-id-type="publisher-id">fig3</object-id><label>Figure 3.</label><caption hwp:id="caption-3"><title hwp:id="title-12">Reconstruction of subclonal phylogenies in murine models of SCLC.</title><p hwp:id="p-20"><bold>A. Animal 3588.</bold> SCHISM identified a single maximum fitness 8-node tree using one primary and two metastatic tumors. <bold>B. Animal 3151.</bold> Six maximum fitness 9-node trees were identified using one primary and two metastatic tumors. <bold>C. Animal 984.</bold> Six maximum fitness 7-node trees were identified using one primary and one metastatic tumor. Solid arrows represent lineage relationships shared by all six trees and dashed arrows represent lineage relationships shared by only a subset of the trees. Each arrow is labeled with the fraction of maximum fitness trees that include the lineage relationship. Highlighted arrows indicate the tree manually constructed by the study authors. GL = germline state. Cluster precedence order violation (CPOV) matrices are shown to the left of each tree. Columns and rows represent subclones (or Clones in the terminology of [<xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-9" hwp:rel-id="ref-13">13</xref>]). Each red square represents a pair of subclones (I,J) for which the null hypothesis that I could be the parent of J was rejected. Each blue square represents a pair for which the null hypothesis could not be rejected.</p></caption><graphic xlink:href="011833_fig3" position="float" orientation="portrait" hwp:id="graphic-3"/></fig></sec><sec id="s2b2" hwp:id="sec-9"><title hwp:id="title-13">Chronic lymphocytic leukemia</title><p hwp:id="p-21">This longitudinal study of subclonal evolution in B-cell CLL tracked three patients (CLL 003, CLL006, CLL077) over a period of up to seven years [<xref rid="c14" ref-type="bibr" hwp:id="xref-ref-14-6" hwp:rel-id="ref-14">14</xref>]. For each patient, five longitudinal peripheral blood samples were collected, and each sample was whole-genome sequenced. For selected somatically mutated sites, they further applied targeted deep sequencing (at reported 100,000X coverage). K-means clustering and expert curation were used to infer mutation clusters and subclonal phylogenetic trees were manually built.</p><p hwp:id="p-22">We used mutation cluster assignments and read counts from targeted deep sequencing, for each mutation in each sample (Tables S6, S7, or S8 in [<xref rid="c14" ref-type="bibr" hwp:id="xref-ref-14-7" hwp:rel-id="ref-14">14</xref>]). Purity was estimated by identifying the mutation cluster with the maximum mean variant allele frequency in each sample. Next, based on purity and read count, we calculated cellularity (and standard error) for each mutation in diploid or copy number=1 regions with the naive estimator. The hypothesis test was performed for each pair of mutations and a cluster precedence order violation (CPOV) matrix was constructed, using a vote aggregation scheme (Methods).</p><p hwp:id="p-23">For patients CLL003 and CLL077, SCHISM identified a single 4-node maximum fitness tree that was identical to the authors’ manually built tree (<xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-1" hwp:rel-id="F4">Fig. 4A,C</xref>). For patient CLL006, two 5-node maximum fitness trees were identified, and one was identical to the authors’ tree (<xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-2" hwp:rel-id="F4">Fig. 4B</xref>).</p><fig id="fig4" position="float" orientation="portrait" fig-type="figure" hwp:id="F4" hwp:rev-id="xref-fig-4-1 xref-fig-4-2 xref-fig-4-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/FIG4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F4</object-id><object-id pub-id-type="publisher-id">fig4</object-id><label>Figure 4.</label><caption hwp:id="caption-4"><title hwp:id="title-14">Reconstruction of subclonal phylogenies in CLL.</title><p hwp:id="p-24"><bold>A. CLL003.</bold> SCHISM identified a single maximum fitness 4-node tree using 5 samples. <bold>B. CLL006.</bold> Two maximum fitness 5-node trees were identified using 5 samples. Solid arrows represent lineage relationships shared by both trees and dashed arrows represent lineage relationships specific to one of the trees. <bold>C. CLL077.</bold> A single maximum fitness 4-node tree was identified using 5 samples. Each arrow is labeled with the fraction of maximum fitness trees that include the lineage relationship. Highlighted arrows indicate the tree manually constructed by the study authors. GL = germline state. Cluster precedence order violation (CPOV) matrices are shown to the left of each tree. Columns and rows represent mutation clusters. Each square represents a pair of mutation clusters (I,J) and the numeric value in the square shows the fraction of mutation pairs (i,j) for which the null hypothesis was rejected (Section Vote Aggregation). The mutated genes assigned to each cluster in [<xref rid="c14" ref-type="bibr" hwp:id="xref-ref-14-8" hwp:rel-id="ref-14">14</xref>, <xref rid="c6" ref-type="bibr" hwp:id="xref-ref-6-4" hwp:rel-id="ref-6">6</xref>] are listed.</p></caption><graphic xlink:href="011833_fig4" position="float" orientation="portrait" hwp:id="graphic-4"/></fig><fig id="fig5" position="float" orientation="portrait" fig-type="figure" hwp:id="F5" hwp:rev-id="xref-fig-5-1 xref-fig-5-2 xref-fig-5-3 xref-fig-5-4 xref-fig-5-5 xref-fig-5-6 xref-fig-5-7 xref-fig-5-8"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/FIG5</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F5</object-id><object-id pub-id-type="publisher-id">fig5</object-id><label>Figure 5.</label><caption hwp:id="caption-5"><title hwp:id="title-15">Reconstruction of subclonal phylogenies in AML.</title><p hwp:id="p-25">For each patient, two samples were available from primary and relapse cancers. Purple nodes represent mutation clusters present in both primary and relapse samples. Gray nodes are present in primary but not relapse and green nodes are present in the relapse but not primary. <bold>A. AML1.</bold> SCHISM identified a single maximum fitness 5-node tree. CPOV matrix columns and rows represent mutation clusters. Each square represents a pair of mutation clusters (I,J) and the numeric value in the square shows the fraction of mutation pairs (i,j) for which the null hypothesis was rejected (Section Vote Aggregation). <bold>B. AML27,35,40.</bold> For each patient, SCHISM identified a single maximum fitness 2-node tree. <bold>C. AML15.</bold> Two maximum fitness 3-node trees were identified. Solid arrows represent lineage relationships shared by both trees and dashed arrows represent lineage relationships specific to one of the trees. <bold>D. AML28.</bold> A single maximum fitness 5-node tree. <bold>E. AML31.</bold> A single maximum fitness 4-node tree was identified. <bold>F. AML43.</bold> A single maximum fitness 4-node tree. Each arrow is labeled with the fraction of maximum fitness trees that include the lineage relationship. Highlighted arrows indicate the tree manually constructed by the study authors, if it was available. GL = germline state. CL = cluster. Cluster precedence order violation (CPOV) matrices are shown to the left of each tree. Columns and rows represent mutation clusters. Each red square represents a pair of mutation clusters (I,J) for which the null hypothesis that I could be the parent of J was rejected. Each blue square represents a pair for which the null hypothesis could not be rejected.</p></caption><graphic xlink:href="011833_fig5" position="float" orientation="portrait" hwp:id="graphic-5"/></fig></sec><sec id="s2b3" hwp:id="sec-10"><title hwp:id="title-16">Acute myeloid leukemia</title><p hwp:id="p-26">This study of relapse in acute myeloid leukemia (AML) consisted of whole genome sequencing for primary and relapse samples from eight patients (AML1, AML15, AML27, AML28, AML31, AML35, AML40, AML43) [<xref rid="c12" ref-type="bibr" hwp:id="xref-ref-12-7" hwp:rel-id="ref-12">12</xref>]. For AML1, the authors identified mutation clusters with MClust [<xref rid="c17" ref-type="bibr" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">17</xref>] and manually constructed a subclonal phylogeny. For the other patients, mutation cluster means were inferred using kernel density estimation. Phylogenetic trees were constructed as in AML1 for four of the patients (AML40, AML27, AML35, AML43).</p><p hwp:id="p-27">The authors described two distinct models of clonal evolution to explain relapse. In the first model, the dominant subclone present in the primary leukemia is not eliminated by therapy, but it acquires new mutations and thrives in the relapse. The patient may not have received a sufficiently aggressive treatment or may have harbored resistance mutations. In the second model, the dominant subclone is eliminated by therapy and a minor subclone in the primary acquires new mutations and thrives in the relapse, while some mutations in the primary are absent in the relapse. The mutations that allow the minor subclone to survive may have been present early on or have been acquired during or after chemotherapy, or both [<xref rid="c12" ref-type="bibr" hwp:id="xref-ref-12-8" hwp:rel-id="ref-12">12</xref>]. For patients where the authors had constructed a tree, we compared it to the best tree(s) identified by SCHISM. For the other patients, we considered whether the SCHISM trees were consistent with their suggested clonal evolution models.</p><p hwp:id="p-28">For AML1, we used the published variant allele fractions and mutation cluster assignments (Table S5a in [<xref rid="c12" ref-type="bibr" hwp:id="xref-ref-12-9" hwp:rel-id="ref-12">12</xref>]). In each sample, the naive estimator was used to derive cellularity values (Supplementary Methods) for the subset of mutations which were located in diploid or hemizygous region and had coverage of ≥ 50. Hypothesis tests were performed for pairs of mutations and the CPOV matrix was constructed by voting (Methods). SCHISM identified a single maximum fitness tree, which was identical to the authors’ manually generated tree (<xref rid="fig5" ref-type="fig" hwp:id="xref-fig-5-2" hwp:rel-id="F5">Fig. 5A</xref>). For the remaining seven patients, we used the published cluster mean variant allele frequencies (Table S10 in [<xref rid="c12" ref-type="bibr" hwp:id="xref-ref-12-10" hwp:rel-id="ref-12">12</xref>]) and combined them with the authors’ purity estimates to infer cluster mean cellularities (<xref rid="eqnS4" ref-type="disp-formula" hwp:id="xref-disp-formula-37-2" hwp:rel-id="disp-formula-37">Eq. S4</xref>).</p><p hwp:id="p-29">Patients AML27, AML35, and AML40 were reported to harbor only two mutation clusters each, and SCHISM identified a single maximum fitness tree for each, which was identical to the authors’ tree (<xref rid="fig5" ref-type="fig" hwp:id="xref-fig-5-3" hwp:rel-id="F5">Fig. 5B</xref>). Patient AML15 was reported to harbor three mutation clusters, and SCHISM identified two maximum fitness trees. Each tree supported one of the authors’ two alternative models of AML relapse (<xref rid="fig5" ref-type="fig" hwp:id="xref-fig-5-4" hwp:rel-id="F5">Fig. 5C</xref>). In one tree, the relapse-specific mutation cluster 3 descended from the dominant subclone in the primary. This subclone consisted of the 92% of cells in the primary that carried both cluster 1 and cluster 2 mutations. In the other tree, it descended from the minor subclone in the primary (the 8% of cells in the primary carrying only cluster 1 mutations). Patient AML28 had five mutation clusters, and SCHISM identified a single maximum fitness tree. While no subclone tree for AML28 was constructed by the authors, they proposed that this patient fit the second clonal evolution model of relapse driven by a minor subclone in the primary. The SCHISM tree was consistent with this model, as the relapse-specific mutation cluster 5 descended from a minor subclone (1% of cells), which harbored only mutation cluster 1, and mutation clusters 3 and 4, which were present in the primary were absent in the relapse cluster (<xref rid="fig5" ref-type="fig" hwp:id="xref-fig-5-5" hwp:rel-id="F5">Fig. 5D</xref>). Patient AML31 had four mutation clusters, and SCHISM identified a single maximum fitness tree (<xref rid="fig5" ref-type="fig" hwp:id="xref-fig-5-6" hwp:rel-id="F5">Fig. 5E</xref>). Although no tree was provided by the authors, they proposed that this patient fit the second clonal evolution model, which was consistent with this tree. In the tree, the relapse-specific mutation cluster 4 descended from a minor subclone (21% of cells) in the primary. Cells in this subclone carried mutations in cluster 1, but not clusters 2 and 3. AML43 was reported to have four mutation clusters and SCHISM identified a single maximum fitness tree that was identical to the authors’ tree (<xref rid="fig5" ref-type="fig" hwp:id="xref-fig-5-7" hwp:rel-id="F5">Fig. 5F</xref>).</p></sec><sec id="s2b4" hwp:id="sec-11"><title hwp:id="title-17">SCHISM runtime</title><p hwp:id="p-30">On a MacBook Pro labptop with Intel Core i7, 4 GB of memory and 2.7 GHz CPU, a GA run with 20 generations modeling three samples and nine mutation clusters completed in 2 minutes.</p></sec></sec></sec><sec id="s3" hwp:id="sec-12"><title hwp:id="title-18">Discussion</title><p hwp:id="p-31">Representing tumor evolution as a phylogenetic tree of cell subpopulations can inform critical questions regarding the temporal order of mutations driving tumor progression and the mechanisms of recurrence and metastasis. As the cost of next generation sequencing with high coverage depth decreases, many labs are employing multi-region tumor sequencing strategies to study tumor evolution. However, going from multi-region sequencing data to a subclonal phylogeny is a computationally challenging task and methods are still in their early days. Here we derived a novel framework to approach the problem. We described a statistical hypothesis test and mathematical representation of constraints on subclone phylogenies, based on rules of lineage precedence and divergence that have informed previous works in the field. We designed a new fitness function that can be used to constrain the process of subclone tree reconstruction. These tools comprise a flexible framework called SCHISM, which can be integrated with many existing methods for mutation cellularity estimation and phylogenetic reconstruction. Combined with a new implementation of genetic algorithms, we demonstrated the utility of SCHISM with simulations and by application to published multi-region sequencing studies. We were able to reconstruct the subclonal phylogenies derived by manual curation in these studies with high fidelity.</p><p hwp:id="p-32">Today’s multi-region sequencing studies may often have a limited number of tumor samples, due to restrictions on the number of biopsies likely to be performed for living patients. Our results suggest that even when only a few samples are available, more accurate estimates of mutation cellularity at higher purity and coverage increase the power of the SCHISM hypothesis test. A more subtle result is that the power and Type 1 error of the test also depend on the accuracy of the standard error estimates for cellularity values. The dependency can be seen directly in the derivation of the test statistic itself (Methods <xref ref-type="disp-formula" rid="eqn13" hwp:id="xref-disp-formula-13-1" hwp:rel-id="disp-formula-13">Eq. 13</xref>) and indirectly in the ability of SCHISM to reconstruct complex subclone phylogenies in murine models of SCLC [<xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-10" hwp:rel-id="ref-13">13</xref>]. Although only two or three samples were sequenced from each mouse, the authors provided robust statistical estimates of mutation cluster cellularity and standard deviations.</p><p hwp:id="p-33">To our knowledge, our study is the first to apply genetic algorithms to the problem of subclone tree reconstruction. Current sequencing technologies limit discovery to approximately 5-10 major subclones in patient tumor samples, equivalent to phylogenetic trees with 5-10 nodes. It is likely that in the near future, improved technology will enable discovery of a larger number of subclones. The number of topologies for a tree with <italic toggle="yes">n</italic> nodes is equal to <italic toggle="yes">n</italic><sup><italic toggle="yes">n</italic>-2</sup> [<xref rid="c18" ref-type="bibr" hwp:id="xref-ref-18-1" hwp:rel-id="ref-18">18</xref>]. Therefore it becomes increasingly difficult to use exhaustive enumeration over all topologies when <italic toggle="yes">n</italic> = 9 (approximately 4.8 million topologies), <italic toggle="yes">n</italic> = 10 (approximately 100 million topologies), and certainly for <italic toggle="yes">n</italic> &gt; 10. The genetic algorithm presented here enables heuristic searches over very large numbers of topologies and consequent evaluation of candidate phylogenetic trees, according to the extent to which they violated the rules of lineage precedence and divergence. However, the genetic algorithm will not always succeed when <italic toggle="yes">n</italic> is very large, and its success depends on the topology of the true tree and the distribution of mutation cluster cellularities (Supplementary Results). Alternative heuristic approaches might also prove useful in this setting such as tabu search [<xref rid="c19" ref-type="bibr" hwp:id="xref-ref-19-1" hwp:rel-id="ref-19">19</xref>, <xref rid="c20" ref-type="bibr" hwp:id="xref-ref-20-1" hwp:rel-id="ref-20">20</xref>], simulating annealing [<xref rid="c21" ref-type="bibr" hwp:id="xref-ref-21-1" hwp:rel-id="ref-21">21</xref>, <xref rid="c22" ref-type="bibr" hwp:id="xref-ref-22-1" hwp:rel-id="ref-22">22</xref>], or iterated local search [<xref rid="c23" ref-type="bibr" hwp:id="xref-ref-23-1" hwp:rel-id="ref-23">23</xref>].</p><p hwp:id="p-34">Currently, the topology cost component of the fitness function is informed by a statistical hypothesis test that addresses a dichotomous question about the ancestral relationship of two nodes. The mass cost is a numeric measure that quantifies the extent to which the lineage divergence rule is violated, and tree fitness depends on this numeric value, rather than on acceptance or rejection of a null hypothesis. We took into consideration the power loss that would result from a statistical test based on mass cost. Such a test would depend on the estimated cellularities of a parental cluster and the sum of cellularities of its child clusters (Methods <xref ref-type="disp-formula" rid="eqn31" hwp:id="xref-disp-formula-31-1" hwp:rel-id="disp-formula-31">Eq. 31</xref>). A possible null hypothesis could be that the difference between parental and sum of child cluster cellularities is non-negative (no violation of lineage divergence rule), and where the absolute value of the difference measures the magnitude of the violation. This test would be underpowered compared to the topology cost test, because the expected confidence interval for the sum of mutation cluster cellularity values (Methods <xref ref-type="disp-formula" rid="eqn2" hwp:id="xref-disp-formula-2-1" hwp:rel-id="disp-formula-2">Eq. 2</xref>) will be larger than that for a single mutation cluster. Thus, we chose to focus our hypothesis testing framework on the topology cost. The value of our current strategy to include a numeric measure of mass cost in the fitness function is explored in (Supplementary Results and <xref rid="figS5" ref-type="fig" hwp:id="xref-fig-13-1" hwp:rel-id="F13">Fig. S5</xref>).</p><p hwp:id="p-35">The fitness function used in this work could be further improved by incorporating measures of mutation or mutation cluster importance, using knowledge about ordering of specific driver mutations based on tumor biology, synthetic lethality, or results from single-cell sequencing. The genetic algorithm used in this work could itself be improved by the addition of online termination criteria and adaptive modulation of its key parameters, such as crossover and mutation probabilities.</p><p hwp:id="p-36">A number of excellent methods to reconstruct subclonal phylogenies have been recently published [<xref rid="c8" ref-type="bibr" hwp:id="xref-ref-8-4" hwp:rel-id="ref-8">8</xref>, <xref rid="c7" ref-type="bibr" hwp:id="xref-ref-7-4" hwp:rel-id="ref-7">7</xref>, <xref rid="c6" ref-type="bibr" hwp:id="xref-ref-6-5" hwp:rel-id="ref-6">6</xref>, <xref rid="c9" ref-type="bibr" hwp:id="xref-ref-9-3" hwp:rel-id="ref-9">9</xref>], and we believe all of them are likely to be useful to the cancer research community. A feature matrix comparing attributes of SCHISM to four other published methods is in <xref rid="tblS1" ref-type="table" hwp:id="xref-table-wrap-1-1" hwp:rel-id="T1">Table S1</xref>. Key contributions of SCHISM are that its genetic algorithm can handle more complex tree topologies than are tractable by brute force while retaining lack of in-built bias towards linear or branched tree topologies, its modularity, and its capability to integrate information from multiple samples (biopsies from a patient) in a new statistical framework.</p><table-wrap id="tblS1" orientation="portrait" position="float" hwp:id="T1" hwp:rev-id="xref-table-wrap-1-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/TBLS1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T1</object-id><object-id pub-id-type="publisher-id">tblS1</object-id><label>Table S1.</label><caption hwp:id="caption-17"><p hwp:id="p-129">Feature matrix comparing subclonal phylogeny reconstruction methods.</p></caption><graphic xlink:href="011833_tblS1" position="float" orientation="portrait" hwp:id="graphic-69"/></table-wrap><p hwp:id="p-37">Finally, it is clear that under many circumstances, particularly when sample count is low and tree complexity is high, the problem of subclone tree reconstruction is underdetermined. It is likely that for at least some tumor types, the true subclone trees may be very complex. In the future, sequencing studies with a large number of samples per patient will be essential to accurately characterize these trees.</p></sec><sec id="s4" hwp:id="sec-13"><title hwp:id="title-19">Methods</title><sec id="s4a" hwp:id="sec-14"><title hwp:id="title-20">Framework overview</title><p hwp:id="p-38">The hypothesis test and genetic algorithm used in this work are components in a general framework that decomposes the problems of mutation cellularity estimation, mutation clustering and subclone tree reconstruction (<xref rid="fig6" ref-type="fig" hwp:id="xref-fig-6-1" hwp:rel-id="F6">Fig. 6</xref>). Given aligned reads from whole-genome, whole-exome or targeted deep next generation sequencing, any method for mutation cellularity estimation and/or clustering can be combined with the hypothesis test described in this section. If cellularities are estimated for a cluster of mutations, the test can be applied directly to temporal ordering of clusters. If cellularities are estimated for specific mutations, the test can be applied to infer temporal ordering of mutation pairs. Given assignments of mutations to clusters, a voting aggregation scheme can be used to order the clusters themselves. The precedence order violation matrix and cluster precedence order violation matrix summarize the output of the hypothesis tests. They can be used to visualize the statistical support for potential temporal orderings (as in <xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-4" hwp:rel-id="F3">Figs. 3</xref>, <xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-3" hwp:rel-id="F4">4</xref> and <xref rid="fig5" ref-type="fig" hwp:id="xref-fig-5-8" hwp:rel-id="F5">5</xref>). Finally, a fitness function that depends on constraints for possible values of cluster cellularities (mass cost) and the results of the hypothesis test (topology cost) can be used to rank possible topologies of subclone phylogenetic trees. The fitness function is independent of the genetic algorithm search strategy proposed in this work.</p><fig id="fig6" position="float" orientation="portrait" fig-type="figure" hwp:id="F6" hwp:rev-id="xref-fig-6-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/FIG6</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F6</object-id><object-id pub-id-type="publisher-id">fig6</object-id><label>Figure 6.</label><caption hwp:id="caption-6"><title hwp:id="title-21">Overview of SCHISM framework.</title><p hwp:id="p-39">The framework decouples estimation of somatic mutation cellularities and reconstruction of subclone phylogenies. Given somatic mutation read counts from next generation sequencing data and somatic copy number calls if available, any tools for mutation cellularity estimation and mutation clustering can be applied. Their output is used to estimate the statistical support for temporal ordering of mutation or mutation cluster pairs, using a generalized likelihood ratio test (GLRT). Other approaches to tree reconstruction can be applied, by using the fitness function as the objective for optimization. GA=genetic algorithm, WGS=whole genome sequencing, WES=whole exome sequencing, DS=(targeted) deep sequencing. KDE=kernel density estimation.</p></caption><graphic xlink:href="011833_fig6" position="float" orientation="portrait" hwp:id="graphic-6"/></fig></sec><sec id="s4b" hwp:id="sec-15"><title hwp:id="title-22">Modeling assumptions</title><p hwp:id="p-40">According to the infinite sites assumption [<xref rid="c8" ref-type="bibr" hwp:id="xref-ref-8-5" hwp:rel-id="ref-8">8</xref>, <xref rid="c6" ref-type="bibr" hwp:id="xref-ref-6-6" hwp:rel-id="ref-6">6</xref>, <xref rid="c7" ref-type="bibr" hwp:id="xref-ref-7-5" hwp:rel-id="ref-7">7</xref>], each somatic mutation in a tumor arises only once throughout the history of the disease, and once a mutation occurs in a cell it is inherited by all descendants of the cell. It follows that given multiple tumor samples from an individual, a mutation may be present in varying proportions of the tumor cells in each sample, referred to as varying <italic toggle="yes">cellularity</italic> of the mutation across samples.</p><p hwp:id="p-41">SCHISM constructs a rooted phylogenetic tree to represent the history of tumor clonal evolution in an individual. Each tree node represents cells harboring a unique compartment of mutations, defining a subclone. Each edge represents a set of mutations, acquired by the cells in the child node and differentiating them from the cells in its parental node. The somatic mutations of each tumor cell then uniquely map it to one of the nodes in the tree.</p><p hwp:id="p-42">From the infinite sites assumption, we can infer that each mutation is uniquely assigned to an edge and the cells represented by a node harbor all mutations present in their parental node. Furthermore, a mutation present at a node cannot have cellularity greater than the mutations at its parental node, defining a <italic toggle="yes">lineage precedence rule</italic>. Also, the sum of mutation cellularities occuring in child nodes cannot exceed the mutation cellularity of their parent, because these mutations occur in mutually exclusive cellular populations, defining a <italic toggle="yes">lineage divergence rule</italic>.</p><p hwp:id="p-43">Many methods have been proposed to estimate mutation cellularities, and our framework can be used with any of these methods. In our reconstruction of subclone phylogenies from three multi-sample sequencing studies (Results), cellularities were derived using ABSOLUTE and our own naive estimator (Supplementary Methods). Other methods such as PyClone or SciClone could also be applied.</p></sec><sec id="s4c" hwp:id="sec-16"><title hwp:id="title-23">Hypothesis test</title><sec id="s4c1" hwp:id="sec-17"><title hwp:id="title-24">Generalized Likelihood Ratio Test</title><p hwp:id="p-44">The lineage precedence rule for a pair of mutations <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>, where <italic toggle="yes">i</italic> precedes <italic toggle="yes">j</italic> in the same lineage implies that
<disp-formula id="eqn1" hwp:id="disp-formula-1">
<alternatives hwp:id="alternatives-1"><graphic xlink:href="011833_eqn1.gif" position="float" orientation="portrait" hwp:id="graphic-7"/></alternatives>
</disp-formula> for <italic toggle="yes">s</italic> in <italic toggle="yes">{</italic>1, <italic toggle="yes">…, S}</italic>, where <inline-formula hwp:id="inline-formula-1"><alternatives hwp:id="alternatives-2"><inline-graphic xlink:href="011833_inline1.gif" hwp:id="inline-graphic-1"/></alternatives></inline-formula> and <inline-formula hwp:id="inline-formula-2"><alternatives hwp:id="alternatives-3"><inline-graphic xlink:href="011833_inline2.gif" hwp:id="inline-graphic-2"/></alternatives></inline-formula> represent the cellularity of mutations <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> in sample <italic toggle="yes">s</italic> and <italic toggle="yes">S</italic> denotes the total number of samples from an individual. Then, for each ordered pair of mutations <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>, the null hypothesis <inline-formula hwp:id="inline-formula-3"><alternatives hwp:id="alternatives-4"><inline-graphic xlink:href="011833_inline3.gif" hwp:id="inline-graphic-3"/></alternatives></inline-formula> to be tested is whether mutation <italic toggle="yes">i can be</italic> an ancestor of mutation <italic toggle="yes">j</italic>, and the alternative hypothesis <inline-formula hwp:id="inline-formula-4"><alternatives hwp:id="alternatives-5"><inline-graphic xlink:href="011833_inline4.gif" hwp:id="inline-graphic-4"/></alternatives></inline-formula> is that it is not possible for <italic toggle="yes">i</italic> to be ancestral to <italic toggle="yes">j</italic>. Let the estimated cellularity for mutation <italic toggle="yes">i</italic> in sample <italic toggle="yes">s</italic> be <inline-formula hwp:id="inline-formula-5"><alternatives hwp:id="alternatives-6"><inline-graphic xlink:href="011833_inline5.gif" hwp:id="inline-graphic-5"/></alternatives></inline-formula>. It can be represented as a draw from a normal distribution centered at the true cellularity of mutation <italic toggle="yes">i</italic> in sample <inline-formula hwp:id="inline-formula-6"><alternatives hwp:id="alternatives-7"><inline-graphic xlink:href="011833_inline6.gif" hwp:id="inline-graphic-6"/></alternatives></inline-formula> and with standard deviation <inline-formula hwp:id="inline-formula-7"><alternatives hwp:id="alternatives-8"><inline-graphic xlink:href="011833_inline6a.gif" hwp:id="inline-graphic-7"/></alternatives></inline-formula>.
<disp-formula id="eqn2" hwp:id="disp-formula-2" hwp:rev-id="xref-disp-formula-2-1">
<alternatives hwp:id="alternatives-9"><graphic xlink:href="011833_eqn2.gif" position="float" orientation="portrait" hwp:id="graphic-8"/></alternatives>
</disp-formula></p><p hwp:id="p-45">Assuming independence between the cellularity estimates for mutations <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>
<disp-formula id="eqn3" hwp:id="disp-formula-3">
<alternatives hwp:id="alternatives-10"><graphic xlink:href="011833_eqn3.gif" position="float" orientation="portrait" hwp:id="graphic-9"/></alternatives>
</disp-formula>
<disp-formula id="eqn4" hwp:id="disp-formula-4" hwp:rev-id="xref-disp-formula-4-1 xref-disp-formula-4-2 xref-disp-formula-4-3">
<alternatives hwp:id="alternatives-11"><graphic xlink:href="011833_eqn4.gif" position="float" orientation="portrait" hwp:id="graphic-10"/></alternatives>
</disp-formula>
<disp-formula id="eqn5" hwp:id="disp-formula-5">
<alternatives hwp:id="alternatives-12"><graphic xlink:href="011833_eqn5.gif" position="float" orientation="portrait" hwp:id="graphic-11"/></alternatives>
</disp-formula> where <inline-formula hwp:id="inline-formula-8"><alternatives hwp:id="alternatives-13"><inline-graphic xlink:href="011833_inline7.gif" hwp:id="inline-graphic-8"/></alternatives></inline-formula> represents the true difference in cellularity of mutations <italic toggle="yes">i</italic>, and <italic toggle="yes">j</italic> in sample <italic toggle="yes">s</italic>, and <inline-formula hwp:id="inline-formula-9"><alternatives hwp:id="alternatives-14"><inline-graphic xlink:href="011833_inline8.gif" hwp:id="inline-graphic-9"/></alternatives></inline-formula>is the standard deviation of <inline-formula hwp:id="inline-formula-10"><alternatives hwp:id="alternatives-15"><inline-graphic xlink:href="011833_inline9.gif" hwp:id="inline-graphic-10"/></alternatives></inline-formula>, the observed difference in cellularity of mutations <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> in sample <italic toggle="yes">s</italic>. Under <inline-formula hwp:id="inline-formula-11"><alternatives hwp:id="alternatives-16"><inline-graphic xlink:href="011833_inline9a.gif" hwp:id="inline-graphic-11"/></alternatives></inline-formula>, the cellularity of mutation <italic toggle="yes">i</italic> should exceed or be equal to that of mutation <italic toggle="yes">j</italic> in all tumor samples, based on the lineage precedence rule. Thus,
<disp-formula id="eqn6" hwp:id="disp-formula-6" hwp:rev-id="xref-disp-formula-6-1 xref-disp-formula-6-2">
<alternatives hwp:id="alternatives-17"><graphic xlink:href="011833_eqn6.gif" position="float" orientation="portrait" hwp:id="graphic-12"/></alternatives>
</disp-formula></p><p hwp:id="p-46">Under the alternative hypothesis <inline-formula hwp:id="inline-formula-12"><alternatives hwp:id="alternatives-18"><inline-graphic xlink:href="011833_inline10.gif" hwp:id="inline-graphic-12"/></alternatives></inline-formula>, mutation <italic toggle="yes">i</italic> cannot be an ancestor to mutation <italic toggle="yes">j</italic>, and it is supported by the existence of samples in which the lineage precedence rule does not hold, and for which
<disp-formula id="eqn7" hwp:id="disp-formula-7" hwp:rev-id="xref-disp-formula-7-1">
<alternatives hwp:id="alternatives-19"><graphic xlink:href="011833_eqn7.gif" position="float" orientation="portrait" hwp:id="graphic-13"/></alternatives>
</disp-formula></p><p hwp:id="p-47">For a pair of mutations <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> and observations <inline-formula hwp:id="inline-formula-13"><alternatives hwp:id="alternatives-20"><inline-graphic xlink:href="011833_inline11.gif" hwp:id="inline-graphic-13"/></alternatives></inline-formula> across <italic toggle="yes">S</italic> tumor samples, <inline-formula hwp:id="inline-formula-14"><alternatives hwp:id="alternatives-21"><inline-graphic xlink:href="011833_inline12.gif" hwp:id="inline-graphic-14"/></alternatives></inline-formula> can be tested with a generalized likelihood ratio test (<italic toggle="yes">GLRT</italic>).
<disp-formula id="eqn8" hwp:id="disp-formula-8" hwp:rev-id="xref-disp-formula-8-1">
<alternatives hwp:id="alternatives-22"><graphic xlink:href="011833_eqn8.gif" position="float" orientation="portrait" hwp:id="graphic-14"/></alternatives>
</disp-formula></p><p hwp:id="p-48">The numerator represents the maximum likelihood for observations <inline-formula hwp:id="inline-formula-15"><alternatives hwp:id="alternatives-23"><inline-graphic xlink:href="011833_inline13.gif" hwp:id="inline-graphic-15"/></alternatives></inline-formula> when <inline-formula hwp:id="inline-formula-16"><alternatives hwp:id="alternatives-24"><inline-graphic xlink:href="011833_inline14.gif" hwp:id="inline-graphic-16"/></alternatives></inline-formula> in <italic toggle="yes">ω</italic><sub>0</sub>, the parameter space corresponding to <inline-formula hwp:id="inline-formula-17"><alternatives hwp:id="alternatives-25"><inline-graphic xlink:href="011833_inline15.gif" hwp:id="inline-graphic-17"/></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="eqn6" hwp:id="xref-disp-formula-6-1" hwp:rel-id="disp-formula-6">Eq. 6</xref>). The denominator represents the maximum likelihood for observations <inline-formula hwp:id="inline-formula-18"><alternatives hwp:id="alternatives-26"><inline-graphic xlink:href="011833_inline16.gif" hwp:id="inline-graphic-18"/></alternatives></inline-formula> where <italic toggle="yes">d</italic><sub><italic toggle="yes">ij</italic></sub> is in the union of the parameter spaces for <inline-formula hwp:id="inline-formula-19"><alternatives hwp:id="alternatives-27"><inline-graphic xlink:href="011833_inline17.gif" hwp:id="inline-graphic-19"/></alternatives></inline-formula> and <inline-formula hwp:id="inline-formula-20"><alternatives hwp:id="alternatives-28"><inline-graphic xlink:href="011833_inline18.gif" hwp:id="inline-graphic-20"/></alternatives></inline-formula>, which implies there is no restriction on the values of <inline-formula hwp:id="inline-formula-21"><alternatives hwp:id="alternatives-29"><inline-graphic xlink:href="011833_inline19.gif" hwp:id="inline-graphic-21"/></alternatives></inline-formula>.</p><p hwp:id="p-49">Given the assumption of independence between <inline-formula hwp:id="inline-formula-22"><alternatives hwp:id="alternatives-30"><inline-graphic xlink:href="011833_inline20.gif" hwp:id="inline-graphic-22"/></alternatives></inline-formula> across samples and considering parameter spaces defined by <inline-formula hwp:id="inline-formula-23"><alternatives hwp:id="alternatives-31"><inline-graphic xlink:href="011833_inline21.gif" hwp:id="inline-graphic-23"/></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="eqn6" hwp:id="xref-disp-formula-6-2" hwp:rel-id="disp-formula-6">Eq. 6</xref>) and <inline-formula hwp:id="inline-formula-24"><alternatives hwp:id="alternatives-32"><inline-graphic xlink:href="011833_inline22.gif" hwp:id="inline-graphic-24"/></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="eqn7" hwp:id="xref-disp-formula-7-1" hwp:rel-id="disp-formula-7">Eq. 7</xref>), <xref ref-type="disp-formula" rid="eqn8" hwp:id="xref-disp-formula-8-1" hwp:rel-id="disp-formula-8">Eq. 8</xref> can be simplified as
<disp-formula id="eqn9" hwp:id="disp-formula-9" hwp:rev-id="xref-disp-formula-9-1">
<alternatives hwp:id="alternatives-33"><graphic xlink:href="011833_eqn9.gif" position="float" orientation="portrait" hwp:id="graphic-15"/></alternatives>
</disp-formula></p><p hwp:id="p-50">Using the normality assumption (<xref ref-type="disp-formula" rid="eqn4" hwp:id="xref-disp-formula-4-1" hwp:rel-id="disp-formula-4">Eq. 4</xref>), <xref ref-type="disp-formula" rid="eqn9" hwp:id="xref-disp-formula-9-1" hwp:rel-id="disp-formula-9">Eq. 9</xref> is rewritten as
<disp-formula id="eqn10" hwp:id="disp-formula-10" hwp:rev-id="xref-disp-formula-10-1">
<alternatives hwp:id="alternatives-34"><graphic xlink:href="011833_eqn10.gif" position="float" orientation="portrait" hwp:id="graphic-16"/></alternatives>
</disp-formula></p><p hwp:id="p-51">To derive the Λ, each <inline-formula hwp:id="inline-formula-25"><alternatives hwp:id="alternatives-35"><inline-graphic xlink:href="011833_inline23.gif" hwp:id="inline-graphic-25"/></alternatives></inline-formula> is replaced by its single sample maximum likelihood estimator under <inline-formula hwp:id="inline-formula-26"><alternatives hwp:id="alternatives-36"><inline-graphic xlink:href="011833_inline24.gif" hwp:id="inline-graphic-26"/></alternatives></inline-formula> in the numerator. If <inline-formula hwp:id="inline-formula-27"><alternatives hwp:id="alternatives-37"><inline-graphic xlink:href="011833_inline25.gif" hwp:id="inline-graphic-27"/></alternatives></inline-formula>, the value of <inline-formula hwp:id="inline-formula-28"><alternatives hwp:id="alternatives-38"><inline-graphic xlink:href="011833_inline26.gif" hwp:id="inline-graphic-28"/></alternatives></inline-formula> that maximizes the numerator is equal to <inline-formula hwp:id="inline-formula-29"><alternatives hwp:id="alternatives-39"><inline-graphic xlink:href="011833_inline27.gif" hwp:id="inline-graphic-29"/></alternatives></inline-formula>. On the other hand, for <inline-formula hwp:id="inline-formula-30"><alternatives hwp:id="alternatives-40"><inline-graphic xlink:href="011833_inline28.gif" hwp:id="inline-graphic-30"/></alternatives></inline-formula>, the value of <inline-formula hwp:id="inline-formula-31"><alternatives hwp:id="alternatives-41"><inline-graphic xlink:href="011833_inline29.gif" hwp:id="inline-graphic-31"/></alternatives></inline-formula> that maximizes the numerator is 0, since negative values of <inline-formula hwp:id="inline-formula-32"><alternatives hwp:id="alternatives-42"><inline-graphic xlink:href="011833_inline30.gif" hwp:id="inline-graphic-32"/></alternatives></inline-formula> are not allowed under <inline-formula hwp:id="inline-formula-33"><alternatives hwp:id="alternatives-43"><inline-graphic xlink:href="011833_inline31.gif" hwp:id="inline-graphic-33"/></alternatives></inline-formula>. In the denominator, since the value of <inline-formula hwp:id="inline-formula-34"><alternatives hwp:id="alternatives-44"><inline-graphic xlink:href="011833_inline32.gif" hwp:id="inline-graphic-34"/></alternatives></inline-formula> is a non-restricted parameter, its maximum likelihood estimator is always equal to <inline-formula hwp:id="inline-formula-35"><alternatives hwp:id="alternatives-45"><inline-graphic xlink:href="011833_inline33.gif" hwp:id="inline-graphic-35"/></alternatives></inline-formula>. Thus <xref ref-type="disp-formula" rid="eqn10" hwp:id="xref-disp-formula-10-1" hwp:rel-id="disp-formula-10">Eq. 10</xref> can be rewritten as
<disp-formula id="eqn11" hwp:id="disp-formula-11">
<alternatives hwp:id="alternatives-46"><graphic xlink:href="011833_eqn11.gif" position="float" orientation="portrait" hwp:id="graphic-17"/></alternatives>
</disp-formula> which simplifies to
<disp-formula id="eqn12" hwp:id="disp-formula-12">
<alternatives hwp:id="alternatives-47"><graphic xlink:href="011833_eqn12.gif" position="float" orientation="portrait" hwp:id="graphic-18"/></alternatives>
</disp-formula></p><p hwp:id="p-52">Therefore, we reject the null hypothesis that mutation <italic toggle="yes">i</italic> could be an ancestor of mutation <italic toggle="yes">j</italic> <inline-formula hwp:id="inline-formula-36"><alternatives hwp:id="alternatives-48"><inline-graphic xlink:href="011833_inline34.gif" hwp:id="inline-graphic-36"/></alternatives></inline-formula> if the test statistic <italic toggle="yes">T</italic> is significantly large.
<disp-formula id="eqn13" hwp:id="disp-formula-13" hwp:rev-id="xref-disp-formula-13-1 xref-disp-formula-13-2 xref-disp-formula-13-3 xref-disp-formula-13-4">
<alternatives hwp:id="alternatives-49"><graphic xlink:href="011833_eqn13.gif" position="float" orientation="portrait" hwp:id="graphic-19"/></alternatives>
</disp-formula> where <italic toggle="yes">I</italic> is a binary indicator variable. <xref ref-type="disp-formula" rid="eqn13" hwp:id="xref-disp-formula-13-2" hwp:rel-id="disp-formula-13">Eq. 13</xref> explicitly shows how <italic toggle="yes">T</italic> depends on the accuracy of cellularity values and their standard deviation. When standard deviation is overestimated, <italic toggle="yes">T</italic> is underestimated, yielding power loss. When standard deviation is underestimated, <italic toggle="yes">T</italic> is overestimated, yielding Type 1 error inflation.</p><p hwp:id="p-53">Since the standard deviation is unknown, standard error was used to calculate the test statistic.</p></sec><sec id="s4c2" hwp:id="sec-18"><title hwp:id="title-25"><bold>Significance Evaluation</bold></title><p hwp:id="p-54">To assess the significance of an observed value of the <italic toggle="yes">GLRT</italic> test statistic (<italic toggle="yes">T</italic>) (<xref ref-type="disp-formula" rid="eqn13" hwp:id="xref-disp-formula-13-3" hwp:rel-id="disp-formula-13">Eq. 13</xref>), we consider the distribution of <italic toggle="yes">T</italic> under <inline-formula hwp:id="inline-formula-37"><alternatives hwp:id="alternatives-50"><inline-graphic xlink:href="011833_inline35.gif" hwp:id="inline-graphic-37"/></alternatives></inline-formula> and derive the Type 1 error probability of the test. Similar results have previously been derived for a more general class of GLRTs [<xref rid="c24" ref-type="bibr" hwp:id="xref-ref-24-1" hwp:rel-id="ref-24">24</xref>]. The distribution of each summation term in <xref ref-type="disp-formula" rid="eqn13" hwp:id="xref-disp-formula-13-4" hwp:rel-id="disp-formula-13">Eq. 13</xref> <inline-formula hwp:id="inline-formula-38"><alternatives hwp:id="alternatives-51"><inline-graphic xlink:href="011833_inline36.gif" hwp:id="inline-graphic-38"/></alternatives></inline-formula>.<inline-formula hwp:id="inline-formula-39"><alternatives hwp:id="alternatives-52"><inline-graphic xlink:href="011833_inline37.gif" hwp:id="inline-graphic-39"/></alternatives></inline-formula> depends on the true value of <inline-formula hwp:id="inline-formula-40"><alternatives hwp:id="alternatives-53"><inline-graphic xlink:href="011833_inline38.gif" hwp:id="inline-graphic-40"/></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="eqn4" hwp:id="xref-disp-formula-4-2" hwp:rel-id="disp-formula-4">Eq. 4</xref>). Given a fixed value of <inline-formula hwp:id="inline-formula-41"><alternatives hwp:id="alternatives-54"><inline-graphic xlink:href="011833_inline39.gif" hwp:id="inline-graphic-41"/></alternatives></inline-formula>, large positive values of <inline-formula hwp:id="inline-formula-42"><alternatives hwp:id="alternatives-55"><inline-graphic xlink:href="011833_inline40.gif" hwp:id="inline-graphic-42"/></alternatives></inline-formula> make observation of negative <inline-formula hwp:id="inline-formula-43"><alternatives hwp:id="alternatives-56"><inline-graphic xlink:href="011833_inline41.gif" hwp:id="inline-graphic-43"/></alternatives></inline-formula> and thus a corresponding non-zero term in the summation less likely. Therefore,
<disp-formula id="eqn14" hwp:id="disp-formula-14">
<alternatives hwp:id="alternatives-57"><graphic xlink:href="011833_eqn14.gif" position="float" orientation="portrait" hwp:id="graphic-20"/></alternatives>
</disp-formula></p><p hwp:id="p-55">By extending the above argument to every term in the summation, we derive an upper bound for the probability of test statistic <italic toggle="yes">T</italic> exceeding a critical value <italic toggle="yes">C</italic> under the null hypothesis <inline-formula hwp:id="inline-formula-44"><alternatives hwp:id="alternatives-58"><inline-graphic xlink:href="011833_inline42.gif" hwp:id="inline-graphic-44"/></alternatives></inline-formula>.
<disp-formula id="eqn15" hwp:id="disp-formula-15" hwp:rev-id="xref-disp-formula-15-1">
<alternatives hwp:id="alternatives-59"><graphic xlink:href="011833_eqn15.gif" position="float" orientation="portrait" hwp:id="graphic-21"/></alternatives>
</disp-formula></p><p hwp:id="p-56">Therefore, to control the Type 1 error probability of the test, it is sufficient to control Type 1 error probability of a test where the null hypothesis is reduced to <inline-formula hwp:id="inline-formula-45"><alternatives hwp:id="alternatives-60"><inline-graphic xlink:href="011833_inline43a.gif" hwp:id="inline-graphic-45"/></alternatives></inline-formula> (<italic toggle="yes">reduced null hypothesis</italic>). Under the reduced null hypothesis we can derive the exact distribution of the test statistic <italic toggle="yes">T</italic> as follows.</p><p hwp:id="p-57">Let <inline-formula hwp:id="inline-formula-46"><alternatives hwp:id="alternatives-61"><inline-graphic xlink:href="011833_inline43.gif" hwp:id="inline-graphic-46"/></alternatives></inline-formula>denote <inline-formula hwp:id="inline-formula-47"><alternatives hwp:id="alternatives-62"><inline-graphic xlink:href="011833_inline44.gif" hwp:id="inline-graphic-47"/></alternatives></inline-formula>
<disp-formula id="eqn16" hwp:id="disp-formula-16">
<alternatives hwp:id="alternatives-63"><graphic xlink:href="011833_eqn16.gif" position="float" orientation="portrait" hwp:id="graphic-22"/></alternatives>
</disp-formula></p><p hwp:id="p-58">Next, let <italic toggle="yes">δ</italic><sub><italic toggle="yes">V</italic></sub> be a binary random variable representing the event when, for a particular subset <italic toggle="yes">V</italic> of <italic toggle="yes">{</italic>1, <italic toggle="yes">…, S}</italic>, we have <inline-formula hwp:id="inline-formula-48"><alternatives hwp:id="alternatives-64"><inline-graphic xlink:href="011833_inline45.gif" hwp:id="inline-graphic-48"/></alternatives></inline-formula> for <italic toggle="yes">s</italic> ∈ <italic toggle="yes">V</italic> and <inline-formula hwp:id="inline-formula-49"><alternatives hwp:id="alternatives-65"><inline-graphic xlink:href="011833_inline46.gif" hwp:id="inline-graphic-49"/></alternatives></inline-formula> for <italic toggle="yes">s</italic> ∉ <italic toggle="yes">V</italic>. By the law of total probability,
<disp-formula id="eqn17" hwp:id="disp-formula-17">
<alternatives hwp:id="alternatives-66"><graphic xlink:href="011833_eqn17.gif" position="float" orientation="portrait" hwp:id="graphic-23"/></alternatives>
</disp-formula> or equivalently,
<disp-formula id="eqn18" hwp:id="disp-formula-18" hwp:rev-id="xref-disp-formula-18-1">
<alternatives hwp:id="alternatives-67"><graphic xlink:href="011833_eqn18.gif" position="float" orientation="portrait" hwp:id="graphic-24"/></alternatives>
</disp-formula></p><p hwp:id="p-59">But the reduced null hypothesis (<xref ref-type="disp-formula" rid="eqn15" hwp:id="xref-disp-formula-15-1" hwp:rel-id="disp-formula-15">Eq. 15</xref>) states that all <inline-formula hwp:id="inline-formula-50"><alternatives hwp:id="alternatives-68"><inline-graphic xlink:href="011833_inline47.gif" hwp:id="inline-graphic-50"/></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="eqn4" hwp:id="xref-disp-formula-4-3" hwp:rel-id="disp-formula-4">Eq. 4</xref> are set to zero, so
<disp-formula id="eqn19" hwp:id="disp-formula-19">
<alternatives hwp:id="alternatives-69"><graphic xlink:href="011833_eqn19.gif" position="float" orientation="portrait" hwp:id="graphic-25"/></alternatives>
</disp-formula> or equivalently,
<disp-formula id="eqn20" hwp:id="disp-formula-20" hwp:rev-id="xref-disp-formula-20-1">
<alternatives hwp:id="alternatives-70"><graphic xlink:href="011833_eqn20.gif" position="float" orientation="portrait" hwp:id="graphic-26"/></alternatives>
</disp-formula></p><p hwp:id="p-60">Also, for a set of independent identically distributed random draws from <italic toggle="yes">N</italic> (0, 1), the value of the summation in <xref ref-type="disp-formula" rid="eqn18" hwp:id="xref-disp-formula-18-1" hwp:rel-id="disp-formula-18">Eq. 18</xref> is independent of the signs of {<inline-formula hwp:id="inline-formula-51"><alternatives hwp:id="alternatives-71"><inline-graphic xlink:href="011833_inline49a.gif" hwp:id="inline-graphic-51"/></alternatives></inline-formula>}, and is a <italic toggle="yes">χ</italic><sup>2</sup> random variable with <italic toggle="yes">|V|</italic> degrees of freedom.
<disp-formula id="eqn21" hwp:id="disp-formula-21">
<alternatives hwp:id="alternatives-72"><graphic xlink:href="011833_eqn21.gif" position="float" orientation="portrait" hwp:id="graphic-27"/></alternatives>
</disp-formula>
<disp-formula id="eqn22" hwp:id="disp-formula-22">
<alternatives hwp:id="alternatives-73"><graphic xlink:href="011833_eqn22.gif" position="float" orientation="portrait" hwp:id="graphic-28"/></alternatives>
</disp-formula></p><p hwp:id="p-61"><xref ref-type="disp-formula" rid="eqn20" hwp:id="xref-disp-formula-20-1" hwp:rel-id="disp-formula-20">Eq. 20</xref> implies that each random variable <inline-formula hwp:id="inline-formula-52"><alternatives hwp:id="alternatives-74"><inline-graphic xlink:href="011833_inline48.gif" hwp:id="inline-graphic-52"/></alternatives></inline-formula> assumes positive and negative signs with equal probability. Thus, the probability of observing a particular sequence of signs for random variables <inline-formula hwp:id="inline-formula-53"><alternatives hwp:id="alternatives-75"><inline-graphic xlink:href="011833_inline49.gif" hwp:id="inline-graphic-53"/></alternatives></inline-formula>, i.e. the probability of each <italic toggle="yes">δ</italic> being true, is <inline-formula hwp:id="inline-formula-54"><alternatives hwp:id="alternatives-76"><inline-graphic xlink:href="011833_inline50.gif" hwp:id="inline-graphic-54"/></alternatives></inline-formula>.
<disp-formula id="eqn23" hwp:id="disp-formula-23">
<alternatives hwp:id="alternatives-77"><graphic xlink:href="011833_eqn23.gif" position="float" orientation="portrait" hwp:id="graphic-29"/></alternatives>
</disp-formula></p><p hwp:id="p-62">Finally, summarizing the sum above over all possible values <italic toggle="yes">|V|</italic> can take,
<disp-formula id="eqn24" hwp:id="disp-formula-24">
<alternatives hwp:id="alternatives-78"><graphic xlink:href="011833_eqn24.gif" position="float" orientation="portrait" hwp:id="graphic-30"/></alternatives>
</disp-formula></p><p hwp:id="p-63">Thus it can be concluded that the distribution of <italic toggle="yes">GLRT</italic> test statistic <italic toggle="yes">T</italic> under the reduced null hypothesis is that of a random variable drawn from a mixture of χ<sup>2</sup> distributions, with degrees of freedom varying in <italic toggle="yes">k ∈ {</italic>0, <italic toggle="yes">…, S}</italic>, and the weight of each mixture component equal to <inline-formula hwp:id="inline-formula-55"><alternatives hwp:id="alternatives-79"><inline-graphic xlink:href="011833_inline51.gif" hwp:id="inline-graphic-55"/></alternatives></inline-formula>. Here, a <inline-formula hwp:id="inline-formula-56"><alternatives hwp:id="alternatives-80"><inline-graphic xlink:href="011833_inline52.gif" hwp:id="inline-graphic-56"/></alternatives></inline-formula> random variable is defined as one that is fixed at zero. We use this derivation to assign a conservative estimate of significance level to an observed value of the test statistic <italic toggle="yes">T</italic> under <inline-formula hwp:id="inline-formula-57"><alternatives hwp:id="alternatives-81"><inline-graphic xlink:href="011833_inline53.gif" hwp:id="inline-graphic-57"/></alternatives></inline-formula>.</p></sec><sec id="s4c3" hwp:id="sec-19"><title hwp:id="title-26"><bold>Precedence Order Violation Matrix</bold></title><p hwp:id="p-64">For each possible ordered pair of mutations (<italic toggle="yes">i, j</italic>) characterized in a set of tumor samples from the same individual, we test the hypothesis that mutation <italic toggle="yes">i</italic> is a potential ancestor of mutation <italic toggle="yes">j</italic>. A fixed common significance level of α = 0.05 is assigned to decide the outcome of each pairwise test. These results can then be organized as a binary <italic toggle="yes">Precedence Order Violation</italic> (<italic toggle="yes">POV</italic>) matrix, where non-zero entries mark mutation pairs (<italic toggle="yes">i, j</italic>) for which the null hypothesis <inline-formula hwp:id="inline-formula-58"><alternatives hwp:id="alternatives-82"><inline-graphic xlink:href="011833_inline54.gif" hwp:id="inline-graphic-58"/></alternatives></inline-formula> was rejected.</p></sec><sec id="s4c4" hwp:id="sec-20"><title hwp:id="title-27"><bold>Application to mutation clusters</bold></title><p hwp:id="p-65">Given a mapping of individual mutations onto clusters, the hypothesis test can be applied to pairs of clusters rather than to pairs of mutations, and in this case is used to generate a straightforward extension of the POV matrix <italic toggle="yes">Cluster Precedence Order Violation</italic> (<italic toggle="yes">CPOV</italic> matrix) where non-zero entries mark mutation cluster pairs (<italic toggle="yes">I, J</italic>) for which the null hypothesis <inline-formula hwp:id="inline-formula-59"><alternatives hwp:id="alternatives-83"><inline-graphic xlink:href="011833_inline55.gif" hwp:id="inline-graphic-59"/></alternatives></inline-formula> was rejected. An alternate approach for generating a CPOV matrix by vote aggregation is described next.</p></sec></sec><sec id="s4d" hwp:id="sec-21"><title hwp:id="title-28">Vote aggregation</title><p hwp:id="p-66">The Cluster Precedence Order Violation (CPOV) matrix can be generated by the following vote aggregation approach. Let the set of mutations assigned to cluster <italic toggle="yes">I</italic> be <italic toggle="yes">M</italic>(<italic toggle="yes">I</italic>). Rows and columns of the POV matrix can be reordered so that mutations belonging to the same cluster are adjacent. Then the ordered interaction of any pair of clusters (<italic toggle="yes">I, J</italic>) is represented by a block of matrix entries with addresses
<disp-formula id="eqn25" hwp:id="disp-formula-25">
<alternatives hwp:id="alternatives-84"><graphic xlink:href="011833_eqn25.gif" position="float" orientation="portrait" hwp:id="graphic-31"/></alternatives>
</disp-formula></p><p hwp:id="p-67">The support for potential lineage precedence of cluster <italic toggle="yes">I</italic> to cluster <italic toggle="yes">J</italic> can be summarized by a vote of the matrix elements within the block, represented as an element (<italic toggle="yes">I, J</italic>) in a cluster-level POV matrix <italic toggle="yes">CPOV</italic>
<disp-formula id="eqn26" hwp:id="disp-formula-26" hwp:rev-id="xref-disp-formula-26-1">
<alternatives hwp:id="alternatives-85"><graphic xlink:href="011833_eqn26.gif" position="float" orientation="portrait" hwp:id="graphic-32"/></alternatives>
</disp-formula> where <italic toggle="yes">|M</italic>(<italic toggle="yes">X</italic>)| denotes the number of mutations in cluster <italic toggle="yes">X</italic>.</p></sec><sec id="s4e" hwp:id="sec-22"><title hwp:id="title-29">Genetic algorithm</title><p hwp:id="p-68">A genetic algorithm (GA) is a heuristic search inspired by the process of natural selection. In an initial generation, a set of random objects is created and their fitness with respect to a fitness criteria is evaluated. Next, objects from the initial generation are selected according to their fitness to be parents of the following generation, with a preference for the fittest parents. The parental objects reproduce themselves, and their progeny may harbor new variation. The process is repeated for either a fixed number of generations or until a pre-defined convergence criteria is reached.</p><p hwp:id="p-69">In our implementation, the GA searches through a space of phylogenetic tree topologies, ranking them with a fitness function that we derived based on our model assumptions. In the initial generation, we generate <italic toggle="yes">G</italic><sub>0</sub> = 1000 random tree topologies and evaluate the fitness of each tree. A sample of size 0.8 ∗ <italic toggle="yes">G</italic><sub>0</sub> trees are selected for reproduction by a fitness proportional selection method [<xref rid="c25" ref-type="bibr" hwp:id="xref-ref-25-1" hwp:rel-id="ref-25">25</xref>] and their progeny are generated, using crossover and mutation operations (<xref rid="fig7" ref-type="fig" hwp:id="xref-fig-7-1" hwp:rel-id="F7">Figs. 7</xref> and <xref rid="fig8" ref-type="fig" hwp:id="xref-fig-8-1" hwp:rel-id="F8">8</xref>). To increase diversity and avoid too fast convergence to a local optimum, 0.2 ∗ <italic toggle="yes">G</italic><sub>0</sub> random tree topologies are also generated. The following generation then consists of a mixture of the progeny of the previous generation(s) and new random trees, and the total number of trees is the same as in the previous generation, so that <italic toggle="yes">G</italic><sub>1</sub> = <italic toggle="yes">G</italic><sub>0</sub>. The process is repeated for a fixed number γ = 20 generations. For each generation, the trees selected to be parents are not limited to the previous generation only, but can be selected from any preceding generations. To avoid getting trapped in local optima, four independent runs of the GA are performed, each with 20 generations (1000 trees per generation), and the entire ensemble of trees sampled in the four runs is ranked by tree fitness.</p><fig id="fig7" position="float" orientation="portrait" fig-type="figure" hwp:id="F7" hwp:rev-id="xref-fig-7-1 xref-fig-7-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/FIG7</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F7</object-id><object-id pub-id-type="publisher-id">fig7</object-id><label>Figure 7.</label><caption hwp:id="caption-7"><title hwp:id="title-30">Crossover Operation.</title><p hwp:id="p-70">A reproductive crossover operation involving a pair of parental trees is used to generate diversity among toplogies in members of each generation produced by the genetic algorithm.</p></caption><graphic xlink:href="011833_fig7" position="float" orientation="portrait" hwp:id="graphic-33"/></fig><fig id="fig8" position="float" orientation="portrait" fig-type="figure" hwp:id="F8" hwp:rev-id="xref-fig-8-1 xref-fig-8-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/FIG8</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F8</object-id><object-id pub-id-type="publisher-id">fig8</object-id><label>Figure 8.</label><caption hwp:id="caption-8"><title hwp:id="title-31">Mutation Operations.</title><p hwp:id="p-71">Two mutation operations are used to increase topological diversity among progeny trees in each generation produced by the genetic algorithm.</p></caption><graphic xlink:href="011833_fig8" position="float" orientation="portrait" hwp:id="graphic-34"/></fig><p hwp:id="p-72">In this work, the number of mutation clusters and the cellularity of each mutation cluster in each sample is assumed to be known, and the GA is applied to explore the space of tree topologies with a given node count, including both linear and branched topologies.</p><sec id="s4e1" hwp:id="sec-23"><title hwp:id="title-32">Random Topology Generation</title><p hwp:id="p-73">To generate a random tree topology, a mutation cluster is randomly selected and assigned to the incident edge downstream of the root node. An incident node downstream of the edge is appended. Next, one of the remaining mutation clusters and a non-root node are randomly selected and the cluster is assigned to the incident edge downstream of this node, again appending a new incident node downstream of the edge. The process continues until all mutation clusters in the data have been assigned.</p></sec><sec id="s4e2" hwp:id="sec-24"><title hwp:id="title-33">Mutation and Crossover Operations</title><p hwp:id="p-74">The tree topologies selected for sexual reproduction are randomly paired, and each pair undergoes a crossover operation with probability <italic toggle="yes">P</italic><sub><italic toggle="yes">c</italic></sub> to yield two progeny intermediate trees (<xref rid="fig7" ref-type="fig" hwp:id="xref-fig-7-2" hwp:rel-id="F7">Fig. 7</xref>). Next, a mutation operation is applied to each progeny intermediate tree with probability <italic toggle="yes">P</italic><sub><italic toggle="yes">m</italic></sub>. There are two possible mutation operations (<xref rid="fig8" ref-type="fig" hwp:id="xref-fig-8-2" hwp:rel-id="F8">Fig. 8</xref>), and for each tree one is selected with probability <italic toggle="yes">P</italic><sub><italic toggle="yes">s</italic></sub>. The result is a collection of new progeny trees that will appear in the next generation. (Default <italic toggle="yes">P</italic><sub><italic toggle="yes">c</italic></sub> = 0.25 and <italic toggle="yes">P</italic><sub><italic toggle="yes">m</italic></sub> = 0.9 and <italic toggle="yes">P</italic><sub><italic toggle="yes">s</italic></sub> = 0.6.</p></sec><sec id="s4e3" hwp:id="sec-25"><title hwp:id="title-34">Fitness function</title><p hwp:id="p-75">Tree fitness is evaluated as
<disp-formula id="eqn27" hwp:id="disp-formula-27">
<alternatives hwp:id="alternatives-86"><graphic xlink:href="011833_eqn27.gif" position="float" orientation="portrait" hwp:id="graphic-35"/></alternatives>
</disp-formula> where <italic toggle="yes">TC</italic>(<italic toggle="yes">T</italic>) is a <italic toggle="yes">topology cost</italic> that summarizes violations of the lineage precedence rule, and <italic toggle="yes">MC</italic>(<italic toggle="yes">T</italic>) is a <italic toggle="yes">mass cost</italic> that summarizes violations of the lineage divergence rule.</p><p hwp:id="p-76">The two components of the fitness function are useful because they represent biological properties of tumor evolution and practically, their combination can identify the true tree in cases where the topology cost or mass cost alone is insufficient (<xref rid="figS5" ref-type="fig" hwp:id="xref-fig-13-2" hwp:rel-id="F13">Fig. S5</xref>, <xref rid="figS6" ref-type="fig" hwp:id="xref-fig-14-1" hwp:rel-id="F14">Fig. S6</xref>).</p><p hwp:id="p-77">The <italic toggle="yes">topology cost</italic> (<italic toggle="yes">TC</italic>) of tree <italic toggle="yes">T</italic> is
<disp-formula id="eqn28" hwp:id="disp-formula-28">
<alternatives hwp:id="alternatives-87"><graphic xlink:href="011833_eqn28.gif" position="float" orientation="portrait" hwp:id="graphic-36"/></alternatives>
</disp-formula> where <italic toggle="yes">tc</italic>(<italic toggle="yes">I, J</italic>) is the topology cost of each (<italic toggle="yes">ancestor → descendant</italic>) edge pair, equivalent to <italic toggle="yes">CPOV</italic> [<italic toggle="yes">I, J</italic>] (<xref ref-type="disp-formula" rid="eqn26" hwp:id="xref-disp-formula-26-1" hwp:rel-id="disp-formula-26">Eq. 26</xref>) and <italic toggle="yes">E</italic>(<italic toggle="yes">T</italic>) represents the set of edges in tree <italic toggle="yes">T</italic>.</p><p hwp:id="p-78">The <italic toggle="yes">mass cost</italic> (<italic toggle="yes">MC</italic>) of tree <italic toggle="yes">T</italic> is
<disp-formula id="eqn29" hwp:id="disp-formula-29">
<alternatives hwp:id="alternatives-88"><graphic xlink:href="011833_eqn29.gif" position="float" orientation="portrait" hwp:id="graphic-37"/></alternatives>
</disp-formula> where <italic toggle="yes">mc</italic>(<italic toggle="yes">n</italic>), the total mass cost for node <italic toggle="yes">n</italic>, is the Euclidean norm of the vector of node mass costs across samples
<disp-formula id="eqn30" hwp:id="disp-formula-30">
<alternatives hwp:id="alternatives-89"><graphic xlink:href="011833_eqn30.gif" position="float" orientation="portrait" hwp:id="graphic-38"/></alternatives>
</disp-formula> and <italic toggle="yes">mc</italic><sup><italic toggle="yes">s</italic></sup>(<italic toggle="yes">n</italic>) is the mass cost for node <italic toggle="yes">n</italic> in sample <italic toggle="yes">s</italic>
<disp-formula id="eqn31" hwp:id="disp-formula-31" hwp:rev-id="xref-disp-formula-31-1 xref-disp-formula-31-2">
<alternatives hwp:id="alternatives-90"><graphic xlink:href="011833_eqn31.gif" position="float" orientation="portrait" hwp:id="graphic-39"/></alternatives>
</disp-formula> where <inline-formula hwp:id="inline-formula-60"><alternatives hwp:id="alternatives-91"><inline-graphic xlink:href="011833_inline56.gif" hwp:id="inline-graphic-60"/></alternatives></inline-formula> is the cellularity of the mutation cluster associated with the upstream edge incident to node <italic toggle="yes">n</italic>, <italic toggle="yes">i.e.</italic>, <italic toggle="yes">p</italic>(<italic toggle="yes">n</italic>) in sample <italic toggle="yes">s</italic>, and <inline-formula hwp:id="inline-formula-61"><alternatives hwp:id="alternatives-92"><inline-graphic xlink:href="011833_inline57.gif" hwp:id="inline-graphic-61"/></alternatives></inline-formula> is the sum of cellularities of mutation clusters associated with its set of immediate <italic toggle="yes">descendant edges D</italic>(<italic toggle="yes">n</italic>). The fitness <italic toggle="yes">F</italic> of the tree <italic toggle="yes">T</italic> is then a monotonically decreasing function of the tree cost <italic toggle="yes">Z</italic>(<italic toggle="yes">T</italic>).
<disp-formula id="eqn32" hwp:id="disp-formula-32">
<alternatives hwp:id="alternatives-93"><graphic xlink:href="011833_eqn32.gif" position="float" orientation="portrait" hwp:id="graphic-40"/></alternatives>
</disp-formula> where <italic toggle="yes">f</italic><sub><italic toggle="yes">c</italic></sub> is a positive-valued scaling coefficient (default <italic toggle="yes">f</italic><sub><italic toggle="yes">c</italic></sub> = 5), yielding fitness reduction by a factor of ∼ 150X for each unit increase in total cost.</p></sec></sec><sec id="s4f" hwp:id="sec-26"><title hwp:id="title-35">Simulations</title><p hwp:id="p-79">The simulations were designed to generate data compatible with a set of likely tree topologies and assess how well SCHISM could recover these topologies from the data. Given a tree topology, a simulation produces a set of tumor samples consistent with lineage relationships summarized in the tree. We assume that while the samples share these lineage relationships, each represents an independent instantiation of cellularity distributions over the edges of the tree. The variability among these simulated samples captures the stochastic process of preferential sampling of tumor cells in an individual’s multiple tumor samples. In each simulated sample, we model variant and reference read counts for mutations belonging to each edge in the tree, taking into account sequencing coverage depth, sample purity level and mutation cluster cellularity.</p><sec id="s4f1" hwp:id="sec-27"><title hwp:id="title-36"><bold>Generating subclonal phylogenies</bold></title><p hwp:id="p-80">Simulated trees range in size from three to eight nodes, with no restrictions on the number of child nodes. For trees with three to five nodes, an exhaustive set of topologies is generated. Otherwise, ten topologies are selected (<xref rid="figS1" ref-type="fig" hwp:id="xref-fig-9-1" hwp:rel-id="F9">Fig. S1</xref>). Each unique topology at a given node count is considered an <italic toggle="yes">instance</italic>. A Poisson process with rate parameter <italic toggle="yes">λ</italic> = 10 is used to simulate the number of mutations that occurred along each each edge in the tree. Node count does not include the root node, which represents the germline state prior to any somatic mutations.</p><fig id="figS1" position="float" orientation="portrait" fig-type="figure" hwp:id="F9" hwp:rev-id="xref-fig-9-1 xref-fig-9-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/FIGS1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F9</object-id><object-id pub-id-type="publisher-id">figS1</object-id><label>Figure S1.</label><caption hwp:id="caption-9"><title hwp:id="title-58">Tree topologies used in the simulations.</title><p hwp:id="p-121">For trees with 3-5 nodes, the exhaustive set of possible topologies were used. Otherwise, we manually selected ten topologies. Each box depicts a tree instance.</p></caption><graphic xlink:href="011833_figS1" position="float" orientation="portrait" hwp:id="graphic-61"/></fig><p hwp:id="p-81">A detailed description of how mutation cellularities and mutation variant allele fractions are generated in the simulations is presented in Supplementary Methods.</p></sec></sec><sec id="s4g" hwp:id="sec-28"><title hwp:id="title-37">Subclone size estimation</title><p hwp:id="p-82">Based on our modeling assumptions, it is straightforward to conclude that in each sample <italic toggle="yes">s</italic>, the fraction of tumor cells belonging to the subclone described by node <italic toggle="yes">n</italic> in a tree can be calculated as
<disp-formula id="eqn33" hwp:id="disp-formula-33">
<alternatives hwp:id="alternatives-94"><graphic xlink:href="011833_eqn33.gif" position="float" orientation="portrait" hwp:id="graphic-41"/></alternatives>
</disp-formula> where <inline-formula hwp:id="inline-formula-62"><alternatives hwp:id="alternatives-95"><inline-graphic xlink:href="011833_inline58.gif" hwp:id="inline-graphic-62"/></alternatives></inline-formula> is the cellularity of the mutation cluster associated with the upstream edge incident to node <italic toggle="yes">n</italic>, <italic toggle="yes">i.e.</italic>, <italic toggle="yes">p</italic>(<italic toggle="yes">n</italic>) in sample <italic toggle="yes">s</italic>, and <inline-formula hwp:id="inline-formula-63"><alternatives hwp:id="alternatives-96"><inline-graphic xlink:href="011833_inline59.gif" hwp:id="inline-graphic-63"/></alternatives></inline-formula> is the sum of cellularities of mutation clusters associated with its set of immediate <italic toggle="yes">descendant edges D</italic>(<italic toggle="yes">n</italic>).</p></sec><sec id="s4h" hwp:id="sec-29"><title hwp:id="title-38">Assessment of hypothesis test</title><p hwp:id="p-83">Each element of the precedence order violation matrix <italic toggle="yes">POV</italic> [<italic toggle="yes">i, j</italic>] is a binary indicator of whether the null hypothesis that mutation <italic toggle="yes">i</italic> can be ancestral to mutation <italic toggle="yes">j</italic> is rejected. Each element in the POV matrix is compared with its true value, given the correct tree topology. Performance is summarized by power and Type 1 error.</p></sec><sec id="s4i" hwp:id="sec-30"><title hwp:id="title-39">Assessment of automated subclone tree reconstruction</title><p hwp:id="p-84">The ability of the genetic algorithm to identify the correctly reconstructed subclone tree is assessed across multiple settings of key variables: tumor purity (0.5, 0.9), sequencing coverage depth (150X,1000X), tree node count (3-8), and tumor sample count (1-10). For each node count, multiple tree instances (alternate topologies for a given node count) are considered (<xref rid="figS1" ref-type="fig" hwp:id="xref-fig-9-2" hwp:rel-id="F9">Fig. S1</xref>). Then for each combination of settings, ten different replicates are run (<xref rid="figS2" ref-type="fig" hwp:id="xref-fig-10-1" hwp:rel-id="F10">Fig. S2</xref>). Each replicate can be viewed as an <italic toggle="yes">in silico</italic> patient having the selected number of samples and a distinct cellularity profile across the samples.</p><fig id="figS2" position="float" orientation="portrait" fig-type="figure" hwp:id="F10" hwp:rev-id="xref-fig-10-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/FIGS2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F10</object-id><object-id pub-id-type="publisher-id">figS2</object-id><label>Figure S2.</label><caption hwp:id="caption-10"><title hwp:id="title-59">The genetic algorithm is assessed across multiple settings of tumor purity, sequencing coverage depth, tree node count, and tumor sample count.</title><p hwp:id="p-122">The example shows purity of 0.9, coverage of 150X, node count of 4, sample count of 4, and a selected tree instance.</p></caption><graphic xlink:href="011833_figS2" position="float" orientation="portrait" hwp:id="graphic-62"/></fig><sec id="s4i1" hwp:id="sec-31"><title hwp:id="title-40">Number of maximum fitness trees identified by the genetic algorithm</title><p hwp:id="p-85">In underdetermined cases, ranking of trees generated by the GA for a replicate may result in ties. We conservatively define a <italic toggle="yes">Stage 1 success</italic> for a replicate as an outcome where only one or two maximum fitness trees have been identified. To estimate the probability of Stage 1 success, the frequency of success of all tree instances and their replicates for each of 240 (2x2x6x10) unique settings of the key variables is computed. In practice, multiple maximum fitness trees can be a useful result, but limiting the number of ties in this way makes the assessment of the simulations more tractable. Note that <italic toggle="yes">Stage 1 success</italic> is only an indicator that the phylogeny reconstruction data is sufficiently determined to identify a good solution.</p></sec><sec id="s4i2" hwp:id="sec-32"><title hwp:id="title-41">Agreement of maximum fitness tree(s) with the true tree</title><p hwp:id="p-86">Even in the absence of ties, the maximum fitness tree discovered by the GA may not be the true tree that was used as the basis for the simulation. For this assessment, <italic toggle="yes">Stage 2 success</italic> for a replicate is an outcome where either a single maximum fitness or top two maximum fitness trees are the true tree. To assess Stage 2 success, we eliminate replicates where Stage 1 failed and of those remaining, calculate the fraction in which the true tree is either the maximum fitness or one of two maximally fit trees.</p></sec><sec id="s4i3" hwp:id="sec-33"><title hwp:id="title-42">Software availability</title><p hwp:id="p-87">SCHISM software is available for download at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://karchinlab.org/apps/appSchism.html" ext-link-type="uri" xlink:href="http://karchinlab.org/apps/appSchism.html" hwp:id="ext-link-1">http://karchinlab.org/apps/appSchism.html</ext-link></p></sec></sec></sec><sec id="s5" hwp:id="sec-34"><title hwp:id="title-43">Acknowledgments</title><p hwp:id="p-88">NIH NCI grant R01CA179991 provided support for NN. We thank Christine Iacobuzio-Donahue and Alvin Makohon-Moore for valuable discussions about subclonal evolution.</p></sec><sec id="s6" sec-type="supplementary-material" hwp:id="sec-35"><title hwp:id="title-44">Supplementary Methods</title><sec id="s6a" hwp:id="sec-36"><title hwp:id="title-45">Naive mutation cellularity estimate</title><p hwp:id="p-89">In diploid regions, a maximum likelihood estimate based on the observed variant allele fraction of a mutation can be used to infer its cellularity. We use the following simple derivation to estimate the cellularity and its standard error from reference and variant read counts for a mutation <italic toggle="yes">i</italic> in a diploid region of the genome. We further assume that the genotype of normal cells and non-variant tumor cells (tumor cells not carrying the mutation) is <italic toggle="yes">AA</italic> where <italic toggle="yes">A</italic> is the reference allele, and there is no loss of heterozygosity. Under these conditions, the probability of sampling a variant allele from tumor sample <italic toggle="yes">s</italic> with purity <italic toggle="yes">α<sup>s</sup></italic>, for mutation <italic toggle="yes">i</italic> with cellularity <inline-formula hwp:id="inline-formula-64"><alternatives hwp:id="alternatives-97"><inline-graphic xlink:href="011833_inline60a.gif" hwp:id="inline-graphic-64"/></alternatives></inline-formula> is
<disp-formula id="eqnS1" hwp:id="disp-formula-34">
<alternatives hwp:id="alternatives-98"><graphic xlink:href="011833_eqnS1.gif" position="float" orientation="portrait" hwp:id="graphic-42"/></alternatives>
</disp-formula> where <italic toggle="yes">V</italic><sub><italic toggle="yes">exp</italic></sub> is the expected variant allele fraction. By the binomial read count assumption, <inline-formula hwp:id="inline-formula-65"><alternatives hwp:id="alternatives-99"><inline-graphic xlink:href="011833_inline60.gif" hwp:id="inline-graphic-65"/></alternatives></inline-formula> is a single sample unbiased estimator of <italic toggle="yes">V</italic><sub><italic toggle="yes">exp</italic></sub>; here <italic toggle="yes">r</italic><sub><italic toggle="yes">B</italic></sub> and <italic toggle="yes">r</italic><sub><italic toggle="yes">T</italic></sub> represent the observed variant and total read count of a mutation, respectively.
<disp-formula id="eqnS2" hwp:id="disp-formula-35">
<alternatives hwp:id="alternatives-100"><graphic xlink:href="011833_eqnS2.gif" position="float" orientation="portrait" hwp:id="graphic-43"/></alternatives>
</disp-formula>
<disp-formula id="eqnS3" hwp:id="disp-formula-36">
<alternatives hwp:id="alternatives-101"><graphic xlink:href="011833_eqnS3.gif" position="float" orientation="portrait" hwp:id="graphic-44"/></alternatives>
</disp-formula></p><p hwp:id="p-90">Therefore, mutation cellularity can be estimated as
<disp-formula id="eqnS4" hwp:id="disp-formula-37" hwp:rev-id="xref-disp-formula-37-1 xref-disp-formula-37-2">
<alternatives hwp:id="alternatives-102"><graphic xlink:href="011833_eqnS4.gif" position="float" orientation="portrait" hwp:id="graphic-45"/></alternatives>
</disp-formula></p><p hwp:id="p-91">Finally, the estimated variance of the above estimator is
<disp-formula id="eqnS5" hwp:id="disp-formula-38">
<alternatives hwp:id="alternatives-103"><graphic xlink:href="011833_eqnS5.gif" position="float" orientation="portrait" hwp:id="graphic-46"/></alternatives>
</disp-formula>
<disp-formula id="eqnS6" hwp:id="disp-formula-39">
<alternatives hwp:id="alternatives-104"><graphic xlink:href="011833_eqnS6.gif" position="float" orientation="portrait" hwp:id="graphic-47"/></alternatives>
</disp-formula>
<disp-formula id="eqnS7" hwp:id="disp-formula-40">
<alternatives hwp:id="alternatives-105"><graphic xlink:href="011833_eqnS7.gif" position="float" orientation="portrait" hwp:id="graphic-48"/></alternatives>
</disp-formula></p><p hwp:id="p-92">Equation S7 shows that the variance of the cellularity estimates decreases as purity and coverage increase.</p><p hwp:id="p-93">Note that a simple modification allows us to extend this approach to regions with copy number = 1. For mutations in these regions, the cellularity is
<disp-formula id="eqnS8" hwp:id="disp-formula-41">
<alternatives hwp:id="alternatives-106"><graphic xlink:href="011833_eqnS8.gif" position="float" orientation="portrait" hwp:id="graphic-49"/></alternatives>
</disp-formula></p><p hwp:id="p-94">The estimated variance is
<disp-formula id="eqnS9" hwp:id="disp-formula-42">
<alternatives hwp:id="alternatives-107"><graphic xlink:href="011833_eqnS9.gif" position="float" orientation="portrait" hwp:id="graphic-50"/></alternatives>
</disp-formula></p><p hwp:id="p-95">Naive cellularity estimation is useful for mutations located in diploid or hemizygous regions of cancer genomes but is of limited utility in genomes with widespread aneuploidy.</p><p hwp:id="p-96">In patients with largely diploid genomes, it is possible to follow the approach above and in each tumor sample, treat the cellularity of mutations outside diploid or hemizygous regions as missing values. In the next step, for each pair of mutations/mutation clusters, the SCHISM hypothesis test can be performed—although with reduced power—by excluding any samples in which any member of the pair had missing cellularity values. On the other hand in patients with largely aneuploid genomes, more sophisticated approaches to estimate cellularity values are recommended [<xref rid="c15" ref-type="bibr" hwp:id="xref-ref-15-2" hwp:rel-id="ref-15">15</xref>, <xref rid="c16" ref-type="bibr" hwp:id="xref-ref-16-2" hwp:rel-id="ref-16">16</xref>]. These approaches can handle variable ploidy states and by providing cellularity estimates for mutations in a larger subset of samples can help increase the power of the hypothesis test.</p></sec><sec id="s6b" hwp:id="sec-37"><title hwp:id="title-46">Cluster cellularity estimation</title><p hwp:id="p-97">By definition, all mutations in a cluster are assumed to have the same cellularity in each sample. If the cellularity of individual mutations is available, the cellularity of a cluster is estimated to be the mean cellularity of its members
<disp-formula id="eqnS10" hwp:id="disp-formula-43">
<alternatives hwp:id="alternatives-108"><graphic xlink:href="011833_eqnS10.gif" position="float" orientation="portrait" hwp:id="graphic-51"/></alternatives>
</disp-formula></p><p hwp:id="p-98">Otherwise cluster cellularity values from other sources can be used. The cellularity of each cluster across multiple samples is represented as a a matrix <italic toggle="yes">CC</italic> whose elements report the cellularity of each cluster <italic toggle="yes">I</italic>, for each sample <italic toggle="yes">s</italic>.</p></sec><sec id="s6c" hwp:id="sec-38"><title hwp:id="title-47">Topology Similarity Measure</title><p hwp:id="p-99">We apply the <italic toggle="yes">Jaccard Index</italic> to quantify the degree of similarity between two tree topologies—sharing the same mutation clusters—as follows. Let <italic toggle="yes">S</italic><sub><italic toggle="yes">u</italic></sub> be the set of all mutation cluster pairs (<italic toggle="yes">I, J</italic>) where mutation cluster <italic toggle="yes">I</italic> is in the same lineage as and precedes mutation cluster <italic toggle="yes">J</italic> in tree <italic toggle="yes">u</italic>. Then the similarity of two subclonal phylogeny trees <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic> can be measured as:
<disp-formula id="eqnS11" hwp:id="disp-formula-44">
<alternatives hwp:id="alternatives-109"><graphic xlink:href="011833_eqnS11.gif" position="float" orientation="portrait" hwp:id="graphic-52"/></alternatives>
</disp-formula></p><p hwp:id="p-100">By construction, Jaccard index varies in [0, 1]. A value of 1 for the Jaccard Index indicates equality of sets <italic toggle="yes">S</italic><sub><italic toggle="yes">u</italic></sub> and <italic toggle="yes">S</italic><sub><italic toggle="yes">v</italic></sub> and thus identical topologies for trees <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic>.</p></sec><sec id="s6d" hwp:id="sec-39"><title hwp:id="title-48">Simulations</title><sec id="s6d1" hwp:id="sec-40"><title hwp:id="title-49">Generating mutation cellularities</title><p hwp:id="p-101">In each simulated sample <italic toggle="yes">s</italic>, a breadth-first-search (BFS) of a subclone tree begins at the incident edge downstream of the root node. The mutation cluster corresponding to this edge has cellularity of 1, and it represents clonal mutations occurring in the most recent common progenitor cell of all the patient’s tumor cells. For subsequent edges, cellularity values are distributed with a modified version of the tree-structured stick-breaking process model [<xref rid="c26" ref-type="bibr" hwp:id="xref-ref-26-1" hwp:rel-id="ref-26">26</xref>, <xref rid="c6" ref-type="bibr" hwp:id="xref-ref-6-7" hwp:rel-id="ref-6">6</xref>].</p><p hwp:id="p-102">For each tree topology <italic toggle="yes">instance</italic> at each node count level, ten sets of mutation cluster cellularity values are generated, representing 10 samples from an individual. Each tree node then represents a unique set of cells or subclones harboring mutations, which have accumulated along the path from the root to that node. As in (Methods <xref ref-type="disp-formula" rid="eqn31" hwp:id="xref-disp-formula-31-2" hwp:rel-id="disp-formula-31">Eq. 31</xref>), <italic toggle="yes">p</italic>(<italic toggle="yes">n</italic>) is the mutation cluster associated with the edge immediately upstream of node <italic toggle="yes">n</italic>, and <italic toggle="yes">D</italic>(<italic toggle="yes">n</italic>) is the set of mutation clusters associated with its immediate downstream edges. Letting <italic toggle="yes">n</italic> = 0 correspond to the node immediately downstream of the root, the edge corresponding to clonal mutations is assigned cellularity <inline-formula hwp:id="inline-formula-66"><alternatives hwp:id="alternatives-110"><inline-graphic xlink:href="011833_inline61.gif" hwp:id="inline-graphic-66"/></alternatives></inline-formula>. For each subsequent node <italic toggle="yes">n</italic>, the fraction of tumor cells that <italic toggle="yes">p</italic>(<italic toggle="yes">n</italic>) harbor <italic toggle="yes">p</italic>(<italic toggle="yes">n</italic>) but none of the mutation clusters downstream of <italic toggle="yes">n</italic> is <inline-formula hwp:id="inline-formula-67"><alternatives hwp:id="alternatives-111"><inline-graphic xlink:href="011833_inline62.gif" hwp:id="inline-graphic-67"/></alternatives></inline-formula> where
<disp-formula id="eqnS12" hwp:id="disp-formula-45">
<alternatives hwp:id="alternatives-112"><graphic xlink:href="011833_eqnS12.gif" position="float" orientation="portrait" hwp:id="graphic-53"/></alternatives>
</disp-formula> and <italic toggle="yes">α</italic><sub>0</sub> = 5, <italic toggle="yes">λ</italic><sub>0</sub> = 0.5 and <italic toggle="yes">d</italic><sub><italic toggle="yes">n</italic></sub> is the depth of node <italic toggle="yes">n</italic> in the rooted tree. Then <inline-formula hwp:id="inline-formula-68"><alternatives hwp:id="alternatives-113"><inline-graphic xlink:href="011833_inline63.gif" hwp:id="inline-graphic-68"/></alternatives></inline-formula> is the fraction of cancer cells harboring at least one mutation cluster in <italic toggle="yes">D</italic>(<italic toggle="yes">n</italic>) in addition to <italic toggle="yes">p</italic>(<italic toggle="yes">n</italic>). These are cells that diverge from their parental population at node <italic toggle="yes">n</italic>. Therefore,
<disp-formula id="eqnS13" hwp:id="disp-formula-46">
<alternatives hwp:id="alternatives-114"><graphic xlink:href="011833_eqnS13.gif" position="float" orientation="portrait" hwp:id="graphic-54"/></alternatives>
</disp-formula></p><p hwp:id="p-103">Letting <italic toggle="yes">V</italic> be a vector of size <italic toggle="yes">|D</italic>(<italic toggle="yes">n</italic>)|, and
<disp-formula id="eqnS14" hwp:id="disp-formula-47">
<alternatives hwp:id="alternatives-115"><graphic xlink:href="011833_eqnS14.gif" position="float" orientation="portrait" hwp:id="graphic-55"/></alternatives>
</disp-formula> then the cellularity of each downstream mutation cluster is
<disp-formula id="eqnS15" hwp:id="disp-formula-48">
<alternatives hwp:id="alternatives-116"><graphic xlink:href="011833_eqnS15.gif" position="float" orientation="portrait" hwp:id="graphic-56"/></alternatives>
</disp-formula></p><p hwp:id="p-104">To capture variability among individuals, this procedure is replicated ten times for each tree <italic toggle="yes">instance</italic>.</p></sec><sec id="s6d2" hwp:id="sec-41"><title hwp:id="title-50">Mutation Variant Allele Fractions</title><p hwp:id="p-105">To obtain read counts that are consistent with the simulated cellularity values in each sample <italic toggle="yes">s</italic>, variant and reference read count values are generated for each mutation in mutation cluster <italic toggle="yes">p</italic>(<italic toggle="yes">n</italic>) associated with <italic toggle="yes">p</italic>(<italic toggle="yes">n</italic>) the edge immediately upstream of node <italic toggle="yes">n</italic>, given simulated cellularity value <inline-formula hwp:id="inline-formula-69"><alternatives hwp:id="alternatives-117"><inline-graphic xlink:href="011833_inline64.gif" hwp:id="inline-graphic-69"/></alternatives></inline-formula>, as follows. We make the simplifying assumption that mutations considered in this simulation experiment are located in diploid regions of tumor genomes in all samples. This assumption enables application of the naive cellularity estimator and allows focusing on performance of the other modules in SCHISM pipeline. Following the conditions above, the expected variant allele frequency for mutations in <italic toggle="yes">p</italic>(<italic toggle="yes">n</italic>) is
<disp-formula id="eqnS16" hwp:id="disp-formula-49">
<alternatives hwp:id="alternatives-118"><graphic xlink:href="011833_eqnS16.gif" position="float" orientation="portrait" hwp:id="graphic-57"/></alternatives>
</disp-formula></p><p hwp:id="p-106">Since read counts may be overdispersed, a noisy expected variant allele frequency for each mutation <italic toggle="yes">i</italic> ∈ <italic toggle="yes">p</italic>(<italic toggle="yes">n</italic>) is generated as <disp-formula id="eqnS17" hwp:id="disp-formula-50">
<alternatives hwp:id="alternatives-119"><graphic xlink:href="011833_eqnS17.gif" position="float" orientation="portrait" hwp:id="graphic-58"/></alternatives>
</disp-formula> <disp-formula id="eqnS18" hwp:id="disp-formula-51">
<alternatives hwp:id="alternatives-120"><graphic xlink:href="011833_eqnS18.gif" position="float" orientation="portrait" hwp:id="graphic-59"/></alternatives>
</disp-formula> where <italic toggle="yes">S</italic> is a global precision parameter for each simulated individual. Given coverage <inline-formula hwp:id="inline-formula-70"><alternatives hwp:id="alternatives-121"><inline-graphic xlink:href="011833_inline65.gif" hwp:id="inline-graphic-70"/></alternatives></inline-formula> for variant <italic toggle="yes">i</italic>, variant read count is
<disp-formula id="eqnS19" hwp:id="disp-formula-52">
<alternatives hwp:id="alternatives-122"><graphic xlink:href="011833_eqnS19.gif" position="float" orientation="portrait" hwp:id="graphic-60"/></alternatives>
</disp-formula></p></sec></sec></sec><sec id="s7" hwp:id="sec-42"><title hwp:id="title-51">Supplementary Results</title><sec id="s7a" hwp:id="sec-43"><title hwp:id="title-52">Genetic algorithm evaluation with large subclone count</title><p hwp:id="p-107">To explore the utility of the genetic algorithm presented in this work when the number of nodes in a subclonal phylogeny is large, we designed a simulation in which 7 tumor samples were available from a patient and 15 subclones were present. In the simulations, the true subclonal phylogeny tree and the cellularity of each mutation cluster in each sample is known. Two patients were simulated. For one patient, the topology of the true tree was predominantly branched, and for the other the topology was predominantly linear (<xref rid="figS3" ref-type="fig" hwp:id="xref-fig-11-1" hwp:rel-id="F11">Fig. S3A</xref>, <xref rid="figS4" ref-type="fig" hwp:id="xref-fig-12-1" hwp:rel-id="F12">Fig. S4A</xref>). Mutation cluster cellularities for each patient are shown in (<xref rid="figS3" ref-type="fig" hwp:id="xref-fig-11-2" hwp:rel-id="F11">Fig. S3B</xref>, <xref rid="figS4" ref-type="fig" hwp:id="xref-fig-12-2" hwp:rel-id="F12">Fig. S4B</xref>). The hypothesis test was applied to each pair of mutation clusters, yielding CPOV matrices (<xref rid="figS3" ref-type="fig" hwp:id="xref-fig-11-3" hwp:rel-id="F11">Fig. S3C</xref>, <xref rid="figS4" ref-type="fig" hwp:id="xref-fig-12-3" hwp:rel-id="F12">Fig. S4C</xref>). For each simulated patient, we performed 10 runs of the GA, where each run consisted of 50 generations with 1000 trees per generation. To assess how many generations were required to identify the true tree, we monitored the progress of the GA by evaluating the topologies of all trees in the population reported to have maximum fitness after each generation. Evaluation was done by computing a Jaccard index of each of these trees with respect to the true tree (Supplementary Methods, Topology Similarity Measure). The maximum Jaccard Index after each generation is shown in (<xref rid="figS3" ref-type="fig" hwp:id="xref-fig-11-4" hwp:rel-id="F11">Fig. S3D</xref>, <xref rid="figS4" ref-type="fig" hwp:id="xref-fig-12-4" hwp:rel-id="F12">Fig. S4D</xref>).</p><fig id="figS3" position="float" orientation="portrait" fig-type="figure" hwp:id="F11" hwp:rev-id="xref-fig-11-1 xref-fig-11-2 xref-fig-11-3 xref-fig-11-4 xref-fig-11-5 xref-fig-11-6 xref-fig-11-7 xref-fig-11-8 xref-fig-11-9"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/FIGS3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F11</object-id><object-id pub-id-type="publisher-id">figS3</object-id><label>Figure S3.</label><caption hwp:id="caption-11"><title hwp:id="title-60">Performance of Genetic Algorithm in reconstruction of a subclonal phylogeny with large node count (n=15).</title><p hwp:id="p-123"><bold>A.</bold> a phylogenetic tree summarizing clonal evolution in a simulated patient <bold>B.</bold> Cellularity values of fifteen mutation clusters (CL0-14) in seven simulated biopsies S1-7 <bold>C.</bold> CPOV matrix depicting the hypothesis test outcomes. Each red square represents a pair of mutation clusters (I,J) for which the null hypothesis that I could be the parent of J was rejected. Each blue square represents a pair for which the null hypothesis could not be rejected. <bold>D.</bold> The Jaccard index (Supplementary Methods, Topology Similarity Measure) of the true tree (A) and the maximum fitness tree(s) in population at the end of each GA generation. In cases where more than a single highest maximum fitness tree was present, the maximum of the Jaccard indices is plotted. Each color trace represent one of ten independent GA runs performed on inputs in (B, C). <bold>E.</bold> The Jaccard index of the true tree and the maximum fitness trees at the end of each generation for a sample GA run. Each transparent circle represents a single maximum fitness tree. This GA run identified 9 maximum fitness tree topologies, one of which was the true tree (A). <bold>F.</bold> The consensus topology of the nine trees identified in (E). These trees shared the majority of their lineage relationships and only disagreed in parental lineage of mutation clusters CL10 and CL14.</p></caption><graphic xlink:href="011833_figS3" position="float" orientation="portrait" hwp:id="graphic-63"/></fig><fig id="figS4" position="float" orientation="portrait" fig-type="figure" hwp:id="F12" hwp:rev-id="xref-fig-12-1 xref-fig-12-2 xref-fig-12-3 xref-fig-12-4 xref-fig-12-5 xref-fig-12-6 xref-fig-12-7 xref-fig-12-8 xref-fig-12-9"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/FIGS4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F12</object-id><object-id pub-id-type="publisher-id">figS4</object-id><label>Figure S4.</label><caption hwp:id="caption-12"><title hwp:id="title-61">Performance of Genetic Algorithm in reconstruction of a subclonal phylogeny with large node count (n=15).</title><p hwp:id="p-124"><bold>A.</bold> a phylogenetic tree summarizing clonal evolution in a second simulated patient <bold>B.</bold> Cellularity values of fifteen mutation clusters (CL0-14) in seven simulated biopsies S1-7 <bold>C.</bold> CPOV matrix depicting the hypothesis test outcomes. Each red square represents a pair of mutation clusters (I,J) for which the null hypothesis that I could be the parent of J was rejected. Each blue square represents a pair for which the null hypothesis could not be rejected. <bold>D.</bold> The Jaccard index (Supplementary Methods, Topology Similarity Measure) of the true tree (A) and the maximum fitness tree(s) in population at the end of each GA generation. In cases where more than a single maximum fitness tree was present, the maximum of the Jaccard indices is plotted. Each color trace represent one of ten independent GA runs performed on inputs in (B, C). Only one of the ten GA runs (dark purple trace) identified the true tree (indicated by reaching Jaccard Index =1). <bold>E.</bold> The Jaccard index of the true tree and the maximum fitness trees at the end of each generation for the successful run. Each transparent circle represents a single maximum fitness tree. This GA run also found 16 other phylogenetic trees sharing the maximum fitness with the true tree.(A). <bold>F.</bold> The consensus topology of the seventeen trees identified in (E). These trees disagreed in parental lineage of 5 out 15 mutation clusters CL16, CL7, CL8, CL12, CL14.</p></caption><graphic xlink:href="011833_figS4" position="float" orientation="portrait" hwp:id="graphic-64"/></fig><p hwp:id="p-108"><xref rid="figS3" ref-type="fig" hwp:id="xref-fig-11-5" hwp:rel-id="F11">Fig. S3</xref> shows results for one of the simulated patients, in which the true tree topology is primarily branched. For this patient, 8 of the 10 GA runs identified the true tree at 50 generations (<xref rid="figS3" ref-type="fig" hwp:id="xref-fig-11-6" hwp:rel-id="F11">Fig. S3D</xref>). <xref rid="figS3" ref-type="fig" hwp:id="xref-fig-11-7" hwp:rel-id="F11">Fig. S3E</xref> shows the progress of one GA run that was randomly selected from these 8 runs. For each generation, the Jaccard Index for all of the maximum fitness trees is shown, rather than only for the tree with maximum Jaccard Index. At the 50th generation, the GA identified nine trees with maximum fitness and one of them was the true tree (<xref rid="figS3" ref-type="fig" hwp:id="xref-fig-11-8" hwp:rel-id="F11">Fig. S3E</xref>). A consensus tree of these nine trees is shown in <xref rid="figS3" ref-type="fig" hwp:id="xref-fig-11-9" hwp:rel-id="F11">Fig. S3F</xref>.</p><p hwp:id="p-109"><xref rid="figS4" ref-type="fig" hwp:id="xref-fig-12-5" hwp:rel-id="F12">Fig. S4</xref> show results for the second simulated patient, in which the true tree topology is primarily linear. For this patient, 1 of the 10 GA runs identified the true tree at 50 generations (<xref rid="figS4" ref-type="fig" hwp:id="xref-fig-12-6" hwp:rel-id="F12">Fig. S4D</xref>). <xref rid="figS4" ref-type="fig" hwp:id="xref-fig-12-7" hwp:rel-id="F12">Fig. S4E</xref> shows the progress of this GA run. At the 50th generation, the GA identified 17 trees with maximum fitness and one of them was the true tree (<xref rid="figS4" ref-type="fig" hwp:id="xref-fig-12-8" hwp:rel-id="F12">Fig. S4E</xref>). A consensus tree of these 17 trees is shown in <xref rid="figS4" ref-type="fig" hwp:id="xref-fig-12-9" hwp:rel-id="F12">Fig. S4F</xref>.</p><p hwp:id="p-110">These results suggest that the GA is able to identify the true subclonal phylogeny, even in cases where the number of subclones is as high as 15, and it is reasonable to infer that it will even succeed for larger numbers of subclones, in some but not all cases. Importantly, the effectiveness of the GA may depend on details of the patient’s cancer evolutionary history and the biopsy samples.</p></sec><sec id="s7b" hwp:id="sec-44"><title hwp:id="title-53">Limitations of topology cost or mass cost alone in identifying the true tree</title><p hwp:id="p-111">Our fitness function depends on both a topology cost (TC), represented in the CPOV matrix, and a mass cost (MC). The effectiveness of the TC by itself in narrowing down candidate tree topologies and identifying the true tree depends on the topology of that true tree. For completely branched topologies, the TC alone may be sufficient in identifying the true tree, if the CPOV matrix has power of 1.0 and Type 1 error of 0. In the case of trees that include linear topologies, the TC alone will not be sufficient. <xref rid="figS5" ref-type="fig" hwp:id="xref-fig-13-3" hwp:rel-id="F13">Fig. S5</xref> shows two scenarios that illustrate this point. For the 5-node branched tree (<xref rid="figS5" ref-type="fig" hwp:id="xref-fig-13-4" hwp:rel-id="F13">Fig. S5A</xref>) the CPOV matrix alone can identify the true tree. For the 5-node linear tree (<xref rid="figS5" ref-type="fig" hwp:id="xref-fig-13-5" hwp:rel-id="F13">Fig. S5B</xref>), six candidate trees (<xref rid="figS5" ref-type="fig" hwp:id="xref-fig-13-6" hwp:rel-id="F13">Fig. S5C</xref>) are equally likely to be the true tree if only the CPOV matrix is considered.</p><fig id="figS5" position="float" orientation="portrait" fig-type="figure" hwp:id="F13" hwp:rev-id="xref-fig-13-1 xref-fig-13-2 xref-fig-13-3 xref-fig-13-4 xref-fig-13-5 xref-fig-13-6 xref-fig-13-7"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/FIGS5</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F13</object-id><object-id pub-id-type="publisher-id">figS5</object-id><label>Figure S5.</label><caption hwp:id="caption-13"><title hwp:id="title-62">Limitations of the topology cost in identifying the true tree.</title><p hwp:id="p-125">Our fitness function considers both a topology cost and a mass cost. If only topology cost is used, in the case of a completely branched tree (A) and a CPOV matrix with power of 1.0 and Type 1 error of 0, the mass cost is not necessary to narrow down candidate tree topologies. However, if the tree contains linear topologies (B), the topology cost is not sufficient to identify the true tree. <bold>A</bold> and <bold>B.</bold> simple 5-node trees representing branched (A) and linear (B) evolutionary patterns. CPOV matrices under the assumption of power 1.0 and Type error 0 appear to the right of each tree. <bold>C.</bold> Candidate tree topologies. C1 depicts the only tree topology compatible with the CPOV matrix of the branched evolutionary pattern (A); while C1-6 are all compatible with the CPOV matrix of the linear evolutionary pattern (B), showing that in this case the topology cost alone is not sufficient.</p></caption><graphic xlink:href="011833_figS5" position="float" orientation="portrait" hwp:id="graphic-65"/></fig><p hwp:id="p-112"><xref rid="figS6" ref-type="fig" hwp:id="xref-fig-14-2" hwp:rel-id="F14">Fig. S6</xref> shows an example where MC alone is not sufficient to identify the true tree, a five-node tree representing a moderately branched evolutionary pattern (<xref rid="figS6" ref-type="fig" hwp:id="xref-fig-14-3" hwp:rel-id="F14">Fig. S6A</xref>). <xref rid="figS6" ref-type="fig" hwp:id="xref-fig-14-4" hwp:rel-id="F14">Fig. S6B</xref> and <xref rid="figS6" ref-type="fig" hwp:id="xref-fig-14-5" hwp:rel-id="F14">Fig. S6C</xref> show cellularity values for two simulated samples and the CPOV matrix. Five candidate tree topologies (<xref rid="figS6" ref-type="fig" hwp:id="xref-fig-14-6" hwp:rel-id="F14">Fig. S6D</xref>) are depicted. Topogies D1, D2 and D3 have minimum TC; D4 and D5 have minimum MC. Using both TC and MC uniquely identifies the true tree topology (D1).</p><fig id="figS6" position="float" orientation="portrait" fig-type="figure" hwp:id="F14" hwp:rev-id="xref-fig-14-1 xref-fig-14-2 xref-fig-14-3 xref-fig-14-4 xref-fig-14-5 xref-fig-14-6 xref-fig-14-7"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/FIGS6</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F14</object-id><object-id pub-id-type="publisher-id">figS6</object-id><label>Figure S6.</label><caption hwp:id="caption-14"><title hwp:id="title-63">Limitation of the mass cost in identifying the true tree.</title><p hwp:id="p-126">Our fitness function considers both a topology cost and a mass cost. Mass cost alone is not sufficient to identify the true tree topology for the example cluster cellularity input in (B). The combination of the two cost terms outperforms each term alone in this example. <bold>A</bold> simple 5-node tree representing a moderately branched evolutionary pattern. <bold>B.</bold> Input cellularity values in two simulated samples. <bold>C.</bold> CPOV matrix. <bold>D.</bold> Candidate tree topologies. D1-3 depict topologies with minimum topology cost, and D4-5 depict those with minimum mass cost. Using both topology and mass cost uniquely identifies the true tree topology (D1).</p></caption><graphic xlink:href="011833_figS6" position="float" orientation="portrait" hwp:id="graphic-66"/></fig></sec><sec id="s7c" hwp:id="sec-45"><title hwp:id="title-54">Sensitivity of genetic algorithm to <italic toggle="yes">f</italic><sub><italic toggle="yes">c</italic></sub> parameter</title><p hwp:id="p-113">The fitness function in our genetic algorithm is a decaying exponential function of tree cost. The parameter <italic toggle="yes">f</italic><sub><italic toggle="yes">c</italic></sub> is a coefficient of the cost and controls the rate at which changes in cost yield changes in fitness. We performed a sensitivity analysis to identify a good default value <italic toggle="yes">f</italic><sub><italic toggle="yes">c</italic></sub> on simulated data. Two scenarios were considered: 8-node tree with three samples and 15-node tree with seven samples. We ran 20 independent runs of the GA for each tree, using 6 unique values of <italic toggle="yes">f</italic><sub><italic toggle="yes">c</italic></sub>. A run for the 8-node tree spanned 20 generations, and a run for the 15-node tree spanned 50 generations, to enable good sampling of tree topology space. Each generation consisted of 1000 trees. The value <italic toggle="yes">f</italic><sub><italic toggle="yes">c</italic></sub> = 5 produces the best results, when both scenarios are considered. For the 8-node tree, 19 out of 20 runs identified the true tree and for the 15-node tree, 17 out of 20 runs identified the true tree (<xref rid="figS7" ref-type="fig" hwp:id="xref-fig-15-1" hwp:rel-id="F15">Fig. S7</xref>).</p><fig id="figS7" position="float" orientation="portrait" fig-type="figure" hwp:id="F15" hwp:rev-id="xref-fig-15-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/FIGS7</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F15</object-id><object-id pub-id-type="publisher-id">figS7</object-id><label>Figure S7.</label><caption hwp:id="caption-15"><title hwp:id="title-64">Sensitivity of genetic algorithm to <italic toggle="yes">f</italic><sub><italic toggle="yes">c</italic></sub> parameter.</title><p hwp:id="p-127">Simulations were designed to identify a reasonable default value of <italic toggle="yes">f</italic><sub><italic toggle="yes">c</italic></sub> in a few scenarios. An 8-node tree and a 15-node tree were simulated (as described in the Simulations section of Methods). The GA was run 20 times for each tree. For the 8-node tree, each run spanned 20 generations and for the 15-node tree, each run spanned 50 generations to enable good sampling of the tree topology space. <bold>A</bold> 8-node tree <bold>B</bold> 15-node tree. <bold>C</bold> and <bold>D</bold> The number of runs (out of 20) in which the true tree was identified by the GA for six values of <italic toggle="yes">f</italic><sub><italic toggle="yes">c</italic></sub>. The value <italic toggle="yes">f</italic><sub><italic toggle="yes">c</italic></sub> = 5 produces good results for both scenarios.</p></caption><graphic xlink:href="011833_figS7" position="float" orientation="portrait" hwp:id="graphic-67"/></fig></sec><sec id="s7d" hwp:id="sec-46"><title hwp:id="title-55">Detail of cost function for multi-sample sequencing studies</title><p hwp:id="p-114"><xref rid="tblS2" ref-type="table" hwp:id="xref-table-wrap-2-1" hwp:rel-id="T2">Table S2</xref> shows the performance of SCHISM on data from the three multi-sample sequencing studies (Results) when only the topology cost (TC) or mass cost (MC) is used in the genetic algorithm. Addition of MC substantially reduces the number of maximum fitness trees identified. In this set of samples, MC alone has equivalent performance to TC+MC. As shown in (<xref rid="figS5" ref-type="fig" hwp:id="xref-fig-13-7" hwp:rel-id="F13">Fig. S5</xref>, <xref rid="figS6" ref-type="fig" hwp:id="xref-fig-14-7" hwp:rel-id="F14">Fig. S6</xref>), inclusion of both cost terms can handle scenarios where only one is insufficient.</p><table-wrap id="tblS2" orientation="portrait" position="float" hwp:id="T2" hwp:rev-id="xref-table-wrap-2-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/TBLS2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T2</object-id><object-id pub-id-type="publisher-id">tblS2</object-id><label>Table S2.</label><caption hwp:id="caption-18"><p hwp:id="p-130">Detailed performance of cost function for multi-sample sequencing studies</p></caption><graphic xlink:href="011833_tblS2" position="float" orientation="portrait" hwp:id="graphic-70"/></table-wrap></sec><sec id="s7e" hwp:id="sec-47"><title hwp:id="title-56">Comparison of SCHISM, SubcloneSeeker and TrAp output on patient AML1</title><p hwp:id="p-115">Subclone Seeker and TrAp have similar inputs to SCHISM but the modeling task and outputs are different. SCHISM models a single, unified tree across multiple samples. Subclone Seeker and TrAp model trees for each individual sample and do not provide a unified tree. To illustrate these differences, we have compared the output of SCHISM to SubcloneSeeker and TrAp on eight two-sample cases (primary and relapse) from acute myeloid leukemia (AML) patients [<xref rid="c12" ref-type="bibr" hwp:id="xref-ref-12-11" hwp:rel-id="ref-12">12</xref>] and one two-sample case (primary and metastasis) from a murine small cell lung cancer (mSCLC) [<xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-11" hwp:rel-id="ref-13">13</xref>]. (Subclone Seeker can handle only up to two samples). Variant allele fractions and mutation cluster assignments from [<xref rid="c12" ref-type="bibr" hwp:id="xref-ref-12-12" hwp:rel-id="ref-12">12</xref>] were used to estimate cluster cellularities and these were input to all three methods.</p><p hwp:id="p-116"><xref rid="figS8" ref-type="fig" hwp:id="xref-fig-16-1" hwp:rel-id="F16">Fig. S8</xref> shows detailed results for the AML patient AML1.</p><fig id="figS8" position="float" orientation="portrait" fig-type="figure" hwp:id="F16" hwp:rev-id="xref-fig-16-1 xref-fig-16-2 xref-fig-16-3 xref-fig-16-4 xref-fig-16-5"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;011833v3/FIGS8</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F16</object-id><object-id pub-id-type="publisher-id">figS8</object-id><label>Figure S8.</label><caption hwp:id="caption-16"><title hwp:id="title-65">Comparison of SCHISM, SubcloneSeeker and TrAp output on patient AML1.</title><p hwp:id="p-128">Subclone Seeker and TrAp have similar inputs to SCHISM but the modeling task and outputs are different. <bold>A</bold> SCHISM models a single, unified tree across multiple samples. <bold>B</bold> Subclone Seeker and <bold>C</bold> TrAp model trees for each individual sample. The AML1 patient has one primary and one relapse sample [<xref rid="c12" ref-type="bibr" hwp:id="xref-ref-12-13" hwp:rel-id="ref-12">12</xref>]. SubcloneSeeker reports six trees for the primary sample and one tree for the relapse (secondary) sample. Primary Tree 11 is reported as compatible with Secondary Tree 1 (marked with asterisks). TrAp reports a top-scoring pair of trees – one tree (left) for the primary and one tree (right) for the relapse sample.</p></caption><graphic xlink:href="011833_figS8" position="float" orientation="portrait" hwp:id="graphic-68"/></fig><p hwp:id="p-117">SCHISM results are a unified tree for both samples in patient AML1 (<xref rid="figS8" ref-type="fig" hwp:id="xref-fig-16-2" hwp:rel-id="F16">Fig. S8A</xref>).</p><p hwp:id="p-118">SubcloneSeeker models the evolution of each individual sample, then identifies compatible pairs of sample trees (<xref rid="figS8" ref-type="fig" hwp:id="xref-fig-16-3" hwp:rel-id="F16">Fig. S8B</xref>). Six trees are reported for the AML1 primary sample (Primary Tree 1, Primary Tree 6, Primary Tree 11, Primary Tree 16, Primary Tree 21, Primary Tree 26). One tree is reported for the secondary sample (Secondary Tree 1). Primary Tree 11 is reported as compatible with Secondary Tree 1 (marked with asterisks in <xref rid="figS8" ref-type="fig" hwp:id="xref-fig-16-4" hwp:rel-id="F16">Fig. S8B</xref>). As shown, each tree node is labeled with <italic toggle="yes">n</italic> followed by a number. The labels are not related to user-provided mutation cluster IDs. It is unclear how Primary Tree 11 and Secondary Tree 1 should be merged, given that the node numbers are disjoint between the two trees, or whether the two trees are compatible with the SCHISM unified tree.</p><p hwp:id="p-119">TrAp also models the evolution of each individual sample, requiring compatibility across all samples, then outputs individual sample trees (<xref rid="figS8" ref-type="fig" hwp:id="xref-fig-16-5" hwp:rel-id="F16">Fig. S8C</xref>). The tree on the left represents the AML1 primary sample and the tree on the right represents the relapse sample. The TrAp trees are compatible with the SCHISM tree, which matches the manually curated tree published by Ding et al. However, the TrAp trees collapse two of the mutation clusters in the primary sample and three in the relapse sample, which is likely due to over-merging of mutation clusters.</p><p hwp:id="p-120">SubcloneSeeker and TrAp appear to over-merge mutation clusters in three and two of the seven remaining AML patients, respectively. For mSCLC case mSCLC984, SubcloneSeeker does not generate any compatible pairs for the primary and secondary samples, and TrAp does not generate any trees compatible with unified trees identified by SCHISM, or the manually curated tree in [<xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-12" hwp:rel-id="ref-13">13</xref>].</p></sec></sec></body><back><ref-list hwp:id="ref-list-1"><title hwp:id="title-57">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1"><label>1.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.1" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Nowell PC"><surname>Nowell</surname> <given-names>PC</given-names></string-name>. <article-title hwp:id="article-title-2">The clonal evolution of tumor cell populations</article-title>. <source hwp:id="source-1">Science.</source> <year>1976</year>;<volume>194</volume>(<issue>4260</issue>):<fpage>23</fpage>–<lpage>28</lpage>.</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1"><label>2.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="Greaves M"><surname>Greaves</surname> <given-names>M</given-names></string-name>, <string-name name-style="western" hwp:sortable="Maley CC"><surname>Maley</surname> <given-names>CC</given-names></string-name>. <article-title hwp:id="article-title-3">Clonal evolution in cancer</article-title>. <source hwp:id="source-2">Nature.</source> <year>2012</year> <month>Jan</month>;<volume>481</volume>(<issue>7381</issue>):<fpage>306</fpage>–<lpage>313</lpage>.</citation></ref><ref id="c3" hwp:id="ref-3" hwp:rev-id="xref-ref-3-1"><label>3.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.3" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Kostadinov RL"><surname>Kostadinov</surname> <given-names>RL</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kuhner MK"><surname>Kuhner</surname> <given-names>MK</given-names></string-name>, <string-name name-style="western" hwp:sortable="Li X"><surname>Li</surname> <given-names>X</given-names></string-name>, <string-name name-style="western" hwp:sortable="Sanchez CA"><surname>Sanchez</surname> <given-names>CA</given-names></string-name>, <string-name name-style="western" hwp:sortable="Galipeau PC"><surname>Galipeau</surname> <given-names>PC</given-names></string-name>, <string-name name-style="western" hwp:sortable="Paulson TG"><surname>Paulson</surname> <given-names>TG</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-4">NSAIDs modulate clonal evolution in Barrett’s esophagus</article-title>. <source hwp:id="source-3">PLoS Genetics.</source> <year>2013</year>;<volume>9</volume>(<issue>6</issue>):<fpage>e1003553</fpage>.</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1 xref-ref-4-2"><label>4.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.4" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Gerlinger M"><surname>Gerlinger</surname> <given-names>M</given-names></string-name>, <string-name name-style="western" hwp:sortable="Horswell S"><surname>Horswell</surname> <given-names>S</given-names></string-name>, <string-name name-style="western" hwp:sortable="Larkin J"><surname>Larkin</surname> <given-names>J</given-names></string-name>, <string-name name-style="western" hwp:sortable="Rowan AJ"><surname>Rowan</surname> <given-names>AJ</given-names></string-name>, <string-name name-style="western" hwp:sortable="Salm MP"><surname>Salm</surname> <given-names>MP</given-names></string-name>, <string-name name-style="western" hwp:sortable="Varela I"><surname>Varela</surname> <given-names>I</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-5">Genomic architecture and evolution of clear cell renal cell carcinomas defined by multiregion sequencing</article-title>. <source hwp:id="source-4">Nature Genetics.</source> <year>2014</year>;<volume>46</volume>(<issue>3</issue>):<fpage>225</fpage>–<lpage>233</lpage>.</citation></ref><ref id="c5" hwp:id="ref-5" hwp:rev-id="xref-ref-5-1"><label>5.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.5" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Johnson BE"><surname>Johnson</surname> <given-names>BE</given-names></string-name>, <string-name name-style="western" hwp:sortable="Mazor T"><surname>Mazor</surname> <given-names>T</given-names></string-name>, <string-name name-style="western" hwp:sortable="Hong C"><surname>Hong</surname> <given-names>C</given-names></string-name>, <string-name name-style="western" hwp:sortable="Barnes M"><surname>Barnes</surname> <given-names>M</given-names></string-name>, <string-name name-style="western" hwp:sortable="Aihara K"><surname>Aihara</surname> <given-names>K</given-names></string-name>, <string-name name-style="western" hwp:sortable="McLean CY"><surname>McLean</surname> <given-names>CY</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-6">Mutational analysis reveals the origin and therapy-driven evolution of recurrent glioma</article-title>. <source hwp:id="source-5">Science.</source> <year>2014</year>;<volume>343</volume>(<issue>6167</issue>):<fpage>189</fpage>–<lpage>193</lpage>.</citation></ref><ref id="c6" hwp:id="ref-6" hwp:rev-id="xref-ref-6-1 xref-ref-6-2 xref-ref-6-3 xref-ref-6-4 xref-ref-6-5 xref-ref-6-6 xref-ref-6-7"><label>6.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.6" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Jiao W"><surname>Jiao</surname> <given-names>W</given-names></string-name>, <string-name name-style="western" hwp:sortable="Vembu S"><surname>Vembu</surname> <given-names>S</given-names></string-name>, <string-name name-style="western" hwp:sortable="Deshwar AG"><surname>Deshwar</surname> <given-names>AG</given-names></string-name>, <string-name name-style="western" hwp:sortable="Stein L"><surname>Stein</surname> <given-names>L</given-names></string-name>, <string-name name-style="western" hwp:sortable="Morris Q."><surname>Morris</surname> <given-names>Q.</given-names></string-name> <article-title hwp:id="article-title-7">Inferring clonal evolution of tumors from single nucleotide somatic mutations</article-title>. <source hwp:id="source-6">BMC Bioinformatics.</source> <year>2014</year>;<volume>15</volume>(<issue>1</issue>):<fpage>35</fpage>.</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1 xref-ref-7-2 xref-ref-7-3 xref-ref-7-4 xref-ref-7-5"><label>7.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.7" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Hajirasouliha I"><surname>Hajirasouliha</surname> <given-names>I</given-names></string-name>, <string-name name-style="western" hwp:sortable="Mahmoody A"><surname>Mahmoody</surname> <given-names>A</given-names></string-name>, <string-name name-style="western" hwp:sortable="Raphael BJ"><surname>Raphael</surname> <given-names>BJ</given-names></string-name>. <article-title hwp:id="article-title-8">A combinatorial approach for analyzing intra-tumor heterogeneity from high-throughput sequencing data</article-title>. <source hwp:id="source-7">Bioinformatics.</source> <year>2014</year>;<volume>30</volume>(<issue>12</issue>):<fpage>i78</fpage>–<lpage>i86</lpage>.</citation></ref><ref id="c8" hwp:id="ref-8" hwp:rev-id="xref-ref-8-1 xref-ref-8-2 xref-ref-8-3 xref-ref-8-4 xref-ref-8-5"><label>8.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Strino F"><surname>Strino</surname> <given-names>F</given-names></string-name>, <string-name name-style="western" hwp:sortable="Parisi F"><surname>Parisi</surname> <given-names>F</given-names></string-name>, <string-name name-style="western" hwp:sortable="Micsinai M"><surname>Micsinai</surname> <given-names>M</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kluger Y."><surname>Kluger</surname> <given-names>Y.</given-names></string-name> <article-title hwp:id="article-title-9">TrAp: a tree approach for fingerprinting subclonal tumor composition</article-title>. <source hwp:id="source-8">Nucleic Acids Research.</source> <year>2013</year>;<volume>41</volume>(<issue>17</issue>):<fpage>e165</fpage>–<lpage>e165</lpage>.</citation></ref><ref id="c9" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1 xref-ref-9-2 xref-ref-9-3"><label>9.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.9" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Qiao Y"><surname>Qiao</surname> <given-names>Y</given-names></string-name>, <string-name name-style="western" hwp:sortable="Quinlan AR"><surname>Quinlan</surname> <given-names>AR</given-names></string-name>, <string-name name-style="western" hwp:sortable="Jazaeri AA"><surname>Jazaeri</surname> <given-names>AA</given-names></string-name>, <string-name name-style="western" hwp:sortable="Verhaak RG"><surname>Verhaak</surname> <given-names>RG</given-names></string-name>, <string-name name-style="western" hwp:sortable="Wheeler DA"><surname>Wheeler</surname> <given-names>DA</given-names></string-name>, <string-name name-style="western" hwp:sortable="Marth GT"><surname>Marth</surname> <given-names>GT</given-names></string-name>. <article-title hwp:id="article-title-10">SubcloneSeeker: a computational framework for reconstructing tumor clone structure for cancer variant interpretation and prioritization</article-title>. <source hwp:id="source-9">Genome Biol.</source> <year>2014</year>;<volume>15</volume>:<fpage>443</fpage>.</citation></ref><ref id="c10" hwp:id="ref-10" hwp:rev-id="xref-ref-10-1"><label>10.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="Navin N"><surname>Navin</surname> <given-names>N</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kendall J"><surname>Kendall</surname> <given-names>J</given-names></string-name>, <string-name name-style="western" hwp:sortable="Troge J"><surname>Troge</surname> <given-names>J</given-names></string-name>, <string-name name-style="western" hwp:sortable="Andrews P"><surname>Andrews</surname> <given-names>P</given-names></string-name>, <string-name name-style="western" hwp:sortable="Rodgers L"><surname>Rodgers</surname> <given-names>L</given-names></string-name>, <string-name name-style="western" hwp:sortable="McIndoo J"><surname>McIndoo</surname> <given-names>J</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-11">Tumour evolution inferred by single-cell sequencing</article-title>. <source hwp:id="source-10">Nature.</source> <year>2011</year>;<volume>472</volume>(<issue>7341</issue>):<fpage>90</fpage>–<lpage>94</lpage>.</citation></ref><ref id="c11" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1"><label>11.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.11" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="Barber LJ"><surname>Barber</surname> <given-names>LJ</given-names></string-name>, <string-name name-style="western" hwp:sortable="Davies MN"><surname>Davies</surname> <given-names>MN</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gerlinger M."><surname>Gerlinger</surname> <given-names>M.</given-names></string-name> <article-title hwp:id="article-title-12">Dissecting cancer evolution at the macro-heterogeneity and micro-heterogeneity scale</article-title>. <source hwp:id="source-11">Current Opinion in Genetics and Development.</source> <year>2015</year>;<volume>30</volume>(<issue>0</issue>):<fpage>1</fpage>–<lpage>6</lpage>.</citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1 xref-ref-12-2 xref-ref-12-3 xref-ref-12-4 xref-ref-12-5 xref-ref-12-6 xref-ref-12-7 xref-ref-12-8 xref-ref-12-9 xref-ref-12-10 xref-ref-12-11 xref-ref-12-12 xref-ref-12-13"><label>12.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.12" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Ding L"><surname>Ding</surname> <given-names>L</given-names></string-name>, <string-name name-style="western" hwp:sortable="Ley TJ"><surname>Ley</surname> <given-names>TJ</given-names></string-name>, <string-name name-style="western" hwp:sortable="Larson DE"><surname>Larson</surname> <given-names>DE</given-names></string-name>, <string-name name-style="western" hwp:sortable="Miller CA"><surname>Miller</surname> <given-names>CA</given-names></string-name>, <string-name name-style="western" hwp:sortable="Koboldt DC"><surname>Koboldt</surname> <given-names>DC</given-names></string-name>, <string-name name-style="western" hwp:sortable="Welch JS"><surname>Welch</surname> <given-names>JS</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-13">Clonal evolution in relapsed acute myeloid leukaemia revealed by whole-genome sequencing</article-title>. <source hwp:id="source-12">Nature.</source> <year>2012</year>;<volume>481</volume>(<issue>7382</issue>):<fpage>506</fpage>–<lpage>510</lpage>.</citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1 xref-ref-13-2 xref-ref-13-3 xref-ref-13-4 xref-ref-13-5 xref-ref-13-6 xref-ref-13-7 xref-ref-13-8 xref-ref-13-9 xref-ref-13-10 xref-ref-13-11 xref-ref-13-12"><label>13.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.13" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="McFadden DG"><surname>McFadden</surname> <given-names>DG</given-names></string-name>, <string-name name-style="western" hwp:sortable="Papagiannakopoulos T"><surname>Papagiannakopoulos</surname> <given-names>T</given-names></string-name>, <string-name name-style="western" hwp:sortable="Taylor-Weiner A"><surname>Taylor-Weiner</surname> <given-names>A</given-names></string-name>, <string-name name-style="western" hwp:sortable="Stewart C"><surname>Stewart</surname> <given-names>C</given-names></string-name>, <string-name name-style="western" hwp:sortable="Carter SL"><surname>Carter</surname> <given-names>SL</given-names></string-name>, <string-name name-style="western" hwp:sortable="Cibulskis K"><surname>Cibulskis</surname> <given-names>K</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-14">Genetic and clonal dissection of murine small cell lung carcinoma progression by genome sequencing</article-title>. <source hwp:id="source-13">Cell.</source> <year>2014</year>;<volume>156</volume>(<issue>6</issue>):<fpage>1298</fpage>–<lpage>1311</lpage>.</citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1 xref-ref-14-2 xref-ref-14-3 xref-ref-14-4 xref-ref-14-5 xref-ref-14-6 xref-ref-14-7 xref-ref-14-8"><label>14.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.14" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Schuh A"><surname>Schuh</surname> <given-names>A</given-names></string-name>, <string-name name-style="western" hwp:sortable="Becq J"><surname>Becq</surname> <given-names>J</given-names></string-name>, <string-name name-style="western" hwp:sortable="Humphray S"><surname>Humphray</surname> <given-names>S</given-names></string-name>, <string-name name-style="western" hwp:sortable="Alexa A"><surname>Alexa</surname> <given-names>A</given-names></string-name>, <string-name name-style="western" hwp:sortable="Burns A"><surname>Burns</surname> <given-names>A</given-names></string-name>, <string-name name-style="western" hwp:sortable="Clifford R"><surname>Clifford</surname> <given-names>R</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-15">Monitoring chronic lymphocytic leukemia progression by whole genome sequencing reveals heterogeneous clonal evolution patterns</article-title>. <source hwp:id="source-14">Blood.</source> <year>2012</year>;<volume>120</volume>(<issue>20</issue>):<fpage>4191</fpage>–<lpage>4196</lpage>.</citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1 xref-ref-15-2"><label>15.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.15" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Roth A"><surname>Roth</surname> <given-names>A</given-names></string-name>, <string-name name-style="western" hwp:sortable="Khattra J"><surname>Khattra</surname> <given-names>J</given-names></string-name>, <string-name name-style="western" hwp:sortable="Yap D"><surname>Yap</surname> <given-names>D</given-names></string-name>, <string-name name-style="western" hwp:sortable="Wan A"><surname>Wan</surname> <given-names>A</given-names></string-name>, <string-name name-style="western" hwp:sortable="Laks E"><surname>Laks</surname> <given-names>E</given-names></string-name>, <string-name name-style="western" hwp:sortable="Biele J"><surname>Biele</surname> <given-names>J</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-16">PyClone: statistical inference of clonal population structure in cancer</article-title>. <source hwp:id="source-15">Nature Methods. 2014</source>;.</citation></ref><ref id="c16" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1 xref-ref-16-2"><label>16.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.16" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Miller CA"><surname>Miller</surname> <given-names>CA</given-names></string-name>, <string-name name-style="western" hwp:sortable="White BS"><surname>White</surname> <given-names>BS</given-names></string-name>, <string-name name-style="western" hwp:sortable="Dees ND"><surname>Dees</surname> <given-names>ND</given-names></string-name>, <string-name name-style="western" hwp:sortable="Griffith M"><surname>Griffith</surname> <given-names>M</given-names></string-name>, <string-name name-style="western" hwp:sortable="Welch JS"><surname>Welch</surname> <given-names>JS</given-names></string-name>, <string-name name-style="western" hwp:sortable="Griffith OL"><surname>Griffith</surname> <given-names>OL</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-17">SciClone: Inferring clonal architecture and tracking the spatial and temporal patterns of tumor evolution</article-title>. <source hwp:id="source-16">PLoS Computational Biology.</source> <year>2014</year>;<volume>10</volume>(<issue>8</issue>):<fpage>e1003665</fpage>.</citation></ref><ref id="c17" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1"><label>17.</label><citation publication-type="other" citation-type="journal" ref:id="011833v3.17" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="Fraley C"><surname>Fraley</surname> <given-names>C</given-names></string-name>, <string-name name-style="western" hwp:sortable="Raftery AE"><surname>Raftery</surname> <given-names>AE</given-names></string-name>. <article-title hwp:id="article-title-18">MCLUST version 3: an R package for normal mixture modeling and model-based clustering</article-title>. <source hwp:id="source-17">DTIC Document; 2006.</source></citation></ref><ref id="c18" hwp:id="ref-18" hwp:rev-id="xref-ref-18-1"><label>18.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.18" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-18"><string-name name-style="western" hwp:sortable="Cayley A."><surname>Cayley</surname> <given-names>A.</given-names></string-name> <article-title hwp:id="article-title-19">A theorem on trees</article-title>. <source hwp:id="source-18">Quart J Math.</source> <year>1889</year>;<volume>23</volume>(<issue>376-378</issue>):<fpage>69</fpage>.</citation></ref><ref id="c19" hwp:id="ref-19" hwp:rev-id="xref-ref-19-1"><label>19.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.19" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-19"><string-name name-style="western" hwp:sortable="Glover F."><surname>Glover</surname> <given-names>F.</given-names></string-name> <article-title hwp:id="article-title-20">Tabu search-Part I</article-title>. <source hwp:id="source-19">ORSA Journal on Computing.</source> <year>1989</year>;<volume>1</volume>(<issue>3</issue>):<fpage>190</fpage>–<lpage>206</lpage>.</citation></ref><ref id="c20" hwp:id="ref-20" hwp:rev-id="xref-ref-20-1"><label>20.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.20" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-20"><string-name name-style="western" hwp:sortable="Glover F."><surname>Glover</surname> <given-names>F.</given-names></string-name> <article-title hwp:id="article-title-21">Tabu search-Part II</article-title>. <source hwp:id="source-20">ORSA Journal on Computing.</source> <year>1990</year>;<volume>2</volume>(<issue>1</issue>):<fpage>4</fpage>–<lpage>32</lpage>.</citation></ref><ref id="c21" hwp:id="ref-21" hwp:rev-id="xref-ref-21-1"><label>21.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.21" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-21"><string-name name-style="western" hwp:sortable="Kirkpatrick S"><surname>Kirkpatrick</surname> <given-names>S</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gelatt CD"><surname>Gelatt</surname> <given-names>CD</given-names></string-name>, <string-name name-style="western" hwp:sortable="Vecchi MP"><surname>Vecchi</surname> <given-names>MP</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-22">Optimization by simmulated annealing</article-title>. <source hwp:id="source-21">Science.</source> <year>1983</year>;<volume>220</volume>(<issue>4598</issue>):<fpage>671</fpage>–<lpage>680</lpage>.</citation></ref><ref id="c22" hwp:id="ref-22" hwp:rev-id="xref-ref-22-1"><label>22.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.22" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-22"><string-name name-style="western" hwp:sortable="Cerny V."><surname>Cerny</surname> <given-names>V.</given-names></string-name> <article-title hwp:id="article-title-23">Thermodynamical approach to the traveling salesman problem: An efficient simulation algorithm</article-title>. <source hwp:id="source-22">Journal of optimization theory and applications.</source> <year>1985</year>;<volume>45</volume>(<issue>1</issue>):<fpage>41</fpage>–<lpage>51</lpage>.</citation></ref><ref id="c23" hwp:id="ref-23" hwp:rev-id="xref-ref-23-1"><label>23.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.23" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-23"><string-name name-style="western" hwp:sortable="Lourenco HR"><surname>Lourenco</surname> <given-names>HR</given-names></string-name>, <string-name name-style="western" hwp:sortable="Martin OC"><surname>Martin</surname> <given-names>OC</given-names></string-name>, <string-name name-style="western" hwp:sortable="Stutzle T."><surname>Stutzle</surname> <given-names>T.</given-names></string-name> <article-title hwp:id="article-title-24">Iterated local search: Framework and applications. In: Handbook of Metaheuristics</article-title>. <source hwp:id="source-23">Springer</source>; <year>2010</year>. p. <fpage>363</fpage>–<lpage>397</lpage>.</citation></ref><ref id="c24" hwp:id="ref-24" hwp:rev-id="xref-ref-24-1"><label>24.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.24" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-24"><string-name name-style="western" hwp:sortable="Barlow RE"><surname>Barlow</surname> <given-names>RE</given-names></string-name>, <string-name name-style="western" hwp:sortable="Bartholomew DJ"><surname>Bartholomew</surname> <given-names>DJ</given-names></string-name>, <string-name name-style="western" hwp:sortable="Bremner JM"><surname>Bremner</surname> <given-names>JM</given-names></string-name>, <string-name name-style="western" hwp:sortable="Brunk HD"><surname>Brunk</surname> <given-names>HD</given-names></string-name>. <article-title hwp:id="article-title-25">Statistical Inference under Order Restrictions</article-title>. <source hwp:id="source-24">John Wiley</source>; <year>1972</year>.</citation></ref><ref id="c25" hwp:id="ref-25" hwp:rev-id="xref-ref-25-1"><label>25.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.25" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-25"><string-name name-style="western" hwp:sortable="Miller BL"><surname>Miller</surname> <given-names>BL</given-names></string-name>, <string-name name-style="western" hwp:sortable="Goldberg DE"><surname>Goldberg</surname> <given-names>DE</given-names></string-name>. <article-title hwp:id="article-title-26">Genetic algorithms, selection schemes, and the varying effects of noise</article-title>. <source hwp:id="source-25">Evolutionary Computation.</source> <year>1996</year>;<volume>4</volume>(<issue>2</issue>):<fpage>113</fpage>–<lpage>131</lpage>.</citation></ref><ref id="c26" hwp:id="ref-26" hwp:rev-id="xref-ref-26-1"><label>26.</label><citation publication-type="journal" citation-type="journal" ref:id="011833v3.26" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-26"><string-name name-style="western" hwp:sortable="Ghahramani Z"><surname>Ghahramani</surname> <given-names>Z</given-names></string-name>, <string-name name-style="western" hwp:sortable="Jordan MI"><surname>Jordan</surname> <given-names>MI</given-names></string-name>, <string-name name-style="western" hwp:sortable="Adams RP"><surname>Adams</surname> <given-names>RP</given-names></string-name> <source hwp:id="source-26">Tree-structured stick breaking for hierarchical data Advances in Neural Information Processing Systems.</source> <year>2010</year>;<fpage>19</fpage>–<lpage>27</lpage>.</citation></ref></ref-list></back></article>
