<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/038463</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;038463v3</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;038463</article-id><article-id pub-id-type="other" hwp:sub-type="slug">038463</article-id><article-id pub-id-type="other" hwp:sub-type="tag">038463</article-id><article-version>1.3</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Genomics" hwp:journal="biorxiv"><subject>Genomics</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">Sequence element enrichment analysis to determine the genetic basis of bacterial phenotypes</article-title></title-group><author-notes hwp:id="author-notes-1"><fn id="n1" fn-type="equal" hwp:id="fn-1" hwp:rev-id="xref-fn-1-1 xref-fn-1-2"><label>†</label><p hwp:id="p-1">These authors contributed equally.</p></fn><corresp id="cor1" hwp:id="corresp-1" hwp:rev-id="xref-corresp-1-1"><label>*</label> Corresponding author: <email hwp:id="email-1">jukka.corander@helsinki.fi</email></corresp></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-5360-1254</contrib-id><name name-style="western" hwp:sortable="Lees John A."><surname>Lees</surname><given-names>John A.</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">1</xref><xref ref-type="author-notes" rid="n1" hwp:id="xref-fn-1-1" hwp:rel-id="fn-1">†</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0001-5360-1254"/></contrib><contrib contrib-type="author" hwp:id="contrib-2"><name name-style="western" hwp:sortable="Vehkala Minna"><surname>Vehkala</surname><given-names>Minna</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-1" hwp:rel-id="aff-2">2</xref><xref ref-type="author-notes" rid="n1" hwp:id="xref-fn-1-2" hwp:rel-id="fn-1">†</xref></contrib><contrib contrib-type="author" hwp:id="contrib-3"><name name-style="western" hwp:sortable="Välimäki Niko"><surname>Välimäki</surname><given-names>Niko</given-names></name><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-1" hwp:rel-id="aff-3">3</xref></contrib><contrib contrib-type="author" hwp:id="contrib-4"><name name-style="western" hwp:sortable="Harris Simon R."><surname>Harris</surname><given-names>Simon R.</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-5"><name name-style="western" hwp:sortable="Chewapreecha Claire"><surname>Chewapreecha</surname><given-names>Claire</given-names></name><xref ref-type="aff" rid="a4" hwp:id="xref-aff-4-1" hwp:rel-id="aff-4">4</xref></contrib><contrib contrib-type="author" hwp:id="contrib-6"><name name-style="western" hwp:sortable="Croucher Nicholas J."><surname>Croucher</surname><given-names>Nicholas J.</given-names></name><xref ref-type="aff" rid="a5" hwp:id="xref-aff-5-1" hwp:rel-id="aff-5">5</xref></contrib><contrib contrib-type="author" hwp:id="contrib-7"><name name-style="western" hwp:sortable="Marttinen Pekka"><surname>Marttinen</surname><given-names>Pekka</given-names></name><xref ref-type="aff" rid="a6" hwp:id="xref-aff-6-1" hwp:rel-id="aff-6">6</xref><xref ref-type="aff" rid="a7" hwp:id="xref-aff-7-1" hwp:rel-id="aff-7">7</xref></contrib><contrib contrib-type="author" hwp:id="contrib-8"><name name-style="western" hwp:sortable="Davies Mark R."><surname>Davies</surname><given-names>Mark R.</given-names></name><xref ref-type="aff" rid="a8" hwp:id="xref-aff-8-1" hwp:rel-id="aff-8">8</xref></contrib><contrib contrib-type="author" hwp:id="contrib-9"><name name-style="western" hwp:sortable="Steer Andrew C."><surname>Steer</surname><given-names>Andrew C.</given-names></name><xref ref-type="aff" rid="a9" hwp:id="xref-aff-9-1" hwp:rel-id="aff-9">9</xref><xref ref-type="aff" rid="a10" hwp:id="xref-aff-10-1" hwp:rel-id="aff-10">10</xref></contrib><contrib contrib-type="author" hwp:id="contrib-10"><name name-style="western" hwp:sortable="Tong Stephen Y. C."><surname>Tong</surname><given-names>Stephen Y. C.</given-names></name><xref ref-type="aff" rid="a11" hwp:id="xref-aff-11-1" hwp:rel-id="aff-11">11</xref></contrib><contrib contrib-type="author" hwp:id="contrib-11"><name name-style="western" hwp:sortable="Honkela Antti"><surname>Honkela</surname><given-names>Antti</given-names></name><xref ref-type="aff" rid="a12" hwp:id="xref-aff-12-1" hwp:rel-id="aff-12">12</xref></contrib><contrib contrib-type="author" hwp:id="contrib-12"><name name-style="western" hwp:sortable="Parkhill Julian"><surname>Parkhill</surname><given-names>Julian</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-3" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-13"><name name-style="western" hwp:sortable="Bentley Stephen D."><surname>Bentley</surname><given-names>Stephen D.</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-4" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" corresp="yes" hwp:id="contrib-14"><name name-style="western" hwp:sortable="Corander Jukka"><surname>Corander</surname><given-names>Jukka</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-2" hwp:rel-id="aff-2">2</xref><xref ref-type="corresp" rid="cor1" hwp:id="xref-corresp-1-1" hwp:rel-id="corresp-1">*</xref></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2 xref-aff-1-3 xref-aff-1-4"><label>1</label><institution hwp:id="institution-1">Pathogen Genomics, Wellcome Trust Sanger Institute</institution>, Cambridge, <country>UK</country></aff><aff id="a2" hwp:id="aff-2" hwp:rev-id="xref-aff-2-1 xref-aff-2-2"><label>2</label><institution hwp:id="institution-2">Department of Mathematics and Statistics, University of Helsinki</institution>, Helsinki, <country>Finland</country></aff><aff id="a3" hwp:id="aff-3" hwp:rev-id="xref-aff-3-1"><label>3</label><institution hwp:id="institution-3">Department of Medical and Clinical Genetics, Genome-Scale Biology Research Program, University of Helsinki</institution></aff><aff id="a4" hwp:id="aff-4" hwp:rev-id="xref-aff-4-1"><label>4</label><institution hwp:id="institution-4">Department of Medicine, University of Cambridge</institution>, Cambridge, <country>UK</country></aff><aff id="a5" hwp:id="aff-5" hwp:rev-id="xref-aff-5-1"><label>5</label><institution hwp:id="institution-5">Department of Infectious Disease Epidemiology, Imperial College</institution>, London, <country>UK</country></aff><aff id="a6" hwp:id="aff-6" hwp:rev-id="xref-aff-6-1"><label>6</label><institution hwp:id="institution-6">Department of Computer Science, Aalto University</institution>, Espoo, <country>Finland</country></aff><aff id="a7" hwp:id="aff-7" hwp:rev-id="xref-aff-7-1"><label>7</label><institution hwp:id="institution-7">Helsinki Institute of Information Technology HIIT, Department of Computer Science, Aalto University</institution>, Espoo, <country>Finland</country></aff><aff id="a8" hwp:id="aff-8" hwp:rev-id="xref-aff-8-1"><label>8</label><institution hwp:id="institution-8">Department of Microbiology and Immunology, Peter Doherty Institute for Infection and Immunity, University of Melbourne</institution>, <country>Australia</country></aff><aff id="a9" hwp:id="aff-9" hwp:rev-id="xref-aff-9-1"><label>9</label><institution hwp:id="institution-9">Centre for International Child Health, Department of Paediatrics, University of Melbourne</institution>, <country>Australia</country></aff><aff id="a10" hwp:id="aff-10" hwp:rev-id="xref-aff-10-1"><label>10</label><institution hwp:id="institution-10">Group A Streptococcal Research Group, Murdoch Children’s Research Institute</institution></aff><aff id="a11" hwp:id="aff-11" hwp:rev-id="xref-aff-11-1"><label>11</label><institution hwp:id="institution-11">Menzies School of Health Research</institution>, Darwin, <country>Australia</country></aff><aff id="a12" hwp:id="aff-12" hwp:rev-id="xref-aff-12-1"><label>12</label><institution hwp:id="institution-12">Helsinki Institute for Information Technology HIIT, Department of Computer Science, University of Helsinki</institution>, Helsinki, <country>Finland</country></aff></contrib-group><pub-date pub-type="epub-original" hwp:start="2016"><year>2016</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2016-02-01T23:21:13-08:00">
    <day>1</day><month>2</month><year>2016</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2016-03-02T08:51:21-08:00">
    <day>2</day><month>3</month><year>2016</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2016-02-02T00:26:09-08:00">
    <day>2</day><month>2</month><year>2016</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2016-03-02T10:11:00-08:00">
    <day>2</day><month>3</month><year>2016</year>
  </pub-date><elocation-id>038463</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2016-02-01"><day>01</day><month>2</month><year>2016</year></date>
<date date-type="accepted" hwp:start="2016-03-02"><day>02</day><month>3</month><year>2016</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2016, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2016</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/" hwp:id="license-1"><p hwp:id="p-2">This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" hwp:id="ext-link-1">http://creativecommons.org/licenses/by/4.0/</ext-link></p></license></permissions><self-uri xlink:href="038463.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2019/pdf/038463v3.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="038463.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2019/abstracts/038463v3/038463v3.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2019/fulltext/038463v3/038463v3.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><p hwp:id="p-3">Bacterial genomes vary extensively in terms of both gene content and gene sequence – this plasticity hampers the use of traditional SNP-based methods for identifying all genetic associations with phenotypic variation. Here we introduce a computationally scalable and widely applicable statistical method (SEER) for the identification of sequence elements that are significantly enriched in a phenotype of interest. SEER is applicable to even tens of thousands of genomes by counting variable-length k-mers using a distributed string-mining algorithm. Robust options are provided for association analysis that also correct for the clonal population structure of bacteria. Using large collections of genomes of the major human pathogens <italic toggle="yes">Streptococcus pneumoniae</italic> and <italic toggle="yes">Streptococcus pyogenes</italic>, SEER identifies relevant previously characterised resistance determinants for several antibiotics and discovers potential novel factors related to the invasiveness of <italic toggle="yes">S. pyogenes</italic>. We thus demonstrate that our method can answer important biologically and medically relevant questions.</p></abstract><counts><page-count count="35"/></counts><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-1">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta></front><body><sec id="s1" hwp:id="sec-1"><title hwp:id="title-2">Introduction</title><p hwp:id="p-4">The rapidly expanding repositories of genomic data for bacteria hold an enormous and yet largely untapped potential for building a more detailed understanding of the evolutionary responses to changing environmental conditions, such as the widespread use of antibiotics and switches between host-niche as farming practices change.</p><p hwp:id="p-5">Genome-wide association studies (GWAS) for bacterial phenotypes have only recently started to appear<sup><xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">1</xref>-<xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-1" hwp:rel-id="ref-5">5</xref></sup>. Use of standard GWAS methods developed originally for human SNP data have been shown to be successfully applicable to core genome mutations in bacteria<sup><xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">2</xref>, <xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-1" hwp:rel-id="ref-3">3</xref></sup>. However, given the high level of genome plasticity of many of the known bacterial species, we can anticipate that such methods can only partially identify genetic determinants of phenotypic variation. To enable discovery of mechanisms related for instance to gene content, alternative alignment-free methods have also been introduced<sup><xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-2" hwp:rel-id="ref-1">1</xref>, <xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">4</xref></sup>. These methods use k-mers, i.e. DNA words of length k, as generalized alternatives to SNPs as putative explanations for observed differences in phenotype distributions. The main advantage of k-mers is their ability to capture several different types of variation present across a collection of genomes, including mutations, recombinations, variable promoter architecture, differences in gene content as well as capturing these variations in regions not present in all genomes.</p><p hwp:id="p-6">The previous study using k-mers to overcome limitations of SNP-based association used Monte-Carlo simulations of word gain and loss along an inferred phylogeny to control for population structure<sup><xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-3" hwp:rel-id="ref-1">1</xref></sup>, whereas SNP-based studies have used clustering algorithms on a core alignment and stratified association tests on the resulting groups of samples<sup><xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-2" hwp:rel-id="ref-2">2</xref>, <xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-2" hwp:rel-id="ref-3">3</xref></sup>. The former does not scale computationally to the hundreds of isolates required to find lower effect-size associations, and the latter requires a core alignment, which lacks sensitivity and difficult to produce when there is a large number of samples, or they are particularly diverse.</p><p hwp:id="p-7">Here we present a sequence element enrichment analysis (SEER), a method computationally scalable to tens of thousands of genomes, implemented as a stand-alone pipeline that uses either <italic toggle="yes">de novo</italic> assembled contigs or raw read data as input. We apply SEER to both simulated and real data from large and diverse populations, and show that it can accurately detect associations with antibiotic resistance caused by both presence of a gene and by SNPs in coding regions, as well as discover novel invasiveness factors.</p></sec><sec id="s2" hwp:id="sec-2"><title hwp:id="title-3">Results</title><sec id="s2a" hwp:id="sec-3"><title hwp:id="title-4">Implementation</title><p hwp:id="p-8">SEER implements and combines three key insights which we discuss in turn: an efficient scan of all possible k-mers with a distributed string mining algorithm, an appropriate alignment-free correction for clonal population structure, and a fast and fully robust association analysis of all counted k-mers.</p><p hwp:id="p-9">K-mers allow simultaneous discovery of both short genetic variants and entire genes associated with a phenotype. Longer k-mers provide higher specificity but less sensitivity than shorter k-mers. Rather than arbitrarily selecting a length prior to analysis or having to count k-mers at multiple lengths and combine the results, we provide an efficient implementation that allows counting and testing simultaneously at all k-mers at lengths over 9 bases long.</p><p hwp:id="p-10">We offer three different methods to count k-mers in all samples in a study. For very large studies, or for counting directly from reads rather than assemblies, we provide an implementation of distributed string mining (DSM)<sup><xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-1" hwp:rel-id="ref-6">6</xref>, <xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">7</xref></sup> which limits maximum memory usage per core, but requires a large cluster to run. For data sets up to around 5 000 sample assemblies we have implemented a single core version fsm-lite (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/nvalimak/fsm-lite" ext-link-type="uri" xlink:href="https://github.com/nvalimak/fsm-lite" hwp:id="ext-link-2">https://github.com/nvalimak/fsm-lite</ext-link>). For comparison with older datasets, or where resources do not allow the storage of the entire k-mer index in memory, DSK<sup><xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-1" hwp:rel-id="ref-8">8</xref></sup> is used to count a single k-mer length in each sample individually, the results of which are then combined.</p><p hwp:id="p-11">To correct for the clonal population structure of bacterial populations, a distance matrix is constructed from a random subsample of these k-mers, on which multidimensional scaling is performed (<xref ref-type="fig" rid="figS1" hwp:id="xref-fig-3-1" hwp:rel-id="F3">Supplementary figure 1</xref>). Compared with modelling SNP variation<sup><xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">9</xref></sup>, use of k-mers as variable sequence elements has been previously shown to accurately estimate bacterial population structure. The projections of each sample in three dimensions are used as covariates to control for the clonal population structure. Simulations of bacterial genomes using a known tree showed this method gave a higher resolution control than using only population clustering (<xref ref-type="fig" rid="figS2" hwp:id="xref-fig-4-1" hwp:rel-id="F4">Supplementary figure 2</xref>). Before testing for association we filter k-mers based on their frequency and unadjusted p-value to reduce false positives from testing underpowered k-mers and reduce computational time.</p><p hwp:id="p-12">Then, for each k-mer, a logistic curve is fitted to binary phenotype data, and a linear model to continuous data, using a time efficient optimisation routine to allow testing of all k-mers. Bacteria can be subject to extremely strong selection pressures, producing common variants with very large effect sizes, such as antibiotics inducing resistance-conferring variants. This can make the data perfectly separable, and consequently the maximum likelihood estimate ceases to exist for the logistic model. Firth regression<sup><xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-1" hwp:rel-id="ref-10">10</xref></sup> has been used to obtain results in these cases.</p><p hwp:id="p-13">For the basal cut-off for significance we use <italic toggle="yes">p</italic> &lt; 0.05, which in our testing we conservatively Bonferroni corrected to the threshold 1x10<sup>-8</sup> based on every position in the S. pneumoniae genome having three possible mutations<sup><xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">11</xref></sup>, and all this variation being uncorrelated. This is a strict cut-off level that prevents a large number of false-positives due to the extensive amount of k-mers being tested, but does not over-penalise by correcting directly on the basis of the number of k-mers counted. Simulations suggested a cut-off of 1.4x10<sup>-8</sup> would be appropriate, supporting this reasoning. Association effect size and p-value of the MDS components can also be included in the output, to compare lineage and variant effects on the phenotype variation.</p><p hwp:id="p-14">K-mers reaching significance are filtered post-association and mapped onto both a well-annotated reference sequence and the annotated draft assemblies to allow discovery of variation in accessory genes not present in the reference strain. The significant k-mers themselves can also be assembled into a longer consensus sequence. Annotating variants by predicted function and effect (against a reference sequence) in the resulting k-mers facilitates fine-mapping of SNPs and small indels.</p><p hwp:id="p-15">Meta-analysis of association studies increases sample size, which improves power and reduces false-positive rates<sup><xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">12</xref></sup>. To facilitate meta-analysis of k-mers across studies, the output of SEER includes effect size, direction and standard error, which can be used directly with existing software to meta-analyse all overlapping k-mers.</p><p hwp:id="p-16">SEER is implemented in C++, and available at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/johnlees/seer" ext-link-type="uri" xlink:href="https://github.com/johnlees/seer" hwp:id="ext-link-3">https://github.com/johnlees/seer</ext-link> as source code and a pre-compiled binary.</p></sec><sec id="s2b" hwp:id="sec-4"><title hwp:id="title-5">Application to simulated data</title><p hwp:id="p-17">To test the power of SEER across different sample sizes, we simulated 3 069 <italic toggle="yes">Streptococcus pneumoniae</italic> genomes from the phylogeny observed in a Thai refugee camp<sup><xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">13</xref></sup> using parameters estimated from real data including accumulation of SNPs, indels (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-5-1" hwp:rel-id="F5">Supplementary figure 3</xref>), gene loss and recombination events. Using knowledge of the true alignments, we then artificially associated an accessory gene with a phenotype over a range of odds-ratios and evaluated power at different sample sizes (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Fig. 1a</xref>). The expected pattern for this power calculation is seen, with higher odds-ratio effects being easier to detect. Currently detected associations in bacteria have had large effect sizes (OR &gt; 28 host-specificity<sup><xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-4" hwp:rel-id="ref-1">1</xref></sup>, OR &gt; 3 beta-lactam resistance<sup><xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-3" hwp:rel-id="ref-2">2</xref></sup>), and the required sample sizes predicted here are consistent with these discoveries.</p><fig id="fig1" position="float" orientation="portrait" fig-type="figure" hwp:id="F1" hwp:rev-id="xref-fig-1-1 xref-fig-1-2 xref-fig-1-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;038463v3/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Fig. 1:</label><caption hwp:id="caption-1"><p hwp:id="p-18">Using simulations and subsamples of the population as described in the online methods, power for a) detecting gene presence/absence at different oddsratios b) using all informative k-mers versus a single length c) detecting k-mers near, in the correct gene, or containing the causal variant for trimethoprim resistance. All curves are logistic fits to the mean power over 100 subsamples.</p></caption><graphic xlink:href="038463_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig><p hwp:id="p-19">The large k-mer diversity, along with the population stratification of gene loss, makes the simulated estimate of the sample size required to reach the stated power clearly conservative. Convergent evolution along multiple branches of a phylogeny for a real population reacting to selection pressures will reduce the required sample size<sup><xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">14</xref></sup>.</p><p hwp:id="p-20">We also used k-mers counted at constant lengths by DSK to perform the gene presence/absence association (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-2" hwp:rel-id="F1">Fig. 1b</xref>). Counting all informative k-mers rather than a range of pre-defined k-mer lengths gives greater power to detect associations, with 80% power being reached at around 1 500 samples, compared with 2 000 samples required by the pre-defined lengths. The slightly lower power at low sample numbers is due to a stricter Bonferroni adjustment being applied to the larger number of DSM k-mers over the DSK k-mers. This is exactly the expected advantage from including shorter k-mers to increase sensitivity, but as k-mers are correlated with each other due to evolving along the same phylogeny, using the same Bonferroni correction for multiple testing does not decrease specificity.</p><p hwp:id="p-21">The strong linkage disequilibrium (LD) caused by the clonal reproduction of bacterial populations means that non-causal k-mers may also appear to be associated. This is well documented in human genetics; non-causal variants tag the causal variant increasing discovery power, but make it more difficult to fine-map the true link between genotype and phenotype<sup><xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">15</xref></sup>. In simulations it is difficult to replicate the LD patterns observed in real populations, as recombination maps for specific bacterial lineages are not yet known. To evaluate fine-mapping power of a SNP we instead used the real sequence data and simulated phenotypes based on changing the effect size of a known causal variant and evaluating the physical distance of significant k-mers from the variant site.</p><p hwp:id="p-22">Using DSM we counted 68M k-mers which we then tested for association. The 2 639 significant k-mers were placed into three categories if after mapping to a reference genome they contained the causal variant I100L (10), were within the same gene (74), or within 2.5kb in either direction (207). <xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-3" hwp:rel-id="F1">Figure 1c</xref>) shows the resulting power when random subsamples of the population are taken. As expected, power is higher when not specifying that the causal variant must be hit, as there are many more k-mers which are in LD with the SNP than directly overlapping it, thus increasing sensitivity.</p></sec><sec id="s2c" hwp:id="sec-5"><title hwp:id="title-6">Confirmation of known resistance mechanisms in a large population of <italic toggle="yes">S. pneumoniae</italic></title><p hwp:id="p-23">SEER was applied to the sequenced genomes from the study described above, using measured resistance to five different antibiotics as the phenotype: chloramphenicol, erythromycin, β-lactams, tetracycline and trimethoprim. Chloramphenicol resistance is conferred by the <italic toggle="yes">cat</italic> gene on the integrative conjugative element (ICE) Tn<italic toggle="yes">5253</italic> in the <italic toggle="yes">S. pneumoniae</italic> chromosome, and similarly tetracycline resistance is conferred by the <italic toggle="yes">tetM</italic> gene which is also carried on the ICE<sup><xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">16</xref></sup>. For both of these drug resistance phenotypes the ICE contains 99% of the significant k-mers, and the causal genes rank highly within the clusters (<xref ref-type="table" rid="tbl1" hwp:id="xref-table-wrap-1-1" hwp:rel-id="T1">Table 1</xref>, <xref ref-type="fig" rid="figS4" hwp:id="xref-fig-6-1" hwp:rel-id="F6">Supplementary figure 4</xref>).</p><table-wrap id="tbl1" orientation="portrait" position="float" hwp:id="T1" hwp:rev-id="xref-table-wrap-1-1 xref-table-wrap-1-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;038463v3/TBL1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T1</object-id><object-id pub-id-type="publisher-id">tbl1</object-id><label>Table 1:</label><caption hwp:id="caption-2"><p hwp:id="p-24">Results from SEER for antibiotic resistance binary outcome on a population of 3069 <italic toggle="yes">S. pneumoniae</italic>. Significant k-mers are first interpreted by mapping to the ATCC 700669 reference genome. Up to the first four highest covered annotations are shown, and if the known mechanism is amongst these it is highlighted in orange. The ICE is the top hit in three analyses, as it carries multiple drug-resistance elements and is commonly found in multi-drug resistant strains<sup><xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-2" hwp:rel-id="ref-16">16</xref></sup>. The distribution of phenotype across the phylogeny is shown in <xref ref-type="fig" rid="figS5" hwp:id="xref-fig-7-1" hwp:rel-id="F7">Supplementary figure 5</xref>.</p></caption><graphic xlink:href="038463_tbl1" position="float" orientation="portrait" hwp:id="graphic-2"/></table-wrap><p hwp:id="p-25">Resistance to erythromycin is also conferred by presence of a gene, but there are multiple genes that can perform the same function (<italic toggle="yes">ermB</italic>, <italic toggle="yes">mef</italic>, mel)<sup><xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">17</xref></sup>. In the population studied, this phenotype was strongly associated with two large lineages (<xref ref-type="fig" rid="figS5" hwp:id="xref-fig-7-2" hwp:rel-id="F7">Supplementary figure 5</xref>), making the task of disentangling association with a lineage versus a specific locus more difficult. Significant k-mers are found in the mega and omega cassettes, which carry the <italic toggle="yes">mel/mef</italic> and <italic toggle="yes">ermB</italic> resistance elements respectively. Some k-mers do not map to the reference, as they are due to lineage specific associations with genetic elements not found in the reference strain. This highlights both the need to map to a close reference or draft assembly to interpret hits, as well as the use of functional follow-up to validate potential hits from SEER.</p><p hwp:id="p-26">Multiple mechanisms of resistance to β-lactams are possible<sup><xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-4" hwp:rel-id="ref-2">2</xref></sup>. Here, we consider just the most important (i.e. highest effect size) mutations, which are SNPs in the penicillin binding proteins <italic toggle="yes">pbp2x, pbp2b</italic> and <italic toggle="yes">pbp1a</italic>. In this case looking at highest coverage annotations finds these genes, but is not sufficient as so many k-mers are significant – either due to other mechanisms of resistance, physical linkage with causal variants or co-selection for resistance conferring mutations. Instead, looking at the k-mers with the most significant p-values gives the top four hit loci as <italic toggle="yes">pbp2b</italic> (p=10<sup>-132</sup>), <italic toggle="yes">pbp2x</italic> (p=10<sup>-96</sup>), putative RNA pseudouridylate synthase UniParc B8ZPU5 (p=10<sup>-92</sup>) and <italic toggle="yes">pbp1a</italic> (p=10<sup>-89</sup>). The non-<italic toggle="yes">pbp</italic> hit is a homologue of a gene in linkage disequilibrium with <italic toggle="yes">pbp2b</italic>, which would suggest mismapping rather than causation of resistance.</p><p hwp:id="p-27">Trimethoprim resistance in <italic toggle="yes">S. pneumoniae</italic> is conferred by the SNP I100L in the <italic toggle="yes">folA/dyr</italic> gene<sup><xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-1" hwp:rel-id="ref-18">18</xref></sup>. The <italic toggle="yes">dpr</italic> and <italic toggle="yes">dyr</italic> genes, which are adjacent in the genome, have the highest coverage of significant k-mers (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-1" hwp:rel-id="F2">Fig. 2</xref>). Following our fine-mapping procedure, we call four high-confidence SNPs that are predicted to be more likely to affect protein function than synonymous SNPs. One is the causal SNP, and the others appear to be hitchhikers in LD with I100L. By evaluating whether sites are conserved across the protein family<sup><xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-1" hwp:rel-id="ref-19">19</xref></sup>, the known causal SNP is ranked as the highest variant, showing that in this case fine-mapping is possible using the output from SEER.</p><fig id="fig2" position="float" orientation="portrait" fig-type="figure" hwp:id="F2" hwp:rev-id="xref-fig-2-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;038463v3/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Fig. 2:</label><caption hwp:id="caption-3"><p hwp:id="p-28">Fine mapping trimethoprim resistance. The locus pictured contains 72 significant k-mers, the most of any gene cluster. Coverage over the locus is pictured at the bottom of the figure. Shown above the genes are high quality missense SNPs, plotted using their p-value for affecting protein function as predicted by SIFT.</p></caption><graphic xlink:href="038463_fig2" position="float" orientation="portrait" hwp:id="graphic-3"/></fig><p hwp:id="p-29">We then compared the results from SEER with the results from two existing methods (as described in online methods). The first method uses mapping of SNPs against a reference, followed by applying the Cochran-Mantel-Haenszel test at every variable site<sup><xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-5" hwp:rel-id="ref-2">2</xref></sup>. The second uses dsk<sup><xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-2" hwp:rel-id="ref-8">8</xref></sup> to count k-mers of length 31, and a highly robust correction for population structure which scales to around 100 genomes<sup><xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-5" hwp:rel-id="ref-1">1</xref></sup>.</p><p hwp:id="p-30">The results are shown in supplementary <xref ref-type="table" rid="tbl1" hwp:id="xref-table-wrap-1-2" hwp:rel-id="T1">table 1</xref>. Both SEER and association of a core mapping of SNPs identify resistances caused by presence of a gene, when it is present in the reference used for mapping. Both produce their most significant p-values in the causal element, though SEER appears to have a lower false-positive rate. However, as demonstrated by chloramphenicol resistance, if not enough SNP calls are made in the causal gene this hinders fine-mapping. SNP-mediated resistance showed the same pattern since many other SNPs were ranked above the causal variant. In the case of β-lactam resistance both methods seem to perform equally well, likely due to the higher rate of recombination and the creation of mosaic <italic toggle="yes">pbp</italic> genes.</p><p hwp:id="p-31">Additionally, as for erythromycin resistance, when an element is not present in the reference SNPs have been called against it is not detectable in SNP-based association analysis. In such cases multiple mappings against other reference genomes would have to be made, which is a tedious and computationally costly procedure. Alternatively a draft assembly with the phenotype from the study could be picked as a second reference to map to, however this may be lower quality than those in public databases picked by genetic content rather than phenotype, and would not necessarily be able to detect multiple genetic mechanisms (as in the case of erythromycin resistance, no single sequenced genome contains all known resistance mechanisms).</p><p hwp:id="p-32">Since the k-mer results from SEER are reference-free, these issues are avoided as just the significant k-mers can quickly be mapped to all available references. Alternatively, the significant k-mers can be mapped to all draft assemblies in the study, at least one of which is guaranteed to contain the k-mer, to check if any annotations are overlapped.</p><p hwp:id="p-33">For the small sample, 31mer approach significance was not reached for chloramphenicol, tetracycline or trimethoprim as the effect size of any k-mer is too small to be detected in the number of samples accessible by the method. Erythromycin had 19 307 hits, and β-lactams 419 hits, at between 1-2% MAF which are all false positives that would likely have been excluded by a fully robust population structure correction method.</p></sec><sec id="s2d" hwp:id="sec-6"><title hwp:id="title-7">Discovery of conjugative elements associated with <italic toggle="yes">Streptococcus pyogenes</italic> isolation location and invasiveness</title><p hwp:id="p-34">Most bacterial GWAS studies to date have searched for genotypic variants that contribute towards or completely explain antibiotic resistance phenotypes. As a proof of principle that SEER can be used for the discovery stage of sequence elements associated with other clinically important phenotypes, we applied our tool to 675 <italic toggle="yes">S. pyogenes</italic> (group A <italic toggle="yes">Streptococcus</italic>) genomes from invasive and non-invasive isolates.</p><p hwp:id="p-35">The top hit was the <italic toggle="yes">tetM</italic> gene in a conjugative transposon (Tn<italic toggle="yes">916</italic>) carried by 23% of isolates (<xref ref-type="fig" rid="figS6" hwp:id="xref-fig-8-1" hwp:rel-id="F8">Supplementary figures 6</xref> and <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-9-1" hwp:rel-id="F9">7</xref>). These elements are variably present in the chromosome of <italic toggle="yes">S. pyogenes<sup><xref ref-type="bibr" rid="c20" hwp:id="xref-ref-20-1" hwp:rel-id="ref-20">20</xref></sup></italic>, and the lack of co-segregation with population structure explains our power to discover the association. However, as a different proportion of the isolates from each collection were invasive (Fiji - 13%; Kilif - 43%), the significant k-mers will also include elements specific to Kilifi. Indeed, we found that this version of Tn916 was never present in genomes collected from Fiji. When country of isolation was included as a covariate in the regression, these hits were no longer significant – highlighting the importance of such considerations in performing association studies in large bacterial populations.</p><p hwp:id="p-36">After applying this correction, we find two significant hits (<xref ref-type="fig" rid="figS8" hwp:id="xref-fig-10-1" hwp:rel-id="F10">Supplementary figure 8</xref>). The first corresponds to SNPs associating a specific allele of <italic toggle="yes">pepF</italic> (Oligoendopeptidase F; UniProt:P54124) with invasive isolates. This could indicate a recombination event, due to the high SNP density and discordance with vertical evolution with respect to the inferred phylogeny<sup><xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-1" hwp:rel-id="ref-21">21</xref>, <xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-1" hwp:rel-id="ref-22">22</xref></sup>. The second hit represents SNPs in the intergenic region upstream of both IgG-binding protein H and <italic toggle="yes">nrdl</italic> (ribonucleotide reductase). If this were found to affect expression of the IgG-binding protein, this would be a plausible novel genetic mechanism affecting pathogenesis<sup><xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-1" hwp:rel-id="ref-23">23</xref>, <xref ref-type="bibr" rid="c24" hwp:id="xref-ref-24-1" hwp:rel-id="ref-24">24</xref></sup>.</p><p hwp:id="p-37">The association of both of these variations would have to be validated either <italic toggle="yes">in vitro</italic> or a replication cohort, and functional follow-up such as RNA-seq may also further help with their interpretation.</p><p hwp:id="p-38">Applying a Cochran-Mantel-Haenszel test to SNPs called against a reference sequence found no sites significantly associated with invasiveness. The <italic toggle="yes">tetM</italic> gene and transposon are not found in the reference sequence, and therefore cannot be discovered by this method. The population structure is so diverse that 88 different clusters are found, which overcorrects leaving too few samples within each group to have power to discover associations.</p></sec></sec><sec id="s3" hwp:id="sec-7"><title hwp:id="title-8">Discussion</title><p hwp:id="p-39">SEER is a reference-independent, scalable pipeline capable of finding bacterial sequence elements associated with a range of phenotypes while controlling for clonal population structure. The sequence elements can be interpreted in terms of protein function using sequence databases, and we have shown that even single causal variants can be fine-mapped using the SEER output.</p><p hwp:id="p-40">Our use of all informative k-mers together with robust regression methods, and the ability to analyse very large sample sizes show improved sensitivity over existing methods. This provides a generic approach capable of analysing the rapidly increasing number of bacterial whole genome sequences linked with a range of different phenotypes. The output can readily be used in a meta-analysis of sequence elements to facilitate the combination of new studies with published data, increasing both discovery power and confirming the significance of results. As with all association methods, our approach is limited by the amount of recombination and convergent evolution that occurs in the observed population, since the discovery of causal sequence elements is principally constrained by the extent of linkage disequilibrium. However, by introducing improved computational scalability and statistical sensitivity SEER significantly pushes the existing boundaries for answering important biologically and medically relevant questions.</p></sec><sec id="s4" hwp:id="sec-8"><title hwp:id="title-9">Online methods</title><sec id="s4a" hwp:id="sec-9"><title hwp:id="title-10">Counting informative k-mers in samples</title><p hwp:id="p-41">Over all <italic toggle="yes">N</italic> samples, all k-mers over 9 bases long that occur in more than one sample are counted. All non-informative k-mers are omitted from the output; a k-mer <italic toggle="yes">X</italic> is not informative if any one base extension to the left (<italic toggle="yes">aX</italic>) or right (<italic toggle="yes">Xa</italic>) has exactly the same frequency support vector as <italic toggle="yes">X</italic>. The frequency support vector has <italic toggle="yes">N</italic> entries, each being the number of occurrences of k-mer <italic toggle="yes">X</italic> in that sample. Further filtering conditions are explained in the sections below.</p><p hwp:id="p-42">Distributed string mining (DSM)<sup><xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-2" hwp:rel-id="ref-6">6</xref>, <xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-2" hwp:rel-id="ref-7">7</xref></sup> parallelises to as much as one sample per core, and either 16 or 64 master server processes. DSM includes an optional entropy-filtering setting that filters the output k-mers based on both number of samples present and frequency distribution. On our 3 069 simulated genomes this took 2 hrs 38 min on 16 cores, and used 1Gb RAM. The distributed approach is applicable up to terabytes of short-read data<sup><xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-3" hwp:rel-id="ref-7">7</xref></sup>, but requires a cluster environment to run. As an easy-to-use alternative, we propose a single core version of DSM that is applicable for gigabyte-scale data. We implemented the single core version based on a succinct data structure library<sup><xref ref-type="bibr" rid="c25" hwp:id="xref-ref-25-1" hwp:rel-id="ref-25">25</xref></sup> to produce the same output as DSM. On 675 S. pyogenes genomes this took 3hrs 44min and used 22.3Gb RAM.</p><p hwp:id="p-43">To count single k-mer lengths, an associative array was used to combine the results from DSK in memory. We concatenated results from k-mer lengths of 21, 31 and 41, as in previous studies<sup><xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-6" hwp:rel-id="ref-1">1</xref></sup>. This can scale to large genome numbers by instead using external sorting to avoid storing the entire array in memory.</p></sec><sec id="s4b" hwp:id="sec-10"><title hwp:id="title-11">Filtering k-mers</title><p hwp:id="p-44">K-mers are filtered if either they appear in &lt;1% or &gt;99% of samples, or are over 100 bases long. We also test if the p-value of association in a simple <italic toggle="yes">χ</italic><sup>2</sup> test (1 d.f.) is less than 10<sup>-5</sup>, as in simulations this was true for all true positives. In the case of a continuous phenotype a Welch two-sample t-test is used instead.</p></sec><sec id="s4c" hwp:id="sec-11"><title hwp:id="title-12">Covariates to control for population structure</title><p hwp:id="p-45">A random sample of between 0.1% and 1% of k-mers appearing in between 5-95% of isolates is taken. We then construct a pairwise distance matrix <bold>D</bold>, with each element being equal to a sum over all <italic toggle="yes">m</italic> sampled k-mers:
<disp-formula id="ueqn1" hwp:id="disp-formula-1">
<alternatives hwp:id="alternatives-1"><graphic xlink:href="038463_ueqn1.gif" position="float" orientation="portrait" hwp:id="graphic-4"/></alternatives></disp-formula>
where <italic toggle="yes">k<sub>im</sub></italic> is 1 if the <italic toggle="yes">m</italic>th sampled k-mer is present in sample <italic toggle="yes">i</italic>, and 0 otherwise.</p><p hwp:id="p-46">Metric multi-dimensional scaling is then performed, projecting these distances into three dimensions. The normalised eigenvectors of each dimension are used as covariates in the regression model. The number of dimensions used is a user-adjustable parameter, and can be evaluated by the goodness-of-fit and the magnitude of the eigenvalues. In species tree with two lineages and 96 isolates one dimension was sufficient as a population control, whereas for the larger collection of 3069 isolates 10-15 dimensions were needed to give tight control (<xref ref-type="fig" rid="figS9" hwp:id="xref-fig-11-1" hwp:rel-id="F11">Supplementary figure 9</xref>). Over all our studies, generally three dimensions appeared a good trade-off between sensitivity and specificity.</p></sec><sec id="s4d" hwp:id="sec-12"><title hwp:id="title-13">Logistic and linear regression</title><p hwp:id="p-47">For samples with binary outcome vector <italic toggle="yes">y</italic>, for each k-mer a logistic model is fitted:
<disp-formula id="ueqn2" hwp:id="disp-formula-2">
<alternatives hwp:id="alternatives-2"><graphic xlink:href="038463_ueqn2.gif" position="float" orientation="portrait" hwp:id="graphic-5"/></alternatives></disp-formula>
where absence and presence for each k-mer coded as 0 and 1 respectively in column 2 of the design matrix <bold>X</bold> (column 1 is a vector of ones, giving an intercept term). Subsequent columns <italic toggle="yes">j</italic> of <bold>X</bold> contain the eigenvectors of the MDS projection, user-supplied categorical covariates (dummy encoded), and quantitative covariates (normalised). The BFGS algorithm is used to maximise the log likelihood <italic toggle="yes">L</italic> in terms of the gradient vector <bold><italic toggle="yes">β</italic></bold> (using an analytic expression for d(log <italic toggle="yes">L</italic>)d<bold>β</bold>):
<disp-formula id="ueqn3" hwp:id="disp-formula-3">
<alternatives hwp:id="alternatives-3"><graphic xlink:href="038463_ueqn3.gif" position="float" orientation="portrait" hwp:id="graphic-6"/></alternatives></disp-formula>
where sig is the sigmoid function. If this fails to converge, <italic toggle="yes">n</italic> Newton-Raphson iterations are applied to <bold><italic toggle="yes">β</italic></bold>
<disp-formula id="ueqn4" hwp:id="disp-formula-4">
<alternatives hwp:id="alternatives-4"><graphic xlink:href="038463_ueqn4.gif" position="float" orientation="portrait" hwp:id="graphic-7"/></alternatives></disp-formula>
from a starting point using the mean phenotype as the intercept, and the root-mean squared beta from a test of k-mers passing filtering
<disp-formula id="ueqn5" hwp:id="disp-formula-5">
<alternatives hwp:id="alternatives-5"><graphic xlink:href="038463_ueqn5.gif" position="float" orientation="portrait" hwp:id="graphic-8"/></alternatives></disp-formula>
which is slower, but has a higher success rate. If this fails to converge due to the observed points being separable in the high dimensional space, or the standard error of the slope is greater than 3 (which empirically indicated almost separable data, with no counts in one element of the contingency table), Firth logistic regression<sup><xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-2" hwp:rel-id="ref-10">10</xref></sup> is then applied. This adds an adjustment to log <italic toggle="yes">L</italic>:
<disp-formula id="ueqn6" hwp:id="disp-formula-6">
<alternatives hwp:id="alternatives-6"><graphic xlink:href="038463_ueqn6.gif" position="float" orientation="portrait" hwp:id="graphic-9"/></alternatives></disp-formula>
using which Newton-Raphson iterations are applied as above.</p><p hwp:id="p-48">In the case of a continuous phenotype a linear model is fitted:
<disp-formula id="ueqn7" hwp:id="disp-formula-7">
<alternatives hwp:id="alternatives-7"><graphic xlink:href="038463_ueqn7.gif" position="float" orientation="portrait" hwp:id="graphic-10"/></alternatives></disp-formula></p><p hwp:id="p-49">The squared distance U(<bold>β</bold>)
<disp-formula id="ueqn8" hwp:id="disp-formula-8">
<alternatives hwp:id="alternatives-8"><graphic xlink:href="038463_ueqn8.gif" position="float" orientation="portrait" hwp:id="graphic-11"/></alternatives></disp-formula>
is minimised using the BFGS algorithm. If this fails to converge then the analytic solution is obtained by orthogonal decomposition:
<disp-formula id="ueqn9" hwp:id="disp-formula-9">
<alternatives hwp:id="alternatives-9"><graphic xlink:href="038463_ueqn9.gif" position="float" orientation="portrait" hwp:id="graphic-12"/></alternatives></disp-formula>
then back-solving for <bold>β</bold> in:
<disp-formula id="ueqn10" hwp:id="disp-formula-10">
<alternatives hwp:id="alternatives-10"><graphic xlink:href="038463_ueqn10.gif" position="float" orientation="portrait" hwp:id="graphic-13"/></alternatives></disp-formula></p><p hwp:id="p-50">In both cases the standard error on β<sub>1</sub> is calculated by inverting the Fisher information matrix d<sup><xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-6" hwp:rel-id="ref-2">2</xref></sup>L/d<bold>β</bold><sup>2</sup> (inversions are performed by Cholesky decomposition, or if this fails due to the matrix being almost singular the Moore-Penrose pseudoinverse is taken) to obtain the variance-covariance matrix. The Wald statistic is calculated with the null hypothesis of no association (β<sub>1</sub> = 0) :
<disp-formula id="ueqn11" hwp:id="disp-formula-11">
<alternatives hwp:id="alternatives-11"><graphic xlink:href="038463_ueqn11.gif" position="float" orientation="portrait" hwp:id="graphic-14"/></alternatives></disp-formula>
which is the test statistic of a χ<sup>2</sup> distribution with 1 d.f. This is equivalent to the positive tail of a standard normal distribution, the integral of which gives the p-value. To calculate an empirical significance testing cut-off for the p-value under multiple correlated tests, we observed the distribution of p-values from 100 random permutations of phenotype. Setting the family-wise error rate (FWER) at 0.05 gave a cut-off of 1.4×10<sup>-8</sup>.</p></sec><sec id="s4e" hwp:id="sec-13"><title hwp:id="title-14">SEER implementation</title><p hwp:id="p-51">SEER is implemented in C++ using the armadillo linear algebra library<sup><xref ref-type="bibr" rid="c26" hwp:id="xref-ref-26-1" hwp:rel-id="ref-26">26</xref></sup>, and dlib optimisation library<sup><xref ref-type="bibr" rid="c27" hwp:id="xref-ref-27-1" hwp:rel-id="ref-27">27</xref></sup>. On a simulation of 3 069 diverse 0.4Mb genomes, 143M k-mers were counted by DSM and 25M 31-mers by DSK. On the largest DSM set, using 16 cores and subsampling 300 000 k-mers (0.2% of the total), calculating population covariates took 6hr 42min and 8.33GB RAM. This step is O(N<sup><xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-7" hwp:rel-id="ref-2">2</xref></sup>M) where N is number of samples and M is number of k-mers, but can be parallelised across up to N<sup>2</sup> cores.</p><p hwp:id="p-52">Processing all 143M informative k-mers as described took 69min 44s and 23MB RAM on 16 cores. This step is O(M) and can be parallelised across up to M cores.</p><p hwp:id="p-53">On the real dataset of full length genomes the 68M informative k-mers counted was less than the simulated dataset above, as the parameters of the simulation created particularly diverse final genomes.</p></sec><sec id="s4f" hwp:id="sec-14"><title hwp:id="title-15">Interpreting significant k-mers</title><p hwp:id="p-54">K-mers reaching the threshold for significance are then post-association filtered requiring β<sub>1</sub> &gt; 0 as a negative effect size does not make biological sense. Remaining k-mers are searched for by exact match in their <italic toggle="yes">de novo</italic> assemblies, and annotations of features examined for overlap of function. BLAT<sup><xref ref-type="bibr" rid="c28" hwp:id="xref-ref-28-1" hwp:rel-id="ref-28">28</xref></sup> is also used with a step size of 2 and minimum match size of 15 to find inexact but close matches to a well annotated reference sequence.</p><p hwp:id="p-55">To better search for gene clusters associated with phenotype, these k-mers are assembled using Velvet<sup><xref ref-type="bibr" rid="c29" hwp:id="xref-ref-29-1" hwp:rel-id="ref-29">29</xref></sup> choosing a smaller sub-k-mer size which maximises longest contig length of the final assembly. K-mers which are then substrings of others significant k-mers are removed.</p></sec><sec id="s4g" hwp:id="sec-15"><title hwp:id="title-16">Mapping of a single SNP</title><p hwp:id="p-56">Using the BLAT mapping of significant k-mers to a reference sequence, SNPs are called using bcftools<sup><xref ref-type="bibr" rid="c30" hwp:id="xref-ref-30-1" hwp:rel-id="ref-30">30</xref></sup>. Quality scores for a read are set to be identical, and are set as the Phred-scaled Holm-adjusted p-values from association. High quality (QUAL &gt; 100) SNPs are then annotated for function using SnpEff<sup><xref ref-type="bibr" rid="c31" hwp:id="xref-ref-31-1" hwp:rel-id="ref-31">31</xref></sup>, and the effect of missense SNPs on protein function is ranked using SIFT<sup><xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-2" hwp:rel-id="ref-19">19</xref></sup>.</p></sec><sec id="s4h" hwp:id="sec-16"><title hwp:id="title-17">Comparison to existing methods</title><p hwp:id="p-57">We compare to two existing methods. The first uses a core-genome SNP mapping along with population clusters defined from the same alignment to perform a Cochran-Mantel-Haenszel test at every called variant site<sup><xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-8" hwp:rel-id="ref-2">2</xref></sup>. The second uses a fixed k-mer length of 31 as counted by dsk<sup><xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-3" hwp:rel-id="ref-8">8</xref></sup>, with a Monte Carlo phylogeny-based population control<sup><xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-7" hwp:rel-id="ref-1">1</xref></sup>. As the second method is not scalable to this population size we used our population control as calculated from all genomes in the population, and a subsample of 100 samples to calculate association statistics, which is roughly the number computationally accessible by this method. In both cases, the same Bonferroni correction is used as for SEER.</p></sec><sec id="s4i" hwp:id="sec-17"><title hwp:id="title-18">Simulating bacterial populations</title><p hwp:id="p-58">A random subset of 450 genes from the <italic toggle="yes">Streptococcus pneumoniae</italic> ATCC 700669<sup><xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-3" hwp:rel-id="ref-16">16</xref></sup> strain were used as the starting genome for ALF<sup><xref ref-type="bibr" rid="c32" hwp:id="xref-ref-32-1" hwp:rel-id="ref-32">32</xref></sup>. ALF simulated 3069 final genomes along the phylogeny observed in a Thai refugee camp<sup><xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-2" hwp:rel-id="ref-13">13</xref></sup>. An alignment between <italic toggle="yes">S. pneumoniae</italic> strains R6, 19F and <italic toggle="yes">Streptococcus rnitis</italic> B6 using Progressive Cactus was used to estimate rates in the GTR matrix and the size distribution of insertions and deletions (INDELs – <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-5-2" hwp:rel-id="F5">Supplementary figure 3</xref>). Previous estimates for the relative rate of SNPs to INDELs<sup><xref ref-type="bibr" rid="c33" hwp:id="xref-ref-33-1" hwp:rel-id="ref-33">33</xref></sup> and the rate of horizontal gene transfer and loss<sup><xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-3" hwp:rel-id="ref-13">13</xref></sup> were used.</p><p hwp:id="p-59">pIRS<sup><xref ref-type="bibr" rid="c34" hwp:id="xref-ref-34-1" hwp:rel-id="ref-34">34</xref></sup> was used to simulate error-prone reads from genomes at the tips of the tree, which were then assembled by Velvet<sup><xref ref-type="bibr" rid="c29" hwp:id="xref-ref-29-2" hwp:rel-id="ref-29">29</xref></sup>. DSM was used to count k-mers from these <italic toggle="yes">de novo</italic> assemblies.</p><p hwp:id="p-60">To test the similarity of the population control to existing methods, 96 full <italic toggle="yes">Streptococcus pneumoniae</italic> ATCC 700669 genomes were evolved with ALF. Intergenic regions were also evolved using Dawg<sup><xref ref-type="bibr" rid="c35" hwp:id="xref-ref-35-1" hwp:rel-id="ref-35">35</xref></sup> at a previously determined rate<sup><xref ref-type="bibr" rid="c36" hwp:id="xref-ref-36-1" hwp:rel-id="ref-36">36</xref></sup>. These were combined, and assemblies generated and k-mers counted as above. A distance matrix was created from 1% of the k-mers as described above, and a neighbour-joining tree produced from this.</p><p hwp:id="p-61">The resulting tree was ranked against the true tree by counting one for each pair of isolates in each BAPS<sup><xref ref-type="bibr" rid="c37" hwp:id="xref-ref-37-1" hwp:rel-id="ref-37">37</xref></sup> cluster which had an isolate not in the same BAPS cluster as a descendent of their MRCA.</p></sec><sec id="s4j" hwp:id="sec-18"><title hwp:id="title-19">Simulating phenotype based on genotype and odds-ratio</title><p hwp:id="p-62">Ratio of cases to controls in the population (<italic toggle="yes">S<sub>R</sub></italic>) was set at 50% to represent antibiotic resistance, and a single variant (gene presence/absence or a SNP) was designated as causal. Minor allele frequency (MAF) in the population is set from the simulation, and odds-ratio (OR) can be varied. The number of disease cases <italic toggle="yes">D<sub>E</sub></italic> is then the solution to a quadratic equation<sup><xref ref-type="bibr" rid="c38" hwp:id="xref-ref-38-1" hwp:rel-id="ref-38">38</xref></sup>, which is related to probability of a sample being a case by:
<disp-formula id="ueqn12" hwp:id="disp-formula-12">
<alternatives hwp:id="alternatives-12"><graphic xlink:href="038463_ueqn12.gif" position="float" orientation="portrait" hwp:id="graphic-15"/></alternatives></disp-formula></p><p hwp:id="p-63">The population was then randomly subsampled 100 times, with case and control status assigned for each run using these formulae. Power was defined by the proportion of runs that had at least one k-mer in the gene associated with phenotype reaching significance.</p></sec><sec id="s4k" hwp:id="sec-19"><title hwp:id="title-20">Elements enriched in <italic toggle="yes">S. pyogenes</italic> invasiveness</title><p hwp:id="p-64">We sequenced 675 isolates of <italic toggle="yes">S. pyogenes</italic> on the Illumina HiSeq platform, of which 347 were from Fiji and 328 were from Kilifi<sup><xref ref-type="bibr" rid="c39" hwp:id="xref-ref-39-1" hwp:rel-id="ref-39">39</xref></sup>. We defined those isolated from blood, cerebrospinal fluid (CSF) or broncho-pulmonary aspirate as invasive (n = 185), and those isolated from throat, skin or urine as non-invasive (n = 490). Including country as a categorical covariate was necessary, as without doing so many elements which stratify by isolate collection appear as significant. The SEER pipeline was run as described, yielding 1233 k-mers which exceeded the threshold for significance.</p><p hwp:id="p-65">BLAST of the k-mers with the nr/nt database was used to determine a suitable reference to map to, and after mapping SNPs were called as above.</p></sec></sec></body><back><ref-list hwp:id="ref-list-1"><title hwp:id="title-21">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1 xref-ref-1-2 xref-ref-1-3 xref-ref-1-4 xref-ref-1-5 xref-ref-1-6 xref-ref-1-7"><label>1.</label><citation publication-type="confproc" citation-type="confproc" ref:id="038463v3.1" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Sheppard S. K."><surname>Sheppard</surname>, <given-names>S. K.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-2">Genome-wide association study identifies vitamin B5 biosynthesis as a host specificity factor in Campylobacter</article-title>. <conf-name>Proc. Natl. Acad. Sci</conf-name>. <volume>110</volume>, <fpage>11923</fpage>–<lpage>11927</lpage> (<year>2013</year>).</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1 xref-ref-2-2 xref-ref-2-3 xref-ref-2-4 xref-ref-2-5 xref-ref-2-6 xref-ref-2-7 xref-ref-2-8"><label>2.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="Chewapreecha C."><surname>Chewapreecha</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-3">Comprehensive Identification of Single Nucleotide Polymorphisms Associated with Beta-lactam Resistance within Pneumococcal Mosaic Genes</article-title>. <source hwp:id="source-1">PLoS Genet</source>. <volume>10</volume>, <fpage>e1004547</fpage> (<year>2014</year>).</citation></ref><ref id="c3" hwp:id="ref-3" hwp:rev-id="xref-ref-3-1 xref-ref-3-2"><label>3.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.3" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Laabei M."><surname>Laabei</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-4">Predicting the virulence of MRSA from its genome sequence</article-title>. <source hwp:id="source-2">Genome Res</source>. <volume>24</volume>, <fpage>839</fpage>–<lpage>849</lpage> (<year>2014</year>).</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1"><label>4.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.4" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Weinert L. a."><surname>Weinert</surname>, <given-names>L. a.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-5">Genomic signatures of human and animal disease in the zoonotic pathogen Streptococcus suis</article-title>. <source hwp:id="source-3">Nat. Commun</source>. <volume>6</volume>, <fpage>6740</fpage> (<year>2015</year>).</citation></ref><ref id="c5" hwp:id="ref-5" hwp:rev-id="xref-ref-5-1"><label>5.</label><citation publication-type="other" citation-type="journal" ref:id="038463v3.5" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Chen P. E."><surname>Chen</surname>, <given-names>P. E.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Shapiro B. J."><surname>Shapiro</surname>, <given-names>B. J.</given-names></string-name> <source hwp:id="source-4">The advent of genome-wide association studies for bacteria</source>. (<year>2015</year>).</citation></ref><ref id="c6" hwp:id="ref-6" hwp:rev-id="xref-ref-6-1 xref-ref-6-2"><label>6.</label><citation publication-type="book" citation-type="book" ref:id="038463v3.6" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Välimäki N."><surname>Välimäki</surname>, <given-names>N.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Puglisi S."><surname>Puglisi</surname>, <given-names>S.</given-names></string-name> in <source hwp:id="source-5">Algorithms Bioinforma. SE - 35</source> (<string-name name-style="western" hwp:sortable="Raphael B."><surname>Raphael</surname>, <given-names>B.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Tang J."><surname>Tang</surname>, <given-names>J.</given-names></string-name>) <volume>7534</volume>, <fpage>441</fpage>–<lpage>452</lpage> (<publisher-name>Springer Berlin Heidelberg</publisher-name>, <year>2012</year>).</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1 xref-ref-7-2 xref-ref-7-3"><label>7.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.7" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Seth S."><surname>Seth</surname>, <given-names>S.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Välimäki N."><surname>Välimäki</surname>, <given-names>N.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kaski S."><surname>Kaski</surname>, <given-names>S.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Honkela A."><surname>Honkela</surname>, <given-names>A.</given-names></string-name> <article-title hwp:id="article-title-6">Exploration and retrieval of whole-metagenome sequencing samples</article-title>. <source hwp:id="source-6">Bioinformatics</source> <volume>30</volume>, <fpage>16</fpage> (<year>2014</year>).</citation></ref><ref id="c8" hwp:id="ref-8" hwp:rev-id="xref-ref-8-1 xref-ref-8-2 xref-ref-8-3"><label>8.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Rizk G."><surname>Rizk</surname>, <given-names>G.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Lavenier D."><surname>Lavenier</surname>, <given-names>D.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Chikhi R."><surname>Chikhi</surname>, <given-names>R.</given-names></string-name> <article-title hwp:id="article-title-7">DSK: K-mer counting with very low memory usage</article-title>. <source hwp:id="source-7">Bioinformatics</source> <volume>29</volume>, <fpage>652</fpage>–<lpage>653</lpage> (<year>2013</year>).</citation></ref><ref id="c9" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1"><label>9.</label><citation publication-type="confproc" citation-type="confproc" ref:id="038463v3.9" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Tasoulis S."><surname>Tasoulis</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-8">Random projection based clustering for population genomics</article-title>. in <conf-name>2014 IEEE Int. Conf. Big Data (Big Data)</conf-name> <fpage>675</fpage>–<lpage>682</lpage> (<year>2014</year>). doi:<pub-id pub-id-type="doi">10.1109/BigData.2014.7004291</pub-id></citation></ref><ref id="c10" hwp:id="ref-10" hwp:rev-id="xref-ref-10-1 xref-ref-10-2"><label>10.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="Heinze G."><surname>Heinze</surname>, <given-names>G.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Schemper M."><surname>Schemper</surname>, <given-names>M.</given-names></string-name> <article-title hwp:id="article-title-9">A solution to the problem of separation in logistic regression</article-title>. <source hwp:id="source-8">Stat. Med</source>. <volume>21</volume>, <fpage>2409</fpage>–<lpage>2419</lpage> (<year>2002</year>).</citation></ref><ref id="c11" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1"><label>11.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.11" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="Ford C. B."><surname>Ford</surname>, <given-names>C. B.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-10">Mycobacterium tuberculosis mutation rate estimates from different lineages predict substantial differences in the emergence of drugresistant tuberculosis</article-title>. <source hwp:id="source-9">Nat. Genet</source>. <volume>45</volume>, <fpage>784</fpage>–<lpage>790</lpage> (<year>2013</year>).</citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1"><label>12.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.12" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Evangelou E."><surname>Evangelou</surname>, <given-names>E.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Ioannidis J. P. A."><surname>Ioannidis</surname>, <given-names>J. P. A.</given-names></string-name> <article-title hwp:id="article-title-11">Meta-analysis methods for genome-wide association studies and beyond</article-title>. <source hwp:id="source-10">Nat. Rev. Genet</source>. <volume>14</volume>, <fpage>379</fpage>–<lpage>389</lpage> (<year>2013</year>).</citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1 xref-ref-13-2 xref-ref-13-3"><label>13.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.13" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="Chewapreecha C."><surname>Chewapreecha</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-12">Dense genomic sampling identifies highways of pneumococcal recombination</article-title>. <source hwp:id="source-11">Nat. Genet</source>. <volume>46</volume>, <fpage>305</fpage>–<lpage>9</lpage> (<year>2014</year>).</citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1"><label>14.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.14" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Farhat M. R."><surname>Farhat</surname>, <given-names>M. R.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-13">Genomic analysis identifies targets of convergent positive selection in drug-resistant Mycobacterium tuberculosis</article-title>. <source hwp:id="source-12">Nat. Genet</source>. <volume>45</volume>, <fpage>1183</fpage>–<lpage>9</lpage> (<year>2013</year>).</citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1"><label>15.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.15" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Spain S. L."><surname>Spain</surname>, <given-names>S. L.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Barrett J. C."><surname>Barrett</surname>, <given-names>J. C.</given-names></string-name> <article-title hwp:id="article-title-14">Strategies for fine-mapping complex traits</article-title>. <source hwp:id="source-13">Hum. Mol. Genet</source>. <volume>24</volume>, <fpage>R111</fpage>–<lpage>R119</lpage> (<year>2015</year>).</citation></ref><ref id="c16" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1 xref-ref-16-2 xref-ref-16-3"><label>16.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.16" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Croucher N. J."><surname>Croucher</surname>, <given-names>N. J.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-15">Role of conjugative elements in the evolution of the multidrug-resistant pandemic clone Streptococcus pneumoniaeSpain23F ST81</article-title>. <source hwp:id="source-14">J. Bacteriol</source>. <volume>191</volume>, <fpage>1480</fpage>–<lpage>1489</lpage> (<year>2009</year>).</citation></ref><ref id="c17" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1"><label>17.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.17" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="Croucher N. J."><surname>Croucher</surname>, <given-names>N. J.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-16">Rapid pneumococcal evolution in response to clinical interventions</article-title>. <source hwp:id="source-15">Science</source> <volume>331</volume>, <fpage>430</fpage>–<lpage>4</lpage> (<year>2011</year>).</citation></ref><ref id="c18" hwp:id="ref-18" hwp:rev-id="xref-ref-18-1"><label>18.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.18" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-18"><string-name name-style="western" hwp:sortable="Maskell J. P."><surname>Maskell</surname>, <given-names>J. P.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Sefton a. M."><surname>Sefton</surname>, <given-names>a. M.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Hall L. M. C."><surname>Hall</surname>, <given-names>L. M. C.</given-names></string-name> <article-title hwp:id="article-title-17">Multiple mutations modulate the function of dihydrofolate reductase in trimethoprim-resistant Streptococcus pneumoniae</article-title>. <source hwp:id="source-16">Antimicrob. Agents Chemother</source>. <volume>45</volume>, <fpage>1104</fpage>–<lpage>1108</lpage> (<year>2001</year>).</citation></ref><ref id="c19" hwp:id="ref-19" hwp:rev-id="xref-ref-19-1 xref-ref-19-2"><label>19.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.19" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-19"><string-name name-style="western" hwp:sortable="Ng P. C."><surname>Ng</surname>, <given-names>P. C.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Henikoff S."><surname>Henikoff</surname>, <given-names>S.</given-names></string-name> <article-title hwp:id="article-title-18">SIFT : predicting amino acid changes that affect protein function</article-title>. <source hwp:id="source-17">Nucleic Acids Res</source>. <volume>31</volume>, <fpage>3812</fpage>–<lpage>3814</lpage> (<year>2003</year>).</citation></ref><ref id="c20" hwp:id="ref-20" hwp:rev-id="xref-ref-20-1"><label>20.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.20" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-20"><string-name name-style="western" hwp:sortable="Roberts A. P."><surname>Roberts</surname>, <given-names>A. P.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Mullany P."><surname>Mullany</surname>, <given-names>P.</given-names></string-name> <article-title hwp:id="article-title-19">A modular master on the move: the Tn916 family of mobile genetic elements</article-title>. <source hwp:id="source-18">Trends Microbiol</source>. <volume>17</volume>, <fpage>251</fpage>–<lpage>258</lpage> (<year>2009</year>).</citation></ref><ref id="c21" hwp:id="ref-21" hwp:rev-id="xref-ref-21-1"><label>21.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.21" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-21"><string-name name-style="western" hwp:sortable="Dubnau D."><surname>Dubnau</surname>, <given-names>D.</given-names></string-name> <article-title hwp:id="article-title-20">DNA Uptake in Bacteria</article-title>. <source hwp:id="source-19">Annu. Rev. Microbiol</source>. <volume>53</volume>, <fpage>217</fpage>–<lpage>244</lpage> (<year>1999</year>).</citation></ref><ref id="c22" hwp:id="ref-22" hwp:rev-id="xref-ref-22-1"><label>22.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.22" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-22"><string-name name-style="western" hwp:sortable="Lefébure T."><surname>Lefébure</surname>, <given-names>T.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Stanhope M. J."><surname>Stanhope</surname>, <given-names>M. J.</given-names></string-name> <article-title hwp:id="article-title-21">Evolution of the core and pan-genome of Streptococcus: positive selection, recombination, and genome composition</article-title>. <source hwp:id="source-20">Genome Biol</source>. <volume>8</volume>, <fpage>R71</fpage> (<year>2007</year>).</citation></ref><ref id="c23" hwp:id="ref-23" hwp:rev-id="xref-ref-23-1"><label>23.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.23" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-23"><string-name name-style="western" hwp:sortable="Raeder R."><surname>Raeder</surname>, <given-names>R.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Boyle M. D."><surname>Boyle</surname>, <given-names>M. D.</given-names></string-name> <article-title hwp:id="article-title-22">Association between expression of immunoglobulin G-binding proteins by group A streptococci and virulence in a mouse skin infection model</article-title>. <source hwp:id="source-21">Infect. Immun</source>. <volume>61</volume>, <fpage>1378</fpage>–<lpage>1384</lpage> (<year>1993</year>).</citation></ref><ref id="c24" hwp:id="ref-24" hwp:rev-id="xref-ref-24-1"><label>24.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.24" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-24"><string-name name-style="western" hwp:sortable="Raeder R."><surname>Raeder</surname>, <given-names>R.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Boyle M. D."><surname>Boyle</surname>, <given-names>M. D.</given-names></string-name> <article-title hwp:id="article-title-23">Analysis of immunoglobulin G-binding-protein expression by invasive isolates of Streptococcus pyogenes</article-title>. <source hwp:id="source-22">Clin. Diagn. Lab. Immunol</source>. <volume>2</volume>, <fpage>484</fpage>–<lpage>486</lpage> (<year>1995</year>).</citation></ref><ref id="c25" hwp:id="ref-25" hwp:rev-id="xref-ref-25-1"><label>25.</label><citation publication-type="book" citation-type="book" ref:id="038463v3.25" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-25"><string-name name-style="western" hwp:sortable="Gog S."><surname>Gog</surname>, <given-names>S.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Beller T."><surname>Beller</surname>, <given-names>T.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Moffat A."><surname>Moffat</surname>, <given-names>A.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Petri M."><surname>Petri</surname>, <given-names>M.</given-names></string-name> in <source hwp:id="source-23">Exp. Algorithms SE - 28</source> (<string-name name-style="western" hwp:sortable="Gudmundsson J."><surname>Gudmundsson</surname>, <given-names>J.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Katajainen J."><surname>Katajainen</surname>, <given-names>J.</given-names></string-name>) <volume>8504</volume>, <fpage>326</fpage>–<lpage>337</lpage> (<publisher-name>Springer International Publishing</publisher-name>, <year>2014</year>).</citation></ref><ref id="c26" hwp:id="ref-26" hwp:rev-id="xref-ref-26-1"><label>26.</label><citation publication-type="other" citation-type="journal" ref:id="038463v3.26" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-26"><string-name name-style="western" hwp:sortable="Sanderson C."><surname>Sanderson</surname>, <given-names>C.</given-names></string-name> <article-title hwp:id="article-title-24">Armadillo: An Open Source C++ Linear Algebra Library for Fast Prototyping and Computationally Intensive Experiments</article-title>. in <source hwp:id="source-24">NICTA NICTA</source>, <fpage>1</fpage>–<lpage>16</lpage> (<year>2010</year>).</citation></ref><ref id="c27" hwp:id="ref-27" hwp:rev-id="xref-ref-27-1"><label>27.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.27" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-27"><string-name name-style="western" hwp:sortable="King D. E."><surname>King</surname>, <given-names>D. E.</given-names></string-name> <article-title hwp:id="article-title-25">Dlib-ml : A Machine Learning Toolkit</article-title>. <source hwp:id="source-25">J. Mach. Learn. Res</source>. <volume>10</volume>, <fpage>1755</fpage>–<lpage>1758</lpage> (<year>2009</year>).</citation></ref><ref id="c28" hwp:id="ref-28" hwp:rev-id="xref-ref-28-1"><label>28.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.28" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-28"><string-name name-style="western" hwp:sortable="Kent W. J."><surname>Kent</surname>, <given-names>W. J.</given-names></string-name> <article-title hwp:id="article-title-26">BLAT—The BLAST-Like Alignment Tool</article-title>. <source hwp:id="source-26">Genome Res</source>. <volume>12</volume>, <fpage>656</fpage>–<lpage>664</lpage> (<year>2002</year>).</citation></ref><ref id="c29" hwp:id="ref-29" hwp:rev-id="xref-ref-29-1 xref-ref-29-2"><label>29.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.29" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-29"><string-name name-style="western" hwp:sortable="Zerbino D. R."><surname>Zerbino</surname>, <given-names>D. R.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Birney E."><surname>Birney</surname>, <given-names>E.</given-names></string-name> <article-title hwp:id="article-title-27">Velvet: algorithms for de novo short read assembly using de Bruijn graphs</article-title>. <source hwp:id="source-27">Genome Res</source>. <volume>18</volume>, <fpage>821</fpage>–<lpage>9</lpage> (<year>2008</year>).</citation></ref><ref id="c30" hwp:id="ref-30" hwp:rev-id="xref-ref-30-1"><label>30.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.30" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-30"><string-name name-style="western" hwp:sortable="Li H."><surname>Li</surname>, <given-names>H.</given-names></string-name> <article-title hwp:id="article-title-28">A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source hwp:id="source-28">Bioinformatics</source> <volume>27</volume>, <fpage>2987</fpage>–<lpage>2993</lpage> (<year>2011</year>).</citation></ref><ref id="c31" hwp:id="ref-31" hwp:rev-id="xref-ref-31-1"><label>31.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.31" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-31"><string-name name-style="western" hwp:sortable="Cingolani P."><surname>Cingolani</surname>, <given-names>P.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-29">A program for annotating and predicting the effects of single nucleotide polymorphisms, SnpEff: SNPs in the genome of Drosophila melanogaster strain w1118; iso-2; iso-3</article-title>. <source hwp:id="source-29">Fly (Austin)</source>. <volume>6</volume>, <fpage>1</fpage>–<lpage>13</lpage> (<year>2012</year>).</citation></ref><ref id="c32" hwp:id="ref-32" hwp:rev-id="xref-ref-32-1"><label>32.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.32" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-32"><string-name name-style="western" hwp:sortable="Dalquen D. a"><surname>Dalquen</surname>, <given-names>D. a</given-names></string-name>, <string-name name-style="western" hwp:sortable="Anisimova M."><surname>Anisimova</surname>, <given-names>M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gonnet G. H."><surname>Gonnet</surname>, <given-names>G. H.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Dessimoz C."><surname>Dessimoz</surname>, <given-names>C.</given-names></string-name> <article-title hwp:id="article-title-30">ALF--a simulation framework for genome evolution</article-title>. <source hwp:id="source-30">Mol. Biol. Evol</source>. <volume>29</volume>, <fpage>1115</fpage>–<lpage>23</lpage> (<year>2012</year>).</citation></ref><ref id="c33" hwp:id="ref-33" hwp:rev-id="xref-ref-33-1"><label>33.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.33" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-33"><string-name name-style="western" hwp:sortable="Chen J. Q."><surname>Chen</surname>, <given-names>J. Q.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-31">Variation in the ratio of nucleotide substitution and indel rates across genomes in mammals and bacteria</article-title>. <source hwp:id="source-31">Mol. Biol. Evol</source>. <volume>26</volume>, <fpage>1523</fpage>–<lpage>1531</lpage> (<year>2009</year>).</citation></ref><ref id="c34" hwp:id="ref-34" hwp:rev-id="xref-ref-34-1"><label>34.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.34" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-34"><string-name name-style="western" hwp:sortable="Hu X."><surname>Hu</surname>, <given-names>X.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-32">pIRS: Profile-based Illumina pair-end reads simulator</article-title>. <source hwp:id="source-32">Bioinformatics</source> <volume>28</volume>, <fpage>1533</fpage>–<lpage>1535</lpage> (<year>2012</year>).</citation></ref><ref id="c35" hwp:id="ref-35" hwp:rev-id="xref-ref-35-1"><label>35.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.35" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-35"><string-name name-style="western" hwp:sortable="Cartwright R. a."><surname>Cartwright</surname>, <given-names>R. a.</given-names></string-name> <article-title hwp:id="article-title-33">DNA assembly with gaps (Dawg): Simulating sequence evolution</article-title>. <source hwp:id="source-33">Bioinformatics</source> <volume>21</volume>, <fpage>31</fpage>–<lpage>38</lpage> (<year>2005</year>).</citation></ref><ref id="c36" hwp:id="ref-36" hwp:rev-id="xref-ref-36-1"><label>36.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.36" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-36"><string-name name-style="western" hwp:sortable="Kosiol C."><surname>Kosiol</surname>, <given-names>C.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Holmes I."><surname>Holmes</surname>, <given-names>I.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Goldman N."><surname>Goldman</surname>, <given-names>N.</given-names></string-name> <article-title hwp:id="article-title-34">An empirical codon model for protein sequence evolution</article-title>. <source hwp:id="source-34">Mol. Biol. Evol</source>. <volume>24</volume>, <fpage>1464</fpage>–<lpage>1479</lpage> (<year>2007</year>).</citation></ref><ref id="c37" hwp:id="ref-37" hwp:rev-id="xref-ref-37-1"><label>37.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.37" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-37"><string-name name-style="western" hwp:sortable="Cheng L."><surname>Cheng</surname>, <given-names>L.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Connor T. R."><surname>Connor</surname>, <given-names>T. R.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Sirén J."><surname>Sirén</surname>, <given-names>J.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Aanensen D. M."><surname>Aanensen</surname>, <given-names>D. M.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Corander J."><surname>Corander</surname>, <given-names>J.</given-names></string-name> <article-title hwp:id="article-title-35">Hierarchical and spatially explicit clustering of DNA sequences with BAPS software</article-title>. <source hwp:id="source-35">Mol. Biol. Evol</source>. <volume>30</volume>, <fpage>1224</fpage>–<lpage>8</lpage> (<year>2013</year>).</citation></ref><ref id="c38" hwp:id="ref-38" hwp:rev-id="xref-ref-38-1"><label>38.</label><citation publication-type="book" citation-type="book" ref:id="038463v3.38" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-38"><string-name name-style="western" hwp:sortable="Newman S. C."><surname>Newman</surname>, <given-names>S. C.</given-names></string-name> in <source hwp:id="source-36">Biostat. Methods Epidemiol</source>. <fpage>329</fpage>–<lpage>330</lpage> (<publisher-name>John Wiley &amp; Sons, Inc</publisher-name>., <year>2003</year>). doi:<pub-id pub-id-type="doi">10.1002/0471272612.app4</pub-id></citation></ref><ref id="c39" hwp:id="ref-39" hwp:rev-id="xref-ref-39-1"><label>39.</label><citation publication-type="journal" citation-type="journal" ref:id="038463v3.39" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-39"><string-name name-style="western" hwp:sortable="Seale A. C."><surname>Seale</surname>, <given-names>A. C.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-36">Invasive Group A Streptococcus Infection among Children, Rural Kenya</article-title>. <source hwp:id="source-37">Emerg. Infect. Dis. J</source>. <volume>22</volume>, <fpage>224</fpage> (<year>2016</year>).</citation></ref></ref-list><ack hwp:id="ack-1"><title hwp:id="title-22">Acknowledgements</title><p hwp:id="p-66">We would like to thank James Hadfield for his help in integrating SEER’s output into the bacterial genome visualisation tool JSCandy, and Jeff Barrett and his group for helpful discussions on the relation of association studies in human genetics to prokaryotic genetics.</p><p hwp:id="p-67">This work was supported by Wellcome Trust grant 098051, MRC grant 1365620, ERC grant 239784, Academy of Finland grant 287665 and COIN Centre of Excellence.</p></ack><sec id="s5" sec-type="COI-statement" hwp:id="sec-20"><title hwp:id="title-23">Competing Interests</title><p hwp:id="p-68">The authors declare no competing interests.</p></sec><sec id="s6" hwp:id="sec-21"><title hwp:id="title-24">Author Contributions</title><p hwp:id="p-69">JAL – Designed method, performed analysis, wrote manuscript.</p><p hwp:id="p-70">MV – Designed method, performed analysis, wrote manuscript.</p><p hwp:id="p-71">NV – Participated in method design, edited manuscript.</p><p hwp:id="p-72">SRH – Helped with interpretation of <italic toggle="yes">S. pyogenes</italic> data</p><p hwp:id="p-73">CC – Prepared genetic and metadata from Maela isolates.</p><p hwp:id="p-74">NJC – Helped with interpretation of antibiotic resistance elements, edited manuscript.</p><p hwp:id="p-75">PM – Participated in method design, edited manuscript.</p><p hwp:id="p-76">AH – Participated in method design, edited manuscript.</p><p hwp:id="p-77">JP – Advised on microbiological interpretation, edited manuscript.</p><p hwp:id="p-78">SDB – Advised on microbiological interpretation, edited manuscript.</p><p hwp:id="p-79">JC – Designed method, performed analysis, wrote manuscript.</p></sec><sec id="s7" hwp:id="sec-22"><title hwp:id="title-25">Data Access</title><p hwp:id="p-80">SEER is available at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/johnlees/seer" ext-link-type="uri" xlink:href="https://github.com/johnlees/seer" hwp:id="ext-link-4">https://github.com/johnlees/seer</ext-link>, DSM at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/HIITMetagenomics/dsm-framework" ext-link-type="uri" xlink:href="https://github.com/HIITMetagenomics/dsm-framework" hwp:id="ext-link-5">https://github.com/HIITMetagenomics/dsm-framework</ext-link> and fsm-lite at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/nvalimak/fsm-lite" ext-link-type="uri" xlink:href="https://github.com/nvalimak/fsm-lite" hwp:id="ext-link-6">https://github.com/nvalimak/fsm-lite</ext-link>.</p><p hwp:id="p-81">Scripts used to perform the simulations are available at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/johnlees/bioinformatics" ext-link-type="uri" xlink:href="https://github.com/johnlees/bioinformatics" hwp:id="ext-link-7">https://github.com/johnlees/bioinformatics</ext-link></p><p hwp:id="p-82">Results from the <italic toggle="yes">S. pyogenes</italic> invasiveness GWAS can be found at: <ext-link l:rel="related" l:ref-type="uri" l:ref="http://dx.doi.org/10.6084/m9.figshare.1613851" ext-link-type="uri" xlink:href="http://dx.doi.org/10.6084/m9.figshare.1613851" hwp:id="ext-link-8">http://dx.doi.org/10.6084/m9.figshare.1613851</ext-link> and can be loaded directly into JSCandy (<ext-link l:rel="related" l:ref-type="uri" l:ref="http://jameshadfield.github.io/JScandy/" ext-link-type="uri" xlink:href="http://jameshadfield.github.io/JScandy/" hwp:id="ext-link-9">http://jameshadfield.github.io/JScandy/</ext-link>) to view the results.</p></sec><sec sec-type="supplementary-material" id="s8" hwp:id="sec-23"><title hwp:id="title-26">Supplementary data</title><table-wrap id="tblS1" orientation="portrait" position="float" hwp:id="T2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;038463v3/TBLS1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T2</object-id><object-id pub-id-type="publisher-id">tblS1</object-id><label>Supplementary table 1:</label><caption hwp:id="caption-4"><p hwp:id="p-83">Comparison of SEER with results from existing methods in finding genetic associations with antibiotic resistance in the Chewapreecha <italic toggle="yes">et. al</italic>. study of 3069 Thai carriage <italic toggle="yes">S. pneumoniae</italic> samples. For each of the five antibiotics, the true causal variant is listed, as are the number of hits passing the significance threshold for each method (plink and dsk) and the number which map to the correct region.</p></caption><graphic xlink:href="038463_tblS1" position="float" orientation="portrait" hwp:id="graphic-16"/></table-wrap><fig id="figS1" position="float" orientation="portrait" fig-type="figure" hwp:id="F3" hwp:rev-id="xref-fig-3-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;038463v3/FIGS1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F3</object-id><object-id pub-id-type="publisher-id">figS1</object-id><label>Supplementary figure 1:</label><caption hwp:id="caption-5"><p hwp:id="p-84">Plot of the k-mer distances projected into three dimensions by MDS for the Chewapreecha <italic toggle="yes">et. al</italic>. study of 3069 Thai carriage <italic toggle="yes">S. pneumoniae</italic> samples. Shade from black to red is by y-coordinate (2<sup>nd</sup> MDS component).</p></caption><graphic xlink:href="038463_figS1" position="float" orientation="portrait" hwp:id="graphic-17"/></fig><fig id="figS2" position="float" orientation="portrait" fig-type="figure" hwp:id="F4" hwp:rev-id="xref-fig-4-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;038463v3/FIGS2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F4</object-id><object-id pub-id-type="publisher-id">figS2</object-id><label>Supplementary figure 2:</label><caption hwp:id="caption-6"><p hwp:id="p-85">a) Tree used for Monte Carlo simulations 733 ions of 96 <italic toggle="yes">S. pneumoniae</italic> genomes. b) UPGMA tree from k-mer distance matrix produced from simulated reads. Colours are hireBAPS clusters.</p></caption><graphic xlink:href="038463_figS2" position="float" orientation="portrait" hwp:id="graphic-18"/></fig><fig id="figS3" position="float" orientation="portrait" fig-type="figure" hwp:id="F5" hwp:rev-id="xref-fig-5-1 xref-fig-5-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;038463v3/FIGS3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F5</object-id><object-id pub-id-type="publisher-id">figS3</object-id><label>Supplementary figure 3:</label><caption hwp:id="caption-7"><p hwp:id="p-86">Estimated size distribution for INDELs, as estimated from a Progressive Cactus alignment of three members of the <italic toggle="yes">Streptococcus</italic> genus. A power law <italic toggle="yes">p=L<sup>k</sup></italic> (Zipfian function; <italic toggle="yes">p</italic> is probability, <italic toggle="yes">L</italic> is INDEL length, <italic toggle="yes">k</italic> is a free parameter) is fit to the data, the parameter <italic toggle="yes">k</italic> is used in the simulations.</p></caption><graphic xlink:href="038463_figS3" position="float" orientation="portrait" hwp:id="graphic-19"/></fig><fig id="figS4" position="float" orientation="portrait" fig-type="figure" hwp:id="F6" hwp:rev-id="xref-fig-6-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;038463v3/FIGS4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F6</object-id><object-id pub-id-type="publisher-id">figS4</object-id><label>Supplementary figure 4:</label><caption hwp:id="caption-8"><p hwp:id="p-87">JScandy view of ATCC 700669 reference genome (blue blocks at top genes on forward and reverse strands) and Manhattan plot of start positions of the 1 508 of 1 526 k-mers significantly associated with chloramphenicol resistance which map to the integrative conjugative element (ICE) Tn<italic toggle="yes">5253</italic>. The hits are all in within the ICE, and the most significant hits cluster around the <italic toggle="yes">cat</italic> gene (which is outlined in red).</p></caption><graphic xlink:href="038463_figS4" position="float" orientation="portrait" hwp:id="graphic-20"/></fig><fig id="figS5" position="float" orientation="portrait" fig-type="figure" hwp:id="F7" hwp:rev-id="xref-fig-7-1 xref-fig-7-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;038463v3/FIGS5</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F7</object-id><object-id pub-id-type="publisher-id">figS5</object-id><label>Supplementary figure 5:</label><caption hwp:id="caption-9"><p hwp:id="p-88">Neighbour joining tree from Chewapreecha <italic toggle="yes">et. al</italic>. study of 3069 Thai carriage <italic toggle="yes">S. pneumoniae</italic> samples, from a SNP alignment produced by mapping to the ATCC 700669 reference strain. Outer ring: red if resistant to Erythromycin, grey if sensitive.</p></caption><graphic xlink:href="038463_figS5" position="float" orientation="portrait" hwp:id="graphic-21"/></fig><fig id="figS6" position="float" orientation="portrait" fig-type="figure" hwp:id="F8" hwp:rev-id="xref-fig-8-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;038463v3/FIGS6</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F8</object-id><object-id pub-id-type="publisher-id">figS6</object-id><label>Supplementary figure 6:</label><caption hwp:id="caption-10"><p hwp:id="p-89">JSCandy view of S. pyogenes metadata on the right, showing whether isolates are invasive/non-invasive (orange/purple), presence of <italic toggle="yes">tetM</italic> (orange – absent, purple – present) and country of isolation (orange – Fiji, purple – Kilifi). Tree from a core genome alignment of all isolates is drawn on the left, with tips aligned to the metadata.</p></caption><graphic xlink:href="038463_figS6" position="float" orientation="portrait" hwp:id="graphic-22"/></fig><fig id="figS7" position="float" orientation="portrait" fig-type="figure" hwp:id="F9" hwp:rev-id="xref-fig-9-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;038463v3/FIGS7</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F9</object-id><object-id pub-id-type="publisher-id">figS7</object-id><label>Supplementary figure 7:</label><caption hwp:id="caption-11"><p hwp:id="p-90">JScandy view of <italic toggle="yes">S. pyogenes</italic> HKU488 reference genome (blue blocks at top genes on forward and reverse strands, <italic toggle="yes">tetM</italic> highlighted in red) and Manhattan plot of start positions of k-mers significantly associated with invasiveness when not adjusted for country of origin.</p></caption><graphic xlink:href="038463_figS7" position="float" orientation="portrait" hwp:id="graphic-23"/></fig><fig id="figS8" position="float" orientation="portrait" fig-type="figure" hwp:id="F10" hwp:rev-id="xref-fig-10-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;038463v3/FIGS8</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F10</object-id><object-id pub-id-type="publisher-id">figS8</object-id><label>Supplementary figure 8:</label><caption hwp:id="caption-12"><p hwp:id="p-91">As supplementary figure 7, except with the Manhattan plot showing p-values when adjusted for country of isolation. a) <italic toggle="yes">pepF</italic>; b) IgG binding protein H precursor.</p></caption><graphic xlink:href="038463_figS8" position="float" orientation="portrait" hwp:id="graphic-24"/></fig><fig id="figS9" position="float" orientation="portrait" fig-type="figure" hwp:id="F11" hwp:rev-id="xref-fig-11-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;038463v3/FIGS9</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F11</object-id><object-id pub-id-type="publisher-id">figS9</object-id><label>Supplementary figure 9:</label><caption hwp:id="caption-13"><p hwp:id="p-92">Scree plot for the first fifty dimensions of the 96 <italic toggle="yes">Listeria monocytogenes</italic> isolates (Supplementary figure 2) in red, 3 069 <italic toggle="yes">Streptococcus pneumoniae</italic> isolates (Supplementary figure 5) in blue, and 675 <italic toggle="yes">Streptococcus pyogenes</italic> isolates (Supplementary figures 6 and 7) in green.</p></caption><graphic xlink:href="038463_figS9" position="float" orientation="portrait" hwp:id="graphic-25"/></fig></sec></back></article>
