<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/015552</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;015552v2</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;015552</article-id><article-id pub-id-type="other" hwp:sub-type="slug">015552</article-id><article-id pub-id-type="other" hwp:sub-type="tag">015552</article-id><article-version>1.2</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Bioinformatics" hwp:journal="biorxiv"><subject>Bioinformatics</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">A complete bacterial genome assembled <italic toggle="yes">de novo</italic> using only nanopore sequencing data</article-title></title-group><author-notes hwp:id="author-notes-1"><corresp hwp:id="corresp-1">Correspondence and requests for materials should be addressed to JTS (email: <email hwp:id="email-1">Jared.Simpson@oicr.on.ca</email>)</corresp></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><name name-style="western" hwp:sortable="Loman Nicholas J."><surname>Loman</surname><given-names>Nicholas J.</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-2"><name name-style="western" hwp:sortable="Quick Joshua"><surname>Quick</surname><given-names>Joshua</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" corresp="yes" hwp:id="contrib-3"><name name-style="western" hwp:sortable="Simpson Jared T."><surname>Simpson</surname><given-names>Jared T.</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-1" hwp:rel-id="aff-2">2</xref></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2"><label>1</label> <institution hwp:id="institution-1">Institute of Microbiology and Infection, University of Birmingham</institution>, Birmingham, B15 2TT, <country>UK</country></aff><aff id="a2" hwp:id="aff-2" hwp:rev-id="xref-aff-2-1"><label>2</label> <institution hwp:id="institution-2">Ontario Institute for Cancer Research</institution>, Toronto, Ontario, <country>Canada</country></aff></contrib-group><pub-date pub-type="epub-original" hwp:start="2015"><year>2015</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2015-02-20T07:27:19-08:00">
    <day>20</day><month>2</month><year>2015</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2015-03-11T07:45:19-07:00">
    <day>11</day><month>3</month><year>2015</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2015-02-20T07:50:22-08:00">
    <day>20</day><month>2</month><year>2015</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2015-03-11T07:51:04-07:00">
    <day>11</day><month>3</month><year>2015</year>
  </pub-date><elocation-id>015552</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2015-02-20"><day>20</day><month>2</month><year>2015</year></date>
<date date-type="accepted" hwp:start="2015-03-11"><day>11</day><month>3</month><year>2015</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2015, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2015</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/" hwp:id="license-1"><p hwp:id="p-1">This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" hwp:id="ext-link-1">http://creativecommons.org/licenses/by/4.0/</ext-link></p></license></permissions><self-uri xlink:href="015552.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2019/pdf/015552v2.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="015552.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2019/abstracts/015552v2/015552v2.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2019/fulltext/015552v2/015552v2.htslp"/><abstract hwp:id="abstract-1"><p hwp:id="p-2">A method for <italic toggle="yes">de novo</italic> assembly of data from the Oxford Nanopore MinION instrument is presented which is able to reconstruct the sequence of an entire bacterial chromosome in a single contig. Initially, overlaps between nanopore reads are detected. Reads are then subjected to one or more rounds of error correction by a multiple alignment process employing partial order graphs. After correction, reads are assembled using the Celera assembler. Finally, the assembly is polished using signal-level data from the nanopore employing a novel hidden Markov model. We show that this method is able to assemble nanopore reads from <italic toggle="yes">Escherichia coli</italic> K-12 MG1655 into a single contig of length 4.6Mb permitting a full reconstruction of gene order. The resulting draft assembly has 98.4% nucleotide identity compared to the finished reference genome. After polishing the assembly with our signal-level HMM, the nucleotide identity is improved to 99.4%. We show that MinION sequencing data can be used to reconstruct genomes without the need for a reference sequence or data from other sequencing platforms.</p></abstract><counts><page-count count="30"/></counts><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-1">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta></front><body><p hwp:id="p-3">The Oxford Nanopore MinION is a portable, single molecule genome sequencing instrument no larger than a typical smartphone. As this instrument directly senses native, individual DNA fragments without the need for amplification, it is able to sequence extremely long fragments (&gt;10 kilobases) of DNA without a reduction in sequence quality <sup><xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">1</xref></sup>.</p><p hwp:id="p-4">The availability of very long reads is important when assembling genomes as they span repetitive elements and anchor repeat copies within uniquely occurring parts of the genome. Many bacterial genomes can be assembled into single contigs if reads greater than eight kilobases are available, as these reads span the conserved ribosomal RNA operon which is typically the longest repeat sequence in a bacterial genome<sup><xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">2</xref></sup>.</p><p hwp:id="p-5">The accuracy of the sequence reads is another potentially limiting step for genome assembly; at launch, data from the Pacific Biosciences sequencing instrument was hard to use for <italic toggle="yes">de novo</italic> assembly due to the lack of bioinformatics tools designed for long reads with a high error rate. Several algorithmic improvements have led to this platform becoming the gold standard for genome assembly; Koren <italic toggle="yes">et al.</italic> demonstrated that hybrid techniques could generate contiguous assemblies<sup><xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-1" hwp:rel-id="ref-3">3</xref></sup>. This method uses accurate short-read data, or Pacific Biosciences circular consensus reads, to correct error-prone long reads sufficiently for assembly<sup><xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">4</xref></sup>. Non-hybrid <italic toggle="yes">de novo</italic> assemblies of PacBio data in absence of short-read data remained an open problem until Chin <italic toggle="yes">et al.</italic> developed the HGAP (Hierarchical Genome-Assembly Process) assembler<sup><xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-1" hwp:rel-id="ref-5">5</xref></sup>. HGAP typically uses a subset of the longest reads in the sequencing data set to use as the input for the assembly process. This subset of long reads is corrected using the entire data set, and this corrected set of reads is assembled with the Celera Assembler. The final assembly is ‘polished’ using a signal-level consensus algorithm to high accuracy. This assembly strategy has revolutionized genome assembly of small genomes and is now being applied to large genomes<sup><xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-1" hwp:rel-id="ref-6">6</xref>,<xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">7</xref></sup>.</p><p hwp:id="p-6">Nanopore sequencing data has clear similarities to Pacific Biosciences data, with reads sufficiently long to be of great use in <italic toggle="yes">de novo</italic> assembly<sup><xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-2" hwp:rel-id="ref-7">7</xref>,<xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-1" hwp:rel-id="ref-8">8</xref></sup>. Recently, a hybrid approach to assembly which used Illumina short reads to correct nanopore reads prior to assembly was shown to give good results a bacterial and a yeast genome <sup><xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">9</xref></sup>. However, non-hybrid assemblies have not yet been described. Recent versions of nanopore chemistry (R7.3) coupled with the latest base caller (Metrichor ≥ 1.9) permits read-level accuracies of between 78-85%<sup><xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-2" hwp:rel-id="ref-1">1</xref>,<xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-2" hwp:rel-id="ref-8">8</xref></sup>. While this is slightly lower than the latest version of Pacific Biosciences chemistry<sup><xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-2" hwp:rel-id="ref-6">6</xref></sup>, we hypothesised that a similar assembly approach where nanopore data reads are self-corrected may result in highly contiguous assemblies.</p><p hwp:id="p-7">Overlaps can be detected more easily with higher accuracy data. Therefore for this study we exclusively used high-quality ”passing filter” two-direction (2D) reads. DNA strands which have been read in both directions by the MinION and combined during base-calling are higher quality than the individual template and complement strands <sup><xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-3" hwp:rel-id="ref-8">8</xref></sup>. All 2D reads from four separate MinION runs using R7.3 chemistry were combined. Each run was made using a freshly prepared sequencing library using library protocol SQK-MAP-003 (first run) or SQK-MAP-004 (three further runs). In total, 22,270 2D reads were used comprising 133.6Mb of read data, representing <sup>~</sup>29x theoretical coverage of the 4.6 megabase <italic toggle="yes">E. coli</italic> K-12 MG1655 reference genome (<xref ref-type="table" rid="tblS3" hwp:id="xref-table-wrap-3-1" hwp:rel-id="T3">Supplementary Table 3</xref>).</p><p hwp:id="p-8">The FASTA sequences for reads were extracted using <monospace>poretools</monospace><sup><xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-1" hwp:rel-id="ref-10">10</xref></sup>. Potential overlaps between the reads were detected using the <monospace>DALIGNER</monospace> software<sup><xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">11</xref></sup>. Each read and the reads it overlaps were used as input to the partial order aligner (<monospace>POA</monospace>) software<sup><xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">12</xref></sup>. <monospace>POA</monospace> uses a directed acyclic graph to compute a multiple alignment, which we use to determine a consensus sequence. The use of partial order graphs permits a more sensitive reconstruction of consensus sequences in the presence of large numbers of insertions or deletions. This step is analogous to the pre-correction step of the HGAP pipeline, which also uses partial order graphs (implemented in the <monospace>pbdagcon</monospace> software) to compute a consensus sequence. We run this correction process multiple times, using the corrected reads as the new input. The results of this correction process increased the mean percentage identity from 80.5% to 95.9% after the first iteration and 97.7% on the second iteration (<xref ref-type="fig" rid="figS7" hwp:id="xref-fig-9-1" hwp:rel-id="F9">Supplementary Figure 7</xref>).</p><p hwp:id="p-9">The reads resulting from two rounds of correction were used as input to version 8.2 of the Celera Assembler<sup><xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">13</xref></sup>. The Celera Assembler was run with settings specified in <xref ref-type="fig" rid="figS8" hwp:id="xref-fig-10-1" hwp:rel-id="F10">Supplementary Figure 8</xref>. The critical parameter for tuning is the overlap minimum identity, which should be double the raw read error rate, in this case set to 6% (<monospace>ovlMinIdentity=0.06</monospace>). This resulted in a highly contiguous assembly with four contigs, the largest being of length 4.6Mb and covering the entire <italic toggle="yes">E. coli</italic> chromosome (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Figure 1</xref>). The other three contigs were small (6-15kb) and their sequences were present in the long contig and so we did not include them in further analysis.
<fig id="fig1" position="float" orientation="portrait" fig-type="figure" hwp:id="F1" hwp:rev-id="xref-fig-1-1 xref-fig-1-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;015552v2/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Figure 1:</label><caption hwp:id="caption-1"><p hwp:id="p-10">Single contig assembly of <italic toggle="yes">E. coli</italic> K-12 MG1655. Panel A shows a dot-plot comparing the assembly presented here with the reference genome. Panel B shows read coverage as a histogram when nanopore reads are aligned against the assembled genome. Panel C shows read coverage and GC composition across the length of the assembled genome. Panel D shows an illustrative view of the read coverage for a randomly chosen section of the assembly genome and the underlying reads used to construct the assembly as viewed in the genome assembly tool Tablet <sup><xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">15</xref></sup>.</p></caption><graphic xlink:href="015552_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig></p><p hwp:id="p-11">The initial draft assembly has 3,949 mismatches (85 per 100kb) and 47,395 indels of ≥1 base (1,021 errors per 100kb), as determined by the QUAST validation tool when compared to the <italic toggle="yes">E. coli</italic> K-12 MG1655 reference genome (NC_000913.3)<sup><xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">14</xref></sup>.</p><p hwp:id="p-12">We computed a new consensus sequence for the assembly using a hidden Markov model that takes the electric current signals emitted by the MinION as input. This algorithm is described in the <xref ref-type="sec" rid="s2" hwp:id="xref-sec-2-1" hwp:rel-id="sec-2">supplementary methods</xref>. After polishing the assembly using this algorithm the base-level accuracy improved to 99.4%, comprising 1,532 mismatches (33 per 100kb) and 18,387 indels of ≥1 base (396 errors per 100kb).</p><p hwp:id="p-13">We explored the sequence context of errors in our assemblies before and after polishing by comparing 5-mer counts between our assemblies and the reference genome. Our initial draft assembly displayed significant under-representation of poly-nucleotide tracts (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-1" hwp:rel-id="F2">Figure 2</xref>, top panels). This error mode is expected as the MinION relies on a change in electric current to detect base-to-base transitions, which may not occur or may not be detectable as locally repetitive sequence transits the pore. After polishing the assembly the representation of poly-nucleotide tracts improves and the 5-mer counts between the reference genome and the polished assembly are well-correlated (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-2" hwp:rel-id="F2">Figure 2</xref>, bottom panels).
<fig id="fig2" position="float" orientation="portrait" fig-type="figure" hwp:id="F2" hwp:rev-id="xref-fig-2-1 xref-fig-2-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;015552v2/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Figure 2:</label><caption hwp:id="caption-2"><p hwp:id="p-14">The left panels show the correlation between 5-mer counts in the reference (x-axis) and an assembly (y-axis). The upper left panel is the assembly before signal-level polishing and the lower left panel is after signal-level polishing. The 5-mer counts are well-correlated between the reference and polished assembly (Pearson’s <italic toggle="yes">r</italic> = 0.99). To explore under-representation of 5-mers, we identified sequences where the reference genome had ≥50% more occurrences than the unpolished assembly (red points in the left panels, grouped bars in the right panels). This indicated that the most under-represented 5-mers in our unpolished assembly are those that consist of a single base (<monospace>TTTTT, AAAAA, CCCCC, GGGGG</monospace>) or contain a 4-base stretch of a single base (all others, top right panel). After polishing the representation of these difficult motifs is improved (bottom right panel) although <monospace>TTTTT</monospace> and <monospace>AAAAA</monospace> remain difficult. In the right panels the bars are ordered by reference occurrence count.</p></caption><graphic xlink:href="015552_fig2" position="float" orientation="portrait" hwp:id="graphic-2"/></fig>
</p><p hwp:id="p-15">QUAST reported two misassemblies with respect to the reference sequence. On visual inspection of an alignment generated by the Mauve software we determined one large (&gt;500 base) region of difference between our assembly and the reference representing an insertion of a transposase-encoding region into our assembly. This sequence (approximately 750 bases long) is present nine times in the reference genome. Insertion events involving transposons are common in bacterial genomes and can affect wild-type strains commonly used in laboratory experiments, but are difficult to detect using draft assemblies from short-read sequencing technologies.</p><p hwp:id="p-16">We conclude that long read data from the Oxford Nanopore MinION can be used to assemble complete bacterial genomes to give an accurate reconstruction of gene order and orientation, without the need to use data from other sequencing technologies. Using signal-level algorithms we are able to improve the per-base accuracy of our assembly further. However, poly-nucleotide tracts remain error-prone. We have not evaluated the impact of increasing sequencing coverage above 30x on accuracy. We expect that improved probabilistic models of the data, possibly incorporating fragment translocation duration information, may result in higher accuracy. The read error correction software, <monospace>nanocorrect</monospace>, is available at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://https://github.com/jts/nanocorrect" ext-link-type="uri" xlink:href="http://https://github.com/jts/nanocorrect" hwp:id="ext-link-2">https://github.com/jts/nanocorrect</ext-link>. The signal-level consensus software, <monospace>nanopolish</monospace> is available at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://https://github.com/jts/nanopolish" ext-link-type="uri" xlink:href="http://https://github.com/jts/nanopolish" hwp:id="ext-link-3">https://github.com/jts/nanopolish</ext-link>. Both programs are freely available under the open-source MIT license.</p></body><back><ref-list hwp:id="ref-list-1"><title hwp:id="title-1">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1 xref-ref-1-2"><label>1.</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.1" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Jain M."><surname>Jain</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-2">Improved data analysis for the MinION nanopore sequencer</article-title>. <source hwp:id="source-1">Nat. Methods</source> (<year>2015</year>).</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1"><label>2.</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="Koren S."><surname>Koren</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-3">Reducing assembly complexity of microbial genomes with single-molecule sequencing</article-title>. <source hwp:id="source-2">Genome Biol</source> <volume>14</volume>, <fpage>R101</fpage> (<year>2013</year>).</citation></ref><ref id="c3" hwp:id="ref-3" hwp:rev-id="xref-ref-3-1"><label>3.</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.3" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Koren S."><surname>Koren</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-4">Hybrid error correction and de novo assembly of single-molecule sequencing reads</article-title>. <source hwp:id="source-3">Nature biotechnology</source> <volume>30</volume>, <fpage>693</fpage>–<lpage>700</lpage> (<year>2012</year>).</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1"><label>4.</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.4" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Rasko D. A."><surname>Rasko</surname>, <given-names>D. A.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-5">Origins of the e. coli strain causing an outbreak of hemolytic–uremic syndrome in germany</article-title>. <source hwp:id="source-4">New England Journal of Medicine</source> <volume>365</volume>, <fpage>709</fpage>–<lpage>717</lpage> (<year>2011</year>).</citation></ref><ref id="c5" hwp:id="ref-5" hwp:rev-id="xref-ref-5-1"><label>5.</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.5" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Chin C.-S."><surname>Chin</surname>, <given-names>C.-S.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-6">Nonhybrid, finished microbial genome assemblies from long-read smrt sequencing data</article-title>. <source hwp:id="source-5">Nature methods</source> <volume>10</volume>, <fpage>563</fpage>–<lpage>569</lpage> (<year>2013</year>).</citation></ref><ref id="c6" hwp:id="ref-6" hwp:rev-id="xref-ref-6-1 xref-ref-6-2"><label>6.</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.6" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Kim K. E."><surname>Kim</surname>, <given-names>K. E.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-7">Long-read, whole-genome shotgun sequence data for five model organisms</article-title>. <source hwp:id="source-6">Scientific Data</source> <volume>1</volume> (<year>2014</year>).</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1 xref-ref-7-2"><label>7.</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.7" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Koren S."><surname>Koren</surname>, <given-names>S.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Phillippy A. M."><surname>Phillippy</surname>, <given-names>A. M.</given-names></string-name> <article-title hwp:id="article-title-8">One chromosome, one contig: complete microbial genomes from long-read sequencing and assembly</article-title>. <source hwp:id="source-7">Current opinion in microbiology</source> <volume>23</volume>, <fpage>110</fpage>–<lpage>120</lpage> (<year>2015</year>).</citation></ref><ref id="c8" hwp:id="ref-8" hwp:rev-id="xref-ref-8-1 xref-ref-8-2 xref-ref-8-3"><label>8.</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Quick J."><surname>Quick</surname>, <given-names>J.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Quinlan A. R."><surname>Quinlan</surname>, <given-names>A. R.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Loman N. J."><surname>Loman</surname>, <given-names>N. J.</given-names></string-name> <article-title hwp:id="article-title-9">A reference bacterial genome dataset generated on the MinION portable single-molecule nanopore sequencer</article-title>. <source hwp:id="source-8">Gigascience</source> <volume>3</volume>, <fpage>22</fpage> (<year>2014</year>).</citation></ref><ref id="c9" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1"><label>9.</label><citation publication-type="other" citation-type="journal" ref:id="015552v2.9" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Goodwin S."><surname>Goodwin</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <source hwp:id="source-9">Oxford nanopore sequencing and de novo assembly of a eukaryotic genome</source>. <italic toggle="yes">bioRxiv</italic> 013490 (<year>2015</year>).</citation></ref><ref id="c10" hwp:id="ref-10" hwp:rev-id="xref-ref-10-1"><label>10.</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="Loman N. J."><surname>Loman</surname>, <given-names>N. J.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Quinlan A. R."><surname>Quinlan</surname>, <given-names>A. R.</given-names></string-name> <article-title hwp:id="article-title-10">Poretools: a toolkit for analyzing nanopore sequence data</article-title>. <source hwp:id="source-10">Bioinformatics</source> <volume>30</volume>, <fpage>3399</fpage>–<lpage>3401</lpage> (<year>2014</year>).</citation></ref><ref id="c11" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1"><label>11.</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.11" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="Myers G."><surname>Myers</surname>, <given-names>G.</given-names></string-name> <source hwp:id="source-11">Efficient local alignment discovery amongst noisy long reads</source> <volume>8701</volume>, <fpage>52</fpage>–<lpage>67</lpage> (<year>2014</year>). URL <monospace><ext-link l:rel="related" l:ref-type="uri" l:ref="http://dx.doi.org/10.1007/978-3-662-44753-6_5" ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-3-662-44753-6_5" hwp:id="ext-link-4">http://dx.doi.org/10.1007/978-3-662-44753-6_5</ext-link>.</monospace></citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1"><label>12.</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.12" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Lee C."><surname>Lee</surname>, <given-names>C.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Grasso C."><surname>Grasso</surname>, <given-names>C.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Sharlow M. F."><surname>Sharlow</surname>, <given-names>M. F.</given-names></string-name> <article-title hwp:id="article-title-11">Multiple sequence alignment using partial order graphs</article-title>. <source hwp:id="source-12">Bioinformatics</source> <volume>18</volume>, <fpage>452</fpage>–<lpage>464</lpage> (<year>2002</year>).</citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1"><label>13.</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.13" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="Myers E. W."><surname>Myers</surname>, <given-names>E. W.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-12">A whole-genome assembly of drosophila</article-title>. <source hwp:id="source-13">Science</source> <volume>287</volume>, <fpage>2196</fpage>–<lpage>2204</lpage> (<year>2000</year>).</citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1"><label>14.</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.14" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Gurevich A."><surname>Gurevich</surname>, <given-names>A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Saveliev V."><surname>Saveliev</surname>, <given-names>V.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Vyahhi N."><surname>Vyahhi</surname>, <given-names>N.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Tesler G."><surname>Tesler</surname>, <given-names>G.</given-names></string-name> <article-title hwp:id="article-title-13">Quast: quality assessment tool for genome assemblies</article-title>. <source hwp:id="source-14">Bioinformatics</source> <volume>29</volume>, <fpage>1072</fpage>–<lpage>1075</lpage> (<year>2013</year>).</citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1"><label>15.</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.15" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Milne I."><surname>Milne</surname>, <given-names>I.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-14">Using tablet for visual exploration of second-generation sequencing data</article-title>. <source hwp:id="source-15">Briefings in bioinformatics</source> bbs012 (<year>2012</year>).</citation></ref></ref-list><ack hwp:id="ack-1"><title hwp:id="title-2">Acknowledgements</title><p hwp:id="p-17">Data analysis was performed on the Medical Research Council Cloud Infrastructure for Microbial Bioinformatics (CLIMB) cyberinfrastructure. NJL is funded by a Medical Research Council Special Training Fellowship in Biomedical Informatics. JQ is funded by the NIHR Surgical Reconstruction and Microbiology Research Centre. JTS is supported by the Ontario Institute for Cancer Research through funding provided by the Government of Ontario. We are grateful for the staff of Oxford Nanopore for technical help and advice during the MinION Access Programme. We are grateful to the EU COST action ES1103 for funding the authors to attend a hackathon that kickstarted the work presented here. The authors thank Leopold Parts for comments on the manuscript.</p></ack><sec id="s1" sec-type="COI-statement" hwp:id="sec-1"><title hwp:id="title-3">Competing Interests</title><p hwp:id="p-18">NJL is a member of the MinION Access Programme (MAP) and has received freeof-charge reagents for nanopore sequencing presented in this study. JQ has received travel and accommodation expenses to speak at an Oxford Nanopore-organised symposium. NJL and JQ have ongoing research collaborations with Oxford Nanopore but do not receive financial compensation for this.</p></sec><sec id="s2" sec-type="supplementary-material" hwp:id="sec-2" hwp:rev-id="xref-sec-2-1"><label>1</label><title hwp:id="title-4">Supplementary Methods</title><sec id="s2a" hwp:id="sec-3"><label>1.1</label><title hwp:id="title-5">Assembly Pipeline</title><p hwp:id="p-19">All the steps described here are additionally documented as an IPython notebook at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://https://github.com/jts/nanopore-paper-analysis" ext-link-type="uri" xlink:href="http://https://github.com/jts/nanopore-paper-analysis" hwp:id="ext-link-5">https://github.com/jts/nanopore-paper-analysis</ext-link> along with the additional scripts to reproduce the analysis presented in this manuscript.</p><sec id="s2a1" hwp:id="sec-4"><title hwp:id="title-6">Read preprocessing</title><p hwp:id="p-20">The <monospace>DALIGNER</monospace> program was designed for Pacific Biosciences data and expects the input reads to be provided in FASTA format with metadata encoded in the read name. To allow <monospace>DALIGNER</monospace> to be run on nanopore data, we wrote a program <monospace>preprocess.pl</monospace> to convert the FASTA output of <monospace>poretools</monospace> into the format expected by <monospace>DALIGNER</monospace>.</p></sec><sec id="s2a2" hwp:id="sec-5"><title hwp:id="title-7">Error Correction</title><p hwp:id="p-21">We ran <monospace>DALIGNER</monospace> on the input reads using default parameters and the procedure described in the documentation to compute read-read overlaps. For each input read, <italic toggle="yes">A,</italic> we queried the <monospace>DALIGNER</monospace> overlap database to extract the set of reads overlapping <italic toggle="yes">A.</italic> For each read overlapping <italic toggle="yes">A,</italic> we trimmed it to the coordinates matching <italic toggle="yes">A</italic> (as reported by <monospace>DALIGNER</monospace>) and reverse complemented the sequence if necessary to make the read match the strand of <italic toggle="yes">A.</italic> This set of strand-matched subsequences were written to a FASTA file along with the sequence of <italic toggle="yes">A.</italic> This was the input to <monospace>POA</monospace>, which was run with parameters <monospace>–hb –clustal</monospace> using the BLOSUM80 sequence similarity matrix.</p><p hwp:id="p-22">The consensus sequence was parsed from the clustal-formatted multiple alignment. We first computed the read depth at each column of the multiple alignment. We then trimmed the multiple alignment by excluding any leading and trailing columns that had depth less than 3. This trimming step is designed to remove uncorrected or unreliable regions of the multiple alignment, which may impact the quality of the downstream assembly. We reported the first consensus record calculated by <monospace>POA</monospace> (labeled ‘CONSENS0’) over the trimmed region as the consensus sequence for the read.</p></sec><sec id="s2a3" hwp:id="sec-6"><title hwp:id="title-8">Genome Assembly</title><p hwp:id="p-23">After two rounds of error correction we assembled the reads using v8.2 of the Celera Assembly with the parameters file described in <xref ref-type="fig" rid="figS8" hwp:id="xref-fig-10-2" hwp:rel-id="F10">Figure 8</xref>. The position in the large contig corresponding to the <italic toggle="yes">E. coli</italic> origin of replication was determined through a BLAST homology search for the first 1000 bases of the reference genome, and the contig was circularised using the <monospace>minimus2</monospace> package in AMOS [<xref ref-type="bibr" rid="c27" hwp:id="xref-ref-27-1" hwp:rel-id="ref-27">12</xref>] by the introduction of an artificial contig break. <monospace>Minimus2</monospace> relies on the <monospace>nucmer</monospace> component of MUMMER [<xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-1" hwp:rel-id="ref-19">4</xref>] to perform the initial overlap alignments.</p></sec></sec><sec id="s2b" hwp:id="sec-7"><label>1.2</label><title hwp:id="title-9">Signal-level Consensus Algorithm</title><p hwp:id="p-24">The electrical current signal sampled by the MinION inherently contains more information than the base-called reads. We sought to use this information when computing the final consensus sequence of our assembly. In this section we describe our consensus algorithm. We first give a brief overview of the algorithm. We start with our initial draft assembly, <italic toggle="yes">G,</italic> and progressively modify it by making small localized changes. We assess whether the modified sequence, <italic toggle="yes">G</italic>′, increases the probability of the electrical current data for a set of reads. If the probability of the signal data increases we accept <italic toggle="yes">G</italic>′ and iterate. To make these calculations computationally feasible, this process is run over short segments of the genome and seeded by reads aligned to <italic toggle="yes">G.</italic> At the core of this algorithm is calculating the probability of the raw signal data emitted by the MinION given a proposed consensus sequence. We first describe our probabilistic model of the data, then describe how we use this model to compute the consensus sequence for the assembly.</p><sec id="s2b1" hwp:id="sec-8"><title hwp:id="title-10">Signal-level MinION Data</title><p hwp:id="p-25">The MinION continuously samples electrical current flow across the pore. When DNA is detected in the pore, these current samples are turned into <italic toggle="yes">events</italic> by a feature detection algorithm provided by the instrument’s software. The feature detection algorithm is designed to find stepwise changes in the current signal that indicate that the DNA sequence has moved through the pore. For each event the feature detection algorithm records the mean of the current samples (in picoamps), its standard deviation and the total duration of the event (in seconds). Simulated idealized data to illustrate these concepts is shown in <xref ref-type="fig" rid="figS1" hwp:id="xref-fig-3-1" hwp:rel-id="F3">Figure 1</xref> and <xref ref-type="table" rid="tblS1" hwp:id="xref-table-wrap-1-1" hwp:rel-id="T1">Table 1</xref>.</p><p hwp:id="p-26">We only use the mean current level in our model but remark that the duration and standard deviation are sources of information that should be considered in future work. When we refer to individual events <italic toggle="yes">e<sub>i</sub></italic> below we are referring to the mean current level component of the event only. For the purpose of our consensus algorithm, we consider a MinION read to be a sequence of events (<italic toggle="yes">e</italic><sub>1</sub><italic toggle="yes">, e</italic><sub>2</sub>,…, <italic toggle="yes">e<sub>n</sub></italic>).
<fig id="figS1" position="float" orientation="portrait" fig-type="figure" hwp:id="F3" hwp:rev-id="xref-fig-3-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;015552v2/FIGS1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F3</object-id><object-id pub-id-type="publisher-id">figS1</object-id><label>Supplementary Figure 1:</label><caption hwp:id="caption-3"><p hwp:id="p-27">Simulated ideal signal data to illustrate the data that is input into our model. The black points are sampled current levels at a given time. The red lines are the events detected by a feature detection algorithm, which partitions the samples into discrete segments.</p></caption><graphic xlink:href="015552_figS1" position="float" orientation="portrait" hwp:id="graphic-3"/></fig>
</p></sec><sec id="s2b2" hwp:id="sec-9"><title hwp:id="title-11">Modeling Events</title><p hwp:id="p-28">The fundamental principle of nanopore-based sequencing is that the amount of current flow through the pore depends on the sequence of DNA that resides in the pore [<xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-1" hwp:rel-id="ref-22">7</xref>, <xref ref-type="bibr" rid="c26" hwp:id="xref-ref-26-1" hwp:rel-id="ref-26">11</xref>]. The MinION model assumes that the current level measured for each event is drawn from a Gaussian distribution with mean and variance dependent on the 5-mer sequence that is in the pore when the samples are taken. Oxford Nanopore provides the parameters for the Gaussians for all 5-mers. We refer to this collection of parameters as <bold>Θ.</bold> The probability of observing event <italic toggle="yes">e<sub>i</sub></italic> given that 5-mer <italic toggle="yes">k</italic> is the true sequence in the pore is <inline-formula hwp:id="inline-formula-1"><alternatives hwp:id="alternatives-1"><inline-graphic xlink:href="015552_inline1.gif" hwp:id="inline-graphic-1"/></alternatives></inline-formula>.
<table-wrap id="tblS1" position="float" orientation="portrait" hwp:id="T1" hwp:rev-id="xref-table-wrap-1-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;015552v2/TBLS1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T1</object-id><object-id pub-id-type="publisher-id">tblS1</object-id><label>Supplementary Table 1:</label><caption hwp:id="caption-4"><p hwp:id="p-29">Events detected from the idealized example shown in <xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-2" hwp:rel-id="F1">Figure 1</xref>.</p></caption><graphic xlink:href="015552_tblS1" position="float" orientation="portrait" hwp:id="graphic-4"/></table-wrap>
</p></sec><sec id="s2b3" hwp:id="sec-10"><title hwp:id="title-12">A Probabilistic Model of MinION Events</title><p hwp:id="p-30">We want to calculate the probability of observing an event sequence given a known DNA sequence <italic toggle="yes">S</italic>, <italic toggle="yes">P</italic>(<italic toggle="yes">e</italic><sub>1</sub>, <italic toggle="yes">e</italic><sub>2</sub>,…, <italic toggle="yes">e<sub>n</sub></italic>|<italic toggle="yes">S</italic>, <bold>Θ</bold>). To do this, we represent the known DNA sequence <italic toggle="yes">S</italic> as its constituent 5-mers, <italic toggle="yes">S</italic> = (<italic toggle="yes">s</italic><sub>1</sub>, <italic toggle="yes">s</italic><sub>2</sub>,…, <italic toggle="yes">s<sub>m</sub></italic>). The simplest generative model of the data is where the sequencer moves stepwise from 5-mer to 5-mer, and emits a single event from each 5-mer. This situation is depicted in <xref ref-type="fig" rid="figS2" hwp:id="xref-fig-4-1" hwp:rel-id="F4">Figure 2</xref>.
<fig id="figS2" position="float" orientation="portrait" fig-type="figure" hwp:id="F4" hwp:rev-id="xref-fig-4-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;015552v2/FIGS2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F4</object-id><object-id pub-id-type="publisher-id">figS2</object-id><label>Supplementary Figure 2:</label><caption hwp:id="caption-5"><p hwp:id="p-31">A simple model where each 5-mer (grey circles) emits a single event (blue circles).</p></caption><graphic xlink:href="015552_figS2" position="float" orientation="portrait" hwp:id="graphic-5"/></fig>
</p><p hwp:id="p-32">In this situation, where there is a perfect one-to-one match between events and 5-mers, calculating the probability of the data is straightforward if we assume independence between events:
<disp-formula id="eqn1" hwp:id="disp-formula-1"><alternatives hwp:id="alternatives-2"><graphic xlink:href="015552_eqn1.gif" position="float" orientation="portrait" hwp:id="graphic-6"/></alternatives></disp-formula></p><p hwp:id="p-33">In reality however, we need to account for two types of event detection errors: <italic toggle="yes">skipped</italic> 5-mers, where the system does not detect an event for a 5-mer that transited the pore, and <italic toggle="yes">split events,</italic> where the signal for a single 5-mer is emitted multiple times, presumably because of transient noise that exceeds the event detection threshold.</p><p hwp:id="p-34">In this situation, we no longer know which 5-mer emitted each event. To provide motivation for our model we will describe an example from the more complex generative process. Let <italic toggle="yes">S</italic> = (<monospace>ACGTA</monospace>, <monospace>CGTAA</monospace>, <monospace>GTAAC</monospace>, <monospace>TAACT</monospace>) be the 5-mers of the known DNA sequence. The process starts at the first 5-mer of <italic toggle="yes">S,</italic> <monospace>ACGTA</monospace>, and emits an event drawn from <inline-formula hwp:id="inline-formula-2"><alternatives hwp:id="alternatives-3"><inline-graphic xlink:href="015552_inline2.gif" hwp:id="inline-graphic-2"/></alternatives></inline-formula>. We then choose to stay at <monospace>ACGTA</monospace>, move to the next 5-mer, <monospace>CGTAA</monospace>, or skip <monospace>CGTAA</monospace> and move directly to <monospace>GTAAC</monospace>. Once a move has been made we can emit another event drawn from the appropriate Gaussian and repeat until we reach the end of the sequence. We can model this process using a hidden Markov model with the structure shown in <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-5-1" hwp:rel-id="F5">Figure 3</xref>.
<fig id="figS3" position="float" orientation="portrait" fig-type="figure" hwp:id="F5" hwp:rev-id="xref-fig-5-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;015552v2/FIGS3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F5</object-id><object-id pub-id-type="publisher-id">figS3</object-id><label>Supplementary Figure 3:</label><caption hwp:id="caption-6"><p hwp:id="p-35">A hidden Markov model allowing self-transitions and jumps over states. This allows us to model split and skipped events.</p></caption><graphic xlink:href="015552_figS3" position="float" orientation="portrait" hwp:id="graphic-7"/></fig></p><p hwp:id="p-36">We will treat the path through the model as the hidden state of the system, <italic toggle="yes">π</italic>, where each entry is a pair <italic toggle="yes">π<sub>i</sub></italic> = (<italic toggle="yes">i</italic>, <italic toggle="yes">s<sub>j</sub></italic>) which denotes that at step <italic toggle="yes">i</italic> the system emitted event <italic toggle="yes">i</italic> from 5-mer <italic toggle="yes">s<sub>j</sub></italic>. We denote the transition probabilities with <italic toggle="yes">P</italic>(<italic toggle="yes">π<sub>i</sub></italic>|<italic toggle="yes">π<sub>i</sub></italic><sub>−1</sub>, <italic toggle="yes">S</italic>) and for convenience define an initial transition <italic toggle="yes">P</italic>(<italic toggle="yes">π</italic><sub>1</sub> = (1, <italic toggle="yes">s</italic><sub>1</sub>)|<italic toggle="yes">π</italic><sub>0</sub>, <italic toggle="yes">S</italic>) = 1. We can then calculate the joint probability of a path and the data:
<disp-formula id="eqn2" hwp:id="disp-formula-2"><alternatives hwp:id="alternatives-4"><graphic xlink:href="015552_eqn2.gif" position="float" orientation="portrait" hwp:id="graphic-8"/></alternatives></disp-formula></p><p hwp:id="p-37">We can calculate the probability of the data given <italic toggle="yes">S</italic> by summing over all possible paths using the Forward algorithm:
<disp-formula id="eqn3" hwp:id="disp-formula-3"><alternatives hwp:id="alternatives-5"><graphic xlink:href="015552_eqn3.gif" position="float" orientation="portrait" hwp:id="graphic-9"/></alternatives></disp-formula></p><p hwp:id="p-38">The structure of the model and transition probabilities are implied by the 5-mer sequence <italic toggle="yes">S</italic> as described later.</p></sec><sec id="s2b4" hwp:id="sec-11"><title hwp:id="title-13">Profile HMM of Events and 5-mer in the Pore</title><p hwp:id="p-39">The model drawn above only allows single 5-mers to be skipped. We could add transitions between more distant 5-mers to allow longer jumps but this increases the computational cost to compute <italic toggle="yes">P</italic>(<italic toggle="yes">e</italic><sub>1</sub>, <italic toggle="yes">e</italic><sub>2</sub>,…, <italic toggle="yes">e<sub>n</sub></italic>|<italic toggle="yes">S</italic>, <bold>Θ</bold>) [<xref ref-type="bibr" rid="c20" hwp:id="xref-ref-20-1" hwp:rel-id="ref-20">5</xref>]. To allow a similar description of the data in a more computationally convienent structure we can convert this model into a standard Profile HMM. The Profile HMM we use is shown in <xref ref-type="fig" rid="figS4" hwp:id="xref-fig-6-1" hwp:rel-id="F6">Figure 4</xref>.</p><p hwp:id="p-40">The Profile HMM expands the state space to include explicit states for extra events emitted by any 5-mer (<italic toggle="yes">E</italic> states) and silent states that allow 5-mers to be visited without observing an event (<italic toggle="yes">K</italic> states). This model has a repeating block structure with 3 states for every 5-mer in <italic toggle="yes">S.</italic> Each state in a block is indexed by the block’s corresponding 5-mer.</p><p hwp:id="p-41">A path <italic toggle="yes">π</italic> through this model consists of states that emit events (incrementing the event index, states <italic toggle="yes">M</italic> and <italic toggle="yes">E</italic>) and states that move from 5-mer to 5-mer (incrementing the 5-mer index, states <italic toggle="yes">M</italic> and <italic toggle="yes">K</italic>). Each entry in the path <italic toggle="yes">π</italic> is again represented as a pair <italic toggle="yes">π<sub>k</sub></italic> = (<italic toggle="yes">i</italic>, <italic toggle="yes">X</italic>) where <italic toggle="yes">i</italic> is the index of the last event emitted by the path and <inline-formula hwp:id="inline-formula-3"><alternatives hwp:id="alternatives-6"><inline-graphic xlink:href="015552_inline3.gif" hwp:id="inline-graphic-3"/></alternatives></inline-formula>. When describing transition probabilities we will use the notation <inline-formula hwp:id="inline-formula-4"><alternatives hwp:id="alternatives-7"><inline-graphic xlink:href="015552_inline4.gif" hwp:id="inline-graphic-4"/></alternatives></inline-formula> to mean <inline-formula hwp:id="inline-formula-5"><alternatives hwp:id="alternatives-8"><inline-graphic xlink:href="015552_inline5.gif" hwp:id="inline-graphic-5"/></alternatives></inline-formula> and so on.</p><p hwp:id="p-42">To calculate the probability <italic toggle="yes">P</italic>(<italic toggle="yes">e</italic><sub>1</sub>, <italic toggle="yes">e</italic><sub>2</sub>,…, <italic toggle="yes">e<sub>n</sub></italic>|<italic toggle="yes">S</italic>, <bold>Θ</bold>) we again use the Forward algorithm which fills in a dynamic programming matrix of size 3<italic toggle="yes">mn</italic> to sum over all paths through the model. We refer the reader to section 5.4 of Durbin et al. [<xref ref-type="bibr" rid="c20" hwp:id="xref-ref-20-2" hwp:rel-id="ref-20">5</xref>] for the recursive definition of the dynamic programming matrix for a Profile HMM.
<fig id="figS4" position="float" orientation="portrait" fig-type="figure" hwp:id="F6" hwp:rev-id="xref-fig-6-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;015552v2/FIGS4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F6</object-id><object-id pub-id-type="publisher-id">figS4</object-id><label>Supplementary Figure 4:</label><caption hwp:id="caption-7"><p hwp:id="p-43">The state structure of the Profile Hidden Markov Model we use to calculate the probability of a sequence of events given a known sequence.</p></caption><graphic xlink:href="015552_figS4" position="float" orientation="portrait" hwp:id="graphic-10"/></fig></p></sec><sec id="s2b5" hwp:id="sec-12"><title hwp:id="title-14">Transition Probabilities</title><p hwp:id="p-44">The transition probabilities of the model are crucial to capturing the behaviour of the pore. Most importantly, we must accurately model the probability of not observing a signal for a particular 5-mer. If the signals for two adjacent 5-mers, <italic toggle="yes">s<sub>i</sub></italic><sub>−1</sub> and <italic toggle="yes">s<sub>i</sub></italic>, are similar the feature detection algorithm may not register a change in current. To make this explicit, consider the situation where the sequenced DNA is <monospace>GAAAAAAC</monospace>. There is no chance to register the <monospace>AAAAA</monospace> → <monospace>AAAAA</monospace> transition as the current signals for these 5-mers are identical by definition. Therefore the probability of an event sequence generated by <italic toggle="yes">S</italic> given two candidate sequences <italic toggle="yes">S</italic><sub>1</sub> = <monospace>GAAAAAAC</monospace> and <italic toggle="yes">S</italic><sub>2</sub> = <monospace>GAAAAAC</monospace>, which only differ by the undetectable length of the poly-A run, should be very similar, <italic toggle="yes">P</italic>(<italic toggle="yes">e</italic><sub>1</sub>, <italic toggle="yes">e</italic><sub>2</sub>,…, <italic toggle="yes">e<sub>n</sub></italic>|<italic toggle="yes">S</italic><sub>1</sub>, <bold>Θ</bold>) ≈ <italic toggle="yes">P</italic>(<italic toggle="yes">e</italic><sub>1</sub>, <italic toggle="yes">e</italic><sub>2</sub>,…, <italic toggle="yes">e<sub>n</sub></italic>|<italic toggle="yes">S</italic><sub>2</sub>, <bold>Θ</bold>).</p><p hwp:id="p-45">We model this by making the transition probability to <italic toggle="yes">K</italic> states a function of the absolute difference between expected current for the adjacent 5-mers <inline-formula hwp:id="inline-formula-6"><alternatives hwp:id="alternatives-9"><inline-graphic xlink:href="015552_inline6.gif" hwp:id="inline-graphic-6"/></alternatives></inline-formula>. We use a lookup table for <italic toggle="yes">f</italic> that was calculated from a sample of reads matched to an earlier draft assembly. The lookup table stores probabilities in bins of 0.5 pA.</p><p hwp:id="p-46">While the majority of skipped 5-mers are due to signal similarity, we also observe skips of 5-mers whose signal differs substantially from the preceding 5-mer. These occurrences are presumably due to events that were too short to reliably detect and hence discarded by the feature detection algorithm.</p><p hwp:id="p-47">The probability of transitioning to an <italic toggle="yes">E</italic> state is independent of the 5-mer. Similar to the <italic toggle="yes">f</italic> table, we learned the probability of emitting an additional event <italic toggle="yes">p<sub>me</sub></italic> from a sample of reads. We calculate <inline-formula hwp:id="inline-formula-7"><alternatives hwp:id="alternatives-10"><inline-graphic xlink:href="015552_inline7.gif" hwp:id="inline-graphic-7"/></alternatives></inline-formula> using <italic toggle="yes">p<sub>me</sub></italic> and the probability of not transitioning to the <italic toggle="yes">K</italic> state:
<disp-formula hwp:id="disp-formula-4"><alternatives hwp:id="alternatives-11"><graphic xlink:href="015552_ueqn1.gif" position="float" orientation="portrait" hwp:id="graphic-11"/></alternatives></disp-formula></p><p hwp:id="p-48">We also estimated the probability of staying in the <italic toggle="yes">E</italic> state, <italic toggle="yes">p<sub>ee</sub></italic>, from the same sample of reads and set <inline-formula hwp:id="inline-formula-8"><alternatives hwp:id="alternatives-12"><inline-graphic xlink:href="015552_inline24.gif" hwp:id="inline-graphic-8"/></alternatives></inline-formula>. Later we describe how these transition probabilities are trained to capture the characteristics of individual MinION reads. The complete set of transition probabilities for our model is as follows:
<disp-formula hwp:id="disp-formula-5"><alternatives hwp:id="alternatives-13"><graphic xlink:href="015552_ueqn2.gif" position="float" orientation="portrait" hwp:id="graphic-12"/></alternatives></disp-formula></p></sec><sec id="s2b6" hwp:id="sec-13"><title hwp:id="title-15">Emission Distributions</title><p hwp:id="p-49">To complete the model we need emission distributions for each state. The emission distribution for the <italic toggle="yes">M</italic> state are the Gaussians described above. The emission distribution for the <italic toggle="yes">E</italic> states are nearly the same however we noted higher variance for the duplicated events so we scale the standard deviation by a factor of <italic toggle="yes">v</italic> = 1.75. As described above, no events are emitted from the <italic toggle="yes">K</italic> states.
<disp-formula id="eqn4" hwp:id="disp-formula-6"><alternatives hwp:id="alternatives-14"><graphic xlink:href="015552_eqn4.gif" position="float" orientation="portrait" hwp:id="graphic-13"/></alternatives></disp-formula>
<disp-formula id="eqn5" hwp:id="disp-formula-7"><alternatives hwp:id="alternatives-15"><graphic xlink:href="015552_eqn5.gif" position="float" orientation="portrait" hwp:id="graphic-14"/></alternatives></disp-formula></p><p hwp:id="p-50">This completes the description of our HMM.
<table-wrap id="tblS2" position="float" orientation="portrait" hwp:id="T2" hwp:rev-id="xref-table-wrap-2-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;015552v2/TBLS2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T2</object-id><object-id pub-id-type="publisher-id">tblS2</object-id><label>Supplementary Table 2:</label><caption hwp:id="caption-8"><p hwp:id="p-51">An example of the first two reads for the first two anchors shown in <xref ref-type="fig" rid="figS5" hwp:id="xref-fig-7-1" hwp:rel-id="F7">Figure 5</xref>.</p></caption><graphic xlink:href="015552_tblS2" position="float" orientation="portrait" hwp:id="graphic-15"/></table-wrap></p></sec></sec><sec id="s2c" hwp:id="sec-14"><label>1.3</label><title hwp:id="title-16">Computing the Consensus Sequence</title><p hwp:id="p-52">Our consensus pipeline begins by mapping the uncorrected 2D MinION reads to the draft assembly, <italic toggle="yes">G</italic>. To do this we use <monospace>bwa mem</monospace> with option <monospace>-x ont2d</monospace> [<xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-1" hwp:rel-id="ref-23">8</xref>]. After the read mapping step, we segment the genome into 10 kilobase segments which overlap by 200bp. For each 10kb segment we extract the subsequence of each read that maps to the segment and create a multiple alignment using POA as in our error correction algorithm. The multiple alignment for the segment is the input into our consensus algorithm.</p><p hwp:id="p-53">The first row of the multiple alignment is the sequence of the draft assembly for the segment and the remaining rows are the 2D reads mapped to the segment. We iterate over the columns of the multiple alignment and select an <italic toggle="yes">anchor</italic> every 50bp of the draft assembly’s sequence. These anchor points define a mapping between bases in the draft assembly and the current signal events for each strand (template and complement) of the aligned 2D MinION reads. Later, when evaluating the probability of the data in our HMM we treat each strand of a 2D read independently. An anchor <italic toggle="yes">A<sub>i</sub></italic> is a set of tuples specifying a MinION read identifier, a strand identifier and the index of the nearest event for the base aligned to the draft assembly. We use the anchor positions to extract subsequences of the draft assembly, the 2D MinION reads and their template and complement events to input into the HMM. An example is in <xref ref-type="fig" rid="figS5" hwp:id="xref-fig-7-2" hwp:rel-id="F7">Figure 5</xref> and <xref ref-type="table" rid="tblS2" hwp:id="xref-table-wrap-2-1" hwp:rel-id="T2">Table 2</xref>.
<fig id="figS5" position="float" orientation="portrait" fig-type="figure" hwp:id="F7" hwp:rev-id="xref-fig-7-1 xref-fig-7-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;015552v2/FIGS5</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F7</object-id><object-id pub-id-type="publisher-id">figS5</object-id><label>Supplementary Figure 5:</label><caption hwp:id="caption-9"><p hwp:id="p-54">Anchor positions are selected from the multiple alignment which store mappings between bases and MinION events for every 2D read mapped to a segment. In this example, anchors are selected every 20bp along the draft assembly row.</p></caption><graphic xlink:href="015552_figS5" position="float" orientation="portrait" hwp:id="graphic-16"/></fig></p><sec id="s2c1" hwp:id="sec-15"><title hwp:id="title-17">Training the HMM Transitions</title><p hwp:id="p-55">Prior to computing the consenseus sequence of a segment, we adjust the transition probabilities for both strands of the MinION reads. We do this by aligning the events for each read strand to the draft assembly sequence using the Viterbi algorithm, guided by the anchor positions. For each read, we count the number of transitions between the states of the Profile HMM and update the <italic toggle="yes">f</italic> table, <italic toggle="yes">p<sub>me</sub></italic> and <italic toggle="yes">p<sub>ee</sub></italic> accordingly. As a read may not have have enough events to estimate the <italic toggle="yes">f</italic> table across the full range of values we use pseudocounts from the original <italic toggle="yes">f</italic> table to initialize this update.</p></sec><sec id="s2c2" hwp:id="sec-16"><title hwp:id="title-18">Consensus Algorithm</title><p hwp:id="p-56">The consensus algorithm recomputes the sequence of the draft assembly between anchors <italic toggle="yes">A<sub>i</sub></italic> and <italic toggle="yes">A<sub>i</sub></italic><sub>+2</sub>. After the new consensus sequence is computed, we update the sequence of the assembly and the event-to-assembly mappings for <italic toggle="yes">A<sub>i</sub></italic><sub>+1</sub>. This update step uses the Viterbi algorithm to align events to the new consensus sequence. The purpose of this pattern - jumping over an anchor and realigning - is to progressively improve the quality of the event-to-assembly alignments recorded in the anchors.</p><p hwp:id="p-57">Let <inline-formula hwp:id="inline-formula-9"><alternatives hwp:id="alternatives-16"><inline-graphic xlink:href="015552_inline8.gif" hwp:id="inline-graphic-9"/></alternatives></inline-formula> be the set of event subsequences for the <italic toggle="yes">r</italic> strands of the 2D MinION reads that are anchored at both <italic toggle="yes">A<sub>i</sub></italic> and <italic toggle="yes">A<sub>i</sub></italic><sub>+2</sub>. Our goal is to compute a consensus sequence <italic toggle="yes">C</italic> that maximizes the probability of the data <inline-formula hwp:id="inline-formula-10"><alternatives hwp:id="alternatives-17"><inline-graphic xlink:href="015552_inline9.gif" hwp:id="inline-graphic-10"/></alternatives></inline-formula>. We do this by initializing <italic toggle="yes">C</italic> to the sequence of the draft assembly between the two anchors. We then propose a set of candidate sequences <inline-formula hwp:id="inline-formula-11"><alternatives hwp:id="alternatives-18"><inline-graphic xlink:href="015552_inline10.gif" hwp:id="inline-graphic-11"/></alternatives></inline-formula> which are derived from the current consensus <italic toggle="yes">C</italic>. We use our HMM to select the sequence that maximizes the probability of the data:
<disp-formula id="eqn6" hwp:id="disp-formula-8" hwp:rev-id="xref-disp-formula-8-1 xref-disp-formula-8-2 xref-disp-formula-8-3 xref-disp-formula-8-4 xref-disp-formula-8-5"><alternatives hwp:id="alternatives-19"><graphic xlink:href="015552_eqn6.gif" position="float" orientation="portrait" hwp:id="graphic-17"/></alternatives></disp-formula>
where
<disp-formula id="eqn7" hwp:id="disp-formula-9"><alternatives hwp:id="alternatives-20"><graphic xlink:href="015552_eqn7.gif" position="float" orientation="portrait" hwp:id="graphic-18"/></alternatives></disp-formula></p><p hwp:id="p-58">The current consensus sequence is always included in the set of candidates. If the current consensus sequence is selected by <xref ref-type="disp-formula" rid="eqn6" hwp:id="xref-disp-formula-8-1" hwp:rel-id="disp-formula-8">equation 6</xref>, the process stops.</p><p hwp:id="p-59">The set of all possible candidate sequences between <italic toggle="yes">A<sub>i</sub></italic> and <italic toggle="yes">A<sub>i</sub></italic><sub>+2</sub> is too large to test every possibility. Instead, we use two methods to propose small sets of candidate sequences derived from the current consensus sequence <italic toggle="yes">C</italic>. The first method makes edits to <italic toggle="yes">C</italic> based on sampling alternative substrings from the reads. The second method, inspired by the Quiver algorithm [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">1</xref>], generates all strings within edit distance of one of <italic toggle="yes">C</italic>. This pair of methods, the first allowing large changes that must be observed by at least one read, the second exhaustively trying all one base edits, balances between compute time and thoroughly exploring the space of candidate consensus sequences.</p><p hwp:id="p-60">The first method, which we call the <monospace>block replacement</monospace> algorithm, computes the longest common subsequence of 5-mers between <italic toggle="yes">C</italic> and an aligned 2D read, <italic toggle="yes">R</italic>. This algorithm partitions <italic toggle="yes">C</italic> and <italic toggle="yes">R</italic> into contiguous regions where they share matching 5-mers and regions where they do not. For each pair of consecutive matching regions, we replace the sequence in <italic toggle="yes">C</italic> with the sequence in <italic toggle="yes">R</italic> and add this derived sequence to the set <inline-formula hwp:id="inline-formula-12"><alternatives hwp:id="alternatives-21"><inline-graphic xlink:href="015552_inline11.gif" hwp:id="inline-graphic-12"/></alternatives></inline-formula>. This algorithm generates a new candidate sequence for each pair of matching regions between <italic toggle="yes">C</italic> and <italic toggle="yes">R</italic> and is run for all 2D reads that are aligned between the anchors.</p><p hwp:id="p-61">The second method, which we call the mutation algorithm, simply makes all one base substitutions, one base insertions and one base deletions to <italic toggle="yes">C</italic> to generate the candidate set <inline-formula hwp:id="inline-formula-13"><alternatives hwp:id="alternatives-22"><inline-graphic xlink:href="015552_inline12.gif" hwp:id="inline-graphic-13"/></alternatives></inline-formula>.</p><p hwp:id="p-62">These algorithms are run iteratively. We initialize the current consensus <italic toggle="yes">C</italic> to the draft genome sequence between the pair of anchors. We then generate candidate set <inline-formula hwp:id="inline-formula-14"><alternatives hwp:id="alternatives-23"><inline-graphic xlink:href="015552_inline13.gif" hwp:id="inline-graphic-14"/></alternatives></inline-formula> using the <monospace>block replacement</monospace> algorithm. We select the best sequence <italic toggle="yes">C</italic>′ using <xref ref-type="disp-formula" rid="eqn6" hwp:id="xref-disp-formula-8-2" hwp:rel-id="disp-formula-8">equation 6</xref>. If <italic toggle="yes">C</italic>′ is not <italic toggle="yes">C</italic>, we set <italic toggle="yes">C</italic> ← <italic toggle="yes">C</italic>′ and repeat the process. Once no more improvements to the consensus sequence are made, we run this procedure again except using the <monospace>mutation</monospace> algorithm to generate <inline-formula hwp:id="inline-formula-15"><alternatives hwp:id="alternatives-24"><inline-graphic xlink:href="015552_inline14.gif" hwp:id="inline-graphic-15"/></alternatives></inline-formula>. Once this procedure converges we update the assembly to contain the final consensus sequence. We then update the event alignments for <italic toggle="yes">A<sub>i</sub></italic><sub>+1</sub> and move on to the next pair of anchors. This process continues until the entire 10kbp sequence has been processed. Once all 10kbp segments have been processed, which occurs in parallel, we merge the segments together at the overlapping 200bp ends.</p></sec><sec id="s2c3" hwp:id="sec-17"><title hwp:id="title-19">Culling Unlikely Candidate Sequences</title><p hwp:id="p-63">While we restrict our candidate sequences to those that are close to the current consensus <italic toggle="yes">C</italic>, we still generate many sequence that are unlikely to be the true sequence of the genome between a pair of anchors. To avoid spending computation time fully evaluating <xref ref-type="disp-formula" rid="eqn6" hwp:id="xref-disp-formula-8-3" hwp:rel-id="disp-formula-8">equation 6</xref> for these sequences we periodically cull unlikely sequences from <inline-formula hwp:id="inline-formula-16"><alternatives hwp:id="alternatives-25"><inline-graphic xlink:href="015552_inline15.gif" hwp:id="inline-graphic-16"/></alternatives></inline-formula>. We do this by progressively evaluating <xref ref-type="disp-formula" rid="eqn6" hwp:id="xref-disp-formula-8-4" hwp:rel-id="disp-formula-8">equation 6</xref> using subsets of <italic toggle="yes">k</italic> elements of the full data <inline-formula hwp:id="inline-formula-17"><alternatives hwp:id="alternatives-26"><inline-graphic xlink:href="015552_inline16.gif" hwp:id="inline-graphic-17"/></alternatives></inline-formula>. We will refer to these subsets as <inline-formula hwp:id="inline-formula-18"><alternatives hwp:id="alternatives-27"><inline-graphic xlink:href="015552_inline17.gif" hwp:id="inline-graphic-18"/></alternatives></inline-formula>.</p><p hwp:id="p-64">To retain a sequence <italic toggle="yes">S</italic> in <inline-formula hwp:id="inline-formula-19"><alternatives hwp:id="alternatives-28"><inline-graphic xlink:href="015552_inline18.gif" hwp:id="inline-graphic-19"/></alternatives></inline-formula>, we require that either <italic toggle="yes">k</italic>/5 event sequences in <inline-formula hwp:id="inline-formula-20"><alternatives hwp:id="alternatives-29"><inline-graphic xlink:href="015552_inline19.gif" hwp:id="inline-graphic-20"/></alternatives></inline-formula> have greater probability given <italic toggle="yes">S</italic> than the current consensus sequence <italic toggle="yes">C</italic> or that <inline-formula hwp:id="inline-formula-21"><alternatives hwp:id="alternatives-30"><inline-graphic xlink:href="015552_inline20.gif" hwp:id="inline-graphic-21"/></alternatives></inline-formula>. If both of these conditions fail, we remove <italic toggle="yes">S</italic> from <inline-formula hwp:id="inline-formula-22"><alternatives hwp:id="alternatives-31"><inline-graphic xlink:href="015552_inline21.gif" hwp:id="inline-graphic-22"/></alternatives></inline-formula>.</p><p hwp:id="p-65">These checks are performed after processing 5 event sequences, eg for subsets <inline-formula hwp:id="inline-formula-23"><alternatives hwp:id="alternatives-32"><inline-graphic xlink:href="015552_inline22.gif" hwp:id="inline-graphic-23"/></alternatives></inline-formula>. The conservative threshold that we set on the ratio between probabilities is to avoid culling the true sequence from <inline-formula hwp:id="inline-formula-24"><alternatives hwp:id="alternatives-33"><inline-graphic xlink:href="015552_inline23.gif" hwp:id="inline-graphic-24"/></alternatives></inline-formula> at the cost of retaining some unlikely sequences.</p></sec><sec id="s2c4" hwp:id="sec-18"><title hwp:id="title-20">Event Preprocessing</title><p hwp:id="p-66">The events recorded for a read may differ from the reference pore model that Oxford Nanopore has provided. To account for this the MinION’s software calculates parameters to globally shift and scale the mean and variance of the provided 5-mer model to better match the observed data. Additionally a correction is applied to the event signals to correct for a tendency of the signal to drift over time. We apply these corrections, shifts and scales to the pore model and events prior to input into our HMM.</p></sec><sec id="s2c5" hwp:id="sec-19"><title hwp:id="title-21">Read Filtering</title><p hwp:id="p-67">During development we noticed that some MinION reads contained observations that were outside of the expected range of signals. To discard these reads rather than having the erroneous observations dominate the probability in <xref ref-type="disp-formula" rid="eqn6" hwp:id="xref-disp-formula-8-5" hwp:rel-id="disp-formula-8">equation 6</xref>, we filtered the input events by computing the probability of the data given the original draft reference sequence and discarding any strands whose log-scaled probability divided by the number of events is greater than 3.5. Better quality control of the input data is an area of future improvement.</p></sec><sec id="s2c6" hwp:id="sec-20"><title hwp:id="title-22">Source Code and Commands Run</title><p hwp:id="p-68">The source code for our consensus algorithm is freely available and open source under the MIT license at <monospace><ext-link l:rel="related" l:ref-type="uri" l:ref="http://https://github.com/jts/nanopolish" ext-link-type="uri" xlink:href="http://https://github.com/jts/nanopolish" hwp:id="ext-link-6">https://github.com/jts/nanopolish</ext-link></monospace>. A description of how we generated the consensus sequence for the assembly in this paper is documented on github:</p><p hwp:id="p-69"><monospace><ext-link l:rel="related" l:ref-type="uri" l:ref="http://https://github.com/jts/nanopore–paper–analysis/blob/master/polishing_commands.txt" ext-link-type="uri" xlink:href="http://https://github.com/jts/nanopore–paper–analysis/blob/master/polishing_commands.txt" hwp:id="ext-link-7">https://github.com/jts/nanopore–paper–analysis/blob/master/polishing_commands.txt</ext-link></monospace></p></sec></sec><sec id="s2d" hwp:id="sec-21"><label>1.4</label><title hwp:id="title-23">Assembly Analysis</title><sec id="s2d1" hwp:id="sec-22"><title hwp:id="title-24">Analysis of read accuracy</title><p hwp:id="p-70">For the analysis of nanopore sequence read accuracy, reads were mapped to the <italic toggle="yes">E. coli</italic> K-12 MG1655 reference genome using <monospace>BWA-MEM 0.7.10-r960-dirty</monospace> [<xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-2" hwp:rel-id="ref-23">8</xref>]. The resulting BAM files were processed with the <monospace>expand-cigar.py</monospace> script and mismatches, insertions and deletions counted using the <monospace>count-errors.py</monospace> script from Aaron Quinlan’s <monospace>nanopore-scripts</monospace> package (<ext-link l:rel="related" l:ref-type="uri" l:ref="http://https://github.com/arq5x/nanopore-scripts" ext-link-type="uri" xlink:href="http://https://github.com/arq5x/nanopore-scripts" hwp:id="ext-link-8">https://github.com/arq5x/nanopore-scripts</ext-link>).</p></sec><sec id="s2d2" hwp:id="sec-23"><title hwp:id="title-25">Dotplot analysis</title><p hwp:id="p-71">The circularised contig was analysed through the <monospace>nucmer</monospace> component of MUMMER [<xref ref-type="bibr" rid="c25" hwp:id="xref-ref-25-1" hwp:rel-id="ref-25">10</xref>] and the delta file visualised using <monospace>mummerplot</monospace>.</p></sec><sec id="s2d3" hwp:id="sec-24"><title hwp:id="title-26">Coverage analysis</title><p hwp:id="p-72">The sorted, aligned BAM file of raw reads against the assembly was analysed using the <monospace>genomeCoverageBed</monospace> module of <monospace>bedtools</monospace> [<xref ref-type="bibr" rid="c25" hwp:id="xref-ref-25-2" hwp:rel-id="ref-25">10</xref>]. Per-base coverage was averaged over 1000 base segments and plotted in R using <monospace>ggplot2</monospace>.</p></sec><sec id="s2d4" hwp:id="sec-25"><title hwp:id="title-27">GC analysis</title><p hwp:id="p-73">The GC plot was constructed from the assembly using a Python script using Biopython averaging GC-content over 1000 base segments [<xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">2</xref>].</p></sec><sec id="s2d5" hwp:id="sec-26"><title hwp:id="title-28">QUAST Analysis</title><p hwp:id="p-74">The circularised contig, both before and after polishing was analysed by QUAST 2.3 [<xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-1" hwp:rel-id="ref-21">6</xref>] which was run with default parameters and supplying the <monospace>NC_000913.3</monospace> reference genome as the comparator.</p></sec><sec id="s2d6" hwp:id="sec-27"><title hwp:id="title-29">Mauve Analysis</title><p hwp:id="p-75">The circularised contig was analysed by running the <monospace>progressiveMauve</monospace> package on the command-line with option <monospace>–collinear</monospace> and visualised in the Mauve Genome Viewer. [<xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-1" hwp:rel-id="ref-18">3</xref>].</p></sec><sec id="s2d7" hwp:id="sec-28"><title hwp:id="title-30">5-mer Analysis</title><p hwp:id="p-76">To explore over and under-representation of 5-mers, we wrote a program to count the number of occurrences of the 1024 different 5-mers in a set of sequences. This program counts 5-mers on the forward and reverse strands independently. The analysis used the counts for the forward strand of the reference and the forward strand of the largest contig of our assemblies. We plotted the results using <monospace>R</monospace> and the <monospace>ggplot2</monospace> library.</p></sec></sec><ref-list hwp:id="ref-list-2"><title hwp:id="title-31">References</title><ref id="c16" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1"><label>[1]</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.16" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Chin Chen-Shan"><given-names>Chen-Shan</given-names> <surname>Chin</surname></string-name>, <string-name name-style="western" hwp:sortable="Alexander David H"><given-names>David H</given-names> <surname>Alexander</surname></string-name>, <string-name name-style="western" hwp:sortable="Marks Patrick"><given-names>Patrick</given-names> <surname>Marks</surname></string-name>, <string-name name-style="western" hwp:sortable="Klammer Aaron A"><given-names>Aaron A</given-names> <surname>Klammer</surname></string-name>, <string-name name-style="western" hwp:sortable="Drake James"><given-names>James</given-names> <surname>Drake</surname></string-name>, <string-name name-style="western" hwp:sortable="Heiner Cheryl"><given-names>Cheryl</given-names> <surname>Heiner</surname></string-name>, <string-name name-style="western" hwp:sortable="Clum Alicia"><given-names>Alicia</given-names> <surname>Clum</surname></string-name>, <string-name name-style="western" hwp:sortable="Copeland Alex"><given-names>Alex</given-names> <surname>Copeland</surname></string-name>, <string-name name-style="western" hwp:sortable="Huddleston John"><given-names>John</given-names> <surname>Huddleston</surname></string-name>, <string-name name-style="western" hwp:sortable="Eichler Evan E"><given-names>Evan E</given-names> <surname>Eichler</surname></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-15">Nonhybrid, finished microbial genome assemblies from long-read smrt sequencing data</article-title>. <source hwp:id="source-16">Nature methods</source>, <volume>10</volume>(<issue>6</issue>):<fpage>563</fpage>–<lpage>569</lpage>, <year>2013</year>.</citation></ref><ref id="c17" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1"><label>[2]</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.17" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="Cock Peter JA"><given-names>Peter JA</given-names> <surname>Cock</surname></string-name>, <string-name name-style="western" hwp:sortable="Antao Tiago"><given-names>Tiago</given-names> <surname>Antao</surname></string-name>, <string-name name-style="western" hwp:sortable="Chang Jeffrey T"><given-names>Jeffrey T</given-names> <surname>Chang</surname></string-name>, <string-name name-style="western" hwp:sortable="Chapman Brad A"><given-names>Brad A</given-names> <surname>Chapman</surname></string-name>, <string-name name-style="western" hwp:sortable="Cox Cymon J"><given-names>Cymon J</given-names> <surname>Cox</surname></string-name>, <string-name name-style="western" hwp:sortable="Dalke Andrew"><given-names>Andrew</given-names> <surname>Dalke</surname></string-name>, <string-name name-style="western" hwp:sortable="Friedberg Iddo"><given-names>Iddo</given-names> <surname>Friedberg</surname></string-name>, <string-name name-style="western" hwp:sortable="Hamelryck Thomas"><given-names>Thomas</given-names> <surname>Hamelryck</surname></string-name>, <string-name name-style="western" hwp:sortable="Kauff Frank"><given-names>Frank</given-names> <surname>Kauff</surname></string-name>, <string-name name-style="western" hwp:sortable="Wilczynski Bartek"><given-names>Bartek</given-names> <surname>Wilczynski</surname></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-16">Biopython: freely available python tools for computational molecular biology and bioinformatics</article-title>. <source hwp:id="source-17">Bioinformatics</source>, <volume>25</volume>(<issue>11</issue>):<fpage>1422</fpage>–<lpage>1423</lpage>, <year>2009</year>.</citation></ref><ref id="c18" hwp:id="ref-18" hwp:rev-id="xref-ref-18-1"><label>[3]</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.18" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-18"><string-name name-style="western" hwp:sortable="Darling Aaron E"><given-names>Aaron E</given-names> <surname>Darling</surname></string-name>, <string-name name-style="western" hwp:sortable="Mau Bob"><given-names>Bob</given-names> <surname>Mau</surname></string-name>, and <string-name name-style="western" hwp:sortable="Perna Nicole T"><given-names>Nicole T</given-names> <surname>Perna</surname></string-name>. <article-title hwp:id="article-title-17">progressivemauve: multiple genome alignment with gene gain, loss and rearrangement</article-title>. <source hwp:id="source-18">PloS one</source>, <volume>5</volume>(<issue>6</issue>):<fpage>e11147</fpage>, <year>2010</year>.</citation></ref><ref id="c19" hwp:id="ref-19" hwp:rev-id="xref-ref-19-1"><label>[4]</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.19" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-19"><string-name name-style="western" hwp:sortable="Delcher Arthur L"><given-names>Arthur L</given-names> <surname>Delcher</surname></string-name>, <string-name name-style="western" hwp:sortable="Phillippy Adam"><given-names>Adam</given-names> <surname>Phillippy</surname></string-name>, <string-name name-style="western" hwp:sortable="Carlton Jane"><given-names>Jane</given-names> <surname>Carlton</surname></string-name>, and <string-name name-style="western" hwp:sortable="Salzberg Steven L"><given-names>Steven L</given-names> <surname>Salzberg</surname></string-name>. <article-title hwp:id="article-title-18">Fast algorithms for large-scale genome alignment and comparison</article-title>. <source hwp:id="source-19">Nucleic acids research</source>, <volume>30</volume>(<issue>11</issue>):<fpage>2478</fpage>–<lpage>2483</lpage>, <year>2002</year>.</citation></ref><ref id="c20" hwp:id="ref-20" hwp:rev-id="xref-ref-20-1 xref-ref-20-2"><label>[5]</label><citation publication-type="book" citation-type="book" ref:id="015552v2.20" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-20"><string-name name-style="western" hwp:sortable="Durbin R."><given-names>R.</given-names> <surname>Durbin</surname></string-name>, <string-name name-style="western" hwp:sortable="Eddy S."><given-names>S.</given-names> <surname>Eddy</surname></string-name>, <string-name name-style="western" hwp:sortable="Krogh A."><given-names>A.</given-names> <surname>Krogh</surname></string-name>, and <string-name name-style="western" hwp:sortable="Mitchison G."><given-names>G.</given-names> <surname>Mitchison</surname></string-name>. <source hwp:id="source-20">Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids</source>. <publisher-name>Cambridge University Press</publisher-name>, <year>1998</year>.</citation></ref><ref id="c21" hwp:id="ref-21" hwp:rev-id="xref-ref-21-1"><label>[6]</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.21" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-21"><string-name name-style="western" hwp:sortable="Gurevich Alexey"><given-names>Alexey</given-names> <surname>Gurevich</surname></string-name>, <string-name name-style="western" hwp:sortable="Saveliev Vladislav"><given-names>Vladislav</given-names> <surname>Saveliev</surname></string-name>, <string-name name-style="western" hwp:sortable="Vyahhi Nikolay"><given-names>Nikolay</given-names> <surname>Vyahhi</surname></string-name>, and <string-name name-style="western" hwp:sortable="Tesler Glenn"><given-names>Glenn</given-names> <surname>Tesler</surname></string-name>. <article-title hwp:id="article-title-19">Quast: quality assessment tool for genome assemblies</article-title>. <source hwp:id="source-21">Bioinformatics</source>, <volume>29</volume>(<issue>8</issue>):<fpage>1072</fpage>–<lpage>1075</lpage>, <year>2013</year>.</citation></ref><ref id="c22" hwp:id="ref-22" hwp:rev-id="xref-ref-22-1"><label>[7]</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.22" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-22"><string-name name-style="western" hwp:sortable="Kasianowicz John J."><given-names>John J.</given-names> <surname>Kasianowicz</surname></string-name>, <string-name name-style="western" hwp:sortable="Brandin Eric"><given-names>Eric</given-names> <surname>Brandin</surname></string-name>, <string-name name-style="western" hwp:sortable="Branton Daniel"><given-names>Daniel</given-names> <surname>Branton</surname></string-name>, and <string-name name-style="western" hwp:sortable="Deamer David W."><given-names>David W.</given-names> <surname>Deamer</surname></string-name>. <article-title hwp:id="article-title-20">Characterization of individual polynucleotide molecules using a membranechannel</article-title>. <source hwp:id="source-22">Proceedings of the National Academy of Sciences</source>, <volume>93</volume>(<issue>24</issue>):<fpage>13770</fpage>–<lpage>13773</lpage>, <year>1996</year>.</citation></ref><ref id="c23" hwp:id="ref-23" hwp:rev-id="xref-ref-23-1 xref-ref-23-2"><label>[8]</label><citation publication-type="other" citation-type="journal" ref:id="015552v2.23" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-23"><string-name name-style="western" hwp:sortable="Li Heng"><given-names>Heng</given-names> <surname>Li</surname></string-name>. <source hwp:id="source-23">Aligning sequence reads, clone sequences and assembly contigs with bwa-mem</source>. <italic toggle="yes">arXiv preprint arXiv</italic>:<pub-id pub-id-type="arxiv">1303.3997</pub-id> <year>2013</year>.</citation></ref><ref id="c24" hwp:id="ref-24"><label>[9]</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.24" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-24"><string-name name-style="western" hwp:sortable="Quick Josh"><given-names>Josh</given-names> <surname>Quick</surname></string-name>, <string-name name-style="western" hwp:sortable="Quinlan Aaron R"><given-names>Aaron R</given-names> <surname>Quinlan</surname></string-name>, and <string-name name-style="western" hwp:sortable="Loman Nicholas J"><given-names>Nicholas J</given-names> <surname>Loman</surname></string-name>. <source hwp:id="source-24">A reference bacterial genome dataset generated on the minion portable single-molecule nanopore sequencer</source>. <italic toggle="yes">bioRxiv,</italic> page <fpage>009613</fpage>, <year>2014</year>.</citation></ref><ref id="c25" hwp:id="ref-25" hwp:rev-id="xref-ref-25-1 xref-ref-25-2"><label>[10]</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.25" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-25"><string-name name-style="western" hwp:sortable="Quinlan Aaron R"><given-names>Aaron R</given-names> <surname>Quinlan</surname></string-name> and <string-name name-style="western" hwp:sortable="Hall Ira M"><given-names>Ira M</given-names> <surname>Hall</surname></string-name>. <article-title hwp:id="article-title-21">Bedtools: a flexible suite of utilities for comparing genomic features</article-title>. <source hwp:id="source-25">Bioinformatics</source>, <volume>26</volume>(<issue>6</issue>):<fpage>841</fpage>–<lpage>842</lpage>, <year>2010</year>.</citation></ref><ref id="c26" hwp:id="ref-26" hwp:rev-id="xref-ref-26-1"><label>[11]</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.26" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-26"><string-name name-style="western" hwp:sortable="Stoddart David"><given-names>David</given-names> <surname>Stoddart</surname></string-name>, <string-name name-style="western" hwp:sortable="Heron Andrew J."><given-names>Andrew J.</given-names> <surname>Heron</surname></string-name>, <string-name name-style="western" hwp:sortable="Mikhailova Ellina"><given-names>Ellina</given-names> <surname>Mikhailova</surname></string-name>, <string-name name-style="western" hwp:sortable="Maglia Giovanni"><given-names>Giovanni</given-names> <surname>Maglia</surname></string-name>, and <string-name name-style="western" hwp:sortable="Bayley Hagan"><given-names>Hagan</given-names> <surname>Bayley</surname></string-name>. <article-title hwp:id="article-title-22">Single-nucleotide discrimination in immobilized dna oligonucleotides with a biological nanopore</article-title>. <source hwp:id="source-26">Proceedings of the National Academy of Sciences</source>, <volume>106</volume>(<issue>19</issue>):<fpage>7702</fpage>–<lpage>7707</lpage>, <year>2009</year>.</citation></ref><ref id="c27" hwp:id="ref-27" hwp:rev-id="xref-ref-27-1"><label>[12]</label><citation publication-type="journal" citation-type="journal" ref:id="015552v2.27" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-27"><string-name name-style="western" hwp:sortable="Treangen Todd J"><given-names>Todd J</given-names> <surname>Treangen</surname></string-name>, <string-name name-style="western" hwp:sortable="Sommer Dan D"><given-names>Dan D</given-names> <surname>Sommer</surname></string-name>, <string-name name-style="western" hwp:sortable="Angly Florent E"><given-names>Florent E</given-names> <surname>Angly</surname></string-name>, <string-name name-style="western" hwp:sortable="Koren Sergey"><given-names>Sergey</given-names> <surname>Koren</surname></string-name>, and <string-name name-style="western" hwp:sortable="Pop Mihai"><given-names>Mihai</given-names> <surname>Pop</surname></string-name>. <article-title hwp:id="article-title-23">Next generation sequence assembly with amos</article-title>. <source hwp:id="source-27">Current Protocols in Bioinformatics</source>, pages <fpage>11</fpage>–<lpage>8</lpage>, <year>2011</year>.</citation></ref></ref-list></sec><sec id="s3" hwp:id="sec-29"><label>2</label><title hwp:id="title-32">Supplementary Figures and Tables</title><p hwp:id="p-77"><fig id="figS6" position="float" orientation="portrait" fig-type="figure" hwp:id="F8"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;015552v2/FIGS6</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F8</object-id><object-id pub-id-type="publisher-id">figS6</object-id><label>Supplementary Figure 6:</label><caption hwp:id="caption-10"><p hwp:id="p-78">Kernel density plot showing the accuracy of reads from the four individual MinION runs used to generate the <italic toggle="yes">de novo</italic> assembly. The mean accuracy varies from 78.2% (run 3) to 82.2% (run 1).</p></caption><graphic xlink:href="015552_figS6" position="float" orientation="portrait" hwp:id="graphic-19"/></fig>
<fig id="figS7" position="float" orientation="portrait" fig-type="figure" hwp:id="F9" hwp:rev-id="xref-fig-9-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;015552v2/FIGS7</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F9</object-id><object-id pub-id-type="publisher-id">figS7</object-id><label>Supplementary Figure 7:</label><caption hwp:id="caption-11"><p hwp:id="p-79">Kernel density plot demonstrating the raw nanopore read accuracy and effect of two rounds of error correction on accuracy. The mauve area represents uncorrected sequencing reads, where the green area shows the improvement in accuracy after the first round of correction and the yellow shows improvement from the second round of correction. Further rounds of correction did not improve the accuracy further.</p></caption><graphic xlink:href="015552_figS7" position="float" orientation="portrait" hwp:id="graphic-20"/></fig>
<fig id="figS8" position="float" orientation="portrait" fig-type="figure" hwp:id="F10" hwp:rev-id="xref-fig-10-1 xref-fig-10-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;015552v2/FIGS8</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F10</object-id><object-id pub-id-type="publisher-id">figS8</object-id><label>Supplementary Figure 8:</label><caption hwp:id="caption-12"><p hwp:id="p-80">Spec file for Celera Assembler.</p></caption><graphic xlink:href="015552_figS8" position="float" orientation="portrait" hwp:id="graphic-21"/></fig>
<table-wrap id="tblS3" position="float" orientation="portrait" hwp:id="T3" hwp:rev-id="xref-table-wrap-3-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;015552v2/TBLS3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T3</object-id><object-id pub-id-type="publisher-id">tblS3</object-id><label>Supplementary Table 3:</label><caption hwp:id="caption-13"><p hwp:id="p-81">Oxford Nanopore MinION datasets used in this study.</p></caption><graphic xlink:href="015552_tblS3" position="float" orientation="portrait" hwp:id="graphic-22"/></table-wrap>
<table-wrap id="tblS4" position="float" orientation="portrait" hwp:id="T4"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;015552v2/TBLS4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T4</object-id><object-id pub-id-type="publisher-id">tblS4</object-id><label>Supplementary Table 4:</label><caption hwp:id="caption-14"><p hwp:id="p-82">Results from QUAST when comparing the draft circular contig (”circular”) and the polished circular contig (”circular_polished”) against the <italic toggle="yes">E. coli</italic> K12 MG1655 reference genome (accession <monospace>NC_000913.3</monospace>).</p></caption><graphic xlink:href="015552_tblS4" position="float" orientation="portrait" hwp:id="graphic-23"/><graphic xlink:href="015552_tblS4a" position="float" orientation="portrait" hwp:id="graphic-24"/></table-wrap></p></sec></back></article>
