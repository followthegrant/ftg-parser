<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/026484</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;026484v2</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;026484</article-id><article-id pub-id-type="other" hwp:sub-type="slug">026484</article-id><article-id pub-id-type="other" hwp:sub-type="tag">026484</article-id><article-version>1.2</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Biophysics" hwp:journal="biorxiv"><subject>Biophysics</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">Photon-HDF5: an open file format for single-molecule fluorescence experiments using photon-counting detectors</article-title></title-group><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-9348-1397</contrib-id><name name-style="western" hwp:sortable="Ingargiola A."><surname>Ingargiola</surname><given-names>A.</given-names></name><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0002-9348-1397"/></contrib><contrib contrib-type="author" hwp:id="contrib-2"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-9348-1397</contrib-id><name name-style="western" hwp:sortable="Laurence T."><surname>Laurence</surname><given-names>T.</given-names></name><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0002-9348-1397"/></contrib><contrib contrib-type="author" hwp:id="contrib-3"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-0720-5426</contrib-id><name name-style="western" hwp:sortable="Weiss S."><surname>Weiss</surname><given-names>S.</given-names></name><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0002-0720-5426"/></contrib><contrib contrib-type="author" hwp:id="contrib-4"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-6602-7693</contrib-id><name name-style="western" hwp:sortable="Michalet X."><surname>Michalet</surname><given-names>X.</given-names></name><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0001-6602-7693"/></contrib></contrib-group><pub-date pub-type="epub-original" hwp:start="2015"><year>2015</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2015-09-09T13:45:13-07:00">
    <day>9</day><month>9</month><year>2015</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2015-09-14T11:15:11-07:00">
    <day>14</day><month>9</month><year>2015</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2015-09-09T14:05:37-07:00">
    <day>9</day><month>9</month><year>2015</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2015-09-14T13:13:07-07:00">
    <day>14</day><month>9</month><year>2015</year>
  </pub-date><elocation-id>026484</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2015-09-09"><day>09</day><month>9</month><year>2015</year></date>
<date date-type="accepted" hwp:start="2015-09-14"><day>14</day><month>9</month><year>2015</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2015, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2015</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/" hwp:id="license-1"><p hwp:id="p-1">This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" hwp:id="ext-link-1">http://creativecommons.org/licenses/by/4.0/</ext-link></p></license></permissions><self-uri xlink:href="026484.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2019/pdf/026484v2.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="026484.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2019/abstracts/026484v2/026484v2.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2019/fulltext/026484v2/026484v2.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><p hwp:id="p-2">We introduce Photon-HDF5, an open and efficient file format to simplify exchange and long term accessibility of data from single-molecule fluorescence experiments based on photon-counting detectors such as single-photon avalanche diode (SPAD), photomultiplier tube (PMT) or arrays of such detectors. The format is based on HDF5, a widely used platform- and language-independent hierarchical file format for which user-friendly viewers are available. Photon-HDF5 can store raw photon data (timestamp, channel number, etc) from any acquisition hardware, but also setup and sample description, information on provenance, authorship and other metadata, and is flexible enough to include any kind of custom data.</p><p hwp:id="p-3">The format specifications are hosted on a public website, which is open to contributions by the biophysics community. As an initial resource, the website provides code examples to read Photon-HDF5 files in several programming languages and a reference python library (<italic toggle="yes">phconvert</italic>), to create new Photon-HDF5 files and convert several existing file formats into Photon-HDF5. To encourage adoption by the academic and commercial communities, all software is released under the MIT open source license.</p></abstract><counts><page-count count="21"/></counts><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-1">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta></front><body><sec id="s1" hwp:id="sec-1"><label>1.</label><title hwp:id="title-2">Introduction</title><p hwp:id="p-4">Single-molecule fluorescence techniques have facilitated ground-breaking developments in biophysics, as recently recognized by the Nobel committee (<xref rid="c1" ref-type="bibr" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">1</xref>). Techniques based on acquisition of long series of images obtained with ultra-sensitive cameras are the most popular among those, with numerous published software tools (<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">2</xref>–<xref rid="c4" ref-type="bibr" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">4</xref>). A related set of single-molecule fluorescence techniques relying on photon-counting devices is used in studies of freely-diffusing single-molecules (<xref rid="c5" ref-type="bibr" hwp:id="xref-ref-5-1" hwp:rel-id="ref-5">5</xref>–<xref rid="c7" ref-type="bibr" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">7</xref>), studies of single-molecules in microfluidic mixers (<xref rid="c8" ref-type="bibr" hwp:id="xref-ref-8-1" hwp:rel-id="ref-8">8</xref>), optical or ABEL traps (<xref rid="c9" ref-type="bibr" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">9</xref>–<xref rid="c11" ref-type="bibr" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">11</xref>), or on immobilized molecules (<xref rid="c12" ref-type="bibr" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">12</xref>), where high temporal resolution (&lt; 1 ms) is required. Among these techniques, single-molecule fluorescence resonant energy transfer (smFRET)(<xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">13</xref>), microsecond alternating laser excitation (μs-ALEX)(<xref rid="c14" ref-type="bibr" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">14</xref>), nanosecond ALEX (ns-ALEX)(<xref rid="c15" ref-type="bibr" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">15</xref>), also known as pulse interleaved excitation (PIE)(<xref rid="c16" ref-type="bibr" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">16</xref>), two-color coincident detection (TCCD)(<xref rid="c17" ref-type="bibr" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">17</xref>, <xref rid="c18" ref-type="bibr" hwp:id="xref-ref-18-1" hwp:rel-id="ref-18">18</xref>), polarization anisotropy(<xref rid="c19" ref-type="bibr" hwp:id="xref-ref-19-1" hwp:rel-id="ref-19">19</xref>, <xref rid="c20" ref-type="bibr" hwp:id="xref-ref-20-1" hwp:rel-id="ref-20">20</xref>), fluorescence correlation and cross-correlation spectroscopy (FCS, FCCS) (<xref rid="c21" ref-type="bibr" hwp:id="xref-ref-21-1" hwp:rel-id="ref-21">21</xref>, <xref rid="c22" ref-type="bibr" hwp:id="xref-ref-22-1" hwp:rel-id="ref-22">22</xref>) or multi-parameter fluorescent detection (MFD)(<xref rid="c23" ref-type="bibr" hwp:id="xref-ref-23-1" hwp:rel-id="ref-23">23</xref>) are but a few in a constantly growing list.</p><p hwp:id="p-5">Contrary to camera-based techniques, where most manufacturers provide a way to save data in a standardized format such as TIFF images, there is no such standardization for photon-counting hardware, where manufacturers of integrated systems have their own binary formats, and most systems are custom-built, including custom software generating oftentimes poorly documented binary files.</p><p hwp:id="p-6">This situation creates a number of issues. First, it is rarely possible for an outsider (for instance a reviewer) to access the raw data of a published study without considerable coding work. Moreover, this assumes that the authors have provided a comprehensive description of their format. Worse, it is often difficult for different generations of students in a laboratory to decipher data file formats created by their predecessors. In summary, the proliferation of file formats impedes interoperability between different software, creates barriers to data sharing among researchers and undermines results reproducibility and long-term preservation of data. Moreover, with the growing trend by funding agencies to request data sharing and documentation, having multiple file formats will inevitably result in significant duplication of efforts by each group.</p><p hwp:id="p-7">To help address these issues, we introduce Photon-HDF5(<xref rid="c24" ref-type="bibr" hwp:id="xref-ref-24-1" hwp:rel-id="ref-24">24</xref>), an open file format for single-molecule fluorescence experiments using photon-counting devices, including Time-Correlated Single-Photon Counting (TCSPC) data. The file format description comes accompanied with a reference Python library (<italic toggle="yes">phconvert</italic>)(<xref rid="c25" ref-type="bibr" hwp:id="xref-ref-25-1" hwp:rel-id="ref-25">25</xref>) to create Photon-HDF5 files from raw data or existing file formats, as well as examples(<xref rid="c26" ref-type="bibr" hwp:id="xref-ref-26-1" hwp:rel-id="ref-26">26</xref>) on how to read Photon-HDF5 files in Python, MATLAB and LabVIEW. Both format documentation and software are hosted on GitHub, a popular collaborative platform (<xref rid="c27" ref-type="bibr" hwp:id="xref-ref-27-1" hwp:rel-id="ref-27">27</xref>), with the aim of allowing the biophysics community to contribute to this project with comments, suggestions and code (<xref rid="c28" ref-type="bibr" hwp:id="xref-ref-28-1" hwp:rel-id="ref-28">28</xref>).</p><p hwp:id="p-8">The article is organized as follows. In Section 2, we briefly review the current situation (characterized by a myriad of formats) and showcase a few successful examples of standardization in other scientific domains. In section 3, we examine requirements for an efficient, maintainable file format and introduce HDF5, a format on which Photon-HDF5 is based. We then describe the overall structure of Photon-HDF5 files and support software. In section 4 we illustrate the use of this format with a few scenarios, and, in section 5, we conclude with a summary of Photon-HDF5 key features and with a call for the community to participate in shaping the evolution of the format.</p></sec><sec id="s2" hwp:id="sec-2"><label>2.</label><title hwp:id="title-3">Current situation</title><sec id="s2a" hwp:id="sec-3"><label>2.1</label><title hwp:id="title-4">Photon-counting based experiments</title><p hwp:id="p-9">Photon-counting based single-molecule fluorescence experiments can rapidly generate large amounts of data: in a typical experiment, count rates from a few kHz to several 10 kHz per detector and measurement durations of minutes are not uncommon and, increasingly, large number of individual detectors are encountered (<xref rid="c29" ref-type="bibr" hwp:id="xref-ref-29-1" hwp:rel-id="ref-29">29</xref>–<xref rid="c31" ref-type="bibr" hwp:id="xref-ref-31-1" hwp:rel-id="ref-31">31</xref>). Since each photon’s information (time stamp, channel number, etc.) may occupy 64 or more bits per photon, most experiments store data in binary formats, which minimize disk space usage, at the expense of human readability. Because there is no natural or standardized structure for such a file format, each research group or company designing or putting together photon-counting instrumentation for single-molecule fluorescence experiments usually ends up developing its own custom binary file format.</p><p hwp:id="p-10">In contrast with self-documenting text-based format, binary formats require detailed documentation of the file structure in order to be properly read (or written). Furthermore, extending a binary format to handle a new piece of information (such as modifications to the setup hardware) usually results in a new, incompatible format requiring specific handling and new, time-consuming code development. Since most researchers are, understandably, not inclined to invest significant resources in developing and documenting file formats, it is common to end up with a collection of poorly documented <italic toggle="yes">ad hoc</italic> binary formats within each individual research groups. The obvious risk is that, over the years, information about those file formats gets lost, effectively leading to data loss.</p><p hwp:id="p-11">While vendors of photon-counting hardware and software have usually done a better job at designing and documenting file formats, their formats are nonetheless tightly bound to a specific hardware and therefore, generally not suitable to store data from a competitor’s systems or from custom hardware used in individual laboratories. Additionally, although these formats can store some predefined metadata (such as for instance author, date of creation and comment), they are not extensible to accept additional metadata, necessary to describe a measurement in details.</p><p hwp:id="p-12">The result of this situation is that it is difficult, if not impractical, for research groups not using identical hardware and software to exchange data to compare methods and results, and within each group, migration to new hardware or software is discouraged or results in incompatible data formats.</p></sec><sec id="s2b" hwp:id="sec-4"><label>2.2</label><title hwp:id="title-5">Examples of other formats</title><p hwp:id="p-13">The need for standard file formats for domain-specific data sets is a common occurrence in many scientific fields. Most in the biophysics community will be familiar with the PDB file format for biomolecular structures maintained by the Protein Data Bank(<xref rid="c32" ref-type="bibr" hwp:id="xref-ref-32-1" hwp:rel-id="ref-32">32</xref>), or with the already mentioned TIFF format for images. The latter format, copyrighted by Adobe Systems, is only marginally adapted to the complexity of scientific data, but is used as a least common denominator export format by camera vendors in the absence of a better solution. The FITS format developed by the astronomy community(<xref rid="c33" ref-type="bibr" hwp:id="xref-ref-33-1" hwp:rel-id="ref-33">33</xref>) (and supported by some camera manufacturers) is a good example of a powerful alternative, although its design principles are dated and it has not been adopted by the biophysics or microscopy communities.</p><p hwp:id="p-14">In the single-molecule community, a text-based file format (SMD) was recently proposed to store data from a variety of surface-immobilized, camera-based experiments. These measurements consist of series of images, from which time traces (time binned data) are extracted for individual emitters identified in the series. These time traces have relatively short duration (limited by fluorophore bleaching) and therefore have minimal space requirements. The proposed SMD format based on JavaScript Object Notation (JSON)(<xref rid="c34" ref-type="bibr" hwp:id="xref-ref-34-1" hwp:rel-id="ref-34">34</xref>) is therefore an appropriate choice for these structured data sets of relatively small size. On the other end, using SMD for timestamp-based experiments, would be inefficient (due to its text-based nature) and result in irreversible information loss (due to the time binning).</p></sec></sec><sec id="s3" hwp:id="sec-5"><label>3.</label><title hwp:id="title-6">Proposal of a new file format</title><sec id="s3a" hwp:id="sec-6"><label>3.1</label><title hwp:id="title-7">Design principles</title><p hwp:id="p-15">The design of a standard file format for long-term data preservation and to facilitate interoperability and data sharing, presents several (often contrasting) requirements.</p><p hwp:id="p-16"><italic toggle="yes">Flexibility:</italic> the format must be capable of efficiently storing a variety of numeric data types and strings to represent both raw data and all metadata associated with an experiment. Moreover, the structure must be general enough to accommodate different types of time stamp-based single-molecule experiments. For instance, it should support experiments using continuous wave or pulsed excitation, one or many detection channels, one or more excitation wavelengths, etc. Since it would be impossible to predict all possible future technical developments, it should be easily extensible and customizable to accommodate them.</p><p hwp:id="p-17"><italic toggle="yes">Ease of use:</italic> in order to encourage adoption and facilitate long-term maintainability, the file structure and complexity should be kept as low as possible. It should be possible for a user to quickly write a reader for the file format in any programming language and operating system of choice. Furthermore, there should be tools to facilitate creation of data files that complies with the specifications.</p><p hwp:id="p-18"><italic toggle="yes">Small size:</italic> while disk storage is increasingly inexpensive, the advantages of a compact file format should not be overlooked. Smaller files are easier to backup, archive online and share as well as generally faster to read. The format must therefore support smart compression allowing fast read and write, and partial loading of large data sets.</p></sec><sec id="s3b" hwp:id="sec-7"><label>3.2</label><title hwp:id="title-8">The parent HDF5 format</title><p hwp:id="p-19">HDF5 is an existing open hierarchical file format satisfying all requirements listed previously. In the following, we provide a brief overview of the HDF5 format. Detailed information can be found on the HDF Group website(<xref rid="c35" ref-type="bibr" hwp:id="xref-ref-35-1" hwp:rel-id="ref-35">35</xref>).</p><p hwp:id="p-20">HDF5 is a general-purpose binary format designed to store numerical data sets, widely used in industry and in several scientific communities. HDF5 development is led by the non-profit HDF Group, which also maintains open-source platform-independent libraries to read and write HDF5 files in multiple languages.</p><p hwp:id="p-21">HDF5 has a hierarchical (tree-like) data structure similar to files and folders in a file system: groups are the equivalent of folders, whereas data fields (e.g. arrays) are the equivalent of files. The main group of a HDF5 file is called “root” (indicated by the slash character “/”) and can contain data fields or other groups. The HDF5 format is self-describing, meaning that a user does not need to know the hierarchical structure or the data types before reading the file. For example, in order to access a numerical array in a HDF5 file, the user only needs to specify its path: the array will be automatically loaded into memory using the appropriate data type. In other words, all the byte-level details (such as byte order and data type width) are transparently handled, greatly simplifying data reading and writing. Moreover, HDF5 transparently supports compression, allowing reducing file size while maintaining high reading speed without any added complexity for the user. Finally, each node in a HDF5 file (groups or data fields) can have any number of attributes, such as descriptions, which can be used to embed metadata to a dataset.</p><p hwp:id="p-22">Libraries to operate on HDF5 files currently exist for the major programming languages used in scientific computing, such as C, Fortran, C++, Java, Python, R, MATLAB and LabVIEW. Furthermore, a free multi-platform graphical viewer and editor (HDFView (<xref rid="c36" ref-type="bibr" hwp:id="xref-ref-36-1" hwp:rel-id="ref-36">36</xref>)) allows users to quickly explore, modify or export content of HDF5 files. The availability of well-maintained open source libraries allows users to reliably manage HDF5 files without the need to deal with the underlying byte-level structure, effectively overcoming the drawbacks of binary formats highlighted in section 2.</p><p hwp:id="p-23">HDF5 has been widely adopted in industry and in several scientific communities as the basis for specialized data formats. Because of its openness, popularity and long-term support, it represents a safe choice for long-term data preservation.</p></sec><sec id="s3c" hwp:id="sec-8"><label>3.3</label><title hwp:id="title-9">Photon-HDF5 file format</title><p hwp:id="p-24">HDF5 is the foundation for the proposed format for photon-counting single-molecule fluorescence data, therefore called “Photon-HDF5” file format.</p><p hwp:id="p-25">Photon-HDF5 is, essentially, a conventional structure to store timestamp-based single-molecule fluorescence data in HDF5 files (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Fig. 1</xref>). Since Photon-HDF5 files are HDF5 files, the requirements of an open, efficient, well-documented and platform- and language-independent are automatically fulfilled.</p><fig id="fig1" position="float" fig-type="figure" orientation="portrait" hwp:id="F1" hwp:rev-id="xref-fig-1-1 xref-fig-1-2 xref-fig-1-3 xref-fig-1-4"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;026484v2/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Figure 1:</label><caption hwp:id="caption-1"><p hwp:id="p-26">A Photon-HDF5 as seen with the HDFView visualizer. In contrast with other binary formats, Photon-HDF5 files (or any other HDF5 file) can be examined with an open source visualizer (HDFView). Note that the file structure (left pane) is immediately intelligible to the user, who can navigate it and select items for display or export. The time stamps array is selected in the left pane and its content displayed in the right pane. In the bottom pane, the TITLE attribute, among others, shows a description for the selected item (time stamps). Photon-HDF5 files include descriptions for every field facilitating interactive file exploration.</p></caption><graphic xlink:href="026484_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig><p hwp:id="p-27">We now briefly describe the main components of a Photon-HDF5 file. The interested reader is invited to visit the <italic toggle="yes">photon-hdf5.org</italic> website for further information and a complete description of the format and associated tools.</p><sec id="s3c1" hwp:id="sec-9"><label>3.3.1</label><title hwp:id="title-10">Photon-HDF5 structure</title><p hwp:id="p-28">The Photon-HDF5 file structure contains 5 main groups (<italic toggle="yes">photon_data</italic>, <italic toggle="yes">setup</italic>, <italic toggle="yes">sample</italic>, <italic toggle="yes">identity</italic> and <italic toggle="yes">provenance</italic>) and two root fields: a general description string (<italic toggle="yes">description</italic>) and the acquisition duration (<italic toggle="yes">acquisition_duration</italic>). The general structure is illustrated in <xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-1" hwp:rel-id="F2">Fig. 2</xref> (see also <xref ref-type="fig" rid="figS1" hwp:id="xref-fig-3-1" hwp:rel-id="F3">Fig. SI-1</xref> and <xref ref-type="fig" rid="figS2" hwp:id="xref-fig-4-1" hwp:rel-id="F4">SI-2</xref>), while <xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-2" hwp:rel-id="F1">Fig. 1</xref> shows a Photon-HDF5 file as it appears when opened with the HDFView visualizer.</p><fig id="fig2" position="float" fig-type="figure" orientation="portrait" hwp:id="F2" hwp:rev-id="xref-fig-2-1 xref-fig-2-2 xref-fig-2-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;026484v2/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Figure 2:</label><caption hwp:id="caption-2"><p hwp:id="p-29">Photon-HDF5 file structure. The core <italic toggle="yes">photon_data</italic> group contains the raw data. A file containing only raw data is still a valid Photon-HDF5 file but it cannot be analyzed without additional information on what the data represents. The optional (but recommended) <italic toggle="yes">measurement_specs</italic> group identifies the type of measurement and specifies the associated metadata (i.e. role of each detector, measurement parameters, etc). When <italic toggle="yes">measurement_spec</italic> is present, a user has all the information to analyze the data. The other groups enhance the data file, providing important measurement metadata. <italic toggle="yes">setup</italic> contains information on the system used for the acquisition (e.g. excitation wavelengths, power, excitation scheme, etc). <italic toggle="yes">sample</italic> contains sample information (dyes, buffer, etc…). The last two groups <italic toggle="yes">identity</italic> and <italic toggle="yes">provenance</italic> provide author and file information.</p></caption><graphic xlink:href="026484_fig2" position="float" orientation="portrait" hwp:id="graphic-2"/></fig><sec id="s3c1a" hwp:id="sec-10"><label>a.</label><title hwp:id="title-11">The <italic toggle="yes">photon_data</italic> group</title><p hwp:id="p-30">As visible in <xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-3" hwp:rel-id="F1">Fig. 1</xref> (and detailed in <xref ref-type="fig" rid="figS1" hwp:id="xref-fig-3-2" hwp:rel-id="F3">Fig. SI-1</xref>), the <italic toggle="yes">photon_data</italic> group contains the raw data (<italic toggle="yes">timestamps</italic>, <italic toggle="yes">detectors</italic> and <italic toggle="yes">nanotimes</italic> arrays), as well as information needed to analyze it (in the <italic toggle="yes">measurement_specs</italic> subgroup). All arrays in <italic toggle="yes">photon_data</italic> have the same length, equal to the number of recorded photons. Information corresponding to the ith photon (its macrotime stamp, detector identity, and when applicable, the microtime measured by TCSPC hardware, or nanotime) is stored the ith value of each of these arrays.</p><p hwp:id="p-31">Except for <italic toggle="yes">timestamps</italic>, the other arrays are present in a file only when needed, i.e. the <italic toggle="yes">detectors</italic> array is present only if there is more than one detector and the <italic toggle="yes">nanotimes</italic> array is present only if TCSPC timing data is recorded.</p><p hwp:id="p-32">Inside <italic toggle="yes">photon_data</italic>, the <italic toggle="yes">measurement_specs</italic> group contains the measurement type and a type-dependent set of metadata fields. The currently supported measurement types are listed in <xref ref-type="table" rid="tblS1" hwp:id="xref-table-wrap-1-1" hwp:rel-id="T1">Table SI-1</xref>. Each measurement type (specified in <italic toggle="yes">measurement_type</italic>) requires a particular set of fields which completely describe the experiment. For example, a single-laser single-molecule FRET data file will have a “smFRET” measurement type, and will include two numeric fields called <italic toggle="yes">spectral_ch1</italic> and <italic toggle="yes">spectral_ch2</italic> containing the donor and acceptor detector number.</p><p hwp:id="p-33">Defining a new measurement type consists in choosing a “name” and a set of required fields in the <italic toggle="yes">measurements_specs</italic> group. Since measurement types are mutually exclusive, new measurement types can be introduced without interfering with the previously defined ones (see <xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-2" hwp:rel-id="F2">Fig. 2</xref>). This approach allows the community to gradually (and safely) extend the file format to support new measurement types.</p><p hwp:id="p-34">The data contained in <italic toggle="yes">measurement_specs</italic> group provides all the necessary information needed to interpret the raw experimental data. Files not including a <italic toggle="yes">measurement_specs</italic> group are still valid Photon-HDF5 files but their content cannot be analyzed by a user without knowing additional measurement specifications.</p></sec><sec id="s3c1b" hwp:id="sec-11"><label>b.</label><title hwp:id="title-12">The <italic toggle="yes">setup</italic> group</title><p hwp:id="p-35">The <italic toggle="yes">setup</italic> group stores setup properties such as laser excitation wavelengths and powers, the number of detected spectral bands (e.g. 2-colors or 3-colors), the number of detected polarization states (e.g. none = 1 and 2 polarizations = 2) and the number of “split channels” (i.e. identical spectral or polarization channels split by non-polarizing beam-splitters).</p></sec><sec id="s3c1c" hwp:id="sec-12"><label>c.</label><title hwp:id="title-13">Metadata groups</title><p hwp:id="p-36">In addition to the previous groups, a Photon-HDF5 file may contain 3 other groups (<italic toggle="yes">sample</italic>, <italic toggle="yes">identity</italic> and <italic toggle="yes">provenance</italic>) which provide additional optional metadata (see <xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-3" hwp:rel-id="F2">Fig. 2</xref>, &amp; <xref ref-type="fig" rid="figS2" hwp:id="xref-fig-4-2" hwp:rel-id="F4">SI-2</xref>).</p><p hwp:id="p-37">The <italic toggle="yes">sample</italic> group contains a description of the sample (<italic toggle="yes">sample_name</italic>), the buffer (<italic toggle="yes">buffer_name</italic>) and the fluorophore names (<italic toggle="yes">dye_names</italic>). Storing this basic sample information with the data simplifies preservation of experimental details.</p><p hwp:id="p-38">The <italic toggle="yes">identity</italic> group contains identification metadata such as dataset <italic toggle="yes">author</italic> (and its affiliation), Photon-HDF5 format version, software used to save the file (and its version), and optional dataset identifiers such as DOI or URL. This information is important when sharing datasets online, in order to keep track of authorship and provide proper credit.</p><p hwp:id="p-39">As discussed in Section 4, a Photon-HDF5 file might be created by converting an original data file saved by an acquisition (or simulation) software outputting some custom file format. The <italic toggle="yes">provenance</italic> group is the place to store this information, such as the name and creation date of the original file, and the software used to save it.</p></sec></sec><sec id="s3c2" hwp:id="sec-13"><label>3.3.2</label><title hwp:id="title-14">Additional file format features</title><sec id="s3c2a" hwp:id="sec-14"><label>a.</label><title hwp:id="title-15">Field data types</title><p hwp:id="p-40">Leveraging the self-describing nature of HDF5, instead of prescribing specific data types, Photon-HDF5 specifications only indicate whether a field is a scalar, an array or a string and whether the data type is integer or floating point. For examples, the <italic toggle="yes">detectors</italic> array (array of detector IDs) typically uses an unsigned 8-bit integer type, which is sufficient for the majority of setups. However, when using SPAD arrays with more than 256 pixels, a 16- or 32-bit integer data type can be used without any modification to the file format.</p></sec><sec id="s3c2b" hwp:id="sec-15"><label>b.</label><title hwp:id="title-16">Custom user groups</title><p hwp:id="p-41">For maximum flexibility, users can store arbitrary amounts of additional (custom) data in any position within the Photon-HDF5 hierarchy. To avoid incompatibilities with future versions of the format, we require that custom data be stored inside a group (or subgroup) named <italic toggle="yes">user</italic>.</p></sec><sec id="s3c2c" hwp:id="sec-16"><label>c.</label><title hwp:id="title-17">Future Photon-HDF5 versions</title><p hwp:id="p-42">In order to guarantee long-term accessibility to Photon-HDF5 files, future versions of the file format software will be backward-compatible. Specifically, previously defined fields will never be renamed or have their meaning modified. This ensures that software written to read an old version will be still capable to correctly read a newer version, although it will not be able to interpret new fields or measurement types.</p></sec></sec><sec id="s3c3" hwp:id="sec-17"><label>3.3.3</label><title hwp:id="title-18">Photon-HDF5 software tools</title><p hwp:id="p-43">In order to facilitate the use and adoption of the Photon-HDF5 file format, we provide examples of how to read Photon-HDF5 files in several languages (currently Python, MATLAB and LabVIEW) (<xref rid="c26" ref-type="bibr" hwp:id="xref-ref-26-2" hwp:rel-id="ref-26">26</xref>).</p><p hwp:id="p-44">We developed and maintain an open-source python library to create Photon-HDF5 files, <italic toggle="yes">phconvert</italic>, serving as reference implementation for the Photon-HDF5 format(<xref rid="c25" ref-type="bibr" hwp:id="xref-ref-25-2" hwp:rel-id="ref-25">25</xref>). When writing Photon-HDF5 files, <italic toggle="yes">phconvert</italic> validates the input data (making sure that all required fields are present and have correct name and type) and adds a description to each field (see <xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-4" hwp:rel-id="F1">Fig. 1</xref> for an example).</p><p hwp:id="p-45">In addition, <italic toggle="yes">phconvert</italic> includes a browser-based interface using Jupyter Notebooks(<xref rid="c37" ref-type="bibr" hwp:id="xref-ref-37-1" hwp:rel-id="ref-37">37</xref>, <xref rid="c38" ref-type="bibr" hwp:id="xref-ref-38-1" hwp:rel-id="ref-38">38</xref>) to convert a few existing proprietary file formats into Photon-HDF5. The formats currently supported are HT3 (a file format created by PicoQuant for data acquired with their TCSPC hardware) and SPC/SET (a file format created by Becker &amp; Hickl for data acquired with their TCSPC hardware) as well as SM, a legacy file format developed by the Weiss Lab. Additional file formats can be easily added in the future. Examples of such data files and their converted Photon-HDF5 version are provided through the Photon-HDF5 website.</p></sec></sec></sec><sec id="s4" hwp:id="sec-18"><label>4</label><title hwp:id="title-19">Scenarios of Photon-HDF5 usage</title><p hwp:id="p-46">In this section, we illustrate a few use cases where employing the Photon-HDF5 format may lead to significant advantages.</p><p hwp:id="p-47">Researchers performing (or interested in) photon-counting based single-molecule experiments can be classified in the following 3 categories:
<list list-type="alpha-lower" hwp:id="list-1"><list-item hwp:id="list-item-1"><p hwp:id="p-48">Commercial acquisition hardware and software (Alice)</p></list-item><list-item hwp:id="list-item-2"><p hwp:id="p-49">Custom acquisition hardware and software (Bob)</p></list-item><list-item hwp:id="list-item-3"><p hwp:id="p-50">Mixture of a and b (Charlie)</p></list-item></list></p><p hwp:id="p-51">In each case, Alice, Bob and Charlie use one or more custom or proprietary binary formats to store data from their experiments, and will use a custom or commercial software to analyze their data. We now examine 3 typical situations encountered by researchers.</p><sec id="s4a" hwp:id="sec-19"><title hwp:id="title-20">Example 1 (Publication)</title><p hwp:id="p-52">Alice wants to publish an article including her data so that as many researchers as possible can look at it (including the reviewers, who may not, however, have time to process it and might just be curious to take a peek at it).</p><p hwp:id="p-53">The Photon-HDF5 format and HDFViewer will to the job for the reviewer and researchers using a different system, while the original format will allow only readers having the same commercial software to have a look at the data. If she uses one of the two most common commercial formats, she can use phconvert to create the Photon-HDF5 version. If not, writing code to create a Photon-HDF5 version should be simple thanks to the examples provided. Moreover, her code could be added to phconvert for the benefit of the entire community.</p></sec><sec id="s4b" hwp:id="sec-20"><title hwp:id="title-21">Example 2 (Collaboration)</title><p hwp:id="p-54">Alice and Bob want to collaborate on a project, Alice doing the experiments and Bob performing some custom analysis with his software.</p><p hwp:id="p-55">Since Bob doesn’t use Alice’s system, he would have to decipher the proprietary file format description of the vendor and extract the relevant data for his analysis. By asking Alice to first convert her file to the Photon-HDF5 format with phconvert, he will benefit from file size reduction, simple access to the data, and by incorporating the necessary code in his software, he will gain access to a variety of other files generated by other users of Photon-HDF5.</p></sec><sec id="s4c" hwp:id="sec-21"><title hwp:id="title-22">Example 3 (Data Management)</title><p hwp:id="p-56">Charlie works with a student running some experiments on a commercial system, which he wants to compare to similar experiments he is carrying out on a new setup he has built with custom hardware and software.</p><p hwp:id="p-57">Since Charlie needs to save new data, he needs a new format. But he also needs to read data generated by the student. The least effort consists in using a format which is efficient, well-documented and supported and in which his student’s files can be easily converted. Photon-HDF5 naturally fits the bill, and additionally provides him with the same benefits enjoyed by Alice and Bob for publication and sharing.</p><p hwp:id="p-58">While these scenarios do not directly involve manufacturers of single-photon counting hardware and their associated software, it is clear that manufacturers should take some interest in an effort such as Photon-HDF5. While it is not expected that they would abandon their proprietary format, their contribution to the definition of future versions of the format or to conversion tools is welcome and encouraged, as is that of anyone interested in the research community.</p></sec></sec><sec id="s5" hwp:id="sec-22"><label>5.</label><title hwp:id="title-23">Conclusions &amp; Perspectives</title><p hwp:id="p-59">We have developed the Photon-HDF5 file format as a hardware-agnostic format for single-molecule fluorescence data based on photon-counting detectors. Photon-HDF5 is easy to use, customize and extend, in addition to inheriting all the advantages of the HDF5 format (open standard, self-described and efficient).</p><p hwp:id="p-60">The format has been designed both for interoperability between different analysis software and long-term data archival. For this purpose, it includes a rich set of metadata to make self-contained measurement data files. Photon-HDF5 facilitates data sharing between research groups by reducing the efforts needed to decode the wide variety of binary formats used across laboratories.</p><p hwp:id="p-61">While we have only discussed standard single-spot confocal experiments in the text, the format supports and is currently used for multi-spot experiments using multi-pixel SPAD arrays(<xref rid="c24" ref-type="bibr" hwp:id="xref-ref-24-2" hwp:rel-id="ref-24">24</xref>). Further extensions to accommodate future developments or new measurement types can be naturally incorporated.</p><p hwp:id="p-62">Currently, the open source FRETBursts software package for smFRET burst analysis supports reading Photon-HDF5 files(<xref rid="c39" ref-type="bibr" hwp:id="xref-ref-39-1" hwp:rel-id="ref-39">39</xref>). Therefore, converting smFRET data to Photon-HDF5 already enables researchers to analyze a variety of data with an alternative software. Other software packages supporting Photon-HDF5 files are expected to be released in the near future.</p><p hwp:id="p-63">The impact of Photon-HDF5 format will be determined by the extent of its adoption in the single-molecule community and its support by scientific publishers. To maximize the involvement of third parties, we embraced an open development model for both the format specification and the support software. Users are encouraged to send feedback (e.g. on perceived limitations or to add support for new measurement types) or other contributions. To facilitate the process, we include guidelines for contributors directly in the Photon-HDF5 reference documentation(<xref rid="c24" ref-type="bibr" hwp:id="xref-ref-24-3" hwp:rel-id="ref-24">24</xref>). Finally, by adopting an open consensus-based governance, we aim to empower the single-molecule community to determine the future directions of Photon-HDF5 format in order to become a standard widely-useful tool for data sharing and preservation.</p></sec></body><back><sec id="s5a" hwp:id="sec-23"><title hwp:id="title-24">Author Contributions</title><p hwp:id="p-64">AI designed the file format, implemented the supporting software, wrote the reference documentation, websites and manuscript; TL designed the file format, implemented reading examples, wrote the manuscript; SW wrote the manuscript; XM designed the file format, implemented reading examples, wrote the manuscript.</p></sec><ack hwp:id="ack-1"><title hwp:id="title-25">Acknowledgements</title><p hwp:id="p-65">We thank Robert Boutelle for writing the example MATLAB script to read Photon-HDF5 files, Sangyoon Chung and Eitan Lerner for providing experimental data files. This work was supported in part by NIH Grant R01-GM95904 and by DOE Grant DE-FC02-02ER63421-00.</p></ack><ref-list hwp:id="ref-list-1"><title hwp:id="title-26">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1"><label>1.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.1" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Lippincott-Schwartz J."><surname>Lippincott-Schwartz</surname>, <given-names>J.</given-names></string-name> <year>2015</year>. <article-title hwp:id="article-title-2">Profile of Eric Betzig, Stefan Hell, and W. E. Moerner, 2014 Nobel Laureates in Chemistry</article-title>. <source hwp:id="source-1">Proc. Natl. Acad. Sci. U. S. A.</source> <volume>112</volume>: <fpage>2630</fpage>–<lpage>2</lpage>.</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1"><label>2.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="McKinney S.A."><surname>McKinney</surname>, <given-names>S.A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Joo C."><given-names>C.</given-names> <surname>Joo</surname></string-name>, and <string-name name-style="western" hwp:sortable="Ha T."><given-names>T.</given-names> <surname>Ha</surname></string-name>. <year>2006</year>. <article-title hwp:id="article-title-3">Analysis of single-molecule FRET trajectories using hidden Markov modeling</article-title>. <source hwp:id="source-2">Biophys. J.</source> <volume>91</volume>: <fpage>1941</fpage>–<lpage>51</lpage>.</citation></ref><ref id="c3" hwp:id="ref-3"><label>3.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.3" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Van de Meent J.-W."><surname>Van de Meent</surname>, <given-names>J.-W.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Bronson J.E."><given-names>J.E.</given-names> <surname>Bronson</surname></string-name>, <string-name name-style="western" hwp:sortable="Wiggins C.H."><given-names>C.H.</given-names> <surname>Wiggins</surname></string-name>, and <string-name name-style="western" hwp:sortable="Gonzalez R.L."><given-names>R.L.</given-names> <surname>Gonzalez</surname></string-name>. <year>2014</year>. <article-title hwp:id="article-title-4">Empirical Bayes methods enable advanced population-level analyses of single-molecule FRET experiments</article-title>. <source hwp:id="source-3">Biophys. J.</source> <volume>106</volume>: <fpage>1327</fpage>–<lpage>37</lpage>.</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1"><label>4.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.4" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Greenfeld M."><surname>Greenfeld</surname>, <given-names>M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Pavlichin D.S."><given-names>D.S.</given-names> <surname>Pavlichin</surname></string-name>, <string-name name-style="western" hwp:sortable="Mabuchi H."><given-names>H.</given-names> <surname>Mabuchi</surname></string-name>, and <string-name name-style="western" hwp:sortable="Herschlag D."><given-names>D.</given-names> <surname>Herschlag</surname></string-name>. <year>2012</year>. <article-title hwp:id="article-title-5">Single Molecule Analysis Research Tool (SMART): an integrated approach for analyzing single molecule data</article-title>. <source hwp:id="source-4">PLoS One.</source> <volume>7</volume>: <fpage>e30024</fpage>.</citation></ref><ref id="c5" hwp:id="ref-5" hwp:rev-id="xref-ref-5-1"><label>5.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.5" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Fries J.R."><surname>Fries</surname>, <given-names>J.R.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Brand L."><given-names>L.</given-names> <surname>Brand</surname></string-name>, <string-name name-style="western" hwp:sortable="Eggeling C."><given-names>C.</given-names> <surname>Eggeling</surname></string-name>, <string-name name-style="western" hwp:sortable="Köllner M."><given-names>M.</given-names> <surname>Köllner</surname></string-name>, and <string-name name-style="western" hwp:sortable="Seidel C.A.M."><given-names>C.A.M.</given-names> <surname>Seidel</surname></string-name>. <year>1998</year>. <article-title hwp:id="article-title-6">Quantitative Identification of Different Single Molecules by Selective Time-Resolved Confocal Fluorescence Spectroscopy</article-title>. <source hwp:id="source-5">J. Phys. Chem. A.</source> <volume>102</volume>: <fpage>6601</fpage>–<lpage>6613</lpage>.</citation></ref><ref id="c6" hwp:id="ref-6"><label>6.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.6" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Dahan M."><surname>Dahan</surname>, <given-names>M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Deniz A.A."><given-names>A.A.</given-names> <surname>Deniz</surname></string-name>, <string-name name-style="western" hwp:sortable="Ha T."><given-names>T.</given-names> <surname>Ha</surname></string-name>, <string-name name-style="western" hwp:sortable="Chemla D.S."><given-names>D.S.</given-names> <surname>Chemla</surname></string-name>, <string-name name-style="western" hwp:sortable="Schultz P.G."><given-names>P.G.</given-names> <surname>Schultz</surname></string-name>, and <string-name name-style="western" hwp:sortable="Weiss S."><given-names>S.</given-names> <surname>Weiss</surname></string-name>. <year>1999</year>. <article-title hwp:id="article-title-7">Ratiometric measurement and identification of single diffusing molecules</article-title>. <source hwp:id="source-6">Chem. Phys.</source> <volume>247</volume>: <fpage>85</fpage>–<lpage>106</lpage>.</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1"><label>7.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.7" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Boukobza E."><surname>Boukobza</surname>, <given-names>E.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Sonnenfeld A."><given-names>A.</given-names> <surname>Sonnenfeld</surname></string-name>, and <string-name name-style="western" hwp:sortable="Haran G."><given-names>G.</given-names> <surname>Haran</surname></string-name>. <year>2001</year>. <article-title hwp:id="article-title-8">Immobilization in Surface-Tethered Lipid Vesicles as a New Tool for Single Biomolecule Spectroscopy</article-title>. <source hwp:id="source-7">J. Phys. Chem. B.</source> <volume>105</volume>: <fpage>12165</fpage>–<lpage>12170</lpage>.</citation></ref><ref id="c8" hwp:id="ref-8" hwp:rev-id="xref-ref-8-1"><label>8.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Lipman E.A."><surname>Lipman</surname>, <given-names>E.A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Schuler B."><given-names>B.</given-names> <surname>Schuler</surname></string-name>, <string-name name-style="western" hwp:sortable="Bakajin O."><given-names>O.</given-names> <surname>Bakajin</surname></string-name>, and <string-name name-style="western" hwp:sortable="Eaton W.A."><given-names>W.A.</given-names> <surname>Eaton</surname></string-name>. <year>2003</year>. <article-title hwp:id="article-title-9">Single-molecule measurement of protein folding kinetics</article-title>. <source hwp:id="source-8">Science.</source> <volume>301</volume>: <fpage>1233</fpage>–<lpage>1235</lpage>.</citation></ref><ref id="c9" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1"><label>9.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.9" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Fields A.P."><surname>Fields</surname>, <given-names>A.P.</given-names></string-name>, and <string-name name-style="western" hwp:sortable="Cohen A.E."><given-names>A.E.</given-names> <surname>Cohen</surname></string-name>. <year>2011</year>. <article-title hwp:id="article-title-10">Electrokinetic trapping at the one nanometer limit</article-title>. <source hwp:id="source-9">Proc. Natl. Acad. Sci. U. S. A.</source> <volume>108</volume>: <fpage>8937</fpage>–<lpage>42</lpage>.</citation></ref><ref id="c10" hwp:id="ref-10"><label>10.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="Wang Q."><surname>Wang</surname>, <given-names>Q.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Goldsmith R.H."><given-names>R.H.</given-names> <surname>Goldsmith</surname></string-name>, <string-name name-style="western" hwp:sortable="Jiang Y."><given-names>Y.</given-names> <surname>Jiang</surname></string-name>, <string-name name-style="western" hwp:sortable="Bockenhauer S.D."><given-names>S.D.</given-names> <surname>Bockenhauer</surname></string-name>, and <string-name name-style="western" hwp:sortable="Moerner W.E."><given-names>W.E.</given-names> <surname>Moerner</surname></string-name>. <year>2012</year>. <article-title hwp:id="article-title-11">Probing single biomolecules in solution using the anti-Brownian electrokinetic (ABEL) trap</article-title>. <source hwp:id="source-10">Acc. Chem. Res.</source> <volume>45</volume>: <fpage>1955</fpage>–<lpage>64</lpage>.</citation></ref><ref id="c11" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1"><label>11.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.11" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="McHale K."><surname>McHale</surname>, <given-names>K.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Berglund A.J."><given-names>A.J.</given-names> <surname>Berglund</surname></string-name>, and <string-name name-style="western" hwp:sortable="Mabuchi H."><given-names>H.</given-names> <surname>Mabuchi</surname></string-name>. <year>2007</year>. <article-title hwp:id="article-title-12">Quantum dot photon statistics measured by three-dimensional particle tracking</article-title>. <source hwp:id="source-11">Nano Lett.</source> <volume>7</volume>: <fpage>3535</fpage>–<lpage>9</lpage>.</citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1"><label>12.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.12" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Yang H."><surname>Yang</surname>, <given-names>H.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Luo G."><given-names>G.</given-names> <surname>Luo</surname></string-name>, <string-name name-style="western" hwp:sortable="Karnchanaphanurach P."><given-names>P.</given-names> <surname>Karnchanaphanurach</surname></string-name>, <string-name name-style="western" hwp:sortable="Louie T.-M."><given-names>T.-M.</given-names> <surname>Louie</surname></string-name>, <string-name name-style="western" hwp:sortable="Rech I."><given-names>I.</given-names> <surname>Rech</surname></string-name>, <string-name name-style="western" hwp:sortable="Cova S."><given-names>S.</given-names> <surname>Cova</surname></string-name>, <string-name name-style="western" hwp:sortable="Xun L."><given-names>L.</given-names> <surname>Xun</surname></string-name>, and <string-name name-style="western" hwp:sortable="Xie X.S."><given-names>X.S.</given-names> <surname>Xie</surname></string-name>. <year>2003</year>. <article-title hwp:id="article-title-13">Protein conformational dynamics probed by single-molecule electron transfer</article-title>. <source hwp:id="source-12">Science.</source> <volume>302</volume>: <fpage>262</fpage>–<lpage>6</lpage>.</citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1"><label>13.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.13" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="Weiss S."><surname>Weiss</surname>, <given-names>S.</given-names></string-name> <year>1999</year>. <article-title hwp:id="article-title-14">Fluorescence spectroscopy of single biomolecules</article-title>. <source hwp:id="source-13">Science.</source> <volume>283</volume>: <fpage>1676</fpage>–<lpage>1683</lpage>.</citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1"><label>14.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.14" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Kapanidis A.N."><surname>Kapanidis</surname>, <given-names>A.N.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Lee N.K."><given-names>N.K.</given-names> <surname>Lee</surname></string-name>, <string-name name-style="western" hwp:sortable="Laurence T.A."><given-names>T.A.</given-names> <surname>Laurence</surname></string-name>, <string-name name-style="western" hwp:sortable="Doose S."><given-names>S.</given-names> <surname>Doose</surname></string-name>, <string-name name-style="western" hwp:sortable="Margeat E."><given-names>E.</given-names> <surname>Margeat</surname></string-name>, and <string-name name-style="western" hwp:sortable="Weiss S."><given-names>S.</given-names> <surname>Weiss</surname></string-name>. <year>2004</year>. <article-title hwp:id="article-title-15">Fluorescence-aided molecule sorting: analysis of structure and interactions by alternating-laser excitation of single molecules</article-title>. <source hwp:id="source-14">Proc. Natl. Acad. Sci. U. S. A.</source> <volume>101</volume>: <fpage>8936</fpage>–<lpage>41</lpage>.</citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1"><label>15.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.15" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Laurence T.A."><surname>Laurence</surname>, <given-names>T.A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kong X."><given-names>X.</given-names> <surname>Kong</surname></string-name>, <string-name name-style="western" hwp:sortable="Jäger M."><given-names>M.</given-names> <surname>Jäger</surname></string-name>, and <string-name name-style="western" hwp:sortable="Weiss S."><given-names>S.</given-names> <surname>Weiss</surname></string-name>. <year>2005</year>. <article-title hwp:id="article-title-16">Probing structural heterogeneities and fluctuations of nucleic acids and denatured proteins</article-title>. <source hwp:id="source-15">Proc. Natl. Acad. Sci. U. S. A.</source> <volume>102</volume>: <fpage>17348</fpage>–<lpage>17353</lpage>.</citation></ref><ref id="c16" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1"><label>16.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.16" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Müller B.K."><surname>Müller</surname>, <given-names>B.K.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Zaychikov E."><given-names>E.</given-names> <surname>Zaychikov</surname></string-name>, <string-name name-style="western" hwp:sortable="Bräuchle C."><given-names>C.</given-names> <surname>Bräuchle</surname></string-name>, and <string-name name-style="western" hwp:sortable="Lamb D.C."><given-names>D.C.</given-names> <surname>Lamb</surname></string-name>. <year>2005</year>. <article-title hwp:id="article-title-17">Pulsed interleaved excitation</article-title>. <source hwp:id="source-16">Biophys. J.</source> <volume>89</volume>: <fpage>3508</fpage>–<lpage>22</lpage>.</citation></ref><ref id="c17" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1"><label>17.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.17" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="Orte A."><surname>Orte</surname>, <given-names>A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Clarke R."><given-names>R.</given-names> <surname>Clarke</surname></string-name>, <string-name name-style="western" hwp:sortable="Balasubramanian S."><given-names>S.</given-names> <surname>Balasubramanian</surname></string-name>, and <string-name name-style="western" hwp:sortable="Klenerman D."><given-names>D.</given-names> <surname>Klenerman</surname></string-name>. <year>2006</year>. <article-title hwp:id="article-title-18">Determination of the fraction and stoichiometry of femtomolar levels of biomolecular complexes in an excess of monomer using single-molecule, two-color coincidence detection</article-title>. <source hwp:id="source-17">Anal. Chem.</source> <volume>78</volume>: <fpage>7707</fpage>–<lpage>15</lpage>.</citation></ref><ref id="c18" hwp:id="ref-18" hwp:rev-id="xref-ref-18-1"><label>18.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.18" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-18"><string-name name-style="western" hwp:sortable="Clarke R.W."><surname>Clarke</surname>, <given-names>R.W.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Orte A."><given-names>A.</given-names> <surname>Orte</surname></string-name>, and <string-name name-style="western" hwp:sortable="Klenerman D."><given-names>D.</given-names> <surname>Klenerman</surname></string-name>. <year>2007</year>. <article-title hwp:id="article-title-19">Optimized threshold selection for single-molecule two-color fluorescence coincidence spectroscopy</article-title>. <source hwp:id="source-18">Anal. Chem.</source> <volume>79</volume>: <fpage>2771</fpage>–<lpage>7</lpage>.</citation></ref><ref id="c19" hwp:id="ref-19" hwp:rev-id="xref-ref-19-1"><label>19.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.19" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-19"><string-name name-style="western" hwp:sortable="Ha T."><surname>Ha</surname>, <given-names>T.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Enderle T."><given-names>T.</given-names> <surname>Enderle</surname></string-name>, <string-name name-style="western" hwp:sortable="Chemla D.S."><given-names>D.S.</given-names> <surname>Chemla</surname></string-name>, <string-name name-style="western" hwp:sortable="Selvin P.R."><given-names>P.R.</given-names> <surname>Selvin</surname></string-name>, and <string-name name-style="western" hwp:sortable="Weiss S."><given-names>S.</given-names> <surname>Weiss</surname></string-name>. <year>1996</year>. <article-title hwp:id="article-title-20">Single Molecule Dynamics Studied by Polarization Modulation</article-title>. <source hwp:id="source-19">Phys. Rev. Lett.</source> <volume>77</volume>: <fpage>3979</fpage>–<lpage>3982</lpage>.</citation></ref><ref id="c20" hwp:id="ref-20" hwp:rev-id="xref-ref-20-1"><label>20.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.20" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-20"><string-name name-style="western" hwp:sortable="Schaffer J."><surname>Schaffer</surname>, <given-names>J.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Volkmer A."><given-names>A.</given-names> <surname>Volkmer</surname></string-name>, <string-name name-style="western" hwp:sortable="Eggeling C."><given-names>C.</given-names> <surname>Eggeling</surname></string-name>, <string-name name-style="western" hwp:sortable="Subramaniam V."><given-names>V.</given-names> <surname>Subramaniam</surname></string-name>, <string-name name-style="western" hwp:sortable="Striker G."><given-names>G.</given-names> <surname>Striker</surname></string-name>, and <string-name name-style="western" hwp:sortable="Seidel C.A.M."><given-names>C.A.M.</given-names> <surname>Seidel</surname></string-name>. <year>1999</year>. <article-title hwp:id="article-title-21">Identification of Single Molecules in Aqueous Solution by Time-Resolved Fluorescence Anisotropy</article-title>. <source hwp:id="source-20">J. Phys. Chem. A.</source> <volume>103</volume>: <fpage>331</fpage>–<lpage>336</lpage>.</citation></ref><ref id="c21" hwp:id="ref-21" hwp:rev-id="xref-ref-21-1"><label>21.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.21" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-21"><string-name name-style="western" hwp:sortable="Rigler R."><surname>Rigler</surname>, <given-names>R.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Mets Ü."><given-names>Ü.</given-names> <surname>Mets</surname></string-name>, <string-name name-style="western" hwp:sortable="Widengren J."><given-names>J.</given-names> <surname>Widengren</surname></string-name>, and <string-name name-style="western" hwp:sortable="Kask P."><given-names>P.</given-names> <surname>Kask</surname></string-name>. <year>1993</year>. <article-title hwp:id="article-title-22">Fluorescence correlation spectroscopy with high count rate and low background: analysis of translational diffusion</article-title>. <source hwp:id="source-21">Eur. Biophys. J</source>. <volume>22</volume>.</citation></ref><ref id="c22" hwp:id="ref-22" hwp:rev-id="xref-ref-22-1"><label>22.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.22" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-22"><string-name name-style="western" hwp:sortable="Schwille P."><surname>Schwille</surname>, <given-names>P.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Meyer-Almes F.J."><given-names>F.J.</given-names> <surname>Meyer-Almes</surname></string-name>, and <string-name name-style="western" hwp:sortable="Rigler R."><given-names>R.</given-names> <surname>Rigler</surname></string-name>. <year>1997</year>. <article-title hwp:id="article-title-23">Dual-color fluorescence cross-correlation spectroscopy for multicomponent diffusional analysis in solution</article-title>. <source hwp:id="source-22">Biophys. J.</source> <volume>72</volume>: <fpage>1878</fpage>–<lpage>1886</lpage>.</citation></ref><ref id="c23" hwp:id="ref-23" hwp:rev-id="xref-ref-23-1"><label>23.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.23" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-23"><string-name name-style="western" hwp:sortable="Eggeling C."><surname>Eggeling</surname>, <given-names>C.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Berger S."><given-names>S.</given-names> <surname>Berger</surname></string-name>, <string-name name-style="western" hwp:sortable="Brand L."><given-names>L.</given-names> <surname>Brand</surname></string-name>, <string-name name-style="western" hwp:sortable="Fries J.R."><given-names>J.R.</given-names> <surname>Fries</surname></string-name>, <string-name name-style="western" hwp:sortable="Schaffer J."><given-names>J.</given-names> <surname>Schaffer</surname></string-name>, <string-name name-style="western" hwp:sortable="Volkmer A."><given-names>A.</given-names> <surname>Volkmer</surname></string-name>, and <string-name name-style="western" hwp:sortable="Seidel C.A.M."><given-names>C.A.M.</given-names> <surname>Seidel</surname></string-name>. <year>2001</year>. <article-title hwp:id="article-title-24">Data registration and selective single-molecule analysis using multi-parameter fluorescence detection</article-title>. <source hwp:id="source-23">J. Biotechnol.</source> <volume>86</volume>: <fpage>163</fpage>–<lpage>180</lpage>.</citation></ref><ref id="c24" hwp:id="ref-24" hwp:rev-id="xref-ref-24-1 xref-ref-24-2 xref-ref-24-3"><label>24.</label><citation publication-type="website" citation-type="web" ref:id="026484v2.24" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-24"><collab hwp:id="collab-1">Photon-HDF5 Home Page</collab>. <ext-link l:rel="related" l:ref-type="uri" l:ref="http://photon-hdf5.org" ext-link-type="uri" xlink:href="http://photon-hdf5.org" hwp:id="ext-link-2">http://photon-hdf5.org</ext-link>.</citation></ref><ref id="c25" hwp:id="ref-25" hwp:rev-id="xref-ref-25-1 xref-ref-25-2"><label>25.</label><citation publication-type="website" citation-type="web" ref:id="026484v2.25" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-25"><string-name name-style="western" hwp:sortable="Ingargiola A."><surname>Ingargiola</surname>, <given-names>A.</given-names></string-name> <source hwp:id="source-24">phconvert - Library and converter for Photon-HDF5 files</source>. <ext-link l:rel="related" l:ref-type="uri" l:ref="http://photon-hdf5.github.io/phconvert" ext-link-type="uri" xlink:href="http://photon-hdf5.github.io/phconvert" hwp:id="ext-link-3">http://photon-hdf5.github.io/phconvert</ext-link>.</citation></ref><ref id="c26" hwp:id="ref-26" hwp:rev-id="xref-ref-26-1 xref-ref-26-2"><label>26.</label><citation publication-type="website" citation-type="web" ref:id="026484v2.26" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-26"><collab hwp:id="collab-2">Reading Photon-HDF5 in multiple languages</collab>. <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/Photon-HDF5/photon_hdf5_reading_examples" ext-link-type="uri" xlink:href="https://github.com/Photon-HDF5/photon_hdf5_reading_examples" hwp:id="ext-link-4">https://github.com/Photon-HDF5/photon_hdf5_reading_examples</ext-link>.</citation></ref><ref id="c27" hwp:id="ref-27" hwp:rev-id="xref-ref-27-1"><label>27.</label><citation publication-type="website" citation-type="web" ref:id="026484v2.27" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-27"><collab hwp:id="collab-3">Photon-HDF5 project page on GitHub</collab>. <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/Photon-HDF5" ext-link-type="uri" xlink:href="https://github.com/Photon-HDF5" hwp:id="ext-link-5">https://github.com/Photon-HDF5</ext-link>.</citation></ref><ref id="c28" hwp:id="ref-28" hwp:rev-id="xref-ref-28-1"><label>28.</label><citation publication-type="website" citation-type="web" ref:id="026484v2.28" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-28"><collab hwp:id="collab-4">Photon-HDF5: Guidelines for contributors</collab>. <ext-link l:rel="related" l:ref-type="uri" l:ref="http://photon-hdf5.readthedocs.org/en/latest/contributing.html" ext-link-type="uri" xlink:href="http://photon-hdf5.readthedocs.org/en/latest/contributing.html" hwp:id="ext-link-6">http://photon-hdf5.readthedocs.org/en/latest/contributing.html</ext-link>.</citation></ref><ref id="c29" hwp:id="ref-29" hwp:rev-id="xref-ref-29-1"><label>29.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.29" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-29"><string-name name-style="western" hwp:sortable="Rech I."><surname>Rech</surname>, <given-names>I.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Marangoni S."><given-names>S.</given-names> <surname>Marangoni</surname></string-name>, <string-name name-style="western" hwp:sortable="Resnati D."><given-names>D.</given-names> <surname>Resnati</surname></string-name>, <string-name name-style="western" hwp:sortable="Ghioni M."><given-names>M.</given-names> <surname>Ghioni</surname></string-name>, and <string-name name-style="western" hwp:sortable="Cova S."><given-names>S.</given-names> <surname>Cova</surname></string-name>. <year>2009</year>. <article-title hwp:id="article-title-25">Multipixel single-photon avalanche diode array for parallel photon counting applications</article-title>. <source hwp:id="source-25">J. Mod. Opt.</source> <volume>56</volume>: <fpage>326</fpage>–<lpage>333</lpage>.</citation></ref><ref id="c30" hwp:id="ref-30"><label>30.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.30" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-30"><string-name name-style="western" hwp:sortable="Laurence T.A."><surname>Laurence</surname>, <given-names>T.A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Ly S."><given-names>S.</given-names> <surname>Ly</surname></string-name>, <string-name name-style="western" hwp:sortable="Bourguet F."><given-names>F.</given-names> <surname>Bourguet</surname></string-name>, <string-name name-style="western" hwp:sortable="Fischer N.O."><given-names>N.O.</given-names> <surname>Fischer</surname></string-name>, and <string-name name-style="western" hwp:sortable="Coleman M.A."><given-names>M.A.</given-names> <surname>Coleman</surname></string-name>. <year>2014</year>. <article-title hwp:id="article-title-26">Fluorescence correlation spectroscopy at micromolar concentrations without optical nanoconfinement</article-title>. <source hwp:id="source-26">J. Phys. Chem. B.</source> <volume>118</volume>: <fpage>9662</fpage>–<lpage>9667</lpage>.</citation></ref><ref id="c31" hwp:id="ref-31" hwp:rev-id="xref-ref-31-1"><label>31.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.31" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-31"><string-name name-style="western" hwp:sortable="Michalet X."><surname>Michalet</surname>, <given-names>X.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Ingargiola A."><given-names>A.</given-names> <surname>Ingargiola</surname></string-name>, <string-name name-style="western" hwp:sortable="Colyer R.A."><given-names>R.A.</given-names> <surname>Colyer</surname></string-name>, <string-name name-style="western" hwp:sortable="Scalia G."><given-names>G.</given-names> <surname>Scalia</surname></string-name>, <string-name name-style="western" hwp:sortable="Weiss S."><given-names>S.</given-names> <surname>Weiss</surname></string-name>, <string-name name-style="western" hwp:sortable="Maccagnani P."><given-names>P.</given-names> <surname>Maccagnani</surname></string-name>, <string-name name-style="western" hwp:sortable="Gulinatti A."><given-names>A.</given-names> <surname>Gulinatti</surname></string-name>, <string-name name-style="western" hwp:sortable="Rech I."><given-names>I.</given-names> <surname>Rech</surname></string-name>, and <string-name name-style="western" hwp:sortable="Ghioni M."><given-names>M.</given-names> <surname>Ghioni</surname></string-name>. <year>2014</year>. <article-title hwp:id="article-title-27">Silicon Photon-Counting Avalanche Diodes for Single-Molecule Fluorescence Spectroscopy</article-title>. <source hwp:id="source-27">IEEE J. Sel. Top. Quantum Electron</source>. <volume>20</volume>: <fpage>1</fpage>–<lpage>20</lpage>.</citation></ref><ref id="c32" hwp:id="ref-32" hwp:rev-id="xref-ref-32-1"><label>32.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.32" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-32"><string-name name-style="western" hwp:sortable="Berman H."><surname>Berman</surname>, <given-names>H.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Henrick K."><given-names>K.</given-names> <surname>Henrick</surname></string-name>, and <string-name name-style="western" hwp:sortable="Nakamura H."><given-names>H.</given-names> <surname>Nakamura</surname></string-name>. <year>2003</year>. <article-title hwp:id="article-title-28">Announcing the worldwide Protein Data Bank</article-title>. <source hwp:id="source-28">Nat. Struct. Biol.</source> <volume>10</volume>: <fpage>980</fpage>.</citation></ref><ref id="c33" hwp:id="ref-33" hwp:rev-id="xref-ref-33-1"><label>33.</label><citation publication-type="website" citation-type="web" ref:id="026484v2.33" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-33"><collab hwp:id="collab-5">FITS, The Astronomical Image Table Format</collab>. <ext-link l:rel="related" l:ref-type="uri" l:ref="http://fits.gsfc.nasa.gov/" ext-link-type="uri" xlink:href="http://fits.gsfc.nasa.gov/" hwp:id="ext-link-7">http://fits.gsfc.nasa.gov/</ext-link>.</citation></ref><ref id="c34" hwp:id="ref-34" hwp:rev-id="xref-ref-34-1"><label>34.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.34" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-34"><string-name name-style="western" hwp:sortable="Greenfeld M."><surname>Greenfeld</surname>, <given-names>M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="van de Meent J.-W."><given-names>J.-W.</given-names> <surname>van de Meent</surname></string-name>, <string-name name-style="western" hwp:sortable="Pavlichin D.S."><given-names>D.S.</given-names> <surname>Pavlichin</surname></string-name>, <string-name name-style="western" hwp:sortable="Mabuchi H."><given-names>H.</given-names> <surname>Mabuchi</surname></string-name>, <string-name name-style="western" hwp:sortable="Wiggins C.H."><given-names>C.H.</given-names> <surname>Wiggins</surname></string-name>, <string-name name-style="western" hwp:sortable="Gonzalez R.L."><given-names>R.L.</given-names> <surname>Gonzalez</surname></string-name>, and <string-name name-style="western" hwp:sortable="Herschlag D."><given-names>D.</given-names> <surname>Herschlag</surname></string-name>. <year>2015</year>. <article-title hwp:id="article-title-29">Single-molecule dataset (SMD): a generalized storage format for raw and processed single-molecule data</article-title>. <source hwp:id="source-29">BMC Bioinformatics.</source> <volume>16</volume>: <fpage>3</fpage>.</citation></ref><ref id="c35" hwp:id="ref-35" hwp:rev-id="xref-ref-35-1"><label>35.</label><citation publication-type="website" citation-type="web" ref:id="026484v2.35" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-35"><collab hwp:id="collab-6">HDF5 Homepage</collab>. <ext-link l:rel="related" l:ref-type="uri" l:ref="https://www.hdfgroup.org/HDF5/" ext-link-type="uri" xlink:href="https://www.hdfgroup.org/HDF5/" hwp:id="ext-link-8">https://www.hdfgroup.org/HDF5/</ext-link>.</citation></ref><ref id="c36" hwp:id="ref-36" hwp:rev-id="xref-ref-36-1"><label>36.</label><citation publication-type="website" citation-type="web" ref:id="026484v2.36" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-36"><collab hwp:id="collab-7">HDFView Homepage</collab>. <ext-link l:rel="related" l:ref-type="uri" l:ref="https://www.hdfgroup.org/products/java/release/download.html" ext-link-type="uri" xlink:href="https://www.hdfgroup.org/products/java/release/download.html" hwp:id="ext-link-9">https://www.hdfgroup.org/products/java/release/download.html</ext-link>.</citation></ref><ref id="c37" hwp:id="ref-37" hwp:rev-id="xref-ref-37-1"><label>37.</label><citation publication-type="journal" citation-type="journal" ref:id="026484v2.37" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-37"><string-name name-style="western" hwp:sortable="Shen H."><surname>Shen</surname>, <given-names>H.</given-names></string-name> <year>2014</year>. <article-title hwp:id="article-title-30">Interactive notebooks: Sharing the code</article-title>. <source hwp:id="source-30">Nature</source>. <volume>515</volume>: <fpage>151</fpage>–<lpage>2</lpage>.</citation></ref><ref id="c38" hwp:id="ref-38" hwp:rev-id="xref-ref-38-1"><label>38.</label><citation publication-type="website" citation-type="web" ref:id="026484v2.38" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-38"><collab hwp:id="collab-8">OpenTechSchool: Introducing IPython Notebook</collab>. <ext-link l:rel="related" l:ref-type="uri" l:ref="http://opentechschool.github.io/python-data-intro/core/notebook.html" ext-link-type="uri" xlink:href="http://opentechschool.github.io/python-data-intro/core/notebook.html" hwp:id="ext-link-10">http://opentechschool.github.io/python-data-intro/core/notebook.html</ext-link>.</citation></ref><ref id="c39" hwp:id="ref-39" hwp:rev-id="xref-ref-39-1"><label>39.</label><citation publication-type="website" citation-type="web" ref:id="026484v2.39" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-39"><string-name name-style="western" hwp:sortable="Ingargiola A."><surname>Ingargiola</surname>, <given-names>A.</given-names></string-name> <article-title hwp:id="article-title-31">FRETBursts - Burst analysis for smFRET experiments</article-title>. <ext-link l:rel="related" l:ref-type="uri" l:ref="http://tritemio.github.io/FRETBursts/" ext-link-type="uri" xlink:href="http://tritemio.github.io/FRETBursts/" hwp:id="ext-link-11">http://tritemio.github.io/FRETBursts/</ext-link>.</citation></ref></ref-list><sec id="s6" hwp:id="sec-24"><title hwp:id="title-27">SUPPORTING INFORMATION</title><sec id="s6a" hwp:id="sec-25"><label>1.</label><title hwp:id="title-28">Photon-HDF5 files examples</title><p hwp:id="p-66">In this section, we describe a few examples of Photon-HDF5 files corresponding to different types of measurement, focusing for brevity on the mandatory fields, which are all found in <italic toggle="yes">/photon_data</italic>. The full list of fields optionally present in the remaining groups (<italic toggle="yes">/setup</italic>, <italic toggle="yes">/sampl</italic>e, <italic toggle="yes">/identity</italic> and <italic toggle="yes">/provenance</italic>) can be found in the reference documentation.</p><p hwp:id="p-67">Photon-HDF5 files can be distinguished from other HDF5 files by the presence of two root node attributes <italic toggle="yes">format_name</italic> and <italic toggle="yes">format_version</italic>: the former must be the string “Photon-HDF5” and the latter is a string identifying the version. The measurement type is identified by reading the string in <italic toggle="yes">/photon_data/measurement_specs/measurement_type</italic>, whose currently supported values are reported in <xref ref-type="table" rid="tblS1" hwp:id="xref-table-wrap-1-2" hwp:rel-id="T1">Table SI-1</xref>.</p><sec id="s6a1" hwp:id="sec-26"><label>1.1</label><title hwp:id="title-29">us-ALEX</title><p hwp:id="p-68">In us-ALEX smFRET data files, the following data fields are mandatory (their definition can be found on the photon-hdf5.org website):
<list list-type="order" hwp:id="list-2"><list-item hwp:id="list-item-4"><p hwp:id="p-69">Timestamps (array): <italic toggle="yes">/photon_data/timestamps</italic></p></list-item><list-item hwp:id="list-item-5"><p hwp:id="p-70">Timestamps unit (scalar): <italic toggle="yes">/photon_data/timestamps_specs/timestamps_unit</italic></p></list-item><list-item hwp:id="list-item-6"><p hwp:id="p-71">Detectors array (array): <italic toggle="yes">/photon_data/detectors</italic></p></list-item><list-item hwp:id="list-item-7"><p hwp:id="p-72">Alternation period (scalar): <italic toggle="yes">/photon_data/measurement_specs/alex_period</italic></p></list-item><list-item hwp:id="list-item-8"><p hwp:id="p-73">Donor detector ID (scalar): <italic toggle="yes">/photon_data/measurement_specs/detectors_specs/spectral_ch1</italic></p></list-item><list-item hwp:id="list-item-9"><p hwp:id="p-74">Acceptor detector ID (scalar): <italic toggle="yes">/photon_data/measurement_specs/detectors_specs/spectral_ch</italic>2</p></list-item><list-item hwp:id="list-item-10"><p hwp:id="p-75">Donor excitation period range (2-elements array): <italic toggle="yes">/photon_data/measurement_specs/alex_excitation_period1</italic></p></list-item><list-item hwp:id="list-item-11"><p hwp:id="p-76">Acceptor excitation period range (2-elements array): <italic toggle="yes">/photon_data/measurement_specs/alex_excitation_period2</italic></p></list-item></list></p></sec><sec id="s6a2" hwp:id="sec-27"><label>1.2</label><title hwp:id="title-30">ns-ALEX</title><p hwp:id="p-77">In ns-ALEX smFRET (also known as PIE) data files, in addition to the fields listed above for us-ALEX, the following additional data fields are mandatory mandatory (their definition can be found on the photon-hdf5.org website):
<list list-type="order" hwp:id="list-3"><list-item hwp:id="list-item-12"><p hwp:id="p-78">TCSPC nanotimes (array): <italic toggle="yes">/photon_data/nanotimes</italic></p></list-item><list-item hwp:id="list-item-13"><p hwp:id="p-79">TCSPC bin width (scalar): <italic toggle="yes">/photon_data/nanotimes_specs/tcspc_unit</italic></p></list-item><list-item hwp:id="list-item-14"><p hwp:id="p-80">TCSPC number of bins (scalar): <italic toggle="yes">/photon_data/nanotimes_specs/tcspc_num_bins</italic></p></list-item><list-item hwp:id="list-item-15"><p hwp:id="p-81">Nanotimes time inversion (boolean): <italic toggle="yes">/photon_data/nanotimes_specs/time_reversed</italic></p></list-item><list-item hwp:id="list-item-16"><p hwp:id="p-82">Laser pulse rate (scalar): <italic toggle="yes">/photon_data/measurement_specs/laser_repetition_rate</italic></p></list-item><list-item hwp:id="list-item-17"><p hwp:id="p-83">Donor excitation TCSPC range (n-tuple): <italic toggle="yes">/photon_data/measurement_specs/alex_excitation_period1</italic></p></list-item><list-item hwp:id="list-item-18"><p hwp:id="p-84">Acceptor excitation TCSPC range (n-tuple): <italic toggle="yes">/photon_data/measurement_specs/alex_excitation_period2</italic></p></list-item></list></p><table-wrap id="tblS1" orientation="portrait" position="float" hwp:id="T1" hwp:rev-id="xref-table-wrap-1-1 xref-table-wrap-1-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;026484v2/TBLS1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T1</object-id><object-id pub-id-type="publisher-id">tblS1</object-id><label>Table SI-1:</label><caption hwp:id="caption-3"><p hwp:id="p-85">List of currently supported measurement types. Additional types can be added in the future based on user demand. The first column represents the string identifying the measurement type that is located at <italic toggle="yes">/photon_data/measurement_specs/measurement_type</italic> in the Photon-HDF5 file. The second column is a brief description of the measurement type. The third column lists the required metadata fields in <italic toggle="yes">/photon_data/measurement_specs/</italic> for each type of measurement.</p></caption><graphic xlink:href="026484_tblS1" position="float" orientation="portrait" hwp:id="graphic-3"/></table-wrap><fig id="figS1" position="float" fig-type="figure" orientation="portrait" hwp:id="F3" hwp:rev-id="xref-fig-3-1 xref-fig-3-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;026484v2/FIGS1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F3</object-id><object-id pub-id-type="publisher-id">figS1</object-id><label>Figure SI-1:</label><caption hwp:id="caption-4"><p hwp:id="p-86">Partial diagram description of the Photon-HDF5 layout comprising the <italic toggle="yes">photon_data</italic> and <italic toggle="yes">setup</italic> groups, which contains the acquisition data and all the information needed for data processing. The symbol preceding each field indicates the data type of that field (e.g. array, string, scalar or boolean), as described in the legend.</p></caption><graphic xlink:href="026484_figS1" position="float" orientation="portrait" hwp:id="graphic-4"/></fig><fig id="figS2" position="float" fig-type="figure" orientation="portrait" hwp:id="F4" hwp:rev-id="xref-fig-4-1 xref-fig-4-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;026484v2/FIGS2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F4</object-id><object-id pub-id-type="publisher-id">figS2</object-id><label>Figure SI-2:</label><caption hwp:id="caption-5"><p hwp:id="p-87">Partial diagram description of the Photon-HDF5 layout showing the <italic toggle="yes">sample</italic>, <italic toggle="yes">identity</italic> and <italic toggle="yes">provenance</italic> groups. These groups are not strictly necessary to analyze the data, but are important for long-term preservation, reproducibility and proper credit/citation when the file is shared.</p></caption><graphic xlink:href="026484_figS2" position="float" orientation="portrait" hwp:id="graphic-5"/></fig></sec></sec><sec id="s6b" hwp:id="sec-28"><label>2.</label><title hwp:id="title-31">Benchmarks</title><sec id="s6b1" hwp:id="sec-29"><label>2.1</label><title hwp:id="title-32">Overview</title><p hwp:id="p-88">In this section, we report the results of two simple read- and write-speed benchmarks for two different data files: one based on a HT3 file (created by the MicroTime 200 hardware sold by PicoQuant) and one based on a SPC file (created by a SPC-630 board sold by Becker &amp; Hickl). The benchmarks were coded in Python 2.7 and pytables 3.1 and run on a desktop PC with Intel<sup>®</sup> Core™ i5-3570K CPU, 16GB of RAM and a 7,200 rpm SATA hard drive (Western Digital WD2002FAEX). The quoted values are the result of a single execution after a system reboot (to eliminate perturbation from file-system cache).</p><p hwp:id="p-89">It should be noted that the value reported are only indicative and cannot be generalized because compression performances (size and speed) can significantly vary for file to file. Furthermore HDF5 allows changing a parameter, the array chunk size (the size of an on-disk-contiguous chunk of data), which can affect (in particular, improve) performance. Here, we used the default value as set by the pytables library.</p><p hwp:id="p-90">We benchmarked different compression levels ranging from 0 (no compression) to 9 (maximum compression) and 2 compression algorithms: zlib (HDF5 default) and blosc (a high-speed alternative compressor developed by the pytables team and not shipped by default with the HDF5 library). It is important to note that, when using languages other than python, using blosc requires compiling the blosc sources, which can represents a significant obstacle for the user. Therefore, we discourage the use of the blosc compressor for any file which needs to be shared. On the other hand, we included it in the benchmarks due to its impressive performance. For instance, in critical, real-time applications where the hard drive write-speed is a bottleneck (i.e. acquiring from large SPAD arrays), the blosc compressor could be used and the conversion to zlib postponed to a second, post-processing step.</p></sec><sec id="s6b2" hwp:id="sec-30"><label>2.2</label><title hwp:id="title-33">Results</title><p hwp:id="p-91">Read speeds were relatively uniform at all compression levels when using zlib, with values around 40 million photons per second (MP/s). In all examples, the read speed from compressed Photon-HDF5 format (compression level of 5) was around twice faster than reading from the native formats (the latter have an overhead due to byte decoding and rollover correction). It is worth noting that the read speed of the native formats depends on the specific decoding implementation, and C routines could potentially result in faster read speed (although we believe our implementation is reasonably fast).</p><p hwp:id="p-92">Write speeds, on the contrary, were strongly affected by the compression level (5-10 MP/s using zlib5). Obviously, the fastest was to write uncompressed data (&gt; 100 MP/s). Remarkably, blosc exhibited write speeds which were comparable to the uncompressed one, while significantly reducing the file size. For single-spot data files, the write speed was more than enough to save data in real time even when using the slow zlib compression. For setup using large detector arrays, it would be advisable to not use any compression or only blosc compression (and later convert the file to zlib compression for sharing).</p><fig id="figS3" position="float" fig-type="figure" orientation="portrait" hwp:id="F5"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;026484v2/FIGS3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F5</object-id><object-id pub-id-type="publisher-id">figS3</object-id><label>Figure SI-3:</label><caption hwp:id="caption-6"><p hwp:id="p-93">Benchmark using a PicoQuant HT3 input file. In the first two graphs (speed), larger values are better, while in the last (size), smaller is better.</p></caption><graphic xlink:href="026484_figS3" position="float" orientation="portrait" hwp:id="graphic-6"/></fig><fig id="figS4" position="float" fig-type="figure" orientation="portrait" hwp:id="F6"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;026484v2/FIGS4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F6</object-id><object-id pub-id-type="publisher-id">figS4</object-id><label>Figure SI-4:</label><caption hwp:id="caption-7"><p hwp:id="p-94">Benchmark using a Becker &amp; Hickl SPC input file. In the first two graphs (speed), larger values are better, while in the last (size), smaller is better.</p></caption><graphic xlink:href="026484_figS4" position="float" orientation="portrait" hwp:id="graphic-7"/></fig></sec></sec></sec></back></article>
