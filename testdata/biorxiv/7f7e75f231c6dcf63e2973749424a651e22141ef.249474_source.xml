<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/249474</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;249474v1</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;249474</article-id><article-id pub-id-type="other" hwp:sub-type="slug">249474</article-id><article-id pub-id-type="other" hwp:sub-type="tag">249474</article-id><article-version>1.1</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Bioinformatics" hwp:journal="biorxiv"><subject>Bioinformatics</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">Accurate analysis of genuine CRISPR editing events with ampliCan</article-title></title-group><author-notes hwp:id="author-notes-1"><corresp hwp:id="corresp-1">Correspondence to: Eivind Valen; Tel: +47 55584074; Email: <email hwp:id="email-1">eivind.valen@gmail.com</email></corresp></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><name name-style="western" hwp:sortable="Labun Kornel"><surname>Labun</surname><given-names>Kornel</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-2"><name name-style="western" hwp:sortable="Guo Xiaoge"><surname>Guo</surname><given-names>Xiaoge</given-names></name><xref ref-type="aff" rid="a4" hwp:id="xref-aff-4-1" hwp:rel-id="aff-4">4</xref><xref ref-type="aff" rid="a5" hwp:id="xref-aff-5-1" hwp:rel-id="aff-5">5</xref></contrib><contrib contrib-type="author" hwp:id="contrib-3"><name name-style="western" hwp:sortable="Chavez Alejandro"><surname>Chavez</surname><given-names>Alejandro</given-names></name><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-1" hwp:rel-id="aff-3">3</xref></contrib><contrib contrib-type="author" hwp:id="contrib-4"><name name-style="western" hwp:sortable="Church George"><surname>Church</surname><given-names>George</given-names></name><xref ref-type="aff" rid="a4" hwp:id="xref-aff-4-2" hwp:rel-id="aff-4">4</xref><xref ref-type="aff" rid="a5" hwp:id="xref-aff-5-2" hwp:rel-id="aff-5">5</xref></contrib><contrib contrib-type="author" hwp:id="contrib-5"><name name-style="western" hwp:sortable="Gagnon James"><surname>Gagnon</surname><given-names>James</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-1" hwp:rel-id="aff-2">2</xref></contrib><contrib contrib-type="author" corresp="yes" hwp:id="contrib-6"><name name-style="western" hwp:sortable="Valen Eivind"><surname>Valen</surname><given-names>Eivind</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">1</xref></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2"><label>1</label><institution hwp:id="institution-1">Computational Biology Unit, Department of Informatics, University of Bergen</institution>, 5008 Bergen, <country>Norway</country>.</aff><aff id="a2" hwp:id="aff-2" hwp:rev-id="xref-aff-2-1"><label>2</label><institution hwp:id="institution-2">Department of Biology, University of Utah</institution>, Salt Lake City, UT 84112, <country>USA</country>.</aff><aff id="a3" hwp:id="aff-3" hwp:rev-id="xref-aff-3-1"><label>3</label><institution hwp:id="institution-3">Sars International Centre for Marine Molecular Biology, University of Bergen</institution>, 5008 Bergen, <country>Norway</country>.</aff><aff id="a4" hwp:id="aff-4" hwp:rev-id="xref-aff-4-1 xref-aff-4-2"><label>4</label><institution hwp:id="institution-4">Department of Pathology and Cell Biology, Columbia University</institution>, New York, NY 10032, <country>USA</country>.</aff><aff id="a5" hwp:id="aff-5" hwp:rev-id="xref-aff-5-1 xref-aff-5-2"><label>5</label><institution hwp:id="institution-5">Wyss Institute for Biologically Inspired Engineering, Harvard University</institution>, Cambridge, MA 02115, <country>USA</country>.</aff><aff id="a6" hwp:id="aff-6"><label>6</label><institution hwp:id="institution-6">Department of Genetics, Harvard Medical School</institution>, Boston, Massachusetts, 02115, <country>USA</country>.</aff></contrib-group><pub-date pub-type="epub-original" hwp:start="2018"><year>2018</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2018-01-17T06:21:14-08:00">
    <day>17</day><month>1</month><year>2018</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2018-01-17T06:21:14-08:00">
    <day>17</day><month>1</month><year>2018</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2018-01-17T06:27:13-08:00">
    <day>17</day><month>1</month><year>2018</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2018-01-17T06:27:13-08:00">
    <day>17</day><month>1</month><year>2018</year>
  </pub-date><elocation-id>249474</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2018-01-17"><day>17</day><month>1</month><year>2018</year></date>
<date date-type="rev-recd" hwp:start="2018-01-17"><day>17</day><month>1</month><year>2018</year></date>
<date date-type="accepted" hwp:start="2018-01-17"><day>17</day><month>1</month><year>2018</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">Â© 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2018</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/" hwp:id="license-1"><p hwp:id="p-1">This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" hwp:id="ext-link-1">http://creativecommons.org/licenses/by/4.0/</ext-link></p></license></permissions><self-uri xlink:href="249474.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2019/pdf/249474v1.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="249474.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2019/abstracts/249474v1/249474v1.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2019/fulltext/249474v1/249474v1.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><p hwp:id="p-2">We present ampliCan, an analysis tool that unites identification, quantification and visualization of genuine genome editing events from CRISPR amplicon sequencing data. ampliCan overcomes methodological challenges suffered by other tools to estimate the true mutational efficiency in a high-throughput automated fashion. ampliCan controls for biases at every step of the analysis and generates reports that allow users to quickly identify successful editing events or potential issues with their experiments. We benchmarked ampliCan against other leading tools demonstrating that it outperformed all in the face of common confounding factors.</p></abstract><counts><page-count count="9"/></counts><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-1">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta></front><body><sec id="s1" hwp:id="sec-1"><title hwp:id="title-2">Introduction</title><p hwp:id="p-3">With the introduction of CRISPR<sup><xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">1</xref>,<xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">2</xref></sup>, researchers obtained an inexpensive and effective tool for targeted mutagenesis. Despite its current limitations, CRISPR has been widely adopted within research settings and has begun to make inroads into medical applications<sup><xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-1" hwp:rel-id="ref-3">3</xref></sup>. The successful use of CRISPR relies on the ability to confidently identify CRISPR-induced mutations, generally insertions and deletions (indels). Indels are often identified by sequencing the targeted loci and comparing the sequenced reads to a reference sequence. Deep sequencing has the advantage of capturing the nature of the indel, readily identifying frameshift mutations or disrupted regulatory elements, and also characterizing the heterogeneity of the introduced mutations in a population. This is of particular importance when the aim is allele-specific editing or the experiment can result in mosaicism.</p><p hwp:id="p-4">The reliability of a sequencing-based approach is dependent on the processing and interpretation of the sequenced reads and is contingent on several factors such as the inclusion of controls, the alignment algorithm and the filtering of experimental artifacts. To date, no tool considers and controls for the whole range of biases that can influence this interpretation and therefore, distorts the estimate of the mutation efficiency and leads to erroneous conclusions. Here we introduce a fully automated tool, ampliCan, designed to determine the true mutation frequencies of CRISPR experiments from high-throughput DNA amplicon sequencing. It scales to genome-wide experiments and can be used alone or integrated with the CHOPCHOP<sup><xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">4</xref>,<xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-1" hwp:rel-id="ref-5">5</xref></sup> guide RNA (gRNA) design tool.</p></sec><sec id="s2" hwp:id="sec-2"><title hwp:id="title-3">Results</title><p hwp:id="p-5">Estimation of the true mutation efficiency depends on multiple steps all subject to different biases<sup><xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-1" hwp:rel-id="ref-6">6</xref></sup>. Following sequencing, reads have to be aligned to the correct reference, filtered for artifacts, and then the mutation efficiency has to be quantified and normalized (<bold><xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Fig. 1A</xref></bold>). In most existing tools, many of the choices made during these steps are typically hidden from the user leading to potential misinterpretation of the data. Furthermore, a subset of steps are often relegated to other tools not optimized for CRISPR experiments. Unlike other tools, ampliCan implements the complete pipeline from alignment to interpretation and can control for biases at all steps.</p><fig id="fig1" position="float" fig-type="figure" orientation="portrait" hwp:id="F1" hwp:rev-id="xref-fig-1-1 xref-fig-1-2 xref-fig-1-3 xref-fig-1-4 xref-fig-1-5 xref-fig-1-6"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;249474v1/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Fig 1.</label><caption hwp:id="caption-1"><p hwp:id="p-6"><bold>A.</bold> Estimation of mutation efficiency consists of multiple steps. At each of these steps biases can be introduced. Controls are processed identically to the main experiment and used for normalization. <bold>B.</bold> Overview of the change in estimated mutation efficiency when using controls that account for natural genetic variance in 28 experiments (mean change of 32%). Red dots show initial estimates based on unnormalized data, while black dots show the values after normalization. <bold>C.</bold> Alignment plot showing the top 10 most abundant reads in a real experiment. The table shows relative efficiency (Freq) of read, absolute number of reads (Count) and the summed size of the indel(s) (F), coloured green when inducing a frameshift. The bars (top right) shows the fraction of reads that contain no indels (Match), those having an indel without inducing frameshift (InDel) and frameshift inducing indels (F). The left panel shows the estimated mutation efficiency from raw reads, which is 14% (11% with frameshift, 3% without). The right panel shows the same genomic loci after normalization with controls resulting in an mutation efficiency of 0%. The deletion of 11bp in 9% of the reads could not be found in GRCz10.88 Ensembl Variation database and would in the absence of controls give the impression of a real editing event.</p></caption><graphic xlink:href="249474_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig><p hwp:id="p-7">Despite being arguably the most important step in any experiment, the use of controls is frequently overlooked in CRISPR assays. Discrepancies between a reference genome and the genetic variation in an organism of interest often lead to false positives and the false impression that mutations have been introduced (<bold><xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-2" hwp:rel-id="F1">Fig. 1B</xref></bold>, <bold>Supplementary Fig. 1</bold>)<sup><xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">7</xref></sup>. While the use of controls is (in principle) feasible with any tool, it commonly requires running the treated and control samples separately followed by a manual inspection and comparison of these. In ampliCan, controls are an integrated part of the pipeline and mutation frequencies are normalized and estimated automatically (<bold><xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-3" hwp:rel-id="F1">Fig. 1C</xref></bold>, Methods and <bold>Supplementary Note 1</bold>).</p><p hwp:id="p-8">Estimating mutation efficiency starts with the alignment of the sequenced reads (<bold><xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-4" hwp:rel-id="F1">Fig. 1A</xref></bold>). A common strategy is to use standard genomic alignment tools. However, these tools do not align using knowledge about the known mechanisms of CRISPR-induced double stranded breaks and DNA repair. Genome editing typically results in a single deletion and/or insertion of variable length. Hence, correctly aligned reads will often have a low number of events (optimally 1 deletion and/or 1 insertion after normalization for controls) overlapping the cut site, while misaligned reads will result in a high number of events throughout the read due to discrepancies to the correct loci. Therefore an alignment strategy that penalizes multiple indel events (see Methods) is more consistent with DNA repair mechanisms and the CRISPR mode of action. ampliCan uses the Needleman-Wunsch algorithm with tuned parameters to ensure optimal alignments of the reads to their loci and models the number of indel and mismatch events to ensure that the reads originated from that loci (see Methods and <bold>Supplementary Note 2</bold>). In contrast, non-optimized aligners can create fragmented alignments resulting in misleading mutation profiles and possible distortion of downstream analyses and frameshift estimation (<bold>Supplementary Fig. 2</bold>). In assessments, ampliCan outperforms the tool CrispRVariants on its own synthetic dataset<sup><xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-2" hwp:rel-id="ref-6">6</xref></sup> contaminated with off-target reads matching the real on-target reads, but with a mismatch rate of 30% per bp (<bold>Supplementary Fig. 3</bold>). More problematic, the mapping strategy used in the pipelines of several tools (<bold>Supplementary Table 1</bold>) are not robust to small perturbations of this mismatch rate and altering it leads to a significant reduction in performance (<bold><xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-1" hwp:rel-id="F2">Fig. 2</xref></bold>, left). In contrast, ampliCan shows consistently high performance across a broad range of mismatch rates (<bold><xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-2" hwp:rel-id="F2">Fig. 2</xref></bold>, left and <bold>Supplementary Figs. 3</bold>, <bold>4</bold>).</p><fig id="fig2" position="float" fig-type="figure" orientation="portrait" hwp:id="F2" hwp:rev-id="xref-fig-2-1 xref-fig-2-2 xref-fig-2-3 xref-fig-2-4"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;249474v1/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Fig 2.</label><caption hwp:id="caption-2"><p hwp:id="p-9">Benchmark of leading tools<sup><xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-3" hwp:rel-id="ref-6">6</xref>,<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">16</xref>,<xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">17</xref></sup> when estimating mutation efficiency under different dataset conditions. Each dot shows the error of the estimate to the correct value for a single experiment. The median performance (Mixed indels) is indicated by the horizontal line. The left panel shows comparison of tools when datasets contain contaminant reads (see text and methods). The x-axis denotes how dissimilar the contaminant reads are to the correct reads. In cases where the contaminants are from homologous regions this may be low (10%), for other contaminants this is likely to be higher (30%). The right panel shows performance of tools as a function of the length of indel events. The sets in the left column contain no indels &gt; 10bp, the right column contain only insertions &gt; 10bp, the middle column (Mixed Indels) is a mix of shorter and longer events.</p></caption><graphic xlink:href="249474_fig2" position="float" orientation="portrait" hwp:id="graphic-2"/></fig><p hwp:id="p-10">Targeted insertion of shorter fragments through co-opting of the homology directed repair (HDR) pathway is becoming increasingly popular<sup><xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-1" hwp:rel-id="ref-8">8</xref>,<xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">9</xref></sup>. This, together with long indels occurring in regular CRISPR experiments, presents a challenge for most CRISPR analysis tools. The inability of current pipelines to process these longer events (<bold><xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-3" hwp:rel-id="F2">Fig. 2</xref></bold>, right) typically stems from alignment strategies that are unable to assign reads with long indels to the correct loci. In previous assessments, simulated data has often been restricted to short indels where this weakness would not be apparent (<bold>Supplementary Note 4</bold>)<sup><xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-4" hwp:rel-id="ref-6">6</xref></sup>. Using a localized alignment strategy, based on primer matching (see Methods), ampliCan robustly handles these longer indels and on simulated data with indels &gt;10 bp ampliCan outperforms all other tools (<bold><xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-4" hwp:rel-id="F2">Fig. 2</xref></bold>, right and <bold>Supplementary Fig. 5</bold>).</p><p hwp:id="p-11">To aid in heterogeneous outcomes, ampliCan quantifies the heterogeneity of reads (<bold>Supplementary Fig. 7</bold>), the complete mutation efficiency for an experiment and the proportion of mutations resulting in a frameshift (<bold><xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-5" hwp:rel-id="F1">Fig. 1C</xref></bold>, top right). It also aggregates and quantifies mutation events of a specific type if a particular outcome is desired (<bold>Supplementary Fig. 6</bold>). In addition, ampliCan provides overviews of the impact of all filtering steps (<bold>Supplementary Fig. 8</bold>). Reports can be generated in several formats (<bold>Supplementary Tables 2 and 3</bold>) and aggregated at multiple levels such as barcode, gRNA, gene, loci or any customized user specified grouping (<bold>Supplementary Note 5</bold>). This enables exploration of questions beyond mutation efficiency such as the rules of gRNA design, whether a particular researcher is better at designing gRNAs than others (<bold>Supplementary Fig. 9</bold>), whether a given barcode is not working or determining the stochasticity in the mutation outcome from a given gRNA (<bold>Supplementary Fig. 19</bold>).</p><p hwp:id="p-12">ampliCan offers a complete pipeline controlling for biases at every step of evaluation. It can be integrated with the CHOPCHOP tool for gRNA design to incorporate all computational steps necessary for a CRISPR experiment. It scales from a single gRNA to genome-wide screens and can be run with a single command. For more advanced users, it provides a complete and adaptable framework, implemented in R and bioconductor, enabling further exploration of the data. Collectively, these advances will minimize misinterpretation of genome editing experiments and allow effective analysis of the outcome in an automated fashion.</p></sec><sec id="s3" hwp:id="sec-3"><title hwp:id="title-4">Methods</title><sec id="s3a" hwp:id="sec-4"><title hwp:id="title-5">ampliCan pipeline</title><p hwp:id="p-13">ampliCan is a multi-step pipeline (<bold>Supplementary Fig. 10</bold>) accepting a configuration file describing the experiment(s) and FASTQ files of sequenced reads as input. The configuration file contains information about barcodes, gRNAs, forward and reverse primers, amplicons and paths to corresponding FASTQ files (<bold>Supplementary Table 4</bold>). From here, the pipeline generates reports summarizing the key features of the experiments.</p><p hwp:id="p-14">In the first step, ampliCan filters low quality reads which either have ambiguous nucleotides, an average quality or individual base quality under a default or user-specified threshold (<bold>Supplementary Note 6</bold>). After quality filtering, ampliCan assigns reads to the particular experiment by searching for matching primers (default up to two mismatches, but ampliCan supports different stringency, <bold>Supplementary Note 7</bold>). Unassigned reads are summarized and reported separately for troubleshooting. After read assignment ampliCan uses the Biostrings<sup><xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-1" hwp:rel-id="ref-10">10</xref></sup> implementation of the Needleman-Wunsch algorithm with optimized parameters (gap opening = â25, gap extension = 0, match = 5, mismatch = â4, no end gap penalty) to align all assigned reads to the loci/amplicon sequence. Subsequently, primer dimer reads are removed by detecting deletions larger than the size of the amplicon subtracting the length of the two primers and a short buffer. Additionally, sequences that contain a high number of indels or mismatch events compared to the remainder of the reads are filtered as these are potential sequencing artifacts or originate from off-target amplification (<bold>Supplementary Note 6</bold> and <bold>Supplementary Fig. 11</bold>). Mutation frequencies are calculated from the remaining reads using the frequency of indels that (<bold>Supplementary Fig. 6</bold>) overlap a region (+/- 5bp) around the expected cut site and, if paired-end sequencing is used, follows consensus rules for the paired forward and reverse read (<bold>Supplementary Fig. 12</bold>). The expected cut site can be specified as a larger region for nickase or TALEN experiments. Any indel or mismatch also observed above a 1% threshold in the control are removed. Frameshifts are identified by summing the impact of deletions and insertions on the amplicon.</p><p hwp:id="p-15">A series of automated reports is prepared in form of â.Rmdâ files which can be converted to multiple formats, but also immediately transformed into html reports with knitr<sup><xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">11</xref></sup> for convenience. There are six different default reports prepared by ampliCan with statistics grouped at the corresponding level: id, barcode, gRNA, amplicon, summary and group (user specified, typically person conducting experiments, treatment or other grouping of interest). In addition to alignments of top reads (<bold><xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-6" hwp:rel-id="F1">Fig. 1C</xref>, Supplementary Fig. 1</bold>) reports contain plots summarized over all deletions, insertions and variants (<bold>Supplementary Fig. 6</bold>). In addition a number of plots showing the general state of the experiments are shown including the heterogeneity of reads to investigate mosaicism or sequencing issues (<bold>Supplementary Figs. 7</bold>, <bold>13</bold>, <bold>14</bold>) and overviews of how many reads were filtered/assigned at each step (<bold>Supplementary Fig. 15</bold>). In addition to the default plots ampliCan produces R objects that contain all alignments and read information, these can be manipulated, extended and visualized through the R statistical package.</p><p hwp:id="p-16">ampliCan provides a simple tool that can be used out-of-the-box, yet equipped with a flexible framework that can be exploited and extended by advanced R users. The default pipeline is compressed into a single convenient wrapper, amplicanPipeline, which generates all default reports. More advanced users can gain complete control over all processing steps and produce novel plots for more specialized use cases. Compatibility with the most popular plotting packages (ggplot2<sup><xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">12</xref></sup> and ggbio<sup><xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">13</xref></sup>) as well as the most popular data processing packages (dplyr<sup><xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">14</xref></sup> and data.table) provides a full fledged and elastic framework. Output files are encoded as GenomicRanges<sup><xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">15</xref></sup> tables of aligned read events for easy parsing (<bold>Supplementary Table 3</bold>) and human readable alignment results (<bold>Supplementary Table 2</bold>) and fasta. We would like to encourage users to communicate their needs and give us feedback, for future development.</p></sec></sec></body><back><sec hwp:id="sec-5"><title hwp:id="title-6">Data Availability</title><p hwp:id="p-17">All data is available online under accession numbers: PRJNA245510 (BioProject, run 1 and run 5) and E-MTAB-6310, E-MTAB-6355, E-MTAB-6356, E-MTAB-6357, E-MTAB-6358, (run 6-10). Synthetic datasets can be reconstructed with the use of code from <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/valenlab/amplican_manuscript" ext-link-type="uri" xlink:href="https://github.com/valenlab/amplican_manuscript" hwp:id="ext-link-2">https://github.com/valenlab/amplican_manuscript</ext-link>.</p></sec><sec hwp:id="sec-6"><title hwp:id="title-7">Code availability</title><p hwp:id="p-18">ampliCan is developed as an R package under GNU General Public License version 3 and available through Bioconductor under <ext-link l:rel="related" l:ref-type="uri" l:ref="http://bioconductor.org/packages/amplican" ext-link-type="uri" xlink:href="http://bioconductor.org/packages/amplican" hwp:id="ext-link-3">http://bioconductor.org/packages/amplican</ext-link> or <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/valenlab/amplican" ext-link-type="uri" xlink:href="https://github.com/valenlab/amplican" hwp:id="ext-link-4">https://github.com/valenlab/amplican</ext-link>.</p></sec><sec hwp:id="sec-7"><title hwp:id="title-8">Additional information</title></sec><ref-list hwp:id="ref-list-1"><title hwp:id="title-9">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1"><label>1.</label><citation publication-type="journal" citation-type="journal" ref:id="249474v1.1" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Jinek M."><surname>Jinek</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-2">A programmable dual-RNA-guided DNA endonuclease in adaptive bacterial immunity</article-title>. <source hwp:id="source-1">Science</source> <volume>337</volume>, <fpage>816</fpage>â<lpage>821</lpage> (<year>2012</year>).</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1"><label>2.</label><citation publication-type="journal" citation-type="journal" ref:id="249474v1.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="Cong L."><surname>Cong</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-3">Multiplex genome engineering using CRISPR/Cas systems</article-title>. <source hwp:id="source-2">Science</source> <volume>339</volume>, <fpage>819</fpage>â<lpage>823</lpage> (<year>2013</year>).</citation></ref><ref id="c3" hwp:id="ref-3" hwp:rev-id="xref-ref-3-1"><label>3.</label><citation publication-type="journal" citation-type="journal" ref:id="249474v1.3" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Courtney D. G."><surname>Courtney</surname>, <given-names>D. G.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-4">CRISPR/Cas9 DNA cleavage at SNP-derived PAM enables both in vitro and in vivo KRT12 mutation-specific targeting</article-title>. <source hwp:id="source-3">Gene Ther</source>. <volume>23</volume>, <fpage>108</fpage>â<lpage>112</lpage> (<year>2016</year>).</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1"><label>4.</label><citation publication-type="journal" citation-type="journal" ref:id="249474v1.4" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Montague T. G."><surname>Montague</surname>, <given-names>T. G.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Cruz J. M."><surname>Cruz</surname>, <given-names>J. M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gagnon J. A."><surname>Gagnon</surname>, <given-names>J. A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Church G. M."><surname>Church</surname>, <given-names>G. M.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Valen E."><surname>Valen</surname>, <given-names>E.</given-names></string-name> <article-title hwp:id="article-title-5">CHOPCHOP: a CRISPR/Cas9 and TALEN web tool for genome editing</article-title>. <source hwp:id="source-4">Nucleic Acids Res</source>. <volume>42</volume>, <fpage>W401</fpage>â<lpage>7</lpage> (<year>2014</year>).</citation></ref><ref id="c5" hwp:id="ref-5" hwp:rev-id="xref-ref-5-1"><label>5.</label><citation publication-type="journal" citation-type="journal" ref:id="249474v1.5" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Labun K."><surname>Labun</surname>, <given-names>K.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Montague T. G."><surname>Montague</surname>, <given-names>T. G.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gagnon J. A."><surname>Gagnon</surname>, <given-names>J. A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Thyme S. B."><surname>Thyme</surname>, <given-names>S. B.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Valen E."><surname>Valen</surname>, <given-names>E.</given-names></string-name> <article-title hwp:id="article-title-6">CHOPCHOP v2: a web tool for the next generation of CRISPR genome engineering</article-title>. <source hwp:id="source-5">Nucleic Acids Res</source>. <volume>44</volume>, <fpage>W272</fpage>â<lpage>6</lpage> (<year>2016</year>).</citation></ref><ref id="c6" hwp:id="ref-6" hwp:rev-id="xref-ref-6-1 xref-ref-6-2 xref-ref-6-3 xref-ref-6-4"><label>6.</label><citation publication-type="journal" citation-type="journal" ref:id="249474v1.6" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Lindsay H."><surname>Lindsay</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-7">CrispRVariants charts the mutation spectrum of genome engineering experiments</article-title>. <source hwp:id="source-6">Nat. Biotechnol</source>. <volume>34</volume>, <fpage>701</fpage>â<lpage>702</lpage> (<year>2016</year>).</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1"><label>7.</label><citation publication-type="journal" citation-type="journal" ref:id="249474v1.7" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Gagnon J. A."><surname>Gagnon</surname>, <given-names>J. A.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-8">Efficient mutagenesis by Cas9 protein-mediated oligonucleotide insertion and large-scale assessment of single-guide RNAs</article-title>. <source hwp:id="source-7">PLoS One</source> <volume>9</volume>, <fpage>e98186</fpage> (<year>2014</year>).</citation></ref><ref id="c8" hwp:id="ref-8" hwp:rev-id="xref-ref-8-1"><label>8.</label><citation publication-type="journal" citation-type="journal" ref:id="249474v1.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Kuscu C."><surname>Kuscu</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-9">CRISPR-STOP: gene silencing through base-editing-induced nonsense mutations</article-title>. <source hwp:id="source-8">Nat. Methods</source> <volume>14</volume>, <fpage>710</fpage>â<lpage>712</lpage> (<year>2017</year>).</citation></ref><ref id="c9" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1"><label>9.</label><citation publication-type="journal" citation-type="journal" ref:id="249474v1.9" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Lackner D. H."><surname>Lackner</surname>, <given-names>D. H.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-10">A generic strategy for CRISPR-Cas9-mediated gene tagging</article-title>. <source hwp:id="source-9">Nat. Commun</source>. <volume>6</volume>, <fpage>10237</fpage> (<year>2015</year>).</citation></ref><ref id="c10" hwp:id="ref-10" hwp:rev-id="xref-ref-10-1"><label>10.</label><citation publication-type="journal" citation-type="journal" ref:id="249474v1.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="Pages H."><surname>Pages</surname>, <given-names>H.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gentleman R."><surname>Gentleman</surname>, <given-names>R.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Aboyoun P."><surname>Aboyoun</surname>, <given-names>P.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="DebRoy S."><surname>DebRoy</surname>, <given-names>S.</given-names></string-name> <article-title hwp:id="article-title-11">Biostrings: String objects representing biological sequences, and matching algorithms</article-title>, <year>2008</year>. <source hwp:id="source-10">R package version</source> <volume>2</volume>, <fpage>160</fpage></citation></ref><ref id="c11" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1"><label>11.</label><citation publication-type="journal" citation-type="journal" ref:id="249474v1.11" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="Xie Y."><surname>Xie</surname>, <given-names>Y.</given-names></string-name> <article-title hwp:id="article-title-12">knitr: A general-purpose package for dynamic report generation in R</article-title>. <source hwp:id="source-11">R package version</source> <volume>1</volume>, <fpage>1</fpage> (<year>2013</year>).</citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1"><label>12.</label><citation publication-type="other" citation-type="journal" ref:id="249474v1.12" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Wickham H."><surname>Wickham</surname>, <given-names>H.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Wickham M. H."><surname>Wickham</surname>, <given-names>M. H.</given-names></string-name> <source hwp:id="source-12">The ggplot package</source>. (<year>2007</year>).</citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1"><label>13.</label><citation publication-type="journal" citation-type="journal" ref:id="249474v1.13" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="Yin T."><surname>Yin</surname>, <given-names>T.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Cook D."><surname>Cook</surname>, <given-names>D.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Lawrence M."><surname>Lawrence</surname>, <given-names>M.</given-names></string-name> <article-title hwp:id="article-title-13">ggbio: an R package for extending the grammar of graphics for genomic data</article-title>. <source hwp:id="source-13">Genome Biol</source>. <volume>13</volume>, <fpage>R77</fpage> (<year>2012</year>).</citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1"><label>14.</label><citation publication-type="journal" citation-type="journal" ref:id="249474v1.14" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Wickham H."><surname>Wickham</surname>, <given-names>H.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Francois R."><surname>Francois</surname>, <given-names>R.</given-names></string-name> <article-title hwp:id="article-title-14">dplyr: A grammar of data manipulation</article-title>. <source hwp:id="source-14">R package version 0. 4</source> <volume>1</volume>, <fpage>20</fpage> (<year>2015</year>).</citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1"><label>15.</label><citation publication-type="journal" citation-type="journal" ref:id="249474v1.15" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Lawrence M."><surname>Lawrence</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-15">Software for computing and annotating genomic ranges</article-title>. <source hwp:id="source-15">PLoS Comput. Biol</source>. <volume>9</volume>, <fpage>e1003118</fpage> (<year>2013</year>).</citation></ref><ref id="c16" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1"><label>16.</label><citation publication-type="journal" citation-type="journal" ref:id="249474v1.16" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Pinello L."><surname>Pinello</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-16">Analyzing CRISPR genome-editing experiments with CRISPResso</article-title>. <source hwp:id="source-16">Nat. Biotechnol</source>. <volume>34</volume>, <fpage>695</fpage>â<lpage>697</lpage> (<year>2016</year>).</citation></ref><ref id="c17" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1"><label>17.</label><citation publication-type="journal" citation-type="journal" ref:id="249474v1.17" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="Varshney G. K."><surname>Varshney</surname>, <given-names>G. K.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-17">High-throughput gene targeting and phenotyping in zebrafish using CRISPR/Cas9</article-title>. <source hwp:id="source-17">Genome Res</source>. <volume>25</volume>, <fpage>1030</fpage>â<lpage>1042</lpage> (<year>2015</year>).</citation></ref></ref-list><ack hwp:id="ack-1"><title hwp:id="title-10">Acknowledgements</title><p hwp:id="p-19">We would like to thank Jason Rihel, Tessa Montague and Alex Schier for support and many useful comments, and members of the Schier lab for their contributions.</p><p hwp:id="p-20">The project was supported by the Bergen Research Foundation and the Norwegian Research Council (FRIMEDBIO #250049) (E.V.), University of Bergen core funding (K.L.) and the American Cancer Society and University of Utah startup funding (J.A.G.).</p></ack><sec hwp:id="sec-8"><title hwp:id="title-11">Author information</title><sec hwp:id="sec-9"><title hwp:id="title-12">Contributions</title><p hwp:id="p-21">E.V. conceived and supervised the project. J.A.G. performed wet-lab experiments and prepared datasets. X.G., G.C. and A.C. assisted in data interpretation and writing the manuscript. K.L. developed the R package and performed all computational work.</p></sec><sec hwp:id="sec-10"><title hwp:id="title-13">Competing financial interests</title><p hwp:id="p-22">The authors declare no competing financial interests.</p></sec></sec></back></article>
