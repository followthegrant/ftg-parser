<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/356584</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;356584v1</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;356584</article-id><article-id pub-id-type="other" hwp:sub-type="slug">356584</article-id><article-id pub-id-type="other" hwp:sub-type="tag">356584</article-id><article-version>1.1</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Biophysics" hwp:journal="biorxiv"><subject>Biophysics</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">SPHIRE-crYOLO: A fast and well-centering automated particle picker for cryo-EM</article-title></title-group><author-notes hwp:id="author-notes-1"><corresp id="cor1" hwp:id="corresp-1">Correspondence: <email hwp:id="email-1">stefan.raunser@mpi-dortmund.mpg.de</email></corresp></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><name name-style="western" hwp:sortable="Wagner Thorsten"><surname>Wagner</surname><given-names>Thorsten</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-2"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-4166-8747</contrib-id><name name-style="western" hwp:sortable="Merino Felipe"><surname>Merino</surname><given-names>Felipe</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">1</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0003-4166-8747"/></contrib><contrib contrib-type="author" hwp:id="contrib-3"><name name-style="western" hwp:sortable="Stabrin Markus"><surname>Stabrin</surname><given-names>Markus</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-3" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-4"><name name-style="western" hwp:sortable="Moriya Toshio"><surname>Moriya</surname><given-names>Toshio</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-4" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-5"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-4922-4545</contrib-id><name name-style="western" hwp:sortable="Gatsogiannis Christos"><surname>Gatsogiannis</surname><given-names>Christos</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-5" hwp:rel-id="aff-1">1</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0002-4922-4545"/></contrib><contrib contrib-type="author" corresp="yes" hwp:id="contrib-6"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-9373-3016</contrib-id><name name-style="western" hwp:sortable="Raunser Stefan"><surname>Raunser</surname><given-names>Stefan</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-6" hwp:rel-id="aff-1">1</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0001-9373-3016"/></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2 xref-aff-1-3 xref-aff-1-4 xref-aff-1-5 xref-aff-1-6"><label>1</label><institution hwp:id="institution-1">Department of Structural Biochemistry, Max Planck Institute of Molecular Physiology</institution>, Otto-Hahn-Str. 11, 44227 Dortmund, <country>Germany</country></aff></contrib-group><pub-date pub-type="epub-original" hwp:start="2018"><year>2018</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2018-06-26T15:14:57-07:00">
    <day>26</day><month>6</month><year>2018</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2018-06-26T15:14:57-07:00">
    <day>26</day><month>6</month><year>2018</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2018-06-26T15:21:56-07:00">
    <day>26</day><month>6</month><year>2018</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2018-06-26T15:21:56-07:00">
    <day>26</day><month>6</month><year>2018</year>
  </pub-date><elocation-id>356584</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2018-06-26"><day>26</day><month>6</month><year>2018</year></date>
<date date-type="rev-recd" hwp:start="2018-06-26"><day>26</day><month>6</month><year>2018</year></date>
<date date-type="accepted" hwp:start="2018-06-26"><day>26</day><month>6</month><year>2018</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2018</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/" hwp:id="license-1"><p hwp:id="p-1">This pre-print is available under a Creative Commons License (Attribution-NonCommercial-NoDerivs 4.0 International), CC BY-NC-ND 4.0, as described at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://creativecommons.org/licenses/by-nc-nd/4.0/" ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/" hwp:id="ext-link-1">http://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link></p></license></permissions><self-uri xlink:href="356584.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2019/pdf/356584v1.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="356584.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2019/abstracts/356584v1/356584v1.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2019/fulltext/356584v1/356584v1.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><p hwp:id="p-2">Selecting particles from digital micrographs is an essential step in single particle electron cryomicroscopy (cryo-EM). Since manual selection is a tedious and time-consuming process, many automatic particle pickers have been developed. However, they have problems especially with non-ideal datasets. Here, we present a novel automated particle picking software called crYOLO, which is based on the deep learning object detection system “You Only Look Once” (YOLO). After training the network with 500 – 2,500 particles per dataset, it automatically selects the particles with high accuracy and precision reaching a speed of up to six micrographs per second. Importantly, we show that crYOLO can be trained to select previously unseen datasets paving the way for completely automated “on-the-fly” cryo-EM data pre-processing during data acquisition. CrYOLO is available as standalone program under <ext-link l:rel="related" l:ref-type="uri" l:ref="http://sphire.mpg.de/" ext-link-type="uri" xlink:href="http://sphire.mpg.de/" hwp:id="ext-link-2">http://sphire.mpg.de/</ext-link> and will be part of the image processing workflow in SPHIRE.</p></abstract><counts><page-count count="25"/></counts><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-1">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta></front><body><sec id="s1" hwp:id="sec-1"><title hwp:id="title-2">Introduction</title><p hwp:id="p-3">In recent years, single particle electron cryomicroscopy (cryo-EM) became one of the most important and versatile methods for investigating the structure and function of biological macromolecules. In single particle cryo-EM many images of identical but randomly oriented macromolecular particles are selected from raw cryo-EM micrographs, then digitally aligned, classified, averaged, and back-projected to obtain a three-dimensional structure of the protein.</p><p hwp:id="p-4">Since usually more than 100,000 particles have to be selected for a near-atomic cryo-EM structure, many automatic particle picking procedures, often based on heuristic approaches, have been recently developed<sup><xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">1</xref>–<xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-1" hwp:rel-id="ref-6">6</xref></sup>. A popular selection approach, called template matching, cross-correlates the micrographs with pre-calculated templates of the particle of interest. However, this procedure is error-prone and the parameter optimization is often complicated. Although it works with optimal data, it often fails when dealing with non-ideal datasets where part of the particles overlap or are degraded and the background of the micrographs is contaminated with ice. In these cases, either the number of selected particles decreases or the number of false positives increases tremendously. The last resort is then often manual selection of particles, which is laborious and time-intensive.</p><p hwp:id="p-5">To solve this problem two particle selection programs<sup><xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">7</xref>,<xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-1" hwp:rel-id="ref-8">8</xref></sup> have been recently developed, employing deep convolutional neural networks (CNN). CNNs are extremely successful in processing data with a grid-like topology<sup><xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">9</xref></sup>. For images this is undoubtedly the state-of-the-art method for pattern recognition and object detection. Similar to learning the weights and biases of specific neurons in a multi-layer perceptron<sup><xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-1" hwp:rel-id="ref-10">10</xref></sup>, a CNN learns the elements of convolutional kernels. A convolution is an operation which calculates the weighted sum of the local neighborhood at a specific position in an image. The weights are the elements of the kernel which extracts specific local features of an image, such as corners or edges. In convolutional neural networks, several layers of convolutions are stacked, where the output of one layer is the input of the next layer. This enables CNNs to learn hierarchies of features.</p><p hwp:id="p-6">Common modern object detection systems, like the particle selection tools by Wang et al. and Zhu et al.<sup><xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-2" hwp:rel-id="ref-7">7</xref>,<xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-2" hwp:rel-id="ref-8">8</xref></sup>, employ a specific classifier for an object and evaluate it at every position. Here, they slide a window over the micrograph to crop out single regions, pass it through a CNN network and finally classify the extracted region. The confidence of classification is transferred into a map and the object positions are estimated by finding the local maxima in this map. Using this approach, it is possible to handle more challenging datasets. However, as it classifies many cut out regions independently, it comes with a high computational cost. Moreover, since the classifier only sees the windowed region, it is not able to learn the larger context of a particle (e.g. to not pick regions near ice contamination).</p><p hwp:id="p-7">In 2016, Joseph Redmon introduced the ‘You Only Look Once’ (YOLO) framework<sup><xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">11</xref></sup> as an alternative to the sliding window approach and reformulated the classification problem into a regression task, where the exact position of the particle is predicted by a network. In contrast to the sliding window approach, the YOLO framework needs only a single pass of the full image instead of multiple passes of cropped-out regions. Thus, the YOLO approach basically splits the image into a grid and predicts for each grid cell if it contains the center of a particle in the bounding box. If that is the case, it applies regression to predict the relative position of the particle center inside the cell as well as the width and height of the bounding box (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Figure 1a</xref>). This procedure makes the detection pipeline rather simple and reduces the number of convolutions tremendously, which renders it fast but still accurate. During training, the YOLO approach only requires labeling positive examples, whereas the sliding window approach also needs the background and contamination to be labeled as negative examples. Moreover, since the network sees the complete image, it is able to learn the larger context and provides therefore an excellent framework to detect single particles in electron micrographs reliably and fast (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-2" hwp:rel-id="F1">Figure 1b</xref>).</p><fig id="fig1" position="float" fig-type="figure" orientation="portrait" hwp:id="F1" hwp:rev-id="xref-fig-1-1 xref-fig-1-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;356584v1/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Figure 1.</label><caption hwp:id="caption-1"><title hwp:id="title-3">Training and picking in crYOLO.</title><p hwp:id="p-8"><bold>a)</bold> The convolutional neural network of crYOLO is trained with a small dataset. For this purpose, only particles have to be labelled and not background or contamination. During training and later picking, the image is spatially downsampled by the CNN to a small grid. Then crYOLO predicts for each grid cell if it contains the center of a particle. If this is the case, it estimates the relative position of the particle center inside the grid cell as well as the width and height of the particle box. If not the grid cell is classified as background. Since the network “sees” the complete micrograph it learns the context of the particle. <bold>b)</bold> CrYOLO uses the trained CNN to select particles from the full dataset. Since every micrograph is only processed once by the network, this procedure is very fast and outperforms the sliding window approach; crYOLO selects up to six micrographs per second.</p></caption><graphic xlink:href="356584_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig><p hwp:id="p-9">Here, we present the novel single particle selection procedure crYOLO which utilizes the YOLO algorithm to select single particles in cryo-EM micrographs. We evaluated our procedure on three recently published high resolution cryo-EM datasets. The results demonstrate that crYOLO is able to accurately and precisely select single particles in micrographs of varying quality with a speed of up to six micrographs per second on a single GPU. This leads to a tremendous acceleration of particle selection, and significantly improves not only the quality of the datasets but also the final structure. Furthermore we show that crYOLO, trained on multiple datasets, is able to select previously unseen particles.</p></sec><sec id="s2" hwp:id="sec-2"><title hwp:id="title-4">Results</title><sec id="s2a" hwp:id="sec-3"><title hwp:id="title-5">Convolutional Neural Network</title><p hwp:id="p-10">The program crYOLO builds upon a Python-based open source implementation<sup><xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">12</xref></sup> of YOLO and uses the deep learning library Keras<sup><xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">13</xref></sup>. Beyond the basic implementation we added support for MRC micrographs, single channel data and EMAN1<sup><xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">14</xref></sup> box files. We added a graphical tool to read and create box files for training data generation or visualization of the results in a user-friendly manner (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-1" hwp:rel-id="F2">Figure 2</xref>) and made changes in the original neural network architecture of YOLO<sup><xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">15</xref></sup>.</p><fig id="fig2" position="float" fig-type="figure" orientation="portrait" hwp:id="F2" hwp:rev-id="xref-fig-2-1 xref-fig-2-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;356584v1/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Figure 2.</label><caption hwp:id="caption-2"><title hwp:id="title-6">Graphical tool for creating training data and visualizing results.</title><p hwp:id="p-11">The tool can read images in MRC, TIFF and JPG format and box files in EMAN1 format. The example shown is a micrograph of TRPC4<sup><xref ref-type="bibr" rid="c31" hwp:id="xref-ref-31-1" hwp:rel-id="ref-31">31</xref></sup> with many contaminants.</p></caption><graphic xlink:href="356584_fig2" position="float" orientation="portrait" hwp:id="graphic-2"/></fig><p hwp:id="p-12">The YOLO network consists of 22 convolutional and five max-pooling layers. In addition, it contains a passthrough layer to exploit fine grain features and the network is followed by a (1×1) convolutional layer that is used as a detection layer. YOLO uses a relatively coarse grid, which could lead to problems when detecting smaller particles as each grid cell can only detect a single particle. To tackle this, we took out the max-pooling layer after the 13<sup>th</sup> convolutional layer. Thus, the adapted network downsamples the input image only by a factor of 16 instead of 32 in original YOLO resulting in a finer effective grid size of 64×64 cells on an input image size of 1024×1024. By default, crYOLO bins the micrographs automatically to 1024×1024 pixels to reduce memory consumption and increase the detection speed. The finer grid is now suitable for detecting smaller particles. Finally, we removed the last six convolutional layers, the passthrough layer and placed a dropout layer in front of the detection layer to reduce overfitting (<xref ref-type="table" rid="tbl1" hwp:id="xref-table-wrap-1-1" hwp:rel-id="T1">Table 1</xref>).</p><p hwp:id="p-13">To increase the amount of training data and to reduce overfitting, we augmented our datasets for each training step of the crYOLO network by a random selection of the following methods: flipping, blurring, adding noise and random contrast changes.</p></sec><sec id="s2b" hwp:id="sec-4"><title hwp:id="title-7">Test datasets</title><p hwp:id="p-14">We validated the performance of our program on three different cryo-EM datasets which are publicly available in the electron microscopy public image archive (EMPIAR) and produced high-resolution structures. These include the TcdA1 toxin subunit from <italic toggle="yes">Photorhabdus luminescens</italic><sup><xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">16</xref></sup> (EMPIAR-10089, EMDB-3645), the <italic toggle="yes">Drosophila</italic> transient receptor channel NOMPC<sup><xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">17</xref></sup> (EMPIAR-10093, EMDB-8702) and the human peroxiredoxin-3 (Prx3)<sup><xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-1" hwp:rel-id="ref-18">18</xref></sup> (EMPIAR-10050, EMDB-3233).</p><table-wrap id="tbl1" orientation="portrait" position="float" hwp:id="T1" hwp:rev-id="xref-table-wrap-1-1 xref-table-wrap-1-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;356584v1/TBL1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T1</object-id><object-id pub-id-type="publisher-id">tbl1</object-id><label>Table 1.</label><caption hwp:id="caption-3"><title hwp:id="title-8">CrYOLO network architecture.</title><p hwp:id="p-15">The CNN consists of 16 convolutional and four max-pooling layers for feature extraction. For detection, a single convolutional layer is used with a dropout layer in front to reduce overfitting. The latter is only used during training, not during prediction.</p></caption><graphic xlink:href="356584_tbl1" position="float" orientation="portrait" hwp:id="graphic-3"/></table-wrap><p hwp:id="p-16">TcdA1 assembles in the soluble prepore state in a large bell-like shaped pentamer with a molecular weight of 1.4 MDa<sup><xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-1" hwp:rel-id="ref-19">19</xref></sup>. It has been our test specimen to develop the software package SPHIRE<sup><xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-2" hwp:rel-id="ref-16">16</xref></sup>. We previously used a dataset of only 7,475 particles of TcdA1 to obtain a reconstruction at a resolution of 3.5 Å<sup><xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-3" hwp:rel-id="ref-16">16</xref></sup>. Due to the large molecular weight of the specimen and its characteristic shape, particles are clearly discernible in the micrographs although a carbon support film was used. Therefore, the selection of the particles is straightforward in this case. We chose this test dataset because of its small size, since the quality and number of selected particles will have likely an influence on the quality of the final reconstruction.</p><p hwp:id="p-17">In the case of NOMPC, which was reconstituted in nanodiscs<sup><xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-2" hwp:rel-id="ref-17">17</xref></sup>, the overall shape of the particle, sample concentration, and limited contrast make it difficult to accurately select the particles, even though it has a molecular weight of 754 kDa. Furthermore, the density of the nanodisc is significantly higher than the density of the extramembrane domain of the protein, thus the center of mass is not located at the center of particle but shifted towards the nanodisc density. A challenge for the selection program is therefore to accurately detect the center of the particles and avoid selection of empty nanodiscs. We therefore chose NOMPC as second test dataset.</p><p hwp:id="p-18">Prx3 has a molecular weight of 257 kDa and shows a characteristic ring-like shape. The dataset is one of the first near-atomic resolution datasets recorded using a Volta phase plate<sup><xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-2" hwp:rel-id="ref-18">18</xref></sup> (VPP). The VPP introduces an additional phase shift in the unscattered beam. This increases the phase contrast significantly, providing a significant boost of the signal-to-noise ratio in the low-resolution range. This makes the structural analysis of low molecular weight complexes at high resolution possible and has revolutionized the cryo-EM field<sup><xref ref-type="bibr" rid="c20" hwp:id="xref-ref-20-1" hwp:rel-id="ref-20">20</xref></sup>. The VPP, however, enhances not only the contrast of the particles of interest, but also the contrast of all weak phase objects, including smaller particles (impurities, contamination, dissociated particle components) that would otherwise not be visible in conventional cryo-EM. This poses new complications with regard to particle selection, especially for automated particle picking procedures that cross-correlate raw EM images with templates. We therefore chose Prx3 as third test dataset.</p></sec><sec id="s2c" hwp:id="sec-5"><title hwp:id="title-9">Training of crYOLO</title><p hwp:id="p-19">To train crYOLO, we manually selected initial training datasets. Dependent on the density of particles, the heterogeneity of the background, and the variation of defocus, more or fewer micrographs are needed. We found that 500 to 2,500 particles from at least five micrographs were sufficient to properly train the networks for the three datasets used in this study (<xref ref-type="table" rid="tbl2" hwp:id="xref-table-wrap-2-1" hwp:rel-id="T2">Table 2</xref>). Ideally, each micrograph should be picked to completion. It should be emphasized that picking of negative examples (including background, carbon edges, ice contamination and “bad particles”) is not required at all in crYOLO. Twenty percent of the micrographs that were used for manual selection were chosen for validation purposes.</p><table-wrap id="tbl2" orientation="portrait" position="float" hwp:id="T2" hwp:rev-id="xref-table-wrap-2-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;356584v1/TBL2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T2</object-id><object-id pub-id-type="publisher-id">tbl2</object-id><label>Table 2.</label><caption hwp:id="caption-4"><title hwp:id="title-10">The number of manually picked particles and the corresponding number of micrographs.</title></caption><graphic xlink:href="356584_tbl2" position="float" orientation="portrait" hwp:id="graphic-4"/></table-wrap><p hwp:id="p-20">To determine the influence of the size of the training dataset on the selection quality, we trained the crYOLO network on subsets of the manually picked particle dataset. We decreased the size of the subsets systematically and evaluated the results by calculating the precision and recall scores<sup><xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-1" hwp:rel-id="ref-21">21</xref></sup>. The recall score measures the ability of the classifier to detect positive examples and the precision score specifies the strength of the classifier not to label a true negative as true positive. Both scores are summarized with the integral of the precision-recall curves (AUC), which is an aggregate measure for the quality of detection. The larger the AUC value, the better the performance.</p><p hwp:id="p-21">The selection performance was excellent, when using as few as 400 TcdA1 particles from four micrographs (<xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-1" hwp:rel-id="F3">Figure 3a</xref>). However, when fewer particles were used, such as 200, the training dataset was not large and representative enough to enable a precise selection (<xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-2" hwp:rel-id="F3">Figure 3a</xref>). Interestingly, training with 400 particles from four micrographs worked better than with 600 particles from six micrographs (<xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-3" hwp:rel-id="F3">Figure 3a</xref>). The reason for this unexpected behavior is the fact that four different defocus groups were used for the recording of the TcdA1 dataset. Therefore, selection of six micrographs instead of four results in an overrepresentation of certain defoci. However, this effect only appears when working with very small training datasets. In general, the user should make sure that the selection of micrographs covers the full defocus range when training crYOLO on manually picked particles.</p><fig id="fig3" position="float" fig-type="figure" orientation="portrait" hwp:id="F3" hwp:rev-id="xref-fig-3-1 xref-fig-3-2 xref-fig-3-3 xref-fig-3-4 xref-fig-3-5 xref-fig-3-6 xref-fig-3-7"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;356584v1/FIG3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F3</object-id><object-id pub-id-type="publisher-id">fig3</object-id><label>Figure 3.</label><caption hwp:id="caption-5"><title hwp:id="title-11">Training of the crYOLO network.</title><p hwp:id="p-22"><bold>a)</bold> Precision-recall curves for the TcdA1 dataset using several training set sizes. The curves were estimated based on four randomly selected test micrographs out of the full dataset (size 1024×1024, one micrograph for each defocus class). The AUC values are 0.964 (black), 0.939 (grey), 0.923 (yellow), 0.935 (cyan), 0.176 (red). <bold>b)</bold> The crYOLO network (black) trained on 10 micrographs shows a similar performance on 1024×1024 micrographs in terms of AUC but with slightly lower precision and higher recall as the YOLO network (grey). On low resolution images of size 512×512 the crYOLO network (yellow) achieves an AUC = 0.71 and the YOLO network (cyan) an AUC of 0.31. <bold>c)</bold> Precision-recall curves for the Prx3 dataset using crYOLO network (black curve) and YOLO network (grey curve). Both networks were trained on the same dataset. The AUC was 0.846 and 0.376 respectively.</p></caption><graphic xlink:href="356584_fig3" position="float" orientation="portrait" hwp:id="graphic-5"/></fig><p hwp:id="p-23">We furthermore compared crYOLO with the original YOLO network using the full training dataset comprising 1,100 TcdA1 particles from 10 micrographs (<xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-4" hwp:rel-id="F3">Figure 3b</xref>). At an input image size of 1024×1024 the performance of the networks is very similar. However, for input images with the size of 512×512, crYOLO with an AUC of 0.71 is superior to YOLO which reaches only a very low AUC value of 0.31 in this case (<xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-5" hwp:rel-id="F3">Figure 3b</xref>). Therefore, it is possible to train crYOLO on GPUs with less memory. However, the 1024×1024 input image size is preferable due to the overall better performance (<xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-6" hwp:rel-id="F3">Figure 3b</xref>). Importantly, for Prx3 crYOLO significantly outperformed YOLO using a training dataset of 2,500 particles from 5 micrographs (<xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-7" hwp:rel-id="F3">Figure 3c</xref>), clearly highlighting the power of crYOLO for small particles.</p><p hwp:id="p-24">To quantify how well the particles are centered, we calculated the mean intersection over union (IOU) value of manually selected particles versus the automatically picked boxes using crYOLO. The IOU is defined as ratio of the intersecting area of two boxes and the area of their union and is a common measure for the localization accuracy. Picked particles with an IOU higher than 0.6 were classified as true positives. The mean IOU for TcdA1 and Prx3 was 0.88 ± 0.009 and 0.80 ±0. 004, respectively. This indicates a high localization accuracy of crYOLO. Since it was difficult to determine the proper center of each NOMPC particle even when selected manually, we did not calculate an IOU for this dataset.</p><p hwp:id="p-25">Besides this classical evaluation, we additionally calculated 2-D classes using the iterative stable alignment and clustering approach ISAC<sup><xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-1" hwp:rel-id="ref-22">22</xref></sup> implemented in the SPHIRE software package<sup><xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-4" hwp:rel-id="ref-16">16</xref></sup>. 2-D clustering using ISAC relies on the concepts of stability and reproducibility and is capable of extracting validated and homogeneous subsets of images that can be reliably processed in further steps of the workflow. Therefore, the number of particles in these subsets indirectly reflects the performance of the particle picker. Moreover, we calculated 3-D reconstructions and compared it to the published reconstructions.</p><p hwp:id="p-26">For TcdA1, crYOLO selected 11,436 particles from 98 micrographs. This is ~36% more particles than previously identified by the Gauss-Boxer in EMAN2<sup><xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-2" hwp:rel-id="ref-14">14</xref></sup> (<xref ref-type="fig" rid="fig4" hwp:id="xref-fig-4-1" hwp:rel-id="F4">Figure 4a-c</xref>). Also the number of ‘good’ particles after 2-D classification is significantly higher (<xref ref-type="fig" rid="fig4" hwp:id="xref-fig-4-2" hwp:rel-id="F4">Figure 4d,e</xref>), indicating that crYOLO is able to identify more true positive particles. This results in a slightly improved resolution of the 3-D reconstruction (<xref ref-type="fig" rid="fig4" hwp:id="xref-fig-4-3" hwp:rel-id="F4">Figure 4f,g</xref>).</p><fig id="fig4" position="float" fig-type="figure" orientation="portrait" hwp:id="F4" hwp:rev-id="xref-fig-4-1 xref-fig-4-2 xref-fig-4-3 xref-fig-4-4 xref-fig-4-5"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;356584v1/FIG4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F4</object-id><object-id pub-id-type="publisher-id">fig4</object-id><label>Figure 4.</label><caption hwp:id="caption-6"><title hwp:id="title-12">Selection of TcdAl particles and structural analysis.</title><p hwp:id="p-27"><bold>a-c)</bold> Representative digital micrograph (micrograph number 0169) taken from the EMPIAR-10089 dataset. Red boxes indicate the particles selected by Gauss-Boxer (<bold>a</bold>), crYOLO (<bold>b</bold>) or the generalized crYOLO network (<bold>c</bold>), respectively. Scale bar, 50 nm. <bold>d</bold>) Summary of particle selection and structural analysis of the three datasets. All datasets were processed using the same workflow in SPHIRE. <bold>e)</bold> Representative reference-free 2-D class averages of TcdA1 obtained using the ISAC and Beautifier tools (SPHIRE) from particles picked using crYOLO. Scale bar, 10 nm. <bold>f</bold>) Fourier shell correlation (FSC) curves of the 3-D reconstructions calculated from the particles selected in crYOLO and Gauss-Boxer. The FSC 0.143 between the independently refined and masked half-maps indicates resolutions of ~3.4 and ~3.5 Å, respectively. <bold>g)</bold> The final density map of TcdA1 obtained from particles picked by crYOLO is shown from the top and side, and is colored by subunit. The reconstruction using particles from the generalized crYOLO network is indistinguishable.</p></caption><graphic xlink:href="356584_fig4" position="float" orientation="portrait" hwp:id="graphic-6"/></fig><p hwp:id="p-28">For NOMPC, the authors picked originally 337,716 particles from 1,873 micrographs using RELION<sup><xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-1" hwp:rel-id="ref-23">23</xref></sup> (<xref ref-type="fig" rid="fig5" hwp:id="xref-fig-5-1" hwp:rel-id="F5">Figure 5b,c</xref>) and obtained a 3-D reconstruction at a resolution of 3.55 Å from 175,314 particles after extensive cleaning of the dataset by 2-D and 3-D classification in RELION<sup><xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-3" hwp:rel-id="ref-17">17</xref></sup>. CrYOLO was trained on 9 micrographs with 585 particles and selected only 228,499 particles (&gt; 30% less) (<xref ref-type="fig" rid="fig5" hwp:id="xref-fig-5-2" hwp:rel-id="F5">Figure 5a,c</xref>). After 2-D classification and the removal of bad classes (<xref ref-type="fig" rid="fig5" hwp:id="xref-fig-5-3" hwp:rel-id="F5">Figure 5c,d</xref>), 178,458 particles were used for the 3-D refinement yielding a slightly improved cryo-EM structure of NOMPC of 3.4 Å (<xref ref-type="fig" rid="fig5" hwp:id="xref-fig-5-4" hwp:rel-id="F5">Figure 5e-f</xref>). The reconstruction shows high-resolution features even in the region of the ankyrin-repeats (<xref ref-type="fig" rid="fig5" hwp:id="xref-fig-5-5" hwp:rel-id="F5">Figure 5g</xref>). Although the number of initially selected particles differs tremendously from crYOLO, the number of particles used for the final reconstruction is very similar, indicating that crYOLO selects less false positive particles than the selection tool in RELION. In this case, this also drastically reduced the steps and overall time of image processing, since 2-D classification was performed on a much lower starting number of particles and further cleaning of the dataset by a laborious 3-D classification was obsolete.</p><fig id="fig5" position="float" fig-type="figure" orientation="portrait" hwp:id="F5" hwp:rev-id="xref-fig-5-1 xref-fig-5-2 xref-fig-5-3 xref-fig-5-4 xref-fig-5-5"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;356584v1/FIG5</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F5</object-id><object-id pub-id-type="publisher-id">fig5</object-id><label>Figure 5.</label><caption hwp:id="caption-7"><title hwp:id="title-13">Selection of NOMPC particles and structural analysis.</title><p hwp:id="p-29"><bold>a, b)</bold>Representative micrograph (micrograph number 1,854) of the EMPIAR-10093 dataset. Particles picked by crYOLO <bold>(a)</bold> or RELION <bold>(b)</bold> are highlighted by red boxes, respectively. Scale bar, 50 nm. <bold>c)</bold> Summary of particle selection and structural analysis using RELION and crYOLO/SPHIRE. <bold>d)</bold> Representative reference-free 2-D class averages obtained using the ISAC and Beautifier tools (SPHIRE) from particles selected by crYOLO. Scale bar, 10 nm. <bold>e)</bold> FSC curves <bold>(f)</bold> and final 3-D reconstruction of the NOMPC dataset obtained from particles picked using crYOLO and processed with SPHIRE. The 0.143 FSC between the masked and unmasked half-maps indicates resolutions of 3.4 and 3.8 Å, respectively. The 3-D reconstruction is shown from the top and side. To allow better visualization of the nanodisc density the unsharpened (gray, transparent) and sharpened map (colored by subunits) are overlaid. <bold>g)</bold> Comparison of the density map obtained by crYOLO/SPHIRE with the deposited NOMPC 3-D reconstruction EMDB-8702.</p></caption><graphic xlink:href="356584_fig5" position="float" orientation="portrait" hwp:id="graphic-7"/></fig><p hwp:id="p-30">For Prx3, crYOLO identified 345,362 particles from 802 digital micrographs, which is comparable to the number of particles picked in the original article using EMAN2<sup><xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-3" hwp:rel-id="ref-18">18</xref></sup> (<xref ref-type="fig" rid="fig6" hwp:id="xref-fig-6-1" hwp:rel-id="F6">Figure 6a-c</xref>). We used two consecutive ISAC rounds to classify the particles in 2-D (<xref ref-type="fig" rid="fig6" hwp:id="xref-fig-6-2" hwp:rel-id="F6">Figure 6d</xref>). In the first one, we classified the whole dataset into large classes to identify the overall orientation of the particles. In the second, we split them into top, side and tilted views, and ran independent classifications on each of them. This procedure is necessary to avoid centering errors in ISAC. After discarding bad classes and removing most of the preferential top view orientations, the dataset was reduced to 43,852 particles. 3-D refinement of this particle stack in SPHIRE yielded a map at a nominal resolution of 4.7 Å (<xref ref-type="fig" rid="fig6" hwp:id="xref-fig-6-3" hwp:rel-id="F6">Figure 6e, f</xref>). In comparison, the final stack in the original article was composed of only 8,562 particles, which were refined to a 4.4 Å resolution map in RELION. Compared to our processing pipeline, the authors used three rounds of 2-D and four rounds of 3-D classification in RELION<sup><xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-2" hwp:rel-id="ref-23">23</xref></sup> to clean this dataset.</p><fig id="fig6" position="float" fig-type="figure" orientation="portrait" hwp:id="F6" hwp:rev-id="xref-fig-6-1 xref-fig-6-2 xref-fig-6-3 xref-fig-6-4"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;356584v1/FIG6</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F6</object-id><object-id pub-id-type="publisher-id">fig6</object-id><label>Figure 6.</label><caption hwp:id="caption-8"><title hwp:id="title-14">Selection of Prx3 particles and structural analysis.</title><p hwp:id="p-31"><bold>a-b)</bold> Particles selected on a representative micrograph (micrograph number 19.22.14) of the EMPIAR-10050 dataset using either crYOLO <bold>(a)</bold> or EMAN2 <bold>(b)</bold>. Scale bar, 100 nm. <bold>c)</bold> Summary of particle selection and structural analysis. The resolution in parentheses is the result obtained after a 3-D refinement performed in SPHIRE, using the final 8,562 particles of the original dataset. <bold>d)</bold> Representative 2-D class averages obtained from 2 rounds of classification using the crYOLO-selected particles and ISAC. Scale bar, 10 nm. Well-centered examples for all views showing high-resolution details can be readily obtained from the data. <bold>e)</bold> Fourier shell correlation plots for the final 3-D reconstruction (black) using the crYOLO-selected particles or the 8,562 particles from the original dataset (gray). The average resolution of our 3-D reconstruction is ~ 4.7 Å while that one from the originally used particles is ~ 4.5 Å. <bold>f)</bold> Top and side views of the 3-D reconstruction obtained with crYOLO/SPHIRE. For guidance, all subunits are colored differently in the volume.</p></caption><graphic xlink:href="356584_fig6" position="float" orientation="portrait" hwp:id="graphic-8"/></fig><p hwp:id="p-32">The small differences in the final resolution of the reconstructions can be attributed to the fact that all reconstructions reach resolutions near the theoretical resolution limit; at a pixel size of 1.74 Å, 4.4 Å represents approximately 0.8 times Nyquist. Consistent with this, the FSC curves of the reconstructions from both sets of particles are practically superimposable (<xref ref-type="fig" rid="fig6" hwp:id="xref-fig-6-4" hwp:rel-id="F6">Figure 6e</xref>). Interestingly, a large fraction of the particles was discarded during refinement, both by the original authors − 97.6% −and by us−87.7% kept. In our case, this is not due to the quality of the particle selection. Indeed, 310,123 of our picks were included into the stably aligned images after ISAC. Instead, we deleted most of the particles found in the preferred top orientation, which represents roughly half the dataset. The remaining discarded images correspond to correct picks in regions where the protein forms clusters. In those cases, while the particles were correctly identified by crYOLO, the particles were not used for single particle reconstruction.</p></sec><sec id="s2d" hwp:id="sec-6"><title hwp:id="title-15">Computational efficiency</title><p hwp:id="p-33">We used a desktop computer equipped with a NVIDIA Geforce GTX 1080 graphics card with 8 GB memory and an Intel Core i7 6900k to train the networks and select the particles. The time needed for training the networks was 13 to 25 minutes (<xref ref-type="fig" rid="fig7" hwp:id="xref-fig-7-1" hwp:rel-id="F7">Figure 7a</xref>). Whereas the same was needed for training crYOLO on the TcdA1 and NOMPC datasets, the training time was lower for Prx3.</p><fig id="fig7" position="float" fig-type="figure" orientation="portrait" hwp:id="F7" hwp:rev-id="xref-fig-7-1 xref-fig-7-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;356584v1/FIG7</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F7</object-id><object-id pub-id-type="publisher-id">fig7</object-id><label>Figure 7.</label><caption hwp:id="caption-9"><title hwp:id="title-16">Computational efficiency statistics of training and particle selection.</title><p hwp:id="p-34"><bold>a)</bold>The crYOLO training time for TcdA1, NOMPC and Prx3 was 956 s, 1,378 s and 876 s, respectively. <bold>b)</bold> Number of processed micrographs per second during particle selection. All datasets were picked in less than a second per image. For TcdA1, crYOLO needed 0.16 s per micrograph, for NOMPC 0.21 s and 0.9 s for Prx3.</p></caption><graphic xlink:href="356584_fig7" position="float" orientation="portrait" hwp:id="graphic-9"/></fig><p hwp:id="p-35">The selection process was very fast for all three datasets (<xref ref-type="fig" rid="fig7" hwp:id="xref-fig-7-2" hwp:rel-id="F7">Figure 7b</xref>). The selection of the Prx3, TcdA1 and NOMPC datasets reached a speed of ~1.1, ~4.6 and ~6.0 micrographs per second, respectively. This difference in speed can be mainly explained by the density of particles within each micrograph. The fewer particles per micrograph, the faster crYOLO performs. While the micrographs of the TcdA1 and NOMPC datasets have on average ~ 140 particles, the Prx3 micrographs contain ~ 456 particles. We expect even faster performance for micrographs containing fewer particles.</p></sec><sec id="s2e" hwp:id="sec-7"><title hwp:id="title-17">Generalization to unseen datasets</title><p hwp:id="p-36">Ideally, crYOLO would specifically recognize and select particles that it has not seen before, paving the way for fully automated particle selection. In order to reach this level of generalization, we trained the network with a combination of 34,813 manually picked particles from 331 micrographs derived from two VPP and nine conventional cryo-EM datasets, including the Prx3 dataset described above, the T20S proteasome<sup><xref ref-type="bibr" rid="c24" hwp:id="xref-ref-24-1" hwp:rel-id="ref-24">24</xref></sup> (EMPIAR 10025) and nine other datasets from different projects that are currently being processed in our research group. The molecular weight of the complexes from the respective datasets ranges from 64 kDa to 1.1 MDa.</p><p hwp:id="p-37">Using this generalized crYOLO network, we automatically selected particles of TcdA1 (EMPIAR 10089), an ATP-synthase<sup><xref ref-type="bibr" rid="c25" hwp:id="xref-ref-25-1" hwp:rel-id="ref-25">25</xref></sup> (EMPIAR 10023), an in-house ribosome and an influenza hemagglutinin dataset<sup><xref ref-type="bibr" rid="c26" hwp:id="xref-ref-26-1" hwp:rel-id="ref-26">26</xref></sup> (EMPIAR 10097) (<xref ref-type="fig" rid="fig8" hwp:id="xref-fig-8-1" hwp:rel-id="F8">Figure 8a-d</xref>). Although crYOLO had never seen these particles before, it performed very well in selecting them specifically while avoiding to pick ice contamination or particles surrounded by contamination (<xref ref-type="fig" rid="fig8" hwp:id="xref-fig-8-2" hwp:rel-id="F8">Figure 8c</xref>). This clearly shows that crYOLO is able to learn general features for identifying particles in context of the micrograph.</p><fig id="fig8" position="float" fig-type="figure" orientation="portrait" hwp:id="F8" hwp:rev-id="xref-fig-8-1 xref-fig-8-2 xref-fig-8-3 xref-fig-8-4"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;356584v1/FIG8</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F8</object-id><object-id pub-id-type="publisher-id">fig8</object-id><label>Figure 8.</label><caption hwp:id="caption-10"><title hwp:id="title-18">Generalized crYOLO network.</title><p hwp:id="p-38"><bold>a-d)</bold> Particles selected on a representative micrograph of TcdA1 (EMPIAR 10089) <bold>(a)</bold>, ATP synthase (EMPIAR 10023) <bold>(b)</bold>, ribosome (in-house dataset) <bold>(c)</bold> and influenza hemagglutinin (EMPIAR 10097) <bold>(d)</bold> by crYOLO using the generalized network. None of the datasets was included in the set used for training the generalized crYOLO network. As the YOLO approach enables to learn the context of an object, crYOLO did not select particles enclosed in or overlaid by ice blobs (<bold>c</bold>, white arrows). Scale bars, 40 nm <bold>e</bold>) Precision-recall curves for TcdA1 picked with either a network directly trained on the TcdA1 dataset (black) and a generalized model trained on several datasets but not on TcdA1 (grey).</p></caption><graphic xlink:href="356584_fig8" position="float" orientation="portrait" hwp:id="graphic-10"/></fig><p hwp:id="p-39">To assess the quality of the generalized crYOLO network, we compared its performance selecting TcdA1 with that of the network that was directly trained on this protein (see above). As expected, the AUC and localization accuracy are better for the directly trained network (<xref ref-type="fig" rid="fig8" hwp:id="xref-fig-8-3" hwp:rel-id="F8">Figure 8e</xref>). However, the generalized crYOLO network selected a similar number of particles (<xref ref-type="fig" rid="fig4" hwp:id="xref-fig-4-4" hwp:rel-id="F4">Figure 4d</xref>); the AUC of 0.748 (<xref ref-type="fig" rid="fig8" hwp:id="xref-fig-8-4" hwp:rel-id="F8">Figure 8e</xref>) and the IOU of 0.77 show that its performance is of sufficient quality to select a good set of particles. Indeed, the TcdA1 particles, selected by the generalized crYOLO network resulted in a reconstruction of similar resolution and quality as the particles from the TcdA1-trained crYOLO (<xref ref-type="fig" rid="fig4" hwp:id="xref-fig-4-5" hwp:rel-id="F4">Figure 4f</xref>). We expect that increasing the number of particles on different micrographs from different complexes to train the network will further expand the capabilities of crYOLO.</p></sec></sec><sec id="s3" hwp:id="sec-8"><title hwp:id="title-19">Discussion</title><p hwp:id="p-40">Here, we present crYOLO, a novel automated particle-picking procedure for cryo-EM. crYOLO employs a state-of-the-art deep learning object detection system which contains a 16-layer convolutional neural network. The excellent performance of crYOLO on several state-of-the-art direct detector datasets, reflects the effectiveness of the program and its efficiency to detect good particles at an accuracy comparable to manual particle selection. This underlines its potential to become a crucial component in a streamlined automated workflow for single particle analysis and thus eliminates one of the few remaining bottlenecks.</p><p hwp:id="p-41">To close the other remaining gaps in the workflow between the electron microscope and data processing, such as evaluation, drift and CTF correction, file conversion and transfer, our lab has developed an on-the-fly processing pipeline called TranSPHIRE, which is documented and freely available on <ext-link l:rel="related" l:ref-type="uri" l:ref="https://www.sphire.mpg.de" ext-link-type="uri" xlink:href="https://www.sphire.mpg.de" hwp:id="ext-link-3">www.sphire.mpg.de</ext-link> (manuscript in preparation). The TranSPHIRE pipeline includes crYOLO.</p><p hwp:id="p-42">The crYOLO package is available as a standalone program and will also soon be integrated into the SPHIRE image processing workflow. In addition to the command line interface, crYOLO provides an easy-to-use graphical tool (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-2" hwp:rel-id="F2">Figure 2</xref>), that makes it easier for users to generate training data and evaluate the results. CrYOLO outputs the coordinate files in EMAN .box-file format which can be easily imported to all available software packages for single particle analysis. CrYOLO picks micrographs rapidly on a standard GPU. If a trained network is available, particle picking can also be performed on multi-core CPUs. However, this decreases the speed of selection to few seconds per micrograph.</p><p hwp:id="p-43">Our evaluation demonstrated that the accuracy of crYOLO yields a set of particles with a tremendously low number of false positives. The IOU values of the selected particles show the excellent centering performance of crYOLO. Both strengths improve the quality of the input data set for image processing and ultimately improve the final reconstruction in many cases. At the same time it dramatically reduces the number of subsequent processing steps, such as computationally intensive 3-D classifications, and thereby shortens the overall processing time.</p><p hwp:id="p-44">In comparison to template-based particle picking approaches, crYOLO is not prone to template bias and therefore the danger of picking “Einstein from noise” <sup><xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-2" hwp:rel-id="ref-22">22</xref></sup> is significantly reduced. The presented datasets have obtained optimal results after training the network on 5 to 10 micrographs. However, the particles in the training data set must be representative to those of the full dataset.</p><p hwp:id="p-45">Importantly, crYOLO can be trained to select previously unseen datasets. With only 34,813 manually picked particles from 331 micrographs derived from 11 cryo-EM datasets, we have already obtained a powerful generalized network. Adding more training datasets from different projects manually picked by experienced users will improve the performance of crYOLO even further. CrYOLO is especially suited for this procedure, because in contrast to the sliding-window approaches, training YOLO only requires particles to be labeled and not the background or contamination. Therefore, previously processed datasets can be directly used to train crYOLO without manually picking background and contamination afterwards. In principle, it is also feasible to train generalized networks, that are specialized on certain types of particles, such as viruses, elongated or very small particles to improve the performance of crYOLO. At the moment, the performance of convolutional neural networks is moving fast and new CNN networks which outperform earlier networks are released frequently. The flexible software architecture of crYOLO allows an easy incorporation of new CNN networks and therefore a straightforward adaption to new developments if necessary.</p><p hwp:id="p-46">Taken together, crYOLO enables rapid automated on-the-fly particle selection at the precision of manual picking without bias from reference templates. Furthermore, increasing the size of the training database will result in a generalized particle picker that can be used without a template or human intervention to select particles on most single particle cryo-EM projects within few minutes.</p></sec></body><back><ack hwp:id="ack-1"><title hwp:id="title-20">Acknowledgments</title><p hwp:id="p-47">We would like to thank Amir Apelbaum, Evelyn Schubert, and Philine Hagel for providing datasets for optimization purposes and Tanvir R. Tapu Shaikh for proofreading and fruitful discussions. We thank Yifan Cheng and Radostin Danev for kindly providing us with the original coordinates of the NOMPC and Prx3 particles, respectively. This work was supported by the Max Planck Society (S.R.) and the European Council under the European Union’s Seventh Framework Programme (FP7/2007-2013) (Grant 615984 to S.R.).</p></ack><sec hwp:id="sec-9"><title hwp:id="title-21">Author contributions</title><p hwp:id="p-48">S.R. designed the project, T.W. conceived the approach and wrote the software. T.W., C.G., M.S., T.M, optimized the approach, T.W., C.G., F.M. evaluated the performance, T.W. and S.R. wrote the manuscript with input from all authors. All authors discussed the results and the manuscript.</p></sec><sec hwp:id="sec-10"><title hwp:id="title-22">Data availability</title><p hwp:id="p-49">The training datasets for this study are available from the corresponding author upon reasonable request. CrYOLO is available for download under <ext-link l:rel="related" l:ref-type="uri" l:ref="http://sphire.mpg.de" ext-link-type="uri" xlink:href="http://sphire.mpg.de" hwp:id="ext-link-4">http://sphire.mpg.de</ext-link></p></sec><sec id="s4" hwp:id="sec-11"><title hwp:id="title-23">Online Methods</title><sec id="s4a" hwp:id="sec-12"><title hwp:id="title-24">CrYOLO architecture and training</title><p hwp:id="p-50">CrYOLO trains a deep convolutional neural network (CNN) for automated particle selection. A typical CNN consists of multiple convolutional and pooling layers, and is characterized by the depth of the network, which is the number of convolutional layers<sup><xref ref-type="bibr" rid="c27" hwp:id="xref-ref-27-1" hwp:rel-id="ref-27">27</xref></sup>. The input of a CNN is data with a grid-like topology, most often images which may have multiple channels. A convolutional layer consists of a fixed number of filters, and each filter consists of multiple convolutional kernels with a fixed size (typical 1×1, 3×3 or 5×5). The number of convolutional kernels per filter is equal to the number of channels in the input data of the layer. During forward propagation, each filter creates a feature map which is a channel in the final output of the layer. Each kernel is convolved with the corresponding input channel. The results are summed up along the channels, resulting in the first channel of the output. The same procedure is applied for the second filter which results in the second channel and so on. After all channels are calculated, the so-called batch normalization<sup><xref ref-type="bibr" rid="c28" hwp:id="xref-ref-28-1" hwp:rel-id="ref-28">28</xref></sup> is applied. Batch normalization normalizes the feature map and leads to faster training. Furthermore it has some regularization power which makes further regularization often unnecessary. Finally, a non-linear activation function is applied element-wise to the normalized feature map which results in the final feature map.</p><p hwp:id="p-51">In typical CNNs max-pooling layers are inserted between some of the convolutional layers. Max-pooling layers divide the input image into equal sized tiles (e.g. 2×2) which are then used to calculate a condensed feature map. Therefore for each tile a cell is created, the maximum for the tile is computed and inserted into the cell. This leads to a reduced dimensionality of the feature map, and makes the network more memory-efficient and robust against small perturbations in the pixel values.</p><p hwp:id="p-52">The general crYOLO network is summarized in <xref ref-type="table" rid="tbl1" hwp:id="xref-table-wrap-1-2" hwp:rel-id="T1">Table 1.</xref> The feature extraction part consists of 16 convolutional layers and each convolutional layer consists either of multiple 3×3 filters or 1×1 filters. All convolutional layers use padding so that they do not reduce the size of their input. We used the leaky rectified linear unit<sup><xref ref-type="bibr" rid="c29" hwp:id="xref-ref-29-1" hwp:rel-id="ref-29">29</xref></sup> (LRELU) as activation function. LRELU simply returns the element itself if the element is positive and the element multiplied by a fixed constant α (here α=0.1) if it is negative.</p><p hwp:id="p-53">Four max-pooling layers downsample the image by a factor of 16. During training, a dropout unit in the detection part sets 20 % of the entries in the feature map after layer 16 to zero. This regularizes the network and reduces overfitting. Finally, a convolution layer with six 1×1 filters does the actual detection. With the YOLO<sup><xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-2" hwp:rel-id="ref-15">15</xref></sup> approach, each cell in the final feature map is used (i) to classify if the center of a particle box is inside this grid cell and (ii) if that is the case, it predicts the exact position of the box center relative to the cell as well as the width and height of the box.</p><p hwp:id="p-54">The network was trained using backpropagation with the ADAM optimizer<sup><xref ref-type="bibr" rid="c30" hwp:id="xref-ref-30-1" hwp:rel-id="ref-30">30</xref></sup>. Backpropagation applies the chain-rule to compute the gradient values in every layer. The gradient determines how the kernel elements in each convolutional layer should be updated to get a lower loss. The optimizer determines how the gradient of the loss is used to update the network parameters. For YOLO, the loss function that is minimized in that way is given by:
<disp-formula id="ueqn1" hwp:id="disp-formula-1"><alternatives hwp:id="alternatives-1"><graphic xlink:href="356584_ueqn1.gif" position="float" orientation="portrait" hwp:id="graphic-11"/></alternatives></disp-formula>
where <inline-formula hwp:id="inline-formula-1"><alternatives hwp:id="alternatives-2"><inline-graphic xlink:href="356584_inline1.gif" hwp:id="inline-graphic-1"/></alternatives></inline-formula> is 1 if the center of a particle is in cell <italic toggle="yes">i</italic> and 0 otherwise, <italic toggle="yes">λ<sub>coord</sub></italic> and <italic toggle="yes">λ<sub>noobJ</sub></italic> constant weights, (<italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>,<italic toggle="yes">y</italic><sub><italic toggle="yes">i</italic></sub>) the centrum coordinates of the training boxes and <inline-formula hwp:id="inline-formula-2"><alternatives hwp:id="alternatives-3"><inline-graphic xlink:href="356584_inline2.gif" hwp:id="inline-graphic-2"/></alternatives></inline-formula> the predicted coordinates. The width and height of the box with their estimates are given by (<italic toggle="yes">w</italic><sub><italic toggle="yes">i</italic></sub>,<italic toggle="yes">h</italic><sub><italic toggle="yes">i</italic></sub>) and <inline-formula hwp:id="inline-formula-3"><alternatives hwp:id="alternatives-4"><inline-graphic xlink:href="356584_inline3.gif" hwp:id="inline-graphic-3"/></alternatives></inline-formula> respectively. The confidence that a cell contains a particle is <italic toggle="yes">C</italic><sub><italic toggle="yes">i</italic></sub>. The first term of the loss function penalizes bad localization of particle boxes. The second term penalizes inaccurate estimates for the width and height of the boxes. The third term tries to increase the confidence for cells with a particle inside. The last term decreases the confidence of those cells containing no particle center. The loss function slightly differs from the one used in Redmon et al.<sup><xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-2" hwp:rel-id="ref-11">11</xref></sup> since we have only a single class to predict and also only one reference box (anchor box in Redmon et al.<sup><xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-3" hwp:rel-id="ref-11">11</xref></sup>).</p></sec><sec id="s4b" hwp:id="sec-13"><title hwp:id="title-25">Data Augmentation</title><p hwp:id="p-55">During training each image is augmented before passing it through the network. This means that it is slightly altered by random selection methods instead of passing the original image through the network. As each image is passed multiple times through the network, it is randomly modified in different ways. This helps the network to reduce overfitting and also the amount of training data needed. The applied methods are:
<list list-type="bullet" hwp:id="list-1"><list-item hwp:id="list-item-1"><p hwp:id="p-56">Gaussian blurring: A random standard deviation between 0 and 3 is selected and then a corresponding filter mask is created. This mask is then convolved with the input image.</p></list-item><list-item hwp:id="list-item-2"><p hwp:id="p-57">Average blurring: A random mask size between 2 and 7 is chosen. This mask is shifted over the image. At each position the central element is replaced with the mean values of its neighbors.</p></list-item><list-item hwp:id="list-item-3"><p hwp:id="p-58">Flip: The image is mirrored along the horizontal axis.</p></list-item><list-item hwp:id="list-item-4"><p hwp:id="p-59">Noise: Gaussian noise with randomly selected standard deviation is added to the image.</p></list-item><list-item hwp:id="list-item-5"><p hwp:id="p-60">Dropout: Randomly replaces 1 to 10% of the image pixels with the image mean value.</p></list-item><list-item hwp:id="list-item-6"><p hwp:id="p-61">Contrast normalization: The contrast is changed by subtracting the median pixel value from each pixel, multiply them by a random constant and finally add the median value again.</p></list-item></list></p></sec></sec><ref-list hwp:id="ref-list-1"><title hwp:id="title-26">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1"><label>1.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.1" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Ogura T."><surname>Ogura</surname>, <given-names>T.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Sato C."><surname>Sato</surname>, <given-names>C.</given-names></string-name> <article-title hwp:id="article-title-2">An Automatic Particle Pickup Method Using a Neural Network Applicable to Low-Contrast Electron Micrographs</article-title>. <source hwp:id="source-1">Journal of Structural Biology</source> <volume>136</volume>, <fpage>227</fpage>–<lpage>238</lpage> (<year>2001</year>).</citation></ref><ref id="c2" hwp:id="ref-2"><label>2.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="Nicholson W. V."><surname>Nicholson</surname>, <given-names>W. V.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Glaeser R. M."><surname>Glaeser</surname>, <given-names>R. M.</given-names></string-name> <article-title hwp:id="article-title-3">Review: Automatic Particle Detection in Electron Microscopy</article-title>. <source hwp:id="source-2">Journal of Structural Biology</source> <volume>133</volume>, <fpage>90</fpage>–<lpage>101</lpage> (<year>2001</year>).</citation></ref><ref id="c3" hwp:id="ref-3"><label>3.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.3" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Huang Z."><surname>Huang</surname>, <given-names>Z.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Penczek P. A."><surname>Penczek</surname>, <given-names>P. A.</given-names></string-name> <article-title hwp:id="article-title-4">Application of template matching technique to particle detection in electron micrographs</article-title>. <source hwp:id="source-3">Journal of Structural Biology</source> <volume>145</volume>, <fpage>29</fpage>–<lpage>40</lpage> (<year>2004</year>).</citation></ref><ref id="c4" hwp:id="ref-4"><label>4.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.4" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Volkmann N."><surname>Volkmann</surname>, <given-names>N.</given-names></string-name> <source hwp:id="source-4">An approach to automated particle picking from electron micrographs based on reduced representation templates</source>. <volume>145</volume>, <fpage>152</fpage>–<lpage>156</lpage> (<year>2004</year>).</citation></ref><ref id="c5" hwp:id="ref-5"><label>5.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.5" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Scheres S. H. W."><surname>Scheres</surname>, <given-names>S. H. W.</given-names></string-name> <article-title hwp:id="article-title-5">Semi-automated selection of cryo-EM particles in RELION-1.3</article-title>. <source hwp:id="source-5">Journal of Structural Biology</source> <volume>189</volume>, <fpage>114</fpage>–<lpage>122</lpage> (<year>2015</year>).</citation></ref><ref id="c6" hwp:id="ref-6" hwp:rev-id="xref-ref-6-1"><label>6.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.6" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Roseman A. M."><surname>Roseman</surname>, <given-names>A. M.</given-names></string-name> <article-title hwp:id="article-title-6">FindEM—a fast, efficient program for automatic selection of particles from electron micrographs</article-title>. <source hwp:id="source-6">Journal of Structural Biology</source> <volume>145</volume>, <fpage>91</fpage>–<lpage>99</lpage> (<year>2004</year>).</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1 xref-ref-7-2"><label>7.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.7" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Wang F."><surname>Wang</surname>, <given-names>F.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-7">DeepPicker: A deep learning approach for fully automated particle picking in cryo-EM</article-title>. <source hwp:id="source-7">Journal of Structural Biology</source> <volume>195</volume>, <fpage>325</fpage>–<lpage>336</lpage> (<year>2016</year>).</citation></ref><ref id="c8" hwp:id="ref-8" hwp:rev-id="xref-ref-8-1 xref-ref-8-2"><label>8.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Zhu Y."><surname>Zhu</surname>, <given-names>Y.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Ouyang Q."><surname>Ouyang</surname>, <given-names>Q.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Mao Y."><surname>Mao</surname>, <given-names>Y.</given-names></string-name> <article-title hwp:id="article-title-8">A deep convolutional neural network approach to single-particle recognition in cryo-electron microscopy</article-title>. <source hwp:id="source-8">BMC Bioinformatics</source> <volume>18</volume>, <fpage>29</fpage> (<year>2017</year>).</citation></ref><ref id="c9" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1"><label>9.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.9" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Rawat W."><surname>Rawat</surname>, <given-names>W.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Wang Z."><surname>Wang</surname>, <given-names>Z.</given-names></string-name> <article-title hwp:id="article-title-9">Deep Convolutional Neural Networks for Image Classification: A Comprehensive Review</article-title>. <source hwp:id="source-9">Neural Computation</source> <volume>29</volume>, <fpage>2352</fpage>–<lpage>2449</lpage> (<year>2017</year>).</citation></ref><ref id="c10" hwp:id="ref-10" hwp:rev-id="xref-ref-10-1"><label>10.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="Schmidhuber J."><surname>Schmidhuber</surname>, <given-names>J.</given-names></string-name> <article-title hwp:id="article-title-10">Deep learning in neural networks: An overview</article-title>. <source hwp:id="source-10">Neural Networks</source> <volume>61</volume>, <fpage>85</fpage>–<lpage>117</lpage> (<year>2015</year>).</citation></ref><ref id="c11" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1 xref-ref-11-2 xref-ref-11-3"><label>11.</label><citation publication-type="confproc" citation-type="confproc" ref:id="356584v1.11" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="Redmon J."><surname>Redmon</surname>, <given-names>J.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Divvala S."><surname>Divvala</surname>, <given-names>S.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Girshick R."><surname>Girshick</surname>, <given-names>R.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Farhadi A."><surname>Farhadi</surname>, <given-names>A.</given-names></string-name> <article-title hwp:id="article-title-11">You Only Look Once: Unified, Real-Time Object Detection</article-title>. in <fpage>779</fpage>–<lpage>788</lpage> (<conf-name>IEEE</conf-name>). doi:<pub-id pub-id-type="doi">10.1109/CVPR.2016.91</pub-id></citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1"><label>12.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.12" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Anh H. N."><surname>Anh</surname>, <given-names>H. N.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Suppa M."><surname>Suppa</surname>, <given-names>M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Sirotenko M."><surname>Sirotenko</surname>, <given-names>M.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Schoen A. J."><surname>Schoen</surname>, <given-names>A. J.</given-names></string-name> <source hwp:id="source-11">experiencor/basic-yolo-keras</source>. (<year>2018</year>). doi:<pub-id pub-id-type="doi">10.5281/zenodo.1168755</pub-id></citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1"><label>13.</label><citation publication-type="other" citation-type="journal" ref:id="356584v1.13" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="Chollet F. C. O."><surname>Chollet</surname>, <given-names>F. C. O.</given-names></string-name>others. <source hwp:id="source-12">Keras</source>. (<collab hwp:id="collab-1">GitHub</collab>, <year>2015</year>).</citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1 xref-ref-14-2"><label>14.</label><citation publication-type="other" citation-type="journal" ref:id="356584v1.14" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-14"><source hwp:id="source-13">EMAN2: An extensible image processing suite for electron microscopy</source>. <volume>157</volume>, <fpage>38</fpage>–<lpage>46</lpage> (<year>2007</year>).</citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1 xref-ref-15-2"><label>15.</label><citation publication-type="confproc" citation-type="confproc" ref:id="356584v1.15" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Redmon J."><surname>Redmon</surname>, <given-names>J.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Farhadi A."><surname>Farhadi</surname>, <given-names>A.</given-names></string-name> <article-title hwp:id="article-title-12">Y0L09000: Better, Faster, Stronger</article-title>. in <fpage>6517</fpage>–<lpage>6525</lpage> (<conf-name>IEEE</conf-name>). doi:<pub-id pub-id-type="doi">10.1109/CVPR.2017.690</pub-id></citation></ref><ref id="c16" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1 xref-ref-16-2 xref-ref-16-3 xref-ref-16-4"><label>16.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.16" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Moriya T."><surname>Moriya</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-13">High-resolution Single Particle Analysis from Electron Cryo-microscopy Images Using SPHIRE</article-title>. <source hwp:id="source-14">JoVE</source> <fpage>e55448</fpage>–<lpage>e55448</lpage> (<year>2017</year>). doi:<pub-id pub-id-type="doi">10.3791/55448</pub-id></citation></ref><ref id="c17" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1 xref-ref-17-2 xref-ref-17-3"><label>17.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.17" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="Jin P."><surname>Jin</surname>, <given-names>P.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-14">Electron cryo-microscopy structure of the mechanotransduction channel NOMPC</article-title>. <source hwp:id="source-15">Nature</source> <volume>547</volume>, <fpage>118</fpage>–<lpage>122</lpage> (<year>2017</year>).</citation></ref><ref id="c18" hwp:id="ref-18" hwp:rev-id="xref-ref-18-1 xref-ref-18-2 xref-ref-18-3"><label>18.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.18" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-18"><string-name name-style="western" hwp:sortable="Khoshouei M."><surname>Khoshouei</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-15">Volta phase plate cryo-EM of the small protein complex Prx3</article-title>. <source hwp:id="source-16">Nat Comms</source> <volume>7</volume>, <fpage>10534</fpage> (<year>2016</year>).</citation></ref><ref id="c19" hwp:id="ref-19" hwp:rev-id="xref-ref-19-1"><label>19.</label><citation publication-type="other" citation-type="journal" ref:id="356584v1.19" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-19"><source hwp:id="source-17">A syringe-like injection mechanism in Photorhabdus luminescens toxins</source>. <volume>495</volume>, <fpage>520</fpage>–<lpage>523</lpage> (<year>2013</year>).</citation></ref><ref id="c20" hwp:id="ref-20" hwp:rev-id="xref-ref-20-1"><label>20.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.20" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-20"><string-name name-style="western" hwp:sortable="Khoshouei M."><surname>Khoshouei</surname>, <given-names>M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Radjainia M."><surname>Radjainia</surname>, <given-names>M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Baumeister W."><surname>Baumeister</surname>, <given-names>W.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Danev R."><surname>Danev</surname>, <given-names>R.</given-names></string-name> <article-title hwp:id="article-title-16">Cryo-EM structure of haemoglobin at 3.2 Å determined with the Volta phase plate</article-title>. <source hwp:id="source-18">Nat Comms</source> <volume>8</volume>, <fpage>16099</fpage> (<year>2017</year>).</citation></ref><ref id="c21" hwp:id="ref-21" hwp:rev-id="xref-ref-21-1"><label>21.</label><citation publication-type="book" citation-type="book" ref:id="356584v1.21" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-21"><string-name name-style="western" hwp:sortable="Goutte C."><surname>Goutte</surname>, <given-names>C.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Gaussier E."><surname>Gaussier</surname>, <given-names>E.</given-names></string-name> <chapter-title>in Advances in Information Retrieval</chapter-title> <volume>3408</volume>, <fpage>345</fpage>–<lpage>359</lpage> (<publisher-name>Springer</publisher-name> <publisher-loc>Berlin Heidelberg</publisher-loc>, <year>2005</year>).</citation></ref><ref id="c22" hwp:id="ref-22" hwp:rev-id="xref-ref-22-1 xref-ref-22-2"><label>22.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.22" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-22"><string-name name-style="western" hwp:sortable="Yang Z."><surname>Yang</surname>, <given-names>Z.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Fang J."><surname>Fang</surname>, <given-names>J.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Chittuluru J."><surname>Chittuluru</surname>, <given-names>J.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Asturias F. J."><surname>Asturias</surname>, <given-names>F. J.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Penczek P. A."><surname>Penczek</surname>, <given-names>P. A.</given-names></string-name> <article-title hwp:id="article-title-17">Iterative Stable Alignment and Clustering of 2D Transmission Electron Microscope Images</article-title>. <source hwp:id="source-19">Structure</source> <volume>20</volume>, <fpage>237</fpage>–<lpage>247</lpage> (<year>2012</year>).</citation></ref><ref id="c23" hwp:id="ref-23" hwp:rev-id="xref-ref-23-1 xref-ref-23-2"><label>23.</label><citation publication-type="other" citation-type="journal" ref:id="356584v1.23" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-23"><source hwp:id="source-20">RELION: implementation of a Bayesian approach to cryo-EM structure determination</source>. <volume>180</volume>, <fpage>519</fpage>–<lpage>530</lpage> (<year>2012</year>).</citation></ref><ref id="c24" hwp:id="ref-24" hwp:rev-id="xref-ref-24-1"><label>24.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.24" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-24"><string-name name-style="western" hwp:sortable="Campbell M. G."><surname>Campbell</surname>, <given-names>M. G.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Veesler D."><surname>Veesler</surname>, <given-names>D.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Cheng A."><surname>Cheng</surname>, <given-names>A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Potter C. S."><surname>Potter</surname>, <given-names>C. S.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Carragher B."><surname>Carragher</surname>, <given-names>B.</given-names></string-name> <article-title hwp:id="article-title-18">2.8 Å resolution reconstruction of the Thermoplasma acidophilum 20S proteasome using cryo-electron microscopy</article-title>. <source hwp:id="source-21">eLife</source> <volume>4</volume>, <fpage>e01963</fpage> (<year>2015</year>).</citation></ref><ref id="c25" hwp:id="ref-25" hwp:rev-id="xref-ref-25-1"><label>25.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.25" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-25"><string-name name-style="western" hwp:sortable="Allegretti M."><surname>Allegretti</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-19">Horizontal membrane-intrinsic α-helices in the stator a-subunit of an F-type ATP synthase</article-title>. <source hwp:id="source-22">Nature</source> <volume>521</volume>, <fpage>237</fpage>–<lpage>240</lpage> (<year>2015</year>).</citation></ref><ref id="c26" hwp:id="ref-26" hwp:rev-id="xref-ref-26-1"><label>26.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.26" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-26"><string-name name-style="western" hwp:sortable="Tan Y. Z."><surname>Tan</surname>, <given-names>Y. Z.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-20">Addressing preferred specimen orientation in single-particle cryo-EM through tilting</article-title>. <source hwp:id="source-23">Nat Meth</source> <volume>14</volume>, <fpage>793</fpage>–<lpage>796</lpage> (<year>2017</year>).</citation></ref><ref id="c27" hwp:id="ref-27" hwp:rev-id="xref-ref-27-1"><label>27.</label><citation publication-type="confproc" citation-type="confproc" ref:id="356584v1.27" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-27"><string-name name-style="western" hwp:sortable="Lecun Y."><surname>Lecun</surname>, <given-names>Y.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Bottou L."><surname>Bottou</surname>, <given-names>L.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Bengio Y."><surname>Bengio</surname>, <given-names>Y.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Haffner P."><surname>Haffner</surname>, <given-names>P.</given-names></string-name> <article-title hwp:id="article-title-21">Gradient-based learning applied to document recognition</article-title>. <conf-name>Proc. IEEE</conf-name> <volume>86</volume>, <fpage>2278</fpage>–<lpage>2324</lpage> (<year>1998</year>).</citation></ref><ref id="c28" hwp:id="ref-28" hwp:rev-id="xref-ref-28-1"><label>28.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.28" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-28"><string-name name-style="western" hwp:sortable="Ioffe S."><surname>Ioffe</surname>, <given-names>S.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Szegedy C."><surname>Szegedy</surname>, <given-names>C.</given-names></string-name> <article-title hwp:id="article-title-22">Batch Normalization - Accelerating Deep Network Training by Reducing Internal Covariate Shift</article-title>. <source hwp:id="source-24">ICML</source> (<year>2015</year>).</citation></ref><ref id="c29" hwp:id="ref-29" hwp:rev-id="xref-ref-29-1"><label>29.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.29" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-29"><string-name name-style="western" hwp:sortable="Maas A. L."><surname>Maas</surname>, <given-names>A. L.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Hannun A. Y."><surname>Hannun</surname>, <given-names>A. Y.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Ng A. Y."><surname>Ng</surname>, <given-names>A. Y.</given-names></string-name> <source hwp:id="source-25">Rectifier Nonlinearities Improve Neural Network Acoustic Models</source>. in <volume>30</volume>, (<year>2013</year>).</citation></ref><ref id="c30" hwp:id="ref-30" hwp:rev-id="xref-ref-30-1"><label>30.</label><citation publication-type="other" citation-type="journal" ref:id="356584v1.30" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-30"><string-name name-style="western" hwp:sortable="Kingma D. P."><surname>Kingma</surname>, <given-names>D. P.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Ba J."><surname>Ba</surname>, <given-names>J.</given-names></string-name> <source hwp:id="source-26">Adam: A Method for Stochastic Optimization</source>. arXiv <ext-link l:rel="related" l:ref-type="uri" l:ref="http://arxiv.org/abs/abs/1412.6980" ext-link-type="arxiv" xlink:href="http://arxiv.org/abs/abs/1412.6980" hwp:id="ext-link-5">abs/1412.6980</ext-link>, (<year>2014</year>).</citation></ref><ref id="c31" hwp:id="ref-31" hwp:rev-id="xref-ref-31-1"><label>31.</label><citation publication-type="journal" citation-type="journal" ref:id="356584v1.31" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-31"><string-name name-style="western" hwp:sortable="Vinayagam D."><surname>Vinayagam</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-23">Electron cryo-microscopy structure of the canonical TRPC4 ion channel</article-title>. <source hwp:id="source-27">eLife</source> <volume>7</volume>, <fpage>213</fpage> (<year>2018</year>).</citation></ref></ref-list></back></article>
