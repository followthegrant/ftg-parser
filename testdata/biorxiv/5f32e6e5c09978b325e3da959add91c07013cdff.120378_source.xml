<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/120378</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;120378</article-id><article-id pub-id-type="other" hwp:sub-type="slug">120378</article-id><article-id pub-id-type="other" hwp:sub-type="tag">120378</article-id><article-version>1.4</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Bioinformatics" hwp:journal="biorxiv"><subject>Bioinformatics</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">Visualizing Structure and Transitions for Biological Data Exploration</article-title></title-group><author-notes hwp:id="author-notes-1"><corresp id="cor1" hwp:id="corresp-1" hwp:rev-id="xref-corresp-1-1"><label>*</label>Corresponding author. E-mail: <email hwp:id="email-1">smita.krishnaswamy@yale.edu</email> Address: 333 Cedar St, New Haven, CT 06510, USA</corresp><corresp id="cor2" hwp:id="corresp-2" hwp:rev-id="xref-corresp-2-1"><label>**</label>Correspondence for experiments. E-mail: <email hwp:id="email-2">natalia.ivanova@yale.edu</email></corresp><fn id="n1" fn-type="equal" hwp:id="fn-1" hwp:rev-id="xref-fn-1-1 xref-fn-1-2 xref-fn-1-3 xref-fn-1-4"><label>†</label><p hwp:id="p-1">These authors contributed equally.</p></fn><fn id="n2" fn-type="equal" hwp:id="fn-2" hwp:rev-id="xref-fn-2-1 xref-fn-2-2 xref-fn-2-3"><label>‡</label><p hwp:id="p-2">These authors contributed equally.</p></fn></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><name name-style="western" hwp:sortable="Moon Kevin R."><surname>Moon</surname><given-names>Kevin R.</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-1" hwp:rel-id="aff-2">2</xref><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-1" hwp:rel-id="aff-3">3</xref><xref ref-type="fn" rid="n1" hwp:id="xref-fn-1-1" hwp:rel-id="fn-1">†</xref></contrib><contrib contrib-type="author" hwp:id="contrib-2"><name name-style="western" hwp:sortable="van Dijk David"><surname>van Dijk</surname><given-names>David</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-2" hwp:rel-id="aff-3">3</xref><xref ref-type="fn" rid="n1" hwp:id="xref-fn-1-2" hwp:rel-id="fn-1">†</xref></contrib><contrib contrib-type="author" hwp:id="contrib-3"><name name-style="western" hwp:sortable="Wang Zheng"><surname>Wang</surname><given-names>Zheng</given-names></name><xref ref-type="aff" rid="a4" hwp:id="xref-aff-4-1" hwp:rel-id="aff-4">4</xref><xref ref-type="fn" rid="n1" hwp:id="xref-fn-1-3" hwp:rel-id="fn-1">†</xref></contrib><contrib contrib-type="author" hwp:id="contrib-4"><name name-style="western" hwp:sortable="Gigante Scott"><surname>Gigante</surname><given-names>Scott</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-3" hwp:rel-id="aff-1">1</xref><xref ref-type="fn" rid="n1" hwp:id="xref-fn-1-4" hwp:rel-id="fn-1">†</xref></contrib><contrib contrib-type="author" hwp:id="contrib-5"><name name-style="western" hwp:sortable="Burkhardt Daniel B."><surname>Burkhardt</surname><given-names>Daniel B.</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-4" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-6"><name name-style="western" hwp:sortable="Chen William S."><surname>Chen</surname><given-names>William S.</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-5" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-7"><name name-style="western" hwp:sortable="Yim Kristina"><surname>Yim</surname><given-names>Kristina</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-6" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-8"><name name-style="western" hwp:sortable="van den Elzen Antonia"><surname>van den Elzen</surname><given-names>Antonia</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-7" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-9"><name name-style="western" hwp:sortable="Hirn Matthew J."><surname>Hirn</surname><given-names>Matthew J.</given-names></name><xref ref-type="aff" rid="a5" hwp:id="xref-aff-5-1" hwp:rel-id="aff-5">5</xref><xref ref-type="aff" rid="a6" hwp:id="xref-aff-6-1" hwp:rel-id="aff-6">6</xref></contrib><contrib contrib-type="author" hwp:id="contrib-10"><name name-style="western" hwp:sortable="Coifman Ronald R."><surname>Coifman</surname><given-names>Ronald R.</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-2" hwp:rel-id="aff-2">2</xref></contrib><contrib contrib-type="author" corresp="yes" hwp:id="contrib-11"><name name-style="western" hwp:sortable="Ivanova Natalia B."><surname>Ivanova</surname><given-names>Natalia B.</given-names></name><xref ref-type="aff" rid="a4" hwp:id="xref-aff-4-2" hwp:rel-id="aff-4">4</xref><xref ref-type="fn" rid="n2" hwp:id="xref-fn-2-1" hwp:rel-id="fn-2">‡</xref><xref ref-type="corresp" rid="cor2" hwp:id="xref-corresp-2-1" hwp:rel-id="corresp-2">**</xref></contrib><contrib contrib-type="author" hwp:id="contrib-12"><name name-style="western" hwp:sortable="Wolf Guy"><surname>Wolf</surname><given-names>Guy</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-3" hwp:rel-id="aff-2">2</xref><xref ref-type="fn" rid="n2" hwp:id="xref-fn-2-2" hwp:rel-id="fn-2">‡</xref></contrib><contrib contrib-type="author" corresp="yes" hwp:id="contrib-13"><name name-style="western" hwp:sortable="Krishnaswamy Smita"><surname>Krishnaswamy</surname><given-names>Smita</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-8" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-3" hwp:rel-id="aff-3">3</xref><xref ref-type="fn" rid="n2" hwp:id="xref-fn-2-3" hwp:rel-id="fn-2">‡</xref><xref ref-type="corresp" rid="cor1" hwp:id="xref-corresp-1-1" hwp:rel-id="corresp-1">*</xref></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2 xref-aff-1-3 xref-aff-1-4 xref-aff-1-5 xref-aff-1-6 xref-aff-1-7 xref-aff-1-8"><label>1</label><institution hwp:id="institution-1">Department of Genetics, Yale University</institution>, New Haven, CT, <country>USA</country></aff><aff id="a2" hwp:id="aff-2" hwp:rev-id="xref-aff-2-1 xref-aff-2-2 xref-aff-2-3"><label>2</label><institution hwp:id="institution-2">Applied Mathematics Program, Yale University</institution>, New Haven, CT, <country>USA</country></aff><aff id="a3" hwp:id="aff-3" hwp:rev-id="xref-aff-3-1 xref-aff-3-2 xref-aff-3-3"><label>3</label><institution hwp:id="institution-3">Department of Computer ScienceYale University</institution>, New Haven, CT, <country>USA</country></aff><aff id="a4" hwp:id="aff-4" hwp:rev-id="xref-aff-4-1 xref-aff-4-2"><label>4</label><institution hwp:id="institution-4">Yale Stem Cell Center, Department of Genetics, Yale University</institution>, New Haven, CT, <country>USA</country></aff><aff id="a5" hwp:id="aff-5" hwp:rev-id="xref-aff-5-1"><label>5</label><institution hwp:id="institution-5">Department of Computational Mathematics, Science and Engineering</institution>, East Lansing, MI, <country>USA</country></aff><aff id="a6" hwp:id="aff-6" hwp:rev-id="xref-aff-6-1"><label>6</label><institution hwp:id="institution-6">Department of Mathematics, Michigan State University</institution>, East Lansing, MI, <country>USA</country></aff></contrib-group><pub-date pub-type="epub-original" hwp:start="2019"><year>2019</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2017-03-24T15:03:15-07:00">
    <day>24</day><month>3</month><year>2017</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2019-04-04T12:48:12-07:00">
    <day>4</day><month>4</month><year>2019</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2017-03-24T15:25:34-07:00">
    <day>24</day><month>3</month><year>2017</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2019-04-04T12:52:27-07:00">
    <day>4</day><month>4</month><year>2019</year>
  </pub-date><elocation-id>120378</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2017-03-24"><day>24</day><month>3</month><year>2017</year></date>
<date date-type="rev-recd" hwp:start="2019-04-03"><day>03</day><month>4</month><year>2019</year></date>
<date date-type="accepted" hwp:start="2019-04-04"><day>04</day><month>4</month><year>2019</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2019, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2019</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/" hwp:id="license-1"><p hwp:id="p-3">This pre-print is available under a Creative Commons License (Attribution-NonCommercial-NoDerivs 4.0 International), CC BY-NC-ND 4.0, as described at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://creativecommons.org/licenses/by-nc-nd/4.0/" ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/" hwp:id="ext-link-1">http://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link></p></license></permissions><self-uri xlink:href="120378.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2019/pdf/120378v4.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="120378.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2019/abstracts/120378v4/120378v4.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2019/fulltext/120378v4/120378v4.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><p hwp:id="p-4">With the advent of high-throughput technologies measuring high-dimensional biological data, there is a pressing need for visualization tools that reveal the structure and emergent patterns of data in an intuitive form. We present PHATE, a visualization method that captures both local and global nonlinear structure in data by an information-geometric distance between datapoints. We perform extensive comparison between PHATE and other tools on a variety of artificial and biological datasets, and find that it consistently preserves a range of patterns in data including continual progressions, branches, and clusters. We define a manifold preservation metric DEMaP to show that PHATE produces quantitatively better denoised embeddings than existing visualization methods. We show that PHATE is able to gain unique insight from a newly generated scRNA-seq dataset of human germ layer differentiation. Here, PHATE reveals a dynamic picture of the main developmental branches in unparalleled detail, including the identification of three novel subpopulations. Finally, we show that PHATE is applicable to a wide variety of datatypes including mass cytometry, single-cell RNA-sequencing, Hi-C, and gut microbiome data, where it can generate interpretable insights into the underlying systems.</p></abstract><counts><page-count count="92"/></counts><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-1">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta></front><body><sec id="s1" hwp:id="sec-1"><label>1</label><title hwp:id="title-2">Introduction</title><p hwp:id="p-5">High dimensional, high-throughput data are accumulating at a staggering rate, especially in biological systems measured using single-cell transcriptomics and other genomic and epigenetic assays. Since humans are visual learners, it is vitally important that these datasets are presented to researchers in intuitive ways to understand both the overall shape and the fine granular structure of the data. This is especially important in biological systems where structure exists at many different scales and is often unknown, for example in phenotypic or response progressions, in which a faithful visualization can lead to hypothesis generation.</p><p hwp:id="p-6">There are many dimensionality reduction methods for visualization [<xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">1</xref>–<xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">11</xref>], of which the most commonly used are PCA [<xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-2" hwp:rel-id="ref-11">11</xref>] and t-SNE [<xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-2" hwp:rel-id="ref-1">1</xref>–<xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-1" hwp:rel-id="ref-3">3</xref>]. However, these methods suffer from several drawbacks that render them suboptimal for exploration of high-dimensional high-throughput biological data. First, they tend to be <bold>sensitive to noise.</bold> Biomedical data is generally very noisy, and methods like PCA and Isomap [<xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">4</xref>] fail to explicitly remove this noise for visualization, leading to the smearing of local neighborhoods, rendering fine grained local structure impossible to recognize. Second, nonlinear visualization methods often <bold>scramble the global structure in data.</bold> For example, to faithfully represent local neighborhoods, methods such as t-SNE minimize an objective function that explicitly deprioritizes long-range distances, causing the global structure of the final embedding to be quasi-random. Third, many of them <bold>fail to optimize for two-dimensional visualization.</bold> Dimensionality reduction methods that are not specifically designed for visualization (e.g., PCA and diffusion maps) do not explicitly adapt their embedding (or coordinate mapping) to the number of dimensions required. Therefore, the visualized dimensions (e.g., the first two extracted coordinates) often only represent a small fraction of the structure of the entire dataset while discarding important information captured in additional dimensions.</p><p hwp:id="p-7">Furthermore, common implementations of dimensionality reduction methods often <bold>lack computational scalability.</bold> The volume of biomedical data being generated is growing at a scale that far outpaces Moore’s Law. State-of-the-art methods such as MDS and t-SNE were originally presented (e.g., in [<xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-3" hwp:rel-id="ref-1">1</xref>,<xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">7</xref>]) as proofs-of-concept with somewhat naïve implementations that do not scale well to datasets with hundreds of thousands, let alone millions, of data points due to speed or memory constraints. While some heuristic improvements may be made (see, for example, [<xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-2" hwp:rel-id="ref-3">3</xref>,<xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-1" hwp:rel-id="ref-8">8</xref>]), most available packages still follow the original implementation and thus cannot run on big data, which severely limits the usability of these methods in the medium to long term.</p><p hwp:id="p-8">Finally, we note that some methods try to alleviate visualization challenges by directly <bold>imposing a fixed geometry or intrinsic structure on the data.</bold> It is relatively simple to generate a faithful data visualization if one knows in advance the expected structure of the data. However, methods that impose a structure on the data generally have no way of alerting the user whether their predetermined structural assumption is correct. Indeed, any data will be transformed to fit a tree with Monocle2 [<xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">12</xref>] or clusters with t-SNE, for example. Therefore, while such methods are useful for data that fit their prior assumptions, they tend to generate spurious and misleading results otherwise, and are often ill suited for hypothesis generation, or data exploration that seeks emerging structure in data.</p><p hwp:id="p-9">To address the above concerns, we have designed a novel dimensionality reduction method for visualization named Potential of Heat-diffusion for Affinity-based Transition Embedding (PHATE). PHATE generates a low-dimensional embedding specific for visualization which provides an accurate, denoised representation of both local and global structure of a dataset in the required number of dimensions, without imposing any strong assumptions on the structure of the data, and is highly scalable, both in memory and runtime.</p><p hwp:id="p-10">To achieve this, we introduce novel mathematical contributions combining ideas from manifold learning, information geometry, and data-driven diffusion geometry. We leverage these together with strengths of current state-of-the-art methods, to result in a dimensionality reduction method carefully optimized for visualization of high-dimensional data. PHATE models the data as a statistical manifold in which each data point is represented by a probability distribution that is constructed via data diffusion using a novel graph construction. The process of data diffusion denoises the data. PHATE then compresses this graph for computational efficiency, and preserves a novel informational distance that we call the <italic toggle="yes">potential distance</italic> between these probability distributions that capture the intrinsic geometry of the dataset. The result is that high-dimensional and nonlinear structures, such as clusters, nonlinear progressions, and branches, become apparent in two or three dimensions and can be extracted for further analysis (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Figure 1A</xref>).</p><fig id="fig1" position="float" orientation="portrait" fig-type="figure" hwp:id="F1" hwp:rev-id="xref-fig-1-1 xref-fig-1-2 xref-fig-1-3 xref-fig-1-4 xref-fig-1-5 xref-fig-1-6 xref-fig-1-7 xref-fig-1-8 xref-fig-1-9 xref-fig-1-10 xref-fig-1-11 xref-fig-1-12 xref-fig-1-13"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Figure 1</label><caption hwp:id="caption-1"><p hwp:id="p-11">Overview of PHATE and its ability to reveal structure in data. (<bold>A</bold>) Conceptual figure demonstrating the progression of stem cells into different cell types and the corresponding high dimensional single-cell measurements rendered as a visualization by PHATE. (<bold>B</bold>) (Left) A 2D drawing of an artificial tree with color-coded branches. Data is uniformly sampled from each branch in 60 dimensions with Gaussian noise added (see Methods). (Right) Comparison of PCA, t-SNE, and the PHATE visualizations for the high-dimensional artificial tree data. PHATE is best at revealing global and branching structure in the data. In particular, PCA cannot reveal fine-grained local features such as branches while t-SNE breaks the structure apart and shuffles the broken pieces within the visualization. See <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-1" hwp:rel-id="F11">Figure S3</xref> for more comparisons on artificial data. (<bold>C</bold>) Comparison of PCA, t-SNE, and the PHATE visualizations for new embryoid body data showing similar trends as in (B). (<bold>D</bold>) PHATE applied to various datatypes. Left: PHATE on human microbiome data shows clear distinctions between skin, oral and fecal samples, as well as different enterotypes within the fecal samples. Middle: PHATE on Hi-C chromatin conformation data shows the global structure of chromatin. The embedding is colored by the different chromosomes. Right: PHATE on induced pluripotent stem cell (iPSC) CyTOF data. The embedding is colored by time after induction. See <xref ref-type="fig" rid="fig5" hwp:id="xref-fig-6-1" hwp:rel-id="F6">Figures 5</xref>, <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-1" hwp:rel-id="F15">S7</xref>, <xref ref-type="fig" rid="figS8" hwp:id="xref-fig-16-1" hwp:rel-id="F16">S8</xref>, and <xref ref-type="fig" rid="figS9" hwp:id="xref-fig-17-1" hwp:rel-id="F17">S9</xref> for more applications to real data.</p></caption><graphic xlink:href="120378_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig><p hwp:id="p-12">We show that PHATE consistently outperforms state-of-the-art methods both qualitatively and quantitatively on a wide variety of benchmark test cases where the ground truth is known. We present Denoised Embedding Manifold Preservation (DEMaP), a metric quantifying the ability of an embedding to preserved denoised manifold distances, and show that PHATE consistently outperforms 11 other methods on synthetically generated data with known ground truth. We also use PHATE to visualize several biological and non-biological real world datasets, showing PHATE’s capacity to visualize datasets with many different underlying structures, including trajectories, clusters, disconnected and intersecting manifolds, and more (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-2" hwp:rel-id="F1">Figure 1</xref>). To demonstrate the ability of PHATE to reveal new biological insights, we apply PHATE to a newly generated single-cell RNA-sequencing dataset of human embryonic stem cells grown as embryoid bodies over a period of 27 days to observe differentiation into diverse cell lineages. PHATE successfully captures all known branches of development within this system as well as numerous novel differentiation pathways, and enables the isolation of rare populations based on surface markers, which we validate experimentally.</p></sec><sec id="s2" hwp:id="sec-2"><label>2</label><title hwp:id="title-3">The PHATE Algorithm</title><p hwp:id="p-13">Visualizing complex, high-dimensional data in a way that is both easy to understand and faithful to the data is a difficult task. Such a method of visualization needs to preserve local and global structure in the high-dimensional data, denoise the data such that the underlying structure is clearly visible, and preserve as much information as possible in low (2-3) dimensions. In addition to these properties, a visualization method should be robust in the sense that the revealed structure of the data are insensitive to user configurations of the algorithm and scalable to the large sizes of modern data.</p><p hwp:id="p-14">Popular dimensionality reduction methods are deficient in one or more of these attributes. For example, t-SNE [<xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-4" hwp:rel-id="ref-1">1</xref>] provides a visualization that focuses on preserving local structure, often at the expense of the global structure (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-3" hwp:rel-id="F1">Figure 1B-C</xref>). In contrast, PCA focuses on preserving global structure at the expense of the local structure (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-4" hwp:rel-id="F1">Figure 1B-C</xref>). While PCA is often used for denoising as a preprocessing step, both PCA and t-SNE provide noisy visualizations when the data is noisy, which can obscure the structure of the data (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-5" hwp:rel-id="F1">Figure 1B-C</xref>). In contrast, diffusion maps [<xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">13</xref>] effectively denoises data and learns the local and global structure. However, diffusion maps typically encodes this information in higher dimensions [<xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">14</xref>], which is not amenable to visualization, and can introduce distortions in the visualization under certain conditions (see <xref ref-type="fig" rid="figS1" hwp:id="xref-fig-9-1" hwp:rel-id="F9">Figures S1</xref> and <xref ref-type="fig" rid="figS2" hwp:id="xref-fig-10-1" hwp:rel-id="F10">S2A</xref>). A discussion of other dimensionality reduction methods for visualization is included in <xref ref-type="sec" rid="s2b" hwp:id="xref-sec-7-1" hwp:rel-id="sec-7">Section 2.2</xref>.</p><p hwp:id="p-15">PHATE is carefully designed to overcome these weaknesses and provide a visualization that preserves the local and global structure of the data, denoises the data, and presents as much information as possible into low dimensions. There are three major steps in the PHATE algorithm.
<list list-type="order" hwp:id="list-1"><list-item hwp:id="list-item-1"><p hwp:id="p-16"><bold>Encode local data information via local similarities (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-1" hwp:rel-id="F2">Figure 2A-C</xref>).</bold> Local relationships between data points, even in the presence of noise, are meaningful with respect to the overall structure of the data as they can be chained together to learn global relationships along the manifold. For some data types, such as Hi-C chromatin conformation maps [<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">15</xref>], the local relationships are encoded directly in the measurements. In this case, this information can be used directly to encode the local similarities of the data. However, for most data types, the local similarities must be learned. We assume that component-wise, the data are well-modeled as lying on a manifold. Effectively, this means that small Euclidean distances are meaningful while large Euclidean distances may not be. We apply a novel kernel we developed (called the <italic toggle="yes">α</italic>-decay kernel) to Euclidean distances to accurately encode the local structure of the data even when the data is not uniformly sampled along the underlying manifold structure.</p></list-item><list-item hwp:id="list-item-2"><p hwp:id="p-17"><bold>Learn global structure and denoise data via diffusion (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-2" hwp:rel-id="F2">Figure 2D</xref>).</bold> Diffusing through data is a concept that was popularized in the derivation of Diffusion Maps (DM) [<xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-2" hwp:rel-id="ref-13">13</xref>]. Diffusion is performed by first transforming the local similarities into probabilities that measure the probability of transitioning from one data point to another in a single step of a random walk and then powering this operator to <italic toggle="yes">t</italic> steps to give <italic toggle="yes">t</italic>-step walk probabilities. Two points that have a high similarity have a high probability of transition and vice versa. Then, the local single-step transitions are propagated by taking a multi-step random walk. Thus both the local and global structure is encoded in the newly-calculated multi-step transition probabilities, referred to as the diffusion probabilities. For example, two points that have multiple potential, short paths that connect them will have a higher diffusion probability than two points that either have only long paths or relatively few paths connecting them. By considering all possible random walks, the diffusion process also denoises the data by downweighting spurious paths created by noise. Thus at the end of this step each point <italic toggle="yes">x<sub>i</sub></italic> is a vector of probabilities (in the ith row of the diffused operator) that a random walk starting at <italic toggle="yes">x<sub>i</sub></italic> would end up at every other vertex within <italic toggle="yes">t</italic> steps.</p></list-item><list-item hwp:id="list-item-3"><p hwp:id="p-18"><bold>Embed diffusion probability information into low dimensions for visualization (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-3" hwp:rel-id="F2">Figure 2E-F</xref>).</bold> Directly embedding the diffusion probabilities into 2 or 3 dimensions via eigenvalue decomposition or distance-preserving methods such as multidimensional scaling (MDS) results in either a loss of information (<xref ref-type="fig" rid="figS1" hwp:id="xref-fig-9-2" hwp:rel-id="F9">Figure S1</xref>) or an unstable embedding (<xref ref-type="fig" rid="figS2" hwp:id="xref-fig-10-2" hwp:rel-id="F10">Figures S2A</xref> and <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-2" hwp:rel-id="F11">S3D</xref>), respectively. Since the data are represented at this point by probability distributions, they lie on a statistical manifold. To extract the information from the diffusion probabilities for embedding, we develop a novel informational distance between points on this statistical manifold. We call this distance the <italic toggle="yes">potential distance</italic> (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-4" hwp:rel-id="F2">Figure 2E</xref>). This information distance is more sensitive to global relationships (between far-away points) and more stable at boundaries of manifolds than straight point-wise comparisons of probabilities (i.e., diffusion distances) as the potential distance is more sensitive to differences between low probabilities, resulting in a stronger emphasis on long-range distances.</p></list-item></list></p><fig id="fig2" position="float" orientation="portrait" fig-type="figure" hwp:id="F2" hwp:rev-id="xref-fig-2-1 xref-fig-2-2 xref-fig-2-3 xref-fig-2-4 xref-fig-2-5 xref-fig-2-6 xref-fig-2-7 xref-fig-2-8 xref-fig-2-9 xref-fig-2-10 xref-fig-2-11 xref-fig-2-12"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Figure 2</label><caption hwp:id="caption-2"><p hwp:id="p-19">Steps of the PHATE algorithm. (<bold>A</bold>) Data. (<bold>B</bold>) Euclidean distances. Data points are colored by their Euclidean distance to the highlighted point. (<bold>C</bold>) Markov-normalized affinity matrix. Distances are transformed to local affinities via a kernel function and then normalized to a probability distribution. Data points are colored by the probability of transitioning from the highlighted point in a single step random walk. (<bold>D</bold>) Diffusion probabilities. The normalized affinities are diffused to denoise the data and learn long-range relationships between points. Data points are colored by the probability of transitioning from the highlighted point in a <italic toggle="yes">t</italic> step random walk. (<bold>E</bold>) Informational distance. An informational distance (e.g. the potential distance) that measures the dissimilarity between the diffused probabilities is computed. The informational distance is better suited for computing differences between probabilities than the Euclidean distance. See the text for a discussion. (<bold>F</bold>) The final PHATE embedding. The informational distances are embedded into low dimensions using MDS. Note that distances or affinities can be directly input to the appropriate step in cases of connectivity data. Therefore, the Euclidean distance or our constructed affinities can be replaced with distances or affinities that best describe the data. For example, in <xref ref-type="fig" rid="figS9" hwp:id="xref-fig-17-2" hwp:rel-id="F17">Figure S9D</xref> we replace our affinity matrix with the Facebook connectivity matrix.</p></caption><graphic xlink:href="120378_fig2" position="float" orientation="portrait" hwp:id="graphic-2"/></fig><p hwp:id="p-20">To give a more intuitive view, consider two points <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic> that are on different sides of a line of points <italic toggle="yes">W</italic> = {<italic toggle="yes">w</italic><sub>1</sub>, <italic toggle="yes">w</italic><sub>2</sub>,…,<italic toggle="yes">w<sub>n</sub></italic>} (See <xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-5" hwp:rel-id="F2">Figure 2E</xref>), suppose that there is a small set of distant points <italic toggle="yes">Z</italic> = {<italic toggle="yes">z</italic><sub>1</sub>,<italic toggle="yes">z</italic><sub>2</sub>,…, <italic toggle="yes">z<sub>n</sub></italic>} that are on the same side of <italic toggle="yes">W</italic> as <italic toggle="yes">y</italic> but opposite side as <italic toggle="yes">x</italic> such that they are twice as far from <italic toggle="yes">x</italic> as from <italic toggle="yes">y</italic>. The representation of each point <italic toggle="yes">x</italic> is as its <italic toggle="yes">t</italic>-step diffusion probability to all other points. So to compute the potential distance between <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic> we compare these probabilities. What is the right type of distance to measure the distinction between these two probability distributions? One solution has been the diffusion distance which is simply the Euclidean distance between these probability distributions. However, in the example mentioned above the diffusion distance would be dominated by larger probabilities and the probabilities to the <italic toggle="yes">Z</italic> points would not affect the distance from <italic toggle="yes">x</italic> to <italic toggle="yes">y</italic> perhaps making them seem close. But instead, we take a divergence between the probabilities from <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic> by first log-scale transforming the probabilities and then taking their Euclidean distance, which makes the distance sensitive to fold-change. Thus, if a probability of 0.01 from <italic toggle="yes">x</italic> to a point <italic toggle="yes">z<sub>i</sub></italic> is changed to 0.02 from <italic toggle="yes">y</italic> then this has the same effect as if the probabilities had been 0.1 and 0.2. Thus, PHATE is sensitive to small differences in probability distribution corresponding to differences in long-range global structure, which allows PHATE to preserve global manifold relationships using this potential distance.</p><p hwp:id="p-21">The information in these distances is then squeezed into low dimensions for visualization via MDS, which creates an embedding by matching the distances in the low-dimensional space to the input distances, which are the potential distances in this case. See Appendix A.1.1 for more details on the advantages of the potential distance.</p><fig id="ufig1" position="float" orientation="portrait" fig-type="figure" hwp:id="F3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/UFIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F3</object-id><object-id pub-id-type="publisher-id">ufig1</object-id><graphic xlink:href="120378_ufig1" position="float" orientation="portrait" hwp:id="graphic-3"/></fig><p hwp:id="p-22">All of these steps are necessary to create a good visualization that preserves local and global structure in the high-dimensional data, denoise the data, and present as much information as possible into low dimensions. Focusing primarily on local relationships can distort global relationships in the data, as evidenced by t-SNE. Focusing primarily on global relationships can distort local relationships, as evidenced by PCA. Additionally, directly embedding both local and global information can result in a loss of information or an unstable embedding, as evidenced by diffusion maps and direct embedding of the diffusion distances. Thus all three steps are necessary. Further details on all of the steps of PHATE are included in Appendix A.1.1 and Algorithm 1. PHATE is also robust to the choice of parameters (Appendix A.1.2 and <xref ref-type="fig" rid="figS4" hwp:id="xref-fig-12-1" hwp:rel-id="F12">Figure S4</xref>).</p><p hwp:id="p-23">In addition to the exact computation of PHATE, we developed a fast version of PHATE that produces near-identical results. In this version, PHATE is implemented in an efficient and scalable manner by using landmark subsampling, sparse matrices, and randomized matrix decompositions. For more details on the scalability of PHATE see Appendix A.1.3, Algorithm 2, and <xref ref-type="fig" rid="figS5" hwp:id="xref-fig-13-1" hwp:rel-id="F13">Figure S5</xref>, which shows the fast runtime of PHATE on datasets of different sizes, including a dataset of 1.3 million cells (2.5 hours) and a network of 1.8 million nodes (12 minutes).</p><sec id="s2a" hwp:id="sec-3" hwp:rev-id="xref-sec-3-1"><label>2.1</label><title hwp:id="title-4">Extracting Information from PHATE</title><p hwp:id="p-24">PHATE embeddings contain a large amount of information on the structure of the data, namely, local transitions, progressions, branches or splits in progressions, and end states of progression. In this section, we present new methods that provide suggested end points, branch points, and branches based on the information from higher dimensional PHATE embeddings. These may not always correspond to real decision points, but provide an annotation to aid the user in interpreting the PHATE visual.</p><sec id="s2a1" hwp:id="sec-4"><title hwp:id="title-5">Branch Point Identification with Local Intrinsic Dimensionality</title><p hwp:id="p-25">Since PHATE emphasizes progressions, PHATE plots can show branch points or divergences in progression. In biological data, branch points often encapsulate switch-like decisions where cells sharply veer towards one of a small number of fates. For example, <xref ref-type="fig" rid="figS6" hwp:id="xref-fig-14-1" hwp:rel-id="F14">Figure S6A</xref> shows PHATE on a CyTOF dataset of induced pluripotent stem cells (iPSC) [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">16</xref>], with a central branch point identified. This branch point connects the early stages of cells with a branch of cells that are successfully reprogrammed and a branch of cells that are refractory (identified via selected markers including those in <xref ref-type="fig" rid="figS6" hwp:id="xref-fig-14-2" hwp:rel-id="F14">Figure S6B</xref>) and marks a major decision point between these two cell fates. Identifying branch points in biological data is of critical importance for analyzing such decisions.</p><p hwp:id="p-26">We make a key observation that most points in PHATE plots of biological data lie on lowdimensional progressions with some noise as demonstrated in <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-4-1" hwp:rel-id="F4">Figure 3Aii</xref>. Since branch points lie at the intersections of such progressions, they have higher local intrinsic dimensionality. We can also regard intrinsic dimensionality in terms of degrees of freedom in the progression modeled by PHATE. If there is only one fate possible for a cell (i.e. a cell lies on a branch as in <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-4-2" hwp:rel-id="F4">Figure 3Aii</xref>) then there are only two directions of transition between data points—forward or backward—and the local intrinsic dimension is low. If on the other hand, there are multiple fates possible, then there are at least three directions of transition possible—a single direction backwards and at least two forward. This cannot be captured by a one dimensional curve and will require a higher dimensional structure such as a plane, as shown in <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-4-3" hwp:rel-id="F4">Figure 3Aii</xref>. Thus, we can use the concept of local intrinsic dimensionality for identifying branch points.</p><fig id="fig3" position="float" orientation="portrait" fig-type="figure" hwp:id="F4" hwp:rev-id="xref-fig-4-1 xref-fig-4-2 xref-fig-4-3 xref-fig-4-4 xref-fig-4-5 xref-fig-4-6 xref-fig-4-7 xref-fig-4-8 xref-fig-4-9"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIG3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F4</object-id><object-id pub-id-type="publisher-id">fig3</object-id><label>Figure 3</label><caption hwp:id="caption-3"><p hwp:id="p-27">Extracting branches and branchpoints from PHATE. (<bold>A</bold>) Methods for identifying suggested endpoints, branch points, and branches. (i) PHATE computes a specialized diffusion operator as an intermediate step (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-6" hwp:rel-id="F2">Figure 2D</xref>). We use this diffusion operator to find endpoints. Specifically we use the the extrema of the corresponding diffusion components (eigenvectors of the diffusion operator) to identify endpoints [<xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-1" hwp:rel-id="ref-19">19</xref>]. (ii) Local intrinsic dimensionality is used to find branchpoints in a PHATE visual. As there are more degrees of freedom at branch points, the local intrinsic dimension is higher than through the rest of a branch. (iii) Cells in the PHATE embedding can be assigned to branches by considering the correlation between distances of neighbors to reference cells (e.g. branch points or endpoints). (<bold>B</bold>) Detected branches in the (i) artificial tree data, (ii) bone marrow scRNA-seq data from [<xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-1" hwp:rel-id="ref-21">21</xref>], and (iii) iPSC CyTOF data from [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-2" hwp:rel-id="ref-16">16</xref>].</p></caption><graphic xlink:href="120378_fig3" position="float" orientation="portrait" hwp:id="graphic-4"/></fig><p hwp:id="p-28">We use a <italic toggle="yes">k</italic>-nn based method for estimating local intrinsic dimensionality [<xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">17</xref>]. This method uses the relationship between the radius and volume of a <italic toggle="yes">d</italic>-dimensional ball. The volume increases exponentially with the dimensionality of the data. So as the radius increases by <italic toggle="yes">δ</italic>, the volume increases by <italic toggle="yes">δ<sup>d</sup></italic> where <italic toggle="yes">d</italic> is the dimensionality of the data. Thus the intrinsic dimension can be estimated via the growth rate of a <italic toggle="yes">k</italic>-nn ball with radius equal to the <italic toggle="yes">k</italic>-nn distance of a point. For more details on this approach, see Appendix A.1.4. We note that other local intrinsic dimension estimation methods could be used such as the maximum likelihood estimator in [<xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-1" hwp:rel-id="ref-18">18</xref>]. <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-4-4" hwp:rel-id="F4">Figure 3Aii</xref> shows that points of intersection in the artificial tree data indeed have higher local intrinsic dimensionality than points on branches.</p></sec><sec id="s2a2" hwp:id="sec-5"><title hwp:id="title-6">Endpoint Identification</title><p hwp:id="p-29">We also identify endpoints in the PHATE embedding. These points can correspond to the beginning or end-states of differentiation processes. For example, <xref ref-type="fig" rid="figS6" hwp:id="xref-fig-14-3" hwp:rel-id="F14">Figure S6A</xref> shows the PHATE visualization of the iPSC CyTOF dataset from [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-3" hwp:rel-id="ref-16">16</xref>] with highlighted endpoints, or end-states, of the reprogrammed and refractory branches. While many major endpoints can be identified by inspecting the PHATE visualization, we provide a method for identifying other endpoints or end-states that may be present in the higher dimensional PHATE embedding. We identify these states using data point centrality and distinctness as described below.</p><p hwp:id="p-30">First, we compute the centrality of a data point by quantifying the impact of its removal on the connectivity of the graph representation of the data (as defined using the local affinity matrix <italic toggle="yes">K<sub>k,α</sub></italic>). Removing a point that is on a one dimensional progression pathway, either branching point or not, breaks the graph into multiple parts and reduces the overall connectivity. However, removing an endpoint does not result in any breaks in the graph. Therefore we expect endpoints to have low centrality, as estimated using the eigenvector centrality measure of <italic toggle="yes">K<sub>k,α</sub></italic>.</p><p hwp:id="p-31">Second, we quantify the distinctness of a cellular state relative to the general data. We expect the beginning or end-states of differentiation processes to have the most distinctive cellular profiles. As shown in [<xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-2" hwp:rel-id="ref-19">19</xref>] we quantify this distinctness by considering the minima and the maxima of diffusion eigenvectors (see <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-4-5" hwp:rel-id="F4">Figure 3Ai</xref>). Thus we identify endpoints in the embedding as those that are most distinct and least central.</p></sec><sec id="s2a3" hwp:id="sec-6"><title hwp:id="title-7">Branch Identification</title><p hwp:id="p-32">After identifying branch points and endpoints, the remaining points can be assigned to branches between two branch points or between a branch point and endpoint. Due to the smoothly-varying nature of centrality and local intrinsic dimension, the previously described procedures identify regions of points as branch points or endpoints rather than individual points. However, it can be useful to reduce these regions to representative points for analysis such as branch detection and cell ordering. To do this, we reduce these regions to representative points using a “shake and bake” procedure similar to that in [<xref ref-type="bibr" rid="c20" hwp:id="xref-ref-20-1" hwp:rel-id="ref-20">20</xref>]. This approach groups collections of branch points or endpoints together into representative points based on their proximity (see Appendix A.1.4 for details). Further, a representative point is labeled an endpoint if the corresponding collection of points contains one or more endpoints as identified using centrality and distinctness. Otherwise, the representative point is labeled a branch point.</p><p hwp:id="p-33">After representative points have been selected, the remaining points can be assigned to corresponding branches. We use an approach based on the branch point detection method in [<xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-2" hwp:rel-id="ref-14">14</xref>] that compares the correlation and anticorrelation of neighborhood distances. However, we use higher dimensional PHATE coordinates instead of the diffusion maps coordinates. <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-4-6" hwp:rel-id="F4">Figure 3Aiii</xref> gives a visual demonstration of this approach and details are given in Appendix A.1.4. <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-4-7" hwp:rel-id="F4">Figure 3B</xref> shows the results of our approach to identifying branch points, endpoints, and branches on an artificial tree dataset, a scRNA-seq dataset of the bone marrow [<xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-2" hwp:rel-id="ref-21">21</xref>], and an iPSC CyTOF dataset [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-4" hwp:rel-id="ref-16">16</xref>]. Our procedure identifies the branches on the artificial tree perfectly and defines biologically meaningful branches on the other two datasets which we will use for data exploration.</p></sec></sec><sec id="s2b" hwp:id="sec-7" hwp:rev-id="xref-sec-7-1 xref-sec-7-2 xref-sec-7-3 xref-sec-7-4"><label>2.2</label><title hwp:id="title-8">Comparison of PHATE to Other Methods</title><p hwp:id="p-34">Here we compare PHATE to multiple dimensionality reduction methods. We provide quantitative comparisons on simulated data where the ground truth is known, and provide a qualitative comparison using both simulated and real biological data.</p><sec id="s2b1" hwp:id="sec-8"><title hwp:id="title-9">Quantitative Comparisons</title><p hwp:id="p-35">To compare PHATE to other visualization methods quantitatively, we formulated the Denoised Embedding Manifold Preservation (DEMaP) metric. DEMaP is designed to encapsulate the desirable properties of a dimensionality reduction method that is intended for visualization. These include: 1. the preservation of relationships in the data such that cells close together on the manifold are close together in the embedded space; and cells that are far apart on the manifold are far apart in the embedding, including disconnected manifolds (e.g. clusters) which should be as well separated as possible; and 2. denoising, such that the low-dimensional embedding accurately represents the ground truth data and is as invariant as possible to biological and technical noise. DEMaP encapsulates each of these properties by comparing the geodesic distances on the noiseless data to the Euclidean distances of the embedding extracted from noisy data. An overview of DEMaP is presented in <xref ref-type="fig" rid="fig4" hwp:id="xref-fig-5-1" hwp:rel-id="F5">Figure 4A</xref>. See Appendix A.3.1 for details.</p><fig id="fig4" position="float" orientation="portrait" fig-type="figure" hwp:id="F5" hwp:rev-id="xref-fig-5-1 xref-fig-5-2 xref-fig-5-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIG4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F5</object-id><object-id pub-id-type="publisher-id">fig4</object-id><label>Figure 4</label><caption hwp:id="caption-4"><p hwp:id="p-36">PHATE most accurately represents manifold distances in a 2D embedding. (<bold>A</bold>) Schematic description of performance comparison procedure. For each method and each type of corruption, Euclidean distances in the 2D embedding are compared to geodesic distances in an equivalent noiseless simulation by Spearman correlation. (<bold>B</bold>) Performance of 12 different methods across varying levels of corruption by dropout, decreased signal-to-noise ratio (BCV), randomly subsampled cells (subsample) and randomly subsampled genes (n_genes). Mean correlation of 20 runs for each configuration is shown. For further details see <xref ref-type="table" rid="tbl1" hwp:id="xref-table-wrap-1-1" hwp:rel-id="T1">Table 1</xref>.</p></caption><graphic xlink:href="120378_fig4" position="float" orientation="portrait" hwp:id="graphic-5"/></fig><p hwp:id="p-37">To compare the performance of PHATE to other dimensionality reduction methods, we calculated DEMaP using simulated scRNA-seq data using Splatter [<xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-1" hwp:rel-id="ref-22">22</xref>]. Splatter uses a parametric model to generate data with various structures, such as branches or clusters. This simulated data provides a ground truth reference to which we can add various types of noise. We then use this noisy data as input for each dimensionality reduction algorithm, and quantify the degree to which each representation preserves local and global structures and denoises the data.</p><p hwp:id="p-38">To generate a diverse set of ground truth references, we simulated 50 datasets containing clusters and 50 datasets containing branches. In each of these simulated datasets, the number and size of the clusters of branches as well as the global position of the clusters or branches with respect to each other is random. Furthermore, the local relationships between individual cells on these structures is random. Finally, the changes in gene expression within clusters or along branches is random. The output of this simulation is the ground truth reference.</p><p hwp:id="p-39">Next, we add biological and technical noise to the reference data. First, to simulate stochastic gene expression we use Splatter’s Biological Coefficient of Variation (BCV) parameter, which controls the level of gene expression in each cell following an inverse gamma distribution. Second, to simulate the inefficient capture of mRNA in single cells, we undersample from the true counts using the default BCV. Third, to demonstrate robustness to varying of total genes measured, we randomly remove genes from the data matrix. Finally, to demonstrate robustness to the number of cells captured, we randomly remove cells from each dataset. We vary each of these parameters, including by default some degree of biological variation and mRNA undersampling to each simulation. See Appendix A.3.3 for the exact parameters used for each simulation.</p><p hwp:id="p-40">We compared DEMaP for 12 visualization methods including t-SNE and UMAP. For each method, we used the default parameters and calculated visualization accuracy on each simulated dataset using 12 regimes of biological and technical noise parameters. We then averaged the accuracy across the 50 cluster datasets and 50 branch datasets for a total of 24 comparisons. The results are presented in <xref ref-type="fig" rid="fig4" hwp:id="xref-fig-5-2" hwp:rel-id="F5">Figure 4B</xref> and <xref ref-type="table" rid="tbl1" hwp:id="xref-table-wrap-1-2" hwp:rel-id="T1">Table 1</xref>. We found that PHATE had the highest DEMaP score in 22/24 comparisons and was the top-performing method overall. UMAP was the second best performing method overall but had the highest DEMaP score in only two of the comparisons, one of which is equal with PHATE. From these results, we conclude that PHATE captures the true structure of high dimensional data more accurately than existing visualization methods.</p><table-wrap id="tbl1" orientation="portrait" position="float" hwp:id="T1" hwp:rev-id="xref-table-wrap-1-1 xref-table-wrap-1-2 xref-table-wrap-1-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/TBL1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T1</object-id><object-id pub-id-type="publisher-id">tbl1</object-id><label>Table 1:</label><caption hwp:id="caption-5"><p hwp:id="p-41">Spearman correlation between Euclidean distances in 2D dimensionality reductions of Splatter simulations and geodesic distances calculated on ground truth data under different noise settings. The best performing method for each test is shown in bold. Results are presented in the form of mean correlation coefficient ± standard deviation. For each category, results are ordered by noise level from least to most. Methods are ordered by mean correlation across all tests, from left to right. The subsample parameter indicates the proportion of cells retained. The n_genes parameter indicates the number of retained genes.</p></caption><graphic xlink:href="120378_tbl1" position="float" orientation="portrait" hwp:id="graphic-6"/></table-wrap></sec><sec id="s2b2" hwp:id="sec-9"><title hwp:id="title-10">Qualitative Comparisons</title><p hwp:id="p-42">In addition to the quantitative comparison, we can visually compare the embeddings provided by different methods. <xref ref-type="fig" rid="fig5" hwp:id="xref-fig-6-2" hwp:rel-id="F6">Figure 5</xref> shows a comparison of the PHATE visualization to seven other methods on five single-cell datasets with known trajectory (<xref ref-type="fig" rid="fig5" hwp:id="xref-fig-6-3" hwp:rel-id="F6">Figure 5A,D,E</xref>) and cluster (<xref ref-type="fig" rid="fig5" hwp:id="xref-fig-6-4" hwp:rel-id="F6">Figure 5B-C</xref>) structures. We see that PHATE provides a clean and relatively denoised visualization of the data that highlights both the local and global structure: local clusters or branches are visually connected to each other in a global structure in each of the PHATE visualizations. Many of these branches are consistent with cell types or clusters validated by the authors [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-5" hwp:rel-id="ref-16">16</xref>,<xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-3" hwp:rel-id="ref-21">21</xref>,<xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-1" hwp:rel-id="ref-23">23</xref>,<xref ref-type="bibr" rid="c24" hwp:id="xref-ref-24-1" hwp:rel-id="ref-24">24</xref>] and additionally are also present in other visualizations such as force directed layout or t-SNE, suggesting that these structures in the PHATE embedding reflect true structure in the dataset. However, force directed layout tends to give a noisier visualization with fewer clear branches. Additionally, t-SNE [<xref ref-type="bibr" rid="c25" hwp:id="xref-ref-25-1" hwp:rel-id="ref-25">25</xref>] tends to shatter trajectories into clusters. Thus t-SNE creates the false impression that data contain natural clusters, which could lead to incorrect analysis. PCA tends to preserve the global structure well, but it gives a noisy visualization with very little visible local structure. We characterize each of these visualizations in detail in Appendix B.</p><fig id="fig5" position="float" orientation="portrait" fig-type="figure" hwp:id="F6" hwp:rev-id="xref-fig-6-1 xref-fig-6-2 xref-fig-6-3 xref-fig-6-4 xref-fig-6-5 xref-fig-6-6 xref-fig-6-7 xref-fig-6-8 xref-fig-6-9 xref-fig-6-10"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIG5</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F6</object-id><object-id pub-id-type="publisher-id">fig5</object-id><label>Figure 5</label><caption hwp:id="caption-6"><p hwp:id="p-43">Comparison of PHATE to other visualization methods on biological datasets. Columns represent different visualization methods, rows different datasets.</p></caption><graphic xlink:href="120378_fig5" position="float" orientation="portrait" hwp:id="graphic-7"/></fig><p hwp:id="p-44">We obtained similar results by comparing PHATE to eleven methods on nine non-biological datasets, including four artificial datasets where the ground truth is known (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-3" hwp:rel-id="F11">Figure S3</xref>). Expanded comparisons on single-cell data, including additional datasets and visualization methods, are also included in <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-2" hwp:rel-id="F15">Figure S7</xref>. See Appendix B for a full discussion of each method in all of these comparisons. A discussion of desirable attributes of some of these methods for the purposes of dimensionality reduction can also be found in [<xref ref-type="bibr" rid="c25" hwp:id="xref-ref-25-2" hwp:rel-id="ref-25">25</xref>].</p></sec></sec></sec><sec id="s3" hwp:id="sec-10" hwp:rev-id="xref-sec-10-1"><label>3</label><title hwp:id="title-11">Data Exploration with PHATE</title><p hwp:id="p-45">PHATE can reveal the underlying structure of the data for a variety of datatypes. Appendix C discusses PHATE applied to multiple different datasets, including SNP data, microbiome data, Facebook network data, Hi-C chromatin conformation data, and facial images (<xref ref-type="fig" rid="figS8" hwp:id="xref-fig-16-2" hwp:rel-id="F16">Figures S8</xref> and <xref ref-type="fig" rid="figS9" hwp:id="xref-fig-17-3" hwp:rel-id="F17">S9</xref>). In this section, however, we show the insights gained through the PHATE visualization of this structure for single-cell data. See Appendix A.2.2 for details on preprocessing steps.</p><p hwp:id="p-46">We show that the identifiable trajectories in the PHATE visualization have biological meaning that can be discerned from the gene expression patterns and the mutual information between gene expression and the ordering of cells along the trajectories. We analyze the mouse bone marrow scRNA-seq [<xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-4" hwp:rel-id="ref-21">21</xref>] and iPSC CyTOF [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-6" hwp:rel-id="ref-16">16</xref>] datasets described previously. Our analysis of the iPSC CyTOF data is presented here while the analysis of the mouse bone marrow data is presented in Appendix C. For both of these datasets, we used our new methods for detecting branches and branch points. We then ordered the cells within each trajectory using Wanderlust [<xref ref-type="bibr" rid="c26" hwp:id="xref-ref-26-1" hwp:rel-id="ref-26">26</xref>] applied to higher-dimensional PHATE coordinates. Ordering is generally from left to right. We note that ordering could also be based on other pseudotime ordering software such as those in [<xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-3" hwp:rel-id="ref-14">14</xref>,<xref ref-type="bibr" rid="c27" hwp:id="xref-ref-27-1" hwp:rel-id="ref-27">27</xref>–<xref ref-type="bibr" rid="c30" hwp:id="xref-ref-30-1" hwp:rel-id="ref-30">30</xref>]. To estimate the strength of the relationship between gene expression and cell ordering along branches, we estimated the DREMI score (a conditional-density resampled mutual information that eliminates biases to reveal shape-agnostic relationships between two variables [<xref ref-type="bibr" rid="c31" hwp:id="xref-ref-31-1" hwp:rel-id="ref-31">31</xref>]) between gene expression and the Wanderlust-based ordering within each branch. Genes with a high DREMI score within a branch are changing along the branch. We also use PHATE to analyze the transcriptional heterogeneity in rod bipolar cells to demonstrate PHATE’s ability to preserve cluster structure.</p><sec id="s3a" hwp:id="sec-11"><title hwp:id="title-12">iPSC Mass Cytometry Data</title><p hwp:id="p-47"><xref ref-type="fig" rid="figS6" hwp:id="xref-fig-14-4" hwp:rel-id="F14">Figure S6C</xref> shows the mass cytometry dataset from [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-7" hwp:rel-id="ref-16">16</xref>] that shows cellular reprogramming with Oct4 GFP from mouse embryonic fibroblasts (MEFs) to induced pluripotent stem cells (iPSCs) at the single-cell resolution. The protein markers measure pluripotency, differentiation, cell-cycle and signaling status. The cellular embedding (with combined timepoints) by PHATE shows a unified embedding that contains five main branches, further segmented in our visualization, each corresponding to biology identified in [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-8" hwp:rel-id="ref-16">16</xref>]. Branch 2 contains early reprogramming intermediates with the correct set of reprogramming factors Sox2<sup>+</sup>/Oct4<sup>+</sup>/Klf4<sup>+</sup>/Nanog<sup>+</sup> and with relatively low CD73 at the beginning of the branch. Branch 2 splits into two additional branches. Branches 4 and 6 (<xref ref-type="fig" rid="figS6" hwp:id="xref-fig-14-5" hwp:rel-id="F14">Figure S6</xref>) show the successful reprogramming to ESC-like lineages expressing markers such as Nanog, Oct4, Lin28 and Ssea1, and Epcam that are associated with transition to pluripotency [<xref ref-type="bibr" rid="c32" hwp:id="xref-ref-32-1" hwp:rel-id="ref-32">32</xref>]. Branch 5 shows a lineage that is refractory to reprogramming, does not express pluripotency markers, and is referred to as “mesoderm-like” in [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-9" hwp:rel-id="ref-16">16</xref>].</p><p hwp:id="p-48">Then, branch 3 represents an intermediate, partially reprogrammed state also containing Oct4<sup>+</sup>/Klf4<sup>+</sup>/CD73<sup>+</sup> but is not yet expressing pluripotency markers like Nanog or Lin28. However, the PHATE embedding indicates that Epcam, which is known to promote reprogramming generally [<xref ref-type="bibr" rid="c33" hwp:id="xref-ref-33-1" hwp:rel-id="ref-33">33</xref>], increases along this branch. This is evidenced by the high DREMI score between Epcam and the cell ordering within the branch (<xref ref-type="fig" rid="figS6" hwp:id="xref-fig-14-6" hwp:rel-id="F14">Figure S6C</xref>). This branch joins into branch 4 at a later stage, showing perhaps an alternative path or timing of reprogramming. Finally, branch 1 shows a lineage that has failed to reprogram, perhaps due to the wrong stoichiometry of the reprogramming factors [<xref ref-type="bibr" rid="c34" hwp:id="xref-ref-34-1" hwp:rel-id="ref-34">34</xref>]. Of note, this lineage contains low Klf4 which is an essential reprogramming factor.</p><p hwp:id="p-49">Additionally, the PHATE embedding shows a decrease in p53 expression in precursor branches (2 and 3) indicating that these cells are released from cell cycle arrest induced by initial reprogramming factor over expression [<xref ref-type="bibr" rid="c35" hwp:id="xref-ref-35-1" hwp:rel-id="ref-35">35</xref>]. However, along the refractory branch (branch 5) we see an increase in cleaved-caspase3, potentially indicating that the failure to reprogram correctly initiates apoptosis in these cells [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-10" hwp:rel-id="ref-16">16</xref>].</p></sec><sec id="s3b" hwp:id="sec-12"><title hwp:id="title-13">PHATE on different views of the data</title><p hwp:id="p-50">By default PHATE produces a single low dimensional embedding of a dataset. However, we can obtain variants of this embedding by reweighting the features before computing distances. Such reweightings correspond to specific “views” of the data. For example, in a biological context, we can upweight genes that are involved in a specific process to have PHATE prominently reflect this process. To demonstrate this reweighting scheme, we computed three alternative PHATE embeddings of the iPSC data, by upweighting either cell cycle markers, stem cell markers, or mitotic markers (<xref ref-type="fig" rid="figS10" hwp:id="xref-fig-18-1" hwp:rel-id="F18">Figure S10</xref>). PHATE, after upweighting cell cycle markers, gives an embedding with a circular structure (<xref ref-type="fig" rid="figS10" hwp:id="xref-fig-18-2" hwp:rel-id="F18">Figure S10Aii</xref>) that reflects the cyclical nature of the cell cycle. In addition to the circular structure, the embedding shows a small protrusion, with high expression of Ccasp3, suggesting that these cells are apoptotic. Upweighting stem cell markers gives an embedding with a 1-dimensional progression. Expression analysis reveals that stem cell markers such as Sox2 are high at one end of the progression and low on the other end. Moreover, the progression is correlated with time (measurement day), further supporting the idea that the progression that PHATE reveals marks the extent to which the cells are stem-like, with early timepoints being less stem-like. Finally, after upweighting mitotic markers, PHATE shows a different 1-dimensional progression. Here, the progression appears to be correlated with mitotic state, as can be seen by the expression of several mitosis-related genes (<xref ref-type="fig" rid="figS10" hwp:id="xref-fig-18-3" hwp:rel-id="F18">Figure S10Biii</xref>), such as pAKT, that are high only in one end of the embedding. Thus, PHATE computed after reweighting the genes can be used to obtain a process specific embedding to gain insight into predefined biological processes.</p></sec><sec id="s3c" hwp:id="sec-13"><title hwp:id="title-14">PHATE reveals transcriptional heterogeneity in Rod Bipolar Cells</title><p hwp:id="p-51"><xref ref-type="fig" rid="figS11" hwp:id="xref-fig-19-1" hwp:rel-id="F19">Figure S11Ai</xref> shows PHATE on scRNA-seq data of mouse retinal bipolar neurons from [<xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-2" hwp:rel-id="ref-23">23</xref>]. Cells were collected from an adult mouse and sorted for transgenic retinal bipolar markers. PHATE visualizes cluster structure while preserving relationships between clusters. The embedding is colored by the clusters described in the original study, which seeks to transcriptionally characterize all subtypes of bipolar cells. In the original characterization, rods bipolar cells (the largest cluster of cells) are shown as a single homogeneous cell type. However, the PHATE embedding in <xref ref-type="fig" rid="figS11" hwp:id="xref-fig-19-2" hwp:rel-id="F19">Figure S11Ai</xref> reveals a bifurcating trajectory within this cluster. We zoomed in on this bifurcating trajectory, by embedding just those cells, in order to determine their sub-structure.</p><p hwp:id="p-52">This embedding of just rod bipolar cells (<xref ref-type="fig" rid="figS11" hwp:id="xref-fig-19-3" hwp:rel-id="F19">Figure S11Aii</xref>) reveals four distinct sub-clusters (found by k-means clustering) of rod bipolar cells. We characterize the transcriptional profile of these sub-clusters in <xref ref-type="fig" rid="figS11" hwp:id="xref-fig-19-4" hwp:rel-id="F19">Figure S11B</xref>, showing all genes used for cell type assignment in [<xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-3" hwp:rel-id="ref-23">23</xref>]. Our results show a trajectory between rod bipolar cell types that is consistent with previous work by [<xref ref-type="bibr" rid="c36" hwp:id="xref-ref-36-1" hwp:rel-id="ref-36">36</xref>], in which cell types RB1 and RB2 are shown to be a continuum of variants of a single type. Further, we show distinct differences between these in known marker genes distinguishing RB1 and RB2 <italic toggle="yes">Trnp1, Rho</italic> and <italic toggle="yes">Pde6b</italic> [<xref ref-type="bibr" rid="c37" hwp:id="xref-ref-37-1" hwp:rel-id="ref-37">37</xref>], indicating that the four clusters we observe may be further subtypes of these two cell types.</p></sec></sec><sec id="s4" hwp:id="sec-14" hwp:rev-id="xref-sec-14-1"><label>4</label><title hwp:id="title-15">Exploratory Analysis with PHATE on Human ESC Differentiation Data</title><sec id="s4a" hwp:id="sec-15"><label>4.1</label><title hwp:id="title-16">Embryoid Body Single-Cell RNAseq Time Course</title><p hwp:id="p-53">To test the ability of PHATE to provide novel insights in a complex biological system, we generated and analyzed scRNA-seq data from human embryonic stem cells (hESCs) differentiating as embryoid bodies (EB) [<xref ref-type="bibr" rid="c38" hwp:id="xref-ref-38-1" hwp:rel-id="ref-38">38</xref>], a system which has never before been extensively analyzed at the single-cell level. EB differentiation is thought to recapitulate key aspects of early embryogene-sis and has been successfully used as the first step in differentiation protocols for certain types of neurons, astrocytes and oligodendrocytes [<xref ref-type="bibr" rid="c39" hwp:id="xref-ref-39-1" hwp:rel-id="ref-39">39</xref>–<xref ref-type="bibr" rid="c42" hwp:id="xref-ref-42-1" hwp:rel-id="ref-42">42</xref>], hematopoietic, endothelial and muscle cells [<xref ref-type="bibr" rid="c43" hwp:id="xref-ref-43-1" hwp:rel-id="ref-43">43</xref>–<xref ref-type="bibr" rid="c51" hwp:id="xref-ref-51-1" hwp:rel-id="ref-51">51</xref>], hepatocytes and pancreatic cells [<xref ref-type="bibr" rid="c52" hwp:id="xref-ref-52-1" hwp:rel-id="ref-52">52</xref>,<xref ref-type="bibr" rid="c53" hwp:id="xref-ref-53-1" hwp:rel-id="ref-53">53</xref>], as well as germ cells [<xref ref-type="bibr" rid="c54" hwp:id="xref-ref-54-1" hwp:rel-id="ref-54">54</xref>,<xref ref-type="bibr" rid="c55" hwp:id="xref-ref-55-1" hwp:rel-id="ref-55">55</xref>]. However, the developmental trajectories through which these early lineage precursors emerge from hESCs as well as their cellular and molecular identities remain largely unknown, particularly in human models.</p><p hwp:id="p-54">We measured approximately 31,000 cells, equally distributed over a 27-day differentiation time course (<xref ref-type="fig" rid="figS12" hwp:id="xref-fig-20-1" hwp:rel-id="F20">Figure S12A</xref> and Appendix A.2.1). Samples were collected at 3-day intervals and pooled for measurement on the 10x Chromium platform. The PHATE embedding of the EB data revealed a highly ordered and clean cellular structure dominated by continuous progressions (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-6" hwp:rel-id="F1">Figures 1C</xref> and <xref ref-type="fig" rid="fig6" hwp:id="xref-fig-7-1" hwp:rel-id="F7">6A</xref>), unlike other methods such as PCA or t-SNE (<xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-3" hwp:rel-id="F15">Figure S7</xref>). Exploratory analysis of this system using PHATE uncovered a comprehensive map of four major germ layers with both known and novel differentiation intermediates which were not captured with other visualization methods.</p><fig id="fig6" position="float" orientation="portrait" fig-type="figure" hwp:id="F7" hwp:rev-id="xref-fig-7-1 xref-fig-7-2 xref-fig-7-3 xref-fig-7-4 xref-fig-7-5 xref-fig-7-6 xref-fig-7-7 xref-fig-7-8 xref-fig-7-9 xref-fig-7-10 xref-fig-7-11 xref-fig-7-12 xref-fig-7-13 xref-fig-7-14 xref-fig-7-15"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIG6</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F7</object-id><object-id pub-id-type="publisher-id">fig6</object-id><label>Figure 6</label><caption hwp:id="caption-7"><p hwp:id="p-55">PHATE analysis of embryoid body scRNA-seq data. (<bold>A</bold>) i) The PHATE visualization colored by clusters. Clustering is done on a ten dimensional PHATE embedding. ii) The PHATE visualization colored by estimated local intrinsic dimensionality with selected branch points highlighted. iii) Branches and subbranches chosen from contiguous clusters for analysis.(<bold>B</bold>) Lineage tree of the EB system determined from the PHATE analysis showing embryonic stem cells (ESC), the primitive streak (PS), mesoderm (ME), endoderm (EN), neuroectoderm (NE), neural crest (NC), neural progenitors (NP), and others. Red font indicates novel cell precursors. (<bold>C</bold>) PHATE embedding overlaid with each of the populations in the lineage tree. Other abbreviations include lateral plate ME (LP ME), hemangioblast (H), cardiac (C), epicardial precursors (EP), smooth muscle precursors (SMP), cardiac precursors (CP), and neuronal subtypes (NS). (<bold>D</bold>) Heatmap showing the EMD score between the cluster distribution and the background distribution for each gene. Relevant genes for identifying the main lineages were manually identified. Genes are organized according to their maximum EMD score. (<bold>E</bold>) The EMD scores of the top scoring surface markers in the targeted sub-branches (sub-branches iii and vii). (<bold>F</bold>) Scatter plots of the bulk transcription factor expression vs. the mean single-cell transcription factor expression in sub-branches iii (left) and vii (right).</p></caption><graphic xlink:href="120378_fig6" position="float" orientation="portrait" hwp:id="graphic-8"/></fig></sec><sec id="s4b" hwp:id="sec-16"><label>4.2</label><title hwp:id="title-17">Deriving a Comprehensive Lineage Map with PHATE</title><p hwp:id="p-56">Importantly, PHATE retained global structure and organization of the data as is evidenced by the retention of a strong time trend in the embedding, although sample time was not included in creating the embedding. Further, PHATE revealed greater phenotypic diversity at later time points as seen by the larger space encompassed by the embedding at days 18 to 27 (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-7" hwp:rel-id="F1">Figure 1C</xref>).</p><p hwp:id="p-57">This phenotypic heterogeneity was further analyzed by both an automated analysis described in <xref ref-type="sec" rid="s2a" hwp:id="xref-sec-3-1" hwp:rel-id="sec-3">Sections 2.1</xref> (for identified clusters and branch points, see Appendix D, <xref ref-type="fig" rid="fig6" hwp:id="xref-fig-7-2" hwp:rel-id="F7">Figure 6A</xref> and <xref ref-type="table" rid="tblS1" hwp:id="xref-table-wrap-2-1" hwp:rel-id="T2">Table S1</xref>) and by manual examination of the embedding in conjunction with the established literature on germ layer development (<xref ref-type="fig" rid="figS12" hwp:id="xref-fig-20-2" hwp:rel-id="F20">Figure S12B</xref>). For the manual analyses, we used 80 markers from the literature to identify populations along the PHATE map which gave rise to a detailed germ layer specification map (<xref ref-type="fig" rid="fig6" hwp:id="xref-fig-7-3" hwp:rel-id="F7">Figure 6B</xref>). These populations are shown on the PHATE visualization in <xref ref-type="fig" rid="fig6" hwp:id="xref-fig-7-4" hwp:rel-id="F7">Figure 6C</xref>. In the lineage tree, the dots are the populations and the arrows represent transitions between the populations. Our map shows in detail how hESCs give rise to germ layer derivatives via a continuum of defined intermediate states.</p></sec><sec id="s4c" hwp:id="sec-17"><label>4.3</label><title hwp:id="title-18">Identification of Novel Transitional Populations with PHATE</title><p hwp:id="p-58">The comprehensive nature of the lineage map generated from the PHATE embedding allowed us to identify novel transitional populations that have not yet been characterized. Three novel pre-cursor states were identified in both manual and automated analyses: a bi-potent NC and NP pre-cursor, a novel EN precursor, and a novel cardiac precursor.</p><p hwp:id="p-59">Within the ectodermal lineage, differentiation begins with the induction of pre-NE state characterized by downregulaton of POU5F1 and induction of OTX2. This state is resolved into two precursors, NE-1 (<italic toggle="yes">GBX2+ZIC2/5+</italic>) and NE-2 (<italic toggle="yes">GBX2+OLIG2+HOXD1+</italic>). While NE-1 neuroectoderm appeared to develop along the canonical NE specification route and expressed a set of well established anterior NE markers (<italic toggle="yes">ZIC2/5, PAX6, GLI3, SIX3/6</italic>), the NE-2 neuroectoderm gave rise to a bi-potent <italic toggle="yes">HOXA2+HOXB1+</italic> precursor that subsequently separated into the NC branch and neural progenitor (NP) branch. Given its potential to generate both NE and NC cell types, the <italic toggle="yes">HOXA2+HOXB1+</italic> precursor could represent the equivalent of the neural plate border cells that have been defined in model organisms [<xref ref-type="bibr" rid="c56" hwp:id="xref-ref-56-1" hwp:rel-id="ref-56">56</xref>, <xref ref-type="bibr" rid="c57" hwp:id="xref-ref-57-1" hwp:rel-id="ref-57">57</xref>].</p><p hwp:id="p-60">Within the EN branch, the canonical <italic toggle="yes">EOMES+FOXA2+SOX17+</italic> EN precursor was clustered together with the novel <italic toggle="yes">EOMES-FOXA2-GATA3+SATB1+KLF8+</italic> precursor, which further differentiated into cells expressing posterior EN markers <italic toggle="yes">NKX2-1, CDX2, ASCL2</italic>, and <italic toggle="yes">KLF5</italic>. Finally, a novel <italic toggle="yes">T+GATA4+ CER1+PROX1+</italic> cardiac precursor cell was identified within the ME lineage that gave rise to <italic toggle="yes">TNNT2+</italic> cells via a <italic toggle="yes">GATA6+HAND1+</italic> differentiation intermediate.</p><p hwp:id="p-61">A more detailed analysis of the novel and canonical cell types derived from the PHATE embedding is given in Appendix D.</p></sec><sec id="s4d" hwp:id="sec-18"><label>4.4</label><title hwp:id="title-19">Experimental Validation of PHATE-Identified Lineages</title><p hwp:id="p-62">We next used the ability of PHATE to extract data on specific regions within the visualization to define a set of surface markers for the isolation and molecular characterization of specific cell populations within the EB differentiation process.</p><p hwp:id="p-63">We focused on two specific regions that correspond to the NC branch (sub-branch iii, <xref ref-type="fig" rid="fig6" hwp:id="xref-fig-7-5" hwp:rel-id="F7">Figure 6Aiii</xref>) and cardiac precursor sub-branch within the ME branch (sub-branch vii, <xref ref-type="fig" rid="fig6" hwp:id="xref-fig-7-6" hwp:rel-id="F7">Figure 6Aiii</xref>). Differential expression analysis identified a set of candidate markers for each region (<xref ref-type="fig" rid="fig6" hwp:id="xref-fig-7-7" hwp:rel-id="F7">Figures 6D-E</xref>). We focused on markers with a high Earth Mover’s Distance (EMD) [<xref ref-type="bibr" rid="c58" hwp:id="xref-ref-58-1" hwp:rel-id="ref-58">58</xref>] score in the targeted sub-branch, and low EMD scores in all other sub-branches (see Appendix A.1.5 for more details on the EMD). Based on these analyses and the availability of antibodies, <italic toggle="yes">CD49D/ITGA4</italic> was chosen for the neural crest (the highest scoring surface marker for subbranch iii) while <italic toggle="yes">CD142/F3</italic> and <italic toggle="yes">CD82</italic> were chosen for cardiac precursors (among the top 6% of surface markers and the top 3% of all genes by EMD). We FACS-purified <italic toggle="yes">CD49d+CD63-</italic> and <italic toggle="yes">CD82+CD142+</italic> and performed bulk RNA-sequencing (<xref ref-type="fig" rid="figS12" hwp:id="xref-fig-20-3" hwp:rel-id="F20">Figure S12F</xref>) on these sorted populations.</p><p hwp:id="p-64">To verify that we isolated the correct regions, we calculated the Spearman correlation between the gene expression pattern of each cell and the bulk RNA-seq data from the CD49d+CD63-sorted cells (<xref ref-type="fig" rid="fig6" hwp:id="xref-fig-7-8" hwp:rel-id="F7">Figures 6F</xref> and <xref ref-type="fig" rid="figS12" hwp:id="xref-fig-20-4" hwp:rel-id="F20">S12D</xref>). The correlation coefficient was the highest in the neural crest branch (branch iii), which corresponds to the highest expression of CD49d. Similar results were obtained for the cardiac precursor cells (<xref ref-type="fig" rid="fig6" hwp:id="xref-fig-7-9" hwp:rel-id="F7">Figures 6F</xref> and <xref ref-type="fig" rid="figS12" hwp:id="xref-fig-20-5" hwp:rel-id="F20">S12E</xref>).</p><p hwp:id="p-65">Taken together, our analyses show that PHATE has the potential to greatly accelerate the pace of biological discovery by suggesting hypotheses in the form of finely grained populations and identifying markers with which to isolate populations. These populations can be probed further using alternative measurements such as epigenetic or protein expression assays.</p></sec></sec><sec id="s5" hwp:id="sec-19"><label>5</label><title hwp:id="title-20">Conclusion</title><p hwp:id="p-66">With large amounts of high-dimensional high-throughput biological data being generated in many types of biological systems, there is a growing need for interpretable visualizations that can represent structures in data without strong prior assumptions. However, most existing methods are highly deficient at retaining structures of interest in biology. These include clusters, trajectories or progressions of various dimensionality, hybrids of the two, as well as local and global nonlinear relations in data. Furthermore, existing methods have trouble contending with the sizes of modern datasets and the high degree of noise inherent to biological datasets. PHATE provides a unique solution to these problems by creating a diffusion-based informational geometry from the data, and by preserving a divergence metric between datapoints that is sensitive to near and far manifold-intrinsic distances in the dataspace. Additionally, PHATE is able to offer clean and denoised visualizations because the information geometry created in PHATE is based on data diffusion dynamics which are robust to noise. Thus, PHATE reveals intricate local as well as global structure in a denoised way.</p><p hwp:id="p-67">We applied PHATE to a wide variety of datasets, including single-cell CyTOF and RNA-seq data, as well as Gut Microbiome and SNP data, where the datapoints are subjects rather than cells. We also tested PHATE on network data, such as Hi-C and Facebook networks. In each case, PHATE was able to reveal structures of visual interest to humans that other methods entirely miss. Moreover, we have implemented PHATE in a scalable way that enables it to process millions of datapoints in a matter of hours. Hence, PHATE can efficiently handle the datasets that are now being produced using single-cell RNA sequencing technologies, as we demonstrated using the 1.3 million cell dataset released by 10X genomics.</p><p hwp:id="p-68">To showcase the ability of PHATE to explore data generated in new systems, we applied PHATE to our newly generated human EB differentiation dataset consisting of roughly 30,000 cells sampled over a differentiation time course. We found that PHATE successfully resolves cellular heterogeneity and correctly maps all germ layer lineages and branches based on scRNA-seq data alone, without any additional assumptions on the data. Through detailed sub-population and gene expression analysis along these branches we identified both canonical and novel differentiation intermediates. The insights obtained with PHATE in this system will be a valuable resource for researchers working on early human development, human ES cells, and their regenerative medicine applications.</p><p hwp:id="p-69">We expect numerous biological, but also non-biological, data types to benefit from PHATE, including applications in high-throughput genomics, phenotyping, and many other fields. As such, we believe that PHATE will revolutionize biomedical data exploration by offering a new way of visualizing, exploring and extracting information from large scale high-dimensional data.</p></sec></body><back><ref-list hwp:id="ref-list-1"><title hwp:id="title-21">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1 xref-ref-1-2 xref-ref-1-3 xref-ref-1-4 xref-ref-1-5 xref-ref-1-6 xref-ref-1-7"><label>[1]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.1" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Maaten L. v. d."><given-names>L. v. d.</given-names> <surname>Maaten</surname></string-name> and <string-name name-style="western" hwp:sortable="Hinton G."><given-names>G.</given-names> <surname>Hinton</surname></string-name>, “<article-title hwp:id="article-title-2">Visualizing data using t-SNE</article-title>,” <source hwp:id="source-1">Journal of Machine Learning Research</source>, vol. <volume>9</volume>, no. <month>Nov</month>, pp. <fpage>2579</fpage>–<lpage>2605</lpage>, <year>2008</year>.</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1"><label>[2]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="Amir E.-a. D."><given-names>E.-a. D.</given-names> <surname>Amir</surname></string-name>, <string-name name-style="western" hwp:sortable="Davis K. L."><given-names>K. L.</given-names> <surname>Davis</surname></string-name>, <string-name name-style="western" hwp:sortable="Tadmor M. D."><given-names>M. D.</given-names> <surname>Tadmor</surname></string-name>, <string-name name-style="western" hwp:sortable="Simonds E. F."><given-names>E. F.</given-names> <surname>Simonds</surname></string-name>, <string-name name-style="western" hwp:sortable="Levine J. H."><given-names>J. H.</given-names> <surname>Levine</surname></string-name>, <string-name name-style="western" hwp:sortable="Bendall S. C."><given-names>S. C.</given-names> <surname>Bendall</surname></string-name>, <string-name name-style="western" hwp:sortable="Shenfeld D. K."><given-names>D. K.</given-names> <surname>Shenfeld</surname></string-name>, <string-name name-style="western" hwp:sortable="Krishnaswamy S."><given-names>S.</given-names> <surname>Krishnaswamy</surname></string-name>, <string-name name-style="western" hwp:sortable="Nolan G. P."><given-names>G. P.</given-names> <surname>Nolan</surname></string-name>, and <string-name name-style="western" hwp:sortable="Pe’er D."><given-names>D.</given-names> <surname>Pe’er</surname></string-name>, “<article-title hwp:id="article-title-3">visne enables visualization of high dimensional single-cell data and reveals phenotypic heterogeneity of leukemia</article-title>,” <source hwp:id="source-2">Nature biotechnology</source>, vol. <volume>31</volume>, no. <issue>6</issue>, pp. <fpage>545</fpage>–<lpage>552</lpage>, <year>2013</year>.</citation></ref><ref id="c3" hwp:id="ref-3" hwp:rev-id="xref-ref-3-1 xref-ref-3-2"><label>[3]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.3" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Linderman G. C."><given-names>G. C.</given-names> <surname>Linderman</surname></string-name>, <string-name name-style="western" hwp:sortable="Rachh M."><given-names>M.</given-names> <surname>Rachh</surname></string-name>, <string-name name-style="western" hwp:sortable="Hoskins J. G."><given-names>J. G.</given-names> <surname>Hoskins</surname></string-name>, <string-name name-style="western" hwp:sortable="Steinerberger S."><given-names>S.</given-names> <surname>Steinerberger</surname></string-name>, and <string-name name-style="western" hwp:sortable="Kluger Y."><given-names>Y.</given-names> <surname>Kluger</surname></string-name>, “<article-title hwp:id="article-title-4">Fast interpolation-based t-sne for improved visualization of single-cell rna-seq data</article-title>,” <source hwp:id="source-3">Nature Methods</source>, p. <fpage>1</fpage>, <year>2019</year>.</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1 xref-ref-4-2 xref-ref-4-3 xref-ref-4-4 xref-ref-4-5 xref-ref-4-6"><label>[4]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.4" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Tenenbaum J. B."><given-names>J. B.</given-names> <surname>Tenenbaum</surname></string-name>, <string-name name-style="western" hwp:sortable="De Silva V."><given-names>V.</given-names> <surname>De Silva</surname></string-name>, and <string-name name-style="western" hwp:sortable="Langford J. C."><given-names>J. C.</given-names> <surname>Langford</surname></string-name>, “<article-title hwp:id="article-title-5">A global geometric framework for nonlinear dimensionality reduction</article-title>,” <source hwp:id="source-4">science</source>, vol. <volume>290</volume>, no. <issue>5500</issue>, pp. <fpage>2319</fpage>–<lpage>2323</lpage>, <year>2000</year>.</citation></ref><ref id="c5" hwp:id="ref-5"><label>[5]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.5" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Becht E."><given-names>E.</given-names> <surname>Becht</surname></string-name>, <string-name name-style="western" hwp:sortable="McInnes L."><given-names>L.</given-names> <surname>McInnes</surname></string-name>, <string-name name-style="western" hwp:sortable="Healy J."><given-names>J.</given-names> <surname>Healy</surname></string-name>, <string-name name-style="western" hwp:sortable="Dutertre C.-A."><given-names>C.-A.</given-names> <surname>Dutertre</surname></string-name>, <string-name name-style="western" hwp:sortable="Kwok I. W."><given-names>I. W.</given-names> <surname>Kwok</surname></string-name>, <string-name name-style="western" hwp:sortable="Ng L. G."><given-names>L. G.</given-names> <surname>Ng</surname></string-name>, <string-name name-style="western" hwp:sortable="Ginhoux F."><given-names>F.</given-names> <surname>Ginhoux</surname></string-name>, and <string-name name-style="western" hwp:sortable="Newell E. W."><given-names>E. W.</given-names> <surname>Newell</surname></string-name>, “<article-title hwp:id="article-title-6">Dimensionality reduction for visualizing single-cell data using umap</article-title>,” <source hwp:id="source-5">Nature biotechnology</source>, vol. <volume>37</volume>, no. <issue>1</issue>, p. <fpage>38</fpage>, <year>2019</year>.</citation></ref><ref id="c6" hwp:id="ref-6" hwp:rev-id="xref-ref-6-1 xref-ref-6-2 xref-ref-6-3 xref-ref-6-4"><label>[6]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.6" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Roweis S. T."><given-names>S. T.</given-names> <surname>Roweis</surname></string-name> and <string-name name-style="western" hwp:sortable="Saul L. K."><given-names>L. K.</given-names> <surname>Saul</surname></string-name>, “<article-title hwp:id="article-title-7">Nonlinear dimensionality reduction by locally linear embedding</article-title>,” <source hwp:id="source-6">science</source>, vol. <volume>290</volume>, no. <issue>5500</issue>, pp. <fpage>2323</fpage>–<lpage>2326</lpage>, <year>2000</year>.</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1 xref-ref-7-2 xref-ref-7-3"><label>[7]</label><citation publication-type="book" citation-type="book" ref:id="120378v4.7" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Cox T. F."><given-names>T. F.</given-names> <surname>Cox</surname></string-name> and <string-name name-style="western" hwp:sortable="Cox M. A. A."><given-names>M. A. A.</given-names> <surname>Cox</surname></string-name>, <source hwp:id="source-7">Multidimensional Scaling</source>. <publisher-name>Chapman &amp; Hall/CRC</publisher-name>, <edition>2 ed.</edition>, <year>2001</year>.</citation></ref><ref id="c8" hwp:id="ref-8" hwp:rev-id="xref-ref-8-1 xref-ref-8-2"><label>[8]</label><citation publication-type="book" citation-type="book" ref:id="120378v4.8" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="De Silva V."><given-names>V.</given-names> <surname>De Silva</surname></string-name> and <string-name name-style="western" hwp:sortable="Tenenbaum J. B."><given-names>J. B.</given-names> <surname>Tenenbaum</surname></string-name>, “<chapter-title>Sparse multidimensional scaling using landmark points</chapter-title>,” <source hwp:id="source-8">tech. rep., Technical report</source>, <publisher-name>Stanford University</publisher-name>, <year>2004</year>.</citation></ref><ref id="c9" hwp:id="ref-9"><label>[9]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.9" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Unen V."><given-names>V.</given-names> <surname>Unen</surname></string-name>, <string-name name-style="western" hwp:sortable="Höllt T."><given-names>T.</given-names> <surname>Höllt</surname></string-name>, <string-name name-style="western" hwp:sortable="Pezzotti N."><given-names>N.</given-names> <surname>Pezzotti</surname></string-name>, <string-name name-style="western" hwp:sortable="Li N."><given-names>N.</given-names> <surname>Li</surname></string-name>, <string-name name-style="western" hwp:sortable="Reinders M. J."><given-names>M. J.</given-names> <surname>Reinders</surname></string-name>, <string-name name-style="western" hwp:sortable="Eisemann E."><given-names>E.</given-names> <surname>Eisemann</surname></string-name>, <string-name name-style="western" hwp:sortable="Koning F."><given-names>F.</given-names> <surname>Koning</surname></string-name>, <string-name name-style="western" hwp:sortable="Vilanova A."><given-names>A.</given-names> <surname>Vilanova</surname></string-name>, and <string-name name-style="western" hwp:sortable="Lelieveldt B. P."><given-names>B. P.</given-names> <surname>Lelieveldt</surname></string-name>, “<article-title hwp:id="article-title-8">Visual analysis of mass cytometry data by hierarchical stochastic neighbour embedding reveals rare cell types</article-title>,” <source hwp:id="source-9">Nature communications</source>, vol. <volume>8</volume>, no. <issue>1</issue>, p. <fpage>1740</fpage>, <year>2017</year>.</citation></ref><ref id="c10" hwp:id="ref-10"><label>[10]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="Chen L."><given-names>L.</given-names> <surname>Chen</surname></string-name> and <string-name name-style="western" hwp:sortable="Buja A."><given-names>A.</given-names> <surname>Buja</surname></string-name>, “<article-title hwp:id="article-title-9">Local multidimensional scaling for nonlinear dimension reduction, graph drawing, and proximity analysis</article-title>,” <source hwp:id="source-10">Journal of the American Statistical Association</source>, vol. <volume>104</volume>, no. <issue>485</issue>, pp. <fpage>209</fpage>–<lpage>219</lpage>, <year>2009</year>.</citation></ref><ref id="c11" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1 xref-ref-11-2 xref-ref-11-3 xref-ref-11-4"><label>[11]</label><citation publication-type="book" citation-type="book" ref:id="120378v4.11" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="Moon T. K. S."><given-names>T. K. S.</given-names> <surname>Moon</surname></string-name> and <string-name name-style="western" hwp:sortable="Wynn C."><given-names>C.</given-names> <surname>Wynn</surname></string-name>, <source hwp:id="source-11">Mathematical methods and algorithms for signal processing</source>. <publisher-name>Prentice Hall</publisher-name>, <year>2000</year>.</citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1 xref-ref-12-2 xref-ref-12-3"><label>[12]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.12" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Qiu X."><given-names>X.</given-names> <surname>Qiu</surname></string-name>, <string-name name-style="western" hwp:sortable="Mao Q."><given-names>Q.</given-names> <surname>Mao</surname></string-name>, <string-name name-style="western" hwp:sortable="Tang Y."><given-names>Y.</given-names> <surname>Tang</surname></string-name>, <string-name name-style="western" hwp:sortable="Wang L."><given-names>L.</given-names> <surname>Wang</surname></string-name>, <string-name name-style="western" hwp:sortable="Chawla R."><given-names>R.</given-names> <surname>Chawla</surname></string-name>, <string-name name-style="western" hwp:sortable="Pliner H. A."><given-names>H. A.</given-names> <surname>Pliner</surname></string-name>, and <string-name name-style="western" hwp:sortable="Trapnell C."><given-names>C.</given-names> <surname>Trapnell</surname></string-name>, “<article-title hwp:id="article-title-10">Reversed graph embedding resolves complex single-cell trajectories</article-title>.,” <source hwp:id="source-12">Nature Methods</source>, <year>2017</year>.</citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1 xref-ref-13-2 xref-ref-13-3 xref-ref-13-4 xref-ref-13-5 xref-ref-13-6"><label>[13]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.13" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="Coifman R. R."><given-names>R. R.</given-names> <surname>Coifman</surname></string-name> and <string-name name-style="western" hwp:sortable="Lafon S."><given-names>S.</given-names> <surname>Lafon</surname></string-name>, “<article-title hwp:id="article-title-11">Diffusion maps</article-title>,” <source hwp:id="source-13">Applied and Computational Harmonic Analysis</source>, vol. <volume>21</volume>, no. <issue>1</issue>, pp. <fpage>5</fpage>–<lpage>30</lpage>, <year>2006</year>.</citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1 xref-ref-14-2 xref-ref-14-3 xref-ref-14-4 xref-ref-14-5"><label>[14]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.14" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Haghverdi L."><given-names>L.</given-names> <surname>Haghverdi</surname></string-name>, <string-name name-style="western" hwp:sortable="Buettner M."><given-names>M.</given-names> <surname>Buettner</surname></string-name>, <string-name name-style="western" hwp:sortable="Wolf F. A."><given-names>F. A.</given-names> <surname>Wolf</surname></string-name>, <string-name name-style="western" hwp:sortable="Buettner F."><given-names>F.</given-names> <surname>Buettner</surname></string-name>, and <string-name name-style="western" hwp:sortable="Theis F. J."><given-names>F. J.</given-names> <surname>Theis</surname></string-name>, “<article-title hwp:id="article-title-12">Diffusion pseudotime robustly reconstructs lineage branching</article-title>,” <source hwp:id="source-14">Nature Methods</source>, vol. <volume>13</volume>, no. <issue>10</issue>, pp. <fpage>845</fpage>–<lpage>848</lpage>, <year>2016</year>.</citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1 xref-ref-15-2 xref-ref-15-3 xref-ref-15-4 xref-ref-15-5 xref-ref-15-6"><label>[15]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.15" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Darrow E. M."><given-names>E. M.</given-names> <surname>Darrow</surname></string-name>, <string-name name-style="western" hwp:sortable="Huntley M. H."><given-names>M. H.</given-names> <surname>Huntley</surname></string-name>, <string-name name-style="western" hwp:sortable="Dudchenko O."><given-names>O.</given-names> <surname>Dudchenko</surname></string-name>, <string-name name-style="western" hwp:sortable="Stamenova E. K."><given-names>E. K.</given-names> <surname>Stamenova</surname></string-name>, <string-name name-style="western" hwp:sortable="Durand N. C."><given-names>N. C.</given-names> <surname>Durand</surname></string-name>, <string-name name-style="western" hwp:sortable="Sun Z."><given-names>Z.</given-names> <surname>Sun</surname></string-name>, <string-name name-style="western" hwp:sortable="Huang S.-C."><given-names>S.-C.</given-names> <surname>Huang</surname></string-name>, <string-name name-style="western" hwp:sortable="Sanborn A. L."><given-names>A. L.</given-names> <surname>Sanborn</surname></string-name>, <string-name name-style="western" hwp:sortable="Machol I."><given-names>I.</given-names> <surname>Machol</surname></string-name>, <string-name name-style="western" hwp:sortable="Shamim M."><given-names>M.</given-names> <surname>Shamim</surname></string-name>, <string-name name-style="western" hwp:sortable="Seberg A. P."><given-names>A. P.</given-names> <surname>Seberg</surname></string-name>, <string-name name-style="western" hwp:sortable="Lander E. S."><given-names>E. S.</given-names> <surname>Lander</surname></string-name>, <string-name name-style="western" hwp:sortable="Chadwick B. P."><given-names>B. P.</given-names> <surname>Chadwick</surname></string-name>, and <string-name name-style="western" hwp:sortable="Lieberman Aiden E."><given-names>E.</given-names> <surname>Lieberman Aiden</surname></string-name>, “<article-title hwp:id="article-title-13">Deletion of dxz4 on the human inactive x chromosome alters higher-order genome architecture</article-title>,” <source hwp:id="source-15">Proceedings of the National Academy of Sciences</source>, p. <fpage>201609643</fpage>, <year>2016</year>.</citation></ref><ref id="c16" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1 xref-ref-16-2 xref-ref-16-3 xref-ref-16-4 xref-ref-16-5 xref-ref-16-6 xref-ref-16-7 xref-ref-16-8 xref-ref-16-9 xref-ref-16-10 xref-ref-16-11 xref-ref-16-12 xref-ref-16-13 xref-ref-16-14 xref-ref-16-15 xref-ref-16-16 xref-ref-16-17"><label>[16]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.16" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Zunder E. R."><given-names>E. R.</given-names> <surname>Zunder</surname></string-name>, <string-name name-style="western" hwp:sortable="Lujan E."><given-names>E.</given-names> <surname>Lujan</surname></string-name>, <string-name name-style="western" hwp:sortable="Goltsev Y."><given-names>Y.</given-names> <surname>Goltsev</surname></string-name>, <string-name name-style="western" hwp:sortable="Wernig M."><given-names>M.</given-names> <surname>Wernig</surname></string-name>, and <string-name name-style="western" hwp:sortable="Nolan G. P."><given-names>G. P.</given-names> <surname>Nolan</surname></string-name>, “<article-title hwp:id="article-title-14">A continuous molecular roadmap to iPSC reprogramming through progression analysis of single-cell mass cytometry</article-title>,” <source hwp:id="source-16">Cell Stem Cell</source>, vol. <volume>16</volume>, no. <issue>3</issue>, pp. <fpage>323</fpage>–<lpage>337</lpage>, <year>2015</year>.</citation></ref><ref id="c17" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1 xref-ref-17-2 xref-ref-17-3 xref-ref-17-4"><label>[17]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.17" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="Carter K. M."><given-names>K. M.</given-names> <surname>Carter</surname></string-name>, <string-name name-style="western" hwp:sortable="Raich R."><given-names>R.</given-names> <surname>Raich</surname></string-name>, and <string-name name-style="western" hwp:sortable="Hero A. O."><given-names>A. O.</given-names> <surname>Hero</surname> <prefix>III</prefix></string-name>, “<article-title hwp:id="article-title-15">On local intrinsic dimension estimation and its applications</article-title>,” <source hwp:id="source-17">IEEE Transactions on Signal Processing</source>, vol. <volume>58</volume>, no. <issue>2</issue>, pp. <fpage>650</fpage>–<lpage>663</lpage>, <year>2010</year>.</citation></ref><ref id="c18" hwp:id="ref-18" hwp:rev-id="xref-ref-18-1"><label>[18]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.18" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-18"><string-name name-style="western" hwp:sortable="Levina E."><given-names>E.</given-names> <surname>Levina</surname></string-name> and <string-name name-style="western" hwp:sortable="Bickel P. J."><given-names>P. J.</given-names> <surname>Bickel</surname></string-name>, “<article-title hwp:id="article-title-16">Maximum likelihood estimation of intrinsic dimension</article-title>,” in <source hwp:id="source-18">Advances in neural information processing systems</source>, pp. <fpage>777</fpage>–<lpage>784</lpage>, <year>2005</year>.</citation></ref><ref id="c19" hwp:id="ref-19" hwp:rev-id="xref-ref-19-1 xref-ref-19-2"><label>[19]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.19" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-19"><string-name name-style="western" hwp:sortable="Cheng X."><given-names>X.</given-names> <surname>Cheng</surname></string-name>, <string-name name-style="western" hwp:sortable="Rachh M."><given-names>M.</given-names> <surname>Rachh</surname></string-name>, and <string-name name-style="western" hwp:sortable="Steinerberger S."><given-names>S.</given-names> <surname>Steinerberger</surname></string-name>, “<article-title hwp:id="article-title-17">On the diffusion geometry of graph laplacians and applications</article-title>,” <source hwp:id="source-19">Applied and Computational Harmonic Analysis</source>, <year>2018</year>.</citation></ref><ref id="c20" hwp:id="ref-20" hwp:rev-id="xref-ref-20-1 xref-ref-20-2"><label>[20]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.20" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-20"><string-name name-style="western" hwp:sortable="David G."><given-names>G.</given-names> <surname>David</surname></string-name> and <string-name name-style="western" hwp:sortable="Averbuch A."><given-names>A.</given-names> <surname>Averbuch</surname></string-name>, “<article-title hwp:id="article-title-18">Hierarchical data organization, clustering and denoising via localized diffusion folders</article-title>,” <source hwp:id="source-20">Applied and Computational Harmonic Analysis</source>, vol. <volume>33</volume>, no. <issue>1</issue>, pp. <fpage>1</fpage>–<lpage>23</lpage>, <year>2012</year>.</citation></ref><ref id="c21" hwp:id="ref-21" hwp:rev-id="xref-ref-21-1 xref-ref-21-2 xref-ref-21-3 xref-ref-21-4 xref-ref-21-5 xref-ref-21-6 xref-ref-21-7 xref-ref-21-8"><label>[21]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.21" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-21"><string-name name-style="western" hwp:sortable="Paul F."><given-names>F.</given-names> <surname>Paul</surname></string-name>, <string-name name-style="western" hwp:sortable="Arkin Y."><given-names>Y.</given-names> <surname>Arkin</surname></string-name>, <string-name name-style="western" hwp:sortable="Giladi A."><given-names>A.</given-names> <surname>Giladi</surname></string-name>, <string-name name-style="western" hwp:sortable="Jaitin D. A."><given-names>D. A.</given-names> <surname>Jaitin</surname></string-name>, <string-name name-style="western" hwp:sortable="Kenigsberg E."><given-names>E.</given-names> <surname>Kenigsberg</surname></string-name>, <string-name name-style="western" hwp:sortable="Keren-Shaul H."><given-names>H.</given-names> <surname>Keren-Shaul</surname></string-name>, <string-name name-style="western" hwp:sortable="Winter D."><given-names>D.</given-names> <surname>Winter</surname></string-name>, <string-name name-style="western" hwp:sortable="Lara-Astiaso D."><given-names>D.</given-names> <surname>Lara-Astiaso</surname></string-name>, <string-name name-style="western" hwp:sortable="Gury M."><given-names>M.</given-names> <surname>Gury</surname></string-name>, <string-name name-style="western" hwp:sortable="Weiner A."><given-names>A.</given-names> <surname>Weiner</surname></string-name>, <etal>et al.,</etal> “<article-title hwp:id="article-title-19">Transcriptional heterogeneity and lineage commitment in myeloid progenitors</article-title>,” <source hwp:id="source-21">Cell</source>, vol. <volume>163</volume>, no. <issue>7</issue>, pp. <fpage>1663</fpage>–<lpage>1677</lpage>, <year>2015</year>.</citation></ref><ref id="c22" hwp:id="ref-22" hwp:rev-id="xref-ref-22-1 xref-ref-22-2 xref-ref-22-3 xref-ref-22-4 xref-ref-22-5 xref-ref-22-6 xref-ref-22-7"><label>[22]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.22" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-22"><string-name name-style="western" hwp:sortable="Zappia L."><given-names>L.</given-names> <surname>Zappia</surname></string-name>, <string-name name-style="western" hwp:sortable="Phipson B."><given-names>B.</given-names> <surname>Phipson</surname></string-name>, and <string-name name-style="western" hwp:sortable="Oshlack A."><given-names>A.</given-names> <surname>Oshlack</surname></string-name>, “<article-title hwp:id="article-title-20">Splatter: simulation of single-cell rna sequencing data</article-title>,” <source hwp:id="source-22">Genome biology</source>, vol. <volume>18</volume>, no. <issue>1</issue>, p. <fpage>174</fpage>, <year>2017</year>.</citation></ref><ref id="c23" hwp:id="ref-23" hwp:rev-id="xref-ref-23-1 xref-ref-23-2 xref-ref-23-3 xref-ref-23-4 xref-ref-23-5 xref-ref-23-6"><label>[23]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.23" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-23"><string-name name-style="western" hwp:sortable="Shekhar K."><given-names>K.</given-names> <surname>Shekhar</surname></string-name>, <string-name name-style="western" hwp:sortable="Lapan S. W."><given-names>S. W.</given-names> <surname>Lapan</surname></string-name>, <string-name name-style="western" hwp:sortable="Whitney I. E."><given-names>I. E.</given-names> <surname>Whitney</surname></string-name>, <string-name name-style="western" hwp:sortable="Tran N. M."><given-names>N. M.</given-names> <surname>Tran</surname></string-name>, <string-name name-style="western" hwp:sortable="Macosko E. Z."><given-names>E. Z.</given-names> <surname>Macosko</surname></string-name>, <string-name name-style="western" hwp:sortable="Kowalczyk M."><given-names>M.</given-names> <surname>Kowalczyk</surname></string-name>, <string-name name-style="western" hwp:sortable="Adiconis X."><given-names>X.</given-names> <surname>Adiconis</surname></string-name>, <string-name name-style="western" hwp:sortable="Levin J. Z."><given-names>J. Z.</given-names> <surname>Levin</surname></string-name>, <string-name name-style="western" hwp:sortable="Nemesh J."><given-names>J.</given-names> <surname>Nemesh</surname></string-name>, <string-name name-style="western" hwp:sortable="Goldman M."><given-names>M.</given-names> <surname>Goldman</surname></string-name>, <etal>et al.,</etal> “<article-title hwp:id="article-title-21">Comprehensive classification of retinal bipolar neurons by single-cell transcriptomics</article-title>,” <source hwp:id="source-23">Cell</source>, vol. <volume>166</volume>, no. <issue>5</issue>, pp. <fpage>1308</fpage>–<lpage>1323</lpage>, <year>2016</year>.</citation></ref><ref id="c24" hwp:id="ref-24" hwp:rev-id="xref-ref-24-1 xref-ref-24-2 xref-ref-24-3 xref-ref-24-4"><label>[24]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.24" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-24"><string-name name-style="western" hwp:sortable="Zeisel A."><given-names>A.</given-names> <surname>Zeisel</surname></string-name>, <string-name name-style="western" hwp:sortable="Muñoz-Manchado A. B."><given-names>A. B.</given-names> <surname>Muñoz-Manchado</surname></string-name>, <string-name name-style="western" hwp:sortable="Codeluppi S."><given-names>S.</given-names> <surname>Codeluppi</surname></string-name>, <string-name name-style="western" hwp:sortable="Lönnerberg P."><given-names>P.</given-names> <surname>Lönnerberg</surname></string-name>, <string-name name-style="western" hwp:sortable="La Manno G."><given-names>G.</given-names> <surname>La Manno</surname></string-name>, <string-name name-style="western" hwp:sortable="Juréus A."><given-names>A.</given-names> <surname>Juréus</surname></string-name>, <string-name name-style="western" hwp:sortable="Marques S."><given-names>S.</given-names> <surname>Marques</surname></string-name>, <string-name name-style="western" hwp:sortable="Munguba H."><given-names>H.</given-names> <surname>Munguba</surname></string-name>, <string-name name-style="western" hwp:sortable="He L."><given-names>L.</given-names> <surname>He</surname></string-name>, <string-name name-style="western" hwp:sortable="Betsholtz C."><given-names>C.</given-names> <surname>Betsholtz</surname></string-name>, <etal>et al.,</etal> “<article-title hwp:id="article-title-22">Cell types in the mouse cortex and hippocampus revealed by single-cell rna-seq</article-title>,” <source hwp:id="source-24">Science</source>, vol. <volume>347</volume>, no. <issue>6226</issue>, pp. <fpage>1138</fpage>–<lpage>1142</lpage>, <year>2015</year>.</citation></ref><ref id="c25" hwp:id="ref-25" hwp:rev-id="xref-ref-25-1 xref-ref-25-2 xref-ref-25-3 xref-ref-25-4"><label>[25]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.25" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-25"><string-name name-style="western" hwp:sortable="Van Der Maaten L."><given-names>L.</given-names> <surname>Van Der Maaten</surname></string-name>, <string-name name-style="western" hwp:sortable="Postma E."><given-names>E.</given-names> <surname>Postma</surname></string-name>, and <string-name name-style="western" hwp:sortable="Van den Herik J."><given-names>J.</given-names> <surname>Van den Herik</surname></string-name>, “<article-title hwp:id="article-title-23">Dimensionality reduction: A comparative review</article-title>,” <source hwp:id="source-25">Journal of Machine Learning Research</source>, vol. <volume>10</volume>, pp. <fpage>66</fpage>–<lpage>71</lpage>, <year>2009</year>.</citation></ref><ref id="c26" hwp:id="ref-26" hwp:rev-id="xref-ref-26-1 xref-ref-26-2 xref-ref-26-3 xref-ref-26-4"><label>[26]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.26" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-26"><string-name name-style="western" hwp:sortable="Bendall S. C."><given-names>S. C.</given-names> <surname>Bendall</surname></string-name>, <string-name name-style="western" hwp:sortable="Davis K. L."><given-names>K. L.</given-names> <surname>Davis</surname></string-name>, <string-name name-style="western" hwp:sortable="Amir E.-a. D."><given-names>E.-a. D.</given-names> <surname>Amir</surname></string-name>, <string-name name-style="western" hwp:sortable="Tadmor M. D."><given-names>M. D.</given-names> <surname>Tadmor</surname></string-name>, <string-name name-style="western" hwp:sortable="Simonds E. F."><given-names>E. F.</given-names> <surname>Simonds</surname></string-name>, <string-name name-style="western" hwp:sortable="Chen T. J."><given-names>T. J.</given-names> <surname>Chen</surname></string-name>, <string-name name-style="western" hwp:sortable="Shenfeld D. K."><given-names>D. K.</given-names> <surname>Shenfeld</surname></string-name>, <string-name name-style="western" hwp:sortable="Nolan G. P."><given-names>G. P.</given-names> <surname>Nolan</surname></string-name>, and <string-name name-style="western" hwp:sortable="Pe’er D."><given-names>D.</given-names> <surname>Pe’er</surname></string-name>, “<article-title hwp:id="article-title-24">Single-cell trajectory detection uncovers progression and regulatory coordination in human b cell development</article-title>,” <source hwp:id="source-26">Cell</source>, vol. <volume>157</volume>, no. <issue>3</issue>, pp. <fpage>714</fpage>–<lpage>725</lpage>, <year>2014</year>.</citation></ref><ref id="c27" hwp:id="ref-27" hwp:rev-id="xref-ref-27-1 xref-ref-27-2 xref-ref-27-3"><label>[27]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.27" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-27"><string-name name-style="western" hwp:sortable="Setty M."><given-names>M.</given-names> <surname>Setty</surname></string-name>, <string-name name-style="western" hwp:sortable="Tadmor M. D."><given-names>M. D.</given-names> <surname>Tadmor</surname></string-name>, <string-name name-style="western" hwp:sortable="Reich-Zeliger S."><given-names>S.</given-names> <surname>Reich-Zeliger</surname></string-name>, <string-name name-style="western" hwp:sortable="Angel O."><given-names>O.</given-names> <surname>Angel</surname></string-name>, <string-name name-style="western" hwp:sortable="Salame T. M."><given-names>T. M.</given-names> <surname>Salame</surname></string-name>, <string-name name-style="western" hwp:sortable="Kathail P."><given-names>P.</given-names> <surname>Kathail</surname></string-name>, <string-name name-style="western" hwp:sortable="Choi K."><given-names>K.</given-names> <surname>Choi</surname></string-name>, <string-name name-style="western" hwp:sortable="Bendall S."><given-names>S.</given-names> <surname>Bendall</surname></string-name>, <string-name name-style="western" hwp:sortable="Friedman N."><given-names>N.</given-names> <surname>Friedman</surname></string-name>, and <string-name name-style="western" hwp:sortable="Pe’er D."><given-names>D.</given-names> <surname>Pe’er</surname></string-name>, “<article-title hwp:id="article-title-25">Wishbone identifies bifurcating developmental trajectories from single-cell data</article-title>,” <source hwp:id="source-27">Nature biotechnology</source>, vol. <volume>34</volume>, no. <issue>6</issue>, pp. <fpage>637</fpage>–<lpage>645</lpage>, <year>2016</year>.</citation></ref><ref id="c28" hwp:id="ref-28"><label>[28]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.28" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-28"><string-name name-style="western" hwp:sortable="Liiv I."><given-names>I.</given-names> <surname>Liiv</surname></string-name>, “<article-title hwp:id="article-title-26">Seriation and matrix reordering methods: An historical overview</article-title>,” <source hwp:id="source-28">Statistical Analysis and Data Mining: The ASA Data Science Journal</source>, vol. <volume>3</volume>, no. <issue>2</issue>, pp. <fpage>70</fpage>–<lpage>91</lpage>, <year>2010</year>.</citation></ref><ref id="c29" hwp:id="ref-29"><label>[29]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.29" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-29"><string-name name-style="western" hwp:sortable="Hahsler M."><given-names>M.</given-names> <surname>Hahsler</surname></string-name>, <string-name name-style="western" hwp:sortable="Hornik K."><given-names>K.</given-names> <surname>Hornik</surname></string-name>, and <string-name name-style="western" hwp:sortable="Buchta C."><given-names>C.</given-names> <surname>Buchta</surname></string-name>, “<article-title hwp:id="article-title-27">Getting things in order: an introduction to the r package seriation</article-title>,” <source hwp:id="source-29">Journal of Statistical Software</source>, vol. <volume>25</volume>, no. <issue>3</issue>, pp. <fpage>1</fpage>–<lpage>34</lpage>, <year>2008</year>.</citation></ref><ref id="c30" hwp:id="ref-30" hwp:rev-id="xref-ref-30-1"><label>[30]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.30" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-30"><string-name name-style="western" hwp:sortable="Wolf F. A."><given-names>F. A.</given-names> <surname>Wolf</surname></string-name>, <string-name name-style="western" hwp:sortable="Hamey F."><given-names>F.</given-names> <surname>Hamey</surname></string-name>, <string-name name-style="western" hwp:sortable="Plass M."><given-names>M.</given-names> <surname>Plass</surname></string-name>, <string-name name-style="western" hwp:sortable="Solana J."><given-names>J.</given-names> <surname>Solana</surname></string-name>, <string-name name-style="western" hwp:sortable="Dahlin J. S."><given-names>J. S.</given-names> <surname>Dahlin</surname></string-name>, <string-name name-style="western" hwp:sortable="Gottgens B."><given-names>B.</given-names> <surname>Gottgens</surname></string-name>, <string-name name-style="western" hwp:sortable="Rajewsky N."><given-names>N.</given-names> <surname>Rajewsky</surname></string-name>, <string-name name-style="western" hwp:sortable="Simon L."><given-names>L.</given-names> <surname>Simon</surname></string-name>, and <string-name name-style="western" hwp:sortable="Theis F. J."><given-names>F. J.</given-names> <surname>Theis</surname></string-name>, “<article-title hwp:id="article-title-28">Graph abstraction reconciles clustering with trajectory inference through a topology preserving map of single cells</article-title>,” <source hwp:id="source-30">bioRxiv</source>, p. <fpage>208819</fpage>, <year>2018</year>.</citation></ref><ref id="c31" hwp:id="ref-31" hwp:rev-id="xref-ref-31-1 xref-ref-31-2 xref-ref-31-3"><label>[31]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.31" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-31"><string-name name-style="western" hwp:sortable="Krishnaswamy S."><given-names>S.</given-names> <surname>Krishnaswamy</surname></string-name>, <string-name name-style="western" hwp:sortable="Spitzer M. H."><given-names>M. H.</given-names> <surname>Spitzer</surname></string-name>, <string-name name-style="western" hwp:sortable="Mingueneau M."><given-names>M.</given-names> <surname>Mingueneau</surname></string-name>, <string-name name-style="western" hwp:sortable="Bendall S. C."><given-names>S. C.</given-names> <surname>Bendall</surname></string-name>, <string-name name-style="western" hwp:sortable="Litvin O."><given-names>O.</given-names> <surname>Litvin</surname></string-name>, <string-name name-style="western" hwp:sortable="Stone E."><given-names>E.</given-names> <surname>Stone</surname></string-name>, <string-name name-style="western" hwp:sortable="Pe’er D."><given-names>D.</given-names> <surname>Pe’er</surname></string-name>, and <string-name name-style="western" hwp:sortable="Nolan G. P."><given-names>G. P.</given-names> <surname>Nolan</surname></string-name>, “<article-title hwp:id="article-title-29">Conditional density-based analysis of T cell signaling in single-cell data</article-title>,” <source hwp:id="source-31">Science</source>, vol. <volume>346</volume>, no. <issue>6213</issue>, p. <fpage>1250689</fpage>, <year>2014</year>.</citation></ref><ref id="c32" hwp:id="ref-32" hwp:rev-id="xref-ref-32-1 xref-ref-32-2"><label>[32]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.32" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-32"><string-name name-style="western" hwp:sortable="Polo J. M."><given-names>J. M.</given-names> <surname>Polo</surname></string-name>, <string-name name-style="western" hwp:sortable="Anderssen E."><given-names>E.</given-names> <surname>Anderssen</surname></string-name>, <string-name name-style="western" hwp:sortable="Walsh R. M."><given-names>R. M.</given-names> <surname>Walsh</surname></string-name>, <string-name name-style="western" hwp:sortable="Schwarz B. A."><given-names>B. A.</given-names> <surname>Schwarz</surname></string-name>, <string-name name-style="western" hwp:sortable="Nefzger C. M."><given-names>C. M.</given-names> <surname>Nefzger</surname></string-name>, <string-name name-style="western" hwp:sortable="Lim S. M."><given-names>S. M.</given-names> <surname>Lim</surname></string-name>, <string-name name-style="western" hwp:sortable="Borkent M."><given-names>M.</given-names> <surname>Borkent</surname></string-name>, <string-name name-style="western" hwp:sortable="Apostolou E."><given-names>E.</given-names> <surname>Apostolou</surname></string-name>, <string-name name-style="western" hwp:sortable="Alaei S."><given-names>S.</given-names> <surname>Alaei</surname></string-name>, <string-name name-style="western" hwp:sortable="Cloutier J."><given-names>J.</given-names> <surname>Cloutier</surname></string-name>, <etal>et al.,</etal> “<article-title hwp:id="article-title-30">A molecular roadmap of reprogramming somatic cells into ips cells</article-title>,” <source hwp:id="source-32">Cell</source>, vol. <volume>151</volume>, no. <issue>7</issue>, pp. <fpage>1617</fpage>–<lpage>1632</lpage>, <year>2012</year>.</citation></ref><ref id="c33" hwp:id="ref-33" hwp:rev-id="xref-ref-33-1"><label>[33]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.33" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-33"><string-name name-style="western" hwp:sortable="Huang H.-P."><given-names>H.-P.</given-names> <surname>Huang</surname></string-name>, <string-name name-style="western" hwp:sortable="Chen P.-H."><given-names>P.-H.</given-names> <surname>Chen</surname></string-name>, <string-name name-style="western" hwp:sortable="Yu C.-Y."><given-names>C.-Y.</given-names> <surname>Yu</surname></string-name>, <string-name name-style="western" hwp:sortable="Chuang C.-Y."><given-names>C.-Y.</given-names> <surname>Chuang</surname></string-name>, <string-name name-style="western" hwp:sortable="Stone L."><given-names>L.</given-names> <surname>Stone</surname></string-name>, <string-name name-style="western" hwp:sortable="Hsiao W.-C."><given-names>W.-C.</given-names> <surname>Hsiao</surname></string-name>, <string-name name-style="western" hwp:sortable="Li C.-L."><given-names>C.-L.</given-names> <surname>Li</surname></string-name>, <string-name name-style="western" hwp:sortable="Tsai S.-C."><given-names>S.-C.</given-names> <surname>Tsai</surname></string-name>, <string-name name-style="western" hwp:sortable="Chen K.-Y."><given-names>K.-Y.</given-names> <surname>Chen</surname></string-name>, <string-name name-style="western" hwp:sortable="Chen H.-F."><given-names>H.-F.</given-names> <surname>Chen</surname></string-name>, <etal>et al.,</etal> “<article-title hwp:id="article-title-31">Epithelial cell adhesion molecule (epcam) complex proteins promote transcription factor-mediated pluripotency reprogramming</article-title>,” <source hwp:id="source-33">Journal of Biological Chemistry</source>, vol. <volume>286</volume>, no. <issue>38</issue>, pp. <fpage>33520</fpage>–<lpage>33532</lpage>, <year>2011</year>.</citation></ref><ref id="c34" hwp:id="ref-34" hwp:rev-id="xref-ref-34-1"><label>[34]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.34" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-34"><string-name name-style="western" hwp:sortable="Takahashi K."><given-names>K.</given-names> <surname>Takahashi</surname></string-name> and <string-name name-style="western" hwp:sortable="Yamanaka S."><given-names>S.</given-names> <surname>Yamanaka</surname></string-name>, “<article-title hwp:id="article-title-32">Induction of pluripotent stem cells from mouse embryonic and adult fibroblast cultures by defined factors</article-title>,” <source hwp:id="source-34">cell</source>, vol. <volume>126</volume>, no. <issue>4</issue>, pp. <fpage>663</fpage>–<lpage>676</lpage>, <year>2006</year>.</citation></ref><ref id="c35" hwp:id="ref-35" hwp:rev-id="xref-ref-35-1"><label>[35]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.35" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-35"><string-name name-style="western" hwp:sortable="Hong H."><given-names>H.</given-names> <surname>Hong</surname></string-name>, <string-name name-style="western" hwp:sortable="Takahashi K."><given-names>K.</given-names> <surname>Takahashi</surname></string-name>, <string-name name-style="western" hwp:sortable="Ichisaka T."><given-names>T.</given-names> <surname>Ichisaka</surname></string-name>, <string-name name-style="western" hwp:sortable="Aoi T."><given-names>T.</given-names> <surname>Aoi</surname></string-name>, <string-name name-style="western" hwp:sortable="Kanagawa O."><given-names>O.</given-names> <surname>Kanagawa</surname></string-name>, <string-name name-style="western" hwp:sortable="Nakagawa M."><given-names>M.</given-names> <surname>Nakagawa</surname></string-name>, <string-name name-style="western" hwp:sortable="Okita K."><given-names>K.</given-names> <surname>Okita</surname></string-name>, and <string-name name-style="western" hwp:sortable="Yamanaka S."><given-names>S.</given-names> <surname>Yamanaka</surname></string-name>, “<article-title hwp:id="article-title-33">Suppression of induced pluripotent stem cell generation by the p53–p21 pathway</article-title>,” <source hwp:id="source-35">Nature</source>, vol. <volume>460</volume>, no. <issue>7259</issue>, pp. <fpage>1132</fpage>–<lpage>1135</lpage>, <year>2009</year>.</citation></ref><ref id="c36" hwp:id="ref-36" hwp:rev-id="xref-ref-36-1"><label>[36]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.36" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-36"><string-name name-style="western" hwp:sortable="Tsukamoto Y."><given-names>Y.</given-names> <surname>Tsukamoto</surname></string-name> and <string-name name-style="western" hwp:sortable="Omi N."><given-names>N.</given-names> <surname>Omi</surname></string-name>, “<article-title hwp:id="article-title-34">Classification of mouse retinal bipolar cells: type-specific connectivity with special reference to rod-driven aii amacrine pathways</article-title>,” <source hwp:id="source-36">Frontiers in neuroanatomy</source>, vol. <volume>11</volume>, p. <fpage>92</fpage>, <year>2017</year>.</citation></ref><ref id="c37" hwp:id="ref-37" hwp:rev-id="xref-ref-37-1"><label>[37]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.37" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-37"><string-name name-style="western" hwp:sortable="Kim D. S."><given-names>D. S.</given-names> <surname>Kim</surname></string-name>, <string-name name-style="western" hwp:sortable="Ross S. E."><given-names>S. E.</given-names> <surname>Ross</surname></string-name>, <string-name name-style="western" hwp:sortable="Trimarchi J. M."><given-names>J. M.</given-names> <surname>Trimarchi</surname></string-name>, <string-name name-style="western" hwp:sortable="Aach J."><given-names>J.</given-names> <surname>Aach</surname></string-name>, <string-name name-style="western" hwp:sortable="Greenberg M. E."><given-names>M. E.</given-names> <surname>Greenberg</surname></string-name>, and <string-name name-style="western" hwp:sortable="Cepko C. L."><given-names>C. L.</given-names> <surname>Cepko</surname></string-name>, “<article-title hwp:id="article-title-35">Identification of molecular markers of bipolar cells in the murine retina</article-title>,” <source hwp:id="source-37">Journal of Comparative Neurology</source>, vol. <volume>507</volume>, no. <issue>5</issue>, pp. <fpage>1795</fpage>–<lpage>1810</lpage>, <year>2008</year>.</citation></ref><ref id="c38" hwp:id="ref-38" hwp:rev-id="xref-ref-38-1"><label>[38]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.38" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-38"><string-name name-style="western" hwp:sortable="Martin G. R."><given-names>G. R.</given-names> <surname>Martin</surname></string-name> and <string-name name-style="western" hwp:sortable="Evans M. J."><given-names>M. J.</given-names> <surname>Evans</surname></string-name>, “<article-title hwp:id="article-title-36">Differentiation of clonal lines of teratocarcinoma cells: formation of embryoid bodies in vitro</article-title>,” <source hwp:id="source-38">Proceedings of the National Academy of Sciences</source>, vol. <volume>72</volume>, no. <issue>4</issue>, pp. <fpage>1441</fpage>–<lpage>1445</lpage>, <year>1975</year>.</citation></ref><ref id="c39" hwp:id="ref-39" hwp:rev-id="xref-ref-39-1"><label>[39]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.39" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-39"><string-name name-style="western" hwp:sortable="Bibel M."><given-names>M.</given-names> <surname>Bibel</surname></string-name>, <string-name name-style="western" hwp:sortable="Richter J."><given-names>J.</given-names> <surname>Richter</surname></string-name>, <string-name name-style="western" hwp:sortable="Lacroix E."><given-names>E.</given-names> <surname>Lacroix</surname></string-name>, and <string-name name-style="western" hwp:sortable="Barde Y.-A."><given-names>Y.-A.</given-names> <surname>Barde</surname></string-name>, “<article-title hwp:id="article-title-37">Generation of a defined and uniform population of cns progenitors and neurons from mouse embryonic stem cells</article-title>,” <source hwp:id="source-39">Nature protocols</source>, vol. <volume>2</volume>, no. <issue>5</issue>, pp. <fpage>1034</fpage>–<lpage>1043</lpage>, <year>2007</year>.</citation></ref><ref id="c40" hwp:id="ref-40"><label>[40]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.40" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-40"><string-name name-style="western" hwp:sortable="Kang S.-M."><given-names>S.-M.</given-names> <surname>Kang</surname></string-name>, <string-name name-style="western" hwp:sortable="Cho M. S."><given-names>M. S.</given-names> <surname>Cho</surname></string-name>, <string-name name-style="western" hwp:sortable="Seo H."><given-names>H.</given-names> <surname>Seo</surname></string-name>, <string-name name-style="western" hwp:sortable="Yoon C. J."><given-names>C. J.</given-names> <surname>Yoon</surname></string-name>, <string-name name-style="western" hwp:sortable="Oh S. K."><given-names>S. K.</given-names> <surname>Oh</surname></string-name>, <string-name name-style="western" hwp:sortable="Choi Y. M."><given-names>Y. M.</given-names> <surname>Choi</surname></string-name>, and <string-name name-style="western" hwp:sortable="Kim D.-W."><given-names>D.-W.</given-names> <surname>Kim</surname></string-name>, “<article-title hwp:id="article-title-38">Efficient induction of oligodendrocytes from human embryonic stem cells</article-title>,” <source hwp:id="source-40">Stem Cells</source>, vol. <volume>25</volume>, no. <issue>2</issue>, pp. <fpage>419</fpage>–<lpage>424</lpage>, <year>2007</year>.</citation></ref><ref id="c41" hwp:id="ref-41"><label>[41]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.41" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-41"><string-name name-style="western" hwp:sortable="Zhao X."><given-names>X.</given-names> <surname>Zhao</surname></string-name>, <string-name name-style="western" hwp:sortable="Liu J."><given-names>J.</given-names> <surname>Liu</surname></string-name>, and <string-name name-style="western" hwp:sortable="Ahmad I."><given-names>I.</given-names> <surname>Ahmad</surname></string-name>, “<article-title hwp:id="article-title-39">Differentiation of embryonic stem cells to retinal cells in vitro</article-title>,” <source hwp:id="source-41">Embryonic Stem Cell Protocols: Volume 2: Differentiation Models</source>, pp. <fpage>401</fpage>–<lpage>416</lpage>, <year>2006</year>.</citation></ref><ref id="c42" hwp:id="ref-42" hwp:rev-id="xref-ref-42-1"><label>[42]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.42" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-42"><string-name name-style="western" hwp:sortable="Liour S. S."><given-names>S. S.</given-names> <surname>Liour</surname></string-name>, <string-name name-style="western" hwp:sortable="Kraemer S. A."><given-names>S. A.</given-names> <surname>Kraemer</surname></string-name>, <string-name name-style="western" hwp:sortable="Dinkins M. B."><given-names>M. B.</given-names> <surname>Dinkins</surname></string-name>, <string-name name-style="western" hwp:sortable="Su C.-Y."><given-names>C.-Y.</given-names> <surname>Su</surname></string-name>, <string-name name-style="western" hwp:sortable="Yanagisawa M."><given-names>M.</given-names> <surname>Yanagisawa</surname></string-name>, and <string-name name-style="western" hwp:sortable="Yu R. K."><given-names>R. K.</given-names> <surname>Yu</surname></string-name>, “<article-title hwp:id="article-title-40">Further characterization of embryonic stem cell-derived radial glial cells</article-title>,” <source hwp:id="source-42">Glia</source>, vol. <volume>53</volume>, no. <issue>1</issue>, pp. <fpage>43</fpage>–<lpage>56</lpage>, <year>2006</year>.</citation></ref><ref id="c43" hwp:id="ref-43" hwp:rev-id="xref-ref-43-1"><label>[43]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.43" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-43"><string-name name-style="western" hwp:sortable="Nakano T."><given-names>T.</given-names> <surname>Nakano</surname></string-name>, <string-name name-style="western" hwp:sortable="Kodama H."><given-names>H.</given-names> <surname>Kodama</surname></string-name>, and <string-name name-style="western" hwp:sortable="Honjo T."><given-names>T.</given-names> <surname>Honjo</surname></string-name>, “<article-title hwp:id="article-title-41">In vitro development of primitive and definitive erythrocytes from different precursors</article-title>,” <source hwp:id="source-43">Science</source>, vol. <volume>272</volume>, no. <issue>5262</issue>, p. <fpage>722</fpage>, <year>1996</year>.</citation></ref><ref id="c44" hwp:id="ref-44"><label>[44]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.44" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-44"><string-name name-style="western" hwp:sortable="Nishikawa S.-I."><given-names>S.-I.</given-names> <surname>Nishikawa</surname></string-name>, <string-name name-style="western" hwp:sortable="Nishikawa S."><given-names>S.</given-names> <surname>Nishikawa</surname></string-name>, <string-name name-style="western" hwp:sortable="Hirashima M."><given-names>M.</given-names> <surname>Hirashima</surname></string-name>, <string-name name-style="western" hwp:sortable="Matsuyoshi N."><given-names>N.</given-names> <surname>Matsuyoshi</surname></string-name>, and <string-name name-style="western" hwp:sortable="Kodama H."><given-names>H.</given-names> <surname>Kodama</surname></string-name>, “<article-title hwp:id="article-title-42">Progressive lineage analysis by cell sorting and culture identifies flk1+ ve-cadherin+ cells at a diverging point of endothelial and hemopoietic lineages</article-title>,” <source hwp:id="source-44">Development</source>, vol. <volume>125</volume>, no. <issue>9</issue>, pp. <fpage>1747</fpage>–<lpage>1757</lpage>, <year>1998</year>.</citation></ref><ref id="c45" hwp:id="ref-45"><label>[45]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.45" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-45"><string-name name-style="western" hwp:sortable="Wiles M. V."><given-names>M. V.</given-names> <surname>Wiles</surname></string-name> and <string-name name-style="western" hwp:sortable="Keller G."><given-names>G.</given-names> <surname>Keller</surname></string-name>, “<article-title hwp:id="article-title-43">Multiple hematopoietic lineages develop from embryonic stem (es) cells in culture</article-title>,” <source hwp:id="source-45">Development</source>, vol. <volume>111</volume>, no. <issue>2</issue>, pp. <fpage>259</fpage>–<lpage>267</lpage>, <year>1991</year>.</citation></ref><ref id="c46" hwp:id="ref-46"><label>[46]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.46" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-46"><string-name name-style="western" hwp:sortable="Potocnik A. J."><given-names>A. J.</given-names> <surname>Potocnik</surname></string-name>, <string-name name-style="western" hwp:sortable="Nielsen P. J."><given-names>P. J.</given-names> <surname>Nielsen</surname></string-name>, and <string-name name-style="western" hwp:sortable="Eichmann K."><given-names>K.</given-names> <surname>Eichmann</surname></string-name>, “<article-title hwp:id="article-title-44">In vitro generation of lymphoid precursors from embryonic stem cells</article-title>.,” <source hwp:id="source-46">The EMBO journal</source>, vol. <volume>13</volume>, no. <issue>22</issue>, p. <fpage>5274</fpage>, <year>1994</year>.</citation></ref><ref id="c47" hwp:id="ref-47"><label>[47]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.47" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-47"><string-name name-style="western" hwp:sortable="Tsai M."><given-names>M.</given-names> <surname>Tsai</surname></string-name>, <string-name name-style="western" hwp:sortable="Wedemeyer J."><given-names>J.</given-names> <surname>Wedemeyer</surname></string-name>, <string-name name-style="western" hwp:sortable="Ganiatsas S."><given-names>S.</given-names> <surname>Ganiatsas</surname></string-name>, <string-name name-style="western" hwp:sortable="Tam S.-Y."><given-names>S.-Y.</given-names> <surname>Tam</surname></string-name>, <string-name name-style="western" hwp:sortable="Zon L. I."><given-names>L. I.</given-names> <surname>Zon</surname></string-name>, and <string-name name-style="western" hwp:sortable="Galli S. J."><given-names>S. J.</given-names> <surname>Galli</surname></string-name>, “<article-title hwp:id="article-title-45">In vivo immunological function of mast cells derived from embryonic stem cells: an approach for the rapid analysis of even embryonic lethal mutations in adult mice in vivo</article-title>,” <source hwp:id="source-47">Proceedings of the National Academy of Sciences</source>, vol. <volume>97</volume>, no. <issue>16</issue>, pp. <fpage>9186</fpage>–<lpage>9190</lpage>, <year>2000</year>.</citation></ref><ref id="c48" hwp:id="ref-48"><label>[48]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.48" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-48"><string-name name-style="western" hwp:sortable="Fairchild P."><given-names>P.</given-names> <surname>Fairchild</surname></string-name>, <string-name name-style="western" hwp:sortable="Brook F."><given-names>F.</given-names> <surname>Brook</surname></string-name>, <string-name name-style="western" hwp:sortable="Gardner R."><given-names>R.</given-names> <surname>Gardner</surname></string-name>, <string-name name-style="western" hwp:sortable="Graca L."><given-names>L.</given-names> <surname>Graca</surname></string-name>, <string-name name-style="western" hwp:sortable="Strong V."><given-names>V.</given-names> <surname>Strong</surname></string-name>, <string-name name-style="western" hwp:sortable="Tone Y."><given-names>Y.</given-names> <surname>Tone</surname></string-name>, <string-name name-style="western" hwp:sortable="Tone M."><given-names>M.</given-names> <surname>Tone</surname></string-name>, <string-name name-style="western" hwp:sortable="Nolan K."><given-names>K.</given-names> <surname>Nolan</surname></string-name>, and <string-name name-style="western" hwp:sortable="Waldmann H."><given-names>H.</given-names> <surname>Waldmann</surname></string-name>, “<article-title hwp:id="article-title-46">Directed differentiation of dendritic cells from mouse embryonic stem cells</article-title>,” <source hwp:id="source-48">Current Biology</source>, vol. <volume>10</volume>, no. <issue>23</issue>, pp. <fpage>1515</fpage>–<lpage>1518</lpage>, <year>2000</year>.</citation></ref><ref id="c49" hwp:id="ref-49"><label>[49]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.49" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-49"><string-name name-style="western" hwp:sortable="Yamashita J."><given-names>J.</given-names> <surname>Yamashita</surname></string-name>, <string-name name-style="western" hwp:sortable="Itoh H."><given-names>H.</given-names> <surname>Itoh</surname></string-name>, <string-name name-style="western" hwp:sortable="Hirashima M."><given-names>M.</given-names> <surname>Hirashima</surname></string-name>, <string-name name-style="western" hwp:sortable="Ogawa M."><given-names>M.</given-names> <surname>Ogawa</surname></string-name>, <string-name name-style="western" hwp:sortable="Nishikawa S."><given-names>S.</given-names> <surname>Nishikawa</surname></string-name>, <string-name name-style="western" hwp:sortable="Yurugi T."><given-names>T.</given-names> <surname>Yurugi</surname></string-name>, <string-name name-style="western" hwp:sortable="Naito M."><given-names>M.</given-names> <surname>Naito</surname></string-name>, <string-name name-style="western" hwp:sortable="Nakao K."><given-names>K.</given-names> <surname>Nakao</surname></string-name>, and <string-name name-style="western" hwp:sortable="Nishikawa S.-I."><given-names>S.-I.</given-names> <surname>Nishikawa</surname></string-name>, “<article-title hwp:id="article-title-47">Flk1-positive cells derived from embryonic stem cells serve as vascular progenitors</article-title>,” <source hwp:id="source-49">Nature</source>, vol. <volume>408</volume>, no. <issue>6808</issue>, pp. <fpage>92</fpage>–<lpage>96</lpage>, <year>2000</year>.</citation></ref><ref id="c50" hwp:id="ref-50"><label>[50]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.50" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-50"><string-name name-style="western" hwp:sortable="Maltsev V. A."><given-names>V. A.</given-names> <surname>Maltsev</surname></string-name>, <string-name name-style="western" hwp:sortable="Rohwedel J."><given-names>J.</given-names> <surname>Rohwedel</surname></string-name>, <string-name name-style="western" hwp:sortable="Hescheler J."><given-names>J.</given-names> <surname>Hescheler</surname></string-name>, and <string-name name-style="western" hwp:sortable="Wobus A. M."><given-names>A. M.</given-names> <surname>Wobus</surname></string-name>, “<article-title hwp:id="article-title-48">Embryonic stem cells differentiate in vitro into cardiomyocytes representing sinusnodal, atrial and ventricular cell types</article-title>,” <source hwp:id="source-50">Mechanisms of development</source>, vol. <volume>44</volume>, no. <issue>1</issue>, pp. <fpage>41</fpage>–<lpage>50</lpage>, <year>1993</year>.</citation></ref><ref id="c51" hwp:id="ref-51" hwp:rev-id="xref-ref-51-1"><label>[51]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.51" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-51"><string-name name-style="western" hwp:sortable="Rohwedel J."><given-names>J.</given-names> <surname>Rohwedel</surname></string-name>, <string-name name-style="western" hwp:sortable="Maltsev V."><given-names>V.</given-names> <surname>Maltsev</surname></string-name>, <string-name name-style="western" hwp:sortable="Bober E."><given-names>E.</given-names> <surname>Bober</surname></string-name>, <string-name name-style="western" hwp:sortable="Arnold H.-H."><given-names>H.-H.</given-names> <surname>Arnold</surname></string-name>, <string-name name-style="western" hwp:sortable="Hescheler J."><given-names>J.</given-names> <surname>Hescheler</surname></string-name>, and <string-name name-style="western" hwp:sortable="Wobus A."><given-names>A.</given-names> <surname>Wobus</surname></string-name>, “<article-title hwp:id="article-title-49">Muscle cell differentiation of embryonic stem cells reflects myogenesis in vivo: developmentally regulated expression of myogenic determination genes and functional expression of ionic currents</article-title>,” <source hwp:id="source-51">Developmental biology</source>, vol. <volume>164</volume>, no. <issue>1</issue>, pp. <fpage>87</fpage>–<lpage>101</lpage>, <year>1994</year>.</citation></ref><ref id="c52" hwp:id="ref-52" hwp:rev-id="xref-ref-52-1"><label>[52]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.52" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-52"><string-name name-style="western" hwp:sortable="Kania G."><given-names>G.</given-names> <surname>Kania</surname></string-name>, <string-name name-style="western" hwp:sortable="Blyszczuk P."><given-names>P.</given-names> <surname>Blyszczuk</surname></string-name>, <string-name name-style="western" hwp:sortable="Jochheim A."><given-names>A.</given-names> <surname>Jochheim</surname></string-name>, <string-name name-style="western" hwp:sortable="Ott M."><given-names>M.</given-names> <surname>Ott</surname></string-name>, and <string-name name-style="western" hwp:sortable="Wobus A. M."><given-names>A. M.</given-names> <surname>Wobus</surname></string-name>, “<article-title hwp:id="article-title-50">Generation of glycogen-and albumin-producing hepatocyte-like cells from embryonic stem cells</article-title>,” <source hwp:id="source-52">Biological chemistry</source>, vol. <volume>385</volume>, no. <issue>10</issue>, pp. <fpage>943</fpage>–<lpage>953</lpage>, <year>2004</year>.</citation></ref><ref id="c53" hwp:id="ref-53" hwp:rev-id="xref-ref-53-1"><label>[53]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.53" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-53"><string-name name-style="western" hwp:sortable="Schroeder I. S."><given-names>I. S.</given-names> <surname>Schroeder</surname></string-name>, <string-name name-style="western" hwp:sortable="Rolletschek A."><given-names>A.</given-names> <surname>Rolletschek</surname></string-name>, <string-name name-style="western" hwp:sortable="Blyszczuk P."><given-names>P.</given-names> <surname>Blyszczuk</surname></string-name>, <string-name name-style="western" hwp:sortable="Kania G."><given-names>G.</given-names> <surname>Kania</surname></string-name>, and <string-name name-style="western" hwp:sortable="Wobus A. M."><given-names>A. M.</given-names> <surname>Wobus</surname></string-name>, “<article-title hwp:id="article-title-51">Differentiation of mouse embryonic stem cells to insulin-producing cells</article-title>,” <source hwp:id="source-53">Nature Protocols</source>, vol. <volume>1</volume>, no. <issue>2</issue>, pp. <fpage>495</fpage>–<lpage>507</lpage>, <year>2006</year>.</citation></ref><ref id="c54" hwp:id="ref-54" hwp:rev-id="xref-ref-54-1"><label>[54]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.54" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-54"><string-name name-style="western" hwp:sortable="Geijsen N."><given-names>N.</given-names> <surname>Geijsen</surname></string-name>, <string-name name-style="western" hwp:sortable="Horoschak M."><given-names>M.</given-names> <surname>Horoschak</surname></string-name>, <string-name name-style="western" hwp:sortable="Kim K."><given-names>K.</given-names> <surname>Kim</surname></string-name>, <string-name name-style="western" hwp:sortable="Gribnau J."><given-names>J.</given-names> <surname>Gribnau</surname></string-name>, <string-name name-style="western" hwp:sortable="Eggan K."><given-names>K.</given-names> <surname>Eggan</surname></string-name>, and <string-name name-style="western" hwp:sortable="Daley G. Q."><given-names>G. Q.</given-names> <surname>Daley</surname></string-name>, “<article-title hwp:id="article-title-52">Derivation of embryonic germ cells and male gametes from embryonic stem cells</article-title>,” <source hwp:id="source-54">Nature</source>, vol. <volume>427</volume>, no. <issue>6970</issue>, pp. <fpage>148</fpage>–<lpage>154</lpage>, <year>2004</year>.</citation></ref><ref id="c55" hwp:id="ref-55" hwp:rev-id="xref-ref-55-1"><label>[55]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.55" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-55"><string-name name-style="western" hwp:sortable="Kehler J."><given-names>J.</given-names> <surname>Kehler</surname></string-name>, <string-name name-style="western" hwp:sortable="Hübner K."><given-names>K.</given-names> <surname>Hübner</surname></string-name>, <string-name name-style="western" hwp:sortable="Garrett S."><given-names>S.</given-names> <surname>Garrett</surname></string-name>, and <string-name name-style="western" hwp:sortable="Schöler H. R."><given-names>H. R.</given-names> <surname>Schöler</surname></string-name>, “<article-title hwp:id="article-title-53">Generating oocytes and sperm from embryonic stem cells</article-title>,” <source hwp:id="source-55">Seminars in reproductive medicine</source>, vol. <volume>23</volume>, no. <issue>03</issue>, pp. <fpage>222</fpage>–<lpage>233</lpage>, <year>2005</year>.</citation></ref><ref id="c56" hwp:id="ref-56" hwp:rev-id="xref-ref-56-1"><label>[56]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.56" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-56"><string-name name-style="western" hwp:sortable="Betancur P."><given-names>P.</given-names> <surname>Betancur</surname></string-name>, <string-name name-style="western" hwp:sortable="Bronner-Fraser M."><given-names>M.</given-names> <surname>Bronner-Fraser</surname></string-name>, and <string-name name-style="western" hwp:sortable="Sauka-Spengler T."><given-names>T.</given-names> <surname>Sauka-Spengler</surname></string-name>, “<article-title hwp:id="article-title-54">Assembling neural crest regulatory circuits into a gene regulatory network</article-title>,” <source hwp:id="source-56">Annual review of cell and developmental biology</source>, vol. <volume>26</volume>, pp. <fpage>581</fpage>–<lpage>603</lpage>, <year>2010</year>.</citation></ref><ref id="c57" hwp:id="ref-57" hwp:rev-id="xref-ref-57-1"><label>[57]</label><citation publication-type="book" citation-type="book" ref:id="120378v4.57" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-57"><string-name name-style="western" hwp:sortable="Barembaum M."><given-names>M.</given-names> <surname>Barembaum</surname></string-name> and <string-name name-style="western" hwp:sortable="Bronner-Fraser M."><given-names>M.</given-names> <surname>Bronner-Fraser</surname></string-name>, “<chapter-title>Early steps in neural crest specification</chapter-title>,” in <source hwp:id="source-57">Seminars in cell &amp; developmental biology</source>, vol. <volume>16</volume>, pp. <fpage>642</fpage>–<lpage>646</lpage>, <publisher-name>Elsevier</publisher-name>, <year>2005</year>.</citation></ref><ref id="c58" hwp:id="ref-58" hwp:rev-id="xref-ref-58-1 xref-ref-58-2"><label>[58]</label><citation publication-type="other" citation-type="journal" ref:id="120378v4.58" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-58"><string-name name-style="western" hwp:sortable="Treleaven K."><given-names>K.</given-names> <surname>Treleaven</surname></string-name> and <string-name name-style="western" hwp:sortable="Frazzoli E."><given-names>E.</given-names> <surname>Frazzoli</surname></string-name>, “<article-title hwp:id="article-title-55">An explicit formulation of the earth movers distance with continuous road map distances</article-title>,” arXiv preprint arXiv:<pub-id pub-id-type="arxiv">1309.7098</pub-id>, <year>2013</year>.</citation></ref><ref id="c59" hwp:id="ref-59" hwp:rev-id="xref-ref-59-1"><label>[59]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.59" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-59"><string-name name-style="western" hwp:sortable="Coifman R. R."><given-names>R. R.</given-names> <surname>Coifman</surname></string-name>, <string-name name-style="western" hwp:sortable="Lafon S."><given-names>S.</given-names> <surname>Lafon</surname></string-name>, <string-name name-style="western" hwp:sortable="Lee A. B."><given-names>A. B.</given-names> <surname>Lee</surname></string-name>, <string-name name-style="western" hwp:sortable="Maggioni M."><given-names>M.</given-names> <surname>Maggioni</surname></string-name>, <string-name name-style="western" hwp:sortable="Nadler B."><given-names>B.</given-names> <surname>Nadler</surname></string-name>, <string-name name-style="western" hwp:sortable="Warner F."><given-names>F.</given-names> <surname>Warner</surname></string-name>, and <string-name name-style="western" hwp:sortable="Zucker S. W."><given-names>S. W.</given-names> <surname>Zucker</surname></string-name>, “<article-title hwp:id="article-title-56">Geometric diffusions as a tool for harmonic analysis and structure definition of data: Diffusion maps</article-title>,” <source hwp:id="source-58">Proceedings of the National Academy of Sciences of the United States of America</source>, vol. <volume>102</volume>, no. <issue>21</issue>, pp. <fpage>7426</fpage>–<lpage>7431</lpage>, <year>2005</year>.</citation></ref><ref id="c60" hwp:id="ref-60" hwp:rev-id="xref-ref-60-1"><label>[60]</label><citation publication-type="book" citation-type="book" ref:id="120378v4.60" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-60"><string-name name-style="western" hwp:sortable="Bellman R. E."><given-names>R. E.</given-names> <surname>Bellman</surname></string-name>, <source hwp:id="source-59">Dynamic Programming</source>. <publisher-loc>Princeton, NJ</publisher-loc>: <publisher-name>Princeton University Press</publisher-name>, <year>1957</year>.</citation></ref><ref id="c61" hwp:id="ref-61" hwp:rev-id="xref-ref-61-1"><label>[61]</label><citation publication-type="book" citation-type="book" ref:id="120378v4.61" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-61"><string-name name-style="western" hwp:sortable="Bellman R. E."><given-names>R. E.</given-names> <surname>Bellman</surname></string-name> and <string-name name-style="western" hwp:sortable="Dreyfus S. E."><given-names>S. E.</given-names> <surname>Dreyfus</surname></string-name>, <source hwp:id="source-60">Applied Dynamic Programming</source>. <publisher-loc>Princeton, NJ</publisher-loc>: <publisher-name>Princeton University Press</publisher-name>, <year>1962</year>.</citation></ref><ref id="c62" hwp:id="ref-62" hwp:rev-id="xref-ref-62-1"><label>[62]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.62" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-62"><string-name name-style="western" hwp:sortable="Moon K. R."><given-names>K. R.</given-names> <surname>Moon</surname></string-name>, <string-name name-style="western" hwp:sortable="Stanley J. S."><given-names>J. S.</given-names> <surname>Stanley</surname> <prefix>III</prefix></string-name>, <string-name name-style="western" hwp:sortable="Burkhardt D."><given-names>D.</given-names> <surname>Burkhardt</surname></string-name>, <string-name name-style="western" hwp:sortable="van Dijk D."><given-names>D.</given-names> <surname>van Dijk</surname></string-name>, <string-name name-style="western" hwp:sortable="Wolf G."><given-names>G.</given-names> <surname>Wolf</surname></string-name>, and <string-name name-style="western" hwp:sortable="Krishnaswamy S."><given-names>S.</given-names> <surname>Krishnaswamy</surname></string-name>, “<article-title hwp:id="article-title-57">Manifold learning-based methods for analyzing single-cell rna-sequencing data</article-title>,” <source hwp:id="source-61">Current Opinion in Systems Biology</source>, vol. <volume>7</volume>, pp. <fpage>36</fpage>–<lpage>46</lpage>, <year>2018</year>.</citation></ref><ref id="c63" hwp:id="ref-63" hwp:rev-id="xref-ref-63-1"><label>[63]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.63" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-63"><string-name name-style="western" hwp:sortable="Bérard P."><given-names>P.</given-names> <surname>Bérard</surname></string-name>, <string-name name-style="western" hwp:sortable="Besson G."><given-names>G.</given-names> <surname>Besson</surname></string-name>, and <string-name name-style="western" hwp:sortable="Gallot S."><given-names>S.</given-names> <surname>Gallot</surname></string-name>, “<article-title hwp:id="article-title-58">Embedding riemannian manifolds by their heat kernel</article-title>,” <source hwp:id="source-62">Geometric and Functional Analysis</source>, vol. <volume>4</volume>, no. <issue>4</issue>, pp. <fpage>373</fpage>–<lpage>398</lpage>, <year>1994</year>.</citation></ref><ref id="c64" hwp:id="ref-64" hwp:rev-id="xref-ref-64-1"><label>[64]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.64" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-64"><string-name name-style="western" hwp:sortable="Jones P. W."><given-names>P. W.</given-names> <surname>Jones</surname></string-name>, <string-name name-style="western" hwp:sortable="Maggioni M."><given-names>M.</given-names> <surname>Maggioni</surname></string-name>, and <string-name name-style="western" hwp:sortable="Schul R."><given-names>R.</given-names> <surname>Schul</surname></string-name>, “<article-title hwp:id="article-title-59">Manifold parametrizations by eigenfunctions of the laplacian and heat kernels</article-title>,” <source hwp:id="source-63">Proceedings of the National Academy of Sciences</source>, vol. <volume>105</volume>, no. <issue>6</issue>, pp. <fpage>1803</fpage>–<lpage>1808</lpage>, <year>2008</year>.</citation></ref><ref id="c65" hwp:id="ref-65" hwp:rev-id="xref-ref-65-1 xref-ref-65-2 xref-ref-65-3 xref-ref-65-4 xref-ref-65-5"><label>[65]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.65" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-65"><string-name name-style="western" hwp:sortable="Nadler B."><given-names>B.</given-names> <surname>Nadler</surname></string-name>, <string-name name-style="western" hwp:sortable="Lafon S."><given-names>S.</given-names> <surname>Lafon</surname></string-name>, <string-name name-style="western" hwp:sortable="Coifman R."><given-names>R.</given-names> <surname>Coifman</surname></string-name>, and <string-name name-style="western" hwp:sortable="Kevrekidis I."><given-names>I.</given-names> <surname>Kevrekidis</surname></string-name>, “<article-title hwp:id="article-title-60">Diffusion maps, spectral clustering and eigenfunctions of fokker-planck operators</article-title>,” in <source hwp:id="source-64">Advances in Neural Information Processing Systems</source>, pp. <fpage>955</fpage>–<lpage>962</lpage>, <year>2005</year>.</citation></ref><ref id="c66" hwp:id="ref-66" hwp:rev-id="xref-ref-66-1 xref-ref-66-2 xref-ref-66-3 xref-ref-66-4 xref-ref-66-5 xref-ref-66-6"><label>[66]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.66" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-66"><string-name name-style="western" hwp:sortable="Nadler B."><given-names>B.</given-names> <surname>Nadler</surname></string-name>, <string-name name-style="western" hwp:sortable="Lafon S."><given-names>S.</given-names> <surname>Lafon</surname></string-name>, <string-name name-style="western" hwp:sortable="Coifman R. R."><given-names>R. R.</given-names> <surname>Coifman</surname></string-name>, and <string-name name-style="western" hwp:sortable="Kevrekidis I. G."><given-names>I. G.</given-names> <surname>Kevrekidis</surname></string-name>, “<article-title hwp:id="article-title-61">Diffusion maps, spectral clustering and reaction coordinates of dynamical systems</article-title>,” <source hwp:id="source-65">Applied and Computational Harmonic Analysis</source>, vol. <volume>21</volume>, no. <issue>1</issue>, pp. <fpage>113</fpage>–<lpage>127</lpage>, <year>2006</year>.</citation></ref><ref id="c67" hwp:id="ref-67" hwp:rev-id="xref-ref-67-1"><label>[67]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.67" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-67"><string-name name-style="western" hwp:sortable="Butterworth S."><given-names>S.</given-names> <surname>Butterworth</surname></string-name>, “<article-title hwp:id="article-title-62">On the theory of filter amplifiers</article-title>,” <source hwp:id="source-66">Wireless Engineer</source>, vol. <volume>7</volume>, no. <issue>6</issue>, pp. <fpage>536</fpage>–<lpage>541</lpage>, <year>1930</year>.</citation></ref><ref id="c68" hwp:id="ref-68" hwp:rev-id="xref-ref-68-1"><label>[68]</label><citation publication-type="book" citation-type="book" ref:id="120378v4.68" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-68"><string-name name-style="western" hwp:sortable="Neumann J."><given-names>J.</given-names> <surname>Neumann</surname></string-name>, <source hwp:id="source-67">Mathematische grundlagen der quantenmechanik</source>. <publisher-name>Verlag von Julius Springer Berlin</publisher-name>, <year>1932</year>.</citation></ref><ref id="c69" hwp:id="ref-69" hwp:rev-id="xref-ref-69-1"><label>[69]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.69" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-69"><string-name name-style="western" hwp:sortable="Anand K."><given-names>K.</given-names> <surname>Anand</surname></string-name>, <string-name name-style="western" hwp:sortable="Bianconi G."><given-names>G.</given-names> <surname>Bianconi</surname></string-name>, and <string-name name-style="western" hwp:sortable="Severini S."><given-names>S.</given-names> <surname>Severini</surname></string-name>, “<article-title hwp:id="article-title-63">Shannon and von neumann entropy of random networks with heterogeneous expected degree</article-title>,” <source hwp:id="source-68">Physical Review E</source>, vol. <volume>83</volume>, no. <issue>3</issue>, p. <fpage>036109</fpage>, <year>2011</year>.</citation></ref><ref id="c70" hwp:id="ref-70" hwp:rev-id="xref-ref-70-1"><label>[70]</label><citation publication-type="other" citation-type="journal" ref:id="120378v4.70" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-70"><string-name name-style="western" hwp:sortable="Kaplan D."><given-names>D.</given-names> <surname>Kaplan</surname></string-name>, “<article-title hwp:id="article-title-64">Knee Point - File Exchange - MATLAB Central</article-title>,” <year>2012</year>.</citation></ref><ref id="c71" hwp:id="ref-71" hwp:rev-id="xref-ref-71-1 xref-ref-71-2"><label>[71]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.71" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-71"><string-name name-style="western" hwp:sortable="Salicrú M."><given-names>M.</given-names> <surname>Salicrú</surname></string-name> and <string-name name-style="western" hwp:sortable="Pons A. A."><given-names>A. A.</given-names> <surname>Pons</surname></string-name>, “<article-title hwp:id="article-title-65">Sobre ciertas propiedades de la m-divergencia en análisis de datos</article-title>,” <source hwp:id="source-69">Qüestiió: quaderns d’estadística i investigació operativa</source>, vol. <volume>9</volume>, no. <issue>4</issue>, pp. <fpage>251</fpage>–<lpage>256</lpage>, <year>1985</year>.</citation></ref><ref id="c72" hwp:id="ref-72" hwp:rev-id="xref-ref-72-1 xref-ref-72-2"><label>[72]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.72" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-72"><string-name name-style="western" hwp:sortable="Salicrú M."><given-names>M.</given-names> <surname>Salicrú</surname></string-name>, <string-name name-style="western" hwp:sortable="Sanchez A."><given-names>A.</given-names> <surname>Sanchez</surname></string-name>, <string-name name-style="western" hwp:sortable="Conde J."><given-names>J.</given-names> <surname>Conde</surname></string-name>, and <string-name name-style="western" hwp:sortable="Sanchez P."><given-names>P.</given-names> <surname>Sanchez</surname></string-name>, “<article-title hwp:id="article-title-66">Entropy measures associated with K and M divergences</article-title>,” <source hwp:id="source-70">Soochow Journal of Mathematics</source>, vol. <volume>21</volume>, no. <issue>3</issue>, pp. <fpage>291</fpage>–<lpage>298</lpage>, <year>1995</year>.</citation></ref><ref id="c73" hwp:id="ref-73" hwp:rev-id="xref-ref-73-1 xref-ref-73-2"><label>[73]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.73" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-73"><string-name name-style="western" hwp:sortable="Hellinger E."><given-names>E.</given-names> <surname>Hellinger</surname></string-name>, “<article-title hwp:id="article-title-67">Neue begründung der theorie quadratischer formen von unendlichvielen veränderlichen</article-title>.,” <source hwp:id="source-71">Journal für die reine und angewandte Mathematik</source>, vol. <volume>136</volume>, pp. <fpage>210</fpage>–<lpage>271</lpage>, <year>1909</year>.</citation></ref><ref id="c74" hwp:id="ref-74" hwp:rev-id="xref-ref-74-1"><label>[74]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.74" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-74"><string-name name-style="western" hwp:sortable="Eguchi S."><given-names>S.</given-names> <surname>Eguchi</surname></string-name> <etal>et al.,</etal> “<article-title hwp:id="article-title-68">A differential geometric approach to statistical inference on the basis of contrast functionals</article-title>,” <source hwp:id="source-72">Hiroshima mathematical journal</source>, vol. <volume>15</volume>, no. <issue>2</issue>, pp. <fpage>341</fpage>–<lpage>391</lpage>, <year>1985</year>.</citation></ref><ref id="c75" hwp:id="ref-75" hwp:rev-id="xref-ref-75-1"><label>[75]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.75" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-75"><string-name name-style="western" hwp:sortable="Csiszár I."><given-names>I.</given-names> <surname>Csiszár</surname></string-name>, “<article-title hwp:id="article-title-69">Eine informationstheoretische ungleichung und ihre anwendung auf beweis der ergodizitaet von markoffschen ketten</article-title>,” <source hwp:id="source-73">Magyer Tud. Akad. Mat. Kutato Int. Koezl</source>., vol. <volume>8</volume>, pp. <fpage>85</fpage>–<lpage>108</lpage>, <year>1964</year>.</citation></ref><ref id="c76" hwp:id="ref-76" hwp:rev-id="xref-ref-76-1"><label>[76]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.76" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-76"><string-name name-style="western" hwp:sortable="Ali S. M."><given-names>S. M.</given-names> <surname>Ali</surname></string-name> and <string-name name-style="western" hwp:sortable="Silvey S. D."><given-names>S. D.</given-names> <surname>Silvey</surname></string-name>, “<article-title hwp:id="article-title-70">A general class of coefficients of divergence of one distribution from another</article-title>,” <source hwp:id="source-74">Journal of the Royal Statistical Society. Series B (Methodological)</source>, pp. <fpage>131</fpage>–<lpage>142</lpage>, <year>1966</year>.</citation></ref><ref id="c77" hwp:id="ref-77" hwp:rev-id="xref-ref-77-1"><label>[77]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.77" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-77"><string-name name-style="western" hwp:sortable="Bregman L. M."><given-names>L. M.</given-names> <surname>Bregman</surname></string-name>, “<article-title hwp:id="article-title-71">The relaxation method of finding the common point of convex sets and its application to the solution of problems in convex programming</article-title>,” <source hwp:id="source-75">USSR computational mathematics and mathematical physics</source>, vol. <volume>7</volume>, no. <issue>3</issue>, pp. <fpage>200</fpage>–<lpage>217</lpage>, <year>1967</year>.</citation></ref><ref id="c78" hwp:id="ref-78" hwp:rev-id="xref-ref-78-1"><label>[78]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.78" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-78"><string-name name-style="western" hwp:sortable="Kullback S."><given-names>S.</given-names> <surname>Kullback</surname></string-name> and <string-name name-style="western" hwp:sortable="Leibler R. A."><given-names>R. A.</given-names> <surname>Leibler</surname></string-name>, “<article-title hwp:id="article-title-72">On information and sufficiency</article-title>,” <source hwp:id="source-76">The annals of mathematical statistics</source>, vol. <volume>22</volume>, no. <issue>1</issue>, pp. <fpage>79</fpage>–<lpage>86</lpage>, <year>1951</year>.</citation></ref><ref id="c79" hwp:id="ref-79" hwp:rev-id="xref-ref-79-1 xref-ref-79-2 xref-ref-79-3"><label>[79]</label><citation publication-type="book" citation-type="book" ref:id="120378v4.79" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-79"><string-name name-style="western" hwp:sortable="Amari S."><given-names>S.</given-names> <surname>Amari</surname></string-name>, <source hwp:id="source-77">Information geometry and its applications</source>. <publisher-name>Springer</publisher-name>, <year>2016</year>.</citation></ref><ref id="c80" hwp:id="ref-80" hwp:rev-id="xref-ref-80-1 xref-ref-80-2 xref-ref-80-3"><label>[80]</label><citation publication-type="book" citation-type="book" ref:id="120378v4.80" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-80"><string-name name-style="western" hwp:sortable="Amari S.-i."><given-names>S.-i.</given-names> <surname>Amari</surname></string-name> and <string-name name-style="western" hwp:sortable="Nagaoka H."><given-names>H.</given-names> <surname>Nagaoka</surname></string-name>, <source hwp:id="source-78">Methods of information geometry</source>, vol. <volume>191</volume> of <italic toggle="yes">Translations of Mathematical Monographs</italic>. <chapter-title>American Mathematical Society, Providence, RI</chapter-title>; <publisher-name>Oxford University Press</publisher-name>, <publisher-loc>Oxford</publisher-loc>, <year>2000</year>. Translated from the 1993 Japanese original by Daishi Harada.</citation></ref><ref id="c81" hwp:id="ref-81" hwp:rev-id="xref-ref-81-1"><label>[81]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.81" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-81"><string-name name-style="western" hwp:sortable="Wolf G."><given-names>G.</given-names> <surname>Wolf</surname></string-name>, <string-name name-style="western" hwp:sortable="Rotbart A."><given-names>A.</given-names> <surname>Rotbart</surname></string-name>, <string-name name-style="western" hwp:sortable="David G."><given-names>G.</given-names> <surname>David</surname></string-name>, and <string-name name-style="western" hwp:sortable="Averbuch A."><given-names>A.</given-names> <surname>Averbuch</surname></string-name>, “<article-title hwp:id="article-title-73">Coarse-grained localized diffusion</article-title>,” <source hwp:id="source-79">Applied and Computational Harmonic Analysis</source>, vol. <volume>33</volume>, no. <issue>3</issue>, pp. <fpage>388</fpage>–<lpage>400</lpage>, <year>2012</year>.</citation></ref><ref id="c82" hwp:id="ref-82" hwp:rev-id="xref-ref-82-1 xref-ref-82-2"><label>[82]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.82" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-82"><string-name name-style="western" hwp:sortable="Platt J."><given-names>J.</given-names> <surname>Platt</surname></string-name>, “<article-title hwp:id="article-title-74">Fastmap, metricmap, and landmark mds are all nystrom algorithms</article-title>.,” in <source hwp:id="source-80">AIS-TATS</source>, <year>2005</year>.</citation></ref><ref id="c83" hwp:id="ref-83" hwp:rev-id="xref-ref-83-1"><label>[83]</label><citation publication-type="other" citation-type="journal" ref:id="120378v4.83" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-83"><string-name name-style="western" hwp:sortable="Yang T."><given-names>T.</given-names> <surname>Yang</surname></string-name>, <string-name name-style="western" hwp:sortable="Liu J."><given-names>J.</given-names> <surname>Liu</surname></string-name>, <string-name name-style="western" hwp:sortable="McMillan L."><given-names>L.</given-names> <surname>McMillan</surname></string-name>, and <string-name name-style="western" hwp:sortable="Wang W."><given-names>W.</given-names> <surname>Wang</surname></string-name>, “<article-title hwp:id="article-title-75">A fast approximation to multidimensional scaling</article-title>,” in <source hwp:id="source-81">IEEE workshop on computation intensive methods for computer vision</source>, <year>2006</year>.</citation></ref><ref id="c84" hwp:id="ref-84" hwp:rev-id="xref-ref-84-1"><label>[84]</label><citation publication-type="other" citation-type="journal" ref:id="120378v4.84" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-84"><string-name name-style="western" hwp:sortable="Gigante S."><given-names>S.</given-names> <surname>Gigante</surname></string-name>, <string-name name-style="western" hwp:sortable="Stanley J. S."><given-names>J. S.</given-names> <surname>Stanley</surname> <prefix>III</prefix></string-name>, <string-name name-style="western" hwp:sortable="Vu N."><given-names>N.</given-names> <surname>Vu</surname></string-name>, <string-name name-style="western" hwp:sortable="van Dijk D."><given-names>D.</given-names> <surname>van Dijk</surname></string-name>, <string-name name-style="western" hwp:sortable="Moon K."><given-names>K.</given-names> <surname>Moon</surname></string-name>, <string-name name-style="western" hwp:sortable="Wolf G."><given-names>G.</given-names> <surname>Wolf</surname></string-name>, and <string-name name-style="western" hwp:sortable="Krishnaswamy S."><given-names>S.</given-names> <surname>Krishnaswamy</surname></string-name>, “<article-title hwp:id="article-title-76">Compressed diffusion</article-title>,” arXiv preprint arXiv:<pub-id pub-id-type="arxiv">1902.00033</pub-id>, <year>2019</year>.</citation></ref><ref id="c85" hwp:id="ref-85" hwp:rev-id="xref-ref-85-1 xref-ref-85-2"><label>[85]</label><citation publication-type="other" citation-type="journal" ref:id="120378v4.85" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-85">“<article-title hwp:id="article-title-77">Our 1.3 million single cell dataset is ready to download</article-title>,” <month>Feb</month>. <year>2017</year>.</citation></ref><ref id="c86" hwp:id="ref-86" hwp:rev-id="xref-ref-86-1 xref-ref-86-2 xref-ref-86-3"><label>[86]</label><citation publication-type="book" citation-type="book" ref:id="120378v4.86" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-86"><string-name name-style="western" hwp:sortable="Costa J. A."><given-names>J. A.</given-names> <surname>Costa</surname></string-name> and <string-name name-style="western" hwp:sortable="Hero A. O."><given-names>A. O.</given-names> <surname>Hero</surname> <prefix>III</prefix></string-name>, “<chapter-title>Determining intrinsic dimension and entropy of highdimensional shape spaces</chapter-title>,” in <source hwp:id="source-82">Statistics and Analysis of Shapes</source>, pp. <fpage>231</fpage>–<lpage>252</lpage>, <publisher-name>Springer</publisher-name>, <year>2006</year>.</citation></ref><ref id="c87" hwp:id="ref-87" hwp:rev-id="xref-ref-87-1 xref-ref-87-2"><label>[87]</label><citation publication-type="confproc" citation-type="confproc" ref:id="120378v4.87" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-87"><string-name name-style="western" hwp:sortable="Rubner Y."><given-names>Y.</given-names> <surname>Rubner</surname></string-name>, <string-name name-style="western" hwp:sortable="Tomasi C."><given-names>C.</given-names> <surname>Tomasi</surname></string-name>, and <string-name name-style="western" hwp:sortable="Guibas L. J."><given-names>L. J.</given-names> <surname>Guibas</surname></string-name>, “<article-title hwp:id="article-title-78">A metric for distributions with applications to image databases</article-title>,” in <source hwp:id="source-83">Computer Vision</source>, 1998. <conf-name>IEEE Sixth International Conference on</conf-name>, pp. <fpage>59</fpage>–<lpage>66</lpage>, IEEE, <year>1998</year>.</citation></ref><ref id="c88" hwp:id="ref-88" hwp:rev-id="xref-ref-88-1"><label>[88]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.88" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-88"><string-name name-style="western" hwp:sortable="Bendall S. C."><given-names>S. C.</given-names> <surname>Bendall</surname></string-name>, <string-name name-style="western" hwp:sortable="Simonds E. F."><given-names>E. F.</given-names> <surname>Simonds</surname></string-name>, <string-name name-style="western" hwp:sortable="Qiu P."><given-names>P.</given-names> <surname>Qiu</surname></string-name>, <string-name name-style="western" hwp:sortable="El-ad D. A."><given-names>D. A.</given-names> <surname>El-ad</surname></string-name>, <string-name name-style="western" hwp:sortable="Krutzik P. O."><given-names>P. O.</given-names> <surname>Krutzik</surname></string-name>, <string-name name-style="western" hwp:sortable="Finck R."><given-names>R.</given-names> <surname>Finck</surname></string-name>, <string-name name-style="western" hwp:sortable="Bruggner R. V."><given-names>R. V.</given-names> <surname>Bruggner</surname></string-name>, <string-name name-style="western" hwp:sortable="Melamed R."><given-names>R.</given-names> <surname>Melamed</surname></string-name>, <string-name name-style="western" hwp:sortable="Trejo A."><given-names>A.</given-names> <surname>Trejo</surname></string-name>, <string-name name-style="western" hwp:sortable="Ornatsky O. I."><given-names>O. I.</given-names> <surname>Ornatsky</surname></string-name>, <etal>et al.,</etal> “<article-title hwp:id="article-title-79">Single-cell mass cytometry of differential immune and drug responses across a human hematopoietic continuum</article-title>,” <source hwp:id="source-84">Science</source>, vol. <volume>332</volume>, no. <issue>6030</issue>, pp. <fpage>687</fpage>–<lpage>696</lpage>, <year>2011</year>.</citation></ref><ref id="c89" hwp:id="ref-89" hwp:rev-id="xref-ref-89-1"><label>[89]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.89" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-89"><string-name name-style="western" hwp:sortable="Zheng G. X."><given-names>G. X.</given-names> <surname>Zheng</surname></string-name>, <string-name name-style="western" hwp:sortable="Terry J. M."><given-names>J. M.</given-names> <surname>Terry</surname></string-name>, <string-name name-style="western" hwp:sortable="Belgrader P."><given-names>P.</given-names> <surname>Belgrader</surname></string-name>, <string-name name-style="western" hwp:sortable="Ryvkin P."><given-names>P.</given-names> <surname>Ryvkin</surname></string-name>, <string-name name-style="western" hwp:sortable="Bent Z. W."><given-names>Z. W.</given-names> <surname>Bent</surname></string-name>, <string-name name-style="western" hwp:sortable="Wilson R."><given-names>R.</given-names> <surname>Wilson</surname></string-name>, <string-name name-style="western" hwp:sortable="Ziraldo S. B."><given-names>S. B.</given-names> <surname>Ziraldo</surname></string-name>, <string-name name-style="western" hwp:sortable="Wheeler T. D."><given-names>T. D.</given-names> <surname>Wheeler</surname></string-name>, <string-name name-style="western" hwp:sortable="McDermott G. P."><given-names>G. P.</given-names> <surname>McDermott</surname></string-name>, <string-name name-style="western" hwp:sortable="Zhu J."><given-names>J.</given-names> <surname>Zhu</surname></string-name>, <string-name name-style="western" hwp:sortable="Gregory M."><given-names>M.</given-names> <surname>Gregory</surname></string-name>, <string-name name-style="western" hwp:sortable="Shuga J."><given-names>J.</given-names> <surname>Shuga</surname></string-name>, <string-name name-style="western" hwp:sortable="Montesclaros L."><given-names>L.</given-names> <surname>Montesclaros</surname></string-name>, <string-name name-style="western" hwp:sortable="Underwood J."><given-names>J.</given-names> <surname>Underwood</surname></string-name>, <string-name name-style="western" hwp:sortable="Masquelier D."><given-names>D.</given-names> <surname>Masquelier</surname></string-name>, <string-name name-style="western" hwp:sortable="Nishimura S."><given-names>S.</given-names> <surname>Nishimura</surname></string-name>, <string-name name-style="western" hwp:sortable="Schnall-Levin M."><given-names>M.</given-names> <surname>Schnall-Levin</surname></string-name>, <string-name name-style="western" hwp:sortable="Wyatt P."><given-names>P.</given-names> <surname>Wyatt</surname></string-name>, <string-name name-style="western" hwp:sortable="Hindson C."><given-names>C.</given-names> <surname>Hindson</surname></string-name>, <string-name name-style="western" hwp:sortable="Bharadwaj R."><given-names>R.</given-names> <surname>Bharadwaj</surname></string-name>, <string-name name-style="western" hwp:sortable="Wong A."><given-names>A.</given-names> <surname>Wong</surname></string-name>, <string-name name-style="western" hwp:sortable="Ness K. D."><given-names>K. D.</given-names> <surname>Ness</surname></string-name>, <string-name name-style="western" hwp:sortable="Beppu L. W."><given-names>L. W.</given-names> <surname>Beppu</surname></string-name>, <string-name name-style="western" hwp:sortable="Deeg H. J."><given-names>H. J.</given-names> <surname>Deeg</surname></string-name>, <string-name name-style="western" hwp:sortable="McFarland C."><given-names>C.</given-names> <surname>McFarland</surname></string-name>, <string-name name-style="western" hwp:sortable="Loeb K. R."><given-names>K. R.</given-names> <surname>Loeb</surname></string-name>, <string-name name-style="western" hwp:sortable="Valente W. J."><given-names>W. J.</given-names> <surname>Valente</surname></string-name>, <string-name name-style="western" hwp:sortable="Ericson N. G."><given-names>N. G.</given-names> <surname>Ericson</surname></string-name>, <string-name name-style="western" hwp:sortable="Stevens E. A."><given-names>E. A.</given-names> <surname>Stevens</surname></string-name>, <string-name name-style="western" hwp:sortable="Radich J. P."><given-names>J. P.</given-names> <surname>Radich</surname></string-name>, <string-name name-style="western" hwp:sortable="Mikkelsen T. S."><given-names>T. S.</given-names> <surname>Mikkelsen</surname></string-name>, <string-name name-style="western" hwp:sortable="Hindson B. J."><given-names>B. J.</given-names> <surname>Hindson</surname></string-name>, and <string-name name-style="western" hwp:sortable="Bielas J. H."><given-names>J. H.</given-names> <surname>Bielas</surname></string-name>, “<article-title hwp:id="article-title-80">Massively parallel digital transcriptional profiling of single cells</article-title>,” <source hwp:id="source-85">Nature Communications</source>, vol. <volume>8</volume>, p. <fpage>14049</fpage>, <year>2017</year>.</citation></ref><ref id="c90" hwp:id="ref-90" hwp:rev-id="xref-ref-90-1"><label>[90]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.90" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-90"><string-name name-style="western" hwp:sortable="Grün D."><given-names>D.</given-names> <surname>Grün</surname></string-name>, <string-name name-style="western" hwp:sortable="Kester L."><given-names>L.</given-names> <surname>Kester</surname></string-name>, and <string-name name-style="western" hwp:sortable="Van Oudenaarden A."><given-names>A.</given-names> <surname>Van Oudenaarden</surname></string-name>, “<article-title hwp:id="article-title-81">Validation of noise models for single-cell transcriptomics</article-title>,” <source hwp:id="source-86">Nature methods</source>, vol. <volume>11</volume>, no. <issue>6</issue>, pp. <fpage>637</fpage>–<lpage>640</lpage>, <year>2014</year>.</citation></ref><ref id="c91" hwp:id="ref-91" hwp:rev-id="xref-ref-91-1 xref-ref-91-2"><label>[91]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.91" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-91"><string-name name-style="western" hwp:sortable="Balasubramanian M."><given-names>M.</given-names> <surname>Balasubramanian</surname></string-name> and <string-name name-style="western" hwp:sortable="Schwartz E. L."><given-names>E. L.</given-names> <surname>Schwartz</surname></string-name>, “<article-title hwp:id="article-title-82">The isomap algorithm and topological stability</article-title>,” <source hwp:id="source-87">Science</source>, vol. <volume>295</volume>, no. <issue>5552</issue>, pp. <fpage>7</fpage>–<lpage>7</lpage>, <year>2002</year>.</citation></ref><ref id="c92" hwp:id="ref-92" hwp:rev-id="xref-ref-92-1 xref-ref-92-2"><label>[92]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.92" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-92"><string-name name-style="western" hwp:sortable="van Dijk D."><given-names>D.</given-names> <surname>van Dijk</surname></string-name>, <string-name name-style="western" hwp:sortable="Sharma R."><given-names>R.</given-names> <surname>Sharma</surname></string-name>, <string-name name-style="western" hwp:sortable="Nainys J."><given-names>J.</given-names> <surname>Nainys</surname></string-name>, <string-name name-style="western" hwp:sortable="Yim K."><given-names>K.</given-names> <surname>Yim</surname></string-name>, <string-name name-style="western" hwp:sortable="Kathail P."><given-names>P.</given-names> <surname>Kathail</surname></string-name>, <string-name name-style="western" hwp:sortable="Carr A. J."><given-names>A. J.</given-names> <surname>Carr</surname></string-name>, <string-name name-style="western" hwp:sortable="Burdziak C."><given-names>C.</given-names> <surname>Burdziak</surname></string-name>, <string-name name-style="western" hwp:sortable="Moon K. R."><given-names>K. R.</given-names> <surname>Moon</surname></string-name>, <string-name name-style="western" hwp:sortable="Chaffer C. L."><given-names>C. L.</given-names> <surname>Chaffer</surname></string-name>, <string-name name-style="western" hwp:sortable="Pattabiraman D."><given-names>D.</given-names> <surname>Pattabiraman</surname></string-name>, <string-name name-style="western" hwp:sortable="Bierie B."><given-names>B.</given-names> <surname>Bierie</surname></string-name>, <string-name name-style="western" hwp:sortable="Mazutis L."><given-names>L.</given-names> <surname>Mazutis</surname></string-name>, <string-name name-style="western" hwp:sortable="Wolf G."><given-names>G.</given-names> <surname>Wolf</surname></string-name>, <string-name name-style="western" hwp:sortable="Krishnaswamy S."><given-names>S.</given-names> <surname>Krishnaswamy</surname></string-name>, and <string-name name-style="western" hwp:sortable="Pe’er D."><given-names>D.</given-names> <surname>Pe’er</surname></string-name>, “<article-title hwp:id="article-title-83">Recovering gene interactions from single-cell data using data diffusion</article-title>,” <source hwp:id="source-88">Cell</source>, vol. <volume>174</volume>, no. <issue>3</issue>, pp. <fpage>716</fpage>–<lpage>729.e27</lpage>, <year>2018</year>.</citation></ref><ref id="c93" hwp:id="ref-93"><label>[93]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.93" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-93"><string-name name-style="western" hwp:sortable="Vieth B."><given-names>B.</given-names> <surname>Vieth</surname></string-name>, <string-name name-style="western" hwp:sortable="Ziegenhain C."><given-names>C.</given-names> <surname>Ziegenhain</surname></string-name>, <string-name name-style="western" hwp:sortable="Parekh S."><given-names>S.</given-names> <surname>Parekh</surname></string-name>, <string-name name-style="western" hwp:sortable="Enard W."><given-names>W.</given-names> <surname>Enard</surname></string-name>, and <string-name name-style="western" hwp:sortable="Hellmann I."><given-names>I.</given-names> <surname>Hellmann</surname></string-name>, “<article-title hwp:id="article-title-84">powsimr: power analysis for bulk and single cell rna-seq experiments</article-title>,” <source hwp:id="source-89">Bioinformatics</source>, vol. <volume>33</volume>, no. <issue>21</issue>, pp. <fpage>3486</fpage>–<lpage>3488</lpage>, <year>2017</year>.</citation></ref><ref id="c94" hwp:id="ref-94"><label>[94]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.94" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-94"><string-name name-style="western" hwp:sortable="Brennecke P."><given-names>P.</given-names> <surname>Brennecke</surname></string-name>, <string-name name-style="western" hwp:sortable="Anders S."><given-names>S.</given-names> <surname>Anders</surname></string-name>, <string-name name-style="western" hwp:sortable="Kim J. K."><given-names>J. K.</given-names> <surname>Kim</surname></string-name>, <string-name name-style="western" hwp:sortable="Kołodziejczyk A. A."><given-names>A. A.</given-names> <surname>Kołodziejczyk</surname></string-name>, <string-name name-style="western" hwp:sortable="Zhang X."><given-names>X.</given-names> <surname>Zhang</surname></string-name>, <string-name name-style="western" hwp:sortable="Proserpio V."><given-names>V.</given-names> <surname>Proserpio</surname></string-name>, <string-name name-style="western" hwp:sortable="Baying B."><given-names>B.</given-names> <surname>Baying</surname></string-name>, <string-name name-style="western" hwp:sortable="Benes V."><given-names>V.</given-names> <surname>Benes</surname></string-name>, <string-name name-style="western" hwp:sortable="Teichmann S. A."><given-names>S. A.</given-names> <surname>Teichmann</surname></string-name>, <string-name name-style="western" hwp:sortable="Marioni J. C."><given-names>J. C.</given-names> <surname>Marioni</surname></string-name>, <etal>et al.,</etal> “<article-title hwp:id="article-title-85">Accounting for technical noise in single-cell rna-seq experiments</article-title>,” <source hwp:id="source-90">Nature methods</source>, vol. <volume>10</volume>, no. <issue>11</issue>, p. <fpage>1093</fpage>, <year>2013</year>.</citation></ref><ref id="c95" hwp:id="ref-95"><label>[95]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.95" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-95"><string-name name-style="western" hwp:sortable="Hwang B."><given-names>B.</given-names> <surname>Hwang</surname></string-name>, <string-name name-style="western" hwp:sortable="Lee J. H."><given-names>J. H.</given-names> <surname>Lee</surname></string-name>, and <string-name name-style="western" hwp:sortable="Bang D."><given-names>D.</given-names> <surname>Bang</surname></string-name>, “<article-title hwp:id="article-title-86">Single-cell rna sequencing technologies and bioinformatics pipelines</article-title>,” <source hwp:id="source-91">Experimental &amp; molecular medicine</source>, vol. <volume>50</volume>, no. <issue>8</issue>, p. <fpage>96</fpage>, <year>2018</year>.</citation></ref><ref id="c96" hwp:id="ref-96" hwp:rev-id="xref-ref-96-1"><label>[96]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.96" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-96"><string-name name-style="western" hwp:sortable="Kim J. K."><given-names>J. K.</given-names> <surname>Kim</surname></string-name>, <string-name name-style="western" hwp:sortable="Kolodziejczyk A. A."><given-names>A. A.</given-names> <surname>Kolodziejczyk</surname></string-name>, <string-name name-style="western" hwp:sortable="Ilicic T."><given-names>T.</given-names> <surname>Ilicic</surname></string-name>, <string-name name-style="western" hwp:sortable="Teichmann S. A."><given-names>S. A.</given-names> <surname>Teichmann</surname></string-name>, and <string-name name-style="western" hwp:sortable="Marioni J. C."><given-names>J. C.</given-names> <surname>Marioni</surname></string-name>, “<article-title hwp:id="article-title-87">Characterizing noise structure in single-cell rna-seq distinguishes genuine from technical stochastic allelic expression</article-title>,” <source hwp:id="source-92">Nature communications</source>, vol. <volume>6</volume>, p. <fpage>8687</fpage>, <year>2015</year>.</citation></ref><ref id="c97" hwp:id="ref-97" hwp:rev-id="xref-ref-97-1"><label>[97]</label><citation publication-type="confproc" citation-type="confproc" ref:id="120378v4.97" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-97"><string-name name-style="western" hwp:sortable="Weinberger K. Q."><given-names>K. Q.</given-names> <surname>Weinberger</surname></string-name>, <string-name name-style="western" hwp:sortable="Sha F."><given-names>F.</given-names> <surname>Sha</surname></string-name>, and <string-name name-style="western" hwp:sortable="Saul L. K."><given-names>L. K.</given-names> <surname>Saul</surname></string-name>, “<article-title hwp:id="article-title-88">Learning a kernel matrix for nonlinear dimensionality reduction</article-title>,” in <conf-name>Proceedings of the twenty-first international conference on Machine learning</conf-name>, p. <fpage>106</fpage>, ACM, <year>2004</year>.</citation></ref><ref id="c98" hwp:id="ref-98" hwp:rev-id="xref-ref-98-1"><label>[98]</label><citation publication-type="book" citation-type="book" ref:id="120378v4.98" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-98"><string-name name-style="western" hwp:sortable="Nene S. A."><given-names>S. A.</given-names> <surname>Nene</surname></string-name>, <string-name name-style="western" hwp:sortable="Nayar S. K."><given-names>S. K.</given-names> <surname>Nayar</surname></string-name>, and <string-name name-style="western" hwp:sortable="Murase H."><given-names>H.</given-names> <surname>Murase</surname></string-name>, “<chapter-title>Columbia object image library (COIL-20)</chapter-title>,” <source hwp:id="source-93">Tech. Rep. CUCS-005-96</source>, <publisher-name>Columbia University</publisher-name>, <year>1996</year>.</citation></ref><ref id="c99" hwp:id="ref-99" hwp:rev-id="xref-ref-99-1"><label>[99]</label><citation publication-type="website" citation-type="web" ref:id="120378v4.99" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-99"><string-name name-style="western" hwp:sortable="LeCun Y."><given-names>Y.</given-names> <surname>LeCun</surname></string-name>, “<article-title hwp:id="article-title-89">The mnist database of handwritten digits</article-title>,” <ext-link l:rel="related" l:ref-type="uri" l:ref="http://yann.lecun.com/exdb/mnist/" ext-link-type="uri" xlink:href="http://yann.lecun.com/exdb/mnist/" hwp:id="ext-link-2">http://yann.lecun.com/exdb/mnist/</ext-link>, <year>1998</year>.</citation></ref><ref id="c100" hwp:id="ref-100" hwp:rev-id="xref-ref-100-1"><label>[100]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.100" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-100"><string-name name-style="western" hwp:sortable="Haber A. L."><given-names>A. L.</given-names> <surname>Haber</surname></string-name>, <string-name name-style="western" hwp:sortable="Biton M."><given-names>M.</given-names> <surname>Biton</surname></string-name>, <string-name name-style="western" hwp:sortable="Rogel N."><given-names>N.</given-names> <surname>Rogel</surname></string-name>, <string-name name-style="western" hwp:sortable="Herbst R. H."><given-names>R. H.</given-names> <surname>Herbst</surname></string-name>, <string-name name-style="western" hwp:sortable="Shekhar K."><given-names>K.</given-names> <surname>Shekhar</surname></string-name>, <string-name name-style="western" hwp:sortable="Smillie C."><given-names>C.</given-names> <surname>Smillie</surname></string-name>, <string-name name-style="western" hwp:sortable="Burgin G."><given-names>G.</given-names> <surname>Burgin</surname></string-name>, <string-name name-style="western" hwp:sortable="Delorey T. M."><given-names>T. M.</given-names> <surname>Delorey</surname></string-name>, <string-name name-style="western" hwp:sortable="Howitt M. R."><given-names>M. R.</given-names> <surname>Howitt</surname></string-name>, <string-name name-style="western" hwp:sortable="Katz Y."><given-names>Y.</given-names> <surname>Katz</surname></string-name>, <etal>et al.,</etal> “<article-title hwp:id="article-title-90">A single-cell survey of the small intestinal epithelium</article-title>,” <source hwp:id="source-94">Nature</source>, vol. <volume>551</volume>, no. <issue>7680</issue>, p. <fpage>333</fpage>, <year>2017</year>.</citation></ref><ref id="c101" hwp:id="ref-101" hwp:rev-id="xref-ref-101-1"><label>[101]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.101" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-101"><string-name name-style="western" hwp:sortable="Saelens W."><given-names>W.</given-names> <surname>Saelens</surname></string-name>, <string-name name-style="western" hwp:sortable="Cannoodt R."><given-names>R.</given-names> <surname>Cannoodt</surname></string-name>, <string-name name-style="western" hwp:sortable="Todorov H."><given-names>H.</given-names> <surname>Todorov</surname></string-name>, and <string-name name-style="western" hwp:sortable="Saeys Y."><given-names>Y.</given-names> <surname>Saeys</surname></string-name>, “<article-title hwp:id="article-title-91">A comparison of single-cell trajectory inference methods: towards more accurate and robust tools</article-title>,” <source hwp:id="source-95">bioRxiv</source>, p. <fpage>276907</fpage>, <year>2018</year>.</citation></ref><ref id="c102" hwp:id="ref-102" hwp:rev-id="xref-ref-102-1 xref-ref-102-2 xref-ref-102-3"><label>[102]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.102" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-102"><string-name name-style="western" hwp:sortable="Qiu P."><given-names>P.</given-names> <surname>Qiu</surname></string-name>, <string-name name-style="western" hwp:sortable="Simonds E. F."><given-names>E. F.</given-names> <surname>Simonds</surname></string-name>, <string-name name-style="western" hwp:sortable="Bendall S. C."><given-names>S. C.</given-names> <surname>Bendall</surname></string-name>, <string-name name-style="western" hwp:sortable="Gibbs K. D. Jr"><given-names>K. D.</given-names> <surname>Gibbs</surname> <suffix>Jr</suffix></string-name>, <string-name name-style="western" hwp:sortable="Bruggner R. V."><given-names>R. V.</given-names> <surname>Bruggner</surname></string-name>, <string-name name-style="western" hwp:sortable="Linderman M. D."><given-names>M. D.</given-names> <surname>Linderman</surname></string-name>, <string-name name-style="western" hwp:sortable="Sachs K."><given-names>K.</given-names> <surname>Sachs</surname></string-name>, <string-name name-style="western" hwp:sortable="Nolan G. P."><given-names>G. P.</given-names> <surname>Nolan</surname></string-name>, and <string-name name-style="western" hwp:sortable="Plevritis S. K."><given-names>S. K.</given-names> <surname>Plevritis</surname></string-name>, “<article-title hwp:id="article-title-92">Extracting a cellular hierarchy from highdimensional cytometry data with spade</article-title>,” <source hwp:id="source-96">Nature biotechnology</source>, vol. <volume>29</volume>, no. <issue>10</issue>, pp. <fpage>886</fpage>–<lpage>891</lpage>, <year>2011</year>.</citation></ref><ref id="c103" hwp:id="ref-103" hwp:rev-id="xref-ref-103-1 xref-ref-103-2 xref-ref-103-3 xref-ref-103-4 xref-ref-103-5 xref-ref-103-6"><label>[103]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.103" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-103"><string-name name-style="western" hwp:sortable="Anchang B."><given-names>B.</given-names> <surname>Anchang</surname></string-name>, <string-name name-style="western" hwp:sortable="Hart T. D."><given-names>T. D.</given-names> <surname>Hart</surname></string-name>, <string-name name-style="western" hwp:sortable="Bendall S. C."><given-names>S. C.</given-names> <surname>Bendall</surname></string-name>, <string-name name-style="western" hwp:sortable="Qiu P."><given-names>P.</given-names> <surname>Qiu</surname></string-name>, <string-name name-style="western" hwp:sortable="Bjornson Z."><given-names>Z.</given-names> <surname>Bjornson</surname></string-name>, <string-name name-style="western" hwp:sortable="Linderman M."><given-names>M.</given-names> <surname>Linderman</surname></string-name>, <string-name name-style="western" hwp:sortable="Nolan G. P."><given-names>G. P.</given-names> <surname>Nolan</surname></string-name>, and <string-name name-style="western" hwp:sortable="Plevritis S. K."><given-names>S. K.</given-names> <surname>Plevritis</surname></string-name>, “<article-title hwp:id="article-title-93">Visualization and cellular hierarchy inference of single-cell data using spade</article-title>,” <source hwp:id="source-97">Nature protocols</source>, vol. <volume>11</volume>, no. <issue>7</issue>, pp. <fpage>1264</fpage>–<lpage>1280</lpage>, <year>2016</year>.</citation></ref><ref id="c104" hwp:id="ref-104" hwp:rev-id="xref-ref-104-1"><label>[104]</label><citation publication-type="other" citation-type="journal" ref:id="120378v4.104" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-104"><string-name name-style="western" hwp:sortable="Wattenberg M."><given-names>M.</given-names> <surname>Wattenberg</surname></string-name>, <string-name name-style="western" hwp:sortable="Viégas F."><given-names>F.</given-names> <surname>Viégas</surname></string-name>, and <string-name name-style="western" hwp:sortable="Johnson I."><given-names>I.</given-names> <surname>Johnson</surname></string-name>, “<article-title hwp:id="article-title-94">How to use t-sne effectively</article-title>,” <source hwp:id="source-98">Distill</source>, <year>2016</year>.</citation></ref><ref id="c105" hwp:id="ref-105" hwp:rev-id="xref-ref-105-1"><label>[105]</label><citation publication-type="book" citation-type="book" ref:id="120378v4.105" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-105"><string-name name-style="western" hwp:sortable="Kruskal J. B."><given-names>J. B.</given-names> <surname>Kruskal</surname></string-name> and <string-name name-style="western" hwp:sortable="Wish M."><given-names>M.</given-names> <surname>Wish</surname></string-name>, <source hwp:id="source-99">Multidimensional Scaling</source>, vol. <volume>11</volume>. <publisher-name>Sage</publisher-name>, <year>1978</year>.</citation></ref><ref id="c106" hwp:id="ref-106" hwp:rev-id="xref-ref-106-1"><label>[106]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.106" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-106"><string-name name-style="western" hwp:sortable="Dijkstra E. W."><given-names>E. W.</given-names> <surname>Dijkstra</surname></string-name>, “<article-title hwp:id="article-title-95">A note on two problems in connexion with graphs</article-title>,” <source hwp:id="source-100">Numerische mathematik</source>, vol. <volume>1</volume>, no. <issue>1</issue>, pp. <fpage>269</fpage>–<lpage>271</lpage>, <year>1959</year>.</citation></ref><ref id="c107" hwp:id="ref-107" hwp:rev-id="xref-ref-107-1"><label>[107]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.107" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-107"><string-name name-style="western" hwp:sortable="Floyd R. W."><given-names>R. W.</given-names> <surname>Floyd</surname></string-name>, “<article-title hwp:id="article-title-96">Algorithm 97: shortest path</article-title>,” <source hwp:id="source-101">Communications of the ACM</source>, vol. <volume>5</volume>, no. <issue>6</issue>, p. <fpage>345</fpage>, <year>1962</year>.</citation></ref><ref id="c108" hwp:id="ref-108" hwp:rev-id="xref-ref-108-1"><label>[108]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.108" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-108"><string-name name-style="western" hwp:sortable="Lee J. A."><given-names>J. A.</given-names> <surname>Lee</surname></string-name> and <string-name name-style="western" hwp:sortable="Verleysen M."><given-names>M.</given-names> <surname>Verleysen</surname></string-name>, “<article-title hwp:id="article-title-97">Nonlinear dimensionality reduction of data manifolds with essential loops</article-title>,” <source hwp:id="source-102">Neurocomputing</source>, vol. <volume>67</volume>, pp. <fpage>29</fpage>–<lpage>53</lpage>, <year>2005</year>.</citation></ref><ref id="c109" hwp:id="ref-109" hwp:rev-id="xref-ref-109-1"><label>[109]</label><citation publication-type="confproc" citation-type="confproc" ref:id="120378v4.109" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-109"><string-name name-style="western" hwp:sortable="Lim I. S."><given-names>I. S.</given-names> <surname>Lim</surname></string-name>, <string-name name-style="western" hwp:sortable="de Heras Ciechomski P."><given-names>P.</given-names> <surname>de Heras Ciechomski</surname></string-name>, <string-name name-style="western" hwp:sortable="Sarni S."><given-names>S.</given-names> <surname>Sarni</surname></string-name>, and <string-name name-style="western" hwp:sortable="Thalmann D."><given-names>D.</given-names> <surname>Thalmann</surname></string-name>, “<article-title hwp:id="article-title-98">Planar arrangement of high-dimensional biomedical data sets by isomap coordinates</article-title>,” in <source hwp:id="source-103">Computer-Based Medical Systems</source>, 2003. <conf-name>Proceedings. 16th IEEE Symposium</conf-name>, pp. <fpage>50</fpage>–<lpage>55</lpage>, IEEE, <year>2003</year>.</citation></ref><ref id="c110" hwp:id="ref-110" hwp:rev-id="xref-ref-110-1"><label>[110]</label><citation publication-type="confproc" citation-type="confproc" ref:id="120378v4.110" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-110"><string-name name-style="western" hwp:sortable="Hagberg A. A."><given-names>A. A.</given-names> <surname>Hagberg</surname></string-name>, <string-name name-style="western" hwp:sortable="Schult D. A."><given-names>D. A.</given-names> <surname>Schult</surname></string-name>, and <string-name name-style="western" hwp:sortable="Swart P. J."><given-names>P. J.</given-names> <surname>Swart</surname></string-name>, “<chapter-title>Exploring network structure, dynamics, and function using NetworkX</chapter-title>,” in <conf-name>Proceedings of the 7th Python in Science Conference (SciPy 2008)</conf-name> (<person-group person-group-type="editor" hwp:id="person-group-1"><string-name name-style="western" hwp:sortable="Varoquaux G."><given-names>G.</given-names> <surname>Varoquaux</surname></string-name>, <string-name name-style="western" hwp:sortable="Vaught T."><given-names>T.</given-names> <surname>Vaught</surname></string-name>, and <string-name name-style="western" hwp:sortable="Millman J."><given-names>J.</given-names> <surname>Millman</surname></string-name></person-group>, eds.), (<publisher-name>Pasadena</publisher-name>, <publisher-loc>CA USA</publisher-loc>), pp. <fpage>11</fpage>–<lpage>15</lpage>, <year>2008</year>.</citation></ref><ref id="c111" hwp:id="ref-111" hwp:rev-id="xref-ref-111-1"><label>[111]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.111" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-111"><string-name name-style="western" hwp:sortable="Fruchterman T. M."><given-names>T. M.</given-names> <surname>Fruchterman</surname></string-name> and <string-name name-style="western" hwp:sortable="Reingold E. M."><given-names>E. M.</given-names> <surname>Reingold</surname></string-name>, “<article-title hwp:id="article-title-99">Graph drawing by force-directed placement</article-title>,” <source hwp:id="source-104">Software: Practice and experience</source>, vol. <volume>21</volume>, no. <issue>11</issue>, pp. <fpage>1129</fpage>–<lpage>1164</lpage>, <year>1991</year>.</citation></ref><ref id="c112" hwp:id="ref-112" hwp:rev-id="xref-ref-112-1"><label>[112]</label><citation publication-type="confproc" citation-type="confproc" ref:id="120378v4.112" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-112"><string-name name-style="western" hwp:sortable="Mao Q."><given-names>Q.</given-names> <surname>Mao</surname></string-name>, <string-name name-style="western" hwp:sortable="Wang L."><given-names>L.</given-names> <surname>Wang</surname></string-name>, <string-name name-style="western" hwp:sortable="Goodison S."><given-names>S.</given-names> <surname>Goodison</surname></string-name>, and <string-name name-style="western" hwp:sortable="Sun Y."><given-names>Y.</given-names> <surname>Sun</surname></string-name>, “<article-title hwp:id="article-title-100">Dimensionality reduction via graph structure learning</article-title>,” in <conf-name>Proceedings of the 21th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</conf-name>, pp. <fpage>765</fpage>–<lpage>774</lpage>, ACM, <year>2015</year>.</citation></ref><ref id="c113" hwp:id="ref-113" hwp:rev-id="xref-ref-113-1"><label>[113]</label><citation publication-type="other" citation-type="journal" ref:id="120378v4.113" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-113"><string-name name-style="western" hwp:sortable="Mao Q."><given-names>Q.</given-names> <surname>Mao</surname></string-name>, <string-name name-style="western" hwp:sortable="Wang L."><given-names>L.</given-names> <surname>Wang</surname></string-name>, <string-name name-style="western" hwp:sortable="Tsang I."><given-names>I.</given-names> <surname>Tsang</surname></string-name>, and <string-name name-style="western" hwp:sortable="Sun Y."><given-names>Y.</given-names> <surname>Sun</surname></string-name>, “<article-title hwp:id="article-title-101">Principal graph and structure learning based on reversed graph embedding</article-title>,” <source hwp:id="source-105">IEEE transactions on pattern analysis and machine intelligence</source>, <year>2016</year>.</citation></ref><ref id="c114" hwp:id="ref-114" hwp:rev-id="xref-ref-114-1"><label>[114]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.114" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-114"><string-name name-style="western" hwp:sortable="Yang H.-Y."><given-names>H.-Y.</given-names> <surname>Yang</surname></string-name>, <string-name name-style="western" hwp:sortable="Jeong D. K."><given-names>D. K.</given-names> <surname>Jeong</surname></string-name>, <string-name name-style="western" hwp:sortable="Kim S.-H."><given-names>S.-H.</given-names> <surname>Kim</surname></string-name>, <string-name name-style="western" hwp:sortable="Chung K.-J."><given-names>K.-J.</given-names> <surname>Chung</surname></string-name>, <string-name name-style="western" hwp:sortable="Cho E.-J."><given-names>E.-J.</given-names> <surname>Cho</surname></string-name>, <string-name name-style="western" hwp:sortable="Jin C. H."><given-names>C. H.</given-names> <surname>Jin</surname></string-name>, <string-name name-style="western" hwp:sortable="Yang U."><given-names>U.</given-names> <surname>Yang</surname></string-name>, <string-name name-style="western" hwp:sortable="Lee S. R."><given-names>S. R.</given-names> <surname>Lee</surname></string-name>, <string-name name-style="western" hwp:sortable="Lee D.-S."><given-names>D.-S.</given-names> <surname>Lee</surname></string-name>, and <string-name name-style="western" hwp:sortable="Lee T.-H."><given-names>T.-H.</given-names> <surname>Lee</surname></string-name>, “<article-title hwp:id="article-title-102">Gene expression profiling related to the enhanced erythropoiesis in mouse bone marrow cells</article-title>,” <source hwp:id="source-106">Journal of cellular biochemistry</source>, vol. <volume>104</volume>, no. <issue>1</issue>, pp. <fpage>295</fpage>–<lpage>303</lpage>, <year>2008</year>.</citation></ref><ref id="c115" hwp:id="ref-115"><label>[115]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.115" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-115"><string-name name-style="western" hwp:sortable="Crispino J. D."><given-names>J. D.</given-names> <surname>Crispino</surname></string-name>, “<article-title hwp:id="article-title-103">Gata1 in normal and malignant hematopoiesis</article-title>,” <source hwp:id="source-107">Seminars in cell &amp; developmental biology</source>, vol. <volume>16</volume>, no. <issue>1</issue>, pp. <fpage>137</fpage>–<lpage>147</lpage>, <year>2005</year>.</citation></ref><ref id="c116" hwp:id="ref-116"><label>[116]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.116" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-116"><string-name name-style="western" hwp:sortable="Fujiwara Y."><given-names>Y.</given-names> <surname>Fujiwara</surname></string-name>, <string-name name-style="western" hwp:sortable="Browne C. P."><given-names>C. P.</given-names> <surname>Browne</surname></string-name>, <string-name name-style="western" hwp:sortable="Cunniff K."><given-names>K.</given-names> <surname>Cunniff</surname></string-name>, <string-name name-style="western" hwp:sortable="Goff S. C."><given-names>S. C.</given-names> <surname>Goff</surname></string-name>, and <string-name name-style="western" hwp:sortable="Orkin S. H."><given-names>S. H.</given-names> <surname>Orkin</surname></string-name>, “<article-title hwp:id="article-title-104">Arrested development of embryonic red cell precursors in mouse embryos lacking transcription factor gata-1</article-title>,” <source hwp:id="source-108">Proceedings of the National Academy of Sciences</source>, vol. <volume>93</volume>, no. <issue>22</issue>, pp. <fpage>12355</fpage>–<lpage>12358</lpage>, <year>1996</year>.</citation></ref><ref id="c117" hwp:id="ref-117"><label>[117]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.117" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-117"><string-name name-style="western" hwp:sortable="Pevny L."><given-names>L.</given-names> <surname>Pevny</surname></string-name>, <string-name name-style="western" hwp:sortable="Simon M. C."><given-names>M. C.</given-names> <surname>Simon</surname></string-name>, <etal>et al.,</etal> “<article-title hwp:id="article-title-105">Erythroid differentiation in chimaeric mice blocked by a targeted mutation in the gene for transcription factor gata-1</article-title>,” <source hwp:id="source-109">Nature</source>, vol. <volume>349</volume>, no. <issue>6306</issue>, p. <fpage>257</fpage>, <year>1991</year>.</citation></ref><ref id="c118" hwp:id="ref-118"><label>[118]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.118" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-118"><string-name name-style="western" hwp:sortable="Fiolka K."><given-names>K.</given-names> <surname>Fiolka</surname></string-name>, <string-name name-style="western" hwp:sortable="Hertzano R."><given-names>R.</given-names> <surname>Hertzano</surname></string-name>, <string-name name-style="western" hwp:sortable="Vassen L."><given-names>L.</given-names> <surname>Vassen</surname></string-name>, <string-name name-style="western" hwp:sortable="Zeng H."><given-names>H.</given-names> <surname>Zeng</surname></string-name>, <string-name name-style="western" hwp:sortable="Hermesh O."><given-names>O.</given-names> <surname>Hermesh</surname></string-name>, <string-name name-style="western" hwp:sortable="Avraham K. B."><given-names>K. B.</given-names> <surname>Avraham</surname></string-name>, <string-name name-style="western" hwp:sortable="Dührsen U."><given-names>U.</given-names> <surname>Dührsen</surname></string-name>, and <string-name name-style="western" hwp:sortable="Möröy T."><given-names>T.</given-names> <surname>Möröy</surname></string-name>, “<article-title hwp:id="article-title-106">Gfi1 and gfi1b act equivalently in haematopoiesis, but have distinct, nonoverlapping functions in inner ear development</article-title>,” <source hwp:id="source-110">EMBO reports</source>, vol. <volume>7</volume>, no. <issue>3</issue>, pp. <fpage>326</fpage>–<lpage>333</lpage>, <year>2006</year>.</citation></ref><ref id="c119" hwp:id="ref-119"><label>[119]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.119" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-119"><string-name name-style="western" hwp:sortable="Van der Meer L."><given-names>L.</given-names> <surname>Van der Meer</surname></string-name>, <string-name name-style="western" hwp:sortable="Jansen J."><given-names>J.</given-names> <surname>Jansen</surname></string-name>, and <string-name name-style="western" hwp:sortable="Van Der Reijden B."><given-names>B.</given-names> <surname>Van Der Reijden</surname></string-name>, “<article-title hwp:id="article-title-107">Gfi1 and gfi1b: key regulators of hematopoiesis</article-title>,” <source hwp:id="source-111">Leukemia</source>, vol. <volume>24</volume>, no. <issue>11</issue>, pp. <fpage>1834</fpage>–<lpage>1843</lpage>, <year>2010</year>.</citation></ref><ref id="c120" hwp:id="ref-120" hwp:rev-id="xref-ref-120-1"><label>[120]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.120" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-120"><string-name name-style="western" hwp:sortable="Yang H.-Y."><given-names>H.-Y.</given-names> <surname>Yang</surname></string-name>, <string-name name-style="western" hwp:sortable="Kim S. H."><given-names>S. H.</given-names> <surname>Kim</surname></string-name>, <string-name name-style="western" hwp:sortable="Kim S.-H."><given-names>S.-H.</given-names> <surname>Kim</surname></string-name>, <string-name name-style="western" hwp:sortable="Kim D.-J."><given-names>D.-J.</given-names> <surname>Kim</surname></string-name>, <string-name name-style="western" hwp:sortable="Kim S.-U."><given-names>S.-U.</given-names> <surname>Kim</surname></string-name>, <string-name name-style="western" hwp:sortable="Yu D.-Y."><given-names>D.-Y.</given-names> <surname>Yu</surname></string-name>, <string-name name-style="western" hwp:sortable="Yeom Y. I."><given-names>Y. I.</given-names> <surname>Yeom</surname></string-name>, <string-name name-style="western" hwp:sortable="Lee D.-S."><given-names>D.-S.</given-names> <surname>Lee</surname></string-name>, <string-name name-style="western" hwp:sortable="Kim Y.-J."><given-names>Y.-J.</given-names> <surname>Kim</surname></string-name>, <string-name name-style="western" hwp:sortable="Park B.-J."><given-names>B.-J.</given-names> <surname>Park</surname></string-name>, <etal>et al.,</etal> “<article-title hwp:id="article-title-108">The suppression of zfpm-1 accelerates the erythropoietic differentiation of human cd34+ cells</article-title>,” <source hwp:id="source-112">Biochemical and biophysical research communications</source>, vol. <volume>353</volume>, no. <issue>4</issue>, pp. <fpage>978</fpage>–<lpage>984</lpage>, <year>2007</year>.</citation></ref><ref id="c121" hwp:id="ref-121" hwp:rev-id="xref-ref-121-1"><label>[121]</label><citation publication-type="other" citation-type="journal" ref:id="120378v4.121" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-121"><string-name name-style="western" hwp:sortable="Silverman J. D."><given-names>J. D.</given-names> <surname>Silverman</surname></string-name>, <string-name name-style="western" hwp:sortable="Washburne A."><given-names>A.</given-names> <surname>Washburne</surname></string-name>, <string-name name-style="western" hwp:sortable="Mukherjee S."><given-names>S.</given-names> <surname>Mukherjee</surname></string-name>, and <string-name name-style="western" hwp:sortable="David L. A."><given-names>L. A.</given-names> <surname>David</surname></string-name>, “<article-title hwp:id="article-title-109">A phylogenetic transform enhances analysis of compositional microbiota data</article-title>,” <source hwp:id="source-113">eLife</source>, <year>2017</year>.</citation></ref><ref id="c122" hwp:id="ref-122" hwp:rev-id="xref-ref-122-1"><label>[122]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.122" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-122"><string-name name-style="western" hwp:sortable="Arumugam M."><given-names>M.</given-names> <surname>Arumugam</surname></string-name>, <string-name name-style="western" hwp:sortable="Raes J."><given-names>J.</given-names> <surname>Raes</surname></string-name>, <string-name name-style="western" hwp:sortable="Pelletier E."><given-names>E.</given-names> <surname>Pelletier</surname></string-name>, <string-name name-style="western" hwp:sortable="Le Paslier D."><given-names>D.</given-names> <surname>Le Paslier</surname></string-name>, <string-name name-style="western" hwp:sortable="Yamada T."><given-names>T.</given-names> <surname>Yamada</surname></string-name>, <string-name name-style="western" hwp:sortable="Mende D. R."><given-names>D. R.</given-names> <surname>Mende</surname></string-name>, <string-name name-style="western" hwp:sortable="Fernandes G. R."><given-names>G. R.</given-names> <surname>Fernandes</surname></string-name>, <string-name name-style="western" hwp:sortable="Tap J."><given-names>J.</given-names> <surname>Tap</surname></string-name>, <string-name name-style="western" hwp:sortable="Bruls T."><given-names>T.</given-names> <surname>Bruls</surname></string-name>, <string-name name-style="western" hwp:sortable="Batto J.-M."><given-names>J.-M.</given-names> <surname>Batto</surname></string-name>, <string-name name-style="western" hwp:sortable="Bertalan M."><given-names>M.</given-names> <surname>Bertalan</surname></string-name>, <string-name name-style="western" hwp:sortable="Borruel N."><given-names>N.</given-names> <surname>Borruel</surname></string-name>, <string-name name-style="western" hwp:sortable="Casellas F."><given-names>F.</given-names> <surname>Casellas</surname></string-name>, <string-name name-style="western" hwp:sortable="Fernandez L."><given-names>L.</given-names> <surname>Fernandez</surname></string-name>, <string-name name-style="western" hwp:sortable="Gautier L."><given-names>L.</given-names> <surname>Gautier</surname></string-name>, <string-name name-style="western" hwp:sortable="Hansen T."><given-names>T.</given-names> <surname>Hansen</surname></string-name>, <string-name name-style="western" hwp:sortable="Hattori M."><given-names>M.</given-names> <surname>Hattori</surname></string-name>, <string-name name-style="western" hwp:sortable="Hayashi T."><given-names>T.</given-names> <surname>Hayashi</surname></string-name>, <string-name name-style="western" hwp:sortable="Kleerebezem M."><given-names>M.</given-names> <surname>Kleerebezem</surname></string-name>, <string-name name-style="western" hwp:sortable="Kurokawa K."><given-names>K.</given-names> <surname>Kurokawa</surname></string-name>, <string-name name-style="western" hwp:sortable="Leclerc M."><given-names>M.</given-names> <surname>Leclerc</surname></string-name>, <string-name name-style="western" hwp:sortable="Levenez F."><given-names>F.</given-names> <surname>Levenez</surname></string-name>, <string-name name-style="western" hwp:sortable="Manichanh C."><given-names>C.</given-names> <surname>Manichanh</surname></string-name>, <string-name name-style="western" hwp:sortable="Nielsen H."><given-names>H.</given-names> <surname>Nielsen</surname></string-name>, <string-name name-style="western" hwp:sortable="Nielsen T."><given-names>T.</given-names> <surname>Nielsen</surname></string-name>, <string-name name-style="western" hwp:sortable="Pons N."><given-names>N.</given-names> <surname>Pons</surname></string-name>, <string-name name-style="western" hwp:sortable="Poulain J."><given-names>J.</given-names> <surname>Poulain</surname></string-name>, <string-name name-style="western" hwp:sortable="Qin J."><given-names>J.</given-names> <surname>Qin</surname></string-name>, <string-name name-style="western" hwp:sortable="Sicheritz-Ponten T."><given-names>T.</given-names> <surname>Sicheritz-Ponten</surname></string-name>, <string-name name-style="western" hwp:sortable="Tims S."><given-names>S.</given-names> <surname>Tims</surname></string-name>, <string-name name-style="western" hwp:sortable="Torrents D."><given-names>D.</given-names> <surname>Torrents</surname></string-name>, <string-name name-style="western" hwp:sortable="Ugarte E."><given-names>E.</given-names> <surname>Ugarte</surname></string-name>, <string-name name-style="western" hwp:sortable="Zoetendal E."><given-names>E.</given-names> <surname>Zoetendal</surname></string-name>, <string-name name-style="western" hwp:sortable="Wang J."><given-names>J.</given-names> <surname>Wang</surname></string-name>, <string-name name-style="western" hwp:sortable="Guarner F."><given-names>F.</given-names> <surname>Guarner</surname></string-name>, <string-name name-style="western" hwp:sortable="Pedersen O."><given-names>O.</given-names> <surname>Pedersen</surname></string-name>, <string-name name-style="western" hwp:sortable="de Vos W."><given-names>W.</given-names> <surname>de Vos</surname></string-name>, <string-name name-style="western" hwp:sortable="Brunak S."><given-names>S.</given-names> <surname>Brunak</surname></string-name>, <string-name name-style="western" hwp:sortable="Dore J."><given-names>J.</given-names> <surname>Dore</surname></string-name>, <collab hwp:id="collab-1">MetaHIT Consortium</collab>, <string-name name-style="western" hwp:sortable="Weissenbach J."><given-names>J.</given-names> <surname>Weissenbach</surname></string-name>, <string-name name-style="western" hwp:sortable="Ehrlich S."><given-names>S.</given-names> <surname>Ehrlich</surname></string-name>, and <string-name name-style="western" hwp:sortable="Bork P."><given-names>P.</given-names> <surname>Bork</surname></string-name>, “<article-title hwp:id="article-title-110">Enterotypes of the human gut microbiome</article-title>,” <source hwp:id="source-114">Nature</source>, vol. <volume>473</volume>, no. <issue>7346</issue>, pp. <fpage>174</fpage>–<lpage>180</lpage>, <year>2011</year>.</citation></ref><ref id="c123" hwp:id="ref-123" hwp:rev-id="xref-ref-123-1"><label>[123]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.123" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-123"><string-name name-style="western" hwp:sortable="Hart Y."><given-names>Y.</given-names> <surname>Hart</surname></string-name>, <string-name name-style="western" hwp:sortable="Sheftel H."><given-names>H.</given-names> <surname>Sheftel</surname></string-name>, <string-name name-style="western" hwp:sortable="Hausser J."><given-names>J.</given-names> <surname>Hausser</surname></string-name>, <string-name name-style="western" hwp:sortable="Szekely P."><given-names>P.</given-names> <surname>Szekely</surname></string-name>, <string-name name-style="western" hwp:sortable="Ben-Moshe N. B."><given-names>N. B.</given-names> <surname>Ben-Moshe</surname></string-name>, <string-name name-style="western" hwp:sortable="Korem Y."><given-names>Y.</given-names> <surname>Korem</surname></string-name>, <string-name name-style="western" hwp:sortable="Tendler A."><given-names>A.</given-names> <surname>Tendler</surname></string-name>, <string-name name-style="western" hwp:sortable="Mayo A. E."><given-names>A. E.</given-names> <surname>Mayo</surname></string-name>, and <string-name name-style="western" hwp:sortable="Alon U."><given-names>U.</given-names> <surname>Alon</surname></string-name>, “<article-title hwp:id="article-title-111">Inferring biological tasks using pareto analysis of high-dimensional data</article-title>,” <source hwp:id="source-115">Nature methods</source>, vol. <volume>12</volume>, no. <issue>3</issue>, pp. <fpage>233</fpage>–<lpage>235</lpage>, <year>2015</year>.</citation></ref><ref id="c124" hwp:id="ref-124" hwp:rev-id="xref-ref-124-1"><label>[124]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.124" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-124"><string-name name-style="western" hwp:sortable="Shoval O."><given-names>O.</given-names> <surname>Shoval</surname></string-name>, <string-name name-style="western" hwp:sortable="Sheftel H."><given-names>H.</given-names> <surname>Sheftel</surname></string-name>, <string-name name-style="western" hwp:sortable="Shinar G."><given-names>G.</given-names> <surname>Shinar</surname></string-name>, <string-name name-style="western" hwp:sortable="Hart Y."><given-names>Y.</given-names> <surname>Hart</surname></string-name>, <string-name name-style="western" hwp:sortable="Ramote O."><given-names>O.</given-names> <surname>Ramote</surname></string-name>, <string-name name-style="western" hwp:sortable="Mayo A."><given-names>A.</given-names> <surname>Mayo</surname></string-name>, <string-name name-style="western" hwp:sortable="Dekel E."><given-names>E.</given-names> <surname>Dekel</surname></string-name>, <string-name name-style="western" hwp:sortable="Kavanagh K."><given-names>K.</given-names> <surname>Kavanagh</surname></string-name>, and <string-name name-style="western" hwp:sortable="Alon U."><given-names>U.</given-names> <surname>Alon</surname></string-name>, “<article-title hwp:id="article-title-112">Evolutionary trade-offs, pareto optimality, and the geometry of phenotype space</article-title>,” <source hwp:id="source-116">Science</source>, vol. <volume>336</volume>, no. <issue>6085</issue>, pp. <fpage>1157</fpage>–<lpage>1160</lpage>, <year>2012</year>.</citation></ref><ref id="c125" hwp:id="ref-125" hwp:rev-id="xref-ref-125-1 xref-ref-125-2"><label>[125]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.125" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-125"><string-name name-style="western" hwp:sortable="Patterson N."><given-names>N.</given-names> <surname>Patterson</surname></string-name>, <string-name name-style="western" hwp:sortable="Moorjani P."><given-names>P.</given-names> <surname>Moorjani</surname></string-name>, <string-name name-style="western" hwp:sortable="Luo Y."><given-names>Y.</given-names> <surname>Luo</surname></string-name>, <string-name name-style="western" hwp:sortable="Mallick S."><given-names>S.</given-names> <surname>Mallick</surname></string-name>, <string-name name-style="western" hwp:sortable="Rohland N."><given-names>N.</given-names> <surname>Rohland</surname></string-name>, <string-name name-style="western" hwp:sortable="Zhan Y."><given-names>Y.</given-names> <surname>Zhan</surname></string-name>, <string-name name-style="western" hwp:sortable="Genschoreck T."><given-names>T.</given-names> <surname>Genschoreck</surname></string-name>, <string-name name-style="western" hwp:sortable="Webster T."><given-names>T.</given-names> <surname>Webster</surname></string-name>, and <string-name name-style="western" hwp:sortable="Reich D."><given-names>D.</given-names> <surname>Reich</surname></string-name>, “<article-title hwp:id="article-title-113">Ancient admixture in human history</article-title>,” <source hwp:id="source-117">Genetics</source>, vol. <volume>192</volume>, no. <issue>3</issue>, pp. <fpage>1065</fpage>–<lpage>1093</lpage>, <year>2012</year>.</citation></ref><ref id="c126" hwp:id="ref-126" hwp:rev-id="xref-ref-126-1"><label>[126]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.126" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-126"><string-name name-style="western" hwp:sortable="Lieberman-Aiden E."><given-names>E.</given-names> <surname>Lieberman-Aiden</surname></string-name>, <string-name name-style="western" hwp:sortable="van Berkum N. L."><given-names>N. L.</given-names> <surname>van Berkum</surname></string-name>, <string-name name-style="western" hwp:sortable="Williams L."><given-names>L.</given-names> <surname>Williams</surname></string-name>, <string-name name-style="western" hwp:sortable="Imakaev M."><given-names>M.</given-names> <surname>Imakaev</surname></string-name>, <string-name name-style="western" hwp:sortable="Ragoczy T."><given-names>T.</given-names> <surname>Ragoczy</surname></string-name>, <string-name name-style="western" hwp:sortable="Telling A."><given-names>A.</given-names> <surname>Telling</surname></string-name>, <string-name name-style="western" hwp:sortable="Amit I."><given-names>I.</given-names> <surname>Amit</surname></string-name>, <string-name name-style="western" hwp:sortable="Lajoie B. R."><given-names>B. R.</given-names> <surname>Lajoie</surname></string-name>, <string-name name-style="western" hwp:sortable="Sabo P. J."><given-names>P. J.</given-names> <surname>Sabo</surname></string-name>, <string-name name-style="western" hwp:sortable="Dorschner M. O."><given-names>M. O.</given-names> <surname>Dorschner</surname></string-name>, <string-name name-style="western" hwp:sortable="Sandstrom R."><given-names>R.</given-names> <surname>Sandstrom</surname></string-name>, <string-name name-style="western" hwp:sortable="Bernstein B."><given-names>B.</given-names> <surname>Bernstein</surname></string-name>, <string-name name-style="western" hwp:sortable="Bender M. A."><given-names>M. A.</given-names> <surname>Bender</surname></string-name>, <string-name name-style="western" hwp:sortable="Groudine M."><given-names>M.</given-names> <surname>Groudine</surname></string-name>, <string-name name-style="western" hwp:sortable="Gnirke A."><given-names>A.</given-names> <surname>Gnirke</surname></string-name>, <string-name name-style="western" hwp:sortable="Stamatoyannopoulos J."><given-names>J.</given-names> <surname>Stamatoyannopoulos</surname></string-name>, <string-name name-style="western" hwp:sortable="Mirny L. A."><given-names>L. A.</given-names> <surname>Mirny</surname></string-name>, <string-name name-style="western" hwp:sortable="Lander E. S."><given-names>E. S.</given-names> <surname>Lander</surname></string-name>, and <string-name name-style="western" hwp:sortable="Dekker J."><given-names>J.</given-names> <surname>Dekker</surname></string-name>, “<article-title hwp:id="article-title-114">Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>,” <source hwp:id="source-118">Science</source>, vol. <volume>326</volume>, no. <issue>5950</issue>, pp. <fpage>289</fpage>–<lpage>293</lpage>, <year>2009</year>.</citation></ref><ref id="c127" hwp:id="ref-127" hwp:rev-id="xref-ref-127-1"><label>[127]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.127" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-127"><string-name name-style="western" hwp:sortable="Consortium E. P."><given-names>E. P.</given-names> <surname>Consortium</surname></string-name> <etal>et al.,</etal> “<article-title hwp:id="article-title-115">An integrated encyclopedia of dna elements in the human genome</article-title>,” <source hwp:id="source-119">Nature</source>, vol. <volume>489</volume>, no. <issue>7414</issue>, pp. <fpage>57</fpage>–<lpage>74</lpage>, <year>2012</year>.</citation></ref><ref id="c128" hwp:id="ref-128" hwp:rev-id="xref-ref-128-1 xref-ref-128-2"><label>[128]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.128" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-128"><string-name name-style="western" hwp:sortable="Leskovec J."><given-names>J.</given-names> <surname>Leskovec</surname></string-name> and <string-name name-style="western" hwp:sortable="Mcauley J. J."><given-names>J. J.</given-names> <surname>Mcauley</surname></string-name>, “<article-title hwp:id="article-title-116">Learning to discover social circles in ego networks</article-title>,” in <source hwp:id="source-120">Advances in neural information processing systems</source>, pp. <fpage>539</fpage>–<lpage>547</lpage>, <year>2012</year>.</citation></ref><ref id="c129" hwp:id="ref-129" hwp:rev-id="xref-ref-129-1"><label>[129]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.129" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-129"><string-name name-style="western" hwp:sortable="White J."><given-names>J.</given-names> <surname>White</surname></string-name> and <string-name name-style="western" hwp:sortable="Dalton S."><given-names>S.</given-names> <surname>Dalton</surname></string-name>, “<article-title hwp:id="article-title-117">Cell cycle control of embryonic stem cells</article-title>,” <source hwp:id="source-121">Stem cell reviews</source>, vol. <volume>1</volume>, no. <issue>2</issue>, pp. <fpage>131</fpage>–<lpage>138</lpage>, <year>2005</year>.</citation></ref><ref id="c130" hwp:id="ref-130" hwp:rev-id="xref-ref-130-1"><label>[130]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.130" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-130"><string-name name-style="western" hwp:sortable="Von Luxburg U."><given-names>U.</given-names> <surname>Von Luxburg</surname></string-name>, “<article-title hwp:id="article-title-118">A tutorial on spectral clustering</article-title>,” <source hwp:id="source-122">Statistics and computing</source>, vol. <volume>17</volume>, no. <issue>4</issue>, pp. <fpage>395</fpage>–<lpage>416</lpage>, <year>2007</year>.</citation></ref><ref id="c131" hwp:id="ref-131" hwp:rev-id="xref-ref-131-1"><label>[131]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.131" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-131"><string-name name-style="western" hwp:sortable="Ng A. Y."><given-names>A. Y.</given-names> <surname>Ng</surname></string-name>, <string-name name-style="western" hwp:sortable="Jordan M. I."><given-names>M. I.</given-names> <surname>Jordan</surname></string-name>, and <string-name name-style="western" hwp:sortable="Weiss Y."><given-names>Y.</given-names> <surname>Weiss</surname></string-name>, “<article-title hwp:id="article-title-119">On spectral clustering: Analysis and an algorithm</article-title>,” in <source hwp:id="source-123">Advances in neural information processing systems</source>, pp. <fpage>849</fpage>–<lpage>856</lpage>, <year>2002</year>.</citation></ref><ref id="c132" hwp:id="ref-132" hwp:rev-id="xref-ref-132-1"><label>[132]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.132" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-132"><string-name name-style="western" hwp:sortable="Blondel V. D."><given-names>V. D.</given-names> <surname>Blondel</surname></string-name>, <string-name name-style="western" hwp:sortable="Guillaume J.-L."><given-names>J.-L.</given-names> <surname>Guillaume</surname></string-name>, <string-name name-style="western" hwp:sortable="Lambiotte R."><given-names>R.</given-names> <surname>Lambiotte</surname></string-name>, and <string-name name-style="western" hwp:sortable="Lefebvre E."><given-names>E.</given-names> <surname>Lefebvre</surname></string-name>, “<article-title hwp:id="article-title-120">Fast unfolding of communities in large networks</article-title>,” <source hwp:id="source-124">Journal of statistical mechanics: theory and experiment</source>, vol. <volume>2008</volume>, no. <issue>10</issue>, p. <fpage>P10008</fpage>, <year>2008</year>.</citation></ref><ref id="c133" hwp:id="ref-133" hwp:rev-id="xref-ref-133-1"><label>[133]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.133" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-133"><string-name name-style="western" hwp:sortable="Levine J. H."><given-names>J. H.</given-names> <surname>Levine</surname></string-name>, <string-name name-style="western" hwp:sortable="Simonds E. F."><given-names>E. F.</given-names> <surname>Simonds</surname></string-name>, <string-name name-style="western" hwp:sortable="Bendall S. C."><given-names>S. C.</given-names> <surname>Bendall</surname></string-name>, <string-name name-style="western" hwp:sortable="Davis K. L."><given-names>K. L.</given-names> <surname>Davis</surname></string-name>, <string-name name-style="western" hwp:sortable="El-ad D. A."><given-names>D. A.</given-names> <surname>El-ad</surname></string-name>, <string-name name-style="western" hwp:sortable="Tadmor M. D."><given-names>M. D.</given-names> <surname>Tadmor</surname></string-name>, <string-name name-style="western" hwp:sortable="Litvin O."><given-names>O.</given-names> <surname>Litvin</surname></string-name>, <string-name name-style="western" hwp:sortable="Fienberg H. G."><given-names>H. G.</given-names> <surname>Fienberg</surname></string-name>, <string-name name-style="western" hwp:sortable="Jager A."><given-names>A.</given-names> <surname>Jager</surname></string-name>, <string-name name-style="western" hwp:sortable="Zunder E. R."><given-names>E. R.</given-names> <surname>Zunder</surname></string-name>, <etal>et al.,</etal> “<article-title hwp:id="article-title-121">Data-driven phenotypic dissection of aml reveals progenitor-like cells that correlate with prognosis</article-title>,” <source hwp:id="source-125">Cell</source>, vol. <volume>162</volume>, no. <issue>1</issue>, pp. <fpage>184</fpage>–<lpage>197</lpage>, <year>2015</year>.</citation></ref><ref id="c134" hwp:id="ref-134" hwp:rev-id="xref-ref-134-1"><label>[134]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.134" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-134"><string-name name-style="western" hwp:sortable="Galluccio L."><given-names>L.</given-names> <surname>Galluccio</surname></string-name>, <string-name name-style="western" hwp:sortable="Michel O."><given-names>O.</given-names> <surname>Michel</surname></string-name>, <string-name name-style="western" hwp:sortable="Comon P."><given-names>P.</given-names> <surname>Comon</surname></string-name>, <string-name name-style="western" hwp:sortable="Kliger M."><given-names>M.</given-names> <surname>Kliger</surname></string-name>, and <string-name name-style="western" hwp:sortable="Hero A. O."><given-names>A. O.</given-names> <surname>Hero</surname></string-name>, “<article-title hwp:id="article-title-122">Clustering with a new distance measure based on a dual-rooted tree</article-title>,” <source hwp:id="source-126">Information Sciences</source>, vol. <volume>251</volume>, pp. <fpage>96</fpage>–<lpage>113</lpage>, <year>2013</year>.</citation></ref><ref id="c135" hwp:id="ref-135" hwp:rev-id="xref-ref-135-1"><label>[135]</label><citation publication-type="journal" citation-type="journal" ref:id="120378v4.135" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-135"><string-name name-style="western" hwp:sortable="Xu D."><given-names>D.</given-names> <surname>Xu</surname></string-name> and <string-name name-style="western" hwp:sortable="Tian Y."><given-names>Y.</given-names> <surname>Tian</surname></string-name>, “<article-title hwp:id="article-title-123">A comprehensive survey of clustering algorithms</article-title>,” <source hwp:id="source-127">Annals of Data Science</source>, vol. <volume>2</volume>, no. <issue>2</issue>, pp. <fpage>165</fpage>–<lpage>193</lpage>, <year>2015</year>.</citation></ref></ref-list><sec id="s6" hwp:id="sec-20"><label>A</label><title hwp:id="title-22">Methods</title><p hwp:id="p-70">Here we present an expanded explanation of our computational methods, experimental methods, and data processing steps.</p><sec id="s6a" hwp:id="sec-21"><label>A.1</label><title hwp:id="title-23">Computational Methods</title><p hwp:id="p-71">Here we further discuss the computational methods. We first provide a detailed overview of the PHATE algorithm followed by a robustness analysis of PHATE with respect to the parameters and the number of datapoints. We then provide details on the scalable version of PHATE, identifying branch points and branches, and the EMD score analysis.</p><sec id="s6a1" hwp:id="sec-22"><label>A.1.1</label><title hwp:id="title-24">PHATE Overview</title><p hwp:id="p-72">A common way of visualizing high dimensional data is by using dimensionality reduction methods, which map high dimensional data points to low dimensional coordinates (i.e., two or three dimensions in this case) by minimizing some notion of distortion. For example, PCA aims to preserve variance, and thus its notion of distortion is derived from variance lost by linear projection [<xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-3" hwp:rel-id="ref-11">11</xref>]. Similarly, diffusion maps preserve diffusion affinities as inner products [<xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-3" hwp:rel-id="ref-13">13</xref>,<xref ref-type="bibr" rid="c59" hwp:id="xref-ref-59-1" hwp:rel-id="ref-59">59</xref>], and Isomap preserves geodesic distances as Euclidean distances [<xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-2" hwp:rel-id="ref-4">4</xref>]. The minimized notion of distortion in these methods can be derived directly from the appropriate inner products or distances, and related to their algorithmic steps. Finally, the popular t-SNE method [<xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-5" hwp:rel-id="ref-1">1</xref>] aims to directly preserve neighborhood structure, and uses KL divergence between high dimensional Gaussian neighborhoods and low dimensional neighborhoods (captured via Student t-distributions) as its distortion.</p><p hwp:id="p-73">The effectiveness of a given dimensionality reduction method in a particular application should be considered by ensuring its distortion notion, or resulting embedding, faithfully preserve structures and patterns of interest. Here, we focus on clustering and progression (e.g., trajectory) structures, due to their established significance and importance in biological data. It should be noted that many, if not most, of the common dimensionality reduction methods were not originally designed for visualization purposes, but rather for alleviating the curse of dimensionality [<xref ref-type="bibr" rid="c60" hwp:id="xref-ref-60-1" hwp:rel-id="ref-60">60</xref>,<xref ref-type="bibr" rid="c61" hwp:id="xref-ref-61-1" hwp:rel-id="ref-61">61</xref>]. While they can be used for visualization by simply setting the dimensionality of the embedding to be two or three, there is no guarantee that the resulting visualization will reliably express clusters, trajectories, or other patterns of interest.</p><p hwp:id="p-74">In this work we focus on embedding data into a two dimensional space for visualization purposes. The embedding provided by PHATE is specifically designed to enable visualization of global and local structure in exploratory settings with the following criteria in mind:
<list list-type="simple" hwp:id="list-2"><list-item hwp:id="list-item-4"><p hwp:id="p-75"><bold>Visualization:</bold> To enable visualization, PHATE captures variance in low (2-3) dimensions.</p></list-item><list-item hwp:id="list-item-5"><p hwp:id="p-76"><bold>Manifold-structure preserving:</bold> To provide an interpretable view of dynamics (e.g., pathways or progressions) in the data, PHATE preserves and emphasizes global nonlinear transitions in the data, in addition to local transitions.</p></list-item><list-item hwp:id="list-item-6"><p hwp:id="p-77"><bold>Denoising:</bold> To enable unsupervised data exploration, PHATE denoises data such that progressions within the data are immediately identifiable and clearly separated.</p></list-item><list-item hwp:id="list-item-7"><p hwp:id="p-78"><bold>Robust:</bold> PHATE produces a robust embedding in the sense that the revealed boundaries and the intersections of progressions within the data are insensitive to user configurations of the algorithm.</p></list-item></list></p><p hwp:id="p-79">PHATE fulfills these criteria with an abstract geometric model based primarily on two properties that we typically observe in high throughput data (biomedical and otherwise). First, transitions between data points tend to be incremental and gradual. There may be many such patches of incremental change but nevertheless these gradual transitions are usually prevalent. Second, there are a limited number of intrinsic directions (or pathways) along which datapoints progress. Therefore, the dynamics captured by collected data are inherently more like a set of rivers, rather than a cloud (expanding outwards in all directions).</p><p hwp:id="p-80">Data with such properties can thus be modeled geometrically by a collection of smoothly varying data patches defined by local neighborhoods [<xref ref-type="bibr" rid="c62" hwp:id="xref-ref-62-1" hwp:rel-id="ref-62">62</xref>]. This collection essentially fits the manifold learning paradigm, which relies on a mathematical manifold model for the geometry of a progression track, together with analysis tools for characterizing it. Furthermore, data manifolds often have a low intrinsic dimension, even if curvature and noise forces them to span a high dimensional ambient volume in the collected feature space. Finally, progression tracks form trajectories, with a limited number of “branching points”, where progression splits into several directions. Therefore, in this case the underlying data geometry can implicitly be regarded as a collection of intrinsically low-dimensional manifolds (i.e., curves, surfaces) that cross each other in branching points. By exploiting this low-dimensional structure, we avoid the effects of the curse of dimensionality.</p><p hwp:id="p-81">It has been shown in several works (e.g., [<xref ref-type="bibr" rid="c63" hwp:id="xref-ref-63-1" hwp:rel-id="ref-63">63</xref>,<xref ref-type="bibr" rid="c64" hwp:id="xref-ref-64-1" hwp:rel-id="ref-64">64</xref>]) that manifold geometries are closely related to heat diffusion, which is modeled by the heat equation – a differential equation defined in terms of the Laplace-Beltrami operators. Indeed, meta-stable solutions of the heat equation over a manifold capture its intrinsic properties, while providing embeddings, affinities, and distance metrics that capture intrinsic manifold relations. It has further been shown that these can be robustly discretized for empirical observations that correlate with hidden (or latent) manifold models, e.g., by considering diffusion maps embedding of the data [<xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-4" hwp:rel-id="ref-13">13</xref>,<xref ref-type="bibr" rid="c65" hwp:id="xref-ref-65-1" hwp:rel-id="ref-65">65</xref>,<xref ref-type="bibr" rid="c66" hwp:id="xref-ref-66-1" hwp:rel-id="ref-66">66</xref>]. The embedding obtained by PHATE extends these results by considering this diffusion goemetry as a statistical manifold of diffusion distributions and using tools of information geometry (namely, <italic toggle="yes">α</italic>-representations) to capture its metric stucture and embed it in visualizable (i.e., two or three) dimensions. Further, as we discuss in the following sections, the information distance metric we use also relates to Boltzman energy potentials of the diffusion process, and therefore it combines together both the dyamical systems and information geometry aspects of data-driven diffusion geometries. In particular, for the case of transition structures, this approach enables the consideration of the underlying data geometry consisting of multiple low-dimensional manifolds (such as trajectory curves) that cross each other, while alleviating boundary-condition instabilities to maintain low dimensionality of the embedded space that is better-suited for visualization.</p><p hwp:id="p-82">We note that the trajectory structure is not artificially generated in our case, but rather it is expected to be dominant (albeit latent or hidden) in the data. Therefore, the PHATE visualization will only show trajectory structures when data fits such a geometry; otherwise, other (e.g., cluster) patterns will be expressed in the PHATE visualization.</p><p hwp:id="p-83">Here we provide further details about each of the steps in PHATE and we explain how each of these steps help us ensure that the provided embedding satisfies the four properties described above.</p><sec id="s6a1a" hwp:id="sec-23"><title hwp:id="title-25">Distances</title><p hwp:id="p-84">Consider the common approach of linearly embedding the raw data matrix itself, e.g., with PCA, to preserve the global structure of the data. PCA finds the directions of the data that capture the largest global variance. However, in most cases local transitions are noisy and global transitions are nonlinear. Therefore, linear notions such as global variance maximization are insufficient to capture latent patterns in the data, and they typically result in a noisy visualization (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-4" hwp:rel-id="F11">Figure S3</xref>, Column 2). To provide reliable <italic toggle="yes">structure preservation</italic> that emphasizes transitions in the data, we need to consider the <italic toggle="yes">intrinsic</italic> structure of the data. This implies and motivates preserving distances between data points (e.g., cells) that consider gradual changes between them along these nonlinear transitions (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-7" hwp:rel-id="F2">Figure 2A-B</xref>).</p></sec><sec id="s6a1b" hwp:id="sec-24"><title hwp:id="title-26">Affinities and the Diffusion Operator</title><p hwp:id="p-85">A standard choice of a distance metric is the Euclidean distance. However, global Euclidean distances are not reflective of transitions in the data, especially in biological datasets that have nonlinear and noisy structures. For instance, cells sampled from a developmental system, such as hematopoiesis or embryonic stem cell differentiation, show gradual changes where adjacent cells are only slightly different from each other. But these changes quickly aggregate into nonlinear transitions in marker expression along each developmental path. Therefore, we transform the global Euclidean distances into local affinities that quantify the similarities between nearby (in the Euclidean space) data points (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-8" hwp:rel-id="F2">Figure 2C</xref>).</p><p hwp:id="p-86">Let <inline-formula hwp:id="inline-formula-1"><alternatives hwp:id="alternatives-1"><inline-graphic xlink:href="120378_inline1.gif" hwp:id="inline-graphic-1"/></alternatives></inline-formula> be a dataset with <italic toggle="yes">N</italic> points sampled i.i.d. from a probability distribution <italic toggle="yes">p</italic>: ℝ<sup><italic toggle="yes">d</italic></sup> → [0, ∞) (with ∫ <italic toggle="yes">p</italic>(<italic toggle="yes">x</italic>)<italic toggle="yes">dx</italic> = 1) that is essentially supported on a low dimensional manifold <inline-formula hwp:id="inline-formula-2"><alternatives hwp:id="alternatives-2"><inline-graphic xlink:href="120378_inline2.gif" hwp:id="inline-graphic-2"/></alternatives></inline-formula>, where <italic toggle="yes">m</italic> is the dimension of <inline-formula hwp:id="inline-formula-3"><alternatives hwp:id="alternatives-3"><inline-graphic xlink:href="120378_inline3.gif" hwp:id="inline-graphic-3"/></alternatives></inline-formula> and <italic toggle="yes">m</italic> ≪ <italic toggle="yes">d</italic>. A common approach to transforming global distances to local similarities is to apply some kernel function. A popular kernel function is the Gaussian kernel <italic toggle="yes">k<sub>ε</sub></italic>(<italic toggle="yes">x,y</italic>) = exp(−||<italic toggle="yes">x</italic> − <italic toggle="yes">y</italic>||<sup>2</sup>/<italic toggle="yes">ε</italic>) that quantifies similarities between points based on Euclidean distances. The bandwidth ε determines the radius (or spread) of neighborhoods captured by this kernel.</p><p hwp:id="p-87">Embedding local affinities directly can result in a loss of global structure as is evident in t-SNE (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-8" hwp:rel-id="F1">Figures 1</xref>, <xref ref-type="fig" rid="fig5" hwp:id="xref-fig-6-5" hwp:rel-id="F6">5</xref>, <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-4" hwp:rel-id="F15">S7</xref>, and <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-5" hwp:rel-id="F11">S3</xref>) or kernel PCA embeddings. For example, t-SNE only preserves data clusters, but not transitions between clusters, since it does not enforce any preservation of global structure. In contrast, a faithful structure-preserving embedding (and visualization) needs to go beyond local affinities (or distances), and consider more global relations between parts of the data. To accomplish this, PHATE is based on constructing a diffusion geometry to learn and represent the shape of the data [<xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-5" hwp:rel-id="ref-13">13</xref>,<xref ref-type="bibr" rid="c65" hwp:id="xref-ref-65-2" hwp:rel-id="ref-65">65</xref>,<xref ref-type="bibr" rid="c66" hwp:id="xref-ref-66-2" hwp:rel-id="ref-66">66</xref>]. This construction is based on computing local similarities between data points, and then <italic toggle="yes">walking</italic> or <italic toggle="yes">diffusing</italic> through the data using a Markovian random-walk diffusion process to infer more global relations (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-9" hwp:rel-id="F2">Figure 2D</xref>).</p><p hwp:id="p-88">The initial probabilities in this random walk are calculated by normalizing the row-sums of the kernel matrix. In the case of the Gaussian kernel described above, we obtain the following:
<disp-formula id="eqn1" hwp:id="disp-formula-1" hwp:rev-id="xref-disp-formula-1-1">
<alternatives hwp:id="alternatives-4"><graphic xlink:href="120378_eqn1.gif" position="float" orientation="portrait" hwp:id="graphic-9"/></alternatives>
</disp-formula>
resulting in a <italic toggle="yes">N × N</italic> row-stochastic matrix
<disp-formula id="eqn2" hwp:id="disp-formula-2" hwp:rev-id="xref-disp-formula-2-1">
<alternatives hwp:id="alternatives-5"><graphic xlink:href="120378_eqn2.gif" position="float" orientation="portrait" hwp:id="graphic-10"/></alternatives>
</disp-formula></p><p hwp:id="p-89">The matrix <italic toggle="yes">P<sub>ε</sub></italic> is a Markov transition matrix where the probability of moving from <italic toggle="yes">x</italic> to <italic toggle="yes">y</italic> in a single time step is given by Pr[<italic toggle="yes">x</italic> → <italic toggle="yes">y</italic>] = [<italic toggle="yes">P<sub>ε</sub></italic>]<sub>(<italic toggle="yes">x,y</italic>)</sub>. This matrix is also referred to as the diffusion operator.</p></sec><sec id="s6a1c" hwp:id="sec-25"><title hwp:id="title-27">The <italic toggle="yes"><italic toggle="yes">α</italic></italic>-decaying Kernel and Adaptive Bandwidth</title><p hwp:id="p-90">When applying the diffusion map framework to data, the choice of the kernel <italic toggle="yes">K</italic> and bandwidth <italic toggle="yes">ε</italic> plays a key role in the results. In particular, choosing the bandwidth corresponds to a tradeoff between encoding global and local information in the probability matrix <italic toggle="yes">P<sub>ε</sub></italic>. If the bandwidth is small, then single-step transitions in the random walk using <italic toggle="yes">P<sub>ε</sub></italic> are largely confined to the nearest neighbors of each data point. In biological data, trajectories between major cell types may be relatively sparsely sampled. Thus, if the bandwidth is too small, then the neighbors of points in sparsely sampled regions may be excluded entirely and the trajectory structure in the probability matrix <italic toggle="yes">P<sub>ε</sub></italic> will not be encoded. Conversely, if the bandwidth is too large, then the resulting probability matrix <italic toggle="yes">P<sub>ε</sub></italic> loses local information as [<italic toggle="yes">P<sub>ε</sub></italic>]<sub>(<italic toggle="yes">x</italic>,·)</sub> becomes more uniform for all <inline-formula hwp:id="inline-formula-4"><alternatives hwp:id="alternatives-6"><inline-graphic xlink:href="120378_inline4.gif" hwp:id="inline-graphic-4"/></alternatives></inline-formula>, which may result in an inability to resolve different trajectories. Here, we use an adaptive bandwidth that changes with each point to be equal to its kth nearest neighbor distance, along with an <italic toggle="yes"><italic toggle="yes">α</italic></italic>-decaying kernel that controls the rate of decay of the kernel.</p><p hwp:id="p-91">The original heuristic proposed in [<xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-6" hwp:rel-id="ref-13">13</xref>] suggests setting <italic toggle="yes">ε</italic> to be the smallest distance that still keeps the diffusion process connected. In other words, it is chosen to be the maximal 1-nearest neighbor distance in the dataset. While this approach is useful in some cases, it is greatly affected by outliers and sparse data regions. Furthermore, it relies on a single manifold with constant dimension as the underlying data geometry, which may not be the case when the data is sampled from specific trajectories rather than uniformly from a manifold. Indeed, the intrinsic dimensionality in such cases differs between mid-branch points that mostly capture one-dimensional trajectory geometry, and branching points that capture multiple trajectories crossing each other.</p><p hwp:id="p-92">This issue can be mitigated by using a locally adaptive bandwidth that varies based on the local density of the data. A common method for choosing a locally adaptive bandwidth is to use the <italic toggle="yes">k</italic>-nearest neighbor (NN) distance of each point as the bandwidth. A point <italic toggle="yes">x</italic> that is within a densely sampled region will have a small <italic toggle="yes">k</italic>-NN distance. Thus, local information in these regions is still preserved. In contrast, if <italic toggle="yes">x</italic> is on a sparsely sampled trajectory, the <italic toggle="yes">k</italic>-NN distance will be greater and will encode the trajectory structure. We denote the <italic toggle="yes">k</italic>-NN distance of <italic toggle="yes">x</italic> as <italic toggle="yes">ε</italic><sub>k</sub>(<italic toggle="yes">x</italic>) and the corresponding diffusion operator as <italic toggle="yes">P<sub>k</sub></italic>.</p><p hwp:id="p-93">A weakness of using locally adaptive bandwidths alongside kernels with exponential tails (e.g., the Gaussian kernel) is that the tails become heavier (i.e., decay more slowly) as the bandwidth increases. Thus for a point <italic toggle="yes">x</italic> in a sparsely sampled region where the <italic toggle="yes">k</italic>-NN distance is large, [<italic toggle="yes">P<sub>k</sub></italic>]<sub>(<italic toggle="yes">x</italic>,·)</sub> may be close to a fully-supported uniform distribution due to the heavy tails, resulting in a high affinity with many points that are far away. This can be mitigated by using the following kernel
<disp-formula id="eqn3" hwp:id="disp-formula-3" hwp:rev-id="xref-disp-formula-3-1">
<alternatives hwp:id="alternatives-7"><graphic xlink:href="120378_eqn3.gif" position="float" orientation="portrait" hwp:id="graphic-11"/></alternatives>
</disp-formula>
which we call the <italic toggle="yes">α</italic>-decaying kernel. The exponent <italic toggle="yes">α</italic> controls the rate of decay of the tails in the kernel <italic toggle="yes">K<sub>k,α</sub></italic>. Increasing <italic toggle="yes">α</italic> increases the decay rate while decreasing <italic toggle="yes">α</italic> decreases the decay rate. Since <italic toggle="yes">α</italic> = 2 for the Gaussian kernel, choosing <italic toggle="yes">α</italic> &gt; 2 will result in lighter tails in the kernel <italic toggle="yes">K<sub>k,α</sub></italic> compared to the Gaussian kernel. We denote the resulting diffusion operator as <italic toggle="yes">P<sub>k,α</sub></italic>. This is similar to common utilizations of Butterworth filters in signal processing applications [<xref ref-type="bibr" rid="c67" hwp:id="xref-ref-67-1" hwp:rel-id="ref-67">67</xref>]. See <xref ref-type="fig" rid="figS2" hwp:id="xref-fig-10-3" hwp:rel-id="F10">Figure S2B</xref> for a visualization of the effect of different values of <italic toggle="yes">α</italic> on this kernel function.</p><p hwp:id="p-94">Our use of a locally adaptive bandwidth and the kernel <italic toggle="yes">K<sub>k,α</sub></italic> requires the choice of two tuning parameters: <italic toggle="yes">k</italic> and <italic toggle="yes">α</italic>. <italic toggle="yes">k</italic> should be chosen sufficiently small to preserve local information, i.e., to ensure that [<italic toggle="yes">P<sub>k,α</sub></italic>]<sub>(<italic toggle="yes">x</italic>,·)</sub> is not a fully-supported uniform distribution. However, <italic toggle="yes">k</italic> should also be chosen sufficiently large to ensure that the underlying graph represented by <italic toggle="yes">P<sub>k,α</sub></italic> is sufficiently connected, i.e., the probability that we can <italic toggle="yes">walk</italic> from one point to another within the same trajectory in a finite number of steps is nonzero.</p><p hwp:id="p-95">The parameter <italic toggle="yes">α</italic> should also be chosen with <italic toggle="yes">k</italic>. <italic toggle="yes">α</italic> should be chosen sufficiently large so that the tails of the kernel <italic toggle="yes">K<sub>k,α</sub></italic> are not too heavy, especially in sparse regions of the data. However, if <italic toggle="yes">k</italic> is small when <italic toggle="yes">α</italic> is large, then the underlying graph represented by <italic toggle="yes">P<sub>k,α</sub></italic> may be too sparsely connected, making it difficult to learn long range connections. Thus we recommend that <italic toggle="yes">α</italic> be fixed at a large number (e.g. <italic toggle="yes">α</italic> ≥ 10) and then <italic toggle="yes">k</italic> can be chosen sufficiently large to ensure that points are locally connected. In practice, we find that choosing <italic toggle="yes">k</italic> to be around 5 and <italic toggle="yes">α</italic> to be about 10 works well for all the data sets presented in this work. However, the PHATE embedding is robust to the choice of these parameters as demonstrated in Appendix A.1.2.</p><p hwp:id="p-96">In addition to progression or trajectory structures, the recommendations provided in this section work well for visualizing data that naturally separate into distinct clusters. In particular, the <italic toggle="yes">α</italic>-decay kernel ensures that relationships are preserved between distinct clusters that are relatively close to each other.</p></sec><sec id="s6a1d" hwp:id="sec-26"><title hwp:id="title-28">Propagating Affinities via Diffusion</title><p hwp:id="p-97">Here we discuss diffusion, i.e., raising the diffusion operator to its <italic toggle="yes">t</italic>-th power as shown in Alg. 1 (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-10" hwp:rel-id="F2">Figure 2D</xref>). To simplify the discussion we use the notation <italic toggle="yes">P</italic> for the diffusion operator, whether defined with a fixed-bandwidth Gaussian kernel or our adaptive kernel. This matrix is referred to as the diffusion operator, since it defines a Markovian diffusion process that essentially only allows single-step transitions within local data neighborhoods whose sizes depend on the kernel parameters (<italic toggle="yes">ε</italic> or <italic toggle="yes">k</italic> and <italic toggle="yes">α</italic>). In particular, let <inline-formula hwp:id="inline-formula-5"><alternatives hwp:id="alternatives-8"><inline-graphic xlink:href="120378_inline5.gif" hwp:id="inline-graphic-5"/></alternatives></inline-formula> and let <italic toggle="yes">δ<sub>x</sub></italic> be a Dirac at <italic toggle="yes">x</italic>, i.e., a row vector of length <italic toggle="yes">N</italic> with a one at the entry corresponding to <italic toggle="yes">x</italic> and zeros everywhere else. The <italic toggle="yes">t</italic>-step distribution of <italic toggle="yes">x</italic> is the row in <inline-formula hwp:id="inline-formula-6"><alternatives hwp:id="alternatives-9"><inline-graphic xlink:href="120378_inline6.gif" hwp:id="inline-graphic-6"/></alternatives></inline-formula> corresponding to <italic toggle="yes">x</italic>:
<disp-formula id="eqn4" hwp:id="disp-formula-4" hwp:rev-id="xref-disp-formula-4-1">
<alternatives hwp:id="alternatives-10"><graphic xlink:href="120378_eqn4.gif" position="float" orientation="portrait" hwp:id="graphic-12"/></alternatives>
</disp-formula></p><p hwp:id="p-98">These distributions capture multi-scale (where <italic toggle="yes">t</italic> serves as the scale) local neighborhoods of data points, where locality is considered via random walks that propagate over the intrinsic manifold geometry of the data. This provides a global and robust intrinsic data distance that preserving the overall structure of the data. In addition to learning the global structure, powering the diffusion operator has the effect of low-pass filtering the data such that the main pathways in it are emphasized and small noise dimensions are diminished, thus achieving the denoising objective of our method as well.</p><p hwp:id="p-99">For appropriate choices of kernel parameters (as described in previous sections), the diffusion process defined by <italic toggle="yes">P</italic> is ergodic and it thus has a unique stationary distribution <italic toggle="yes">p</italic><sup>∞</sup> that is independent of the initial conditions of the process. Thus <inline-formula hwp:id="inline-formula-7"><alternatives hwp:id="alternatives-11"><inline-graphic xlink:href="120378_inline7.gif" hwp:id="inline-graphic-7"/></alternatives></inline-formula> for all <inline-formula hwp:id="inline-formula-8"><alternatives hwp:id="alternatives-12"><inline-graphic xlink:href="120378_inline8.gif" hwp:id="inline-graphic-8"/></alternatives></inline-formula>. The stationary distribution <italic toggle="yes">p</italic><sup>∞</sup> is the left eigenvector of <italic toggle="yes">P</italic> with eigenvalue λ<sub>0</sub> = 1 and can be written explicitly as <italic toggle="yes">ν</italic>/||<italic toggle="yes">ν</italic>||<sub>1</sub> with the row-sums from <xref ref-type="disp-formula" rid="eqn1" hwp:id="xref-disp-formula-1-1" hwp:rel-id="disp-formula-1">Eq. 1</xref> (possibly adapted to use <italic toggle="yes">K<sub>k,α</sub></italic> from <xref ref-type="disp-formula" rid="eqn3" hwp:id="xref-disp-formula-3-1" hwp:rel-id="disp-formula-3">Eq. 3</xref>). It can be shown [<xref ref-type="bibr" rid="c66" hwp:id="xref-ref-66-3" hwp:rel-id="ref-66">66</xref>] that for fixed-bandwidth Gaussian-kernel diffusion, <italic toggle="yes">p</italic><sup>∞</sup> converges asymptotically to the original distribution <italic toggle="yes">p</italic> of the data as <italic toggle="yes">N</italic> → ∞ and <italic toggle="yes">ε</italic> → 0.</p><p hwp:id="p-100">The representation provided by the diffusion distributions <inline-formula hwp:id="inline-formula-9"><alternatives hwp:id="alternatives-13"><inline-graphic xlink:href="120378_inline9.gif" hwp:id="inline-graphic-9"/></alternatives></inline-formula>, defines a diffusion geometry with the diffusion distance
<disp-formula id="eqn5" hwp:id="disp-formula-5" hwp:rev-id="xref-disp-formula-5-1 xref-disp-formula-5-2">
<alternatives hwp:id="alternatives-14"><graphic xlink:href="120378_eqn5.gif" position="float" orientation="portrait" hwp:id="graphic-13"/></alternatives>
</disp-formula>
which is given by a weighted <italic toggle="yes">ℓ</italic><sub>2</sub> distance between the diffusion distributions originating from the data points <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic>. This distance incorporates a comparison between intrinsic manifold regions of the two data points as well as the concentration of data between them, i.e., the difference between the mass distributions.</p><p hwp:id="p-101">The diffusion distance at all time scales can be approximated by the Euclidean distance in the diffusion map embedding, which is defined as follows. If the diffusion process is connected, the eigenvalues of <italic toggle="yes">P</italic> can be indexed as 1 = λ<sub>0</sub> &gt; λ<sub>1</sub> ≥ ⋯ λ<sub><italic toggle="yes">N</italic>−1</sub> ≥ 0. Let <italic toggle="yes">ψ<sub>i</sub></italic> and <italic toggle="yes">ϕ<sub>i</sub></italic> be the corresponding <italic toggle="yes">i</italic>th left and right eigenvectors of <italic toggle="yes">P</italic>, respectively. The diffusion map embedding is defined as
<disp-formula id="eqn6" hwp:id="disp-formula-6" hwp:rev-id="xref-disp-formula-6-1">
<alternatives hwp:id="alternatives-15"><graphic xlink:href="120378_eqn6.gif" position="float" orientation="portrait" hwp:id="graphic-14"/></alternatives>
</disp-formula></p><p hwp:id="p-102">The time scale <italic toggle="yes">t</italic> only impacts the scaling of the embedded coordinates via the powers of the eigenvalues. It can then be shown that <italic toggle="yes">D<sup>t</sup></italic>(<italic toggle="yes">x, y</italic>) = ||Φ<sup><italic toggle="yes">t</italic></sup>(<italic toggle="yes">x</italic>) − Φ<sup><italic toggle="yes">t</italic></sup>(<italic toggle="yes">y</italic>)||<sub>2</sub>.</p></sec><sec id="s6a1e" hwp:id="sec-27"><title hwp:id="title-29">Choosing the Diffusion Time Scale <italic toggle="yes">t</italic> with Von Neumann Entropy</title><p hwp:id="p-103">The diffusion time scale <italic toggle="yes">t</italic> is an important parameter that affects the embedding. The parameter <italic toggle="yes">t</italic> determines the number of steps taken in a random walk. A larger <italic toggle="yes">t</italic> corresponds to more steps compared to a smaller <italic toggle="yes">t</italic>. Thus, <italic toggle="yes">t</italic> provides a tradeoff between encoding local and global information in the embedding. The diffusion process can also be viewed as a low-pass filter where local noise is smoothed out based on more global structures. The parameter <italic toggle="yes">t</italic> determines the level of smoothing. If <italic toggle="yes">t</italic> is chosen to be too small, then the embedding may be too noisy. On the other hand, if <italic toggle="yes">t</italic> is chosen to be too large, then some of the signal may be smoothed away.</p><p hwp:id="p-104">We formulate a new algorithm for choosing the timescale <italic toggle="yes">t</italic>. Our algorithm quantifies the information in the powered diffusion operator with various values of <italic toggle="yes">t</italic>. This is accomplished by computing the spectral or <italic toggle="yes">Von Neumann Entropy</italic> (VNE) [<xref ref-type="bibr" rid="c68" hwp:id="xref-ref-68-1" hwp:rel-id="ref-68">68</xref>,<xref ref-type="bibr" rid="c69" hwp:id="xref-ref-69-1" hwp:rel-id="ref-69">69</xref>] of the powered diffusion operator. The amount of variability explained by each dimension is equal to its eigenvalue in the eigendecomposition of the related (non-Markov) affinity matrix that is conjugate to the Markov diffusion operator. The VNE is calculated by computing the Shannon entropy on the normalized eigenvalues of this matrix. Due to noise in the data, this value is artificially high for low values of <italic toggle="yes">t</italic>, and rapidly decreases as one powers the matrix. Thus, we choose values that are around the “knee” of this decrease.</p><p hwp:id="p-105">More formally, to choose <italic toggle="yes">t</italic>, we first note that its impact on the diffusion geometry can be determined by considering the eigenvalues of the diffusion operator, as the corresponding eigenvectors are not impacted by the time scale. To facilitate spectral considerations and for computational ease, we use a symmetric conjugate
<disp-formula hwp:id="disp-formula-7">
<alternatives hwp:id="alternatives-16"><graphic xlink:href="120378_ueqn1.gif" position="float" orientation="portrait" hwp:id="graphic-15"/></alternatives>
</disp-formula>
of the diffusion operator <italic toggle="yes">P</italic> with the row-sums <italic toggle="yes">ν</italic>. This symmetric matrix is often called the diffusion affinity matrix. The VNE of this diffusion affinity is used to quantify the amount of variability. It can be verified that the eigenvalues of <italic toggle="yes">A<sup>t</sup></italic> are the same as those of <italic toggle="yes">P<sup>t</sup></italic>, and furthermore these eigenvalues are given by the powers <inline-formula hwp:id="inline-formula-10"><alternatives hwp:id="alternatives-17"><inline-graphic xlink:href="120378_inline10.gif" hwp:id="inline-graphic-10"/></alternatives></inline-formula> of the spectrum of <italic toggle="yes">P</italic>. Let <italic toggle="yes">η</italic>(<italic toggle="yes">t</italic>) be a probability distribution defined by normalizing these (nonnegative) eigenvalues as <inline-formula hwp:id="inline-formula-11"><alternatives hwp:id="alternatives-18"><inline-graphic xlink:href="120378_inline11.gif" hwp:id="inline-graphic-11"/></alternatives></inline-formula>. Then, the VNE <italic toggle="yes">H</italic>(<italic toggle="yes">t</italic>) of <italic toggle="yes">A<sup>t</sup></italic> (and equivalently of <italic toggle="yes">P<sup>t</sup></italic>) is given by the entropy of <italic toggle="yes">η</italic>(<italic toggle="yes">t</italic>), i.e.,
<disp-formula id="eqn7" hwp:id="disp-formula-8" hwp:rev-id="xref-disp-formula-8-1">
<alternatives hwp:id="alternatives-19"><graphic xlink:href="120378_eqn7.gif" position="float" orientation="portrait" hwp:id="graphic-16"/></alternatives>
</disp-formula>
where we use the convention of 0 log(0) ≜ 0. The VNE <italic toggle="yes">H</italic>(<italic toggle="yes">t</italic>) is dominated by the relatively large eigenvalues, while eigenvalues that are relatively small contribute little. Therefore, it provides a measure of the number of the relatively significant eigenvalues.</p><p hwp:id="p-106">The VNE generally decreases as <italic toggle="yes">t</italic> increases. As mentioned previously, the initial decrease is primarily due to a denoising of the data as less significant eigenvalues (likely corresponding to noise) decrease rapidly to zero. The more significant eigenvalues (likely corresponding to signal) decrease much more slowly. Thus the overall rate of decrease in <italic toggle="yes">H</italic>(<italic toggle="yes">t</italic>) is high initially as the data is denoised but then low for larger values of <italic toggle="yes">t</italic> as the signal is smoothed. As <italic toggle="yes">t</italic> → ∞, eventually all but the first eigenvalue decrease to zero and so <italic toggle="yes">H</italic>(<italic toggle="yes">t</italic>) → 0.</p><p hwp:id="p-107">To choose <italic toggle="yes">t</italic>, we plot <italic toggle="yes">H</italic>(<italic toggle="yes">t</italic>) as a function of <italic toggle="yes">t</italic> as in the first plot of <xref ref-type="fig" rid="figS2" hwp:id="xref-fig-10-4" hwp:rel-id="F10">Figure S2C</xref>. Choosing <italic toggle="yes">t</italic> from among the values where <italic toggle="yes">H</italic>(<italic toggle="yes">t</italic>) is decreasing rapidly generally results in noisy visualizations and embeddings (second plot in <xref ref-type="fig" rid="figS2" hwp:id="xref-fig-10-5" hwp:rel-id="F10">Figure S2C</xref>). Very large values of <italic toggle="yes">t</italic> result in a visualization where some of the branches or trajectories are combined together and some of the signal is lost (fourth plot in <xref ref-type="fig" rid="figS2" hwp:id="xref-fig-10-6" hwp:rel-id="F10">Figure S2C</xref>). Good PHATE visualizations can be obtained by choosing <italic toggle="yes">t</italic> from among the values where the decrease in <italic toggle="yes">H</italic>(<italic toggle="yes">t</italic>) is relatively slow, i.e. the set of values around the “knee” in the plot of <italic toggle="yes">H</italic>(<italic toggle="yes">t</italic>) (third plot in <xref ref-type="fig" rid="figS2" hwp:id="xref-fig-10-7" hwp:rel-id="F10">Figure S2C</xref> and the PHATE visualizations in <xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-9" hwp:rel-id="F1">Figure 1</xref>). This is the set of values for which much of the noise in the data has been smoothed away, and most of the signal is still intact. The PHATE visualization is fairly robust to the choice of <italic toggle="yes">t</italic> in this range, as discussed in Appendix A.1.2.</p><p hwp:id="p-108">In the code, we include an automatic method for selecting <italic toggle="yes">t</italic> based on a knee point detection algorithm that finds the knee by fitting two lines to the VNE curve [<xref ref-type="bibr" rid="c70" hwp:id="xref-ref-70-1" hwp:rel-id="ref-70">70</xref>]. This algorithm calculates the error between the VNE plot and two lines fitted to the data. The first line has endpoints at the first VNE value and the suggested knee point. The second line has endpoints at the suggested knee point and the last VNE value. The suggested knee point with the minimum error is selected.</p></sec><sec id="s6a1f" hwp:id="sec-28"><title hwp:id="title-30">Potential Distances</title><p hwp:id="p-109">To resolve instabilities in diffusion distances and embed the global structure captured by the diffusion geometry in low (2 or 3) dimensions, we instead use a novel diffusion-based informational distance, which we call potential distance (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-11" hwp:rel-id="F2">Figure 2E</xref>). It is calculated by computing the distance between log-transformed transition probabilities from the powered diffusion operator. The key insight in formulating the potential distance is that an informational distance between probability distributions is more sensitive to global relationships (between far-away points) and more stable at boundaries of manifolds than straight point-wise comparisons of probabilities (i.e., diffusion distances). This is because the diffusion distance is sensitive to differences between the main modes of the diffused probabilities and is largely insensitive to differences in the tails. In contrast, the potential distance, or more generally informational distances, use a submodular function (such as a log) to render distances sensitive to differences in both the main modes and the tails. This gives PHATE the ability to preserve both local and manifold-intrinsic global distances in a way that is optimized for visualization. The resulting metric space also quantifies differences between energy potentials that dominate “heat” propagation along diffusion pathways (i.e., based on the heat-equation diffusion model) between data points, instead of simply considering transition probabilities along them.</p><p hwp:id="p-110">The potential distance is inspired by information theory and stochastic dynamics, both fields where probability distributions are compared for different purposes. First, in information theory literature, information divergences are used to measure discrepancies between probability distributions in the information space rather than the probability space, as they are more sensitive to differences between the tails of the distributions as described above. Second, when analyzing dynamical systems of moving particles, it is not the point-wise difference between absolute particle counts that is used to compare states, but rather the ratio between these counts. Indeed, in the latter case the <italic toggle="yes">Boltzmann Distribution Law</italic> directly relates these ratios to differences in the energy of a state in the system. Therefore, similar to the information theory case, dynamical states are differentiated in energy terms, rather than probability terms. We employ the same reasoning in our case by defining our potential distance using localized diffusion energy potentials, rather than diffusion transition probabilities.</p><p hwp:id="p-111">To go from the probability space to the energy (or information) space, we log transform the probabilities in the powered diffusion operator and consider an <italic toggle="yes">L</italic><sup>2</sup> distance between these localized energy potentials in the data as our intrinsic data distance, which forms an M-divergence between the diffusion probability distributions [<xref ref-type="bibr" rid="c71" hwp:id="xref-ref-71-1" hwp:rel-id="ref-71">71</xref>,<xref ref-type="bibr" rid="c72" hwp:id="xref-ref-72-1" hwp:rel-id="ref-72">72</xref>].</p><p hwp:id="p-112">To provide further mathematical context to the potential distance used in PHATE, we relate it here to the heat propagation dynamics that govern the diffusion geometry and the diffusion process we use to build it. This heat diffusion process can be analyzed by considering two possible scenarios for the origin of the dataset <inline-formula hwp:id="inline-formula-12"><alternatives hwp:id="alternatives-20"><inline-graphic xlink:href="120378_inline12.gif" hwp:id="inline-graphic-12"/></alternatives></inline-formula> and its distribution <italic toggle="yes">p</italic>, as described in [<xref ref-type="bibr" rid="c65" hwp:id="xref-ref-65-3" hwp:rel-id="ref-65">65</xref>,<xref ref-type="bibr" rid="c66" hwp:id="xref-ref-66-4" hwp:rel-id="ref-66">66</xref>]. In the first scenario, the data generation process is modeled as an instantiation of a dynamical system that has reached an equilibrium state independent of the initial conditions. Mathematically, let <italic toggle="yes">U</italic>(<italic toggle="yes">x</italic>) be a potential and <italic toggle="yes">w</italic>(<italic toggle="yes">x</italic>) be a d-dimensional Brownian motion process. The data distribution is the steady state solution of the stochastic differential equation (SDE) <inline-formula hwp:id="inline-formula-13"><alternatives hwp:id="alternatives-21"><inline-graphic xlink:href="120378_inline13.gif" hwp:id="inline-graphic-13"/></alternatives></inline-formula>, where <inline-formula hwp:id="inline-formula-14"><alternatives hwp:id="alternatives-22"><inline-graphic xlink:href="120378_inline14.gif" hwp:id="inline-graphic-14"/></alternatives></inline-formula> denotes differentiation of <italic toggle="yes">x</italic> with respect to time. The time steps of the system are dominated by the forward and backward Fokker-Planck equations. This steady state solution is given by
<disp-formula hwp:id="disp-formula-9">
<alternatives hwp:id="alternatives-23"><graphic xlink:href="120378_ueqn2.gif" position="float" orientation="portrait" hwp:id="graphic-17"/></alternatives>
</disp-formula>
up to normalization in the <italic toggle="yes">L</italic><sup>1</sup> norm to form a proper probability distribution.</p><p hwp:id="p-113">The distribution of the data in this case is dominated by the potential <italic toggle="yes">U</italic> that models the underlying structure of the data. As an example, if the data is uniformly distributed on or around a manifold, then this potential is minimal on the manifold itself and increases rapidly when deviating from the manifold. The underlying potential also incorporates data densities that are not uniform. For example, data clusters are represented as local wells or pits in the underlying potential, while progression trajectories and transitions between clusters are represented as rivers or branches in the potential. See [<xref ref-type="bibr" rid="c65" hwp:id="xref-ref-65-4" hwp:rel-id="ref-65">65</xref>, <xref ref-type="bibr" rid="c66" hwp:id="xref-ref-66-5" hwp:rel-id="ref-66">66</xref>] for more details.</p><p hwp:id="p-114">In the second scenario, the data generation process is not modeled as a dynamical system. Instead, we consider the data in this case as generated by drawing <italic toggle="yes">N</italic> i.i.d. samples from the probability distribution <italic toggle="yes">p</italic>(<italic toggle="yes">x</italic>). We then artificially define the underlying potential of the data as
<disp-formula hwp:id="disp-formula-10">
<alternatives hwp:id="alternatives-24"><graphic xlink:href="120378_ueqn3.gif" position="float" orientation="portrait" hwp:id="graphic-18"/></alternatives>
</disp-formula></p><p hwp:id="p-115">The potential <italic toggle="yes">U</italic> can be used in this scenario since its properties and its relation to the structure of the data are not directly related to the notion of time. Furthermore, in both scenarios, the diffusion-based analysis introduces the notion of diffusion time to reveal intrinsic data geometry. Finally, as shown in [<xref ref-type="bibr" rid="c65" hwp:id="xref-ref-65-5" hwp:rel-id="ref-65">65</xref>, <xref ref-type="bibr" rid="c66" hwp:id="xref-ref-66-6" hwp:rel-id="ref-66">66</xref>], in both scenarios the Markov process that defines the diffusion geometry converges asymptotically to a diffusion process governed by Fokker-Planck equations with a potential 2<italic toggle="yes">U</italic>(<italic toggle="yes">x</italic>), whether the original potential is defined naturally or artificially.</p><p hwp:id="p-116">Using the same relationship between a potential <italic toggle="yes">U</italic> and an equilibrium distribution <italic toggle="yes">p</italic>, we can define a diffusion potential from the stationary distribution <italic toggle="yes">p</italic><sup>∞</sup> as <italic toggle="yes">U</italic><sup>∞</sup> = −log(<italic toggle="yes">p</italic><sup>∞</sup>). This potential corresponds to data generation using the random walk process defined by <italic toggle="yes">P<sub>ε</sub></italic> with <italic toggle="yes">t</italic> → ∞ with random initial conditions. Similarly, if we consider a data generation process using this random walk process with <italic toggle="yes">t</italic>-steps and a fixed initial condition <italic toggle="yes">δ<sub>x</sub></italic>, then the generated data is distributed according to <inline-formula hwp:id="inline-formula-15"><alternatives hwp:id="alternatives-25"><inline-graphic xlink:href="120378_inline15.gif" hwp:id="inline-graphic-15"/></alternatives></inline-formula> and the corresponding <italic toggle="yes">t</italic>-step potential representation of <italic toggle="yes">x</italic> is <inline-formula hwp:id="inline-formula-16"><alternatives hwp:id="alternatives-26"><inline-graphic xlink:href="120378_inline16.gif" hwp:id="inline-graphic-16"/></alternatives></inline-formula>.</p><p hwp:id="p-117">Given the potential representations <inline-formula hwp:id="inline-formula-17"><alternatives hwp:id="alternatives-27"><inline-graphic xlink:href="120378_inline17.gif" hwp:id="inline-graphic-17"/></alternatives></inline-formula> of the data in <inline-formula hwp:id="inline-formula-18"><alternatives hwp:id="alternatives-28"><inline-graphic xlink:href="120378_inline18.gif" hwp:id="inline-graphic-18"/></alternatives></inline-formula>, we define the following potential distance metric as an alternative to the distribution-based diffusion distance:</p><statement hwp:id="statement-1"><label>Definition 1.</label><p hwp:id="p-118"><italic toggle="yes">The t</italic>-step <bold>potential distance</bold> <italic toggle="yes">is defined as</italic> <inline-formula hwp:id="inline-formula-19"><alternatives hwp:id="alternatives-29"><inline-graphic xlink:href="120378_inline19.gif" hwp:id="inline-graphic-19"/></alternatives></inline-formula>.</p><p hwp:id="p-119">The following proposition shows a relation between the two metrics by expressing the potential distance in embedded diffusion map coordinates<xref ref-type="fn" rid="fn1" hwp:id="xref-fn-3-1" hwp:rel-id="fn-3"><sup>1</sup></xref> for fixed-bandwidth Gaussian-based diffusion (i.e., generated by <italic toggle="yes">P<sub>ε</sub></italic> from <xref ref-type="disp-formula" rid="eqn2" hwp:id="xref-disp-formula-2-1" hwp:rel-id="disp-formula-2">Eq. 2</xref>):</p></statement><statement hwp:id="statement-2"><label>Proposition 1.</label><p hwp:id="p-120"><italic toggle="yes">Given a diffusion process defined by a fixed-bandwidth Gaussian kernel, the potential distance from Def 1 can be written as</italic> <inline-formula hwp:id="inline-formula-20"><alternatives hwp:id="alternatives-30"><inline-graphic xlink:href="120378_inline20.gif" hwp:id="inline-graphic-20"/></alternatives></inline-formula></p><p hwp:id="p-121"><italic toggle="yes">Proof</italic>. According to the spectral theorem, the entries of <inline-formula hwp:id="inline-formula-21"><alternatives hwp:id="alternatives-31"><inline-graphic xlink:href="120378_inline21.gif" hwp:id="inline-graphic-21"/></alternatives></inline-formula> can be written as
<disp-formula hwp:id="disp-formula-11">
<alternatives hwp:id="alternatives-32"><graphic xlink:href="120378_ueqn4.gif" position="float" orientation="portrait" hwp:id="graphic-19"/></alternatives>
</disp-formula>
since powers of the operator <italic toggle="yes">P<sub>ε</sub></italic> only affect the eigenvalues, which are taken to the same power, and since the trivial eigenvalue λ<sub>0</sub> is one and the corresponding right eigenvector <italic toggle="yes">ϕ</italic><sub>0</sub> only consists of ones. Furthermore, it can be verified that the left and right eigenvectors of <italic toggle="yes">P<sub>ε</sub></italic> are related by <italic toggle="yes">ψ<sub>i</sub></italic>(<italic toggle="yes">y</italic>) = <italic toggle="yes">ϕ<sub>i</sub></italic>(<italic toggle="yes">y</italic>)<italic toggle="yes">ψ</italic><sub>0</sub>(<italic toggle="yes">y</italic>), thus, combined with <xref ref-type="disp-formula" rid="eqn4" hwp:id="xref-disp-formula-4-1" hwp:rel-id="disp-formula-4">Eqs. 4</xref> and <xref ref-type="disp-formula" rid="eqn6" hwp:id="xref-disp-formula-6-1" hwp:rel-id="disp-formula-6">6</xref>, we get
<disp-formula hwp:id="disp-formula-12">
<alternatives hwp:id="alternatives-33"><graphic xlink:href="120378_ueqn5.gif" position="float" orientation="portrait" hwp:id="graphic-20"/></alternatives>
</disp-formula></p><p hwp:id="p-122">By applying the logarithm to both ends of this equation we express the entries of the potential representation <inline-formula hwp:id="inline-formula-22"><alternatives hwp:id="alternatives-34"><inline-graphic xlink:href="120378_inline22.gif" hwp:id="inline-graphic-22"/></alternatives></inline-formula> as
<disp-formula hwp:id="disp-formula-13">
<alternatives hwp:id="alternatives-35"><graphic xlink:href="120378_ueqn6.gif" position="float" orientation="portrait" hwp:id="graphic-21"/></alternatives>
</disp-formula>
and thus for any <italic toggle="yes">j</italic> = 1,…, <italic toggle="yes">N</italic>,
<disp-formula hwp:id="disp-formula-14">
<alternatives hwp:id="alternatives-36"><graphic xlink:href="120378_ueqn7.gif" position="float" orientation="portrait" hwp:id="graphic-22"/></alternatives>
</disp-formula>
which yields the result in the proposition.</p></statement></sec><sec id="s6a1g" hwp:id="sec-29"><title hwp:id="title-31">Alternative Informational Distances</title><p hwp:id="p-123">We note that the potential distance is a particular case of a wider family of diffusion-based informational distances that view the diffusion geometry as a statistical manifold in information geometry. We offer a generalization of these to a family of distances, where the diffusion distance (<xref ref-type="disp-formula" rid="eqn5" hwp:id="xref-disp-formula-5-1" hwp:rel-id="disp-formula-5">Eq. 5</xref>) is at one extreme of this family and the potential distance (Def. 1) is at the other. Diffusion distances directly compare probability distributions pointwise with no <italic toggle="yes">damping</italic> of high probabilities. Thus changes in the tails of distributions do not contribute much to the distance. The potential distance is damped using the log function to the point where fold changes, even in low probabilities, have impact on the distance. Other distances, including the Hellinger distance [<xref ref-type="bibr" rid="c73" hwp:id="xref-ref-73-1" hwp:rel-id="ref-73">73</xref>], are in between these two. We introduce a parameter <italic toggle="yes">γ</italic> as a knob to control the level of damping, with the diffusion distance having <italic toggle="yes">γ</italic> = −1, the potential distance with <italic toggle="yes">γ</italic> =1 and the Hellinger distance at <italic toggle="yes">γ</italic> = 0.</p><p hwp:id="p-124">Mathematically, let the diffusion distributions <inline-formula hwp:id="inline-formula-23"><alternatives hwp:id="alternatives-37"><inline-graphic xlink:href="120378_inline23.gif" hwp:id="inline-graphic-23"/></alternatives></inline-formula> and <inline-formula hwp:id="inline-formula-24"><alternatives hwp:id="alternatives-38"><inline-graphic xlink:href="120378_inline24.gif" hwp:id="inline-graphic-24"/></alternatives></inline-formula> represent data points <italic toggle="yes">x</italic>, <inline-formula hwp:id="inline-formula-25"><alternatives hwp:id="alternatives-39"><inline-graphic xlink:href="120378_inline25.gif" hwp:id="inline-graphic-25"/></alternatives></inline-formula>. Given an intermediate data point <inline-formula hwp:id="inline-formula-26"><alternatives hwp:id="alternatives-40"><inline-graphic xlink:href="120378_inline26.gif" hwp:id="inline-graphic-26"/></alternatives></inline-formula>, and a meta-parameter −1 ≤ <italic toggle="yes">γ</italic> ≤ 1, let
<disp-formula id="eqn8" hwp:id="disp-formula-15">
<alternatives hwp:id="alternatives-41"><graphic xlink:href="120378_eqn8.gif" position="float" orientation="portrait" hwp:id="graphic-23"/></alternatives>
</disp-formula>
quantify the difference between the transition probabilities <inline-formula hwp:id="inline-formula-27"><alternatives hwp:id="alternatives-42"><inline-graphic xlink:href="120378_inline27.gif" hwp:id="inline-graphic-27"/></alternatives></inline-formula> from <italic toggle="yes">x,y</italic> to <italic toggle="yes">z</italic>. Then, diffusion distances and potential distances are given by <italic toggle="yes">L</italic><sup>2</sup> norms of <inline-formula hwp:id="inline-formula-28"><alternatives hwp:id="alternatives-43"><inline-graphic xlink:href="120378_inline28.gif" hwp:id="inline-graphic-28"/></alternatives></inline-formula> and <inline-formula hwp:id="inline-formula-29"><alternatives hwp:id="alternatives-44"><inline-graphic xlink:href="120378_inline29.gif" hwp:id="inline-graphic-29"/></alternatives></inline-formula> correspondingly (albeit with a different measure over <italic toggle="yes">z</italic>, since diffusion distances are defined over <inline-formula hwp:id="inline-formula-30"><alternatives hwp:id="alternatives-45"><inline-graphic xlink:href="120378_inline30.gif" hwp:id="inline-graphic-30"/></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="eqn5" hwp:id="xref-disp-formula-5-2" hwp:rel-id="disp-formula-5">Eq. 5</xref>). Therefore, these distances can be regarded as two extremes of a general family of distances over the diffusion geometry. Moreover, as we show in Prop 2, diffusion dissimilarities of the form <inline-formula hwp:id="inline-formula-31"><alternatives hwp:id="alternatives-46"><inline-graphic xlink:href="120378_inline31.gif" hwp:id="inline-graphic-31"/></alternatives></inline-formula> combine both this diffusion-geometry notion of a data-driven distance metric, and an information-theory notion of divergence between diffusion distributions, which is provided in Def. 2 for completeness.</p><statement hwp:id="statement-3"><label>Definition 2</label><p hwp:id="p-125">(Divergence [Information Theory]). <italic toggle="yes">Let S be a space of probability distributions with common support. A divergence on S is a function D</italic>(·||·): <italic toggle="yes">S × S</italic> → ℝ <italic toggle="yes">s.t. (1) D</italic>(<italic toggle="yes">p||q</italic>) ≥ 0 <italic toggle="yes">for all p,q</italic> ∈ <italic toggle="yes">S, and (2) D</italic>(<italic toggle="yes">p||q</italic>) = 0 <italic toggle="yes">if and only if p</italic> = <italic toggle="yes">q</italic> [<xref ref-type="bibr" rid="c74" hwp:id="xref-ref-74-1" hwp:rel-id="ref-74">74</xref>]. <italic toggle="yes">Some specific classes of divergences include</italic>:
<list list-type="roman-lower" hwp:id="list-3"><list-item hwp:id="list-item-8"><p hwp:id="p-126">M-divergence [<xref ref-type="bibr" rid="c71" hwp:id="xref-ref-71-2" hwp:rel-id="ref-71">71</xref>,<xref ref-type="bibr" rid="c72" hwp:id="xref-ref-72-2" hwp:rel-id="ref-72">72</xref>]: <italic toggle="yes">Let p and q be probability mass functions and let g be a differentiable function with continuous second derivative. Then the M-divergence between p and q is M<sub>g</sub></italic>(<italic toggle="yes">p, q</italic>) = Σ<sub><italic toggle="yes">i</italic></sub>(<italic toggle="yes">g</italic>(<italic toggle="yes">p<sub>i</sub></italic>) − <italic toggle="yes">g</italic>(<italic toggle="yes">q<sub>i</sub></italic>))<sup>2</sup>.</p></list-item><list-item hwp:id="list-item-9"><p hwp:id="p-127"><italic toggle="yes">f</italic>-divergence [<xref ref-type="bibr" rid="c75" hwp:id="xref-ref-75-1" hwp:rel-id="ref-75">75</xref>,<xref ref-type="bibr" rid="c76" hwp:id="xref-ref-76-1" hwp:rel-id="ref-76">76</xref>]: <italic toggle="yes">Let f be a convex function s.t. f</italic>(1) = 0 <italic toggle="yes">and let p and q be probability mass functions. The f-divergence between p and q is</italic> <inline-formula hwp:id="inline-formula-32"><alternatives hwp:id="alternatives-47"><inline-graphic xlink:href="120378_inline32.gif" hwp:id="inline-graphic-32"/></alternatives></inline-formula>.</p></list-item><list-item hwp:id="list-item-10"><p hwp:id="p-128">Bregman divergence [<xref ref-type="bibr" rid="c77" hwp:id="xref-ref-77-1" hwp:rel-id="ref-77">77</xref>]: <italic toggle="yes">Let</italic> Ω <italic toggle="yes">be a closed convex set and let F</italic>: Ω → ℝ <italic toggle="yes">be a strictly convex and continuously differentiable function. The Bregman divergence between the points p, q</italic> ∈ Ω <italic toggle="yes">is D<sub>F</sub></italic>(<italic toggle="yes">p, q</italic>) = <italic toggle="yes">F</italic>(<italic toggle="yes">p</italic>) − <italic toggle="yes">F</italic>(<italic toggle="yes">q</italic>) − 〈∇<italic toggle="yes">F</italic>(<italic toggle="yes">q</italic>),<italic toggle="yes">p</italic> − <italic toggle="yes">q</italic>〉, <italic toggle="yes">where</italic> ∇<italic toggle="yes">F</italic>(<italic toggle="yes">q</italic>) <italic toggle="yes">is the gradient of F evaluated at q</italic>.</p></list-item></list></p><p hwp:id="p-129">Unlike (formal) distance metrics, a divergence is not required to be symmetric nor satisfy the triangle inequality. Examples of <italic toggle="yes">f</italic>-divergences include the Kullback-Leibler divergence [<xref ref-type="bibr" rid="c78" hwp:id="xref-ref-78-1" hwp:rel-id="ref-78">78</xref>] and the Hellinger distance [<xref ref-type="bibr" rid="c73" hwp:id="xref-ref-73-2" hwp:rel-id="ref-73">73</xref>]. An example of a Bregman divergence is the squared Euclidean distance where <italic toggle="yes">F</italic>(<italic toggle="yes">x</italic>) = <italic toggle="yes">x</italic><sup>2</sup>. Note that these different types of divergences are not mutually exclusive as is evident in the following proposition.</p></statement><statement hwp:id="statement-4"><label>Proposition 2.</label><p hwp:id="p-130"><italic toggle="yes">The squared norm</italic> <inline-formula hwp:id="inline-formula-33"><alternatives hwp:id="alternatives-48"><inline-graphic xlink:href="120378_inline33.gif" hwp:id="inline-graphic-33"/></alternatives></inline-formula> <italic toggle="yes">forms an M-divergence between the diffusion probability distributions</italic> <inline-formula hwp:id="inline-formula-34"><alternatives hwp:id="alternatives-49"><inline-graphic xlink:href="120378_inline34.gif" hwp:id="inline-graphic-34"/></alternatives></inline-formula> <italic toggle="yes">and</italic> <inline-formula hwp:id="inline-formula-35"><alternatives hwp:id="alternatives-50"><inline-graphic xlink:href="120378_inline35.gif" hwp:id="inline-graphic-35"/></alternatives></inline-formula> <italic toggle="yes">for all γ</italic> ∈ [−1,1]. <italic toggle="yes">Furthermore</italic>, <inline-formula hwp:id="inline-formula-36"><alternatives hwp:id="alternatives-51"><inline-graphic xlink:href="120378_inline36.gif" hwp:id="inline-graphic-36"/></alternatives></inline-formula> <italic toggle="yes">forms an</italic> f-<italic toggle="yes">divergence for γ</italic> = 0 <italic toggle="yes">and a Bregman divergence for γ</italic> = −1.</p><p hwp:id="p-131"><italic toggle="yes">Proof</italic>. For <italic toggle="yes">γ</italic> ∈ (−1,1), it follows that <inline-formula hwp:id="inline-formula-37"><alternatives hwp:id="alternatives-52"><inline-graphic xlink:href="120378_inline37.gif" hwp:id="inline-graphic-37"/></alternatives></inline-formula> is an M-divergence from Definition 2 with <inline-formula hwp:id="inline-formula-38"><alternatives hwp:id="alternatives-53"><inline-graphic xlink:href="120378_inline38.gif" hwp:id="inline-graphic-38"/></alternatives></inline-formula>. Similarly, <italic toggle="yes">g</italic>(<italic toggle="yes">x</italic>) = <italic toggle="yes">x</italic> and <italic toggle="yes">g</italic>(<italic toggle="yes">x</italic>) = log<italic toggle="yes">x</italic> yield this result for <italic toggle="yes">γ</italic> = −1,1, respectively. For <italic toggle="yes">γ</italic> = 0, we obtain <inline-formula hwp:id="inline-formula-39"><alternatives hwp:id="alternatives-54"><inline-graphic xlink:href="120378_inline39.gif" hwp:id="inline-graphic-39"/></alternatives></inline-formula>, which is indeed an <italic toggle="yes">f</italic>-divergence as it is proportional to the Hellinger divergence. Finally, since <italic toggle="yes">γ</italic> = −1 yields a squared Euclidean distance between the distributions it is indeed a Bregman divergence.</p><p hwp:id="p-132">The family of distances (or divergences) formed by <inline-formula hwp:id="inline-formula-40"><alternatives hwp:id="alternatives-55"><inline-graphic xlink:href="120378_inline40.gif" hwp:id="inline-graphic-40"/></alternatives></inline-formula> is also directly related to <italic toggle="yes">α</italic>-representations used in information geometries [<xref ref-type="bibr" rid="c79" hwp:id="xref-ref-79-1" hwp:rel-id="ref-79">79</xref>] when defining statistical manifolds over probability distributions. Indeed, the <italic toggle="yes">α</italic>-representation of a distribution <italic toggle="yes">p</italic> is defined as
<disp-formula hwp:id="disp-formula-16">
<alternatives hwp:id="alternatives-56"><graphic xlink:href="120378_ueqn8.gif" position="float" orientation="portrait" hwp:id="graphic-24"/></alternatives>
</disp-formula>
where <italic toggle="yes">ℓ</italic><sup>(−1)</sup> and <italic toggle="yes">ℓ</italic><sup>(+1)</sup> give rise to the popular mixed family (<italic toggle="yes">m</italic>-family) and exponential family (<italic toggle="yes">e</italic>-family) in information geometry [<xref ref-type="bibr" rid="c79" hwp:id="xref-ref-79-2" hwp:rel-id="ref-79">79</xref>,<xref ref-type="bibr" rid="c80" hwp:id="xref-ref-80-1" hwp:rel-id="ref-80">80</xref>], correspondingly. We also note at this point that the third popular <italic toggle="yes">α</italic>-family in information geometry is the 0-family, which gives a Fisher geometry as its Riemannian metric as given by Fisher information [<xref ref-type="bibr" rid="c80" hwp:id="xref-ref-80-2" hwp:rel-id="ref-80">80</xref>]. Interestingly, this family corresponds to setting <italic toggle="yes">γ</italic> = 0 in our case, which yields a distance <inline-formula hwp:id="inline-formula-41"><alternatives hwp:id="alternatives-57"><inline-graphic xlink:href="120378_inline41.gif" hwp:id="inline-graphic-41"/></alternatives></inline-formula> that is proportional to the Hellinger distance between diffusion distributions.</p></statement><p hwp:id="p-133">Since, as we discussed here, <inline-formula hwp:id="inline-formula-42"><alternatives hwp:id="alternatives-58"><inline-graphic xlink:href="120378_inline42.gif" hwp:id="inline-graphic-42"/></alternatives></inline-formula> encodes differences between information geometry <italic toggle="yes">ℓ</italic><sup>(<italic toggle="yes">γ</italic>)</sup> representations of diffusion distributions, we refer to the distances <inline-formula hwp:id="inline-formula-43"><alternatives hwp:id="alternatives-59"><inline-graphic xlink:href="120378_inline43.gif" hwp:id="inline-graphic-43"/></alternatives></inline-formula> (from Prop. 2) as diffusion-based informational distances. In general, this family of informational distances creates an exciting connection between diffusion geometries and information geometries for exploring emergent structures in data exploration. In particular, in PHATE we focus on the potential distance as an <italic toggle="yes">e</italic>-family distance [<xref ref-type="bibr" rid="c79" hwp:id="xref-ref-79-3" hwp:rel-id="ref-79">79</xref>, <xref ref-type="bibr" rid="c80" hwp:id="xref-ref-80-3" hwp:rel-id="ref-80">80</xref>] that combines both the Boltzman distribution law approach and the information geometry approach towards capturing a stable metric structure of the diffusion geometry, and use it for the purpose of visualizing progression by embedding this metric structure in low dimensions.</p><p hwp:id="p-134"><xref ref-type="fig" rid="figS2" hwp:id="xref-fig-10-8" hwp:rel-id="F10">Figure S2D</xref> shows PHATE visualizations of the retinal bipolar data from [<xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-4" hwp:rel-id="ref-23">23</xref>] using different values of <italic toggle="yes">γ</italic>. This figure also indicates the impact of <italic toggle="yes">γ</italic> on the global structure captured by these distances, where indeed the global structure of the potential distance (<italic toggle="yes">γ</italic> = 1) is more similar (as compared to other <italic toggle="yes">γ</italic> values) to the structure captured by PCA, which is known to preserve global structure. Another way to see this is that the structure is unraveled less than when using diffusion distances.</p></sec><sec id="s6a1h" hwp:id="sec-30"><title hwp:id="title-32">Embedding the Potential Distances in Low Dimensions</title><p hwp:id="p-135">A popular approach for embedding diffusion geometries is to use the eigendecomposition of the diffusion operator to build a <italic toggle="yes">diffusion map</italic> of the data. However, this approach tends to isolate progression trajectories into numerous diffusion coordinates (i.e., eigenvectors of the diffusion operator; see <xref ref-type="fig" rid="figS1" hwp:id="xref-fig-9-3" hwp:rel-id="F9">Figure S1</xref>). In fact, this specific property was used in [<xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-4" hwp:rel-id="ref-14">14</xref>] as a heuristic for ordering cells along specific developmental tracks. Therefore, while diffusion maps preserve global structure and denoise the data, their higher intrinsic dimensionality is not amenable for visualization. Instead, we squeeze the variability into low dimensions using metric multidimensional scaling (MDS), a distance embedding method (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-12" hwp:rel-id="F2">Figure 2F</xref>).</p><p hwp:id="p-136">There are multiple approaches to MDS. Classical MDS (CMDS) [<xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-2" hwp:rel-id="ref-7">7</xref>] takes a distance matrix as input and embeds the data into a lower-dimensional space as follows. The squared potential distance matrix is double centered:
<disp-formula id="eqn9" hwp:id="disp-formula-17">
<alternatives hwp:id="alternatives-60"><graphic xlink:href="120378_eqn9.gif" position="float" orientation="portrait" hwp:id="graphic-25"/></alternatives>
</disp-formula>
where <inline-formula hwp:id="inline-formula-44"><alternatives hwp:id="alternatives-61"><inline-graphic xlink:href="120378_inline44.gif" hwp:id="inline-graphic-44"/></alternatives></inline-formula> is the squared potential distance matrix (i.e. each entry is squared) and <inline-formula hwp:id="inline-formula-45"><alternatives hwp:id="alternatives-62"><inline-graphic xlink:href="120378_inline45.gif" hwp:id="inline-graphic-45"/></alternatives></inline-formula> with 1 a vector of ones with length <italic toggle="yes">N</italic>. The CMDS coordinates are then obtained by an eigendecomposition of the matrix <italic toggle="yes">B</italic>. This is equivalent to minimizing the following “strain” function:
<disp-formula id="eqn10" hwp:id="disp-formula-18">
<alternatives hwp:id="alternatives-63"><graphic xlink:href="120378_eqn10.gif" position="float" orientation="portrait" hwp:id="graphic-26"/></alternatives>
</disp-formula>
over embedded <italic toggle="yes">m</italic>-dimensional coordinates <inline-formula hwp:id="inline-formula-46"><alternatives hwp:id="alternatives-64"><inline-graphic xlink:href="120378_inline46.gif" hwp:id="inline-graphic-46"/></alternatives></inline-formula> of data points in <inline-formula hwp:id="inline-formula-47"><alternatives hwp:id="alternatives-65"><inline-graphic xlink:href="120378_inline47.gif" hwp:id="inline-graphic-47"/></alternatives></inline-formula>. We apply CMDS to the potential distances of the data to obtain an initial configuration of the data in low dimension <italic toggle="yes">m</italic>.</p><p hwp:id="p-137">While classical MDS is computationally efficient relative to other MDS approaches, it assumes that the input distances directly correspond to low-dimensional Euclidean distances, which is overly restrictive in our setting. Metric MDS relaxes this assumption by only requiring the input distances to be a distance metric. Metric MDS then embeds the data into lower dimensions by minimizing the following “stress” function:
<disp-formula id="eqn11" hwp:id="disp-formula-19">
<alternatives hwp:id="alternatives-66"><graphic xlink:href="120378_eqn11.gif" position="float" orientation="portrait" hwp:id="graphic-27"/></alternatives>
</disp-formula>
over embedded m-dimensional coordinates <inline-formula hwp:id="inline-formula-48"><alternatives hwp:id="alternatives-67"><inline-graphic xlink:href="120378_inline48.gif" hwp:id="inline-graphic-48"/></alternatives></inline-formula> of data points in <inline-formula hwp:id="inline-formula-49"><alternatives hwp:id="alternatives-68"><inline-graphic xlink:href="120378_inline49.gif" hwp:id="inline-graphic-49"/></alternatives></inline-formula>.</p><p hwp:id="p-138">If the stress of the embedded points is zero, then the input data is faithfully represented in the MDS embedding. The stress may be nonzero due to noise or if the embedded dimension <italic toggle="yes">m</italic> is too small to represent the data without distortion. Thus, by choosing the number of MDS dimensions to be <italic toggle="yes">m</italic> = 2 (or <italic toggle="yes">m</italic> = 3) for visualization purposes, we may trade off distortion in exchange for readily visualizable coordinates. However, some distortion of the distances/dissimilarities is tolerable in many of our applications since precise dissimilarities between points on two different trajectories are not important as long as the trajectories are visually distinguishable. By using metric MDS, we find an embedding of the data with the desired dimension for visualization and the minimum amount of distortion as measured by the stress. When analyzing the PHATE coordinates (e.g. for clustering or branch detection), we use metric MDS with <italic toggle="yes">m</italic> chosen to explain most of the variance in the data as determined by the eigenvalues of the diffusion operator (as is done for von Neumann entropy). In this case, minimal distortion is introduced into the analysis.</p><p hwp:id="p-139">A naïve approach towards obtaining a truly low dimensional embedding of diffusion geometries is to directly apply metric MDS, from the diffusion map space to a two dimensional space. However, as seen in <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-6" hwp:rel-id="F11">Figures S3</xref> (Column 5) and S7, direct embedding of these distances produces distorted visualizations. Embedding the potential distances (defined in Def. 1) is more stable at boundary conditions near end points compared to diffusion maps, even in the case of simple curves that contain no branching points. <xref ref-type="fig" rid="figS2" hwp:id="xref-fig-10-9" hwp:rel-id="F10">Figure S2A</xref> shows a half circle embedding with diffusion distances versus distances between log-scaled diffusion. We see that points are compressed towards the boundaries of the figure in the former. Additionally, this figure demonstrates that in the case of a full circle (i.e., with no end points or boundary conditions), our potential embedding (PHATE) yields the same representation as diffusion maps.</p><p hwp:id="p-140">In some cases, it may be advantageous to relax our assumptions further on the input distances. In this case, non-metric MDS may be used. In contrast with metric MDS, non-metric MDS does not require the input distances to be an actual distance or metric. Non-metric MDS minimizes the differences between a monotonic transformation of the input dissimilarities and the distances in the embedded space. Mathematically, non-metric MDS minimizes the following stress function:
<disp-formula id="eqn12" hwp:id="disp-formula-20">
<alternatives hwp:id="alternatives-69"><graphic xlink:href="120378_eqn12.gif" position="float" orientation="portrait" hwp:id="graphic-28"/></alternatives>
</disp-formula>
where <italic toggle="yes">f</italic> is a monotonic transformation of the distances between points in the embedded space.</p><p hwp:id="p-141">In our experience, the resulting visualizations from metric MDS and non-metric MDS are nearly identical for most datasets. Furthermore, metric MDS is computationally faster than non-metric MDS. Thus, we recommend metric MDS for most problems.</p></sec><sec id="s6a1i" hwp:id="sec-31"><title hwp:id="title-33">Overview Summary</title><p hwp:id="p-142">PHATE achieves an embedding that satisfies all four properties delineated above: PHATE preserves and emphasizes the global and local structure of the data via: 1. a localized affinity that is chained via diffusion to form global affinities through the intrinsic geometry of the data, 2. denoises the data by low-pass filtering through diffusion, 3. provides a distance that accounts for local and global relationships in the data and has robust boundary conditions for purposes of visualization, and 4. captures the data in low dimensions, using MDS, for visualization.</p><p hwp:id="p-143">We have shown by demonstration in <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-7" hwp:rel-id="F11">Figures S3</xref> and <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-5" hwp:rel-id="F15">S7</xref> that all of the steps of PHATE, including the potential transform and MDS, are necessary, as diffusion maps, t-SNE on diffusion maps, and MDS on diffusion maps fail to provide an adequate visualization in several benchmark test cases with known ground truth (even when using the same customized <italic toggle="yes">α</italic>-decaying kernel we developed for PHATE). We have also shown that PHATE is robust to the choice of parameters.</p></sec></sec><sec id="s6a2" hwp:id="sec-32"><label>A.1.2</label><title hwp:id="title-34">Robustness Analysis of PHATE</title><p hwp:id="p-144">Here we show that the PHATE embedding is robust to subsampling and the choice of parameters. We demonstrate this both qualitatively and quantitatively. For the quantitative demonstrations, we simulated scRNA-seq data using the Splatter package [<xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-2" hwp:rel-id="ref-22">22</xref>] as in <xref ref-type="sec" rid="s2b" hwp:id="xref-sec-7-2" hwp:rel-id="sec-7">Section 2.2</xref>. We first calculated the geodesic pairwise distances for the noiseless data. Then for each setting, we calculated the pairwise Euclidean distances in the 2-dimensional embedding. We then compared the geodesic distances with the embedded distances via the Spearman correlation coefficient as discussed in <xref ref-type="sec" rid="s2b" hwp:id="xref-sec-7-3" hwp:rel-id="sec-7">Section 2.2</xref>. We used both the paths and groups options of the Splatter package. Simulation details are found in Appendix A.3.3.</p><sec id="s6a2a" hwp:id="sec-33"><title hwp:id="title-35">Subsampling Robustness</title><p hwp:id="p-145"><xref ref-type="table" rid="tbl1" hwp:id="xref-table-wrap-1-3" hwp:rel-id="T1">Table 1</xref> shows that PHATE is robust to subsampling on the Splatter datasets. For the paths dataset, the average Spearman correlation is the same when 95% and 50% of the data points are retained. For the groups dataset, the correlation drops slightly when going from 95% retention to 50% retention. Additionally, the correlation coefficient is still quite high (and better than all other methods) when only 5% of the data points are retained. Thus, quantitatively, PHATE is robust to subsampling.</p><p hwp:id="p-146">We also demonstrate this visually. We ran PHATE on the iPSC mass cytometry dataset from [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-11" hwp:rel-id="ref-16">16</xref>] with varying subsample sizes <italic toggle="yes">N</italic>. <xref ref-type="fig" rid="figS4" hwp:id="xref-fig-12-2" hwp:rel-id="F12">Figure S4A</xref> shows the PHATE embedding for <italic toggle="yes">N</italic> = 1000, 2500, 5000,10000. Note that the primary branches or trajectories that are visible when <italic toggle="yes">N</italic> = 50000 (<xref ref-type="fig" rid="figS6" hwp:id="xref-fig-14-7" hwp:rel-id="F14">Figure S6C</xref>) are still visible for all subsamples. Thus, PHATE is robust to the subsampling size. Similar results can be obtained on other datasets.</p></sec><sec id="s6a2b" hwp:id="sec-34"><title hwp:id="title-36">Parameter Robustness</title><p hwp:id="p-147">Here, we show that the PHATE embedding is robust to the choice of <italic toggle="yes">t, k</italic>, and <italic toggle="yes">α</italic>. <xref ref-type="fig" rid="figS4" hwp:id="xref-fig-12-3" hwp:rel-id="F12">Figure S4B</xref> shows the PHATE embedding on the iPSC mass cytometry dataset from [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-12" hwp:rel-id="ref-16">16</xref>] with varying scale parameter <italic toggle="yes">t</italic>. This figure shows that the embeddings for 50 ≤ <italic toggle="yes">t</italic> ≤ 200 are nearly identical. Thus, PHATE is very visually robust to the scale parameter <italic toggle="yes">t</italic>. Similar results can be obtained on other datasets and with the <italic toggle="yes">k</italic> and <italic toggle="yes">α</italic> parameters.</p><p hwp:id="p-148">The embedding is also quantitatively robust to the parameter choices. <xref ref-type="fig" rid="figS4" hwp:id="xref-fig-12-4" hwp:rel-id="F12">Figure S4C-D</xref> shows heatmaps of the Spearman correlation coefficient between geodesic distances of the ground truth data and the Euclidean distances of the PHATE visualization applied to the simulated Splatter datasets for different values of <italic toggle="yes">k, t</italic>, and <italic toggle="yes">α</italic>. For <italic toggle="yes">α</italic> ≥ 10, the correlation coefficients are very similar for all values of <italic toggle="yes">k</italic>, <italic toggle="yes">t</italic>, and <italic toggle="yes">α</italic>. This demonstrates that PHATE is robust to the choices of these parameters.</p></sec></sec><sec id="s6a3" hwp:id="sec-35"><label>A.1.3</label><title hwp:id="title-37">Scalability of PHATE</title><p hwp:id="p-149">The native form of PHATE is limited in scalability due to the computationally intensive steps of computing potential distances between all pairs of points, computing metric MDS, and storing in memory the diffused operator. Thus, we describe here, and in Algorithm 2, an alternative way to compute a PHATE embedding that is highly scalable and provides a good approximation of the native PHATE described previously. The scalable version of PHATE uses a slight difference in computing t-step diffusion probabilities between points. It requires that every other step that the diffusion takes goes through one of a small number of “landmarks.” Each landmark is selected to be a central point that is representative of a portion of the manifold, selected by spectrally clustering manifold dimensions.</p><p hwp:id="p-150">First, we construct the <italic toggle="yes">α</italic>-decaying kernel on the entire dataset. This can be calculated efficiently and stored as a sparse matrix by using radius-based nearest neighbor searches and thresholding (i.e., setting to zero) connections between points below a specified value (e.g., 0.0001), as we regard them numerically insignificant for the constructed diffusion process. The resulting affinity matrix <italic toggle="yes">K<sub>k,α</sub></italic> will be sparse as long as <italic toggle="yes">α</italic> is sufficiently large (e.g., <italic toggle="yes">α</italic> ≥ 10) to enforce sharp decay of the captured local affinities. The full diffusion operator <italic toggle="yes">P</italic> is constructed from <italic toggle="yes">K<sub>k,α</sub></italic> by normalizing by row-sums as described previously.</p><p hwp:id="p-151">However, powering the sparse diffusion operator would result in a dense matrix, causing memory issues. To avoid this, we instead perform diffusion between points via a series of <italic toggle="yes">M</italic> landmarks where <italic toggle="yes">M</italic> &lt; <italic toggle="yes">N</italic>. We select the landmarks by first applying PCA to the diffusion operator and then using <italic toggle="yes">k</italic>-means clustering on the principal components to partition the data into <italic toggle="yes">M</italic> clusters. This is a variation on spectral clustering. We then calculate the probability of transitioning in a single step from the <italic toggle="yes">i</italic>-th point in <inline-formula hwp:id="inline-formula-50"><alternatives hwp:id="alternatives-70"><inline-graphic xlink:href="120378_inline50.gif" hwp:id="inline-graphic-50"/></alternatives></inline-formula> to any point in the <italic toggle="yes">j</italic>-th cluster for all pairs of points and clusters. Mathematically, we can write this as
<disp-formula id="eqn13" hwp:id="disp-formula-21">
<alternatives hwp:id="alternatives-71"><graphic xlink:href="120378_eqn13.gif" position="float" orientation="portrait" hwp:id="graphic-29"/></alternatives>
</disp-formula>
where <italic toggle="yes">C<sub>j</sub></italic> is the set of points in the <italic toggle="yes">j</italic>th cluster. Thus, we can view each cluster as being represented by a landmark and the (<italic toggle="yes">i, j</italic>)-th entry in <italic toggle="yes">P<sub>NM</sub></italic> gives the probability of transitioning from the <italic toggle="yes">i</italic>th point in <inline-formula hwp:id="inline-formula-51"><alternatives hwp:id="alternatives-72"><inline-graphic xlink:href="120378_inline51.gif" hwp:id="inline-graphic-51"/></alternatives></inline-formula> to the <italic toggle="yes">j</italic>-th landmark in a single step. Similarly, we construct the matrix <italic toggle="yes">P<sub>MN</sub></italic> where the (<italic toggle="yes">j, i</italic>)-th entry contains the probability of transitioning from the <italic toggle="yes">j</italic>-th landmark to the <italic toggle="yes">i</italic>-th point in <inline-formula hwp:id="inline-formula-52"><alternatives hwp:id="alternatives-73"><inline-graphic xlink:href="120378_inline52.gif" hwp:id="inline-graphic-52"/></alternatives></inline-formula>. In this case, we cannot simply sum the transition probabilities <italic toggle="yes">P</italic>(<italic toggle="yes">ξ, i</italic>), <italic toggle="yes">ξ</italic> ∈ <italic toggle="yes">C<sub>j</sub></italic>, since we also have to consider the prior probability <italic toggle="yes">Q</italic>(<italic toggle="yes">j,ξ</italic>) of the <italic toggle="yes">ξ</italic>-th point (with <italic toggle="yes">ξ</italic> ∈ <italic toggle="yes">C<sub>j</sub></italic>) being the source of a transition from a cluster <italic toggle="yes">C<sub>j</sub></italic>. For this purpose we use the prior proposed in [<xref ref-type="bibr" rid="c81" hwp:id="xref-ref-81-1" hwp:rel-id="ref-81">81</xref>], and write
<disp-formula id="eqn14" hwp:id="disp-formula-22">
<alternatives hwp:id="alternatives-74"><graphic xlink:href="120378_eqn14.gif" position="float" orientation="portrait" hwp:id="graphic-30"/></alternatives>
</disp-formula>
with <italic toggle="yes">Q</italic>(<italic toggle="yes">j,ξ</italic>) = Σ<sub><italic toggle="yes">i</italic></sub> <italic toggle="yes">K<sub>k,α</sub></italic>(<italic toggle="yes">ξ,i</italic>)/Σ<sub><italic toggle="yes">ζ∈C<sub>j</sub></italic></sub> Σ<sub><italic toggle="yes">i</italic></sub> <italic toggle="yes">K<sub>k,α</sub></italic>(<italic toggle="yes">ζ,i</italic>).</p><fig id="ufig2" position="float" orientation="portrait" fig-type="figure" hwp:id="F8"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/UFIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F8</object-id><object-id pub-id-type="publisher-id">ufig2</object-id><graphic xlink:href="120378_ufig2" position="float" orientation="portrait" hwp:id="graphic-31"/></fig><p hwp:id="p-152">We use the two constructed transition matrices to compute <italic toggle="yes">P<sub>MM</sub></italic> = <italic toggle="yes">P<sub>MN</sub>P<sub>NM</sub></italic>, which provides the probability of transitioning from landmark to landmark in a random walk by walking through the full point space. Diffusion is then performed by powering the matrix <italic toggle="yes">P<sub>MM</sub></italic>. This can be written as
<disp-formula id="eqn15" hwp:id="disp-formula-23">
<alternatives hwp:id="alternatives-75"><graphic xlink:href="120378_eqn15.gif" position="float" orientation="portrait" hwp:id="graphic-32"/></alternatives>
</disp-formula></p><p hwp:id="p-153">From this expression, we see that powering the matrix <italic toggle="yes">P<sub>MM</sub></italic> is equivalent to taking a random walk between landmarks by walking from landmarks to points and then back to landmarks <italic toggle="yes">t</italic> times.</p><p hwp:id="p-154">We then embed the landmarks into the PHATE space by calculating the potential distances between landmarks and applying metric MDS to the potential distances. Denote the resulting embedding as <italic toggle="yes">Y</italic><sub>landmarks</sub>. We then perform an out of sample extension to all points from the landmarks by multiplying the point to landmark transition matrix <italic toggle="yes">P<sub>NM</sub></italic> by <italic toggle="yes">Y</italic><sub>landmarks</sub> to get
<disp-formula id="eqn16" hwp:id="disp-formula-24">
<alternatives hwp:id="alternatives-76"><graphic xlink:href="120378_eqn16.gif" position="float" orientation="portrait" hwp:id="graphic-33"/></alternatives>
</disp-formula></p><p hwp:id="p-155">Since <italic toggle="yes">M</italic> is chosen to be vastly less than <italic toggle="yes">N</italic>, the memory requirements and computational demands of the powering the diffusion operator and embedding the potential distances are much lower.</p><p hwp:id="p-156">The described steps are summarized in Algorithm 2. In <xref ref-type="fig" rid="figS5" hwp:id="xref-fig-13-2" hwp:rel-id="F13">Figure S5A-E</xref> we show that this constrained diffusion preserves distances between datapoints in the final PHATE embedding, with the scalable version giving near-identical results to the exact computation of PHATE. Further, in <xref ref-type="fig" rid="figS5" hwp:id="xref-fig-13-3" hwp:rel-id="F13">Figure S5B</xref> we show that the embedding achieved by this approach is robust to the number of landmarks chosen.</p><p hwp:id="p-157">We note that if the only computational bottleneck were in computing MDS, scalable versions of MDS could be used [<xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-2" hwp:rel-id="ref-8">8</xref>,<xref ref-type="bibr" rid="c82" hwp:id="xref-ref-82-1" hwp:rel-id="ref-82">82</xref>,<xref ref-type="bibr" rid="c83" hwp:id="xref-ref-83-1" hwp:rel-id="ref-83">83</xref>]. However, since storing the entries of the powered diffusion operator in memory is also an issue, we employ the use of landmarks earlier in the process. It has also been shown that “compressing” the process of diffusion through landmarks in the fashion described here performs better than simply applying Nystrom extension (which includes landmark MDS [<xref ref-type="bibr" rid="c82" hwp:id="xref-ref-82-2" hwp:rel-id="ref-82">82</xref>]) to diffusion maps [<xref ref-type="bibr" rid="c84" hwp:id="xref-ref-84-1" hwp:rel-id="ref-84">84</xref>].</p><p hwp:id="p-158">The fast version of PHATE was used in <xref ref-type="fig" rid="fig5" hwp:id="xref-fig-6-6" hwp:rel-id="F6">Figures 5</xref>, <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-6" hwp:rel-id="F15">S7</xref>, <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-8" hwp:rel-id="F11">S3</xref>, <xref ref-type="fig" rid="figS2" hwp:id="xref-fig-10-10" hwp:rel-id="F10">S2D</xref>, <xref ref-type="fig" rid="figS5" hwp:id="xref-fig-13-4" hwp:rel-id="F13">S5A-E</xref>, <xref ref-type="fig" rid="figS10" hwp:id="xref-fig-18-4" hwp:rel-id="F18">S10</xref>, and <xref ref-type="fig" rid="figS11" hwp:id="xref-fig-19-5" hwp:rel-id="F19">S11</xref>. All other plots were generated using the exact version of PHATE.</p><sec id="s6a3a" hwp:id="sec-36"><title hwp:id="title-38">PHATE on Large Scale Datasets</title><p hwp:id="p-159">To demonstrate the scalability of PHATE for data exploration on large datasets, we applied PHATE to the 1.3 million mouse brain cell dataset from 10x [<xref ref-type="bibr" rid="c85" hwp:id="xref-ref-85-1" hwp:rel-id="ref-85">85</xref>]. <xref ref-type="fig" rid="figS5" hwp:id="xref-fig-13-5" hwp:rel-id="F13">Figure S5C</xref> shows a comparison of PHATE to t-SNE, colored by 10 of the 60 clusters provided by 10x. We see that PHATE retains cluster coherence while t-SNE shatters some of the cluster structure.</p></sec></sec><sec id="s6a4" hwp:id="sec-37"><label>A.1.4</label><title hwp:id="title-39">Branch Point Detection</title><p hwp:id="p-160">Here we describe the methods we developed for identifying branch points and selecting representative branch- and endpoints.</p><sec id="s6a4a" hwp:id="sec-38"><title hwp:id="title-40">Branch Point Identification</title><p hwp:id="p-161">We used the local intrinsic dimension estimation method derived in [<xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-2" hwp:rel-id="ref-17">17</xref>, <xref ref-type="bibr" rid="c86" hwp:id="xref-ref-86-1" hwp:rel-id="ref-86">86</xref>] to provide suggested branch points. The procedure is as follows. Let <bold>Z</bold><sub><italic toggle="yes">n</italic></sub> = {<bold>z</bold><sub>1</sub>,…, <bold>z</bold><sub><italic toggle="yes">n</italic></sub>} be a set of independent and identically distributed random vectors with values in a compact subset of ℝ<sup><italic toggle="yes">d</italic></sup>. Let <inline-formula hwp:id="inline-formula-53"><alternatives hwp:id="alternatives-77"><inline-graphic xlink:href="120378_inline53.gif" hwp:id="inline-graphic-53"/></alternatives></inline-formula> be the <italic toggle="yes">k</italic> nearest neighbors of <bold>z</bold><sub><italic toggle="yes">j</italic></sub>; i.e. <inline-formula hwp:id="inline-formula-54"><alternatives hwp:id="alternatives-78"><inline-graphic xlink:href="120378_inline54.gif" hwp:id="inline-graphic-54"/></alternatives></inline-formula>. The <italic toggle="yes">k</italic>-nn graph is formed by assigning edges between a point in <bold>Z</bold><sub><italic toggle="yes">n</italic></sub> and its <italic toggle="yes">k</italic>-nearest neighbors. The power-weighted total edge length of the <italic toggle="yes">k</italic>-nn graph is related to the intrinsic dimension of the data and is defined as
<disp-formula id="eqn17" hwp:id="disp-formula-25">
<alternatives hwp:id="alternatives-79"><graphic xlink:href="120378_eqn17.gif" position="float" orientation="portrait" hwp:id="graphic-34"/></alternatives>
</disp-formula>
where <italic toggle="yes">γ</italic> &gt; 0 is a power weighting constant. Let <italic toggle="yes">m</italic> be the global intrinsic dimension of all the data points in <bold>Z</bold><sub><italic toggle="yes">n</italic></sub>. It can be shown that for large <italic toggle="yes">n</italic>,
<disp-formula id="eqn18" hwp:id="disp-formula-26">
<alternatives hwp:id="alternatives-80"><graphic xlink:href="120378_eqn18.gif" position="float" orientation="portrait" hwp:id="graphic-35"/></alternatives>
</disp-formula>
where <italic toggle="yes">β</italic>(<italic toggle="yes">m</italic>) = (<italic toggle="yes">m</italic> − <italic toggle="yes">γ</italic>)/<italic toggle="yes">m, ϵ<sub>n</sub></italic> is an error term that decreases to 0 as <italic toggle="yes">n</italic> → ∞, and <italic toggle="yes">c</italic> is a constant with respect to <italic toggle="yes">β</italic>(<italic toggle="yes">m</italic>) [<xref ref-type="bibr" rid="c86" hwp:id="xref-ref-86-2" hwp:rel-id="ref-86">86</xref>]. A global intrinsic dimension estimator <italic toggle="yes">m</italic> can be defined based on this relationship using non-linear least squares regression over different values of <italic toggle="yes">n</italic> [<xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-3" hwp:rel-id="ref-17">17</xref>,<xref ref-type="bibr" rid="c86" hwp:id="xref-ref-86-3" hwp:rel-id="ref-86">86</xref>].</p><p hwp:id="p-162">A local estimator of intrinsic dimension <inline-formula hwp:id="inline-formula-55"><alternatives hwp:id="alternatives-81"><inline-graphic xlink:href="120378_inline55.gif" hwp:id="inline-graphic-55"/></alternatives></inline-formula> at a point <bold>z</bold><sub><italic toggle="yes">i</italic></sub> can be defined by running the above procedure in a smaller neighborhood about <bold>z</bold><sub><italic toggle="yes">i</italic></sub>. This approach is demonstrated in <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-4-8" hwp:rel-id="F4">Figure 3A</xref>, where a <italic toggle="yes">k</italic>-nn graph is grown locally at each point in the data. However, this estimator can have high variance within a neighborhood. To reduce this variance, majority voting within a neighborhood of <bold>z</bold><sub><italic toggle="yes">i</italic></sub> can be performed:
<disp-formula id="eqn19" hwp:id="disp-formula-27">
<alternatives hwp:id="alternatives-82"><graphic xlink:href="120378_eqn19.gif" position="float" orientation="portrait" hwp:id="graphic-36"/></alternatives>
</disp-formula>
where <inline-formula hwp:id="inline-formula-56"><alternatives hwp:id="alternatives-83"><inline-graphic xlink:href="120378_inline56.gif" hwp:id="inline-graphic-56"/></alternatives></inline-formula> is the indicator function [<xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-4" hwp:rel-id="ref-17">17</xref>].</p></sec><sec id="s6a4b" hwp:id="sec-39"><title hwp:id="title-41">Representative Point Selection with Shake and Bake</title><p hwp:id="p-163">To reduce branch points and endpoints to a set of representative points for branch analysis, we use a shake and bake procedure similar to that in [<xref ref-type="bibr" rid="c20" hwp:id="xref-ref-20-2" hwp:rel-id="ref-20">20</xref>]. Let <inline-formula hwp:id="inline-formula-57"><alternatives hwp:id="alternatives-84"><inline-graphic xlink:href="120378_inline57.gif" hwp:id="inline-graphic-57"/></alternatives></inline-formula> be the set of branch points and endpoints in the high-dimensional PHATE coordinates that we wish to reduce. We create a Voronoi partitioning of these points as follows. We first permute the order of <inline-formula hwp:id="inline-formula-58"><alternatives hwp:id="alternatives-85"><inline-graphic xlink:href="120378_inline58.gif" hwp:id="inline-graphic-58"/></alternatives></inline-formula>, which we denote as <inline-formula hwp:id="inline-formula-59"><alternatives hwp:id="alternatives-86"><inline-graphic xlink:href="120378_inline59.gif" hwp:id="inline-graphic-59"/></alternatives></inline-formula>. We then take the first point <italic toggle="yes">υ</italic><sub>1′</sub> and find all the points in <inline-formula hwp:id="inline-formula-60"><alternatives hwp:id="alternatives-87"><inline-graphic xlink:href="120378_inline60.gif" hwp:id="inline-graphic-60"/></alternatives></inline-formula> that are within a distance of <italic toggle="yes">h</italic>, where <italic toggle="yes">h</italic> is a scale parameter provided by the user. These points (including <italic toggle="yes">υ</italic><sub>1′</sub>) are assigned to the first component of the partition and removed from the set <inline-formula hwp:id="inline-formula-61"><alternatives hwp:id="alternatives-88"><inline-graphic xlink:href="120378_inline61.gif" hwp:id="inline-graphic-61"/></alternatives></inline-formula>. This process is then repeated until all points in <italic toggle="yes">V<sub>n</sub></italic> are assigned to the partition. To ensure that each point is assigned to the nearest component of the partition (as measured by proximity to the centroid), we next calculate the distance of each point to all centroids of the partition, and reassign the point to the component with the nearest centroid. This reassignment process is repeated until a stable partition is achieved. This completes the process of constructing the Voronoi partition.</p><p hwp:id="p-164">The Voronoi partition constructed from this process may be sensitive to the ordering of the points in <inline-formula hwp:id="inline-formula-62"><alternatives hwp:id="alternatives-89"><inline-graphic xlink:href="120378_inline62.gif" hwp:id="inline-graphic-62"/></alternatives></inline-formula>. To reduce this sensitivity, we repeat this process multiple times (e.g., 40-100) to create multiple Voronoi partitions. We then construct a distance between points by estimating the probability that two points are not in the same component from this partitioning process. This provides a notion of distance that is robust to noise, random permutations, and the scale parameter <italic toggle="yes">h</italic>. We then partition the data again using the above procedure except we use these probability-based distances. The representative points are then selected from the resulting centroids of this final partition.</p></sec><sec id="s6a4c" hwp:id="sec-40"><title hwp:id="title-42">Branch Detection</title><p hwp:id="p-165">We now describe how we assign data points to branches using the correlation and anticorrelation of neighborhood distances (in higher dimensional PHATE coordinates). The approach is demonstrated visually in <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-4-9" hwp:rel-id="F4">Figure 3Aiii</xref>. Here we consider two reference cells <italic toggle="yes">X</italic> and <italic toggle="yes">Y</italic>. We wish to determine if cells <italic toggle="yes">Q</italic><sub>1</sub> and <italic toggle="yes">Q</italic><sub>2</sub> belong to the branch between <italic toggle="yes">X</italic> and <italic toggle="yes">Y</italic> or not. Consider <italic toggle="yes">Q</italic><sub>1</sub> first which does belong to this branch. If we move from Q1 towards <italic toggle="yes">X</italic>, we also move farther away from <italic toggle="yes">Y</italic>. Thus the distances to <italic toggle="yes">X</italic> and <italic toggle="yes">Y</italic> of a neighborhood of points around <italic toggle="yes">Q</italic><sub>1</sub> (which will be located on the branch) are negatively correlated with each other. Now consider <italic toggle="yes">Q</italic><sub>2</sub> which does not belong to the branch between <italic toggle="yes">X</italic> and <italic toggle="yes">Y</italic>. In this case, if we move from <italic toggle="yes">Q</italic><sub>2</sub> towards <italic toggle="yes">Y</italic>, we also move closer to <italic toggle="yes">X</italic>. Thus the distances to <italic toggle="yes">X</italic> and <italic toggle="yes">Y</italic> of a neighborhood of points around <italic toggle="yes">Q</italic><sub>2</sub> are positively correlated with each other. In practice, these distance-based correlations are computed for each possible branch and the point is assigned to the branch with the largest anticorrelation (i.e. the most negative correlation coefficient).</p></sec></sec><sec id="s6a5" hwp:id="sec-41"><label>A.1.5</label><title hwp:id="title-43">EMD Score Analysis</title><p hwp:id="p-166">The EMD is measure of dissimilarity between two probability distributions that is particularly popular in computer vision [<xref ref-type="bibr" rid="c87" hwp:id="xref-ref-87-1" hwp:rel-id="ref-87">87</xref>]. The EMD was chosen to perform differential expression analysis in the EB scRNA-seq data due to its stability in estimation compared to other divergence measures. Intuitively, if each distribution is viewed as a pile of dirt, the EMD can be thought of as the minimum cost of converting one pile of dirt into the other. If the distributions are identical, then the cost is zero. When comparing univariate distributions (as we do as we only consider a single gene at a time), the EMD simplifies to the <italic toggle="yes">L</italic><sup>1</sup> distance between the cumulative distribution functions [<xref ref-type="bibr" rid="c58" hwp:id="xref-ref-58-2" hwp:rel-id="ref-58">58</xref>]. That is, if <italic toggle="yes">P</italic> and <italic toggle="yes">Q</italic> are the cumulative distributions of densities <italic toggle="yes">p</italic> and <italic toggle="yes">q</italic>, respectively, then the EMD between <italic toggle="yes">p</italic> and <italic toggle="yes">q</italic> is ∫ |<italic toggle="yes">P</italic>(<italic toggle="yes">x</italic>) − <italic toggle="yes">Q</italic>(<italic toggle="yes">x</italic>)|<italic toggle="yes">dx</italic>. While the EMD is nonnegative, we assign a sign to the EMD score based on the difference between the medians of the distributions.</p></sec></sec><sec id="s6b" hwp:id="sec-42"><label>A.2</label><title hwp:id="title-44">Biological Methods</title><p hwp:id="p-167">The processes for generating the EB data and for preprocessing the biological data are described here.</p><sec id="s6b1" hwp:id="sec-43"><label>A.2.1</label><title hwp:id="title-45">Generation of Human Embryoid Body Data</title><p hwp:id="p-168">Low passage H1 hESCs were maintained on Matrigel-coated dishes in DMEM/F12-N2B27 media supplemented with FGF2. For EB formation, cells were treated with Dispase, dissociated into small clumps and plated in non-adherent plates in media supplemented with 20% FBS, which was prescreened for EB differentiation. Samples were collected during 3-day intervals during a 27 day-long differentiation timecourse. An undifferentiated hESC sample was also included (<xref ref-type="fig" rid="figS12" hwp:id="xref-fig-20-6" hwp:rel-id="F20">Figure S12A</xref>). Induction of key germ layer markers in these EB cultures was validated by qPCR (data not shown). For single cell analyses, EB cultures were dissociated, FACS sorted to remove doublets and dead cells and processed on a 10x genomics instrument to generate cDNA libraries, which were then sequenced. Small scale sequencing determined that we have successfully collected data on approximately 31,000 cells equally distributed throughout the timecourse.</p></sec><sec id="s6b2" hwp:id="sec-44"><label>A.2.2</label><title hwp:id="title-46">Data Preprocessing</title><p hwp:id="p-169">In this section, we discuss methods we used to preprocess the various datasets.</p><sec id="s6b2a" hwp:id="sec-45"><title hwp:id="title-47">Data Subsampling</title><p hwp:id="p-170">The full PHATE implementation scales well for sample sizes up to approximately <italic toggle="yes">N</italic> = 50000. For <italic toggle="yes">N</italic> much larger than 50000, computational complexity can become an issue due to the multiple matrix operations required. All of the scRNAseq datasets considered in this paper have <italic toggle="yes">N</italic> &lt; 50000. Thus, we used the full data and did not subsample these datasets. However, the mass cytometry datasets have much larger sample sizes. To aid in branch analysis, we randomly subsampled these datasets for analysis in <xref ref-type="sec" rid="s3" hwp:id="xref-sec-10-1" hwp:rel-id="sec-10">Section 3</xref> using uniform subsampling. For the comparison figures (<xref ref-type="fig" rid="fig5" hwp:id="xref-fig-6-7" hwp:rel-id="F6">Figures 5</xref>, <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-9" hwp:rel-id="F11">S3</xref>, and <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-7" hwp:rel-id="F15">S7</xref>), scalable PHATE was used and subsampling was not performed except as indicated in the figures. The PHATE embedding is robust to the number of samples chosen, which we demonstrated in Appendix A.1.2.</p></sec><sec id="s6b2b" hwp:id="sec-46"><title hwp:id="title-48">Mass Cytometry Data Preprocessing</title><p hwp:id="p-171">We process the mass cytometry datasets according to [<xref ref-type="bibr" rid="c88" hwp:id="xref-ref-88-1" hwp:rel-id="ref-88">88</xref>].</p></sec><sec id="s6b2c" hwp:id="sec-47"><title hwp:id="title-49">Single-Cell RNA-Sequencing Data Preprocessing</title><p hwp:id="p-172">This data was processed from raw reads to molecule counts using the Cell Ranger pipeline [<xref ref-type="bibr" rid="c89" hwp:id="xref-ref-89-1" hwp:rel-id="ref-89">89</xref>]. Additionally, to minimize the effects of experimental artifacts on our analysis, we preprocess the scRNAseq data. We first filter out dead cells by removing cells that have high expression levels in mitochondrial DNA. In the case of the EB data which had a wide variation in library size, we then remove cells that are either below the 20th percentile or above the 80th percentile in library size. scRNA-seq data have large cell-to-cell variations in the number of observed molecules in each cell or <italic toggle="yes">library size</italic>. Some cells are highly sampled with many transcripts, while other cells are sampled with fewer. This variation is often caused by technical variations due to enzymatic steps including lysis efficiency, mRNA capture efficiency, and the efficiency of multiple amplification rounds [<xref ref-type="bibr" rid="c90" hwp:id="xref-ref-90-1" hwp:rel-id="ref-90">90</xref>]. Removing cells with extreme library size values helps to correct for these technical variations. We then drop genes that are only expressed in a few cells and then perform library size normalization. Normalization is accomplished by dividing the expression level of each gene in a cell by the library size of the corresponding cell.</p><p hwp:id="p-173">After normalizing by the library size, we take the square root transform of the data and then perform PCA to improve the robustness and reliability of the constructed affinity matrix <italic toggle="yes">K<sub>k,α</sub></italic>.</p><p hwp:id="p-174">We choose the number of principal components to retain approximately 70% of the variance in the data which results in 20-50 principal components.</p></sec><sec id="s6b2d" hwp:id="sec-48"><title hwp:id="title-50">Gut Microbiome Data Preprocessing</title><p hwp:id="p-175">We use the cleaned L6 American Gut data and remove samples that are near duplicates of other samples. We then preprocess the data using a similar approach for scRNA-seq data. We first perform “library size” normalization to account for technical variations in different samples. We then log transform the data and then use PCA to reduce the data to 30 dimensions.</p><p hwp:id="p-176">Applying PHATE to this data reveals several outlier samples that are very far from the rest of the data. We remove these samples and then reapply PHATE to the log-transformed data to obtain the results that are shown in <xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-10" hwp:rel-id="F1">Figure 1D</xref>.</p></sec><sec id="s6b2e" hwp:id="sec-49"><title hwp:id="title-51">ChIP-seq Processing for Hi-C Visualization</title><p hwp:id="p-177">We used narrow peak bed files and took the average peak intensity for each bin at a 10 kb resolution. For visualization, we smoothed the average peak intensity values based on location using a 25 bin moving average.</p></sec></sec></sec><sec id="s6c" hwp:id="sec-50"><label>A.3</label><title hwp:id="title-52">Comparison Details</title><p hwp:id="p-178">Here we provide details for the construction of the DEMaP score that we use to compare between dimensionality reduction methods. We also provide details on generating the artificial tree data and Splatter datasets, and for the parameter settings for all PHATE plots in the paper.</p><sec id="s6c1" hwp:id="sec-51"><label>A.3.1</label><title hwp:id="title-53">DEMaP</title><p hwp:id="p-179">To quantitatively compare each dimensionality reduction tool, we wish to calculate the degree to which each method preserves the underlying structure of the reference dataset and removes noise. Since single-cell RNA-sequencing and other biological types of data are highly noisy, visual renderings of the data that can offer denoised embeddings that reveal the underlying structure of the data are desirable. Therefore, the goal of our accuracy metric is to quantify the correspondence between distances in the low-dimensional embedding and manifold distances in the ground truth reference.</p><p hwp:id="p-180">To define a quantitative notion of manifold distance we use geodesic distances. Geodesic distances are shortest path distances on a nearest-neighbor graph of the data weighted by the Euclidean distances between connected points [<xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-3" hwp:rel-id="ref-4">4</xref>]. In cases where points are sampled noiselessly from a manifold, such as in our ground truth reference, geodesic distances converge exactly to distances along the manifold of the data [<xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-4" hwp:rel-id="ref-4">4</xref>,<xref ref-type="bibr" rid="c91" hwp:id="xref-ref-91-1" hwp:rel-id="ref-91">91</xref>]. Thus we reason that if geodesic distances between points on the noiseless manifold are preserved by an embedding computed on the noisy data then the data is sufficiently denoised and the manifold structure is also preserved.</p><p hwp:id="p-181">We take this approach to formulate our ground-truth manifold distance as a quantification of the degree to which each dimensionality reduction method preserves the pairwise geodesic distances of the noiseless data after low-dimensional embedding of the corresponding noisy data. Since the low dimensional embedding is often a result of a non-linear dimensionality reduction, curves and major paths in the data are “straightened” such that Euclidean distances in the embedding space correspond to manifold distance in the high dimensional space [<xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-3" hwp:rel-id="ref-7">7</xref>]. Thus we quantify the preservation of manifold distances as the correlation between geodesic distance in the noiseless reference dataset and Euclidean distances in the embedding space as a measure of structure preservation which we call <italic toggle="yes">Denoised Embedding Manifold Preservation (DEMaP)</italic>. An overview of DEMaP is presented in <xref ref-type="fig" rid="fig4" hwp:id="xref-fig-5-3" hwp:rel-id="F5">Figure 4A</xref>.</p></sec><sec id="s6c2" hwp:id="sec-52"><label>A.3.2</label><title hwp:id="title-54">Construction of the Artificial Tree Test Case</title><p hwp:id="p-182">The artificial tree data shown in <xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-11" hwp:rel-id="F1">Figure 1B</xref> is constructed as follows. The first branch consists of 100 linearly spaced points that progress in the first four dimensions. All other dimensions are set to zero. The 100 points in the second branch are constant in the first four dimensions with a constant value equal to the endpoint of the first branch. The next four dimensions then progress linearly in this branch while all other dimensions are set to zero. The third branch is constructed similarly except the progression occurs in dimensions 9-12 instead of dimensions 5-8. All remaining branches are constructed similarly with some variation in the length of the branches. We then add 40 points at each endpoint and branch point and add zero mean Gaussian noise with a standard deviation of 7. This construction models a system where progression along a branch corresponds to an increase in gene expression in several genes. Prior to adding noise, we also constructed a small gap between the first branch point and the orange branch that splits into a blue and purple branch (see the top set of branches in the left part of <xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-12" hwp:rel-id="F1">Figure 1B</xref>). This simulates gaps that are often present in measured biological data. We also added additional noise dimensions, bringing the total dimensionality of the data to 60.</p></sec><sec id="s6c3" hwp:id="sec-53"><label>A.3.3</label><title hwp:id="title-55">Splatter Simulation Details</title><p hwp:id="p-183">Splatter is a scRNA-seq simulation package that uses a parametric model to generate data with various structures, such as branches or clusters [<xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-3" hwp:rel-id="ref-22">22</xref>]. We use Splatter to simulate multiple ground truth datasets for multiple experiments. To select parameters for the simulation, we fit the Splatter simulation to the EB data, and then modified the resulting dataset from both the Splatter “paths” and the Splatter “groups” simulations as described in <xref ref-type="sec" rid="s2b" hwp:id="xref-sec-7-4" hwp:rel-id="sec-7">Section 2.2</xref>. Note that we do not make use of Splatter’s built-in dropout function, since it uses a zero-inflated model; multiple studies have shown that an undersampling (binomial) model is more appropriate [<xref ref-type="bibr" rid="c92" hwp:id="xref-ref-92-1" hwp:rel-id="ref-92">92</xref>–<xref ref-type="bibr" rid="c96" hwp:id="xref-ref-96-1" hwp:rel-id="ref-96">96</xref>]. Each simulation is performed with 3000 simulated cells. The mean correlation coefficient and standard deviations are calculated from 20 trials.</p><p hwp:id="p-184">The default parameters used in the simulation are the following: <monospace>batchCells = 3000, nGenes=17580, mean.shape=6.6, mean.rate=0.45, lib.loc=9.1, lib.scale=0.33, out.prob=0.016, out.facLoc=5.4, out.facScale=0.90, bcv.common=0.18, bcv.df=21.6, de.prob=0.2, dropout.type=“none”</monospace>, with a post-hoc binomial dropout of 50%. For the groups simulation we drew the number of groups <italic toggle="yes">n</italic> from a Poisson distribution with rate λ = 10, and then drew the <monospace>group.prob</monospace> parameter from a Dirich-let distribution with <italic toggle="yes">n</italic> categories and a uniform concentration <italic toggle="yes">α</italic><sub>1</sub> = ⋯ = <italic toggle="yes">α<sub>n</sub></italic> =1. For the paths simulation, we set <monospace>group.prob</monospace> as above, and additionally set the <italic toggle="yes">i</italic>th entry in the parameter <monospace>path.from</monospace> as a random integer between 0 and <italic toggle="yes">i</italic> − 1, drew the parameter <monospace>path.nonlinearProb</monospace> from a uniform distribution on the interval (0,1), and drew the parameter <monospace>path.skew</monospace> from a beta distribution with shape <italic toggle="yes">α</italic> = 10, <italic toggle="yes">β</italic> = 10. Note that here the library size was doubled from the fit value, since the EB data itself suffers from dropout. To reduce the number of genes for the <italic toggle="yes">n_genes</italic> simulation, we randomly removed genes post-hoc in order to avoid changing the state of the random number generator in building the simulation.</p><p hwp:id="p-185">For the ground truth simulations, we set <monospace>bcv.common</monospace> to 0, did not perform binomial dropout, and did not remove genes or cells. For the <italic toggle="yes">BCV</italic> simulation, we performed 50% post-hoc binomial dropout, did not remove genes or cells, and set <monospace>bcv.common</monospace> to 0, 0.25, and 0.5. For the <italic toggle="yes">dropout</italic> simulation, we set <monospace>bcv.common</monospace> to 0.18, did not remove genes or cells, and performed 0%, 50%, and 95% post-hoc binomial dropout. For the <italic toggle="yes">subsample</italic> simulation, we set <monospace>bcv.common</monospace> to 0.18, performed 50% post-hoc binomial dropout, did not remove genes, and subsampled rows of the matrix to retain 95%, 50%, and 5% of the total cells. For the <italic toggle="yes">n-genes</italic> simulation, we set <monospace>bcv.common</monospace> to 0.18, performed 50% post-hoc binomial dropout, did not remove cells, and subsampled columns of the matrix to retain 17000, 10000, and 2000 genes.</p></sec><sec id="s6b4" hwp:id="sec-54"><label>A.3.4</label><title hwp:id="title-56">PHATE Experimental Details</title><p hwp:id="p-186">For all of the quantitative comparisons, we have used the default parameter settings for the PHATE plots. For the majority of the qualitative comparisons in <xref ref-type="fig" rid="fig5" hwp:id="xref-fig-6-8" hwp:rel-id="F6">Figures 5</xref>, <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-8" hwp:rel-id="F15">S7</xref>, and <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-10" hwp:rel-id="F11">S3</xref>, we also used the default parameter settings for all methods. Exceptions to this are the artificial tree (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-11" hwp:rel-id="F11">Figure S3A</xref>), the intersecting circles (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-12" hwp:rel-id="F11">Figure S3D</xref>), and the MNIST dataset (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-13" hwp:rel-id="F11">Figure S3I</xref>). In these cases, the PHATE parameters have been tuned to give a clearer separation of the branches. However, in general, the default PHATE settings give good results on most datasets, especially those that are complex, high-dimensional, and noisy as demonstrated empirically in Appendix A.1.2. The default settings are also used in <xref ref-type="fig" rid="figS2" hwp:id="xref-fig-10-11" hwp:rel-id="F10">Figures S2D</xref>, <xref ref-type="fig" rid="figS5" hwp:id="xref-fig-13-6" hwp:rel-id="F13">S5A-E</xref>, <xref ref-type="fig" rid="figS10" hwp:id="xref-fig-18-5" hwp:rel-id="F18">S10</xref>, and <xref ref-type="fig" rid="figS11" hwp:id="xref-fig-19-6" hwp:rel-id="F19">S11</xref>. For all other PHATE plots, the parameters were tuned slightly to better highlight the structure of the data.</p></sec></sec><sec id="s6d" hwp:id="sec-55"><label>A.4</label><title hwp:id="title-57">Data Availability</title><p hwp:id="p-187">The embryoid body scRNA-seq and bulk RNA-seq datasets generated and analyzed during the current study are available in the Mendeley Data repository at: <ext-link l:rel="related" l:ref-type="uri" l:ref="http://dx.doi.org/10.17632/v6n743h5ng.1" ext-link-type="uri" xlink:href="http://dx.doi.org/10.17632/v6n743h5ng.1" hwp:id="ext-link-3">http://dx.doi.org/10.17632/v6n743h5ng.1</ext-link> <xref ref-type="fig" rid="figS12" hwp:id="xref-fig-20-7" hwp:rel-id="F20">Figure S12A</xref> contains images of the raw single cells while <xref ref-type="fig" rid="figS12" hwp:id="xref-fig-20-8" hwp:rel-id="F20">Figure S12F</xref> contains scatter plots showing the gating procedure for FACS sorting cell populations for the bulk RNA-seq data.</p></sec><sec id="s6e" hwp:id="sec-56"><label>A.5</label><title hwp:id="title-58">Code Availability</title><p hwp:id="p-188">Python, R, and Matlab implementations of PHATE are available on GitHub, for academic use: <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/KrishnaswamyLab/PHATE" ext-link-type="uri" xlink:href="https://github.com/KrishnaswamyLab/PHATE" hwp:id="ext-link-4">https://github.com/KrishnaswamyLab/PHATE</ext-link> An interactive tool for exploring PHATE on the EB data is available at: <ext-link l:rel="related" l:ref-type="uri" l:ref="https://www.krishnaswamylab.org/phatewebtool" ext-link-type="uri" xlink:href="https://www.krishnaswamylab.org/phatewebtool" hwp:id="ext-link-5">https://www.krishnaswamylab.org/phatewebtool</ext-link></p></sec></sec><sec id="s7" hwp:id="sec-57"><label>B</label><title hwp:id="title-59">Extended Comparison of PHATE to Other Methods</title><p hwp:id="p-189">Here we provide an extended qualitative comparison of PHATE to methods of dimensionality reduction, graph rendering, and visualization on multiple datasets. These comparisons are found in <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-14" hwp:rel-id="F11">Figures S3</xref> and <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-9" hwp:rel-id="F15">S7</xref>. Details on parameter selection are included in Appendix A.3.4.</p><p hwp:id="p-190"><xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-15" hwp:rel-id="F11">Figure S3</xref> shows comparisons on non-biological datasets. These include (in the order shown) A. Artificial tree data with 7 branches in 60 dimensions; B. Simulated Splatter path data [<xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-4" hwp:rel-id="ref-22">22</xref>]; C. Simulated Splatter groups data [<xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-5" hwp:rel-id="ref-22">22</xref>]; D. Three intersecting curves in 3 dimensions; E. Video of a rotating teapot [<xref ref-type="bibr" rid="c97" hwp:id="xref-ref-97-1" hwp:rel-id="ref-97">97</xref>]; F. Swiss roll data used in [<xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-5" hwp:rel-id="ref-4">4</xref>]; G. Frey faces video [<xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-1" hwp:rel-id="ref-6">6</xref>]; H. Columbia Object Image Library (COIL-20), 20 videos of rotating objects [<xref ref-type="bibr" rid="c98" hwp:id="xref-ref-98-1" hwp:rel-id="ref-98">98</xref>]; I. MNIST, 70,000 images of handwritten digits from 0 to 9 [<xref ref-type="bibr" rid="c99" hwp:id="xref-ref-99-1" hwp:rel-id="ref-99">99</xref>].</p><p hwp:id="p-191"><xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-10" hwp:rel-id="F15">Figure S7</xref> shows comparisons on biological datasets including (in the order shown) A. Developing mouse bone marrow cells, enriched for the myeloid and erythroid lineages, which were measured with the MARS-seq single cell RNA-sequencing technology [<xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-5" hwp:rel-id="ref-21">21</xref>]; B. Single cell RNA-sequencing of epithelial cells from mouse small intestine and organoids [<xref ref-type="bibr" rid="c100" hwp:id="xref-ref-100-1" hwp:rel-id="ref-100">100</xref>]; C. Mass cytometry data measuring T cell development into CD8+ and CD4+ T cells in mouse thymus [<xref ref-type="bibr" rid="c27" hwp:id="xref-ref-27-2" hwp:rel-id="ref-27">27</xref>]; D. New embryoid body data from a 27-day timecourse; E. Mass cytometry data showing iPSC reprogramming of mouse embryonic fibroblasts [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-13" hwp:rel-id="ref-16">16</xref>]; F. Single cell RNA-sequencing of mouse retinal bipolar cells [<xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-5" hwp:rel-id="ref-23">23</xref>]; G. Single cell RNA-sequencing of mouse cortical cells from the somatosensory cortex and hippocampal CA1 region [<xref ref-type="bibr" rid="c24" hwp:id="xref-ref-24-2" hwp:rel-id="ref-24">24</xref>].</p><p hwp:id="p-192">Some of these biological datasets represent differentiating processes within the body, and hence visualizing progression is key to understanding the structure of these datasets. Other artificial datasets show a combination of clusters and trajectories, while the artificial datasets give a plausible range of manifold structures that could be found in biological data.</p><p hwp:id="p-193">PHATE is primarily a dimensionality reduction method that takes high dimensional raw data and embeds it, via a metric preserving embedding, into low dimensions that naturally show trajectory structure. Thus, we focus our comparisons of PHATE to existing dimensionality reduction methods such as PCA, t-SNE, and diffusion maps.</p><p hwp:id="p-194">We note that several methods exist that focus on finding <italic toggle="yes">pseudotime</italic> orderings of cells, such as Wanderlust [<xref ref-type="bibr" rid="c26" hwp:id="xref-ref-26-2" hwp:rel-id="ref-26">26</xref>], Wishbone [<xref ref-type="bibr" rid="c27" hwp:id="xref-ref-27-3" hwp:rel-id="ref-27">27</xref>], and diffusion pseudotime [<xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-5" hwp:rel-id="ref-14">14</xref>]. Wanderlust can find single non-branching progressions. Wishbone recognizes a single branch, while diffusion pseudotimes provides potentially multiple branches. However, pseudotime approaches do not naturally provide a dimensionality reduction method to visualize such structure. Therefore, the resulting cell orderings can be difficult to interpret and verify, especially in the context of the entire data set. Since PHATE reveals the entire branching structure in low dimensions, it can be beneficial to visualize, verify and interpret the results of any pseudotime algorithm displayed on PHATE.</p><p hwp:id="p-195">These pseudotime methods can also be used alongside PHATE to order parts of the branching progressions. Indeed, we use Wanderlust on the EB data in <xref ref-type="sec" rid="s4" hwp:id="xref-sec-14-1" hwp:rel-id="sec-14">Section 4</xref> to extract ordering from the branches identified from PHATE. A comprehensive overview and comparison of state of the art pseudotime and trajectory inference methods for single-cell RNA sequencing is given in [<xref ref-type="bibr" rid="c101" hwp:id="xref-ref-101-1" hwp:rel-id="ref-101">101</xref>].</p><p hwp:id="p-196">A few pseudotime methods can create a visualization based on finding and rendering a differentiation tree structure, including SPADE [<xref ref-type="bibr" rid="c102" hwp:id="xref-ref-102-1" hwp:rel-id="ref-102">102</xref>,<xref ref-type="bibr" rid="c103" hwp:id="xref-ref-103-1" hwp:rel-id="ref-103">103</xref>] and Monocle2 [<xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-2" hwp:rel-id="ref-12">12</xref>]. However, SPADE is not well-suited for analyzing scRNA-seq data without prior knowledge (see [<xref ref-type="bibr" rid="c103" hwp:id="xref-ref-103-2" hwp:rel-id="ref-103">103</xref>] and <xref ref-type="sec" rid="s8b" hwp:id="xref-sec-75-1" hwp:rel-id="sec-75">Section B.2</xref>). Thus we only compare to Monocle2.</p><p hwp:id="p-197">Note that we do not include any metadata, such as sample time or clusters, in any of the analyses. Therefore, we are focusing on the performance of these methods in an unsupervised setting. Instead, we use this metadata as a tool for comparing the results of the various methods.</p><sec id="s7a" hwp:id="sec-58"><label>B.1</label><title hwp:id="title-60">Comparison of PHATE to Dimensionality Reduction Methods</title><p hwp:id="p-198"><xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-16" hwp:rel-id="F11">Figures S3</xref> and <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-11" hwp:rel-id="F15">S7</xref> compare the PHATE visualization to the dimensionality reduction methods of principal components analysis (PCA), Diffusion Maps (DM), Metric Multidimensional Scaling (MDS), MDS performed on Diffusion Maps, t=SNE, t-SNE performed on Diffusion Maps, Local Linear Embedding (LLE), Isomap, Force Directed Layout, UMAP and Monocle2 on nine non-biological datasets and seven biological datasets, including the five biological datasets shown on a subset of these methods in <xref ref-type="fig" rid="fig5" hwp:id="xref-fig-6-9" hwp:rel-id="F6">Figure 5</xref>. The datasets show a combination of intersecting and distinct manifolds, clusters, and branching trajectories, examining a range of both real biological manifolds and plausible challenging structures for visualization. The PHATE visualization most consistently distinguishes branches, trajectories and clusters in order to give a denoised representation of the underlying structure of the data. We focus on each method individually.</p><sec id="s7a1" hwp:id="sec-59"><title hwp:id="title-61">Comparison of PHATE to PCA</title><p hwp:id="p-199">PCA is a popular method of data analysis that uses eigen-decomposition of the covariance matrix to learn axes within the high-dimensional data that account for the largest amount of variance within the data [<xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-4" hwp:rel-id="ref-11">11</xref>]. However, PCA assumes a linear structure on the data, the visualization amounts to projecting the data onto a slicing plane, which creates a noisy visualization. Also, since biological data are rarely linear, PCA is unable to optimally reduce non-linear noise along the manifold and reveal progression structure in low dimensions. This is evident in <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-17" hwp:rel-id="F11">Figure S3A</xref> where we compare PCA to PHATE on artificial tree data. This data contains seven distinct branches uniformly sampled in 60 dimensions. See Appendix A.3.2 for details. PCA does capture some of the global structure in this relatively low-noise data. However, many branches are not visible in the first two PCA dimensions and the trajectories in the PCA visualization are noisy compared to the PHATE visualization, in which all seven branches are easily identifiable.</p><p hwp:id="p-200">For the other datasets in <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-18" hwp:rel-id="F11">Figures S3</xref> and <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-12" hwp:rel-id="F15">S7</xref>, PCA captures some of the overall global structure of the datasets. For example, the PCA dimensions in <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-13" hwp:rel-id="F15">Figure S7D</xref> encode the overall time progression of the noisy EB scRNA-seq data. Thus, PCA captures some of the global structure. However, PCA presents mostly a cloud of cells in this case and any finer branching structure is not visible. This contrasts with PHATE which shows multiple branches and trajectories. Similar results are obtained from the mouse bone marrow scRNA-seq and iPSC CyTOF datasets in <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-14" hwp:rel-id="F15">Figures S7A and E</xref> respectively, demonstrating that PCA is unable to accurately visualize the global and local structure of the data simultaneously.</p></sec><sec id="s7a2" hwp:id="sec-60"><title hwp:id="title-62">Comparison of PHATE to t-SNE</title><p hwp:id="p-201">t-SNE (t-distributed stochastic neighbor embedding) [<xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-6" hwp:rel-id="ref-1">1</xref>] is a visualization method that emphasizes local neighborhood structure within data. Recently, t-SNE has become popular for revealing cluster structure or separations in single cell data [<xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">2</xref>]. However, due to its emphasis on preserving local neighborhoods, t-SNE tends to shatter trajectories into clusters as seen in the artificial tree and intersecting curves in <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-19" hwp:rel-id="F11">Figures S3A and D</xref> as well as the EB data and the iPSC data in <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-15" hwp:rel-id="F15">Figures S7D and E</xref>. In all of these cases, the data naturally have a strong trajectory structure either by design (the artificial trees and intersecting curves) or due to the developmental nature of the data (the EB and iPSC datasets). Thus t-SNE creates the false impression that the data contain natural clusters, which could lead to incorrect analysis.</p><p hwp:id="p-202">Furthermore, the adaptive kernel used in t-SNE for calculating neighborhood probabilities tends to spread out neighbors such that dense clusters occupy proportionally more space in the visualization compared to sparse clusters [<xref ref-type="bibr" rid="c104" hwp:id="xref-ref-104-1" hwp:rel-id="ref-104">104</xref>]. Thus, the relative location of data points within the t-SNE embedding often does not accurately reflect the relationships between them. This is clearly visible in the t-SNE plot in <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-20" hwp:rel-id="F11">Figure S3A</xref> where the shattered branches are located far away from where they originated in the main structure in the artificial tree data. Similarly, t-SNE creates clusters in the EB and iPSC data in <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-16" hwp:rel-id="F15">Figures S7D and E</xref> which split the time samples into different components. Since the relative position of clusters in t-SNE is generally meaningless the overall progression of the data is destroyed.</p><p hwp:id="p-203">Even in the case where the data are more naturally separated into clusters, t-SNE can destroy the global information about the relative relationships between clusters due to this weakness. In contrast, PHATE separates clusters that are sufficiently separated from each other (see <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-21" hwp:rel-id="F11">Figure S3C</xref>) while maintaining the relative relationships of clusters based on the relative positions of the clusters in the PHATE embedding. In other words, PHATE preserves both the global and local structure while t-SNE only preserves local structure.</p><p hwp:id="p-204">One proposed solution to the failure of t-SNE to retain global structure is to use a random walk to learn the global structure, and then apply t-SNE to the resulting kernel [<xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-7" hwp:rel-id="ref-1">1</xref>]. One approach to do this is to apply t-SNE to DM. However, our experiments show that this fails to capture the global structure of the data. In the artificial tree data (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-22" hwp:rel-id="F11">Figure S3A</xref>) the intersecting curves (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-23" hwp:rel-id="F11">Figure S3D</xref>), as well as the new EB data (<xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-17" hwp:rel-id="F15">Figure S7D</xref>) t-SNE on DM shatters trajectories. Furthermore, in the retinal bipolar dataset (<xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-18" hwp:rel-id="F15">Figure S7F</xref>) t-SNE on DM shatters clusters and creates misleading trajectory-like structures. Hence, performing t-SNE on diffusion maps suffers from the same shortcomings as t-SNE, with additional distortion from the denoising aspect of diffusion maps, as t-SNE tends to shatter trajectories less frequently on noisier data (see <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-24" hwp:rel-id="F11">Figures S3A and B</xref>). Due to the nature of the t-SNE penalty function, global distances encoded in the diffusion distances are ignored, and the resulting embedding is a denoised equivalent of t-SNE, which is more prone to shattering trajectories than t-SNE and lacks the global structure benefits from Diffusion Maps.</p></sec><sec id="s7a3" hwp:id="sec-61"><title hwp:id="title-63">Comparison of PHATE to Diffusion Maps</title><p hwp:id="p-205">Diffusion maps effectively encode continuous relationships between cells. However, different trajectories are often encoded in different dimensions (i.e., since they represent different meta-stable states of the diffusion process) as seen in <xref ref-type="fig" rid="figS1" hwp:id="xref-fig-9-4" hwp:rel-id="F9">Figure S1</xref>, which is unsuitable for visualization. In contrast, PHATE effectively encodes trajectories in lower dimensions for visualization. This is also seen clearly in <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-25" hwp:rel-id="F11">Figures S3A and D</xref> in the comparison of PHATE to diffusion maps on the artificial tree and intersecting curves data (for each data set, the same kernel and diffusion scale <italic toggle="yes">t</italic> is used for both diffusion maps and PHATE). In this case, the diffusion maps visualization is denoised and the global structure is visible. However, multiple branches are not visible in the low-dimensional visualization of diffusion maps. In fact, approximately six diffusion maps coordinates are needed to separate all ten branches (see <xref ref-type="fig" rid="figS1" hwp:id="xref-fig-9-5" hwp:rel-id="F9">Figure S1</xref>). In contrast, all of the ten branches of the artificial tree data are clearly visible in the PHATE visualization. Similarly, multiple branches that are visible in the PHATE visualization are not visible in the diffusion maps visualization for the bone marrow and EB scRNA-seq datasets (<xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-19" hwp:rel-id="F15">Figures S7A and D</xref>, respectively). Additionally, the diffusion maps instabilities mentioned previously appear to cause very noisy data (e.g. the scRNA-seq data in <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-20" hwp:rel-id="F15">Figures S7A, B, and D</xref>) to contract too much into thin trajectories, which can distort some of the underlying progression structure. In summary, while diffusion maps works well for nonlinear dimensionality reduction, it is not well-suited for visualizing data with multiple trajectories due to its instabilities and its propensity to encode different trajectories in different dimensions.</p><p hwp:id="p-206">A logical question is whether applying MDS on diffusion distances would be sufficient for encoding the high dimensional spatial information from diffusion maps in low dimensions for visualization. However, in <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-26" hwp:rel-id="F11">Figures S3D and H</xref> on the intersecting curves and COIL20 we show that MDS on DM suffers equivalently from instability at boundary conditions and intersections of manifolds, producing a totally structureless embedding. Additionally, MDS on DM collapses trajectories into thin trajectories as shown on the mouse bone marrow scRNAseq, EB data, and iPSC CyTOF data (<xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-21" hwp:rel-id="F15">Figures S7A, D, and E</xref> respectively), masking the intricate structure visible in PHATE. Thus, performing MDS on diffusion maps without applying the informational potential transformation of PHATE is insufficient for high quality visualization.</p></sec><sec id="s7a4" hwp:id="sec-62"><title hwp:id="title-64">Comparison of PHATE to MDS</title><p hwp:id="p-207">Multidimensional scaling (MDS) [<xref ref-type="bibr" rid="c105" hwp:id="xref-ref-105-1" hwp:rel-id="ref-105">105</xref>] aims to preserve or approximate the metric structure of the data by optimizing a stress loss between original (Euclidean) distances and embedded ones. While MDS ostensibly preserves both local and global distances, it does not rely on or infer any particular intrinsic structure from the data. Therefore, it cannot separate meaningful relations in complex high dimensional data from superfluous ones. In particular, this causes MDS to be strongly affected by noise, as shown in Splatter simulations in <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-27" hwp:rel-id="F11">Figures S3B and C</xref> where the embeddings show no structure at all. Further, this causes problems in visualizing noisy biological datasets, such as the new EB scRNAseq data (<xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-22" hwp:rel-id="F15">Figure S7D</xref>) where local trajectories are lost, and the iPSC CyTOF data (<xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-23" hwp:rel-id="F15">Figure S7E</xref>) where the branching structure is entirely masked by noise. MDS also fails to separate clusters in noisy data, as shown in biological datasets from [<xref ref-type="bibr" rid="c24" hwp:id="xref-ref-24-3" hwp:rel-id="ref-24">24</xref>] and [<xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-6" hwp:rel-id="ref-23">23</xref>] (<xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-24" hwp:rel-id="F15">Figures S7F and G</xref>) as well as in MNIST (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-28" hwp:rel-id="F11">Figure S3I</xref>).</p></sec><sec id="s7a5" hwp:id="sec-63"><title hwp:id="title-65">Comparison of PHATE to Isomap</title><p hwp:id="p-208">Isomap [<xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-6" hwp:rel-id="ref-4">4</xref>] embeds the intrinsic metric structure of the data by applying MDS to geodesic distances, which are obtained by constructing a <italic toggle="yes">k</italic>-nearest neighbor graph over the data, and then applying all-pairs shortest path search (e.g., Dijkstra [<xref ref-type="bibr" rid="c106" hwp:id="xref-ref-106-1" hwp:rel-id="ref-106">106</xref>] or Floyd [<xref ref-type="bibr" rid="c107" hwp:id="xref-ref-107-1" hwp:rel-id="ref-107">107</xref>]) to compute distances. Like other manifold learning methods, Isomap works under the assumption that the data is sampled from an underlying manifold, and thus the geodesic distances approximate intrinsic manifold distances and the coordinate assigned by MDS should provide a global intrinsic coordinate system. However, this assumption is mainly valid when the manifold itself is convex, with no holes, and the data is sampled uniformly from it with only small amount of noise away from the manifold. Indeed, the main weaknesses of Isomap is its topological instability when such assumptions are not satisfied in practice [<xref ref-type="bibr" rid="c25" hwp:id="xref-ref-25-3" hwp:rel-id="ref-25">25</xref>,<xref ref-type="bibr" rid="c91" hwp:id="xref-ref-91-2" hwp:rel-id="ref-91">91</xref>,<xref ref-type="bibr" rid="c108" hwp:id="xref-ref-108-1" hwp:rel-id="ref-108">108</xref>], as we also show here. These instabilities render Isomap susceptible to spurious connections created in noisy datasets, as shown by the failure to separate branches on the artificial tree and Splatter paths (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-29" hwp:rel-id="F11">Figure S3A and B</xref>). Further, Isomap is incapable of embedding clusters, such as the Splatter groups (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-30" hwp:rel-id="F11">Figure S3D</xref>), the mouse retinal bipolar scR-NAseq (<xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-25" hwp:rel-id="F15">Figure S7F</xref>), and MNIST (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-31" hwp:rel-id="F11">Figure S3I</xref>), in which many clusters are merged together since geodesic distances do not consider the data distribution and do not quantify relations between disconnected clusters. Additionally, Isomap is also unstable to intersecting manifolds, as shown by the Intersecting Curves dataset, where Isomap fails to distinguish between two of the curves and shows no intersections (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-32" hwp:rel-id="F11">Figure S3D</xref>), and does not clearly display branching points, as shown on the iPSC data where Isomap only separates points by timepoint (<xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-26" hwp:rel-id="F15">Figure S7E</xref>).</p></sec><sec id="s7a6" hwp:id="sec-64"><title hwp:id="title-66">Comparison of PHATE to Locally Linear Embedding (LLE)</title><p hwp:id="p-209">LLE [<xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-2" hwp:rel-id="ref-6">6</xref>] is a manifold learning algorithm that is similar to Isomap in that it assumes the data is sampled from a single smooth manifold, approximated by a <italic toggle="yes">k</italic>-NN graph, and tries to use its geometric properties to embed the data. However, unlike Isomap, it only considers local information - namely, it uses the low dimensional coordinate neighborhoods, which are (independently) linearly related to local manifold patches, and attempts to tile these local coordinates into a consistent global embedding in low dimensions. This is done by first optimizing weights that allow the approximation of each data point as a linear combination of its neighbors, and then optimizing low dimensional coordinates that preserve the same linear relations encoded by these weights.</p><p hwp:id="p-210">While LLE is less susceptible to shortcut connections, it heavily relies on a smooth well-connected manifold structure to provide global connections through the data. Therefore, LLE is ill-suited for embedding separate clusters, as shown by its failure to separate the distinct digits in the MNIST dataset (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-33" hwp:rel-id="F11">Figure S3I</xref>). Further, due to its reliance on local interpolation for encoding relations between each point and its neighbors, it strongly affected by boundary conditions that make such interpolation unstable, as shown by its complete failure to embed the Gaussian Mixture Model (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-34" hwp:rel-id="F11">Figure S3C</xref>). Additionally, LLE does not handle intersecting manifolds and high curvatures, due its implicit assumption that local data patches correspond to manifold coordinate neighborhoods, which can be linearly approximated by a tangent space of the same intrinsic dimension of the manifold. For example, on the Intersecting Curves dataset, while PHATE shows a clean intersection between the curves, LLE treats one of the intersections as a noisy subcluster, and the other intersection is not shown, with the orange curve shown simply as a continuation of the blue curve (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-35" hwp:rel-id="F11">Figure S3D</xref>). Finally, we note that some additional weaknesses of LLE for visualization of even simple synthetic biomedical data were reported previously, e.g., in [<xref ref-type="bibr" rid="c25" hwp:id="xref-ref-25-4" hwp:rel-id="ref-25">25</xref>,<xref ref-type="bibr" rid="c109" hwp:id="xref-ref-109-1" hwp:rel-id="ref-109">109</xref>].</p></sec><sec id="s7a7" hwp:id="sec-65"><title hwp:id="title-67">Comparison of PHATE to UMAP</title><p hwp:id="p-211">Like t-SNE, upon which the UMAP algorithm is modeled, UMAP encourages formation of clusters even when cluster structures do not exist. As such, UMAP shatters trajectories, as shown in the artificial trees and intersecting circles (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-36" hwp:rel-id="F11">Figures S3A and D</xref> respectively) as well as in the new EB data (<xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-27" hwp:rel-id="F15">Figure S7D</xref>). Additionally, although UMAP’s algorithm is designed to respect global relationships between the clusters that it forms, this does not always hold between distant clusters; take for example the artificial tree, in which UMAP places the shattered cyan branch at the opposite end of the plot to the green and yellow branches to which it is connected, and does the same for the purple branch, which should be connected to be the brown, orange and red branches, but is placed far from all of these (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-37" hwp:rel-id="F11">Figure S3A</xref>).</p></sec></sec><sec id="s7b" hwp:id="sec-66"><label>B.2</label><title hwp:id="title-68">Comparison of PHATE to Graph-Rendering Methods</title><p hwp:id="p-212">Graph-rendering methods differ fundamentally from dimensionality reduction methods in that they do not produce a reduced dimension representation of the data and instead focus only on providing a specific rendering of the data. However, these renderings are often limited by structural assumptions on the data (e.g. a tree) that may be inaccurate. <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-38" hwp:rel-id="F11">Figures S3</xref> and <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-28" hwp:rel-id="F15">S7</xref> compare the PHATE visualization to graph-rending methods including Force Directed Layout (FDL) and Monocle2.</p><sec id="s7b1" hwp:id="sec-67"><title hwp:id="title-69">Comparison of PHATE to Force-Directed Methods</title><p hwp:id="p-213">FDL algorithms attempt to draw a weighted graph in a two-dimensional space so that all edge weights are approximately preserved as distances and relatively few edges cross each other. To this end, such methods solve a <italic toggle="yes">n</italic>-body problem modeled by attractive and repulsive forces that resemble physical systems, such as elastic (e.g., Hooke’s law), electric (e.g., Coulomb’s law), or nuclear forces. Typically, repulsive forces are used to separate and spread out all pairs of nodes while attractive ones are used to keep neighboring nodes on the graph close to each other in the embedding. These attractive forces are scaled based on the strength of the connections within the graph. We specifically apply the Spring Layout method within the NetworkX Python package [<xref ref-type="bibr" rid="c110" hwp:id="xref-ref-110-1" hwp:rel-id="ref-110">110</xref>] to the graph defined by the <italic toggle="yes">α</italic>-decaying kernel produced for PHATE. This method uses the Fruchterman-Reingold algorithm [<xref ref-type="bibr" rid="c111" hwp:id="xref-ref-111-1" hwp:rel-id="ref-111">111</xref>], which is motivated by the aesthetics of rendering a planar graph, and models the attractive and repulsive forces based on a combination of notions elastic attraction, nuclear repulsion, and global stability criteria (e.g., ideal uniform distance and decaying temperature of the system).</p><p hwp:id="p-214">FDL algorithms are generally computationally expensive, making it difficult to scale them to larger datasets (<xref ref-type="fig" rid="figS5" hwp:id="xref-fig-13-7" hwp:rel-id="F13">Figure S5E</xref>). FDL algorithms also do not denoise the connections between data points, but rather assume that attractive and repulsive forces will eventually balance each other. Thus, they suffer from the same sensitivity to graph construction as Isomap, where spurious connections in noisy data can dominate the resulting force-dynamics and strongly affect the embedding (see the artificial tree and intersecting curves in <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-39" hwp:rel-id="F11">Figures S3A and D</xref> respectively). Additionally, exceedingly weak forces between distant clusters, which are clearly not well-connected in the graph, lead to a failure to retain long-range global distances, as shown in <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-29" hwp:rel-id="F15">Figure S7F</xref>, in which rod bipolar cells and cone bipolar cells do not appear substantially distinct. These shortcomings can lead to the loss of information, such as a lack of branching structure in the iPSC CyTOF data, or a merging of cell types in the neuronal scRNAseq from [<xref ref-type="bibr" rid="c24" hwp:id="xref-ref-24-4" hwp:rel-id="ref-24">24</xref>] (<xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-30" hwp:rel-id="F15">Figures S7E and G</xref> respectively.)</p></sec><sec id="s7b2" hwp:id="sec-68"><title hwp:id="title-70">Comparison of PHATE to Tree-Rendering Methods (SPADE and Monocle2)</title><p hwp:id="p-215">SPADE [<xref ref-type="bibr" rid="c102" hwp:id="xref-ref-102-2" hwp:rel-id="ref-102">102</xref>,<xref ref-type="bibr" rid="c103" hwp:id="xref-ref-103-3" hwp:rel-id="ref-103">103</xref>] and Monocle2 [<xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-3" hwp:rel-id="ref-12">12</xref>] are popular methods that fit the data to a predetermined structure such as a tree. These methods first attempt to do data reduction by clustering the data. Clustering methods tend to make less restrictive assumptions on the structure of the data compared to PCA. However, clustering methods assume that the underlying data can be partitioned into discrete separate regions. In reality, biological data are often continuous, and the apparent cluster structure given by clustering methods is only a result of non-uniform density and finite sampling of the continuous underlying state space. Additionally, the results from these methods will be incorrect if the underlying data does not lie on a tree. In contrast, PHATE does not make any assumptions on the data and instead learns the underlying structure.</p><p hwp:id="p-216">SPADE fits a minimal spanning tree to the clusters and was originally designed for mass cytometry data [<xref ref-type="bibr" rid="c102" hwp:id="xref-ref-102-3" hwp:rel-id="ref-102">102</xref>]. In Anchang et al. [<xref ref-type="bibr" rid="c103" hwp:id="xref-ref-103-4" hwp:rel-id="ref-103">103</xref>], the authors applied SPADE to scRNA-seq data by selecting relevant genes to perform dimensionality reduction. This makes it difficult to do data exploration as gene selection must be performed first. In contrast, PHATE does not require any gene selection procedure although PHATE can be used to analyze specific genes of interest by including only the relevant genes. SPADE has several other limitations according to Anchang et al. [<xref ref-type="bibr" rid="c103" hwp:id="xref-ref-103-5" hwp:rel-id="ref-103">103</xref>]. First, the SPADE results can be sensitive to the number of clusters which must be specified by the user. Second, down-sampling is required to visualize large datasets. SPADE is very sensitive to random down-sampling and will produce very different trees even when only down-sampling to 99% [<xref ref-type="bibr" rid="c103" hwp:id="xref-ref-103-6" hwp:rel-id="ref-103">103</xref>]. Thus, the random nature of the SPADE results make it difficult to discover the right structure of the data with SPADE. Given these limitations, we do not make a direct comparison between PHATE and SPADE.</p><p hwp:id="p-217">Monocle2 also fits a tree to cell clusters using the DDRTree algorithm [<xref ref-type="bibr" rid="c112" hwp:id="xref-ref-112-1" hwp:rel-id="ref-112">112</xref>,<xref ref-type="bibr" rid="c113" hwp:id="xref-ref-113-1" hwp:rel-id="ref-113">113</xref>] as a default. We compare Monocle2 to PHATE in <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-31" hwp:rel-id="F15">Figures S7</xref> and <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-40" hwp:rel-id="F11">S3</xref>. For the artificial tree in <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-41" hwp:rel-id="F11">Figure S3A</xref>, Monocle2 successfully identifies the branches of the tree. However, for the bone marrow scRNA-seq data in <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-32" hwp:rel-id="F15">Figure S7A</xref>, Monocle2 fails to detect several branches that are visible in the PHATE visualization. At the same time, Monocle2 shows several branches that are not detected by PHATE. The number and location of these branches vary from run to run on the same data with the same settings. Thus it is difficult to determine if the branches shown by Monocle2 are spurious or not.</p><p hwp:id="p-218">Similar results are obtained when applying Monocle2 to the EB scRNA-seq data where the number and location of the branches within the Monocle2 visualization differ drastically from run to run. Thus it is difficult to determine the underlying structure of this data using Monocle2. In contrast, for the same set of parameters, PHATE produces the same results with each run while preserving the relative relationships between different branches directly in the visualization based on their proximity.</p><p hwp:id="p-219">Furthermore, since Monocle2 enforces a tree structure on the data, the application of Monocle2 to data without a tree structure produces unintelligible results, giving tree-shaped visualizations for clustered (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-42" hwp:rel-id="F11">Figures S3C, H, I</xref> and <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-33" hwp:rel-id="F15">S7F</xref>), circular (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-43" hwp:rel-id="F11">Figure S3E</xref>) and planar (<xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-44" hwp:rel-id="F11">Figure S3F</xref>) data.</p></sec></sec></sec><sec id="s8" hwp:id="sec-69"><label>C</label><title hwp:id="title-71">PHATE for Data Exploration on Various Data Types</title><p hwp:id="p-220">PHATE can be used for exploratory data analysis on a variety of data types. Here we present some examples of PHATE applied to other datasets including non-single-cell data such as microbiome data, SNP data, facial images, Hi-C chromatin conformation maps, and Facebook network data.</p><sec id="s8a" hwp:id="sec-70"><label>C.1</label><title hwp:id="title-72">PHATE on High-dimensional High-throughput Data</title><p hwp:id="p-221">As a general dimensionality reduction method, PHATE is applicable to many datatypes. Here we show that PHATE reveals and preserves global transitional structure in mouse bone marrow scRNA-seq data, microbiome data, human SNP data, and (non-biological) image data.</p><sec id="s8a1" hwp:id="sec-71"><title hwp:id="title-73">Bone Marrow scRNA-seq Data Reveals New Structure</title><p hwp:id="p-222"><xref ref-type="fig" rid="figS6" hwp:id="xref-fig-14-8" hwp:rel-id="F14">Figure S6D</xref> shows the color-coded 3D PHATE embedding and gene expression matrix for scRNA-seq data from mouse bone marrow. This data is enriched for myeloid and erythroid lineages and was organized into clusters in [<xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-6" hwp:rel-id="ref-21">21</xref>], as shown in <xref ref-type="fig" rid="fig5" hwp:id="xref-fig-6-10" hwp:rel-id="F6">Figure 5A</xref>. Here, we show that PHATE reveals a continuous progression structure instead of cluster structure and illustrates the connections between clusters. The PHATE embedding shows a continuous progression from progenitor cell types in the center to erythroid lineages towards the right and myeloid lineages towards the left. The expression matrix shows increasing expression of erythroid markers in the rightmost branches (branches 4, 5, and 6) such as hemoglobin subunits Hba-a2 and Hbb-b1 as well as heme synthesis pathway enzyme Cpox as the lineage progresses to the right. Towards the left in branches 1 and 2, we see an enrichment for myeloid markers, including CD14 and Elane, which are primarily monocyte and neutrophil markers, respectively.</p><p hwp:id="p-223">In addition, PHATE splits the erythrocytes into three branches not distinguished by the authors of [<xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-7" hwp:rel-id="ref-21">21</xref>]. These branches show differential expression of several genes. Branch 6 is more highly expressed in Gata1 and Gfi1B, both of which are involved in erythrocyte maturation. Branch 4 is also more highly expressed in Zfpm1 which is involved in erythroid and megakary-ocytic cell differentiation. Additionally, branches 4 and 5 are more highly expressed in Car2, which is associated with the release of oxygen. Given these differential expression levels, it is likely that the different branches correspond to erythrocytes at different levels of maturity and in different states [<xref ref-type="bibr" rid="c114" hwp:id="xref-ref-114-1" hwp:rel-id="ref-114">114</xref>–<xref ref-type="bibr" rid="c120" hwp:id="xref-ref-120-1" hwp:rel-id="ref-120">120</xref>]. In addition, the branches at the right have high mutual information with CD235a, which is an erythroid marker that progressively increases in those lineages.</p><p hwp:id="p-224">PHATE in 3 dimensions more clearly reveals a separation of the myeloid lineages to the left into two branches. Cd14 and Sfpi1 are both more highly expressed at the beginning of branch 2 than in branch 1, suggesting that branch 2 is associated with monocytes while branch 1 is associated with neutrophils.</p><p hwp:id="p-225">We note that due to the lack of common myeloid progenitors in this sample, one may expect to see a gap between the monocytes and megakaryocyte lineage, since PHATE does not artificially connect separable data clusters (see <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-45" hwp:rel-id="F11">Figure S3C</xref>). However, we note that all but one of the 12 embeddings of this data in <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-34" hwp:rel-id="F15">Figure S7A</xref> also lack a gap between these trajectories, suggesting there is a genuine similarity between cells in the monocyte and megakaryocyte lineages, whether due to biological similarities or a technical artifact of sequencing (e.g., contamination.)</p></sec><sec id="s8a2" hwp:id="sec-72"><title hwp:id="title-74">PHATE on Facial Images</title><p hwp:id="p-226">To demonstrate that PHATE can also be used to learn and visualize the underlying structure of nonbiological data, we applied PHATE to the Frey Face dataset used in [<xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-3" hwp:rel-id="ref-6">6</xref>]. This dataset consists of nearly 2000 video frames of a single subject’s face in various poses. <xref ref-type="fig" rid="figS8" hwp:id="xref-fig-16-3" hwp:rel-id="F16">Figure S8A</xref> shows a 3D visualization of this dataset using PHATE, colored by time. Multiple branches are clearly visible in the visualization and each branch corresponds to the progression of a different pose. A short video highlighting two of these branches is available at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://www.youtube.com/watch?v=QMCWsKNgvHI" ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=QMCWsKNgvHI" hwp:id="ext-link-6">https://www.youtube.com/watch?v=QMCWsKNgvHI</ext-link>. The video highlights the continuous nature of the data as points along branches correspond to transitions from pose to pose.</p></sec><sec id="s8a3" hwp:id="sec-73"><title hwp:id="title-75">PHATE on Microbiome Data Reveals Archetypal Structure</title><p hwp:id="p-227">Recently there have been many studies of bacterial species abundance in the human intestinal tract, saliva, vagina and other membranes as measured by sequencing of the 16S ribosomal-RNA-encoding gene (16s sequencing) or by whole genome shotgun sequencing (metagenomics). However, most analysis of microbiome data has been limited to clustering and PCA. Here we use PHATE to analyze microbiome data from the American Gut Project.</p><p hwp:id="p-228">First we note that PCA applied to 9660 fecal, oral, and skin samples (<xref ref-type="fig" rid="figS8" hwp:id="xref-fig-16-4" hwp:rel-id="F16">Figure S8B</xref> left) results in an undifferentiated cloud with two density centers corresponding to fecal samples on the right and oral/skin samples on the left. In contrast, PHATE shows branching structures with 4 branches emanating from a point of origin for fecal sample, and additional structures on the right that differentiates between skin samples, which form their own progression, and oral samples, which again result in several branches. <xref ref-type="fig" rid="figS8" hwp:id="xref-fig-16-5" hwp:rel-id="F16">Figure S8C</xref> shows the PHATE embedding colored by two genera (bacteroides and prevotella) and a phylum (actinobacteria) of bacteria on the same 9660 samples. These figures show that the Bacteroides genus of bacteria is almost exclusively found in the fecal samples. The Prevotella genus of bacteria is found in certain stool and oral samples while the Actinobacteria phylum is primarily found in the oral and skin samples. This is consistent with the work in [<xref ref-type="bibr" rid="c121" hwp:id="xref-ref-121-1" hwp:rel-id="ref-121">121</xref>] which showed that different genera and phyla of bacteria are prevalent in the different body sites.</p><p hwp:id="p-229">Upon “zooming in” to the 8596 fecal samples in <xref ref-type="fig" rid="figS8" hwp:id="xref-fig-16-6" hwp:rel-id="F16">Figure S8D</xref>, we see 4 major branches, instead of the three enterotypes reported in previous literature [<xref ref-type="bibr" rid="c122" hwp:id="xref-ref-122-1" hwp:rel-id="ref-122">122</xref>], with highly expressed Firmicutes, Prevotella, Bacteroides and Verrucomicrobia respectively. Furthermore, the Fermicutes/Bacteroides branches seem to form a smooth continuum with samples falling into various parts of a triangular simplex shape typically seen in archetypal analysis [<xref ref-type="bibr" rid="c123" hwp:id="xref-ref-123-1" hwp:rel-id="ref-123">123</xref>,<xref ref-type="bibr" rid="c124" hwp:id="xref-ref-124-1" hwp:rel-id="ref-124">124</xref>]. This shows that individuals can exist as mixed phenotypes between archetypal bacterial states as well as in a continuum with more or less prevalence for each of these states.</p></sec><sec id="s8a4" hwp:id="sec-74"><title hwp:id="title-76">PHATE on SNP Data Reveals Geographic Structure</title><p hwp:id="p-230">To demonstrate PHATE on population data, we examined a dataset containing 2345 present-day humans from 203 populations genotyped at 594,924 autosomal SNPs with the Human Origins array [<xref ref-type="bibr" rid="c125" hwp:id="xref-ref-125-1" hwp:rel-id="ref-125">125</xref>]. In <xref ref-type="fig" rid="figS8" hwp:id="xref-fig-16-7" hwp:rel-id="F16">Figure S8E</xref>, we see that as compared to PCA, the PHATE embedding shows clear population structures, such as the near eastern Jewish populations near the bottom (Iranian and Iraqi Jews, Jordanians), with further branches showing progression within the same population, such as the Jordanian population show as orange diamonds (see <xref ref-type="fig" rid="figS8" hwp:id="xref-fig-16-8" hwp:rel-id="F16">Figure S8F</xref> for population labels.) Further, PHATE shows a global structure that mimics geography, with European populations generally towards the top and Near Eastern populations towards the bottom. Thus PHATE shows that the occurrence and structure of these SNPs follows a progression based on geography and population divergence. PCA tends to crowd populations together into two linear branches, without clearly distinguishing between population groups or showing population divergence.</p></sec></sec><sec id="s8b" hwp:id="sec-75" hwp:rev-id="xref-sec-75-1"><label>C.2</label><title hwp:id="title-77">PHATE on Connectivity Data</title><p hwp:id="p-231">Thus far we have used PHATE to embed high-dimensional data. That is, we have mapped the original feature space of the data to the PHATE dimensions. However, the PHATE algorithm also allows for embedding any data that exists in either an inner product space or a metric space. In other words, we can apply PHATE to data that is naturally described by distances or affinities instead of features. For example, network data (i.e. graphs) can be embedded using PHATE simply by skipping the initial steps of the algorithm that go from the original feature space to an affinity matrix. We can thus replace the affinity matrix with the network (as represented by an affinity matrix) and proceed with the rest of the PHATE algorithm.</p><p hwp:id="p-232">There are abundant examples of natively networked data in biology, such as chromatin conformation contact maps (Hi-C), gene/protein interaction networks, and neural connectivity data such as fMRI. Outside of biology, network data is also prevalent. A common example is social network data that contain information of friend-communities (e.g. Facebook) or interest-communities (e.g. Twitter). We show that PHATE provides a visualization of network data that emphasizes major structure (i.e. pathways) in the network, better than typical graph layout methods.</p><sec id="s8b1" hwp:id="sec-76"><title hwp:id="title-78">PHATE on Hi-C Data Reveals Spatial Chromatin Structure</title><p hwp:id="p-233">We use PHATE to visualize human Hi-C data from [<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-2" hwp:rel-id="ref-15">15</xref>] by using the Hi-C contact map as the affinity matrix in the PHATE algorithm. The contact map gives the frequency with which genomic locations are observed in spatial proximity. Hi-C contact maps are typically visualized using the matrix directly – often using the 45 degree counterclockwise rotated upper triangle part of the matrix [<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-3" hwp:rel-id="ref-15">15</xref>]. While this depiction can show chromosomal domains, it is not a reconstruction of the actual spatial structure of the chromatin. In contrast, the PHATE embedding reconstructs the relative positions of the genomic locations both locally and globally in such a way that the embedding represents an actual projection of the spatial structure within and between chromosomes. As a result, we get an intuitive visual of the Hi-C contact map that not only shows the topological domains present in the data but also how they are connected to one another. <xref ref-type="fig" rid="figS9" hwp:id="xref-fig-17-4" hwp:rel-id="F17">Figure S9A</xref> shows a 3D PHATE embedding of the chromatin, colored by chromosome. We see that the embedding resembles the fractal globule structure proposed in [<xref ref-type="bibr" rid="c126" hwp:id="xref-ref-126-1" hwp:rel-id="ref-126">126</xref>], with the total chromatin organized in a spherical shape and individual chromosomes mostly connected within themselves.</p><p hwp:id="p-234">PHATE can also effectively visualize a single chromosome. <xref ref-type="fig" rid="figS9" hwp:id="xref-fig-17-5" hwp:rel-id="F17">Figure S9B</xref> shows PHATE just on chromosome 1 contact map at 10 kilobase (kb) resolution. Each point corresponds to a genomic fragment and is colored by its location within the genome. In this visualization, multiple “folds” are clearly visible.</p><p hwp:id="p-235">To validate that the PHATE embedding of Hi-C data is meaningful we color the embedding by the ChIP-seq signals of several chromatin modification markers. <xref ref-type="fig" rid="figS9" hwp:id="xref-fig-17-6" hwp:rel-id="F17">Figure S9C</xref> shows a 2D PHATE embedding of chromosome 1 colored by various methylation and acetylation markers (ChIP-seq [<xref ref-type="bibr" rid="c127" hwp:id="xref-ref-127-1" hwp:rel-id="ref-127">127</xref>], dataset ENCSR977QPF). Histone methylation and acetylation play an important role in global gene regulation via control of chromatin organization. They are often used in combination with Hi-C data to investigate the open or closed structure of chromatin [<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-4" hwp:rel-id="ref-15">15</xref>], where the ChIP-seq signal of various histone modification markers correlates with so called topologically associated domains or TADs. <xref ref-type="fig" rid="figS9" hwp:id="xref-fig-17-7" hwp:rel-id="F17">Figure S9C</xref> shows an organized methylation (H3K27me3 and H3K4me2) and acetylation (H3K9ac and H3K27ac) signal on PHATE, with clusters of similar intensity of the marker, suggesting that the PHATE embedding has biological meaning with respect to the spatial organization of the chromatin.</p><p hwp:id="p-236">These results indicate that PHATE provides a visualization of Hi-C data that captures more spatial information compared to directly looking at the contact map.</p></sec><sec id="s8b2" hwp:id="sec-77"><title hwp:id="title-79">PHATE on Facebook Data Reveals Super Connectors</title><p hwp:id="p-237">We visualize Facebook network data using PHATE. The data [<xref ref-type="bibr" rid="c128" hwp:id="xref-ref-128-1" hwp:rel-id="ref-128">128</xref>] consist of networks of friends. This network graph is directly converted into a 0-1 affinity matrix and fed to PHATE. <xref ref-type="fig" rid="figS9" hwp:id="xref-fig-17-8" hwp:rel-id="F17">Figure S9D</xref> compares the PHATE visualization of the network to a force-directed layout, a common method for visualizing network data. In both plots, edges (friends) are shown and each node/person is colored by degree (the number of friends a person has). The PHATE embedding clearly shows multiple branching structures in the network, that are not visible in the force-directed layout which shows a T shape.</p><p hwp:id="p-238">Several subnetworks and important nodes (super-connectors) between subnetworks are visible in the PHATE embedding that are not visible in the force-directed layout visualization. For example, in the top-left corner of the PHATE visualization of the entire network, a single node connects the top-left group of people to the remainder of the network. Several other important nodes can be identified that bridge the gap between the left section of the network and the center region. Thus PHATE can be used for visualizing network data and identifying important features of the network.</p><p hwp:id="p-239">We also show that PHATE can be used to find more structure within subnetworks as identified by the friend networks of selected individuals (referred to as ego nodes in [<xref ref-type="bibr" rid="c128" hwp:id="xref-ref-128-2" hwp:rel-id="ref-128">128</xref>]) in <xref ref-type="fig" rid="figS9" hwp:id="xref-fig-17-9" hwp:rel-id="F17">Figure S9D</xref>. Again, we find that PHATE finds more structure in subnetworks.</p><p hwp:id="p-240">Therefore, we see that PHATE can be used to visualize any type of data, high-dimensional or featureless. Further, we see that PHATE will emphasize continuous transitional structure, while maintaining separation between clusters in these datasets.</p></sec></sec></sec><sec id="s9" hwp:id="sec-78"><label>D</label><title hwp:id="title-80">Detailed EB Data Results</title><p hwp:id="p-241">Here we provide a more detailed analysis of the EB data based on the PHATE visualization. We examined markers of cell proliferation as they are known to be correlated with the time trend. Undifferentiated hESCs have very fast cell cycles with prominent S and M phases and very short G1 phase, while differentiating cells have longer G1 phase and cycle slower [<xref ref-type="bibr" rid="c129" hwp:id="xref-ref-129-1" hwp:rel-id="ref-129">129</xref>]. Indeed, we found that S-phase cyclins <italic toggle="yes">CCNE1</italic> and <italic toggle="yes">CCNE2</italic> had the highest level of expression in the earlier time points while G1-specific CDK inhibitors <italic toggle="yes">CDKN1A, CDKN1B</italic> and <italic toggle="yes">CDKN1C</italic> were induced at later time points as shown in <xref ref-type="fig" rid="figS12" hwp:id="xref-fig-20-9" hwp:rel-id="F20">Figure S12B</xref>.</p><p hwp:id="p-242">To examine localized lineages and branching structures, we visualized the expression of known germ layer markers on PHATE (as in <xref ref-type="fig" rid="figS12" hwp:id="xref-fig-20-10" hwp:rel-id="F20">Figure S12B</xref>), resulting in the germ layer specification chart shown in <xref ref-type="fig" rid="fig6" hwp:id="xref-fig-7-10" hwp:rel-id="F7">Figure 6B</xref>. Note that in the remaining description we refer to the branches based on the labels shown in <xref ref-type="fig" rid="fig6" hwp:id="xref-fig-7-11" hwp:rel-id="F7">Figure 6Aiii</xref>. These branches are identified as follows. First, we performed clustering of the data using the <italic toggle="yes">k</italic>-means algorithm on ten-dimensional PHATE (<xref ref-type="fig" rid="fig6" hwp:id="xref-fig-7-12" hwp:rel-id="F7">Figure 6Ai</xref>) to identify differentiation intermediates within each germ layer branch. This can be viewed as a variant on spectral clustering using PHATE dimensions instead of the eigenvectors of a Laplacian matrix [<xref ref-type="bibr" rid="c130" hwp:id="xref-ref-130-1" hwp:rel-id="ref-130">130</xref>,<xref ref-type="bibr" rid="c131" hwp:id="xref-ref-131-1" hwp:rel-id="ref-131">131</xref>]. We note that clustering could also be applied directly to the potential distances and other clustering approaches can be used including hierarchical clustering, Louvain clustering [<xref ref-type="bibr" rid="c132" hwp:id="xref-ref-132-1" hwp:rel-id="ref-132">132</xref>,<xref ref-type="bibr" rid="c133" hwp:id="xref-ref-133-1" hwp:rel-id="ref-133">133</xref>], and others [<xref ref-type="bibr" rid="c134" hwp:id="xref-ref-134-1" hwp:rel-id="ref-134">134</xref>,<xref ref-type="bibr" rid="c135" hwp:id="xref-ref-135-1" hwp:rel-id="ref-135">135</xref>]. For each cluster, we performed differential expression analysis by comparing, for each gene, its expression distribution within the cluster to the expression distribution in all other cells (i.e., the “background” expression distribution) using the earth mover’s distance or EMD (<xref ref-type="fig" rid="fig6" hwp:id="xref-fig-7-13" hwp:rel-id="F7">Figure 6D</xref>), a measure of dissimilarity between probability distributions [<xref ref-type="bibr" rid="c87" hwp:id="xref-ref-87-2" hwp:rel-id="ref-87">87</xref>] (see Appendix A.1.5 for details). We confirmed that the genes expressed in several differentiation intermediates, which we identified by manual inspection, can also be identified based on the EMD scores of the corresponding cluster. For example, <italic toggle="yes">SOX10</italic> has a high EMD score in clusters 14 and 15, which corresponds with neural crest cells. Similarly, <italic toggle="yes">EOMES</italic> has a high EMD score in clusters 4, 17, and 20, which corresponds with the primitive streak cells. We also observed several canonical differentiation intermediates that were previously defined based on studies in mice. These include anterior NE and NC branches in the ectodermal lineage, anterior EN, cardiac and lateral plate ME, and hemangioblasts in the mesendoderm lineage.</p><p hwp:id="p-243">The advantage of clustering over manual population extraction is that the resolution of the clustering can be chosen by setting <italic toggle="yes">k</italic> (the number of clusters), and very finely grained populations can be extracted and characterized. Here, we characterized thirty clusters, at finer resolution than the manual analysis above. However, a larger <italic toggle="yes">k</italic> can be used for even finer exploration of the data. These clusters can then be characterized on the basis of gene expression for FACS sorting and further experimentation as we show in the next section.</p><p hwp:id="p-244">ESC-specific transcripts <italic toggle="yes">POU5F1, NANOG</italic>, and <italic toggle="yes">DPPA2/4</italic> were highly expressed in cells located at the left-most part of sub-branch i, indicating that this is the starting point of the data (<xref ref-type="fig" rid="figS12" hwp:id="xref-fig-20-11" hwp:rel-id="F20">Figure S12B</xref>). As cells traveled along sub-branch i into sub-branch ii, the epiblast marker <italic toggle="yes">OTX2</italic> was upregulated and then downregulated, followed by a sharp increase in markers associated with primitive streak (<italic toggle="yes">CER1, MIXL1, EOMES</italic>, and <italic toggle="yes">T</italic>), indicating that mesoderm (ME) and endoderm (EN) differentiation begins in this region. These markers continued to be highly expressed in cells located within the sub-region of branch v, which also exhibits high expression of the anterior EN markers <italic toggle="yes">FOXA2</italic> and <italic toggle="yes">SOX17</italic>, while the posterior EN transcripts <italic toggle="yes">CDX2, NKX2-1</italic>, and <italic toggle="yes">KLF5</italic> were expressed in the adjacent region of the same branch. ME transcripts <italic toggle="yes">NKX2-5, TNNT2, TAL1, TBX5</italic>, and <italic toggle="yes">TBX18</italic> were specifically expressed in different sub-branches vi-x.</p><p hwp:id="p-245">Further along sub-branch ii, past the ME/EN initiation region, the neuroectoderm (NE) markers <italic toggle="yes">PAX6, ZBTB16, SOX1, SOX2, NEUROG1</italic>, and <italic toggle="yes">DCX</italic> were expressed throughout branch iv, while branch iii was positive for the neural crest (NC) markers <italic toggle="yes">PAX3, FOXD3, SOX9</italic>, and <italic toggle="yes">SOX10</italic>. <xref ref-type="fig" rid="figS6" hwp:id="xref-fig-14-9" hwp:rel-id="F14">Figures S6E</xref> and <xref ref-type="fig" rid="figS12" hwp:id="xref-fig-20-12" hwp:rel-id="F20">S12C</xref> further show how the expression of these and other selected genes changes at different points within the branches. From these analyses, it is clear that PHATE successfully resolved all known germ layer branches based solely on the scRNA-seq data without any prior assumption about the structure of the data.</p><p hwp:id="p-246">Furthermore, the PHATE embedding suggested three novel differentiation trajectories. Within the ectodermal lineage, a distinct <italic toggle="yes">GBX2+ZIC2/5-HOXD1+GLI3+</italic> NE progenitor gave rise to a bi-potent <italic toggle="yes">HOXA2+HOXB1+</italic> precursor that separated into the NC branch and neural progenitor (NP) branch. The latter, in turn, split into at least five specialized neuronal subtypes. Within the EN branch, the canonical <italic toggle="yes">EOMES+FOXA2+SOX17+</italic> EN precursor was clustered together with the novel <italic toggle="yes">EOMES-FOXA2-GATA3+SATB1+KLF8+</italic> precursor, which further differentiated into cells expressing posterior EN markers <italic toggle="yes">NKX2-1, CDX2, ASCL2</italic>, and <italic toggle="yes">KLF5</italic>. Importantly, both the canonical and non-canonical EN cells expressed <italic toggle="yes">ARID3A</italic>, which can thus be defined as a pan-EN marker in humans. Moreover, we have identified a novel <italic toggle="yes">T+GATA4+ CER1+PROX1+</italic> cardiac precursor cell type within the ME lineage that gives rise to a <italic toggle="yes">TNNT2+</italic> cell via a <italic toggle="yes">GATA6+HAND1+</italic> differentiation intermediate.</p></sec><sec sec-type="supplementary-material" hwp:id="sec-79"><table-wrap id="tblS1" orientation="portrait" position="float" hwp:id="T2" hwp:rev-id="xref-table-wrap-2-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/TBLS1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T2</object-id><object-id pub-id-type="publisher-id">tblS1</object-id><label>Supplemental Table S1:</label><caption hwp:id="caption-8"><p hwp:id="p-247">Branches of the EB data identified for analysis and the corresponding clusters (<xref ref-type="fig" rid="fig6" hwp:id="xref-fig-7-14" hwp:rel-id="F7">Figure 6Bi</xref>) and sub-branches (<xref ref-type="fig" rid="fig6" hwp:id="xref-fig-7-15" hwp:rel-id="F7">Figure 6Biii</xref>) that comprise them.</p></caption><graphic xlink:href="120378_tblS1" position="float" orientation="portrait" hwp:id="graphic-37"/></table-wrap><fig id="figS1" position="float" orientation="portrait" fig-type="figure" hwp:id="F9" hwp:rev-id="xref-fig-9-1 xref-fig-9-2 xref-fig-9-3 xref-fig-9-4 xref-fig-9-5"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIGS1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F9</object-id><object-id pub-id-type="publisher-id">figS1</object-id><label>Supplemental Figure S1</label><caption hwp:id="caption-9"><p hwp:id="p-248">Comparison of PHATE to DM. (<bold>A</bold>) PHATE applied to the artificial tree data. Only two PHATE coordinates are needed to separate all branches. (<bold>B</bold>) The first six diffusion map coordinates of the artificial tree data. At least five of these coordinates are necessary to separate all of the branches.</p></caption><graphic xlink:href="120378_figS1" position="float" orientation="portrait" hwp:id="graphic-38"/></fig><fig id="figS2" position="float" orientation="portrait" fig-type="figure" hwp:id="F10" hwp:rev-id="xref-fig-10-1 xref-fig-10-2 xref-fig-10-3 xref-fig-10-4 xref-fig-10-5 xref-fig-10-6 xref-fig-10-7 xref-fig-10-8 xref-fig-10-9 xref-fig-10-10 xref-fig-10-11"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIGS2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F10</object-id><object-id pub-id-type="publisher-id">figS2</object-id><label>Supplemental Figure S2</label><caption hwp:id="caption-10"><p hwp:id="p-249">Impact of potential distances and PHATE parameters on the resulting visualization. (<bold>A</bold>) Comparison of Diffusion Maps (blue) and PHATE (orange) embeddings on data (black) from a half circle (left) and a full circle (right). Both the data and the embeddings have been centered about the mean and rescaled by the max Euclidean norm. For the full circle, both embeddings are identical (up to centering &amp; scaling) to the original circle. However, for the half circle, the Diffusion Maps embedding (blue) suffers from instabilities that generate significantly higher densities near the two end points. The PHATE embedding (orange) does not exhibit these instabilities. (<bold>B</bold>) The <italic toggle="yes">α</italic>-decaying kernel <inline-formula hwp:id="inline-formula-63"><alternatives hwp:id="alternatives-90"><inline-graphic xlink:href="120378_inline63.gif" hwp:id="inline-graphic-63"/></alternatives></inline-formula> as a function of <italic toggle="yes">x</italic> for different values of <italic toggle="yes">α</italic> and <italic toggle="yes">σ</italic> = 1 (left) and <italic toggle="yes">σ</italic> = 4 (right). As <italic toggle="yes">α</italic> increases, <italic toggle="yes">K<sub>α,σ</sub></italic>(<italic toggle="yes">x</italic>) becomes more constant for <italic toggle="yes">x</italic> ∈ (−<italic toggle="yes">σ, σ</italic>) and the tails of the kernel become lighter (i.e., decay to zero more quickly) for <italic toggle="yes">x</italic> ∉ (−<italic toggle="yes">σ, σ</italic>). (<bold>C</bold>) Demonstration of the effect of the scale <italic toggle="yes">t</italic> on the PHATE visualization for the artificial tree data colored by branch. The first column shows the VNE <italic toggle="yes"><italic toggle="yes">H</italic>(<italic toggle="yes">t</italic>)</italic> (see <xref ref-type="disp-formula" rid="eqn7" hwp:id="xref-disp-formula-8-1" hwp:rel-id="disp-formula-8">Eq. 7</xref>) of the diffusion affinities as a function of the time scale <italic toggle="yes">t</italic>. The other columns give the PHATE visualization with different values of <italic toggle="yes">t</italic>. The red dots in the first column indicate the values of <italic toggle="yes">t</italic> chosen for the plots. The red dot surrounded by a black box indicate the chosen value of <italic toggle="yes">t</italic> for the visualization in <xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-13" hwp:rel-id="F1">Figure 1B</xref> of the artificial tree data. Values of <italic toggle="yes">t</italic> that are too low can give noisy visualizations while very high values of <italic toggle="yes">t</italic> can result in a loss of information in the visualization. (<bold>D</bold>) Visualization of scRNAseq on mouse retinal bipolar neurons data using different informational distances defined via the parameter <italic toggle="yes">γ</italic>.</p></caption><graphic xlink:href="120378_figS2" position="float" orientation="portrait" hwp:id="graphic-39"/></fig><fig id="figS3" position="float" orientation="portrait" fig-type="figure" hwp:id="F11" hwp:rev-id="xref-fig-11-1 xref-fig-11-2 xref-fig-11-3 xref-fig-11-4 xref-fig-11-5 xref-fig-11-6 xref-fig-11-7 xref-fig-11-8 xref-fig-11-9 xref-fig-11-10 xref-fig-11-11 xref-fig-11-12 xref-fig-11-13 xref-fig-11-14 xref-fig-11-15 xref-fig-11-16 xref-fig-11-17 xref-fig-11-18 xref-fig-11-19 xref-fig-11-20 xref-fig-11-21 xref-fig-11-22 xref-fig-11-23 xref-fig-11-24 xref-fig-11-25 xref-fig-11-26 xref-fig-11-27 xref-fig-11-28 xref-fig-11-29 xref-fig-11-30 xref-fig-11-31 xref-fig-11-32 xref-fig-11-33 xref-fig-11-34 xref-fig-11-35 xref-fig-11-36 xref-fig-11-37 xref-fig-11-38 xref-fig-11-39 xref-fig-11-40 xref-fig-11-41 xref-fig-11-42 xref-fig-11-43 xref-fig-11-44 xref-fig-11-45 xref-fig-11-46"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIGS3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F11</object-id><object-id pub-id-type="publisher-id">figS3</object-id><label>Supplemental Figure S3</label><caption hwp:id="caption-11"><p hwp:id="p-250">Comparison of PHATE to various methods on multiple artificial and non-biological datasets. See B for discussion.</p></caption><graphic xlink:href="120378_figS3" position="float" orientation="portrait" hwp:id="graphic-40"/></fig><fig id="figS4" position="float" orientation="portrait" fig-type="figure" hwp:id="F12" hwp:rev-id="xref-fig-12-1 xref-fig-12-2 xref-fig-12-3 xref-fig-12-4"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIGS4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F12</object-id><object-id pub-id-type="publisher-id">figS4</object-id><label>Supplemental Figure S4</label><caption hwp:id="caption-12"><p hwp:id="p-251">Visual and quantitative demonstrations of the robustness of PHATE to subsampling and the choice of parameters. (<bold>A</bold>) The PHATE visualization for the iPSC mass cytometry dataset from [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-14" hwp:rel-id="ref-16">16</xref>] with varying number of subsample sizes <italic toggle="yes">N</italic>. The main branches present for <italic toggle="yes">N</italic> = 10000 are also visible for the other values of <italic toggle="yes">N</italic>, demonstrating that the PHATE embedding is robust to the size of the subsample. (<bold>B</bold>) The PHATE visualization for the iPSC CyTOF dataset from [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-15" hwp:rel-id="ref-16">16</xref>] with varying scale parameter <italic toggle="yes">t</italic>. The embeddings for all <italic toggle="yes">t</italic> preserve the branching structure and the visualizations are very similar to each other, demonstrating that the embedding is robust to the choice of <italic toggle="yes">t</italic>. (<bold>C</bold>) Heatmap of the Spearman correlation coefficient between geodesic distances of the ground truth data and the Euclidean distances of the PHATE visualization applied to the simulated paths dataset using Splatter [<xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-6" hwp:rel-id="ref-22">22</xref>]. The results are presented using different values for <italic toggle="yes">k, t</italic>, and <italic toggle="yes">α</italic>. The value of <italic toggle="yes">t</italic> selected using the kneepoint method in this case is 8. (<bold>D</bold>) Heatmap of the Spearman correlation coefficient between geodesic distances of the ground truth data and the Euclidean distances of the PHATE visualization applied to the simulated groups dataset using Splatter [<xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-7" hwp:rel-id="ref-22">22</xref>]. The results are presented using different values for <italic toggle="yes">k, t</italic>, and <italic toggle="yes">α</italic>. For both the groups and paths datasets, the results are very stable for <italic toggle="yes">α</italic> ≥ 10. The value of <italic toggle="yes">t</italic> selected using the kneepoint method in this case is 8.</p></caption><graphic xlink:href="120378_figS4" position="float" orientation="portrait" hwp:id="graphic-41"/></fig><fig id="figS5" position="float" orientation="portrait" fig-type="figure" hwp:id="F13" hwp:rev-id="xref-fig-13-1 xref-fig-13-2 xref-fig-13-3 xref-fig-13-4 xref-fig-13-5 xref-fig-13-6 xref-fig-13-7"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIGS5</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F13</object-id><object-id pub-id-type="publisher-id">figS5</object-id><label>Supplemental Figure S5</label><caption hwp:id="caption-13"><p hwp:id="p-252">Scalability tests of PHATE. (<bold>A</bold>) Scalable PHATE embedding of iPSC CyTOF data with a subset of the landmarks shown in red (200 out of 2000). (<bold>B</bold>) Robustness of PHATE to the number of landmarks chosen. PHATE on the EB data computed using increasing numbers of landmarks (X-axis) was compared to exact PHATE, i.e. without landmarks. Comparison was done using Procrustes analysis (optimal linear transformation) and the sum of squared error (SSE, Y-axis) is shown. To ensure a stable embedding that accurately approximates exact PHATE we choose 2000 landmarks as default. The inset shows the histogram of pairwise distances in the visualization computed using fast PHATE (2000 landmarks) on the EB data vs. the pairwise distances from exact PHATE. The correspondence and correlation coefficient are very high. (<bold>C</bold>) PHATE and t-SNE embeddings of a 1.3 million mouse brain cell dataset from 10X genomics [<xref ref-type="bibr" rid="c85" hwp:id="xref-ref-85-2" hwp:rel-id="ref-85">85</xref>]. The PHATE embedding was calculated with 2000 landmarks and completed in three hours. A subset (10 of 60) of the clusters provided by 10X are shown in color, the rest in gray. t-SNE shatters the cluster structure, while PHATE retains clusters as contiguous groups of cells. (<bold>D</bold>) Runtime of PHATE, t-SNE and UMAP on increasingly large subsamples of the EB data. Runtime was averaged across four runs. (<bold>E</bold>) Runtime of 12 visualization methods shown in <xref ref-type="fig" rid="figS3" hwp:id="xref-fig-11-46" hwp:rel-id="F11">Figures S3</xref> and <xref ref-type="fig" rid="figS7" hwp:id="xref-fig-15-35" hwp:rel-id="F15">S7</xref> across 19 datasets and corresponding line of best fit for each method. Where a method ran out of memory or took longer than one hour, the runtime is not shown and linear fits are cut off accordingly.</p></caption><graphic xlink:href="120378_figS5" position="float" orientation="portrait" hwp:id="graphic-42"/></fig><fig id="figS6" position="float" orientation="portrait" fig-type="figure" hwp:id="F14" hwp:rev-id="xref-fig-14-1 xref-fig-14-2 xref-fig-14-3 xref-fig-14-4 xref-fig-14-5 xref-fig-14-6 xref-fig-14-7 xref-fig-14-8 xref-fig-14-9"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIGS6</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F14</object-id><object-id pub-id-type="publisher-id">figS6</object-id><label>Supplemental Figure S6</label><caption hwp:id="caption-14"><p hwp:id="p-253">Annotated PHATE visualizations of CyTOF iPSC data [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-16" hwp:rel-id="ref-16">16</xref>] and branch expression analysis. (<bold>A</bold>) The primary branch point between the two major branches (reprogrammed and refractory) of the data is highlighted. (<bold>B</bold>) The PHATE visualization colored by LIN28 (a marker associated with the transition to pluripotency [<xref ref-type="bibr" rid="c32" hwp:id="xref-ref-32-2" hwp:rel-id="ref-32">32</xref>]) and CCASP3 (associated with cell apoptosis). LIN28 expression is limited to the reprogrammed branch while CCASP3 is primarily expressed in the refractory branch, indicating that the failure to reprogram may initiate apoptosis in these cells. (<bold>C</bold>) Analysis of branches on the PHATE embedding for the iPSC CyTOF data [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-17" hwp:rel-id="ref-16">16</xref>], (<bold>D</bold>) bone marrow scRNA-seq dataset from [<xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-8" hwp:rel-id="ref-21">21</xref>], and (<bold>E</bold>) newly generated embryoid body scRNA-seq data. (Left) The PHATE visualization with identified branches. (Middle) Expression level for each cell ordered by branch and ordering within the branch. Cell ordering is calculated using Wanderlust [<xref ref-type="bibr" rid="c26" hwp:id="xref-ref-26-3" hwp:rel-id="ref-26">26</xref>] starting on the left-most point of each branch. Expression levels are z-scored for each gene. A colorbar is given below the expression matrices that identifies each branch and (in the case of the bone marrow scRNA-seq data) cell type. (Right) DREMI scores [<xref ref-type="bibr" rid="c31" hwp:id="xref-ref-31-2" hwp:rel-id="ref-31">31</xref>] between gene expression levels and cell order within each branch. MAGIC [<xref ref-type="bibr" rid="c92" hwp:id="xref-ref-92-2" hwp:rel-id="ref-92">92</xref>] is applied first in (<bold>D</bold>) and (<bold>E</bold>) to impute missing values using the same kernel used for PHATE and smaller <italic toggle="yes">t</italic>. For branch analysis of the bone marrow data in (<bold>D</bold>), we used 3 PHATE dimensions to obtain clearer branch separation.</p></caption><graphic xlink:href="120378_figS6" position="float" orientation="portrait" hwp:id="graphic-43"/></fig><fig id="figS7" position="float" orientation="portrait" fig-type="figure" hwp:id="F15" hwp:rev-id="xref-fig-15-1 xref-fig-15-2 xref-fig-15-3 xref-fig-15-4 xref-fig-15-5 xref-fig-15-6 xref-fig-15-7 xref-fig-15-8 xref-fig-15-9 xref-fig-15-10 xref-fig-15-11 xref-fig-15-12 xref-fig-15-13 xref-fig-15-14 xref-fig-15-15 xref-fig-15-16 xref-fig-15-17 xref-fig-15-18 xref-fig-15-19 xref-fig-15-20 xref-fig-15-21 xref-fig-15-22 xref-fig-15-23 xref-fig-15-24 xref-fig-15-25 xref-fig-15-26 xref-fig-15-27 xref-fig-15-28 xref-fig-15-29 xref-fig-15-30 xref-fig-15-31 xref-fig-15-32 xref-fig-15-33 xref-fig-15-34 xref-fig-15-35"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIGS7</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F15</object-id><object-id pub-id-type="publisher-id">figS7</object-id><label>Supplemental Figure S7</label><caption hwp:id="caption-15"><p hwp:id="p-254">Comparison of PHATE to various methods on multiple biological datasets. See B for discussion.</p></caption><graphic xlink:href="120378_figS7" position="float" orientation="portrait" hwp:id="graphic-44"/></fig><fig id="figS8" position="float" orientation="portrait" fig-type="figure" hwp:id="F16" hwp:rev-id="xref-fig-16-1 xref-fig-16-2 xref-fig-16-3 xref-fig-16-4 xref-fig-16-5 xref-fig-16-6 xref-fig-16-7 xref-fig-16-8"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIGS8</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F16</object-id><object-id pub-id-type="publisher-id">figS8</object-id><label>Supplemental Figure S8</label><caption hwp:id="caption-16"><p hwp:id="p-255">PHATE reveals structure in a variety of high-dimensional datasets. (<bold>A</bold>) A 3D PHATE visualization of the Frey Faces dataset used in [<xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-4" hwp:rel-id="ref-6">6</xref>]. Points are colored by time within the video. Multiple branches corresponding to different poses are clearly visible. (<bold>B</bold>) PCA and PHATE embeddings of microbiome data from the American Gut project, colored by body site, and branches annotated by their dominant genera or phyla. (<bold>C</bold>) The PHATE embedding of data from the American Gut project colored by 2 genera (bacteroides and prevotella) and a phylum (actinobacteria) of bacteria. (<bold>D</bold>) The PHATE embedding of only the fecal samples from the American Gut project colored by various genera (bacteroides and prevotella) and phyla (firmicutes, verrucomicrobia, and proteobacteria) of bacteria. Each PHATE branch is associated with one of these bacteria groups. (<bold>E</bold>) PCA and PHATE embeddings of SNP data from the Human Origins dataset showing genotyped present-day humans from 203 populations [<xref ref-type="bibr" rid="c125" hwp:id="xref-ref-125-2" hwp:rel-id="ref-125">125</xref>] with the population legend in (<bold>F</bold>).</p></caption><graphic xlink:href="120378_figS8" position="float" orientation="portrait" hwp:id="graphic-45"/></fig><fig id="figS9" position="float" orientation="portrait" fig-type="figure" hwp:id="F17" hwp:rev-id="xref-fig-17-1 xref-fig-17-2 xref-fig-17-3 xref-fig-17-4 xref-fig-17-5 xref-fig-17-6 xref-fig-17-7 xref-fig-17-8 xref-fig-17-9"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIGS9</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F17</object-id><object-id pub-id-type="publisher-id">figS9</object-id><label>Supplemental Figure S9</label><caption hwp:id="caption-17"><p hwp:id="p-256">PHATE reveals structure in a variety of connectivity datasets. (<bold>A</bold>) 3D PHATE visualization of human Hi-C data [<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-5" hwp:rel-id="ref-15">15</xref>] using all 23 chromosomes at 50 kb resolution, colored by chromosome. Each point corresponds to a genomic fragment. (<bold>B</bold>) PHATE visualizations of the same human Hi-C data in A for chromosome 1 at 10 kb resolution colored by chromosome location. (<bold>C</bold>) 2D PHATE visualization of human Hi-C data [<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-6" hwp:rel-id="ref-15">15</xref>] for chromosome 1 at 10 kb resolution, colored by selected chromatin modification markers from ChIP-seq data. (<bold>D</bold>) Force-directed layout and PHATE visualizations of Facebook network data with data points colored by their degree (number of connections). The subnetworks are taken from the friend networks of selected individuals within the entire network. In all cases, PHATE reveals more structure.</p></caption><graphic xlink:href="120378_figS9" position="float" orientation="portrait" hwp:id="graphic-46"/></fig><fig id="figS10" position="float" orientation="portrait" fig-type="figure" hwp:id="F18" hwp:rev-id="xref-fig-18-1 xref-fig-18-2 xref-fig-18-3 xref-fig-18-4 xref-fig-18-5"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIGS10</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F18</object-id><object-id pub-id-type="publisher-id">figS10</object-id><label>Supplemental Figure S10</label><caption hwp:id="caption-18"><p hwp:id="p-257">PHATE using reweighted distances to highlight specific biological processes or “views” of the data. (<bold>A</bold>) PHATE embedding of CyTOF iPSC data using (i) unweighted distances, (ii) distances after upweighting cell cycle markers, (iii) distances after upweighting stem cell markers, (iv) distances after upweighting mitotic markers. (<bold>B</bold>) PHATE colored by different markers (columns). From top to bottom: (i) PHATE cell cycle “view”, (ii) PHATE stem cell “view” (iii) PHATE mitotic “view”.</p></caption><graphic xlink:href="120378_figS10" position="float" orientation="portrait" hwp:id="graphic-47"/></fig><fig id="figS11" position="float" orientation="portrait" fig-type="figure" hwp:id="F19" hwp:rev-id="xref-fig-19-1 xref-fig-19-2 xref-fig-19-3 xref-fig-19-4 xref-fig-19-5 xref-fig-19-6"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIGS11</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F19</object-id><object-id pub-id-type="publisher-id">figS11</object-id><label>Supplemental Figure S11</label><caption hwp:id="caption-19"><p hwp:id="p-258">Additional analysis with PHATE. ((<bold>A</bold>) i. Initial PHATE embedding of scR-NAseq on mouse retinal bipolar neurons. The rod bipolar cells cluster (cluster 1) is circled. ii. Subsequent PHATE embedding of cluster 1, colored by K means clustering to show heterogeneity within rod bipolar cells. (<bold>B</bold>) Transcriptional characterization of subtypes of rod bipolar cells, using known bipolar cell markers.</p></caption><graphic xlink:href="120378_figS11" position="float" orientation="portrait" hwp:id="graphic-48"/></fig><fig id="figS12" position="float" orientation="portrait" fig-type="figure" hwp:id="F20" hwp:rev-id="xref-fig-20-1 xref-fig-20-2 xref-fig-20-3 xref-fig-20-4 xref-fig-20-5 xref-fig-20-6 xref-fig-20-7 xref-fig-20-8 xref-fig-20-9 xref-fig-20-10 xref-fig-20-11 xref-fig-20-12"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;120378v4/FIGS12</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F20</object-id><object-id pub-id-type="publisher-id">figS12</object-id><label>Supplemental Figure S12</label><caption hwp:id="caption-20"><p hwp:id="p-259">Further analysis of the EB scRNA-seq data. (<bold>A</bold>) Inverted images of hESCs and EBs at each timepoint of data collection. Structures of different densities are clearly visible late in the time course (D15-D27) indicating the formation of distinct cell types. (<bold>B</bold>) PHATE colored by expression levels of selected markers. (<bold>C</bold>) Heatmap showing gene expression level in each cell in four of the branches starting with ESC. Cell ordering is determined using Wanderlust [<xref ref-type="bibr" rid="c26" hwp:id="xref-ref-26-4" hwp:rel-id="ref-26">26</xref>]. Genes were selected either manually or by high DREMI scores [<xref ref-type="bibr" rid="c31" hwp:id="xref-ref-31-3" hwp:rel-id="ref-31">31</xref>] between gene expression and cell ordering. (<bold>D</bold>) PHATE colored by CD49d expression level from the scRNA-seq data (top) and by correlation between the scRNA-seq transcription factor expression and the CD49d-sorted bulk RNA-seq transcription factor expression per cell (bottom). (<bold>E</bold>) Same as <bold>D</bold>, with CD142 and CD82. The correlation coefficient is highest in branch vii, which is the branch with the highest CD142 and CD82 expression. Bottom right: Scatter plot of single cell expression levels between CD82 and CD142. Color corresponds to the correlation between the scRNA-seq expression and the CD142+CD82+ sorted bulk RNA-seq expression. The branch with highest correlation corresponds to cells that are positive in both CD142 and CD82. (<bold>F</bold>) Scatter plots showing the gating procedure for FACS sorting cell populations of sub-branch iii (CD49d and CD63) and sub-branch vii (CD82 and CD142).</p></caption><graphic xlink:href="120378_figS12" position="float" orientation="portrait" hwp:id="graphic-49"/></fig></sec><fn-group hwp:id="fn-group-1"><fn id="fn1" hwp:id="fn-3" hwp:rev-id="xref-fn-3-1"><label>1</label><p hwp:id="p-260">Recall the diffusion distance is simply the Euclidean distance in these coordinates</p></fn></fn-group></back></article>
