<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/385591</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;385591v4</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;385591</article-id><article-id pub-id-type="other" hwp:sub-type="slug">385591</article-id><article-id pub-id-type="other" hwp:sub-type="atom-slug">385591</article-id><article-id pub-id-type="other" hwp:sub-type="tag">385591</article-id><article-version>1.4</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Bioinformatics" hwp:journal="biorxiv"><subject>Bioinformatics</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">GranatumX: A Community-engaging, Modularized, and Flexible Webtool for Single-cell Data Analysis</article-title></title-group><author-notes hwp:id="author-notes-1"><fn id="n1" fn-type="equal" hwp:id="fn-1" hwp:rev-id="xref-fn-1-1 xref-fn-1-2"><label>#</label><p hwp:id="p-1">These authors contributed equally to the work.</p></fn><corresp id="cor1" hwp:id="corresp-1" hwp:rev-id="xref-corresp-1-1"><label>*</label>To whom correspondence should be addressed. Email address: <email hwp:id="email-1">lgarmire@med.umich.edu</email></corresp></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><name name-style="western" hwp:sortable="Garmire David"><surname>Garmire</surname><given-names>David</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">1</xref><xref ref-type="fn" rid="n1" hwp:id="xref-fn-1-1" hwp:rel-id="fn-1">#</xref></contrib><contrib contrib-type="author" hwp:id="contrib-2"><name name-style="western" hwp:sortable="Zhu Xun"><surname>Zhu</surname><given-names>Xun</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-1" hwp:rel-id="aff-2">2</xref><xref ref-type="fn" rid="n1" hwp:id="xref-fn-1-2" hwp:rel-id="fn-1">#</xref></contrib><contrib contrib-type="author" hwp:id="contrib-3"><name name-style="western" hwp:sortable="Mantravadi Aravind"><surname>Mantravadi</surname><given-names>Aravind</given-names></name><xref ref-type="aff" rid="a4" hwp:id="xref-aff-4-1" hwp:rel-id="aff-4">3</xref></contrib><contrib contrib-type="author" hwp:id="contrib-4"><name name-style="western" hwp:sortable="Huang Qianhui"><surname>Huang</surname><given-names>Qianhui</given-names></name><xref ref-type="aff" rid="a4" hwp:id="xref-aff-4-2" hwp:rel-id="aff-4">3</xref></contrib><contrib contrib-type="author" hwp:id="contrib-5"><name name-style="western" hwp:sortable="Yunits Breck"><surname>Yunits</surname><given-names>Breck</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-2" hwp:rel-id="aff-2">2</xref></contrib><contrib contrib-type="author" hwp:id="contrib-6"><name name-style="western" hwp:sortable="Liu Yu"><surname>Liu</surname><given-names>Yu</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-3" hwp:rel-id="aff-2">2</xref></contrib><contrib contrib-type="author" hwp:id="contrib-7"><name name-style="western" hwp:sortable="Wolfgruber Thomas"><surname>Wolfgruber</surname><given-names>Thomas</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-8"><name name-style="western" hwp:sortable="Poirion Olivier"><surname>Poirion</surname><given-names>Olivier</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-3" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-9"><name name-style="western" hwp:sortable="Zhao Tianying"><surname>Zhao</surname><given-names>Tianying</given-names></name><xref ref-type="aff" rid="a5" hwp:id="xref-aff-5-1" hwp:rel-id="aff-5">4</xref></contrib><contrib contrib-type="author" hwp:id="contrib-10"><name name-style="western" hwp:sortable="Arisdakessian Cédric"><surname>Arisdakessian</surname><given-names>Cédric</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-4" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a5" hwp:id="xref-aff-5-2" hwp:rel-id="aff-5">4</xref></contrib><contrib contrib-type="author" hwp:id="contrib-11"><name name-style="western" hwp:sortable="Stanojevic Stefan"><surname>Stanojevic</surname><given-names>Stefan</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-4" hwp:rel-id="aff-2">2</xref></contrib><contrib contrib-type="author" corresp="yes" hwp:id="contrib-12"><name name-style="western" hwp:sortable="Garmire Lana X."><surname>Garmire</surname><given-names>Lana X.</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-5" hwp:rel-id="aff-2">2</xref><xref ref-type="corresp" rid="cor1" hwp:id="xref-corresp-1-1" hwp:rel-id="corresp-1">*</xref></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2 xref-aff-1-3 xref-aff-1-4"><label>1</label><institution hwp:id="institution-1">Department of Electrical &amp; Computer Engineering, University of Michigan</institution>, Ann Arbor, MI48105, <country>USA</country></aff><aff id="a2" hwp:id="aff-2" hwp:rev-id="xref-aff-2-1 xref-aff-2-2 xref-aff-2-3 xref-aff-2-4 xref-aff-2-5"><label>2</label><institution hwp:id="institution-2">Epidemiology Program, University of Hawaii Cancer Center</institution>, Honolulu, HI 96813, <country>USA</country></aff><aff id="a3" hwp:id="aff-3"><label>2</label><institution hwp:id="institution-3">Department of Computational Medicine and Bioinformatics, University of Michigan</institution>, Ann Arbor, MI48105, <country>USA</country></aff><aff id="a4" hwp:id="aff-4" hwp:rev-id="xref-aff-4-1 xref-aff-4-2"><label>3</label><institution hwp:id="institution-4">Department of Biostatistics, University of Michigan</institution>, Ann Arbor, MI48109, <country>USA</country></aff><aff id="a5" hwp:id="aff-5" hwp:rev-id="xref-aff-5-1 xref-aff-5-2"><label>4</label><institution hwp:id="institution-5">Molecular Biosciences and Bioengineering Graduate Program, University of Hawaii at Manoa</institution>, Honolulu, HI 96822, <country>USA</country></aff></contrib-group><pub-date pub-type="epub-original" date-type="pub" publication-format="electronic" hwp:start="2021"><year>2021</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2018-08-06T03:00:09-07:00">
    <day>6</day><month>8</month><year>2018</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2021-07-01T23:39:12-07:00">
    <day>1</day><month>7</month><year>2021</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2018-08-06T03:08:10-07:00">
    <day>6</day><month>8</month><year>2018</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2021-07-01T23:43:34-07:00">
    <day>1</day><month>7</month><year>2021</year>
  </pub-date><elocation-id>385591</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2018-08-05"><day>05</day><month>8</month><year>2018</year></date>
<date date-type="rev-recd" hwp:start="2021-07-01"><day>01</day><month>7</month><year>2021</year></date>
<date date-type="accepted" hwp:start="2021-07-01"><day>01</day><month>7</month><year>2021</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2021, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2021</copyright-year><license hwp:id="license-1"><p hwp:id="p-2">The copyright holder for this pre-print is the author. All rights reserved. The material may not be redistributed, re-used or adapted without the author's permission.</p></license></permissions><self-uri xlink:href="385591.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/change-list" xlink:role="change-list" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2021/pdf/385591v4.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="385591.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2021/abstracts/385591v4/385591v4.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2021/fulltext/385591v4/385591v4.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><p hwp:id="p-3">We present GranatumX, a next-generation software environment for single-cell data analysis. GranatumX is inspired by the interactive web tool Granatum. It enables biologists to access the latest single-cell bioinformatics methods in a web-based graphical environment. It also offers software developers the opportunity to rapidly promote their own tools with others in customizable pipelines. The architecture of GranatumX allows for easy inclusion of plugin modules, named Gboxes, that wrap around bioinformatics tools written in various programming languages and on various platforms. GranatumX can be run on the cloud or private servers and generate reproducible results. It is a community-engaging, flexible, and evolving software ecosystem for scRNA-Seq analysis, connecting developers with bench scientists. GranatumX is freely accessible at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://garmiregroup.org/granatumx/app" ext-link-type="uri" xlink:href="http://garmiregroup.org/granatumx/app" hwp:id="ext-link-1">http://garmiregroup.org/granatumx/app</ext-link>.</p></abstract><kwd-group kwd-group-type="author" hwp:id="kwd-group-1"><title hwp:id="title-2">Keywords</title><kwd hwp:id="kwd-1">single cell</kwd><kwd hwp:id="kwd-2">RNA-Seq</kwd><kwd hwp:id="kwd-3">analysis</kwd><kwd hwp:id="kwd-4">software</kwd><kwd hwp:id="kwd-5">pipeline</kwd><kwd hwp:id="kwd-6">plugin</kwd><kwd hwp:id="kwd-7">webtool</kwd></kwd-group><counts><page-count count="22"/></counts><custom-meta-wrap><custom-meta hwp:id="custom-meta-1"><meta-name>special-property</meta-name><meta-value>contains-inline-supplementary-material</meta-value></custom-meta></custom-meta-wrap><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-2">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta><notes hwp:id="notes-1"><notes notes-type="competing-interest-statement" hwp:id="notes-2"><title hwp:id="title-3">Competing Interest Statement</title><p hwp:id="p-4">The authors have declared no competing interest.</p></notes><fn-group content-type="summary-of-updates" hwp:id="fn-group-1"><title hwp:id="title-4">Summary of Updates:</title><fn fn-type="update" hwp:id="fn-2"><p hwp:id="p-5">Minor changes on figure legends and manuscript main texts.</p></fn></fn-group></notes></front><body><sec id="s1" hwp:id="sec-1"><title hwp:id="title-5">Introduction</title><p hwp:id="p-6">Single-cell RNA sequencing (scRNA-seq) technologies have advanced our understanding of cell-level biology significantly [<xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">1</xref>]. Many exciting scientific discoveries are attributed to new experimental technologies and sophisticated computational methods [<xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">2</xref>,<xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-1" hwp:rel-id="ref-3">3</xref>]. Despite the progress in cultivating professionals with cross-discipline training, a gap continues to exist between the wet-lab biology and the bioinformatics community. Moreover, with the rapid development of many varieties of modules handling different parts of scRNA-seq analysis [<xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">4</xref>–<xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-1" hwp:rel-id="ref-6">6</xref>], it becomes increasingly challenging for bioinformaticians themselves to decide which method to choose. Although some analytical packages such as SINCERA [<xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">7</xref>], Seurat [<xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-1" hwp:rel-id="ref-8">8</xref>], and Scanpy [<xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">9</xref>] provide complete scRNA-seq pipelines, they require users to be familiar with their corresponding programming language (typically R or Python), installation platform, and command-line interface. This overhead hinders wide adoption by experimental biologists, especially those newly adopting scRNA-seq technologies. A few platforms, such as ASAP [<xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-1" hwp:rel-id="ref-10">10</xref>] and our own previous tool Granatum [<xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">11</xref>], provide intuitive graphical user interfaces and may be useful for a first-hand exploratory check. However, Granatum does not allow for modularity, while ASAP lacks flexibility and restricts the user to a set number of computational tools. Here we present GranatumX, the new generation of scRNA-seq analysis platforms that aims to solve these issues systematically. Its architecture facilitates the rapid incorporation of cutting-edge tools and enables the efficient handling of large datasets aided by virtualization [<xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">12</xref>].</p></sec><sec id="s2" hwp:id="sec-2"><title hwp:id="title-6">Methods</title><sec id="s2a" hwp:id="sec-3"><title hwp:id="title-7">Architectural overview</title><p hwp:id="p-7">GranatumX consists of three independent components: Central Data Storage (CDS), User Interface (UI), and Task Runner (TR). CDS stores all data and metadata in GranatumX, including the uploaded files, processed intermediate data, and final results. The other two components of GranatumX both have controlled access to the central data storage, which allows them to communicate with each other. CDS is implemented using a PostgreSQL database and a secure file system based data warehouse. UI is the component with which wet-lab biologists interact. The layout is intuitive with Gbox settings while providing a flexible and customizable analysis pipeline. UI also allows for the asynchronous submission of tasks before they can be run by the back-end. UI is implemented using JavaScript, with the ReactJS framework. The submitted jobs queue up in the database and can be retrieved in real-time by TR. TR monitors the task queue in the CDS in real-time, actively retrieves the high-priority tasks (based on submission time), initializes the corresponding Gboxes, and prepares the input data by retrieving relevant data from CDS.</p></sec><sec id="s2b" hwp:id="sec-4"><title hwp:id="title-8">Deployment</title><p hwp:id="p-8">GranatumX uses Docker to ensure that all Gboxes can be installed reproducibly with all their dependencies. As a result, GranatumX can be deployed in various environments including personal computers, dedicated servers, High-Performance Computing (HPC) platforms, and cloud services. The installation instructions are detailed in the README file of the source code.</p></sec><sec id="s2c" hwp:id="sec-5"><title hwp:id="title-9">Responsive UI</title><p hwp:id="p-9">The web-based UI offers different device-specific layouts to suit a wider range of screen sizes. On Desktop computers, the UI takes advantage of the screen space and uses a panel-based layout, and maximizes the on-screen information. On small tablets and mobile devices with limited screen space, a collapsible sidebar-based layout is used to allow the most important information (the results of the current step) to show up on the screen.</p></sec><sec id="s2d" hwp:id="sec-6"><title hwp:id="title-10">Recipe system</title><p hwp:id="p-10">Most studies can use similarly structured pipelines, which typically consist of data entry (upload and parsing), data pre-processing (imputation, filtering, normalization, etc.), and finally data analysis functionalities (clustering, differential expression, pseudo-time construction, network analysis, etc.). GranatumX allows users to save a given pipeline into a “recipe” for the future. GranatumX comes with a set of built-in recipes, which cover many of the most common experiment pipelines.</p></sec><sec id="s2e" hwp:id="sec-7"><title hwp:id="title-11">Software Development Kits (SDKs)</title><p hwp:id="p-11">GranaumX SDKs are made for Python and R. These SDKs provide a set of Application Programming Interfaces (APIs) and helper functions that connect Gbox developer’s own code with the core of GranatumX The detailed documentation can be found in the Github repository.</p><p hwp:id="p-12">There are three steps to build a new Gbox from the existing code: 1) Write an entry point in the language of the developer’s choice. The entry point uses the SDK to retrieve necessary input from the core of GranatumX and send back output to the core after the results are computed. 2) Package the entry point, the original package source code, and any dependencies into a docker image using a Dockerfile and the “docker build” command. 3) Write a UI specification for the Gbox. The specification is a simple YAML file that declares the data requirements of the Gbox.</p></sec><sec id="s2f" hwp:id="sec-8"><title hwp:id="title-12">Pipeline customization</title><p hwp:id="p-13">GranatumX allows for full customization of the analysis pipeline. An analysis pipeline has a number of Gboxes organized in a series of steps. Note that two different steps can have the same underlying Gbox. For example, two PCA Gboxes can appear before and after imputation, to evaluate its effect. Because the data are usually processed in a streamlined fashion, later steps in the pipeline usually depend on data generated by the earlier steps. Steps can be added from the app-store into the current project and can be removed from the pipeline at any time. A newly added step can be inserted at any point in the pipeline and can be reordered in any way, as long as such re-arrangement does not violate the dependency relationships.</p></sec><sec id="s2g" hwp:id="sec-9"><title hwp:id="title-13">Current GranatumX cloud server setup</title><p hwp:id="p-14">The current GranatumX web version is hosted on OVHcloud, with specs: Intel Haswell vCPU 128 GB RAM Xeon E5-1650 4GHz. Additionally the https protocol is verified with Let’s Encrypt (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://letsencrypt.org" ext-link-type="uri" xlink:href="https://letsencrypt.org" hwp:id="ext-link-2">https://letsencrypt.org</ext-link>) with an Apache 2 server (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://httpd.apache.org/" ext-link-type="uri" xlink:href="https://httpd.apache.org/" hwp:id="ext-link-3">https://httpd.apache.org/</ext-link>) and a site registered with No-IP (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://www.noip.com/" ext-link-type="uri" xlink:href="https://www.noip.com/" hwp:id="ext-link-4">https://www.noip.com/</ext-link>). This server uses a proxy implementation to pass a user to the Node.js web service. In this manner, Node does not have to manage the security or https connections which allows setup to occur efficiently in an enterprise system. Additionally, an optional fast compute system may be connected to the OVH cloud server through ssh tunneling which allows the local port to be mapped to the remote connection. In this manner, a high speed rig can be connected -- in this case, the AMD 3590x can be connected without having to procure a new cloud system.</p></sec><sec id="s2h" hwp:id="sec-10"><title hwp:id="title-14">Project management</title><p hwp:id="p-15">The studies in GranatumX are organized as projects. Each user can manage multiple concurrent projects. The automatic customer’s report can be generated per project using the parameters and results stored in the CDS.</p></sec><sec id="s2i" hwp:id="sec-11"><title hwp:id="title-15">Example data sets</title><p hwp:id="p-16">Three datasets are used in this report. One data set is downloaded from GSE117988, a study on a patient with metastatic Merkel cell carcinoma, treated using T cell immunotherapy as well as immune-checkpoint inhibitors (anti-PD1 and anti-CTLA4) but later developed resistance [<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">15</xref>]. A second dataset is Tabula Muris dataset, which contains 54,865 cells from 20 organs and tissues of the mouse [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">16</xref>]. Another dataset is the 1.3 Million Brain Cells from E18 Mice, downloaded from 10x genomics website: <ext-link l:rel="related" l:ref-type="uri" l:ref="https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.3.0/1M_neurons" ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.3.0/1M_neurons" hwp:id="ext-link-5">https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.3.0/1M_neurons</ext-link> (accessed on date 05/09/2020). This dataset contains 1,308,421 cells from embryonic mice brains, done by Chromium™ Single Cell 3’ Solution (v2 Chemistry).</p></sec><sec id="s2j" hwp:id="sec-12"><title hwp:id="title-16">GranatumX Plug-in development</title><p hwp:id="p-17">The detailed instruction document, the tutorial youtube or youku videos for writing Gbox plug-in are on the project website: <ext-link l:rel="related" l:ref-type="uri" l:ref="http://garmiregroup.org/granatumx/app" ext-link-type="uri" xlink:href="http://garmiregroup.org/granatumx/app" hwp:id="ext-link-6">http://garmiregroup.org/granatumx/app</ext-link>. Additionally, we created a slack group named “GranatumX-Developer” to facilitate plug-in development from the 3rd party.</p></sec></sec><sec id="s3" hwp:id="sec-13"><title hwp:id="title-17">Results</title><sec id="s3a" hwp:id="sec-14"><title hwp:id="title-18">Overview of GranatumX</title><p hwp:id="p-18">The objective of GranatumX is to provide scRNA-seq biologists better access to bioinformatics tools and the ability to conduct single-cell data analysis independently (<bold><xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Figure 1</xref></bold>). Currently other scRNA-seq platforms usually only provide a fixed set of methods implemented by the authors themselves. It is difficult to add new methods developed by the community due to programming language lock-in as well as monolithic code architectures. If a pipeline is assembled between heterogeneous tools, it is manually crafted and inhibits a repeatable execution of data analysis tools by other wet-lab scientists. As a solution, GranatumX uses the plugin and virtualized framework that provides an easy and unified approach to add new methods in a data-analysis pipeline. The plugin system is agnostic to developer code and the choice of the original scripting language. It also eliminates inter-module incompatibilities, by isolating the dependencies of each module (<bold><xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-1" hwp:rel-id="F2">Figure 2A</xref></bold>). As a data portal, GranatumX provides a graphical user interface (GUI) that requires no programming experience.</p><fig id="fig1" position="float" fig-type="figure" orientation="portrait" hwp:id="F1" hwp:rev-id="xref-fig-1-1 xref-fig-1-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;385591v4/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Figure 1:</label><caption hwp:id="caption-1"><title hwp:id="title-19">Overview of the Granatum × platform.</title><p hwp:id="p-19">Granatum × aims to bridge the gap between the computational method developers (the bioinformaticians) and the experiment designers (the biologists). It achieves this by building end-to-end infrastructure including the packaging and containerization of the code (<bold>Gbox Packaging</bold>), organization and indexing of the Gboxes (<bold>Apps</bold>), customization of the analysis steps (<bold>Pipeline building</bold>), visualization and results downloading (<bold>Interactive Analysis</bold>), and finally the aggregation and summarization of the study (<bold>Report Generation</bold>).</p></caption><graphic xlink:href="385591v4_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig><fig id="fig2" position="float" fig-type="figure" orientation="portrait" hwp:id="F2" hwp:rev-id="xref-fig-2-1 xref-fig-2-2 xref-fig-2-3 xref-fig-2-4 xref-fig-2-5 xref-fig-2-6"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;385591v4/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Figure 2:</label><caption hwp:id="caption-2"><title hwp:id="title-20">GranatumX deployment, data management and analysis flow.</title><p hwp:id="p-20">A) Granatum × can be deployed on various computational environments, from personal computers, private servers, High-Performance Computation systems, to cloud services. Granatum X’s web UI is adaptable to devices with various screen sizes, which allows desktop and mobile access. B) Granatum X’s data management. Each Gbox (labeled by a particular color to represent a certain functionality) with order dependency on the pipeline, may take some project data and some user-specified parameters as input and may generate results (interactive visualization, plots, tables, or even plain text) and new project data. All project data and results, as well as the specified parameters, are recorded and saved into the central data storage and can be used for reproducibility control. C) A scRNA-Seq computational study typically consists of three phases: the uploading and parsing of the expression matrices and metadata (Data Entry), the quality improvement and signal extraction of the data (Data Processing), and finally the assorted analyses on the processed data which offer biological insights (Data Analysis).</p></caption><graphic xlink:href="385591v4_fig2" position="float" orientation="portrait" hwp:id="graphic-2"/></fig></sec><sec id="s3b" hwp:id="sec-15"><title hwp:id="title-21">Deployment of GranatumX</title><p hwp:id="p-21">The web-based GUI can be accessed on various devices including desktop, tablets, and smartphones (<bold><xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-2" hwp:rel-id="F2">Figure 2A</xref></bold>). In addition to the web-based format, GranatumX is also deployable on a broad variety of computational environments, such as private PCs, cloud services, and High-Performance Computing (HPC) platforms with minimal effort by system administrators. The deployment process is unified on all platforms because all components of GranatumX are containerized in Docker [<xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">13</xref>] (also portable to Singularity [<xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">14</xref>]). GranatumX can handle larger-scale scRNA-seq datasets coming online, with an adequate cloud configuration setup and appropriate Gboxes. For example, after uploading data, it took GranatumX ~12 minutes to finish the recommended pipeline with xxx modules on an AMD 3950x with 16 cores and 128GB of DRAM memory running Ubuntu 20.04, using 10K cells downsampled from the dataset of “1.3 Million Brain Cells from E18 Mice” on the 10x Genomics website. The most time-consuming step is imputation using neural-network model DeepImpute (~⅖ time), and the detailed breakdown of time consumption is shown in <bold>Supplementary Table 1</bold>.</p><table-wrap id="tbl1" orientation="portrait" position="float" hwp:id="T1" hwp:rev-id="xref-table-wrap-1-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;385591v4/TBL1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T1</object-id><object-id pub-id-type="publisher-id">tbl1</object-id><label>Table 1.</label><caption hwp:id="caption-3"><p hwp:id="p-22">Gene Set Enrichment Analysis results on clusters from UMAP plot in <xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-1" hwp:rel-id="F3">Figure 3B</xref>.</p></caption><graphic xlink:href="385591v4_tbl1" position="float" orientation="portrait" hwp:id="graphic-3"/><graphic xlink:href="385591v4_tbl1a" position="float" orientation="portrait" hwp:id="graphic-4"/><graphic xlink:href="385591v4_tbl1b" position="float" orientation="portrait" hwp:id="graphic-5"/></table-wrap></sec><sec id="s3c" hwp:id="sec-16"><title hwp:id="title-22">Unique Gbox modules</title><p hwp:id="p-23">Gbox is a unique concept of GrantumX. It represents a containerized version of a scientific package that handles its input and output by a format understood by the GranatumX core (<bold><xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-3" hwp:rel-id="F2">Figure 2B</xref></bold>). GranatumX has a set of pre-installable Gboxes that enable complete scRNA-seq analysis out of the box. Various Gboxes for data entry, preprocessing, and processing can be customized and organized together, to form a complete analysis pipeline (<bold><xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-4" hwp:rel-id="F2">Figure 2C</xref>)</bold>. One highlight feature of the Gbox is that it stands alone and the user can assume any Gbox without the need to restart the full pipeline, in case one implemented by the user fails. Another highlight of the Gbox feature is that the entire GranatumX platform is fully interactive, with addition or removal of some Gboxes or parameter changes on the go, while some other Gboxes are being executed.</p><p hwp:id="p-24">A comprehensive set of over 30 Gboxes are implemented in GranatumX to perform tasks all the way from data entry and processing to downstream functional analysis. The data processing tasks help to minimize the biases in the data and increase the signal-to-noise ratio. For each of these quality improvement categories, GranatumX provides multiple popular methods from which users can pick. To assist functional analysis, GranatumX provides a core list of methods for dimension reduction, visualization (including PCA, t-SNE, and UMAP), clustering, differential expression, marker gene identification, Gene Set Enrichment Analysis, network analysis and pseudo-time construction. Versioning for each of these Gboxes has been implemented so that users can use a specific tested version of a Gbox. Developers on the other hand can work on newer versions separately before the official upgrade. Gboxes can be stored on DockerHub for public use which maintains its own versioning system (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://hub.docker.com/u/granatumx" ext-link-type="uri" xlink:href="https://hub.docker.com/u/granatumx" hwp:id="ext-link-7">https://hub.docker.com/u/granatumx</ext-link>). Detailed step-by-step tutorials for writing and building Gboxes are on GranatumX website <ext-link l:rel="related" l:ref-type="uri" l:ref="http://garmiregroup.org/granatumx/app" ext-link-type="uri" xlink:href="http://garmiregroup.org/granatumx/app" hwp:id="ext-link-8">http://garmiregroup.org/granatumx/app</ext-link>.</p></sec><sec id="s3d" hwp:id="sec-17"><title hwp:id="title-23">Input files</title><p hwp:id="p-25">The input files of GranatumX include expression matrices and optional sample metadata tables, acceptable in a variety of formats such as CSV, TSV, or Excel format. GranatumX even accepts zip files and gz files (GNU zip), and the user can choose that format for large expression matrices. Expression matrices are raw read counts for all genes (rows) in all cells (columns). The sample metadata tables annotate each cell with a pre-assigned cell type, state, or other quality information. The parsing step creates a sparse matrix using the coordinate list (COO) format, and this representation ensures swift upload onto the back end, even for large input datasets (&gt;10K cells). Such information will either be used to generate computational results (such as Gene Set Analysis) or be mapped onto the PCA, t-SNE, or UMAP plot for visualization (see <bold><xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-5" hwp:rel-id="F2">Figure 2C</xref></bold> for the workflow). Once the user uploads the gene expression matrix, the data are read into a dataframe using <italic toggle="yes">Pandas</italic> and the step updates the user with a “preview”, consisting of the first few rows and columns of the gene expression matrix, along with the number of genes and samples present.</p></sec><sec id="s3e" hwp:id="sec-18"><title hwp:id="title-24">User-centric design</title><p hwp:id="p-26">As a user-friendly tool, GranatumX allows multiple users to be affiliated with the same project for data and result sharing, while restricting one user to run the pipeline at a time to avoid data conflicts. It allows dynamically adding, removing, and reordering pipeline steps on the go. It also allows users to reset the current step. All relevant data in the analysis pipeline and all results generated by each module are stored in a database, allowing users to access and download them. To ensure reproducibility, GranatumX can automatically generate a human-readable report detailing the inputs, running arguments, and the results of all steps (see examples in <bold>Supplementary File 1</bold> and <bold>Supplementary File 2</bold>). All of these features are designed with the mindset of “consumer reports” to facilitate research in experimental labs or genomics cores.</p></sec><sec id="s3f" hwp:id="sec-19"><title hwp:id="title-25">Case studies using GranatumX</title><p hwp:id="p-27">In the following section, we demonstrate two case studies of GranatumX. The first data set was downloaded from GSE117988, including 7431 single cells generated by the 10x Genomics 3’ Chromium platform. It was obtained from a patient with metastatic Merkel cell carcinoma, treated using T cell immunotherapy as well as immune-checkpoint inhibitors (anti-PD1 and anti-CTLA4) but later developed resistance [<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-2" hwp:rel-id="ref-15">15</xref>]. We used a customized pipeline to analyze the scRNA-seq data (<bold><xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-2" hwp:rel-id="F3">Figure 3A</xref></bold>). The pipeline comprises all common analysis steps, including 1) File upload, 2) imputation (based on DeepImpute [<xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-2" hwp:rel-id="ref-6">6</xref>]), 3) normalization, 4) gene filtering, 5) log transformation, 6) principal component analysis (PCA), 7) t-SNE/UMAP plot, 8) sample coloring, 9) clustering, 10) marker gene identification, 11) GSEA analysis, and 12) pseudo-time construction. The analysis report of the entire pipeline is included as <bold>Supplementary File 1</bold>. The clustering step identifies 7 clusters on the UMAP plot (<bold><xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-3" hwp:rel-id="F3">Figure 3B</xref></bold>). The exemplary GSEA analysis results (<bold><xref rid="tbl1" ref-type="table" hwp:id="xref-table-wrap-1-1" hwp:rel-id="T1">Table 1</xref>)</bold> show the significance in many important immune-related pathways, including the MAPK signaling pathway and antigen processing and presentation pathway (cluster_5 vs. rest), cell cycle genes (cluster_3 vs. rest), and ubiquitin-mediated proteolysis (cluster_3 vs. rest).</p><fig id="fig3" position="float" fig-type="figure" orientation="portrait" hwp:id="F3" hwp:rev-id="xref-fig-3-1 xref-fig-3-2 xref-fig-3-3 xref-fig-3-4 xref-fig-3-5"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;385591v4/FIG3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F3</object-id><object-id pub-id-type="publisher-id">fig3</object-id><label>Figure 3:</label><caption hwp:id="caption-4"><title hwp:id="title-26">Case studies using an exemplary workflow of GranatumX.</title><p hwp:id="p-28">A) An exemplary workflow of a customized scRNA-seq pipeline set by the user. B) The UMAP plot clusters on Merkel cell carcinoma data from the 10x genomics platform. C) The UMAP plot clusters of Tabula Muris Consortium data.</p></caption><graphic xlink:href="385591v4_fig3" position="float" orientation="portrait" hwp:id="graphic-6"/></fig><p hwp:id="p-29">We also used GranatumX to analyze Tabula Muris dataset, which contains 54,865 cells from 20 organs and tissues of mouse [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-2" hwp:rel-id="ref-16">16</xref>]. Again we used the same pipeline as shown in <bold><xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-4" hwp:rel-id="F3">Figure 3A</xref></bold>. GranatumX offers multiple popular clustering algorithms, and for this dataset we used the Louvain algorithm. For illustration purposes, we focus on the viewing and clustering of this large graph-based clustering method implemented by Scanpy. A total of 44 clusters are assigned on the UMAP plot (<bold><xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-5" hwp:rel-id="F3">Figure 3C</xref></bold>). We also superimposed the metadata that contain tissue types for each cell on the same plot for visualization (<bold>Supplementary Figure 1</bold>). The complete analysis report of this dataset is included as <bold>Supplementary File 2</bold>.</p></sec></sec><sec id="s4" hwp:id="sec-20"><title hwp:id="title-27">Discussion</title><p hwp:id="p-30">With the ever-increasing popularity of scRNA-seq, more and more experimental biologists will adopt this technology. At the same time, new bioinformatics tools are being developed rapidly. The development of GranatumX fills in a unique niche that enables both scientific and technical advancements. It is a “common ground” that connects scRNA-seq tool developers with the end-users, together for new discoveries. Domain experts can use GranatumX for the initial exploratory analysis. Additionally, with more Gboxes to be implemented on model performance metrics, GranatumX could be a vessel to enable benchmark studies to compare existing computational modules and pipelines, as well as assess the performance of a new method or pipeline relative to the existing ones. Moreover, it can also serve as the test engine to probe the source of variations in different modules, so as to optimize a pipeline for given datasets.</p><p hwp:id="p-31">To demonstrate the uniqueness of GranatumX, we also compare it with other similar tools for comprehensive scRNA-seq analysis, such as SC1[<xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">17</xref>], ASAP [<xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-2" hwp:rel-id="ref-10">10</xref>] and Single Cell Explorer [<xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-1" hwp:rel-id="ref-18">18</xref>] in <bold><xref rid="tbl2" ref-type="table" hwp:id="xref-table-wrap-2-1" hwp:rel-id="T2">Table 2</xref></bold>. While all these tools aim for simple report and interaction with biologists, GranatumX is the only framework that supports bioinformatics developers to contribute their own plug-ins (<bold><xref rid="tbl2" ref-type="table" hwp:id="xref-table-wrap-2-2" hwp:rel-id="T2">Table 2</xref></bold>). This significantly enhances the adaptability of GranatumX among the developer community. The web-tool that is closest to GranatumX is Single Cell Explorer, still with significant differences in the functionalities. Single Cell Explorer begins from raw data processing including reading mapping alignment. GranatumX is a much lighter-weight tool that starts from a cell read count table since the alignment/tag counting step is readily done by the popular Cell Ranger software of the 10x genomics platform. Instead, GranatumX put more efforts on downstream analysis, such as gene enrichment analysis, protein-protein interaction and pseudo-time construction (<bold><xref rid="tbl2" ref-type="table" hwp:id="xref-table-wrap-2-3" hwp:rel-id="T2">Table 2</xref></bold>). For ASAP, besides lacking modules to perform functions such as imputation, protein-protein interaction and pseudo-time construction, it also does not allow reconfiguration of the pipeline like GranatumX. SC1 lacks the flexibility and functionalities similar to ASAP and is restricted by Shiny, an R programming language based web-interface, whereas GranatumX accepted containerized Gboxes packaged written in R, Python, or other languages.</p><table-wrap id="tbl2" orientation="portrait" position="float" hwp:id="T2" hwp:rev-id="xref-table-wrap-2-1 xref-table-wrap-2-2 xref-table-wrap-2-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;385591v4/TBL2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T2</object-id><object-id pub-id-type="publisher-id">tbl2</object-id><label>Table 2.</label><caption hwp:id="caption-5"><p hwp:id="p-32">Comparison on multiple user-friendly web-tools.</p></caption><graphic xlink:href="385591v4_tbl2" position="float" orientation="portrait" hwp:id="graphic-7"/><graphic xlink:href="385591v4_tbl2a" position="float" orientation="portrait" hwp:id="graphic-8"/></table-wrap><p hwp:id="p-33">As an inclusive and open software environment that employs other third-party tools, GranatumX has some challenges. One of them is handling the upgrade of underlying 3rd party libraries and resources. Accompanying with updated 3rd party tools which may not be tested extensively by the original developers, errors from these packages may propagate into GranatumX. To deal with this issue, we implement versioning through the use of Docker which helps to maintain system-level dependencies as well as software dependencies in a complete package. The Gbox Docker containers for this release are listed in the <bold>Supplementary Table 2</bold> with a version number of 1.0.0. New versions can update the minor and major revision numbers so that users know exactly which code is being executed for a given pipeline. The source code for the Docker containers which represent the Gboxes are stored in the corresponding GitHub repositories. For example, <ext-link l:rel="related" l:ref-type="uri" l:ref="https://hub.docker.com/r/granatumx/gbox-differentialexpression" ext-link-type="uri" xlink:href="https://hub.docker.com/r/granatumx/gbox-differentialexpression" hwp:id="ext-link-9">https://hub.docker.com/r/granatumx/gbox-differentialexpression</ext-link> is stored in <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/granatumx/gbox-differentialexpression" ext-link-type="uri" xlink:href="https://github.com/granatumx/gbox-differentialexpression" hwp:id="ext-link-10">https://github.com/granatumx/gbox-differentialexpression</ext-link>. Such an endeavor provides safety and reliability in maintaining the stability of the software not just in the source of the software but in the configuration of the system required to run the computational elements. Due to its openness, GranatumX can not prevent p-hacking or manipulating data analysis to improve the statistical significance of the desired result [<xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-1" hwp:rel-id="ref-19">19</xref>]. One way to discourage p-hacking is to suggest using standard pipeline and default parameters. If the user chooses values other than defaults, the reproducible design of GranatumX allows one to compare the outputs from the users (if they are recorded) with those from the default setting.</p></sec><sec id="s5" hwp:id="sec-21"><title hwp:id="title-28">Conclusions</title><p hwp:id="p-34">We present an open-source, shareable and evolvable single cell analysis tool called GranantumX. It not only enables the domain experts to independently conduct single cell analysis, but also promotes bioinformatics tool developers to contribute and develop their own single cell analysis methods through Gbox plug-in setup. We hope that GranatumX will engage the single cell analysis community broadly and continuously for scientific discoveries.</p></sec><sec sec-type="supplementary-material" hwp:id="sec-22"><title hwp:id="title-29">Supporting information</title><supplementary-material position="float" orientation="portrait" hwp:id="DC1"><object-id pub-id-type="other" hwp:sub-type="slug">DC1</object-id><label>Supplementary Figure 1</label><media xlink:href="supplements/385591_file05.pdf" position="float" orientation="portrait" hwp:id="media-1"/></supplementary-material><supplementary-material position="float" orientation="portrait" hwp:id="DC2"><object-id pub-id-type="other" hwp:sub-type="slug">DC2</object-id><label>Supplemetnary File 2</label><media xlink:href="supplements/385591_file06.pdf" position="float" orientation="portrait" hwp:id="media-2"/></supplementary-material><supplementary-material position="float" orientation="portrait" hwp:id="DC3"><object-id pub-id-type="other" hwp:sub-type="slug">DC3</object-id><label>Supplementary File 3</label><media xlink:href="supplements/385591_file07.pdf" position="float" orientation="portrait" hwp:id="media-3"/></supplementary-material><supplementary-material position="float" orientation="portrait" hwp:id="DC4"><object-id pub-id-type="other" hwp:sub-type="slug">DC4</object-id><label>Supplementary Table 1</label><media xlink:href="supplements/385591_file08.xlsx" position="float" orientation="portrait" hwp:id="media-4"/></supplementary-material><supplementary-material position="float" orientation="portrait" hwp:id="DC5"><object-id pub-id-type="other" hwp:sub-type="slug">DC5</object-id><label>Supplementary Table 2</label><media xlink:href="supplements/385591_file09.xlsx" position="float" orientation="portrait" hwp:id="media-5"/></supplementary-material></sec></body><back><sec id="s6" hwp:id="sec-23"><title hwp:id="title-30">Code availability</title><p hwp:id="p-35">The webtool of GranatumX can be found at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://garmiregroup.org/granatumx/app" ext-link-type="uri" xlink:href="http://garmiregroup.org/granatumx/app" hwp:id="ext-link-11">http://garmiregroup.org/granatumx/app</ext-link>. On this website, users can also find youtube or youku tutorial videos that demonstrate how to use GranatumX webtool. The source code for GranatumX is available at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/granatumx" ext-link-type="uri" xlink:href="https://github.com/granatumx" hwp:id="ext-link-12">https://github.com/granatumx</ext-link> under MIT license. All builds are deployed via Docker Hub at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://hub.docker.com/u/granatumx" ext-link-type="uri" xlink:href="https://hub.docker.com/u/granatumx" hwp:id="ext-link-13">https://hub.docker.com/u/granatumx</ext-link>.</p></sec><sec id="s7" hwp:id="sec-24"><title hwp:id="title-31">Copyright</title><p hwp:id="p-36">Some of the cartoon icons in <xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-2" hwp:rel-id="F1">Figure 1</xref> and <xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-6" hwp:rel-id="F2">Figure 2</xref> are downloaded from <ext-link l:rel="related" l:ref-type="uri" l:ref="https://www.flaticon.com/" ext-link-type="uri" xlink:href="https://www.flaticon.com/" hwp:id="ext-link-14">https://www.flaticon.com/</ext-link>.</p></sec><sec id="s8" hwp:id="sec-25"><title hwp:id="title-32">CRediT authorship contribution statement</title><p hwp:id="p-37">Lana × Garmire: Conceptualization, supervision, writing manuscript. David Garmire, Xun Zhu: Design, implementation of Software, writing manuscript. Aravind Mantravadi, Breck Yunits: Implementation and code testing. Qianhui Huang, Yu Liu: case study and testing. Thomas Wolfgruber, Olivier Poirion, Tianying Zhao, Cédric Arisdakessian, Stefan Stanojevic: implementation of Gbox. All authors have read and approved the manuscript.</p></sec><ack hwp:id="ack-1"><title hwp:id="title-33">Acknowledgment</title><p hwp:id="p-38">We thank Dr. Larry Reiter for providing valuable feedback while using GrantumX to test his single cell dataset. This research was supported by grants K01ES025434 awarded by NIEHS through funds provided by the trans-NIH Big Data to Knowledge (BD2K) initiative (<ext-link l:rel="related" l:ref-type="uri" l:ref="http://www.bd2k.nih.gov" ext-link-type="uri" xlink:href="http://www.bd2k.nih.gov" hwp:id="ext-link-15">www.bd2k.nih.gov</ext-link>), P20 COBRE GM103457 awarded by NIH/NIGMS, R01 LM012373 awarded by NLM, R01 HD084633 awarded by NICHD to L.X. Garmire.</p></ack><sec sec-type="display-objects" hwp:id="sec-26"><fig id="ufig1" position="float" fig-type="figure" orientation="portrait" hwp:id="F4"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;385591v4/UFIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F4</object-id><object-id pub-id-type="publisher-id">ufig1</object-id><graphic xlink:href="385591v4_ufig1" position="float" orientation="portrait" hwp:id="graphic-9"/></fig></sec><sec id="s9" hwp:id="sec-27"><title hwp:id="title-34">Supplementary Materials</title><p hwp:id="p-39"><bold>Supplementary Figure 1. UMAP plot with annotated tissue types in the Tabula Muris Consortium data</bold>.</p><p hwp:id="p-40"><bold>Supplementary Table 1. The running time for different steps of the recommended pipeline in GranatumX over 10</bold>,<bold>000 cells, using an AMD 3950X processor, 16 cores, with 128 GB of RAM</bold>.</p><p hwp:id="p-41"><bold>Supplementary Table 2. The list of currently implemented Gboxes</bold>.</p><p hwp:id="p-42"><bold>Supplementary File 1: The analysis report using a dataset with metastatic Merkel cell carcinoma from the 10x genomics platform</bold>.</p><p hwp:id="p-43"><bold>Supplementary File 2: The analysis report using a dataset with Tabula Muris Consortium data</bold>.</p></sec><ref-list hwp:id="ref-list-1"><title hwp:id="title-35">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1"><label>[1]</label><citation publication-type="journal" citation-type="journal" ref:id="385591v4.1" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Saliba A-E"><surname>Saliba</surname> <given-names>A-E</given-names></string-name>, <string-name name-style="western" hwp:sortable="Westermann AJ"><surname>Westermann</surname> <given-names>AJ</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gorski SA"><surname>Gorski</surname> <given-names>SA</given-names></string-name>, <string-name name-style="western" hwp:sortable="Vogel J."><surname>Vogel</surname> <given-names>J.</given-names></string-name> <article-title hwp:id="article-title-2">Single-cell RNA-seq: advances and future challenges</article-title>. <source hwp:id="source-1">Nucleic Acids Res</source> <year>2014</year>;<volume>42</volume>:<fpage>8845</fpage>–<lpage>60</lpage>.</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1"><label>[2]</label><citation publication-type="journal" citation-type="journal" ref:id="385591v4.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="Zappia L"><surname>Zappia</surname> <given-names>L</given-names></string-name>, <string-name name-style="western" hwp:sortable="Phipson B"><surname>Phipson</surname> <given-names>B</given-names></string-name>, <string-name name-style="western" hwp:sortable="Oshlack A."><surname>Oshlack</surname> <given-names>A.</given-names></string-name> <article-title hwp:id="article-title-3">Exploring the single-cell RNA-seq analysis landscape with the scRNA-tools database</article-title>. <source hwp:id="source-2">PLoS Comput Biol</source> <year>2018</year>;<volume>14</volume>:<fpage>e1006245</fpage>.</citation></ref><ref id="c3" hwp:id="ref-3" hwp:rev-id="xref-ref-3-1"><label>[3]</label><citation publication-type="journal" citation-type="journal" ref:id="385591v4.3" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Svensson V"><surname>Svensson</surname> <given-names>V</given-names></string-name>, <string-name name-style="western" hwp:sortable="Vento-Tormo R"><surname>Vento-Tormo</surname> <given-names>R</given-names></string-name>, <string-name name-style="western" hwp:sortable="Teichmann SA"><surname>Teichmann</surname> <given-names>SA</given-names></string-name>. <article-title hwp:id="article-title-4">Exponential scaling of single-cell RNA-seq in the past decade</article-title>. <source hwp:id="source-3">Nat Protoc</source> <year>2018</year>;<volume>13</volume>:<fpage>599</fpage>–<lpage>604</lpage>.</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1"><label>[4]</label><citation publication-type="website" citation-type="web" ref:id="385591v4.4" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-4"><collab hwp:id="collab-1">Evaluation of Cell Type Annotation R Packages on Single-cell RNA-seq Data</collab>. <source hwp:id="source-4">Genomics Proteomics Bioinformatics</source> <year>2020</year>. <ext-link l:rel="related" l:ref-type="uri" l:ref="https://doi.org/10.1016/j.gpb.2020.07.004" ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.gpb.2020.07.004" hwp:id="ext-link-16">https://doi.org/10.1016/j.gpb.2020.07.004</ext-link>.</citation></ref><ref id="c5" hwp:id="ref-5"><label>[5]</label><citation publication-type="journal" citation-type="journal" ref:id="385591v4.5" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Poirion OB"><surname>Poirion</surname> <given-names>OB</given-names></string-name>, <string-name name-style="western" hwp:sortable="Zhu X"><surname>Zhu</surname> <given-names>X</given-names></string-name>, <string-name name-style="western" hwp:sortable="Ching T"><surname>Ching</surname> <given-names>T</given-names></string-name>, <string-name name-style="western" hwp:sortable="Garmire L."><surname>Garmire</surname> <given-names>L.</given-names></string-name> <article-title hwp:id="article-title-5">Single-Cell Transcriptomics Bioinformatics and Computational Challenges</article-title>. <source hwp:id="source-5">Frontiers in Genetics</source> <year>2016</year>;<volume>7</volume>:<fpage>163</fpage>.</citation></ref><ref id="c6" hwp:id="ref-6" hwp:rev-id="xref-ref-6-1 xref-ref-6-2"><label>[6]</label><citation publication-type="journal" citation-type="journal" ref:id="385591v4.6" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Arisdakessian C"><surname>Arisdakessian</surname> <given-names>C</given-names></string-name>, <string-name name-style="western" hwp:sortable="Poirion O"><surname>Poirion</surname> <given-names>O</given-names></string-name>, <string-name name-style="western" hwp:sortable="Yunits B"><surname>Yunits</surname> <given-names>B</given-names></string-name>, <string-name name-style="western" hwp:sortable="Zhu X"><surname>Zhu</surname> <given-names>X</given-names></string-name>, <string-name name-style="western" hwp:sortable="Garmire LX"><surname>Garmire</surname> <given-names>LX</given-names></string-name>. <article-title hwp:id="article-title-6">DeepImpute: an accurate, fast, and scalable deep neural network method to impute single-cell RNA-seq data</article-title>. <source hwp:id="source-6">Genome Biol</source> <year>2019</year>;<volume>20</volume>:<fpage>211</fpage>.</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1"><label>[7]</label><citation publication-type="journal" citation-type="journal" ref:id="385591v4.7" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Guo M"><surname>Guo</surname> <given-names>M</given-names></string-name>, <string-name name-style="western" hwp:sortable="Wang H"><surname>Wang</surname> <given-names>H</given-names></string-name>, <string-name name-style="western" hwp:sortable="Potter SS"><surname>Potter</surname> <given-names>SS</given-names></string-name>, <string-name name-style="western" hwp:sortable="Whitsett JA"><surname>Whitsett</surname> <given-names>JA</given-names></string-name>, <string-name name-style="western" hwp:sortable="Xu Y."><surname>Xu</surname> <given-names>Y.</given-names></string-name> <article-title hwp:id="article-title-7">SINCERA: A Pipeline for Single-Cell RNA-Seq Profiling Analysis</article-title>. <source hwp:id="source-7">PLoS Comput Biol</source> <year>2015</year>;<volume>11</volume>:<fpage>e1004575</fpage>.</citation></ref><ref id="c8" hwp:id="ref-8" hwp:rev-id="xref-ref-8-1"><label>[8]</label><citation publication-type="journal" citation-type="journal" ref:id="385591v4.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Butler A"><surname>Butler</surname> <given-names>A</given-names></string-name>, <string-name name-style="western" hwp:sortable="Hoffman P"><surname>Hoffman</surname> <given-names>P</given-names></string-name>, <string-name name-style="western" hwp:sortable="Smibert P"><surname>Smibert</surname> <given-names>P</given-names></string-name>, <string-name name-style="western" hwp:sortable="Papalexi E"><surname>Papalexi</surname> <given-names>E</given-names></string-name>, <string-name name-style="western" hwp:sortable="Satija R."><surname>Satija</surname> <given-names>R.</given-names></string-name> <article-title hwp:id="article-title-8">Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source hwp:id="source-8">Nat Biotechnol</source> <year>2018</year>;<volume>36</volume>:<fpage>411</fpage>–<lpage>20</lpage>.</citation></ref><ref id="c9" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1"><label>[9]</label><citation publication-type="journal" citation-type="journal" ref:id="385591v4.9" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Wolf FA"><surname>Wolf</surname> <given-names>FA</given-names></string-name>, <string-name name-style="western" hwp:sortable="Alexander Wolf F"><surname>Alexander Wolf</surname> <given-names>F</given-names></string-name>, <string-name name-style="western" hwp:sortable="Angerer P"><surname>Angerer</surname> <given-names>P</given-names></string-name>, <string-name name-style="western" hwp:sortable="Theis FJ"><surname>Theis</surname> <given-names>FJ</given-names></string-name>. <article-title hwp:id="article-title-9">SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source hwp:id="source-9">Genome Biology</source> <year>2018</year>;<volume>19</volume>:<fpage>15</fpage>.</citation></ref><ref id="c10" hwp:id="ref-10" hwp:rev-id="xref-ref-10-1 xref-ref-10-2"><label>[10]</label><citation publication-type="journal" citation-type="journal" ref:id="385591v4.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="David FPA"><surname>David</surname> <given-names>FPA</given-names></string-name>, <string-name name-style="western" hwp:sortable="Litovchenko M"><surname>Litovchenko</surname> <given-names>M</given-names></string-name>, <string-name name-style="western" hwp:sortable="Deplancke B"><surname>Deplancke</surname> <given-names>B</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gardeux V."><surname>Gardeux</surname> <given-names>V.</given-names></string-name> <article-title hwp:id="article-title-10">ASAP 2020 update: an open, scalable and interactive web-based portal for (single-cell) omics analyses</article-title>. <source hwp:id="source-10">Nucleic Acids Res</source> <year>2020</year>;<volume>48</volume>:<fpage>W403</fpage>–<lpage>14</lpage>.</citation></ref><ref id="c11" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1"><label>[11]</label><citation publication-type="journal" citation-type="journal" ref:id="385591v4.11" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="Zhu X"><surname>Zhu</surname> <given-names>X</given-names></string-name>, <string-name name-style="western" hwp:sortable="Wolfgruber TK"><surname>Wolfgruber</surname> <given-names>TK</given-names></string-name>, <string-name name-style="western" hwp:sortable="Tasato A"><surname>Tasato</surname> <given-names>A</given-names></string-name>, <string-name name-style="western" hwp:sortable="Arisdakessian C"><surname>Arisdakessian</surname> <given-names>C</given-names></string-name>, <string-name name-style="western" hwp:sortable="Garmire DG"><surname>Garmire</surname> <given-names>DG</given-names></string-name>, <string-name name-style="western" hwp:sortable="Garmire LX"><surname>Garmire</surname> <given-names>LX</given-names></string-name>. <article-title hwp:id="article-title-11">Granatum: a graphical single-cell RNA-Seq analysis pipeline for genomics scientists</article-title>. <source hwp:id="source-11">Genome Med</source> <year>2017</year>;<volume>9</volume>:<fpage>108</fpage>.</citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1"><label>[12]</label><citation publication-type="website" citation-type="web" ref:id="385591v4.12" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Felter W"><surname>Felter</surname> <given-names>W</given-names></string-name>, <string-name name-style="western" hwp:sortable="Ferreira A"><surname>Ferreira</surname> <given-names>A</given-names></string-name>, <string-name name-style="western" hwp:sortable="Rajamony R"><surname>Rajamony</surname> <given-names>R</given-names></string-name>, <string-name name-style="western" hwp:sortable="Rubio J."><surname>Rubio</surname> <given-names>J.</given-names></string-name> <article-title hwp:id="article-title-12">An updated performance comparison of virtual machines and Linux containers</article-title>. <source hwp:id="source-12">2015 IEEE International Symposium on Performance Analysis of Systems and Software (ISPASS)</source> <year>2015</year>. <ext-link l:rel="related" l:ref-type="uri" l:ref="https://doi.org/10.1109/ispass.2015.7095802" ext-link-type="uri" xlink:href="https://doi.org/10.1109/ispass.2015.7095802" hwp:id="ext-link-17">https://doi.org/10.1109/ispass.2015.7095802</ext-link>.</citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1"><label>[13]</label><citation publication-type="website" citation-type="web" ref:id="385591v4.13" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-13"><collab hwp:id="collab-2">Docker: Lightweight Linux Containers for Consistent Development and Deployment</collab>. <source hwp:id="source-13">Linux Journal</source> <year>2014</year>. <ext-link l:rel="related" l:ref-type="uri" l:ref="http://dl.acm.org/citation.cfm?id=2600239.2600241" ext-link-type="uri" xlink:href="http://dl.acm.org/citation.cfm?id=2600239.2600241" hwp:id="ext-link-18">http://dl.acm.org/citation.cfm?id=2600239.2600241</ext-link> (accessed <date-in-citation content-type="access-date">June 22, 2021</date-in-citation>).</citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1"><label>[14]</label><citation publication-type="journal" citation-type="journal" ref:id="385591v4.14" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Kurtzer GM"><surname>Kurtzer</surname> <given-names>GM</given-names></string-name>, <string-name name-style="western" hwp:sortable="Sochat V"><surname>Sochat</surname> <given-names>V</given-names></string-name>, <string-name name-style="western" hwp:sortable="Bauer MW"><surname>Bauer</surname> <given-names>MW</given-names></string-name>. <article-title hwp:id="article-title-13">Singularity: Scientific containers for mobility of compute</article-title>. <source hwp:id="source-14">PLoS One</source> <year>2017</year>;<volume>12</volume>:<fpage>e0177459</fpage>.</citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1 xref-ref-15-2"><label>[15]</label><citation publication-type="journal" citation-type="journal" ref:id="385591v4.15" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Paulson KG"><surname>Paulson</surname> <given-names>KG</given-names></string-name>, <string-name name-style="western" hwp:sortable="Voillet V"><surname>Voillet</surname> <given-names>V</given-names></string-name>, <string-name name-style="western" hwp:sortable="McAfee MS"><surname>McAfee</surname> <given-names>MS</given-names></string-name>, <string-name name-style="western" hwp:sortable="Hunter DS"><surname>Hunter</surname> <given-names>DS</given-names></string-name>, <string-name name-style="western" hwp:sortable="Wagener FD"><surname>Wagener</surname> <given-names>FD</given-names></string-name>, <string-name name-style="western" hwp:sortable="Perdicchio M"><surname>Perdicchio</surname> <given-names>M</given-names></string-name>, <etal>et al.</etal> <article-title hwp:id="article-title-14">Acquired cancer resistance to combination immunotherapy from transcriptional loss of class I HLA</article-title>. <source hwp:id="source-15">Nature Communications</source> <year>2018</year>;<volume>9</volume>:<fpage>3868</fpage>.</citation></ref><ref id="c16" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1 xref-ref-16-2"><label>[16]</label><citation publication-type="journal" citation-type="journal" ref:id="385591v4.16" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-16"><collab hwp:id="collab-3">Tabula Muris Consortium, Overall coordination, Logistical coordination, Organ collection and processing, Library preparation and sequencing, Computational data analysis</collab>, <etal>et al.</etal> <article-title hwp:id="article-title-15">Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title>. <source hwp:id="source-16">Nature</source> <year>2018</year>;<volume>562</volume>:<fpage>367</fpage>–<lpage>72</lpage>.</citation></ref><ref id="c17" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1"><label>[17]</label><citation publication-type="website" citation-type="web" ref:id="385591v4.17" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="Moussa M"><surname>Moussa</surname> <given-names>M</given-names></string-name>, <string-name name-style="western" hwp:sortable="Mandoiu II"><surname>Mandoiu</surname> <given-names>II</given-names></string-name>. <article-title hwp:id="article-title-16">SC1: A web-based single cell RNA-seq analysis pipeline</article-title>. <source hwp:id="source-17">2018 IEEE 8th International Conference on Computational Advances in Bio and Medical Sciences (ICCABS)</source> <year>2018</year>. <ext-link l:rel="related" l:ref-type="uri" l:ref="https://doi.org/10.1109/iccabs.2018.8542088" ext-link-type="uri" xlink:href="https://doi.org/10.1109/iccabs.2018.8542088" hwp:id="ext-link-19">https://doi.org/10.1109/iccabs.2018.8542088</ext-link>.</citation></ref><ref id="c18" hwp:id="ref-18" hwp:rev-id="xref-ref-18-1"><label>[18]</label><citation publication-type="journal" citation-type="journal" ref:id="385591v4.18" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-18"><string-name name-style="western" hwp:sortable="Feng D"><surname>Feng</surname> <given-names>D</given-names></string-name>, <string-name name-style="western" hwp:sortable="Whitehurst CE"><surname>Whitehurst</surname> <given-names>CE</given-names></string-name>, <string-name name-style="western" hwp:sortable="Shan D"><surname>Shan</surname> <given-names>D</given-names></string-name>, <string-name name-style="western" hwp:sortable="Hill JD"><surname>Hill</surname> <given-names>JD</given-names></string-name>, <string-name name-style="western" hwp:sortable="Yue YG"><surname>Yue</surname> <given-names>YG</given-names></string-name>. <article-title hwp:id="article-title-17">Single Cell Explorer, collaboration-driven tools to leverage large-scale single cell RNA-seq data</article-title>. <source hwp:id="source-18">BMC Genomics</source> <year>2019</year>;<volume>20</volume>:<fpage>676</fpage>.</citation></ref><ref id="c19" hwp:id="ref-19" hwp:rev-id="xref-ref-19-1"><label>[19]</label><citation publication-type="website" citation-type="web" ref:id="385591v4.19" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-19"><collab hwp:id="collab-4">P-HACKING</collab>. <source hwp:id="source-19">Oxford Online Dictionary n.d</source>. <ext-link l:rel="related" l:ref-type="uri" l:ref="https://www.lexico.com/definition/p-hacking" ext-link-type="uri" xlink:href="https://www.lexico.com/definition/p-hacking" hwp:id="ext-link-20">https://www.lexico.com/definition/p-hacking</ext-link> (accessed <date-in-citation content-type="access-date">June 22, 2021</date-in-citation>).</citation></ref></ref-list></back></article>
