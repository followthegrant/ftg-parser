<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/261149</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;261149v1</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;261149</article-id><article-id pub-id-type="other" hwp:sub-type="slug">261149</article-id><article-id pub-id-type="other" hwp:sub-type="tag">261149</article-id><article-version>1.1</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Bioinformatics" hwp:journal="biorxiv"><subject>Bioinformatics</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">Integrating Hi-C links with assembly graphs for chromosome-scale assembly</article-title></title-group><author-notes hwp:id="author-notes-1"><corresp id="cor1" hwp:id="corresp-1" hwp:rev-id="xref-corresp-1-1 xref-corresp-1-2"><label>*</label>To whom correspondence should be addressed.</corresp></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><name name-style="western" hwp:sortable="Ghurye Jay"><surname>Ghurye</surname><given-names>Jay</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">1</xref><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-1" hwp:rel-id="aff-2">2</xref></contrib><contrib contrib-type="author" hwp:id="contrib-2"><name name-style="western" hwp:sortable="Rhie Arang"><surname>Rhie</surname><given-names>Arang</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-2" hwp:rel-id="aff-2">2</xref></contrib><contrib contrib-type="author" hwp:id="contrib-3"><name name-style="western" hwp:sortable="Walenz Brian P."><surname>Walenz</surname><given-names>Brian P.</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-3" hwp:rel-id="aff-2">2</xref></contrib><contrib contrib-type="author" hwp:id="contrib-4"><name name-style="western" hwp:sortable="Schmitt Anthony"><surname>Schmitt</surname><given-names>Anthony</given-names></name><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-1" hwp:rel-id="aff-3">3</xref></contrib><contrib contrib-type="author" hwp:id="contrib-5"><name name-style="western" hwp:sortable="Selvaraj Siddarth"><surname>Selvaraj</surname><given-names>Siddarth</given-names></name><xref ref-type="aff" rid="a3" hwp:id="xref-aff-3-2" hwp:rel-id="aff-3">3</xref></contrib><contrib contrib-type="author" hwp:id="contrib-6"><name name-style="western" hwp:sortable="Pop Mihai"><surname>Pop</surname><given-names>Mihai</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" corresp="yes" hwp:id="contrib-7"><name name-style="western" hwp:sortable="Phillippy Adam M."><surname>Phillippy</surname><given-names>Adam M.</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-4" hwp:rel-id="aff-2">2</xref><xref ref-type="corresp" rid="cor1" hwp:id="xref-corresp-1-1" hwp:rel-id="corresp-1">*</xref></contrib><contrib contrib-type="author" corresp="yes" hwp:id="contrib-8"><name name-style="western" hwp:sortable="Koren Sergey"><surname>Koren</surname><given-names>Sergey</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-5" hwp:rel-id="aff-2">2</xref><xref ref-type="corresp" rid="cor1" hwp:id="xref-corresp-1-2" hwp:rel-id="corresp-1">*</xref></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2"><label>1</label><institution hwp:id="institution-1">Department of Computer Science, University of Maryland, College Park</institution>, <country>USA</country></aff><aff id="a2" hwp:id="aff-2" hwp:rev-id="xref-aff-2-1 xref-aff-2-2 xref-aff-2-3 xref-aff-2-4 xref-aff-2-5"><label>2</label><institution hwp:id="institution-2">Genome Informatics Section, Computational and Statistical Genomics Branch, National Human Genome Research Institute, National Institutes of Health, Bethesda</institution>, <country>USA</country></aff><aff id="a3" hwp:id="aff-3" hwp:rev-id="xref-aff-3-1 xref-aff-3-2"><label>3</label><institution hwp:id="institution-3">Arima Genomics, Inc, San Diego</institution>, <country>USA</country></aff></contrib-group><pub-date pub-type="epub-original" hwp:start="2018"><year>2018</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2018-02-07T04:54:16-08:00">
    <day>7</day><month>2</month><year>2018</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2018-02-07T04:54:16-08:00">
    <day>7</day><month>2</month><year>2018</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2018-02-07T05:00:14-08:00">
    <day>7</day><month>2</month><year>2018</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2018-02-07T05:00:14-08:00">
    <day>7</day><month>2</month><year>2018</year>
  </pub-date><elocation-id>261149</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2018-02-06"><day>06</day><month>2</month><year>2018</year></date>
<date date-type="rev-recd" hwp:start="2018-02-06"><day>06</day><month>2</month><year>2018</year></date>
<date date-type="accepted" hwp:start="2018-02-07"><day>07</day><month>2</month><year>2018</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2018</copyright-year><license hwp:id="license-1"><p hwp:id="p-1">The copyright holder for this pre-print is the author. All rights reserved. The material may not be redistributed, re-used or adapted without the author's permission.</p></license></permissions><self-uri xlink:href="261149.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2019/pdf/261149v1.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="261149.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2019/abstracts/261149v1/261149v1.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2019/fulltext/261149v1/261149v1.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><sec hwp:id="sec-1"><title hwp:id="title-2">Motivation</title><p hwp:id="p-2">Long-read sequencing and novel long-range assays have revolutionized de novo genome assembly by automating the reconstruction of reference-quality genomes. In particular, Hi-C sequencing is becoming an economical method for generating chromosome-scale scaffolds. Despite its increasing popularity, there are limited open-source tools available. Errors, particularly inversions and fusions across chromosomes, remain higher than alternate scaffolding technologies.</p></sec><sec hwp:id="sec-2"><title hwp:id="title-3">Results</title><p hwp:id="p-3">We present a novel open-source Hi-C scaffolder that does not require an <italic toggle="yes">a priori</italic> estimate of chromosome number and minimizes errors by scaffolding with the assistance of an assembly graph. We demonstrate higher accuracy than the state-of-the-art methods across a variety of Hi-C library preparations and input assembly sizes.</p></sec><sec hwp:id="sec-3"><title hwp:id="title-4">Availability and Implementation</title><p hwp:id="p-4">The Python and C++ code for our method is openly available at <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/machinegun/SALSA" ext-link-type="uri" xlink:href="https://github.com/machinegun/SALSA" hwp:id="ext-link-1">https://github.com/machinegun/SALSA</ext-link></p></sec><sec hwp:id="sec-4"><title hwp:id="title-5">Contact</title><p hwp:id="p-5"><email hwp:id="email-1">sergey.koren@nih.gov</email>, <email hwp:id="email-2">adam.phillippy@nih.gov</email></p></sec><sec sec-type="supplementary-material" hwp:id="sec-5"><title hwp:id="title-6">Supplementary information</title><p hwp:id="p-6">Not available online.</p></sec></abstract><counts><page-count count="9"/></counts><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-1">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta></front><body><sec id="s1" hwp:id="sec-6"><label>1</label><title hwp:id="title-7">Introduction</title><p hwp:id="p-7">Genome assembly is the process of reconstructing a complete genome sequence from significantly shorter sequencing reads. Most genome projects rely on whole genome shotgun sequencing which yields an oversampling of each genomic locus. Reads originating from the same locus are identified using assembly software, which can use these overlaps to reconstruct the genome sequence (<xref ref-type="bibr" rid="c25" hwp:id="xref-ref-28-1" hwp:rel-id="ref-28">Nagarajan and Pop, 2013</xref>; <xref ref-type="bibr" rid="c22" hwp:id="xref-ref-25-1" hwp:rel-id="ref-25">Miller <italic toggle="yes">et al.</italic>, 2010</xref>). Most approaches are based on either a de Bruijn (<xref ref-type="bibr" rid="c28" hwp:id="xref-ref-31-1" hwp:rel-id="ref-31">Pevzner <italic toggle="yes">et al.</italic>, 2001</xref>) or a string graph (<xref ref-type="bibr" rid="c23" hwp:id="xref-ref-26-1" hwp:rel-id="ref-26">Myers, 2005</xref>) formulation. Repetitive sequences exceeding the sequencing read length (<xref ref-type="bibr" rid="c24" hwp:id="xref-ref-27-1" hwp:rel-id="ref-27">Nagarajan and Pop, 2009</xref>) introduce ambiguity and prevent complete reconstruction. Unambiguous reconstructions of the sequence are output as “unitigs” (or often “contigs”). Ambiguous reconstructions are output as edges linking unitigs. Scaffolding utilizes long-range linking information such as BAC or fosmid clones (<xref ref-type="bibr" rid="c35" hwp:id="xref-ref-39-1" hwp:rel-id="ref-39">Venter <italic toggle="yes">et al.</italic>, 1996</xref>; <xref ref-type="bibr" rid="c11" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">Gnerre <italic toggle="yes">et al.</italic>, 2011</xref>), optical maps (<xref ref-type="bibr" rid="c32" hwp:id="xref-ref-36-1" hwp:rel-id="ref-36">Schwartz <italic toggle="yes">et al.</italic>, 1993</xref>; <xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-1" hwp:rel-id="ref-6">Dong <italic toggle="yes">et al.</italic>, 2013</xref>; Shelton <italic toggle="yes">et al.</italic>, 2015), linked reads (<xref ref-type="bibr" rid="c40" hwp:id="xref-ref-44-1" hwp:rel-id="ref-44">Zheng <italic toggle="yes">et al.</italic>, 2016</xref>; <xref ref-type="bibr" rid="c37" hwp:id="xref-ref-41-1" hwp:rel-id="ref-41">Weisenfeld <italic toggle="yes">et al.</italic>, 2017</xref>; <xref ref-type="bibr" rid="c39" hwp:id="xref-ref-43-1" hwp:rel-id="ref-43">Yeo <italic toggle="yes">et al.</italic>, 2017</xref>), or chromosomal conformation capture (<xref ref-type="bibr" rid="c34" hwp:id="xref-ref-38-1" hwp:rel-id="ref-38">Simonis <italic toggle="yes">et al.</italic>, 2006</xref>) to order and orient unitigs. If the linking information spans large distances on the chromosome, the resulting scaffolds can span entire chromosomes or chromosome arms.</p><p hwp:id="p-8">Hi-C is a sequencing-based assay originally designed to interrogate the 3D structure of the genome inside a cell nucleus by measuring the contact frequency between all pairs of loci in the genome (<xref ref-type="bibr" rid="c20" hwp:id="xref-ref-23-1" hwp:rel-id="ref-23">Lieberman-Aiden <italic toggle="yes">et al.</italic>, 2009</xref>). The contact frequency between a pair of loci strongly correlates with the one-dimensional distance between them. Hi-C data can provide linkage information across a variety of length scales, spanning tens of megabases. As a result, Hi-C data can be used for genome scaffolding. Shortly after its introduction, Hi-C was used to generate chromosome-scale scaffolds (<xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-1" hwp:rel-id="ref-3">Burton <italic toggle="yes">et al.</italic>, 2013</xref>; <xref ref-type="bibr" rid="c13" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">Kaplan and Dekker, 2013</xref>; <xref ref-type="bibr" rid="c21" hwp:id="xref-ref-24-1" hwp:rel-id="ref-24">Marie-Nelly <italic toggle="yes">et al.</italic>, 2014</xref>; <xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">Bickhart <italic toggle="yes">et al.</italic>, 2017</xref>; <xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">Dudchenko <italic toggle="yes">et al.</italic>, 2017</xref>).</p><p hwp:id="p-9">LACHESIS(Burton <italic toggle="yes">et al.</italic>, 2017) method first corrects the input assembly, using a lack of HiC coverage as evidence of error. It then orients and orders the corrected unitigs to generate scaffolds. However, SALSA requires manual parameter tuning for each dataset which affects the contiguity and correctness of the final scaffolds. Recently, the 3D-DNA (<xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-2" hwp:rel-id="ref-7">Dudchenko <italic toggle="yes">et al.</italic>, 2017</xref>) method was introduced and demonstrated on a draft assembly of the <italic toggle="yes">Aedes aegypti</italic> genome. 3D-DNA also corrects the errors in the input assembly and then iteratively orients and orders unitigs into a single megascaffold. This megascaffold is then broken into a user-specified number of chromosomes, identifying chromosomal ends based the on Hi-C contact map.</p><p hwp:id="p-10">There are several shortcomings common across currently available tools. They require the user to specify the number of chromosomes <italic toggle="yes">a priori</italic>. This can be challenging in novel genomes where no karyotype is available. An incorrect guess often leads to mis-joins that fuse chromosomes. They are also sensitive to input assembly contiguity and Hi-C library variations and require tuning of parameters for each dataset. Inversions are common when the input unitigs are short, as orientation is determined by maximizing the interaction frequency between unitig ends across all possible orientations (<xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-2" hwp:rel-id="ref-3">Burton <italic toggle="yes">et al.</italic>, 2013</xref>). When unitigs are long, there are few interactions spanning the full length of the unitig, making the true orientation apparent from the higher weight of links. However, in the case of short unitigs, there are interactions spanning the full length of the unitig, making the true orientation have a similar weight to incorrect orientations. Biological factors, such as topologically associated domains (TADs) also confound this analysis (<xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-1" hwp:rel-id="ref-5">Dixon <italic toggle="yes">et al.</italic>, 2012</xref>).</p><p hwp:id="p-11">In this work, we introduce SALSA2 – an open source software that combines Hi-C linkage information with the ambiguous-edge information from a genome assembly graph to better resolve unitig orientations. We also propose a novel stopping condition, which does not require an <italic toggle="yes">a priori</italic> estimate of chromosome count, as it naturally stops when the Hi-C information is exhausted. We show that SALSA2 has fewer orientation, ordering, and chimeric errors across a wide range of assembly contiguities. We also demonstrate robustness to different Hi-C libraries with varying intra-chromosomal contact frequencies. When compared to 3D-DNA, SALSA2 generates more accurate scaffolds across all conditions tested. To our knowledge, this is the first method to leverage assembly graph information for scaffolding Hi-C data.</p></sec><sec id="s2" hwp:id="sec-7"><label>2</label><title hwp:id="title-8">Methods</title><p hwp:id="p-12"><xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Figure 1</xref>(A) shows the overview of the SALSA2 pipeline. A draft assembly is generated from long reads such as Pacific Biosciences (<xref ref-type="bibr" rid="c9" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">Eid <italic toggle="yes">et al.</italic>, 2009</xref>) or Oxford Nanopore (<xref ref-type="bibr" rid="c12" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">Jain <italic toggle="yes">et al.</italic>, 2016</xref>). SALSA2 requires the unitig sequences and, optionally, a GFA-format graph (<xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">Li, 2016</xref>) representing the ambiguous reconstructions. Hi-C reads are aligned to the unitig sequences, and unitigs are optionally split in regions lacking Hi-C coverage. A hybrid scaffold graph is constructed using both ambiguous edges from the GFA and edges from the Hi-C reads, scoring edges according to a “best buddy” scheme. Scaffolds are iteratively constructed from this graph using a greedy weighted maximum matching. A mis-join detection step is performed after each iteration to check if any of the joins made during this round are incorrect. Incorrect joins are broken and the edges blacklisted during subsequent iterations. This process continues until the majority of joins made in the prior iteration are incorrect. This provides a natural stopping condition, when accurate Hi-C links have been exhausted. Below, we describe each of the steps in detail.</p><fig id="fig1" position="float" orientation="portrait" fig-type="figure" hwp:id="F1" hwp:rev-id="xref-fig-1-1 xref-fig-1-2 xref-fig-1-3 xref-fig-1-4 xref-fig-1-5"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;261149v1/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Fig. 1.</label><caption hwp:id="caption-1"><p hwp:id="p-13">(A) Overview of the SALSA2 scaffolding algorithm. (B) Linkage information obtained from the alignment of Hi-C reads to the assembly. (C) The assembly graph obtained from the assembler. (D) A hybrid scaffold graph constructed from the links obtained from the Hi-C read alignments and the overlap graph. Solid edges indicate the linkages between different unitigs and dotted edges indicate the links between the ends of the same unitig. (E) Maximal matching obtained from the graph using a greedy weighted maximum matching algorithm. (F) Edges between the ends of same unitigs are added back to the matching.</p></caption><graphic xlink:href="261149_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig><sec id="s2a" hwp:id="sec-8"><label>2.1</label><title hwp:id="title-9">Read alignment</title><p hwp:id="p-14">Hi-C paired end reads are aligned to unitigs using the BWA aligner (<xref ref-type="bibr" rid="c9" hwp:id="xref-ref-11-2" hwp:rel-id="ref-11">Li and Durbin, 2009</xref>)(parameters: -t 12 -B 8) as single end reads. Reads which align across ligation junctions are chimeric and are trimmed to retain only the start of the read which aligns prior to the ligation junction. After filtering the chimeric reads, the pairing information is restored. Any PCR duplicates in the paired-end alignments are removed using Picard tools (<xref ref-type="bibr" rid="c38" hwp:id="xref-ref-42-1" hwp:rel-id="ref-42">Wysoker <italic toggle="yes">et al.</italic>, 2013</xref>). Read pairs aligned to different unitigs are used to construct the initial scaffold graph. The suggested mapping pipeline is available at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://github.com/ArimaGenomics/mapping_pipeline" ext-link-type="uri" xlink:href="http://github.com/ArimaGenomics/mapping_pipeline" hwp:id="ext-link-2">http://github.com/ArimaGenomics/mapping_pipeline</ext-link>.</p><fig id="fig2" position="float" orientation="portrait" fig-type="figure" hwp:id="F2" hwp:rev-id="xref-fig-2-1 xref-fig-2-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;261149v1/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Fig. 2.</label><caption hwp:id="caption-2"><p hwp:id="p-15">Example of the mis-assembly detection algorithm in SALSA2. The plot shows the position on x-axis and the physical coverage on the y-axis. The dotted horizontal lines show the different thresholds tested to find low physical coverage intervals. The lines at the bottom show the suspicious intervals identified by the algorithm. The dotted line through the intervals shows the maximal clique. The smallest interval (purple) in the clique is identified as mis-assembly and the unitig is broken in three parts at its boundaries.</p></caption><graphic xlink:href="261149_fig2" position="float" orientation="portrait" hwp:id="graphic-2"/></fig></sec><sec id="s2b" hwp:id="sec-9"><label>2.2</label><title hwp:id="title-10">Unitig correction</title><p hwp:id="p-16">As any assembly is likely to contain mis-assembled sequences, SALSA2 uses the physical coverage of Hi-C pairs to identify suspicious regions and break the sequence at the likely point of mis-assembly. We define the physical coverage of a Hi-C read pair as the region on the unitig spanned by the start of the leftmost fragment and the end of the rightmost fragment. A drop in physical coverage indicates a likely assembly error. We extend the mis-assembly detection algorithm from SALSA which split a unitig when a fixed minimum coverage threshold was not met. A drawback of this approach is that coverage can vary, both due to sequencing depth and variation in Hi-C link density.</p><p hwp:id="p-17"><xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-1" hwp:rel-id="F2">Figure 2</xref> sketches the new unitig correction algorithm implemented in SALSA2. Instead of a single coverage threshold, a set of suspicious intervals is found with a sweep of thresholds. Using the collection of intervals as an interval graph, we find the maximal clique. This can be done in <italic toggle="yes">O</italic>(<italic toggle="yes">NlogN</italic>) time, where <italic toggle="yes">N</italic> is the number of intervals. For any clique of a minimum size, the region between the start and end of the smallest interval in the clique is flagged as a mis-assembly and the unitig is split into three pieces — the sequence to the left of the region, the junction region itself, and the sequence to the right of the region.</p></sec><sec id="s2c" hwp:id="sec-10"><label>2.3</label><title hwp:id="title-11">Assembly graph construction</title><p hwp:id="p-18">For our experiments, we use the unitig assembly graph produced by Canu (<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-19-1" hwp:rel-id="ref-19">Koren <italic toggle="yes">et al.</italic>, 2017</xref>) (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-2" hwp:rel-id="F1">Figure 1</xref>(C)), as this is the more conservative graph output. SALSA2 requires only a GFA format (<xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-2" hwp:rel-id="ref-4">Li, 2016</xref>) representation of the assembly. Since most long read genome assemblers such as FALCON (<xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-3" hwp:rel-id="ref-4">Chin <italic toggle="yes">et al.</italic>, 2016</xref>), miniasm (<xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-4" hwp:rel-id="ref-4">Li, 2016</xref>), Canu (<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-19-2" hwp:rel-id="ref-19">Koren <italic toggle="yes">et al.</italic>, 2017</xref>), and Flye (<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-18-1" hwp:rel-id="ref-18">Kolmogorov <italic toggle="yes">et al.</italic>, 2018</xref>) provide assembly graphs in GFA format, their output is compatible with SALSA2 for scaffolding.</p></sec><sec id="s2d" hwp:id="sec-11"><label>2.4</label><title hwp:id="title-12">Scaffold graph construction</title><p hwp:id="p-19">The scaffold graph is defined as <italic toggle="yes">G</italic>(<italic toggle="yes">V, E</italic>), where nodes <italic toggle="yes">V</italic> are the ends of unitigs and edges <italic toggle="yes">E</italic> are derived from the Hi-C read mapping (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-3" hwp:rel-id="F1">Figure 1B</xref>). The idea of using unitig ends as nodes is similar to that used by the string graph formulation (<xref ref-type="bibr" rid="c23" hwp:id="xref-ref-26-2" hwp:rel-id="ref-26">Myers, 2005</xref>).</p><p hwp:id="p-20">Modeling each unitig as two nodes allows a pair of unitigs to have multiple edges in any of the four possible orientations (forward-forward, forward-reverse, reverse-forward, and reverse-reverse). The graph then contains two edge types - one explicitly connects two different unitigs based on Hi-C data, while the other implicitly connects the two ends of the same unitig.</p><p hwp:id="p-21">We normalize the Hi-C read counts by the frequency of restriction enzyme cut sites in each unitig. This normalization reduces the bias in the number of shared read pairs due to the unitig length as the number of Hi-C reads sequenced from a particular region are proportional to the number of restriction enzyme cut sites in that region. For each unitig, we denote the number of times a cut site appears as <italic toggle="yes">C</italic>(<italic toggle="yes">V</italic>). We define edges weights of <italic toggle="yes">G</italic> as:
<disp-formula hwp:id="disp-formula-1"><alternatives hwp:id="alternatives-1"><graphic xlink:href="261149_ueqn1.gif" position="float" orientation="portrait" hwp:id="graphic-3"/></alternatives></disp-formula>
where <italic toggle="yes">N</italic>(<italic toggle="yes">u, v</italic>) is the number of Hi-C read pairs mapped to the ends of the unitigs <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic>.</p><p hwp:id="p-22">We observed that the globally highest edge weight does not always capture the correct orientation and ordering information due to variations in Hi-C interaction frequencies within a genome. To address this, we defined a modified edge ratio, similar to the one described in (<xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-3" hwp:rel-id="ref-7">Dudchenko <italic toggle="yes">et al.</italic>, 2017</xref>), which captures the relative weights of all the neighboring edges for a particular node.</p><p hwp:id="p-23">The best buddy weight <italic toggle="yes">BB</italic>(<italic toggle="yes">u, v</italic>) is the weight <italic toggle="yes">W</italic> (<italic toggle="yes">u, v</italic>) divided by the maximal weight of any edge incident upon nodes <italic toggle="yes">u</italic> or <italic toggle="yes">v</italic>, excluding the (<italic toggle="yes">u, v</italic>) edge itself. Computing best buddy weight naively would take <italic toggle="yes">O</italic>(<italic toggle="yes">|E|</italic><sup>2</sup>) time. This is computationally prohibitive since the graph, <italic toggle="yes">G</italic>, is usually dense. If the maximum weighted edge incident on each node is stored with the node, the running time for the computation becomes <italic toggle="yes">O</italic>(<italic toggle="yes">|E|</italic>). We retain only edges where <italic toggle="yes">BB</italic>(<italic toggle="yes">u, v</italic>) <italic toggle="yes">&gt;</italic> 1. This keeps only the edges which are the best incident edge on both <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic>. Once used, the edges are removed from subsequent iterations. Thus, the most confident edges are used first but initially low scoring edges can become best in subsequent iterations.</p><p hwp:id="p-24">For the assembly graph, we define a similar ratio. Since the edge weights are optional in the GFA specification and do not directly relate to the proximity of two unitigs on the chromosome, we use the graph topology to establish this relationship. Let <italic toggle="yes">ū</italic> denote the reverse complement of the unitig <italic toggle="yes">u</italic>. Let <italic toggle="yes">˙</italic>(<italic toggle="yes">u, v</italic>) denote the length of shortest path between <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic>. For each edge (<italic toggle="yes">u, v</italic>) in the scaffold graph, we find the shortest path between unitigs <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic> in every possible orientation, that is, <italic toggle="yes">˙</italic>(<italic toggle="yes">u, v</italic>), <italic toggle="yes">˙</italic>(<inline-formula hwp:id="inline-formula-1"><alternatives hwp:id="alternatives-2"><inline-graphic xlink:href="261149_inline1.gif" hwp:id="inline-graphic-1"/></alternatives></inline-formula>), <italic toggle="yes">˙</italic>(<inline-formula hwp:id="inline-formula-2"><alternatives hwp:id="alternatives-3"><inline-graphic xlink:href="261149_inline2.gif" hwp:id="inline-graphic-2"/></alternatives></inline-formula>) and <italic toggle="yes">˙</italic>(<inline-formula hwp:id="inline-formula-3"><alternatives hwp:id="alternatives-4"><inline-graphic xlink:href="261149_inline3.gif" hwp:id="inline-graphic-3"/></alternatives></inline-formula>). With this, the score for a pair of unitigs is defined as follows:
<disp-formula hwp:id="disp-formula-2"><alternatives hwp:id="alternatives-5"><graphic xlink:href="261149_ueqn2.gif" position="float" orientation="portrait" hwp:id="graphic-4"/></alternatives></disp-formula>
where <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic> are the orientations in which <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic> are connected by a shortest path in the assembly graph. Essentially, <italic toggle="yes">Score</italic>(<italic toggle="yes">u, v</italic>) is the ratio of the length of the second shortest path to the length of the shortest path in all possible orientations. Once again, we retain edges where <italic toggle="yes">Score</italic>(<italic toggle="yes">u, v</italic>) <italic toggle="yes">&gt;</italic> 1. If the orientation implied by the assembly graph differs from the orientation implied by the Hi-C data, we remove the HiC edge and retain the assembly graph edge (<xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-4" hwp:rel-id="F1">Figure 1D</xref>). Computing the score graph requires <italic toggle="yes">|E|</italic> shortest path queries, yielding total runtime of <italic toggle="yes">O</italic>(<italic toggle="yes">|E|</italic> (<italic toggle="yes">|V |</italic> + <italic toggle="yes">|E|</italic>)) since we do not use the edge weights.</p></sec><sec id="s2e" hwp:id="sec-12"><label>2.5</label><title hwp:id="title-13">Unitig layout</title><p hwp:id="p-25">Once we have the hybrid graph, we lay out the unitigs to generate scaffolds. Since there are implicit edges in the graph <italic toggle="yes">G</italic> between the beginning and end of each unitig, the problem of computing a scaffold layout can be modeled as finding a weighted maximum matching in a general graph, with edge weights being our ratio weights. If we find the weighted maximum matching of the non-implicit edges (that is, edges between different unitigs) in the graph, adding the implicit edges to this matching would yield a complete traversal. However, adding implicit edges to the matching can introduce a cycle. Such cycles are removed by removing the lowest weight non-implicit edge. Computing a maximal matching takes <italic toggle="yes">O</italic>(<italic toggle="yes">|E||V |</italic><sup>2</sup>) time (<xref ref-type="bibr" rid="c8b" hwp:id="xref-ref-10-1" hwp:rel-id="ref-10">Edmonds, 1965</xref>). We iteratively find a maximum matching in the graph by removing nodes found in the previous iteration. Using the optimal maximum matching algorithm this would take <italic toggle="yes">O</italic>(<italic toggle="yes">|E||V |</italic><sup>3</sup>) time, which would be extremely slow for large graphs. Instead, we use a greedy maximal matching algorithm which is guaranteed to find a matching within 1/2-approximation of the optimum (<xref ref-type="bibr" rid="c29" hwp:id="xref-ref-32-1" hwp:rel-id="ref-32">Poloczek and Szegedy, 2012</xref>). The greedy matching algorithm takes <italic toggle="yes">O</italic>(<italic toggle="yes">|E|</italic>) time, thereby making the total runtime <italic toggle="yes">O</italic>(<italic toggle="yes">|V ||E|</italic>). The algorithm for unitig layout is sketched in Algorithm 1. <xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-5" hwp:rel-id="F1">Figure 1</xref>(D - F) show the layout on an example graph.</p><p hwp:id="p-26">Junctions in the graph can prevent some nodes from being included in larger scaffolds. At a junction, only one of the possible unitigs can be included in the matching, demoting the other unitigs at the junction to alternate matchings. To account for this, we try to insert unitigs from small scaffolds (less than five unitigs) into all possible positions in the large scaffolds in all possible orientations. A unitig is inserted into the scaffold at the position and orientation which maximizes the sum of edge weights between it and all adjacent unitigs at that location. If the gain in the sum of edge weights is not sufficient, the unitig is not inserted into any of the existing scaffolds but can be scaffolded in subsequent iterations.</p><statement hwp:id="statement-1"><label>Algorithm 1</label><title hwp:id="title-14">Unitig Layout Algorithm</title><p hwp:id="p-27"><preformat position="float" orientation="portrait" xml:space="preserve" hwp:id="preformat-1">
<italic toggle="yes">E</italic> : Edges sorted by the best buddy weight
<italic toggle="yes">M</italic> : Set to store maximal matchings
<italic toggle="yes">G</italic> : The scaffold graph
<bold>while</bold> all nodes in <italic toggle="yes">G</italic> are not matched <bold>do</bold>
   <italic toggle="yes">M</italic>* = <italic toggle="yes">{}
   for e 2 E</italic> sorted by best buddy weights <bold>do</bold>
      if <italic toggle="yes">e</italic> can be added to <italic toggle="yes">M</italic>* then
         <italic toggle="yes">M</italic>* = <italic toggle="yes">M* [ e</italic>
      <bold>end if
   end for</bold>
   <italic toggle="yes">M</italic> = <italic toggle="yes">M [ M</italic>
   Remove nodes and edges which are part of <italic toggle="yes">M</italic>* from G
<bold>end while</bold>
</preformat></p></statement></sec><sec id="s2f" hwp:id="sec-13"><label>2.6</label><title hwp:id="title-15">Iterative mis-join correction</title><p hwp:id="p-28">Since the unitig layout is greedy, it can introduce errors by selecting a false Hi-C link which was not eliminated by our ratio scoring. These errors propagate downstream, causing large chimeric scaffolds and chromosomal fusions. We examine each join made within all the scaffolds in the last iteration for correctness. Any join with low spanning Hi-C support relative to the rest of the scaffold is broken and the links are blacklisted for further iterations.</p><p hwp:id="p-29">We compute the physical coverage spanned by all read pairs aligned in a window of size <italic toggle="yes">w</italic> around each join. For each window, <italic toggle="yes">w</italic>, we create an auxiliary array, which stores <italic toggle="yes">−</italic>1 at position <italic toggle="yes">i</italic> if the physical coverage is greater than some cutoff and 1, otherwise. We then find the maximum sum subarray in this auxiliary array, since it captures the longest stretch of low physical coverage. If the position being tested for a mis-join lies within the region spanned by the maximal clique generated with the maximum sum subarray intervals for different cutoffs (<xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-2" hwp:rel-id="F2">Figure 2</xref>), the join is marked as incorrect. The physical coverage can be computed in <italic toggle="yes">O</italic>(<italic toggle="yes">w</italic> + <italic toggle="yes">N</italic>) time, where <italic toggle="yes">N</italic> is the number of read pairs aligned in window <italic toggle="yes">w</italic>. The maximum sum subarray computation takes <italic toggle="yes">O</italic>(<italic toggle="yes">w</italic>) time. If <italic toggle="yes">K</italic> is the number of cutoffs(δ) tested for the suspicious join finding, then the total runtime of mis-assembly detection becomes <italic toggle="yes">O</italic>(<italic toggle="yes">K</italic>(<italic toggle="yes">N</italic> + 2 <italic toggle="yes">w</italic>)). The parameter <italic toggle="yes">K</italic> controls the specificity of the mis-assembly detection, thereby avoiding false positives. The algorithm for mis-join detection is sketched in Algorithm 2. When the majority of joins made in a particular iteration are flagged as incorrect by the algorithm, SASLA2 stops scaffolding and reports the scaffolds generated in the penultimate iteration as the final result.</p></sec></sec><sec id="s4" hwp:id="sec-14"><label>3</label><title hwp:id="title-16">Results</title><sec id="s4a" hwp:id="sec-15"><label>3.1</label><title hwp:id="title-17">Dataset description</title><p hwp:id="p-30">We created artificial assemblies, each containing unitigs of same size, by splitting the GRCh38 (<xref ref-type="bibr" rid="c31a" hwp:id="xref-ref-35-1" hwp:rel-id="ref-35">Schneider <italic toggle="yes">et al.</italic>, 2017</xref>) reference into fixed sized unitigs of 200 to 900 kbp. This gave us eight assemblies. The assembly graph for each input is built by adding edges for any adjacent unitigs in the genome.</p><p hwp:id="p-31">For real data, we use the recently published NA12878 human dataset sequenced with Oxford Nanopore (<xref ref-type="bibr" rid="c12a" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">Jain <italic toggle="yes">et al.</italic>, 2017</xref>) and assembled with Canu (<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-19-3" hwp:rel-id="ref-19">Koren <italic toggle="yes">et al.</italic>, 2017</xref>). We use a Hi-C library from Arima Genomics (Arima Genomics, San Diego, CA) sequenced to 40x coverage</p><statement hwp:id="statement-2"><label>Algorithm 2</label><title hwp:id="title-18">Misjoin detection and correction algorithm</title><p hwp:id="p-32"><preformat position="float" orientation="portrait" xml:space="preserve" hwp:id="preformat-2">
<italic toggle="yes">Cov</italic> : Physical coverage array for a window size <italic toggle="yes">w</italic> around a scaffold join at position <italic toggle="yes">p</italic> on a scaffold
<italic toggle="yes">A</italic> : Auxiliary array
<italic toggle="yes">I</italic> : Maximum sum subarray intervals
<bold>for</bold> <italic toggle="yes">δ</italic> ϵ {min_coverage, max_coverage} <bold>do
    if</bold> <italic toggle="yes">Cov</italic>[<italic toggle="yes">i</italic>] ≤ δ <bold>then</bold>
           <italic toggle="yes">A</italic>[<italic toggle="yes">i</italic>] = 1
    <bold>else</bold>
           <italic toggle="yes">A</italic>[<italic toggle="yes">i</italic>] = <italic toggle="yes">−</italic>1
    <bold>end if</bold>
    <italic toggle="yes">s
     sδ,eδ</italic> = maximum_sum_subarray(<italic toggle="yes">A</italic>)
     <italic toggle="yes">I</italic> = <italic toggle="yes">I</italic> ∪ [ {<italic toggle="yes">sδ,eδ</italic>}
<bold>end for</bold>
<italic toggle="yes">s, e</italic> =maximal_clique_interval(<italic toggle="yes">I</italic>)
<bold>if</bold> <italic toggle="yes">p</italic> ϵ {<italic toggle="yes">s, e</italic>} <bold>then</bold>
   Break the scaffold at position <italic toggle="yes">p</italic>
<bold>end if</bold>
</preformat></p></statement><p hwp:id="p-33">(SRX3651893). We compare results with the original SALSA, SALSA2 without the assembly graph input, and 3D-DNA. We did not compare our results with LACHESIS because it is no longer supported and is outperformed by 3D-DNA (<xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-4" hwp:rel-id="ref-7">Dudchenko <italic toggle="yes">et al.</italic>, 2017</xref>). SALSA2 was run using default parameters, with the exception of graph incorporation, as listed. For 3D-DNA, alignments were generated using the Juicer alignment pipeline (<xref ref-type="bibr" rid="c8a" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">Durand <italic toggle="yes">et al.</italic>, 2016b</xref>) with defaults (-m haploid -t 15000 -s 2), except for mis-assembly detection, as listed. The chromosome number was set to 23 for all experiments. A genome size of 3.2 Gbp was used for contiguity statistics for all assemblies.</p><p hwp:id="p-34">For evaluation, we also used the GRCh38 reference to define a set of true and false links from the Hi-C graph. We mapped the assembly to the reference with MUMmer3.23 (nucmer -c 500 -l 20) (<xref ref-type="bibr" rid="c17" hwp:id="xref-ref-20-1" hwp:rel-id="ref-20">Kurtz <italic toggle="yes">et al.</italic>, 2004</xref>) and generated a tiling using MUMmer’s show-tiling utility. For this“true link” dataset, any link joining unitigs in the same chromosome in the correct orientation was marked as true. This also gives the true unitig position, orientation, and chromosome assignment. We masked sequences in GRCh38 which matched known structural variants from a previous assembly of NA12878 (<xref ref-type="bibr" rid="c27" hwp:id="xref-ref-30-1" hwp:rel-id="ref-30">Pendleton <italic toggle="yes">et al.</italic>, 2015</xref>) to avoid counting true variations as scaffolding errors.</p><fig id="fig3" position="float" orientation="portrait" fig-type="figure" hwp:id="F3" hwp:rev-id="xref-fig-3-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;261149v1/FIG3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F3</object-id><object-id pub-id-type="publisher-id">fig3</object-id><label>Fig. 3.</label><caption hwp:id="caption-3"><p hwp:id="p-35">Precision at different cutoffs for Hi-C links. The plot on the left shows the curve for the SALSA2 best buddy weight cutoffs and the plot on the right shows the curve for a fixed Hi-C pair count cutoff, used in SALSA1, across changing coverage.</p></caption><graphic xlink:href="261149_fig3" position="float" orientation="portrait" hwp:id="graphic-5"/></fig><fig id="fig4" position="float" orientation="portrait" fig-type="figure" hwp:id="F4" hwp:rev-id="xref-fig-4-1 xref-fig-4-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;261149v1/FIG4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F4</object-id><object-id pub-id-type="publisher-id">fig4</object-id><label>Fig. 4.</label><caption hwp:id="caption-4"><p hwp:id="p-36">Comparison of orientation, ordering, and chimeric errors in the scaffolds produced by SALSA2 and 3D-DNA on the simulated data. As expected, the number of errors for all error types decrease with increasing input unitig size. Incorporating the assembly graph reduces error across all categories and most assembly sizes, with the largest decrease seen in orientation errors. SALSA2 utilizing the graph has 2-4 fold fewer errors than 3D-DNA.</p></caption><graphic xlink:href="261149_fig4" position="float" orientation="portrait" hwp:id="graphic-6"/></fig></sec><sec id="s4b" hwp:id="sec-16"><label>3.2</label><title hwp:id="title-19">Scoring effectiveness</title><p hwp:id="p-37">For correct scaffolding, we want to filter false edges and retain only the correct linkage information between pairs of unitigs. Our previous algorithm used a fixed, user-defined minimum for edges connecting a pair of unitigs. The drawback of a fixed cutoff is that it cannot handle variations in coverage within the assembly and varies between any pair of sequencing datasets. To compare the scoring methods, we down-sample the alignments into three different sets with 0.25, 0.5 and 0.75 of the original coverage and computed the precision of filtering based on the ratio score and a fixed threshold. The precision remained almost constant for the ratio cutoff on all datasets, whereas the precision changes rapidly for different coverages and a fixed threshold (<xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-1" hwp:rel-id="F3">Figure 3</xref>).</p></sec><sec id="s4c" hwp:id="sec-17"><label>3.3</label><title hwp:id="title-20">Evaluation on simulated unitigs</title><sec id="s4d1" hwp:id="sec-18"><title hwp:id="title-21">3.3.1 Assembly correction</title><p hwp:id="p-38">We simulated assembly error by randomly joining 200 pairs of unitigs from each simulated assembly. All erroneous joins were made between unitigs that are more than 10 Mbp apart or were assigned to different chromosomes in the reference. The remaining unitigs were unaltered. We then aligned the Arima-HiC data and ran our assembly correction algorithm. When the algorithm marked a mis-join within 20 kbp of a true error we called it a true positive, otherwise we called it a false positive. Any unmarked error was called a false negative. The average sensitivity over all simulated assemblies was 77.62% and the specificity was 86.13%. The sensitivity was highest for larger unitigs (50% for 200 kbp versus &gt;90% for untigs greater than 500 kbp) implying that our algorithm is able to accurately identify errors in large unitigs, which can have a negative impact on the final scaffolds if not corrected.</p></sec><sec id="s4e" hwp:id="sec-19"><title hwp:id="title-22">3.3.2 Scaffold mis-join validation</title><p hwp:id="p-39">As before, we simulated erroneous scaffolds by joining unitigs which were not within 10 Mbp in the reference or were assigned to different chromosomes. Rather than pairs of unitigs, each erroneous scaffold joined 10 unitigs and we generated 200 such erroneous scaffolds. The remaining unitigs were correctly scaffolded (ten unitigs per scaffold) based on their location in the reference. The average sensitivity was 68.89% and specificity was 100% (no correct scaffolds were broken). Most of the un-flagged joins occurred near the ends of scaffolds and could be captured by decreasing the window size. Similar to assembly correction, we observed that sensitivity was highest with larger input unitigs. This evaluation highlights the accuracy of the mis-join detection algorithm to avoid over-scaffolding and provide a suitable stopping condition.</p><fig id="fig5" position="float" orientation="portrait" fig-type="figure" hwp:id="F5" hwp:rev-id="xref-fig-5-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;261149v1/FIG5</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F5</object-id><object-id pub-id-type="publisher-id">fig5</object-id><label>Fig. 5.</label><caption hwp:id="caption-5"><p hwp:id="p-40">(A) NGA50 statistic for different input unitig sizes and (B) The length of longest error-free block for different input unitig sizes. Once again, the assembly graph typically increases both the NGA50 and the largest correct block.</p></caption><graphic xlink:href="261149_fig5" position="float" orientation="portrait" hwp:id="graphic-7"/></fig></sec><sec id="s4f" hwp:id="sec-20"><title hwp:id="title-23">3.3.3 Scaffold accuracy</title><p hwp:id="p-41">We evaluated scaffolds across three categories of error: orientation, order, and chimera. An orientation error occurs whenever the orientation of a unitig in a scaffold differs from that of the scaffold in the reference. An ordering error occurs when a set of three unitigs adjacent in a scaffold have non-monotonic coordinates in the reference. A chimera error occurs when any pair of unitigs adjacent in a scaffold align to different chromosomes in the reference. We broke the assembly at these errors and computed corrected scaffold lengths and NGA50 (analogous to the NGA50 defined by Salzberg et al. (<xref ref-type="bibr" rid="c31" hwp:id="xref-ref-34-1" hwp:rel-id="ref-34">Salzberg <italic toggle="yes">et al.</italic>, 2012</xref>)). This statistic corrects for large but incorrect scaffolds which have a high NG50 but are not useful for downstream analysis because of errors.</p><p hwp:id="p-42">Hi-C scaffolding errors, particularly orientation errors, increased with decreasing assembly contiguity. We evaluated scaffolding methods across a variety of simulated unitig sizes. <xref ref-type="fig" rid="fig4" hwp:id="xref-fig-4-1" hwp:rel-id="F4">Figure 4</xref> shows the comparison of these errors for 3D-DNA, SALSA2 without the assembly graph, and SALSA2 with the graph. SALSA2 produced fewer errors than 3D-DNA across all error types and input sizes. The number of correctly oriented unitigs increased significantly when assembly graph information was integrated with the scaffolding, particularly for lower input unitig sizes (<xref ref-type="fig" rid="fig4" hwp:id="xref-fig-4-2" hwp:rel-id="F4">Figure 4</xref>). For example, at 400 kbp, the orientation errors with the graph were comparable to the orientation errors of the graph-less approach at 900 kbp. The NGA50 for SALSA2 also increased when assembly graph information was included (<xref ref-type="fig" rid="fig5" hwp:id="xref-fig-5-1" hwp:rel-id="F5">Figure 5</xref>). This highlights the power of the assembly graph to improve scaffolding and correct errors, especially on lower contiguity assemblies. This also indicates that generating a conservative assembly, rather than maximizing contiguity, can be preferable for input to Hi-C scaffolding.</p><fig id="fig6" position="float" orientation="portrait" fig-type="figure" hwp:id="F6" hwp:rev-id="xref-fig-6-1 xref-fig-6-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;261149v1/FIG6</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F6</object-id><object-id pub-id-type="publisher-id">fig6</object-id><label>Fig. 6.</label><caption hwp:id="caption-6"><p hwp:id="p-43">Feature Response Curve for (A) assemblies obtained from unitigs as input (B) assemblies obtained from mitotic Hi-C data and (C) assemblies obtained using Dovetail Chicago data. The best assemblies lie near the top left of the plot, with the largest area under the curve. The FRC for 3D-DNA scaffolds with Chicago input is a straight line because 3D-DNA generated a single 2.7 Gbp super-scaffold which contained the majority of the genome sequence.</p></caption><graphic xlink:href="261149_fig6" position="float" orientation="portrait" hwp:id="graphic-8"/></fig><table-wrap id="tbl1" orientation="portrait" position="float" hwp:id="T1" hwp:rev-id="xref-table-wrap-1-1 xref-table-wrap-1-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;261149v1/TBL1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T1</object-id><object-id pub-id-type="publisher-id">tbl1</object-id><label>Table 1.</label><caption hwp:id="caption-7"><p hwp:id="p-44">Assembly scaffold and correctness statistics for NA12878 assemblies scaffolded with different Hi-C libraries. The NG50 of human reference GRCh38 is 145 Mbp. The ratio between NG50 and NGA50 represents how many erroneous joins affect large scaffolds in the assembly. A high ratio between NGA50 and NG50 indicates a more accurate assembly. We observe that 3D-DNA mis-assembly detections shears the input with both the mitotic Hi-C and Chicago data so we include results both with and without this assembly correction. In case of Chicago data, 3D-DNA generates a large super-scaffold containing more than 50% of the genome, giving a very high NG50 but a poor NGA50 and ratio.</p></caption><graphic xlink:href="261149_tbl1" position="float" orientation="portrait" hwp:id="graphic-9"/></table-wrap></sec></sec><sec id="s4g" hwp:id="sec-21"><label>3.4</label><title hwp:id="title-24">Evaluation on NA12878</title><p hwp:id="p-45"><xref ref-type="table" rid="tbl1" hwp:id="xref-table-wrap-1-1" hwp:rel-id="T1">Table 1</xref> lists the metrics for NA12878 scaffolds. We include an idealized scenario, using only reference-filtered Hi-C edges for comparison. As expected, the scaffolds generated using only true links had the highest NGA50 value and longest error-free scaffold block. SALSA2 scaffolds were more accurate and contiguous than the scaffolds generated by SALSA1 and 3D-DNA, even without use of the assembly graph. The addition of the graph further improved the NGA50 and longest error-free scaffold length.</p><p hwp:id="p-46">We also evaluated the assemblies using Feature Response Curves (FRC) based on scaffolding errors (<xref ref-type="bibr" rid="c36" hwp:id="xref-ref-40-1" hwp:rel-id="ref-40">Vezzi <italic toggle="yes">et al.</italic>, 2012</xref>). An assembly can have a high raw error count but still be of high quality if the errors are restricted to only short scaffolds. FRC captures this by showing how quickly error is accumulated, starting from the largest scaffolds. <xref ref-type="fig" rid="fig6" hwp:id="xref-fig-6-1" hwp:rel-id="F6">Figure 6</xref>(A) shows the FRC for different assemblies, where the X-axis denotes the cumulative % of assembly errors and the Y-axis denotes the cumulative assembly size. The assemblies with more area under the curve accumulate fewer errors in larger scaffolds and hence are more accurate. SALSA2 scaffolds with and without the graph have similar areas under the curve and closely match the curve of the assembly using only true links. The 3D-DNA scaffolds have the lowest area under the curve, implying that most errors in the assembly occur in the long scaffolds. This is confirmed by the lower NGA50 value for the 3D-DNA assembly (<xref ref-type="table" rid="tbl1" hwp:id="xref-table-wrap-1-2" hwp:rel-id="T1">Table 1</xref>).</p><fig id="fig7" position="float" orientation="portrait" fig-type="figure" hwp:id="F7" hwp:rev-id="xref-fig-7-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;261149v1/FIG7</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F7</object-id><object-id pub-id-type="publisher-id">fig7</object-id><label>Fig. 7.</label><caption hwp:id="caption-8"><p hwp:id="p-47">Chromosome ideogram generated using the coloredChromosomes (<xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">Böhringer et al., 2002</xref>) package. Each color switch denotes a change in the aligned sequence, either due to large structural error or the end of a unitig/scaffold. Left: input unitigs aligned to the GRCh38 reference genome. Right: SALSA2 scaffolds aligned to the GRCh38 reference genome. More than ten chromosomes are in a single scaffold. Chromosomes 1 and 7 are more fragmented due to scaffolding errors which break the alignment.</p></caption><graphic xlink:href="261149_fig7" position="float" orientation="portrait" hwp:id="graphic-10"/></fig><fig id="fig8" position="float" orientation="portrait" fig-type="figure" hwp:id="F8" hwp:rev-id="xref-fig-8-1 xref-fig-8-2 xref-fig-8-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;261149v1/FIG8</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F8</object-id><object-id pub-id-type="publisher-id">fig8</object-id><label>Fig. 8.</label><caption hwp:id="caption-9"><p hwp:id="p-48">Contiguity plot for scaffolds generated with (A) standard Arima-HiC data (B) mitotic Hi-C data and (C) Chicago data. The X-axis denotes the NGAX statistic and the Y-axis denotes the corrected block length to reach the NGAX value. SALSA2 results were generated using the assembly graph, unless otherwise noted.</p></caption><graphic xlink:href="261149_fig8" position="float" orientation="portrait" hwp:id="graphic-11"/></fig><p hwp:id="p-49">Apart from the correctness, SALSA2 scaffolds were highly contiguous and reached an NG50 of 125 Mbp (cf. GRCh38 NG50 of 145 Mbp). <xref ref-type="fig" rid="fig7" hwp:id="xref-fig-7-1" hwp:rel-id="F7">Figure 7</xref> shows the alignment ideogram for the input unitigs as well as the SALSA2 assembly. Every color change indicates an alignment break, either due to error or due to the end of a sequence. The input unitigs are fragmented with multiple unitigs aligning to the same chromosome, while the SALSA2 scaffolds are highly contiguous and span entire chromosomes in many cases. <xref ref-type="fig" rid="fig8" hwp:id="xref-fig-8-1" hwp:rel-id="F8">Figure 8</xref>(A) shows the contiguity plot with corrected NG stats. As expected, the assembly generated with only true links has the highest values for all NGA stats. The curve for SALSA2 assemblies with and without the assembly graph closely matches this curve, implying that the scaffolds generated with SALSA2 are approaching the optimal assembly of this Arima-HiC data.</p></sec><sec id="s4h" hwp:id="sec-22"><label>3.5</label><title hwp:id="title-25">Robustness to input library</title><fig id="fig9" position="float" orientation="portrait" fig-type="figure" hwp:id="F9" hwp:rev-id="xref-fig-9-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;261149v1/FIG9</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F9</object-id><object-id pub-id-type="publisher-id">fig9</object-id><label>Fig. 9.</label><caption hwp:id="caption-10"><p hwp:id="p-50">Contact map of Hi-C interactions on Chromosome 3 generated by the Juicebox software (<xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-1" hwp:rel-id="ref-8">Durand et al., 2016a</xref>). The cells sequenced in (A) normal conditions, (B) during mitosis, and (C) Dovetail Chicago</p></caption><graphic xlink:href="261149_fig9" position="float" orientation="portrait" hwp:id="graphic-12"/></fig><p hwp:id="p-51">We next tested scaffolding using two libraries with different Hi-C contact patterns. The first, from (<xref ref-type="bibr" rid="c26" hwp:id="xref-ref-29-1" hwp:rel-id="ref-29">Naumova <italic toggle="yes">et al.</italic>, 2013</xref>), is sequenced during mitosis. This removes the topological domains and generates fewer off-diagonal interactions. The second, the L1 library from (<xref ref-type="bibr" rid="c30" hwp:id="xref-ref-33-1" hwp:rel-id="ref-33">Putnam <italic toggle="yes">et al.</italic>, 2016</xref>), is an <italic toggle="yes">in vitro</italic> chromatin sequencing library (Chicago) generated by Dovetail Genomics. It also removes off-diagonal matches but has shorter-range interactions, limited by the size of the input molecules. As seen from the contact map in <xref ref-type="fig" rid="fig9" hwp:id="xref-fig-9-1" hwp:rel-id="F9">Figure 9</xref>, both the mitotic Hi-C and Chicago libraries follow different interaction distributions than the standard Hi-C (ArimaHiC in this case). We ran SALSA2 with defaults and 3D-DNA with both the assembly correction turned on and off.</p><p hwp:id="p-52">For mitotic Hi-C data, we observed that the 3D-DNA mis-assembly correction algorithm sheared the input assembly into small pieces, which resulted in more than 12,000 errors and more than half of the unitigs incorrectly oriented or ordered. Without mis-assembly correction, the 3D-DNA assembly has a higher number of orientation (345 vs. 117) and ordering (320 vs. 98) errors compared to SALSA2. The feature response curve for the 3D-DNA assembly with breaking is almost a diagonal (<xref ref-type="fig" rid="fig6" hwp:id="xref-fig-6-2" hwp:rel-id="F6">Figure 6</xref>(B)) because the sheared unitigs appeared to be randomly joined. SALSA2 scaffolds contain longer stretches of correct scaffolds compared to 3D-DNA with and without mis-assembly correction (<xref ref-type="fig" rid="fig8" hwp:id="xref-fig-8-2" hwp:rel-id="F8">Figure 8</xref>(B)).</p><p hwp:id="p-53">For the Chicago libraries, 3D-DNA mis-assembly detection once again sheared the input unitigs. It generated a single 2.7 Gbp scaffold and was unable to split it into the requested number of chromosomes. 3D-DNA uses signatures of chromosome ends (<xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-5" hwp:rel-id="ref-7">Dudchenko <italic toggle="yes">et al.</italic>, 2017</xref>) to identify break positions which are not present in Chicago data. As a result, it generated more chimeric joins compared to SALSA2 (1,550 vs. 128 errors). However, the number of order and orientation errors was similar across the methods. Even in the large single scaffold generated by 3D-DNA, the sizes of the correctly oriented and ordered blocks were smaller than SALSA2 (<xref ref-type="fig" rid="fig8" hwp:id="xref-fig-8-3" hwp:rel-id="F8">Figure 8</xref>(C)). Since Chicago libraries do not provide chromosome-spanning contact information for scaffolding, the NG50 value for SALSA is 6.15 Mbp, comparable to the equivalent coverage assembly (50% L1+L2) in (<xref ref-type="bibr" rid="c30" hwp:id="xref-ref-33-2" hwp:rel-id="ref-33">Putnam <italic toggle="yes">et al.</italic>, 2016</xref>) but much smaller than Hi-C libraries. SALSA2 is robust to changing contact distributions. In the case of Chicago data it produced a less contiguous assembly due to the shorter interaction distance. However, it avoids introducing false joins, unlike 3D-DNA, which appears tuned for a specific contact model.</p></sec><sec id="s4i" hwp:id="sec-23"><label>4</label><title hwp:id="title-26">Conclusion</title><p hwp:id="p-54">In this work, we present the first Hi-C scaffolding method that integrates an assembly graph to produce high-accuracy, chromosome-scale assemblies. Our experiments on both simulated and real sequencing data for the human genome demonstrate the benefits of using an assembly graph to guide scaffolding. We also show that SALSA2 outperforms alternative Hi-C scaffolding tools on assemblies of varied contiguity, using multiple Hi-C library preparations.</p><p hwp:id="p-55">Hi-C scaffolding has been historically prone to inversion errors when the input assembly is highly fragmented. The integration of the assembly graph with the scaffolding process can overcome this limitation. Existing Hi-C scaffolding methods also require an estimate for the number of chromosomes in the genome. Since SALSA2’s mis-join correction algorithm stops scaffolding after the useful linking information in a dataset is exhausted, no chromosome count is needed as input. As the Genome10K consortium (<xref ref-type="bibr" rid="c14" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">Koepfli <italic toggle="yes">et al.</italic>, 2015</xref>) and independent scientists begin to sequence novel lineages in the tree of life, it may be impractical to generate physical or genetics maps for every organism. Thus, Hi-C sequencing combined with SALSA2 presents an economical alternative for the reconstruction of chromosome-scale assemblies.</p></sec></sec></body><back><ack hwp:id="ack-1"><title hwp:id="title-27">Acknowledgements</title><p hwp:id="p-56">AS and SS were funded by generous support from NHGRI (grant# 1R44HG009584). JG and MP were supported by NIH grant R01-AI-100947 to MP. SK, AR, BPW, and AMP were supported by the Intramural Research Program of the National Human Genome Research Institute, National Institutes of Health. AR was also supported by a grant from the Korean Visiting Scientist Training Award (KVSTA) through the Korea Health Industry Development Institute (KHIDI), funded by the Ministry of Health &amp; Welfare, Republic of Korea (grant number: HI17C2098). This work utilized the computational resources of the NIH HPC Biowulf cluster (<ext-link l:rel="related" l:ref-type="uri" l:ref="http://hpc.nih.gov" ext-link-type="uri" xlink:href="http://hpc.nih.gov" hwp:id="ext-link-3">http://hpc.nih.gov</ext-link>).</p></ack><ref-list hwp:id="ref-list-1"><title hwp:id="title-28">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.1" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Bickhart D. M."><surname>Bickhart</surname> <given-names>D. M.</given-names></string-name> <etal>et al.</etal> (<year>2017</year>). <article-title hwp:id="article-title-2">Single-molecule sequencing and chromatin conformation capture enable de novo reference assembly of the domestic goat genome</article-title>. <source hwp:id="source-1">Nature Genetics</source>, <volume>49</volume>(<issue>4</issue>), <fpage>643</fpage>–<lpage>650</lpage>.</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="Böhringer S."><surname>Böhringer</surname> <given-names>S.</given-names></string-name> <etal>et al.</etal> (<year>2002</year>). <article-title hwp:id="article-title-3">A software package for drawing ideograms automatically</article-title>. <source hwp:id="source-2">Online J Bioinformatics</source>, <volume>1</volume>, <fpage>51</fpage>–<lpage>61</lpage>.</citation></ref><ref id="c3" hwp:id="ref-3" hwp:rev-id="xref-ref-3-1 xref-ref-3-2"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.3" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Burton J. N."><surname>Burton</surname> <given-names>J. N.</given-names></string-name> <etal>et al.</etal> (<year>2013</year>). <article-title hwp:id="article-title-4">Chromosome-scale scaffolding of de novo genome assemblies based on chromatin interactions</article-title>. <source hwp:id="source-3">Nature biotechnology</source>, <volume>31</volume>(<issue>12</issue>), <fpage>1119</fpage>–<lpage>1125</lpage>.</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1 xref-ref-4-2 xref-ref-4-3 xref-ref-4-4"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.4" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Chin C.-S."><surname>Chin</surname> <given-names>C.-S.</given-names></string-name> <etal>et al.</etal> (<year>2016</year>). <article-title hwp:id="article-title-5">Phased diploid genome assembly with single molecule real-time sequencing</article-title>. <source hwp:id="source-4">bioRxiv</source>.</citation></ref><ref id="c5" hwp:id="ref-5" hwp:rev-id="xref-ref-5-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.5" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Dixon J. R."><surname>Dixon</surname> <given-names>J. R.</given-names></string-name> <etal>et al.</etal> (<year>2012</year>). <article-title hwp:id="article-title-6">Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>. <source hwp:id="source-5">Nature</source>, <volume>485</volume>(<issue>7398</issue>), <fpage>376</fpage>–<lpage>380</lpage>.</citation></ref><ref id="c6" hwp:id="ref-6" hwp:rev-id="xref-ref-6-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.6" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Dong Y."><surname>Dong</surname> <given-names>Y.</given-names></string-name> <etal>et al.</etal> (<year>2013</year>). <article-title hwp:id="article-title-7">Sequencing and automated whole-genome optical mapping of the genome of a domestic goat (capra hircus)</article-title>. <source hwp:id="source-6">Nature biotechnology</source>, <volume>31</volume>(<issue>2</issue>), <fpage>135</fpage>–<lpage>141</lpage>.</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1 xref-ref-7-2 xref-ref-7-3 xref-ref-7-4 xref-ref-7-5"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.7" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Dudchenko O."><surname>Dudchenko</surname> <given-names>O.</given-names></string-name> <etal>et al.</etal> (<year>2017</year>). <article-title hwp:id="article-title-8">De novo assembly of the aedes aegypti genome using hi-c yields chromosome-length scaffolds</article-title>. <source hwp:id="source-7">Science</source>, <volume>356</volume>(<issue>6333</issue>), <fpage>92</fpage>–<lpage>95</lpage>.</citation></ref><ref id="c8" hwp:id="ref-8" hwp:rev-id="xref-ref-8-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Durand N. C."><surname>Durand</surname> <given-names>N. C.</given-names></string-name> <etal>et al.</etal> (<year>2016a</year>). <article-title hwp:id="article-title-9">Juicebox provides a visualization system for hi-c contact maps with unlimited zoom</article-title>. <source hwp:id="source-8">Cell systems</source>, <volume>3</volume>(<issue>1</issue>), <fpage>99</fpage>–<lpage>101</lpage>.</citation></ref><ref id="c8a" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.9" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Durand N. C."><surname>Durand</surname> <given-names>N. C.</given-names></string-name> <etal>et al.</etal> (<year>2016b</year>). <article-title hwp:id="article-title-10">Juicer provides a one-click system for analyzing loop-resolution hi-c experiments</article-title>. <source hwp:id="source-9">Cell systems</source>, <volume>3</volume>(<issue>1</issue>), <fpage>95</fpage>–<lpage>98</lpage>.</citation></ref><ref id="c8b" hwp:id="ref-10" hwp:rev-id="xref-ref-10-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="Edmonds J."><surname>Edmonds</surname> <given-names>J.</given-names></string-name> (<year>1965</year>). <article-title hwp:id="article-title-11">Paths, trees, and flowers</article-title>. <source hwp:id="source-10">Canadian Journal of mathematics</source>, <volume>17</volume>(<issue>3</issue>), <fpage>449</fpage>–<lpage>467</lpage>.</citation></ref><ref id="c9" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1 xref-ref-11-2"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.11" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="Eid J."><surname>Eid</surname> <given-names>J.</given-names></string-name> <etal>et al.</etal> (<year>2009</year>). <article-title hwp:id="article-title-12">Real-time dna sequencing from single polymerase molecules</article-title>. <source hwp:id="source-11">Science</source>, <volume>323</volume>(<issue>5910</issue>), <fpage>133</fpage>–<lpage>138</lpage>.</citation></ref><ref id="c10" hwp:id="ref-12"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.12" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Ghurye J."><surname>Ghurye</surname> <given-names>J.</given-names></string-name> <etal>et al.</etal> (<year>2017</year>). <article-title hwp:id="article-title-13">Scaffolding of long read assemblies using long range contact information</article-title>. <source hwp:id="source-12">BMC genomics</source>, <volume>18</volume>(<issue>1</issue>), <fpage>527</fpage>.</citation></ref><ref id="c11" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.13" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="Gnerre S."><surname>Gnerre</surname> <given-names>S.</given-names></string-name> <etal>et al.</etal> (<year>2011</year>). <article-title hwp:id="article-title-14">High-quality draft assemblies of mammalian genomes from massively parallel sequence data</article-title>. <source hwp:id="source-13">Proceedings of the National Academy of Sciences</source>, <volume>108</volume>(<issue>4</issue>), <fpage>1513</fpage>–<lpage>1518</lpage>.</citation></ref><ref id="c12" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.14" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Jain M."><surname>Jain</surname> <given-names>M.</given-names></string-name> <etal>et al.</etal> (<year>2016</year>). <article-title hwp:id="article-title-15">The oxford nanopore minion: delivery of nanopore sequencing to the genomics community</article-title>. <source hwp:id="source-14">Genome biology</source>, <volume>17</volume>(<issue>1</issue>), <fpage>239</fpage>.</citation></ref><ref id="c12a" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.15" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Jain M."><surname>Jain</surname> <given-names>M.</given-names></string-name> <etal>et al.</etal> (<year>2017</year>). <article-title hwp:id="article-title-16">Nanopore sequencing and assembly of a human genome with ultra-long reads</article-title>. <source hwp:id="source-15">bioRxiv</source>, page <fpage>128835</fpage>.</citation></ref><ref id="c13" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.16" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Kaplan N."><surname>Kaplan</surname> <given-names>N.</given-names></string-name> and <string-name name-style="western" hwp:sortable="Dekker J."><surname>Dekker</surname> <given-names>J.</given-names></string-name> (<year>2013</year>). <article-title hwp:id="article-title-17">High-throughput genome scaffolding from in vivo dna interaction frequency</article-title>. <source hwp:id="source-16">Nature biotechnology</source>, <volume>31</volume>(<issue>12</issue>), <fpage>1143</fpage>–<lpage>1147</lpage>.</citation></ref><ref id="c14" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.17" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="Koepfli K.-P."><surname>Koepfli</surname> <given-names>K.-P.</given-names></string-name> <etal>et al.</etal> (<year>2015</year>). <article-title hwp:id="article-title-18">The genome 10k project: a way forward</article-title>. <source hwp:id="source-17">Annu. Rev. Anim. Biosci</source>., <volume>3</volume>(<issue>1</issue>), <fpage>57</fpage>–<lpage>111</lpage>.</citation></ref><ref id="c15" hwp:id="ref-18" hwp:rev-id="xref-ref-18-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.18" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-18"><string-name name-style="western" hwp:sortable="Kolmogorov M."><surname>Kolmogorov</surname> <given-names>M.</given-names></string-name> <etal>et al.</etal> (<year>2018</year>). <article-title hwp:id="article-title-19">Assembly of long error-prone reads using repeat graphs</article-title>. <source hwp:id="source-18">bioRxiv</source>.</citation></ref><ref id="c16" hwp:id="ref-19" hwp:rev-id="xref-ref-19-1 xref-ref-19-2 xref-ref-19-3"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.19" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-19"><string-name name-style="western" hwp:sortable="Koren S."><surname>Koren</surname> <given-names>S.</given-names></string-name> <etal>et al.</etal> (<year>2017</year>). <article-title hwp:id="article-title-20">Canu: scalable and accurate long-read assembly via adaptive k-mer weighting and repeat separation</article-title>. <source hwp:id="source-19">Genome research</source>, <volume>27</volume>(<issue>5</issue>), <fpage>722</fpage>–<lpage>736</lpage>.</citation></ref><ref id="c17" hwp:id="ref-20" hwp:rev-id="xref-ref-20-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.20" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-20"><string-name name-style="western" hwp:sortable="Kurtz S."><surname>Kurtz</surname> <given-names>S.</given-names></string-name> <etal>et al.</etal> (<year>2004</year>). <article-title hwp:id="article-title-21">Versatile and open software for comparing large genomes</article-title>. <source hwp:id="source-20">Genome biology</source>, <volume>5</volume>(<issue>2</issue>), <fpage>R12</fpage>.</citation></ref><ref id="c18" hwp:id="ref-21"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.21" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-21"><string-name name-style="western" hwp:sortable="Li H."><surname>Li</surname> <given-names>H.</given-names></string-name> (<year>2016</year>). <article-title hwp:id="article-title-22">Minimap and miniasm: fast mapping and de novo assembly for noisy long sequences</article-title>. <source hwp:id="source-21">Bioinformatics</source>, <volume>32</volume>(<issue>14</issue>), <fpage>2103</fpage>–<lpage>2110</lpage>.</citation></ref><ref id="c19" hwp:id="ref-22"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.22" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-22"><string-name name-style="western" hwp:sortable="Li H."><surname>Li</surname> <given-names>H.</given-names></string-name> and <string-name name-style="western" hwp:sortable="Durbin R."><surname>Durbin</surname> <given-names>R.</given-names></string-name> (<year>2009</year>). <article-title hwp:id="article-title-23">Fast and accurate short read alignment with burrows–wheeler transform</article-title>. <source hwp:id="source-22">Bioinformatics</source>, <volume>25</volume>(<issue>14</issue>), <fpage>1754</fpage>–<lpage>1760</lpage>.</citation></ref><ref id="c20" hwp:id="ref-23" hwp:rev-id="xref-ref-23-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.23" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-23"><string-name name-style="western" hwp:sortable="Lieberman-Aiden E."><surname>Lieberman-Aiden</surname> <given-names>E.</given-names></string-name> <etal>et al.</etal> (<year>2009</year>). <article-title hwp:id="article-title-24">Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>. <source hwp:id="source-23">science</source>, <volume>326</volume>(<issue>5950</issue>), <fpage>289</fpage>–<lpage>293</lpage>.</citation></ref><ref id="c21" hwp:id="ref-24" hwp:rev-id="xref-ref-24-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.24" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-24"><string-name name-style="western" hwp:sortable="Marie-Nelly H."><surname>Marie-Nelly</surname> <given-names>H.</given-names></string-name> <etal>et al.</etal> (<year>2014</year>). <article-title hwp:id="article-title-25">High-quality genome (re) assembly using chromosomal contact data</article-title>. <source hwp:id="source-24">Nature communications</source>, <fpage>5</fpage>.</citation></ref><ref id="c22" hwp:id="ref-25" hwp:rev-id="xref-ref-25-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.25" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-25"><string-name name-style="western" hwp:sortable="Miller J. R."><surname>Miller</surname> <given-names>J. R.</given-names></string-name> <etal>et al.</etal> (<year>2010</year>). <article-title hwp:id="article-title-26">Assembly algorithms for next-generation sequencing data</article-title>. <source hwp:id="source-25">Genomics</source>, <volume>95</volume>(<issue>6</issue>), <fpage>315</fpage>–<lpage>327</lpage>.</citation></ref><ref id="c23" hwp:id="ref-26" hwp:rev-id="xref-ref-26-1 xref-ref-26-2"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.26" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-26"><string-name name-style="western" hwp:sortable="Myers E. W."><surname>Myers</surname> <given-names>E. W.</given-names></string-name> (<year>2005</year>). <article-title hwp:id="article-title-27">The fragment assembly string graph</article-title>. <source hwp:id="source-26">Bioinformatics</source>, <volume>21</volume>(suppl <issue>2</issue>), <fpage>ii79</fpage>–<lpage>ii85</lpage>.</citation></ref><ref id="c24" hwp:id="ref-27" hwp:rev-id="xref-ref-27-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.27" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-27"><string-name name-style="western" hwp:sortable="Nagarajan N."><surname>Nagarajan</surname> <given-names>N.</given-names></string-name> and <string-name name-style="western" hwp:sortable="Pop M."><surname>Pop</surname> <given-names>M.</given-names></string-name> (<year>2009</year>). <article-title hwp:id="article-title-28">Parametric complexity of sequence assembly: theory and applications to next generation sequencing</article-title>. <source hwp:id="source-27">Journal of computational biology</source>, <volume>16</volume>(<issue>7</issue>), <fpage>897</fpage>–<lpage>908</lpage>.</citation></ref><ref id="c25" hwp:id="ref-28" hwp:rev-id="xref-ref-28-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.28" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-28"><string-name name-style="western" hwp:sortable="Nagarajan N."><surname>Nagarajan</surname> <given-names>N.</given-names></string-name> and <string-name name-style="western" hwp:sortable="Pop M."><surname>Pop</surname> <given-names>M.</given-names></string-name> (<year>2013</year>). <article-title hwp:id="article-title-29">Sequence assembly demystified</article-title>. <source hwp:id="source-28">Nature Reviews Genetics</source>, <volume>14</volume>(<issue>3</issue>), <fpage>157</fpage>–<lpage>167</lpage>.</citation></ref><ref id="c26" hwp:id="ref-29" hwp:rev-id="xref-ref-29-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.29" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-29"><string-name name-style="western" hwp:sortable="Naumova N."><surname>Naumova</surname> <given-names>N.</given-names></string-name> <etal>et al.</etal> (<year>2013</year>). <article-title hwp:id="article-title-30">Organization of the mitotic chromosome</article-title>. <source hwp:id="source-29">Science</source>, <volume>342</volume>(<issue>6161</issue>), <fpage>948</fpage>–<lpage>953</lpage>.</citation></ref><ref id="c27" hwp:id="ref-30" hwp:rev-id="xref-ref-30-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.30" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-30"><string-name name-style="western" hwp:sortable="Pendleton M."><surname>Pendleton</surname> <given-names>M.</given-names></string-name> <etal>et al.</etal> (<year>2015</year>). <article-title hwp:id="article-title-31">Assembly and diploid architecture of an individual human genome via single-molecule technologies</article-title>. <source hwp:id="source-30">Nature methods</source>.</citation></ref><ref id="c28" hwp:id="ref-31" hwp:rev-id="xref-ref-31-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.31" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-31"><string-name name-style="western" hwp:sortable="Pevzner P. A."><surname>Pevzner</surname> <given-names>P. A.</given-names></string-name> <etal>et al.</etal> (<year>2001</year>). <article-title hwp:id="article-title-32">An eulerian path approach to dna fragment assembly</article-title>. <source hwp:id="source-31">Proceedings of the National Academy of Sciences</source>, <volume>98</volume>(<issue>17</issue>), <fpage>9748</fpage>–<lpage>9753</lpage>.</citation></ref><ref id="c29" hwp:id="ref-32" hwp:rev-id="xref-ref-32-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.32" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-32"><string-name name-style="western" hwp:sortable="Poloczek M."><surname>Poloczek</surname> <given-names>M.</given-names></string-name> and <string-name name-style="western" hwp:sortable="Szegedy M."><surname>Szegedy</surname> <given-names>M.</given-names></string-name> (<year>2012</year>). <article-title hwp:id="article-title-33">Randomized greedy algorithms for the maximum matching problem with new analysis. In</article-title> <source hwp:id="source-32">Foundations of Computer Science (FOCS), 2012 IEEE 53rd Annual Symposium on</source>, pages <fpage>708</fpage>–<lpage>717</lpage>. IEEE.</citation></ref><ref id="c30" hwp:id="ref-33" hwp:rev-id="xref-ref-33-1 xref-ref-33-2"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.33" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-33"><string-name name-style="western" hwp:sortable="Putnam N. H."><surname>Putnam</surname> <given-names>N. H.</given-names></string-name> <etal>et al.</etal> (<year>2016</year>). <article-title hwp:id="article-title-34">Chromosome-scale shotgun assembly using an in vitro method for long-range linkage</article-title>. <source hwp:id="source-33">Genome research</source>, <volume>26</volume>(<issue>3</issue>), <fpage>342</fpage>–<lpage>350</lpage>.</citation></ref><ref id="c31" hwp:id="ref-34" hwp:rev-id="xref-ref-34-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.34" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-34"><string-name name-style="western" hwp:sortable="Salzberg S. L."><surname>Salzberg</surname> <given-names>S. L.</given-names></string-name> <etal>et al.</etal> (<year>2012</year>). <article-title hwp:id="article-title-35">Gage: A critical evaluation of genome assemblies and assembly algorithms</article-title>. <source hwp:id="source-34">Genome research</source>, <volume>22</volume>(<issue>3</issue>), <fpage>557</fpage>–<lpage>567</lpage>.</citation></ref><ref id="c31a" hwp:id="ref-35" hwp:rev-id="xref-ref-35-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.35" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-35"><string-name name-style="western" hwp:sortable="Schneider V. A."><surname>Schneider</surname> <given-names>V. A.</given-names></string-name> <etal>et al.</etal> (<year>2017</year>). <article-title hwp:id="article-title-36">Evaluation of grch38 and de novo haploid genome assemblies demonstrates the enduring quality of the reference assembly</article-title>. <source hwp:id="source-35">Genome research</source>, <volume>27</volume>(<issue>5</issue>), <fpage>849</fpage>–<lpage>864</lpage>.</citation></ref><ref id="c32" hwp:id="ref-36" hwp:rev-id="xref-ref-36-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.36" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-36"><string-name name-style="western" hwp:sortable="Schwartz D. C."><surname>Schwartz</surname> <given-names>D. C.</given-names></string-name> <etal>et al.</etal> (<year>1993</year>). <article-title hwp:id="article-title-37">Ordered restriction maps of saccharomyces cerevisiae chromosomes constructed by optical mapping</article-title>. <source hwp:id="source-36">Science</source>, <volume>262</volume>(<issue>5130</issue>), <fpage>110</fpage>–<lpage>114</lpage>.</citation></ref><ref id="c33" hwp:id="ref-37"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.37" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-37"><string-name name-style="western" hwp:sortable="Selton J. M."><surname>Selton</surname> <given-names>J. M.</given-names></string-name> <etal>et al.</etal> (<year>2015</year>). <article-title hwp:id="article-title-38">Tools and pipelines for bionano data: molecule assembly pipeline and fasta super scaffolding tool</article-title>. <source hwp:id="source-37">BMC genomics</source>, <volume>16</volume>(<issue>1</issue>), <fpage>734</fpage>.</citation></ref><ref id="c34" hwp:id="ref-38" hwp:rev-id="xref-ref-38-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.38" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-38"><string-name name-style="western" hwp:sortable="Simonis M."><surname>Simonis</surname> <given-names>M.</given-names></string-name> <etal>et al.</etal> (<year>2006</year>). <article-title hwp:id="article-title-39">Nuclear organization of active and inactive chromatin domains uncovered by chromosome conformation capture– on-chip (4c)</article-title>. <source hwp:id="source-38">Nature genetics</source>, <volume>38</volume>(<issue>11</issue>), <fpage>1348</fpage>–<lpage>1354</lpage>.</citation></ref><ref id="c35" hwp:id="ref-39" hwp:rev-id="xref-ref-39-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.39" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-39"><string-name name-style="western" hwp:sortable="Venter J. C."><surname>Venter</surname> <given-names>J. C.</given-names></string-name> <etal>et al.</etal> (<year>1996</year>). <article-title hwp:id="article-title-40">A new strategy for genome sequencing</article-title>. <source hwp:id="source-39">Nature</source>, <volume>381</volume>(<issue>6581</issue>), <fpage>364</fpage>.</citation></ref><ref id="c36" hwp:id="ref-40" hwp:rev-id="xref-ref-40-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.40" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-40"><string-name name-style="western" hwp:sortable="Vezzi F."><surname>Vezzi</surname> <given-names>F.</given-names></string-name> <etal>et al.</etal> (<year>2012</year>). <article-title hwp:id="article-title-41">Feature-by-feature–evaluating de novo sequence assembly</article-title>. <source hwp:id="source-40">PloS one</source>, <volume>7</volume>(<issue>2</issue>), <fpage>e31002</fpage>.</citation></ref><ref id="c37" hwp:id="ref-41" hwp:rev-id="xref-ref-41-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.41" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-41"><string-name name-style="western" hwp:sortable="Weisenfeld N. I."><surname>Weisenfeld</surname> <given-names>N. I.</given-names></string-name> <etal>et al.</etal> (<year>2017</year>). <article-title hwp:id="article-title-42">Direct determination of diploid genome sequences</article-title>. <source hwp:id="source-41">Genome research</source>, <volume>27</volume>(<issue>5</issue>), <fpage>757</fpage>–<lpage>767</lpage>.</citation></ref><ref id="c38" hwp:id="ref-42" hwp:rev-id="xref-ref-42-1"><citation publication-type="other" citation-type="journal" ref:id="261149v1.42" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-42"><string-name name-style="western" hwp:sortable="Wysoker A."><surname>Wysoker</surname> <given-names>A.</given-names></string-name> <etal>et al.</etal> (<year>2013</year>). <article-title hwp:id="article-title-43">Picard tools version 1.90</article-title>.</citation></ref><ref id="c39" hwp:id="ref-43" hwp:rev-id="xref-ref-43-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.43" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-43"><string-name name-style="western" hwp:sortable="Yeo S."><surname>Yeo</surname> <given-names>S.</given-names></string-name> <etal>et al.</etal> (<year>2017</year>). <article-title hwp:id="article-title-44">Arcs: Scaffolding genome drafts with linked reads</article-title>. <source hwp:id="source-42">Bioinformatics</source>.</citation></ref><ref id="c40" hwp:id="ref-44" hwp:rev-id="xref-ref-44-1"><citation publication-type="journal" citation-type="journal" ref:id="261149v1.44" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-44"><string-name name-style="western" hwp:sortable="Zheng G. X."><surname>Zheng</surname> <given-names>G. X.</given-names></string-name> <etal>et al.</etal> (<year>2016</year>). <article-title hwp:id="article-title-45">Haplotyping germline and cancer genomes with high-throughput linked-read sequencing</article-title>. <source hwp:id="source-43">Nature biotechnology</source>.</citation></ref></ref-list></back></article>
