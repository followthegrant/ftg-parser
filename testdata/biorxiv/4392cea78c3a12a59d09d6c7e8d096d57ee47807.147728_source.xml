<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/147728</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;147728v3</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;147728</article-id><article-id pub-id-type="other" hwp:sub-type="slug">147728</article-id><article-id pub-id-type="other" hwp:sub-type="tag">147728</article-id><article-version>1.3</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Ecology" hwp:journal="biorxiv"><subject>Ecology</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">The cavity method for community ecology</article-title></title-group><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><name name-style="western" hwp:sortable="Barbier Matthieu"><surname>Barbier</surname><given-names>Matthieu</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-2"><name name-style="western" hwp:sortable="Arnoldi Jean-François"><surname>Arnoldi</surname><given-names>Jean-François</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">1</xref></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2"><label>1</label><institution hwp:id="institution-1">Centre for Biodiversity Theory and Modelling, Theoretical and Experimental Ecology Station, CNRS and Paul Sabatier University</institution>, 09200 Moulis, <country>France</country>.</aff></contrib-group><pub-date pub-type="epub-original" hwp:start="2017"><year>2017</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2017-06-08T09:35:49-07:00">
    <day>8</day><month>6</month><year>2017</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2017-06-23T14:33:02-07:00">
    <day>23</day><month>6</month><year>2017</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2017-06-08T09:40:42-07:00">
    <day>8</day><month>6</month><year>2017</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2017-06-23T14:40:55-07:00">
    <day>23</day><month>6</month><year>2017</year>
  </pub-date><elocation-id>147728</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2017-06-08"><day>08</day><month>6</month><year>2017</year></date>
<date date-type="rev-recd" hwp:start="2017-06-23"><day>23</day><month>6</month><year>2017</year></date>
<date date-type="accepted" hwp:start="2017-06-23"><day>23</day><month>6</month><year>2017</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2017</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" hwp:id="license-1"><p hwp:id="p-1">This pre-print is available under a Creative Commons License (Attribution-NonCommercial 4.0 International), CC BY-NC 4.0, as described at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://creativecommons.org/licenses/by-nc/4.0/" ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" hwp:id="ext-link-1">http://creativecommons.org/licenses/by-nc/4.0/</ext-link></p></license></permissions><self-uri xlink:href="147728.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2019/pdf/147728v3.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="147728.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2019/abstracts/147728v3/147728v3.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2019/fulltext/147728v3/147728v3.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><p hwp:id="p-2">This article is addressed to researchers and students in theoretical ecology, as an introduction to “disordered systems” approaches from statistical physics, and how they can help understand large ecological communities. We discuss the relevance of these approaches, and how they fit within the broader landscape of models in community ecology. We focus on a remarkably simple technique, the cavity method, which allows to derive the equilibrium properties of Lotka-Volterra systems. We present its predictions, the new intuitions it suggests, and its technical underpinnings. We also discuss a number of new results concerning possible extensions, including different functional responses and community structures.</p></abstract><counts><page-count count="59"/></counts><custom-meta-wrap>
    <custom-meta hwp:id="custom-meta-1">
      <meta-name>has-earlier-version</meta-name>
      <meta-value>yes</meta-value>
    </custom-meta>
  </custom-meta-wrap></article-meta></front><body><sec id="s1" hwp:id="sec-1"><label>1</label><title hwp:id="title-2">Context</title><sec id="s1a" hwp:id="sec-2"><label>1.1</label><title hwp:id="title-3">Disordered systems</title><p hwp:id="p-3">Many foundational insights of ecological theory were derived from the careful study of simplified patterns of interaction between a few distinct entities (individuals or species). Examples include trophic chains [<xref ref-type="bibr" rid="c20" hwp:id="xref-ref-20-1" hwp:rel-id="ref-20">20</xref>], competition and exclusion over a few resources [<xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-1" hwp:rel-id="ref-21">21</xref>, <xref ref-type="bibr" rid="c39" hwp:id="xref-ref-39-1" hwp:rel-id="ref-39">39</xref>], mutualism [<xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">13</xref>] and parasite-host in-teractions [<xref ref-type="bibr" rid="c25" hwp:id="xref-ref-25-1" hwp:rel-id="ref-25">25</xref>]. These archetypal structures can be used as modules [<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">15</xref>, <xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-1" hwp:rel-id="ref-5">5</xref>] to understand more complex systems, when this complexity does not interfere with their order and structure. For instance, our intuitions on multitrophic commu-nities combine simple trophic mechanisms to understand inter-guild relations, and simple competitive mechanisms for intra-guild dynamics. Many theories also distinguish between ecosystems shaped by top-down control from preda-tors, and those shaped by bottom-up control from resources. In all cases, these intuitions can only work if these interaction structures remain distinct even in a complex community.</p><p hwp:id="p-4">In parallel, neutral models [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">16</xref>] have shown that many quantitative predic-tions can be made with minimal assumptions of structure, or even of distinctive-ness of the entities. In most such works, the only accounting for an ecosystem’s diversity is its number of otherwise identical species. These theories belong to the <italic toggle="yes">mean-field</italic> class, meaning that intrinsic differences between entities are erased statistically, owing to large numbers and some form of stochasticity. More precisely, such differences lose their importance in the collective dynamics – and therefore also in individual species’ dynamics, provided that those are mostly shaped by collective factors (e.g. aggregate competition from many other species).</p><p hwp:id="p-5"><italic toggle="yes">Disordered systems</italic> stand between these extremes, in that they exhibit heterogeneity without order: they represent situations where one cannot neglect the existence of differences between species, but no clear-cut structural patterns can be identified. As in neutral theories, it is either impossible or unnecessary to assign clear “roles” to individual species. But instead of being modelled as identical, all species appear to be completely heterogeneous in their biological features and interactions, without regular motifs. What we can know is the range and frequency of these traits in the community as a whole, and we investigate how much can be predicted about an ecosystem from that limited knowledge. While the notion of disordered system originates in physics<xref ref-type="fn" rid="fn1" hwp:id="xref-fn-1-1" hwp:rel-id="fn-1"><sup>1</sup></xref>, perhaps the simplest analogy is found in models of neural networks [<xref ref-type="bibr" rid="c27" hwp:id="xref-ref-27-1" hwp:rel-id="ref-27">27</xref>]. Each neuron has a distinct set of interactions, but it is difficult to identify the role of any given neuron, or group them into functional classes; mainly, we can access summary statistics of “how different” neurons and their interactions are in a given network.</p><p hwp:id="p-6">This approach shares a conceptual starting point with Random Matrix The-ory, which has long become a staple of theoretical ecology [<xref ref-type="bibr" rid="c24" hwp:id="xref-ref-24-1" hwp:rel-id="ref-24">24</xref>, <xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">1</xref>]. In both cases, one considers a “simple sort of complexity”: in large disordered communities, most details cease to matter and a few general mechanisms emerge, allowing us to unify many superficially different systems and models. However, Random Matrix Theory has developed with a specific focus on stability, whereas disordered systems techniques give access to properties – functioning, coexistence, abundance distributions, trait selection – which are usually predicted using neutral or structured models. In fact, many ecological models already fall into this category, especially numerical models that contain many species with uncertain attributes (lacking empirical or mechanistic constraints) such as large random Lotka-Volterra communities. What has perhaps not been sufficiently realized is the availability of mathematical techniques for making broader and more robust statements about such systems, thus helping guide, validate or even bypass heavy simulation work. It is only recently that these techniques and ideas have been brought to bear on ecological problems [<xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">12</xref>, <xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-1" hwp:rel-id="ref-18">18</xref>, <xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-1" hwp:rel-id="ref-6">6</xref>, <xref ref-type="bibr" rid="c37" hwp:id="xref-ref-37-1" hwp:rel-id="ref-37">37</xref>, <xref ref-type="bibr" rid="c38" hwp:id="xref-ref-38-1" hwp:rel-id="ref-38">38</xref>].</p><p hwp:id="p-7">Of particular interest is the application of this framework to <italic toggle="yes">ecosystem assembly,</italic> i.e. how dynamics and interactions shape the realized community from a pool of potential invaders. Indeed, it is easier to imagine that the pool itself is disordered: it may consist of species immigrating from a number of different environments, with independent evolutionary histories. By contrast, the assembled state that emerges from that pool will be less random. By following the process of assembly from that pool, it is possible to see which properties are selected by the ecological dynamics, i.e. how traits in the assembled community differ from those in the pool. Multiple works have thus explored what shapes species coexistence and invadability, in the context of assembly from a fixed regional pool [<xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-2" hwp:rel-id="ref-6">6</xref>], from immigration and stochastic extinction in an island biogeography perspective [<xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-2" hwp:rel-id="ref-18">18</xref>], or from two consumer communities “coalescing” – starting to compete on the same resources [<xref ref-type="bibr" rid="c37" hwp:id="xref-ref-37-2" hwp:rel-id="ref-37">37</xref>]. These methods have proven apt at generalizing to many species what was previously understood for modules of a few heterogeneous species, e.g. the conditions of competitive coexistence [<xref ref-type="bibr" rid="c38" hwp:id="xref-ref-38-2" hwp:rel-id="ref-38">38</xref>].</p></sec><sec id="s1b" hwp:id="sec-3"><label>1.2</label><title hwp:id="title-4">Models of ecological dynamics</title><sec id="s1b1" hwp:id="sec-4" hwp:rev-id="xref-sec-4-1"><label>1.2.1</label><title hwp:id="title-5">The disordered systems framework</title><p hwp:id="p-8">Practically speaking, the notion of disordered systems, and the fact that it allows for a simple and generic analytical approach, comes with significant methodological potential: it connects a class of commonly used models in ecology, synthesizing their insights and explaining why and when they may give similar or different predictions. We illustrate this in another work [<xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-1" hwp:rel-id="ref-3">3</xref>] with a “model meta-analysis” demonstrating that a variety of community structures, including mutualistic networks and resource competition, can still fall within the realm of disordered systems and create assembly patterns that we can predict with this framework.</p><p hwp:id="p-9">This also means that if there were reasons to outright reject our results as a valid representation of ecological reality, then an entire class of models would become disqualified at once, as well as many qualitative arguments based on certain notions of complexity. That would be a useful result for ecological theory, limiting the field of investigation in models and simulations.</p><p hwp:id="p-10">More concretely, to help situate this framework among preexisting work in theoretical ecology, we show in <xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Fig. 1</xref> a bird’s eye view of the main types of dynamical models we identified in the field. They roughly fall between three extremes. First, fully independent populations, where we use physiological and behavioral traits to predict existence and functioning within a given environment. Second, fully dependent (i.e. very strongly interacting) populations where, for instance, the coexistence of competitors requires precise tradeoffs between their traits. Third, fully stochastic models, where the characteristics of species and their interactions are all blurred and dominated by noise coming from internal (demographic) or external (environmental) sources. On this graph, our position is represented by the orange dot, a regime of collective organization where interactions are individually weak but collectively strong.
<fig id="fig1" position="float" orientation="portrait" fig-type="figure" hwp:id="F1" hwp:rev-id="xref-fig-1-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;147728v3/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Figure 1:</label><caption hwp:id="caption-1"><p hwp:id="p-11">An abstract representation of the main classes of dynamical models in theoretical ecology, and the regime of collective organization where the notions and methods developed here are meant to apply.</p></caption><graphic xlink:href="147728_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig></p><p hwp:id="p-12">The two main axes of opposition on this graph are the following. First, deterministic versus stochastic: in deterministic approaches such as ours, we generally expect that real ecosystem properties can be understood from the equilibrium or near-equilibrium properties of a given dynamical model, controlled by some combination of intrinsic species fitness and by their interactions. The opposite pole includes theories that are dominated by stochastic and transient dynamics, where “noise” – in the demographics, the environment, or the immigration process – prevents the system from ever being close to some deterministic assembled equilibrium<xref ref-type="fn" rid="fn2" hwp:id="xref-fn-2-1" hwp:rel-id="fn-2"><sup>2</sup></xref>. Those include neutral theories [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-2" hwp:rel-id="ref-16">16</xref>] and island biogeography and its variants [<xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-1" hwp:rel-id="ref-22">22</xref>, <xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">11</xref>, <xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-3" hwp:rel-id="ref-18">18</xref>]. These two viewpoints are complementary; only careful confrontation to empirical data can decide whether an ecosystem’s dynamics are governed by transient, far-from equilibrium dynamics such as neutral turnover, or by the sort of near-equilibrium features described here.</p><p hwp:id="p-13">The second axis of opposition confronts models whose dynamics are dominated by species characteristics, and those that are determined by interactions. Independent populations illustrate the former, competitive exclusion the latter. In these two extremes, results are often very sensitive to model assumptions: for instance, the colonization-competition tradeoff model ensures global coexistence by requiring a very precise ordering of competitive and dispersive ability. It may be surprising to see that the middle-ground – collective organization, where interactions are individually weak but collectively strong (because distributed among many species) – gives rise to very generic and predictable patterns.</p><p hwp:id="p-14">This is the class of systems that we can describe with this framework. Note however that it could, fairly easily, be extended to include noise; by contrast, systems where species are strongly influenced by other individual species tend to have very dramatic dynamics (e.g. predator-prey cycles) which typically preclude the existence of any non-trivial equilibrium. Such dynamics are not entirely beyond the reach of disordered system approaches, but will almost certainly require more involved techniques than the simple one presented here.</p></sec><sec id="s1b2" hwp:id="sec-5"><label>1.2.2</label><title hwp:id="title-6">Example: History dependence</title><p hwp:id="p-15">Importantly, each class of models makes different predictions for the mechanisms of various ecological phenomena. We can illustrate it in the case of history-dependence (e.g. founder effects). In a deterministic equilibrium viewpoint, the long-term state of a system is dependent on its history only if its dynamics allow for multiple attractors. Of course, even with a single global attractor (e.g. a single final, stable and uninvadable community), if the time to reach it is very long, the system may retain some memory of its previous states at visible timescales. But this memory should become fainter as time passes, and any shock should only reset the dynamics to some earlier stage along a similar trajectory. This perspective is compatible with the intuitive notion of maturity<xref ref-type="fn" rid="fn3" hwp:id="xref-fn-3-1" hwp:rel-id="fn-3"><sup>3</sup></xref> as found e.g. in Margalef [<xref ref-type="bibr" rid="c23" hwp:id="xref-ref-23-1" hwp:rel-id="ref-23">23</xref>].</p><p hwp:id="p-16">By contrast, in a stochastic perspective, any composition is to some degree an accident, though it may hold for a long time if there are positive feedbacks (e.g. self-reinforcing density dependence) that transform an early advantage into a long-lasting one. Nevertheless, the composition may well undergo a dramatic shift, due to a shock or even out of steady noise, without it signalling any change in intrinsic species fitness. This is closer to the usual intuition behind the founder effect.</p></sec></sec></sec><sec id="s2" hwp:id="sec-6" hwp:rev-id="xref-sec-6-1 xref-sec-6-2 xref-sec-6-3"><label>2</label><title hwp:id="title-7">General framework</title><sec id="s2a" hwp:id="sec-7"><label>2.1</label><title hwp:id="title-8">The assembly process</title><p hwp:id="p-17">Here is the central conceit of this theory of assembly: we define a pool of species that can invade the community, and whose dynamical traits, such as growth rates and interactions, are known only statistically. We then allow sequences of invasions until the community reaches an uninvadable state, and investigate the properties of this “assembled” state – among others, species diversity, abundance, and how traits selected by the dynamics differ from the pool baseline.</p><p hwp:id="p-18">This can represent a variety of physical settings: the pool could be a entire region and the community a local patch [<xref ref-type="bibr" rid="c31" hwp:id="xref-ref-31-1" hwp:rel-id="ref-31">31</xref>], they could be a mainland and an island connected by migration fluxes [<xref ref-type="bibr" rid="c22" hwp:id="xref-ref-22-2" hwp:rel-id="ref-22">22</xref>, <xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-2" hwp:rel-id="ref-11">11</xref>, <xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-4" hwp:rel-id="ref-18">18</xref>], or even oceanic water and the microbiome of an individual sponge [<xref ref-type="bibr" rid="c36" hwp:id="xref-ref-36-1" hwp:rel-id="ref-36">36</xref>]. More generally, this suggests a stable reservoir of biodiversity with some known aggregate properties, and an environment that is being populated from that reservoir, even if the reservoir is not larger (e.g. a forest serving as a biodiversity shelter for surrounding plains), provided that it can serve as a stable supply of potential invaders for the timescales considered.</p><p hwp:id="p-19">But this can also represent, more abstractly, a “separation of concerns” between, for example, physiology and ecology. Properties of the pool reflect the traits of species “in potential”; by contrast, the assembled community retains only the subset of traits that are dynamically selected to survive together. Thus, in an abstract model, the pool could represent the range of species that are allowed to exist by physiological constraints, while assembly would single out combinations of such species that can coexist in the same ecosystem. Even in the spatial interpretation suggested before, there is such a separation of concerns: species-species interactions are properties of the pool, but species-environment interactions (e.g. carrying capacities) could be specific to a location, leading to different assembled states in different locales.</p><p hwp:id="p-20">This means that the size of the pool, <italic toggle="yes">S</italic>, admits very different interpretations depending on the ecological scenario represented: <italic toggle="yes">S</italic> could be regional diversity or mainland diversity, if one is interested in invasion through immigration, but it could also represent the mutant strains that try to invade a microbial community over a given timescale (the pool being disordered would then reflect an assumption of random mutations). Carefully teasing apart these various interpretations and the hypotheses they hide is one of our purposes in this article.</p></sec><sec id="s2b" hwp:id="sec-8"><label>2.2</label><title hwp:id="title-9">The assembled state</title><sec id="s2b1" hwp:id="sec-9"><label>2.2.1</label><title hwp:id="title-10">Equilibrium relations</title><p hwp:id="p-21">Within this general setting, we decide to look only at the final assembled state, i.e. a feasible, stable and uninvadable community. As discussed in <xref ref-type="sec" rid="s1b1" hwp:id="xref-sec-4-1" hwp:rel-id="sec-4">Sec. 1.2.1</xref>, this stands in stark contrast with theories that are dominated by stochastic and transient dynamics.</p><p hwp:id="p-22">The mathematical techniques of disordered systems can be applied to many different dynamics. For convenience, we investigate the very commonly used Lotka-Volterra dynamics<xref ref-type="fn" rid="fn4" hwp:id="xref-fn-4-1" hwp:rel-id="fn-4"><sup>4</sup></xref>:
<disp-formula id="eqn1" hwp:id="disp-formula-1" hwp:rev-id="xref-disp-formula-1-1 xref-disp-formula-1-2"><alternatives hwp:id="alternatives-1"><graphic xlink:href="147728_eqn1.gif" position="float" orientation="portrait" hwp:id="graphic-2"/></alternatives></disp-formula></p><p hwp:id="p-23">Here <italic toggle="yes">A<sub>ij</sub></italic> is the interaction between species <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> (i.e. the rate at which a unit of species <italic toggle="yes">i</italic> affects a unit of species <italic toggle="yes">j</italic> dynamically). <italic toggle="yes">R<sub>i</sub></italic> is the growth rate of species <italic toggle="yes">i</italic>, that combines growth on external resources and mortality (and could thus be negative). <italic toggle="yes">D<sub>i</sub></italic> is intra-species competition, hereafter <italic toggle="yes">self-interaction.</italic> We can define
<disp-formula id="eqn2" hwp:id="disp-formula-2"><alternatives hwp:id="alternatives-2"><graphic xlink:href="147728_eqn2.gif" position="float" orientation="portrait" hwp:id="graphic-3"/></alternatives></disp-formula>
where <italic toggle="yes">K<sub>i</sub></italic> is properly the carrying capacity of species <italic toggle="yes">i</italic> in the case of consumers with <italic toggle="yes">R<sub>i</sub></italic> &gt; 0. If <italic toggle="yes">R<sub>i</sub></italic> &lt; 0, then <italic toggle="yes">K<sub>i</sub></italic> is negative and cannot be interpreted as a carrying capacity, but remains an important mathematical quantity (a measure of density-dependent mortality).</p><p hwp:id="p-24">We will concern ourselves only with the equilibrium solutions, meaning <italic toggle="yes">dN<sub>i</sub>/dt</italic> = 0 and
<disp-formula id="eqn3" hwp:id="disp-formula-3" hwp:rev-id="xref-disp-formula-3-1 xref-disp-formula-3-2 xref-disp-formula-3-3 xref-disp-formula-3-4 xref-disp-formula-3-5 xref-disp-formula-3-6"><alternatives hwp:id="alternatives-3"><graphic xlink:href="147728_eqn3.gif" position="float" orientation="portrait" hwp:id="graphic-4"/></alternatives></disp-formula></p><p hwp:id="p-25">Only the species for which a positive solution <italic toggle="yes">N<sub>i</sub> &gt;</italic> 0 exists will then survive together in an assembled state. This state is obtained after long immigration sequence, during which all species that could invade did. As we explain below in <xref ref-type="sec" rid="s3c" hwp:id="xref-sec-15-1" hwp:rel-id="sec-15">Sec. 3.3</xref>, in a certain region of parameters, the precise sequence of invasions is irrelevant to the final state, which is a global attractor of the dynamics.</p></sec><sec id="s2b2" hwp:id="sec-10"><label>2.2.2</label><title hwp:id="title-11">Control parameters</title><p hwp:id="p-26"><bold>Important: To simplify the exposition, we assume starting now that all the self-interaction terms are equal</bold> <italic toggle="yes">D<sub>i</sub></italic> = 〈<italic toggle="yes">D</italic>〉 = 1, <bold>so that</bold> <italic toggle="yes">K<sub>i</sub></italic> = <italic toggle="yes">R<sub>i</sub>.</italic> <bold>This assumption is relaxed and the consequences of heterogeneous</bold> <italic toggle="yes">D<sub>i</sub></italic> <bold>are discussed starting in <xref ref-type="sec" rid="s4" hwp:id="xref-sec-18-1" hwp:rel-id="sec-18">Sec. 4</xref>.</bold></p><p hwp:id="p-27">We will proceed to show that, to predict many properties of the assembled state, it is sufficient to know four simple statistical features of the pool of potential invaders. First, we need a measure of intrinsic fitness differences between species; for this we take <italic toggle="yes">ζ</italic> the standard deviation of the growth rates <italic toggle="yes">R<sub>i</sub>.</italic> Second, we need to characterize interactions at a collective level. We thus ask how much a species is affected by the <italic toggle="yes">sum</italic> of all its interactions: how adverse this total interaction is on average, represented by a parameter <italic toggle="yes">μ</italic> (<italic toggle="yes">μ &gt;</italic> 0 means that biomass is on average lost through interactions, <italic toggle="yes">μ &lt;</italic> 0 means it is gained), and how much that varies from species to species, represented by a parameter <italic toggle="yes">σ.</italic> Hence, for any species, the total effect of interactions can be understood to fall roughly in the range <italic toggle="yes">μ</italic> ± <italic toggle="yes">σ.</italic> Finally, to understand feedbacks between species, we need to know how similar the effect of species <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> is to the reciprocal effect of <italic toggle="yes">j</italic> on <italic toggle="yes">i</italic>, and we encapsulate this in a parameter <italic toggle="yes">γ.</italic></p><p hwp:id="p-28">Formally, these parameters are defined as follows:
<disp-formula id="eqn4" hwp:id="disp-formula-4" hwp:rev-id="xref-disp-formula-4-1 xref-disp-formula-4-2"><alternatives hwp:id="alternatives-4"><graphic xlink:href="147728_eqn4.gif" position="float" orientation="portrait" hwp:id="graphic-5"/></alternatives></disp-formula>
where <italic toggle="yes">s</italic> = <italic toggle="yes">Sc</italic> is the average number of interaction partners for each species (<italic toggle="yes">c</italic> being the connectivity of the interaction network). This factor <italic toggle="yes">s</italic> means that <italic toggle="yes">μ</italic> and <italic toggle="yes">σ</italic><sup>2</sup> indeed represent the <italic toggle="yes">total</italic> interaction strength and variance faced by one species from all its partners. Given our definition of <italic toggle="yes">γ</italic>, it takes values in the range [−1, 1]: <italic toggle="yes">γ</italic> = 1 means that two partners affect each other identically, while <italic toggle="yes">γ</italic> = −1 means that reciprocal effects are maximally different, see <xref ref-type="sec" rid="s4b2" hwp:id="xref-sec-25-1" hwp:rel-id="sec-25">Sec. 4.2.2</xref>. Examples from competitive and trophic communities are given in the next section.</p><p hwp:id="p-29">These parameters suggest how disordered systems differ from both mean-field and structured systems. The various species traits retain a non-negligible heterogeneity, encapsulated by <italic toggle="yes">ζ</italic> and <italic toggle="yes">σ.</italic> Yet, little more information is needed than those simple metrics, which give a basic estimate of “how different” species can be. The precise interpretation of these abstract parameters will become clearer, first from seeing what role they play in model results, and later in more in-depth discussion.</p><p hwp:id="p-30">All higher-order correlations, that capture more precise structural information about the pool, are neglected. If more order is needed (e.g. for trophic systems, given that trophic roles are an essential feature that is not represented here), one could consistently push the formalism further, incorporating more and more structural properties in the form of correlations<xref ref-type="fn" rid="fn5" hwp:id="xref-fn-5-1" hwp:rel-id="fn-5"><sup>5</sup></xref>.</p></sec><sec id="s2b3" hwp:id="sec-11" hwp:rev-id="xref-sec-11-1 xref-sec-11-2"><label>2.2.3</label><title hwp:id="title-12">The special case of competitive communities</title><p hwp:id="p-31">Note that in competitive communities, where species have carrying capacities <italic toggle="yes">K<sub>i</sub> &gt;</italic> 0 which can follow a wide distribution (e.g. lognormal), it is often difficult to generate communities where many species coexist if interactions <italic toggle="yes">A<sub>ij</sub></italic> are drawn arbitrarily. It has been found that a particualr scaling of interactions does allow for species coexistence: they must scale with the ratios of carrying capacities, more precisely
<disp-formula id="eqn5" hwp:id="disp-formula-5" hwp:rev-id="xref-disp-formula-5-1"><alternatives hwp:id="alternatives-5"><graphic xlink:href="147728_eqn5.gif" position="float" orientation="portrait" hwp:id="graphic-6"/></alternatives></disp-formula>
where <italic toggle="yes">B<sub>ij</sub></italic> has a narrower distribution (e.g. normal) [<xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">17</xref>, <xref ref-type="bibr" rid="c26" hwp:id="xref-ref-26-1" hwp:rel-id="ref-26">26</xref>]. In this case, we can divide the equilibrium condition <xref ref-type="disp-formula" rid="eqn3" hwp:id="xref-disp-formula-3-1" hwp:rel-id="disp-formula-3">(3)</xref> by <italic toggle="yes">R<sub>i</sub></italic> to get
<disp-formula id="eqn6" hwp:id="disp-formula-6"><alternatives hwp:id="alternatives-6"><graphic xlink:href="147728_eqn6.gif" position="float" orientation="portrait" hwp:id="graphic-7"/></alternatives></disp-formula></p><p hwp:id="p-32">In other words, all the calculations and results presented here apply to this particular competitive setting by replacing the <italic toggle="yes">N<sub>i</sub></italic> with the effective variables <italic toggle="yes">η<sub>i</sub></italic>, the real interactions <italic toggle="yes">A<sub>ij</sub></italic> by their “core” <italic toggle="yes">B<sub>ij</sub></italic>, and setting <italic toggle="yes">R<sub>i</sub></italic> = <italic toggle="yes">D<sub>i</sub></italic> = 1.</p><p hwp:id="p-33">Our framework in fact gives a very clear mathematical explanation for how the scaling s<xref ref-type="disp-formula" rid="eqn5" hwp:id="xref-disp-formula-5-1" hwp:rel-id="disp-formula-5">(5)</xref> allows for coexistence: imagine instead that we had started from the Lotka-Volterra equations rewritten as
<disp-formula hwp:id="disp-formula-7"><alternatives hwp:id="alternatives-7"><graphic xlink:href="147728_ueqn1.gif" position="float" orientation="portrait" hwp:id="graphic-8"/></alternatives></disp-formula>
with some randomly drawn <italic toggle="yes">Ã<sub>ij</sub></italic>, then the equilibrium condition would be
<disp-formula id="eqn7" hwp:id="disp-formula-8"><alternatives hwp:id="alternatives-8"><graphic xlink:href="147728_eqn7.gif" position="float" orientation="portrait" hwp:id="graphic-9"/></alternatives></disp-formula>
for the effective variables <italic toggle="yes">η<sub>i</sub></italic> = <italic toggle="yes">N<sub>i</sub>/K<sub>i</sub></italic>. The effective interactions <italic toggle="yes">B<sub>ij</sub></italic> = <italic toggle="yes">Ã<sub>ij</sub>K<sub>j</sub></italic> could be very widely distributed, since <italic toggle="yes">K<sub>j</sub></italic> themselves are drawn from some wide (e.g. lognormal) distribution. This would correspond to a large value of interaction heterogeneity <italic toggle="yes">σ</italic>, which we show below has a very negative effect on coexistence. We give precise conditions on the statistics of <italic toggle="yes">B<sub>ij</sub></italic> which allow to generate communities of given diversity.</p></sec></sec></sec><sec id="s3" hwp:id="sec-12"><label>3</label><title hwp:id="title-13">What can we predict?</title><p hwp:id="p-34">While the following sections discuss the methods that we will use to solve the equations above, this one gives an overview of some of the main system properties that can be computed in this framework. These results fall roughly in four categories of important ecological properties: functioning, diversity, stability, and features selected by the assembly process.</p><p hwp:id="p-35">We present these results in the abstract parameter space defined in <xref ref-type="disp-formula" rid="eqn4" hwp:id="xref-disp-formula-4-1" hwp:rel-id="disp-formula-4">(4)</xref>. The interpretation of the parameters comes in <xref ref-type="sec" rid="s4" hwp:id="xref-sec-18-2" hwp:rel-id="sec-18">Sec. 4</xref>. Importantly, the results that we show are exact for the region of parameters where there exists a single, globally stable, uninvadable final assembled state. However, most results hold approximately past the boundary of this region, and we later discuss in <xref ref-type="sec" rid="s4a" hwp:id="xref-sec-19-1" hwp:rel-id="sec-19">Sec. 4.1</xref> when systems are likely to be found in this region. The complex region that lays beyond is still being investigated.</p><sec id="s3a" hwp:id="sec-13"><label>3.1</label><title hwp:id="title-14">Functioning</title><p hwp:id="p-36">For functioning, we can for instance compute the total biomass
<disp-formula id="eqn8" hwp:id="disp-formula-9"><alternatives hwp:id="alternatives-9"><graphic xlink:href="147728_eqn8.gif" position="float" orientation="portrait" hwp:id="graphic-10"/></alternatives></disp-formula>
and total productivity or growth from external resources
<disp-formula id="eqn9" hwp:id="disp-formula-10"><alternatives hwp:id="alternatives-10"><graphic xlink:href="147728_eqn9.gif" position="float" orientation="portrait" hwp:id="graphic-11"/></alternatives></disp-formula>
with the Heaviside function Θ(<italic toggle="yes">x</italic>) = 1 if <italic toggle="yes">x &gt;</italic> 0, Θ(<italic toggle="yes">x</italic>) = 0 otherwise. In fact, since <italic toggle="yes">G<sub>tot</sub></italic> scales with the total biomass, it is more practical to look at the productivity ratio <italic toggle="yes">G<sub>tot</sub></italic>/<italic toggle="yes">N<sub>tot</sub></italic>, which increases when faster-growing species are favored.</p><p hwp:id="p-37">Note that throughout, we make no difference between biomass and abundance, as we are not considering individual mass as a particular species trait. Our choice is equivalent to assuming that biomass has no systematic correlation with either interactions or carrying capacities in the pool of potential invaders, so that converting total abundance to total biomass only requires multiplying by the average individual’s mass in the community. However the framework could easily be extended to account for individual mass as a trait controlling other dynamical properties (e.g. via metabolic scaling).</p><p hwp:id="p-38">In addition, let us recall here that, as suggested in <xref ref-type="sec" rid="s2b3" hwp:id="xref-sec-11-1" hwp:rel-id="sec-11">Sec. 2.2.3</xref>, the calculations made here can be extended to competitive communities with wide distributions of carrying capacity <italic toggle="yes">K<sub>i</sub></italic>, but all our predictions for <italic toggle="yes">N<sub>i</sub></italic> will instead be about the rescaled abundances <italic toggle="yes">N<sub>i</sub>/K<sub>i</sub></italic>. Hence, for instance, predictions of 〈<italic toggle="yes">N</italic>〉 <italic toggle="yes">&gt;</italic> 1 will signal overyielding. Since these discussion points are specific to competitive communities and we strive to be as general as possible, we will leave the analysis of all these consequences to future work.</p></sec><sec id="s3b" hwp:id="sec-14"><label>3.2</label><title hwp:id="title-15">Diversity and coexistence</title><p hwp:id="p-39">For diversity we will consider two main metrics. The first is the number of species surviving in the assembled state <italic toggle="yes">S*</italic> = <italic toggle="yes">Sø</italic>, see <xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-1" hwp:rel-id="F2">Fig. 2</xref>. As one would expect, coexistence decreases with increasing <italic toggle="yes">σ</italic> and <italic toggle="yes">ζ</italic>, since more variance in growth rates and interactions entails that some species are more likely to be overall stronger competitors than some others. Interestingly, as we discuss below, decreasing <italic toggle="yes">γ</italic> tends to increase coexistence. The second is Simpson’s index, which gives a measure of biomass concentration,
<disp-formula id="eqn10" hwp:id="disp-formula-11"><alternatives hwp:id="alternatives-11"><graphic xlink:href="147728_eqn10.gif" position="float" orientation="portrait" hwp:id="graphic-12"/></alternatives></disp-formula>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure" hwp:id="F2" hwp:rev-id="xref-fig-2-1 xref-fig-2-2 xref-fig-2-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;147728v3/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Figure 2:</label><caption hwp:id="caption-2"><p hwp:id="p-40">Coexistence, abundance and stability properties in the space (<italic toggle="yes">μ, σ</italic>) for <italic toggle="yes">γ</italic> = 1, 0, −1 (top to bottom) and <italic toggle="yes">ζ</italic> = 0. Since all species have the same growth rate, the productivity/biomass ratio is always constant here. The uniform area in the left of each graph signals the parameter region where some interactions are mutualistic enough that abundances diverge, see <xref ref-type="fig" rid="fig4" hwp:id="xref-fig-4-1" hwp:rel-id="F4">Fig. 4</xref> below. As is apparent here, when <italic toggle="yes">ζ</italic> = 0, the average coupling strength <italic toggle="yes">μ</italic> only affects the total biomass <italic toggle="yes">N<sub>tot</sub>,</italic> while all other panels show purely vertical gradients, i.e. they only depend on <italic toggle="yes">σ</italic> (and <italic toggle="yes">γ</italic>). Results for <italic toggle="yes">ζ</italic> = 0.3 are shown below in <xref ref-type="fig" rid="fig5" hwp:id="xref-fig-5-1" hwp:rel-id="F5">Fig 5</xref>.</p></caption><graphic xlink:href="147728_fig2" position="float" orientation="portrait" hwp:id="graphic-13"/></fig></p><p hwp:id="p-41">Its inverse, Simpson diversity <italic toggle="yes">D</italic>, tells us how effectively diverse the community is, in terms of the biomass being equitably distributed among all species. The index is related to the second moment of the abundance distribution. In fact, the full distribution can be computed within this framework, with some caveats discussed in <xref ref-type="sec" rid="s5" hwp:id="xref-sec-27-1" hwp:rel-id="sec-27">Sec. 5</xref>.</p></sec><sec id="s3c" hwp:id="sec-15" hwp:rev-id="xref-sec-15-1 xref-sec-15-2 xref-sec-15-3 xref-sec-15-4"><label>3.3</label><title hwp:id="title-16">Stability</title><p hwp:id="p-42">We discuss three aspects of stability: the existence of multiple equilibria, variability around an equilibrium under stochastic perturbations, and the consequences of permanent community shifts – be they due to environmental changes or species extinction. All three can be shown to be related via simple expressions to pool parameters and to the fraction of surviving species <italic toggle="yes">ϕ</italic>.</p><p hwp:id="p-43">First, we can find an expression for <italic toggle="yes">invariability</italic> as defined in [<xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">2</xref>], i.e. the inverse of the response of the system to demographic noise.
<disp-formula id="eqn11" hwp:id="disp-formula-12"><alternatives hwp:id="alternatives-12"><graphic xlink:href="147728_eqn11.gif" position="float" orientation="portrait" hwp:id="graphic-14"/></alternatives></disp-formula></p><p hwp:id="p-44">It can formally be related to the response to other types of noise, and is also the basis for deriving a prediction for Taylor’s law.</p><p hwp:id="p-45">Second, we can derive the number of secondary extinctions resulting from the extinction of one species in the system. In a disordered system, secondary extinctions are more or less numerous depending on parameters, but never make up a significant fraction of the community, due to species abundances being controlled by the community as a whole rather than by individual partners.</p><p hwp:id="p-46">The final important result is <italic toggle="yes">χ</italic> the order parameter for multistability. Let us imagine that we perturb all the carrying capacities
<disp-formula id="eqn12" hwp:id="disp-formula-13"><alternatives hwp:id="alternatives-13"><graphic xlink:href="147728_eqn12.gif" position="float" orientation="portrait" hwp:id="graphic-15"/></alternatives></disp-formula>
with a perturbation that is on average 〈<italic toggle="yes">ξ<sub>i</sub></italic>〉 = 0, representing a small change in the environment that leads to different species being favored, without making the environment overall better or worse for the community. Then we can ask how much the abundances of the species are changed in response,
<disp-formula id="eqn13" hwp:id="disp-formula-14"><alternatives hwp:id="alternatives-14"><graphic xlink:href="147728_eqn13.gif" position="float" orientation="portrait" hwp:id="graphic-16"/></alternatives></disp-formula>
and this change (with zero mean) is characterized by its variance, which we compute in <xref ref-type="sec" rid="s5f" hwp:id="xref-sec-35-1" hwp:rel-id="sec-35">Sec. 5.6</xref> below:
<disp-formula id="eqn14" hwp:id="disp-formula-15" hwp:rev-id="xref-disp-formula-15-1"><alternatives hwp:id="alternatives-15"><graphic xlink:href="147728_eqn14.gif" position="float" orientation="portrait" hwp:id="graphic-17"/></alternatives></disp-formula>
where <italic toggle="yes">u</italic> = 1 − <italic toggle="yes">μ</italic>/<italic toggle="yes">s</italic>. This expression reflects the deep relationship between coexistence <italic toggle="yes">ϕ</italic> and sensitivity to the environment <italic toggle="yes">χ.</italic></p><p hwp:id="p-47">The divergence of <italic toggle="yes">χ</italic><sup>2</sup> when the denominator of <xref ref-type="disp-formula" rid="eqn14" hwp:id="xref-disp-formula-15-1" hwp:rel-id="disp-formula-15">(14)</xref> vanishes, i.e. when
<disp-formula id="eqn15" hwp:id="disp-formula-16" hwp:rev-id="xref-disp-formula-16-1 xref-disp-formula-16-2"><alternatives hwp:id="alternatives-16"><graphic xlink:href="147728_eqn15.gif" position="float" orientation="portrait" hwp:id="graphic-18"/></alternatives></disp-formula>
signals the boundary of the region where multiple equilibria exist: precisely at the boundary, an infinitesimal change in intrinsic fitness can lead to different species being present in the final assembled state. Of course, while the quantity formally diverges, the community’s response is not truly infinitely steep – it only signals that the approximations we use to compute the single globally attractive equilibrium break down. Indeed, as one gets close to the divergence, <italic toggle="yes">χ</italic> stops predicting the simulated response to a press perturbation, which plateaus as shown in <xref ref-type="fig" rid="fig3" hwp:id="xref-fig-3-1" hwp:rel-id="F3">Fig. 3</xref>.
<fig id="fig3" position="float" orientation="portrait" fig-type="figure" hwp:id="F3" hwp:rev-id="xref-fig-3-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;147728v3/FIG3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F3</object-id><object-id pub-id-type="publisher-id">fig3</object-id><label>Figure 3:</label><caption hwp:id="caption-3"><p hwp:id="p-48">Average effect of a random perturbation of carrying capacities, calculated as <italic toggle="yes">χ</italic> (solid line) or directly from the assembled community in simulations (dots), depending on coupling heterogeneity <italic toggle="yes">σ.</italic> Left: <italic toggle="yes">γ</italic> = 1, with divergence of <italic toggle="yes">χ</italic> at finite <italic toggle="yes">σ,</italic> revealing the loss of stability of the single global attractor and the start of the multistable phase. Right: <italic toggle="yes">γ</italic> = −1, no divergence (no multistable phase).</p></caption><graphic xlink:href="147728_fig3" position="float" orientation="portrait" hwp:id="graphic-19"/></fig></p><p hwp:id="p-49">Hence, it is possible to construct the <italic toggle="yes">phase diagram</italic> shown in <xref ref-type="fig" rid="fig4" hwp:id="xref-fig-4-2" hwp:rel-id="F4">Fig. 4</xref>, which indicates where in parameter space one will find a single, multiple or no equilibria. As we discuss more below, lowering <italic toggle="yes">γ</italic> has a stabilizing effect, as it extends the single equilibrium phase – in fact, it is apparent from <xref ref-type="disp-formula" rid="eqn15" hwp:id="xref-disp-formula-16-1" hwp:rel-id="disp-formula-16">(15)</xref> above that, in the limit <italic toggle="yes">γ</italic> = −1, the threshold to the multiple equilibria phase becomes infinite, and there can only be one attractor which is globally stable.
<fig id="fig4" position="float" orientation="portrait" fig-type="figure" hwp:id="F4" hwp:rev-id="xref-fig-4-1 xref-fig-4-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;147728v3/FIG4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F4</object-id><object-id pub-id-type="publisher-id">fig4</object-id><label>Figure 4:</label><caption hwp:id="caption-4"><p hwp:id="p-50">Phase diagram in the (<italic toggle="yes">μ</italic>, <italic toggle="yes">σ</italic>) plane for various <italic toggle="yes">γ</italic> and <italic toggle="yes">ζ</italic> = 0, based on phase parameter <italic toggle="yes">χ</italic><sup>2</sup> from <xref ref-type="sec" rid="s3c" hwp:id="xref-sec-15-2" hwp:rel-id="sec-15">Sec. 3.3</xref>. There are three regions depending on parameters. In the first region, there is a single global attractor, meaning that – after a long enough sequence of invasions and extinctions – a given community will reach a single uninvadable state, no matter what sequence it went through. In the second region however (up of the dashed line, signalling a divergence of <italic toggle="yes">χ</italic><sup>2</sup>), there are multiple such attractors, and the final assembled state depends on the history of the system. As <italic toggle="yes">γ</italic> → −1, the transition to the second region disappears. Finally, the third region (left of the solid line, signaling a Rdivergence of 〈<italic toggle="yes">N</italic>〉) has no attractor, as some species have mutualistic interactions that are stronger than any negative feedback and their abundances grow to infinity. This signals a breakdown of the Lotka-Volterra approximation for more realistic dynamics.</p></caption><graphic xlink:href="147728_fig4" position="float" orientation="portrait" hwp:id="graphic-20"/></fig></p></sec><sec id="s3d" hwp:id="sec-16"><label>3.4</label><title hwp:id="title-17">Selected features</title><p hwp:id="p-51">Previous work [<xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-3" hwp:rel-id="ref-6">6</xref>] has shown that it is possible to use this framework to infer not only the distributions of abundances, growth rates and interactions in the assembled state, but also correlations between those, including the frequency of various small network motifs [<xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-2" hwp:rel-id="ref-15">15</xref>]. How these distributions differ from the pool baseline tells us how non-random properties have been selected from a random pool. This gives us worthwhile information on which factors are likely to enable a species to survive into the assembled state, or conversely, how ecosystems may adapt to ensure coexistence. We demonstrate this idea in this article with the selection of carrying capacities or growth rates, but see the Appendices in [<xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-4" hwp:rel-id="ref-6">6</xref>] for details on the selection of interaction patterns.</p></sec><sec id="s3e" hwp:id="sec-17"><label>3.5</label><title hwp:id="title-18">Discussion</title><p hwp:id="p-52">Most striking is the role of <italic toggle="yes">γ</italic> the reciprocity of interactions: as <italic toggle="yes">γ</italic> becomes negative, sensitivity to perturbations decreases, the single attractor region expands and coexistence increases. This suggests that asymmetrical interactions – including commensalism, amensalism and trophic interactions – lead to easier assembly than symmetrical ones, echoing the conclusions of other authors [<xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-2" hwp:rel-id="ref-1">1</xref>] who noted “remarkable differences between predator-prey interactions, which increase stability, and mutualistic and competitive, which are destabilizing”. Yet, we can also show that <italic toggle="yes">γ &lt;</italic> 0 may very well be achieved by competitive interactions. It is in fact possible to construct trophic and competitive com-munities so that the latter have more negative <italic toggle="yes">γ</italic> than the former. Hence, this statement should not be taken as generally valid, and the meaning of <italic toggle="yes">γ</italic> should be discussed much more carefully, as we do in <xref ref-type="sec" rid="s4b2" hwp:id="xref-sec-25-2" hwp:rel-id="sec-25">Sec. 4.2.2</xref>.</p><p hwp:id="p-53">In the single attractor region, many different ecological scenarios become indistinguishable as long as one is only interested in the eventual assembled state. Whether invaders from the pool come from migrations or mutations, frequent or rare, correlated or not with the species dominating the community at any given time, interspersed with extinctions and recoveries or not – these distinctions become irrelevant in the long run, as any dynamical trajectory that does not involve irreversible changes in the pool of potential invaders (e.g. a permanent extinction) will end at the same point.</p><p hwp:id="p-54">If we look at a pool that lies on the boundary between the two regions, multiple attractors first emerge as small deviations from the single attractor that existed below that boundary - most species remain, and only a few rare ones distinguish the multiple attractors by their absence or presence. Therefore, even though the results presented in this work focus on the single attractor region, where our analytical results hold exactly, we will demonstrate multiple times that our framework still provides good approximations some distance into the multiple attractor region. When our framework ceases to be predictive altogether, it is likely that the various attractors are different enough that perturbations may engender significant regime shifts.</p><p hwp:id="p-55">If <italic toggle="yes">ζ</italic> ≠ 0, the model predictions seen on <xref ref-type="fig" rid="fig5" hwp:id="xref-fig-5-2" hwp:rel-id="F5">Fig. 5</xref> are still quite similar to those shown in <xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-2" hwp:rel-id="F2">Fig. 2</xref> for <italic toggle="yes">ζ</italic> = 0, except for the fact that average coupling <italic toggle="yes">μ</italic> plays a much more important role: instead of controlling only the average biomass 〈<italic toggle="yes">N</italic>〉, it affects all the metrics, favoring the existence of a global attractor while reducing coexistence.
<fig id="fig5" position="float" orientation="portrait" fig-type="figure" hwp:id="F5" hwp:rev-id="xref-fig-5-1 xref-fig-5-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;147728v3/FIG5</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F5</object-id><object-id pub-id-type="publisher-id">fig5</object-id><label>Figure 5:</label><caption hwp:id="caption-5"><p hwp:id="p-56">Coexistence, abundance and stability properties in the space (<italic toggle="yes">μ</italic>, <italic toggle="yes">σ</italic>) for <italic toggle="yes">γ</italic> = 1, 0, −1 (top to bottom) and <italic toggle="yes">ζ</italic> = 0.3. See <xref ref-type="fig" rid="fig2" hwp:id="xref-fig-2-3" hwp:rel-id="F2">Fig. 2</xref> for results at <italic toggle="yes">ζ</italic> = 0.</p></caption><graphic xlink:href="147728_fig5" position="float" orientation="portrait" hwp:id="graphic-21"/></fig></p></sec></sec><sec id="s4" hwp:id="sec-18" hwp:rev-id="xref-sec-18-1 xref-sec-18-2 xref-sec-18-3"><label>4</label><title hwp:id="title-19">Mathematical setting</title><p hwp:id="p-57">This section is meant to be an qualitative explanation of the mathematical concepts that are crucial for a better understanding of the methods and results shown in this paper. <xref ref-type="sec" rid="s5" hwp:id="xref-sec-27-2" hwp:rel-id="sec-27">Sec. 5</xref> below gives a detailed explanation of the derivation, of interest to the more mathematically-inclined reader.</p><p hwp:id="p-58">We recall that the central equation we investigate is <xref ref-type="disp-formula" rid="eqn3" hwp:id="xref-disp-formula-3-2" hwp:rel-id="disp-formula-3">(3)</xref> which defines the equilibrium for Lotka-Volterra dynamics:
<disp-formula hwp:id="disp-formula-17"><alternatives hwp:id="alternatives-17"><graphic xlink:href="147728_ueqn2.gif" position="float" orientation="portrait" hwp:id="graphic-22"/></alternatives></disp-formula></p><p hwp:id="p-59">Before solving this equation, we show that it is possible to better isolate the role of the various parameters, thanks to two simple tricks of rescaling. First, it is easily seen in <xref ref-type="disp-formula" rid="eqn1" hwp:id="xref-disp-formula-1-1" hwp:rel-id="disp-formula-1">(1)</xref> that <italic toggle="yes">R<sub>i</sub></italic>, <italic toggle="yes">D<sub>i</sub></italic> and <italic toggle="yes">A<sub>ij</sub></italic> could all be multiplied by the same number, without changing the dynamics (only making them globally faster or slower). Hence we can arbitrarily choose the time scale so that, for instance, growth rates have unit mean:
<disp-formula id="eqn16" hwp:id="disp-formula-18"><alternatives hwp:id="alternatives-18"><graphic xlink:href="147728_eqn16.gif" position="float" orientation="portrait" hwp:id="graphic-23"/></alternatives></disp-formula></p><p hwp:id="p-60">Now, we can look more specifically at equilibria, i.e. <xref ref-type="disp-formula" rid="eqn3" hwp:id="xref-disp-formula-3-3" hwp:rel-id="disp-formula-3">equation (3)</xref>. Clearly, we could multiply all <italic toggle="yes">D<sub>i</sub></italic> and <italic toggle="yes">A<sub>ij</sub></italic> by some number, and divide all <italic toggle="yes">N<sub>i</sub></italic> and <italic toggle="yes">N<sub>j</sub></italic> by the same number, without changing the equilibrium: the average intensity of interactions, inter- and intra-species, simply changes the average abundance at equilibrium. Hence we can also arbitrarily take
<disp-formula id="eqn17" hwp:id="disp-formula-19"><alternatives hwp:id="alternatives-19"><graphic xlink:href="147728_eqn17.gif" position="float" orientation="portrait" hwp:id="graphic-24"/></alternatives></disp-formula>
so that now, interactions <italic toggle="yes">A<sub>ij</sub></italic> are measured in units of the average self-interaction, and abundances are measured in units of “carrying capacity” – indeed, if it were alone with positive growth rate, the average equilibrium abundance of the species would be around 1 (or equal to 1 if <italic toggle="yes">D<sub>i</sub></italic> = 1). Neither of these choices subtract anything from the generality of the equations. An important consequence is that any change of the absolute value of growth rates or interactions, for instance via nutrient enrichment, will affect only the total amount of biomass and no other property of the assembled state.</p><p hwp:id="p-61">The second trick is using the fact that interactions can always be rewritten as
<disp-formula id="eqn18" hwp:id="disp-formula-20"><alternatives hwp:id="alternatives-20"><graphic xlink:href="147728_eqn18.gif" position="float" orientation="portrait" hwp:id="graphic-25"/></alternatives></disp-formula>
with two parameters: the average interaction <italic toggle="yes">A</italic> = 〈<italic toggle="yes">A<sub>ij</sub></italic>〉 and the variance of interactions <inline-formula hwp:id="inline-formula-1"><alternatives hwp:id="alternatives-21"><inline-graphic xlink:href="147728_inline1.gif" hwp:id="inline-graphic-1"/></alternatives></inline-formula>, so that the rescaled interactions <italic toggle="yes">a<sub>ij</sub></italic> have zero mean and unit variance
<disp-formula id="eqn19" hwp:id="disp-formula-21"><alternatives hwp:id="alternatives-22"><graphic xlink:href="147728_eqn19.gif" position="float" orientation="portrait" hwp:id="graphic-26"/></alternatives></disp-formula></p><p hwp:id="p-62">For now, we make no further assumption on what the distribution of the <italic toggle="yes">A<sub>ij</sub></italic> and <italic toggle="yes">a<sub>ij</sub></italic> may be, beyond the fact that it has a well-defined mean and variance. We simply suggest that is important to know both how intense interactions are on average, i.e. <italic toggle="yes">A</italic>, and how much they differ between pairs of species, <italic toggle="yes">σ<sub>A</sub></italic>.</p><p hwp:id="p-63">Hence, we transform <xref ref-type="disp-formula" rid="eqn3" hwp:id="xref-disp-formula-3-4" hwp:rel-id="disp-formula-3">(3)</xref> into the following equation
<disp-formula id="eqn20" hwp:id="disp-formula-22"><alternatives hwp:id="alternatives-23"><graphic xlink:href="147728_eqn20.gif" position="float" orientation="portrait" hwp:id="graphic-27"/></alternatives></disp-formula>
and using
<disp-formula id="eqn21" hwp:id="disp-formula-23"><alternatives hwp:id="alternatives-24"><graphic xlink:href="147728_eqn21.gif" position="float" orientation="portrait" hwp:id="graphic-28"/></alternatives></disp-formula>
we finally get
<disp-formula id="eqn22" hwp:id="disp-formula-24" hwp:rev-id="xref-disp-formula-24-1 xref-disp-formula-24-2"><alternatives hwp:id="alternatives-25"><graphic xlink:href="147728_eqn22.gif" position="float" orientation="portrait" hwp:id="graphic-29"/></alternatives></disp-formula></p><p hwp:id="p-64">The first term is an effective growth rate including the overall biomass loss due to competition (<italic toggle="yes">A &gt;</italic> 0) or gain due to mutualism (<italic toggle="yes">A &lt;</italic> 0). The second term contains the effective intra-species competition, and the third the relative gain or loss of fitness of species <italic toggle="yes">i</italic> due to the <italic toggle="yes">heterogeneity</italic> of inter-species interactions. Multiple insights already arise from this simple reformulation, without even solving the equation, and we discuss them now.</p><sec id="s4a" hwp:id="sec-19" hwp:rev-id="xref-sec-19-1"><label>4.1</label><title hwp:id="title-20">Scaling of interactions: when are large disordered com-munities not neutral?</title><sec id="s4a1" hwp:id="sec-20"><label>4.1.1</label><title hwp:id="title-21">Inter-species versus intra-species effects</title><p hwp:id="p-65">It is well-known that intra-species competition plays a large role in stabilizing the dynamics: interactions with other species become important only if they are not negligible compared to this self-interaction. Strongly interacting communities can exhibit complex dynamics with multiple equilibria, limit cycles or other attractors. If interactions with others are negligible, each species simply follows its own logistic equation, and the system is sure to evolve toward a globally attractive equilibrium.</p><p hwp:id="p-66">The <xref ref-type="disp-formula" rid="eqn22" hwp:id="xref-disp-formula-24-1" hwp:rel-id="disp-formula-24">equation (22)</xref> above shows that – beyond a simple translation of every species’ growth rate – the effective importance of interactions compared to self-interaction is controlled by the ratio
<disp-formula id="eqn23" hwp:id="disp-formula-25"><alternatives hwp:id="alternatives-26"><graphic xlink:href="147728_eqn23.gif" position="float" orientation="portrait" hwp:id="graphic-30"/></alternatives></disp-formula></p><p hwp:id="p-67">This gives a clear intuition of why species heterogeneity, as encapsulated by <italic toggle="yes">σ<sub>A</sub></italic>, can be important in the dynamics. If species are too similar, <italic toggle="yes">σ<sub>A</sub></italic> <bold><italic toggle="yes">→</italic></bold> 0, then the abundances <italic toggle="yes">N<sub>i</sub></italic> decouple from each other: species are only coupled collectively through the average value 〈<italic toggle="yes">N</italic>〉 in the effective growth rate, except in the very special case of the Hubbell point <italic toggle="yes">D<sub>i</sub></italic> = <italic toggle="yes">A</italic> where all inter- and intra-specific interactions are equal [<xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-3" hwp:rel-id="ref-16">16</xref>, <xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-5" hwp:rel-id="ref-18">18</xref>]. Away from that singular point, we see that what truly destabilizes the system is not only how <italic toggle="yes">intense</italic> interactions are, i.e. <italic toggle="yes">A</italic> at the denominator, but also how <italic toggle="yes">diverse</italic> they are, i.e. <italic toggle="yes">σ<sub>A</sub></italic> at the numerator.</p></sec><sec id="s4a2" hwp:id="sec-21"><label>4.1.2</label><title hwp:id="title-22">Comparing communities of different sizes and connectivities</title><p hwp:id="p-68">A second central insight comes from asking: what does it mean to say that two pools with different sizes <italic toggle="yes">S</italic> have the <italic toggle="yes">same amount</italic> of heterogeneity? Let us assume that each species is connected to <italic toggle="yes">s<sub>i</sub></italic> other species in the interaction matrix, on average
<disp-formula id="eqn24" hwp:id="disp-formula-26"><alternatives hwp:id="alternatives-27"><graphic xlink:href="147728_eqn24.gif" position="float" orientation="portrait" hwp:id="graphic-31"/></alternatives></disp-formula>
with <italic toggle="yes">c</italic> ∊ [0, <xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-3" hwp:rel-id="ref-1">1</xref>] the connectivity of the network. If <italic toggle="yes">s</italic> is the same in the two pools<xref ref-type="fn" rid="fn6" hwp:id="xref-fn-6-1" hwp:rel-id="fn-6"><sup>6</sup></xref>, then species from either pool have the same average number of interactions. In that case, it makes sense to directly compare the properties of these interactions, i.e. the values of <italic toggle="yes">A</italic> and <italic toggle="yes">σ<sub>A</sub></italic>, to decide which pool has stronger or more diverse interactions.</p><p hwp:id="p-69">However, let us assume that <italic toggle="yes">c</italic> is the same for both pools, e.g. <italic toggle="yes">c</italic> = 1. In that case, the dynamical influence on one species from all the others will be proportional to the quantity
<disp-formula id="eqn25" hwp:id="disp-formula-27"><alternatives hwp:id="alternatives-28"><graphic xlink:href="147728_eqn25.gif" position="float" orientation="portrait" hwp:id="graphic-32"/></alternatives></disp-formula></p><p hwp:id="p-70">(this gives a general trend; of course, the precise dynamical effect will depend on species abundances). This quantity is on average
<disp-formula id="eqn26" hwp:id="disp-formula-28"><alternatives hwp:id="alternatives-29"><graphic xlink:href="147728_eqn26.gif" position="float" orientation="portrait" hwp:id="graphic-33"/></alternatives></disp-formula>
which increases with the size of the community. This term is seen in <xref ref-type="disp-formula" rid="eqn22" hwp:id="xref-disp-formula-24-2" hwp:rel-id="disp-formula-24">(22)</xref> to intervene in the effective growth rate. As for how much <inline-formula hwp:id="inline-formula-2"><alternatives hwp:id="alternatives-30"><inline-graphic xlink:href="147728_inline1a.gif" hwp:id="inline-graphic-2"/></alternatives></inline-formula> varies between species, that comes from the sum
<disp-formula id="eqn27" hwp:id="disp-formula-29" hwp:rev-id="xref-disp-formula-29-1"><alternatives hwp:id="alternatives-31"><graphic xlink:href="147728_eqn27.gif" position="float" orientation="portrait" hwp:id="graphic-34"/></alternatives></disp-formula></p><p hwp:id="p-71">By assumption, this sum is an unbiased random walk of mean 0 and typical step size 1; hence, after <italic toggle="yes">s</italic> steps (with <italic toggle="yes">s</italic> large enough), no matter the distribution of <italic toggle="yes">a<sub>ij</sub></italic>, the random walk will typically have gone a distance of order <inline-formula hwp:id="inline-formula-3"><alternatives hwp:id="alternatives-32"><inline-graphic xlink:href="147728_inline2.gif" hwp:id="inline-graphic-3"/></alternatives></inline-formula> toward either positive or negative values. There are two important assumptions here: one of large numbers, which can only be checked numerically (in fact, we can often find good agreement even for <italic toggle="yes">s</italic> ~ 10), and one of randomness which is discussed more carefully in <xref ref-type="sec" rid="s5" hwp:id="xref-sec-27-3" hwp:rel-id="sec-27">Sec. 5</xref>. If one accepts these assumptions for now, the final interaction strength perceived by any species falls roughly in the range
<disp-formula id="eqn28" hwp:id="disp-formula-30" hwp:rev-id="xref-disp-formula-30-1"><alternatives hwp:id="alternatives-33"><graphic xlink:href="147728_eqn28.gif" position="float" orientation="portrait" hwp:id="graphic-35"/></alternatives></disp-formula></p><p hwp:id="p-72">This is a crucial point: if we consider different systems with the same values of <italic toggle="yes">A</italic> and <italic toggle="yes">σ<sub>A</sub></italic>, but different values of <italic toggle="yes">S</italic> or <italic toggle="yes">c,</italic> then we can see from <xref ref-type="disp-formula" rid="eqn28" hwp:id="xref-disp-formula-30-1" hwp:rel-id="disp-formula-30">(28)</xref> that, the larger and more connected the pool, the smaller the relative variation in <inline-formula hwp:id="inline-formula-4"><alternatives hwp:id="alternatives-34"><inline-graphic xlink:href="147728_inline1b.gif" hwp:id="inline-graphic-4"/></alternatives></inline-formula> compared to its mean. In fact, for very large communities, there will be practically no difference in the interaction strength perceived by different species, making them <italic toggle="yes">mean-field</italic> (all species are effectively identical from the point of view of interactions) rather than disordered.</p><p hwp:id="p-73">Instead, two pools of different size <italic toggle="yes">S</italic> have “equal” interaction strength and heterogeneity if their pools exhibit the same values of
<disp-formula id="eqn29" hwp:id="disp-formula-31"><alternatives hwp:id="alternatives-35"><graphic xlink:href="147728_eqn29.gif" position="float" orientation="portrait" hwp:id="graphic-36"/></alternatives></disp-formula>
rather than the same values of <italic toggle="yes">A</italic> and <italic toggle="yes">σ<sub>A</sub></italic>. To understand this, we can see that, no matter the pool size or connectivity, a species’ total interaction with others is given by
<disp-formula id="eqn30" hwp:id="disp-formula-32"><alternatives hwp:id="alternatives-36"><graphic xlink:href="147728_eqn30.gif" position="float" orientation="portrait" hwp:id="graphic-37"/></alternatives></disp-formula></p><p hwp:id="p-74">We can indeed show that <italic toggle="yes">μ</italic> and <italic toggle="yes">σ</italic> (in addition to a few other parameters) are what controls the properties of the assembled state – systems with different <italic toggle="yes">S</italic> but the same <italic toggle="yes">μ</italic> and <italic toggle="yes">σ</italic> will obey the same trends in terms of diversity, stability, abundance distribution, and so on. This rescaling means that systems with more connections between species (i.e. larger <italic toggle="yes">S</italic> or larger <italic toggle="yes">c</italic>) must have proportionally more varied interactions to retain the same <italic toggle="yes">σ</italic>, so that heterogeneity still matters and is not “averaged out”.</p></sec><sec id="s4a3" hwp:id="sec-22"><label>4.1.3</label><title hwp:id="title-23">Tradeoffs and global stability in large systems</title><p hwp:id="p-75">We now further investigate this inverse perspective: instead of asking how <italic toggle="yes">community parameters μ</italic> and <italic toggle="yes">σ</italic> change with diversity <italic toggle="yes">S</italic> if we keep the same distribution of <italic toggle="yes">individual parameters A<sub>ij</sub></italic>, we ask how these <italic toggle="yes">A<sub>ij</sub></italic> should change with <italic toggle="yes">S</italic> to achieve a given <italic toggle="yes">μ</italic> and <italic toggle="yes">σ.</italic> This simple question actually contains an important insight on the properties of large assembled communities. It is easy to see that if one wants to fix connectivity <italic toggle="yes">c</italic> as well as <italic toggle="yes">μ</italic> and <italic toggle="yes">σ</italic>, but increase <italic toggle="yes">S</italic>, then necessarily interactions should vary like
<disp-formula id="eqn31" hwp:id="disp-formula-33"><alternatives hwp:id="alternatives-37"><graphic xlink:href="147728_eqn31.gif" position="float" orientation="portrait" hwp:id="graphic-38"/></alternatives></disp-formula></p><p hwp:id="p-76">For large enough systems <italic toggle="yes">S</italic> ≫ 1, if we maintain the same values of <italic toggle="yes">μ</italic> and <italic toggle="yes">σ</italic>, we thus expect <italic toggle="yes">σ<sub>A</sub></italic> ≫ 〈<italic toggle="yes">A<sub>ij</sub></italic>〉. Having a standard deviation much larger than the mean is not achievable with “reasonable” distributions<xref ref-type="fn" rid="fn7" hwp:id="xref-fn-7-1" hwp:rel-id="fn-7"><sup>7</sup></xref> unless we allow the interactions to take any sign (the mean can thus go to zero while the variance remains large).</p><p hwp:id="p-77">Hence, due to simple mathematical constraints, large systems must have at least one of these four properties: large <italic toggle="yes">μ</italic>, small <italic toggle="yes">σ</italic>, low connectivity <italic toggle="yes">c</italic>, or mixed interactions allowing for all signs. For instance, a large competitive community where all species can potentially interact (<italic toggle="yes">c</italic> = 1) must have either large <italic toggle="yes">μ</italic>, meaning very strong competition and low biomass, or small <italic toggle="yes">σ</italic>, meaning that heterogeneities in species interactions cease to matter and the system is effectively mean-field. This “biomass–heterogeneity” tradeoff in large competitive communities, which we emphasize comes from simple algebra independent of any model, is indeed very apparent in our analysis of resource consumer models in [<xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">4</xref>].</p><p hwp:id="p-78">This tradeoff has important consequences: as shown in recent work [<xref ref-type="bibr" rid="c40" hwp:id="xref-ref-40-1" hwp:rel-id="ref-40">40</xref>], small <italic toggle="yes">σ</italic> is a condition under which a complex ecosystem might be reduced to a single dimension, leading to predictions of “universal” behavior [<xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">9</xref>]. Further-more, small <italic toggle="yes">σ</italic> and small <italic toggle="yes">ζ</italic> taken together constitute the basic hypothesis of neutral theory – that we can take all species as identical in large communities, despite their very real heterogeneities. Hence, the fact that simple algebraic constraints could limit <italic toggle="yes">σ</italic> in large competitive communities provides some formal grounding for the intuitions behind “universal” and neutral dynamics.</p></sec></sec><sec id="s4b" hwp:id="sec-23"><label>4.2</label><title hwp:id="title-24">Couplings rather than interactions</title><sec id="s4b1" hwp:id="sec-24" hwp:rev-id="xref-sec-24-1"><label>4.2.1</label><title hwp:id="title-25">Allowing heterogeneous self-interactions</title><p hwp:id="p-79">At multiple points in the discussion above, we have suggested that interactions are not, by themselves, the quantities that control the equilibria: instead, that role is taken by <italic toggle="yes">couplings,</italic> i.e. the ratios of interactions to self-interaction, which represents how much the influence of another species could cause one to deviate from its independent logistic trajectory.</p><p hwp:id="p-80">In <xref ref-type="sec" rid="s2" hwp:id="xref-sec-6-1" hwp:rel-id="sec-6">Sec. 2</xref>, we presented results assuming that all self-interactions were equal, <italic toggle="yes">D<sub>i</sub></italic> = 1. But in fact, we can easily see that we can transfer our conclusions to the Lotka-Volterra equilibrium <xref ref-type="disp-formula" rid="eqn3" hwp:id="xref-disp-formula-3-5" hwp:rel-id="disp-formula-3">equation (3)</xref> <italic toggle="yes">divided by D<sub>i</sub></italic><xref ref-type="fn" rid="fn8" hwp:id="xref-fn-8-1" hwp:rel-id="fn-8"><sup>8</sup></xref>:
<disp-formula id="eqn32" hwp:id="disp-formula-34"><alternatives hwp:id="alternatives-38"><graphic xlink:href="147728_eqn32.gif" position="float" orientation="portrait" hwp:id="graphic-39"/></alternatives></disp-formula></p><p hwp:id="p-81">Here, we recall <italic toggle="yes">K<sub>i</sub></italic> = <italic toggle="yes">R<sub>i</sub></italic>/<italic toggle="yes">D<sub>i</sub></italic> the carrying capacity of species <italic toggle="yes">i,</italic> and <italic toggle="yes">α<sub>ij</sub></italic> = <italic toggle="yes">A<sub>ij</sub> /D<sub>i</sub></italic> the coupling of species <italic toggle="yes">i</italic> to species <italic toggle="yes">j.</italic> Thus, all the results we presented in <xref ref-type="sec" rid="s2" hwp:id="xref-sec-6-2" hwp:rel-id="sec-6">Sec. 2</xref> still hold if, instead of using the variance of growth rates, we use that of carrying capacities, and instead of using the statistics of <italic toggle="yes">A<sub>ij</sub></italic>, we use those of <italic toggle="yes">α<sub>ij</sub></italic>. In other words, we formally redefine the parameters of <xref ref-type="disp-formula" rid="eqn4" hwp:id="xref-disp-formula-4-2" hwp:rel-id="disp-formula-4">(4)</xref> as follows:
<disp-formula id="eqn33" hwp:id="disp-formula-35"><alternatives hwp:id="alternatives-39"><graphic xlink:href="147728_eqn33.gif" position="float" orientation="portrait" hwp:id="graphic-40"/></alternatives></disp-formula></p><p hwp:id="p-82">We can relabel the parameters and retain the same mathematical structure, and their interpretation does not change too dramatically – except in the important case of <italic toggle="yes">γ</italic>, as we soon discuss. Previously in this section, we used <italic toggle="yes">A</italic> = 〈<italic toggle="yes">A<sub>ij</sub></italic>〉 and <italic toggle="yes">σ<sub>A</sub></italic> extensively to discuss simple and general properties of the dynamics – the distribution of the interactions <italic toggle="yes">A<sub>ij</sub></italic> is otherwise entirely unspecified, and could take arbitrary forms (Gaussian, exponential, uniform, gamma, multimodal …) except for the pathological. We saw in examples that almost all other properties of this distribution <italic toggle="yes">P</italic>(<italic toggle="yes">A<sub>ij</sub></italic>) were irrelevant to assembly for large enough communities, one of the very counter-intuitive and attractive traits of disordered systems. In fact, we see now that, if self-interactions differ, we should use the <italic toggle="yes">α<sub>ij</sub></italic> instead; but thankfully, results remain insensitive to the details of <italic toggle="yes">P</italic>(<italic toggle="yes">α<sub>ij</sub></italic>). The subtlety is found in the fact that <italic toggle="yes">σ</italic> now includes not only the heterogeneity of interactions, but also that of self-interaction – in other words, species with identical interactions but very different growth rates and carrying capacities will have large <italic toggle="yes">σ</italic>, with all the consequences shown in <xref ref-type="sec" rid="s2" hwp:id="xref-sec-6-3" hwp:rel-id="sec-6">Sec. 2</xref> in terms of coexistence and multistability.</p><p hwp:id="p-83">This of course requires that <italic toggle="yes">D<sub>i</sub></italic> ≠ 0 – and in fact that <italic toggle="yes">A &lt; D<sub>i</sub></italic>, as the case of very strong interactions <italic toggle="yes">A &gt; D<sub>i</sub></italic> tends to lead to very unstable dynamics that we wish to avoid entirely in this approach<xref ref-type="fn" rid="fn9" hwp:id="xref-fn-9-1" hwp:rel-id="fn-9"><sup>9</sup></xref>, as discussed in 1.2.1.</p></sec><sec id="s4b2" hwp:id="sec-25" hwp:rev-id="xref-sec-25-1 xref-sec-25-2"><label>4.2.2</label><title hwp:id="title-26">Reinterpreting <italic toggle="yes">γ</italic></title><p hwp:id="p-84">However, there is one crucial change in interpretation. The parameter <italic toggle="yes">γ</italic> ∊ [−1, 1] represents the average degree of reciprocity between the dynamical coupling of species <italic toggle="yes">i</italic> to <italic toggle="yes">j</italic>, and that of <italic toggle="yes">j</italic> to <italic toggle="yes">i</italic>. The extreme case <italic toggle="yes">γ</italic> = 1 indicates fully symmetrical couplings <italic toggle="yes">α<sub>ij</sub></italic> = <italic toggle="yes">α<sub>ji</sub></italic>, while <italic toggle="yes">γ</italic> = −1 means anticorrelated couplings. Unfortunately, while this parameter is the one that truly encapsulates how asymmetry between interaction partners affects the assembly process, its interpretation is very subtle and counter-intuitive.</p><p hwp:id="p-85">Let us first discuss <italic toggle="yes">γ</italic> in the previous case where all self-interactions are equal, <italic toggle="yes">D<sub>i</sub></italic> = 1, as even that simpler situation has some difficulties. If <italic toggle="yes">A</italic> = 0, then <italic toggle="yes">γ &lt;</italic> 0 suggests trophic interactions, since <italic toggle="yes">A<sub>ij</sub></italic> and <italic toggle="yes">A<sub>ji</sub></italic> will typically be of opposite signs. However, if A ≫ <italic toggle="yes">σ<sub>A</sub></italic>, then even with <italic toggle="yes">γ</italic> = −1, <italic toggle="yes">A<sub>ij</sub></italic> ~ <italic toggle="yes">A</italic> + <italic toggle="yes">σ<sub>A</sub></italic> and <italic toggle="yes">A<sub>ji</sub></italic> ~ <italic toggle="yes">A</italic> − <italic toggle="yes">σ<sub>A</sub></italic> will have the same sign. They will simply be maximally anticorrelated: for every pair of species, one will affect the other much more than it is affected by it. This can for instance give rise to “rock-paper-scissors” intransitive competition.</p><p hwp:id="p-86">If we now return to varied self-interactions <italic toggle="yes">D<sub>i</sub></italic> ≠ 1 so that couplings are different from bare interactions, even that refined notion of reciprocity becomes more complex. Consider for example the classic resource competition models [<xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-2" hwp:rel-id="ref-21">21</xref>, <xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-1" hwp:rel-id="ref-10">10</xref>, <xref ref-type="bibr" rid="c39" hwp:id="xref-ref-39-2" hwp:rel-id="ref-39">39</xref>]. By construction, interactions come from two species harvesting the same resource and are therefore perfectly symmetrical, <italic toggle="yes">A<sub>ij</sub></italic> = <italic toggle="yes">A<sub>ji</sub></italic>. However, couplings are <italic toggle="yes">not</italic> – in fact, depending on parameters, the model can give any <italic toggle="yes">γ</italic> between −1 and 1, and most plausible parameter values correspond to <italic toggle="yes">γ &lt;</italic> 0. In any pair of competitors, each reduces the other’s growth equally, yet this will on average have a much larger impact on the dynamical trajectory of one species than the other.</p><p hwp:id="p-87">Hence, the proper way to understand <italic toggle="yes">γ</italic> is in relative terms: no matter whether the interaction is positive or negative or even symmetrical, if <italic toggle="yes">γ</italic> = −1, one species will respond much more to the interaction (in the sense that it will be more affected compared to the trajectory it would have if alone), while for <italic toggle="yes">γ</italic> = 1 they will respond equally. Given that assembly is a process of selecting species that are most compatible among a larger pool, it can be understood that what really matters is not the net outcome of each interaction, but how differently it affects the partners’ dynamics. But despite its predictive power, any intuitive interpretation of this parameter can only be made in the context of a more concrete model.</p></sec></sec><sec id="s4c" hwp:id="sec-26"><label>4.3</label><title hwp:id="title-27">Computing the assembled state</title><p hwp:id="p-88">At the start of <xref ref-type="sec" rid="s4" hwp:id="xref-sec-18-3" hwp:rel-id="sec-18">Sec. 4</xref>, we showed that the equilibrium of the Lotka-Volterra <xref ref-type="disp-formula" rid="eqn3" hwp:id="xref-disp-formula-3-6" hwp:rel-id="disp-formula-3">equations (3)</xref>, which we recall is given by
<disp-formula hwp:id="disp-formula-36"><alternatives hwp:id="alternatives-40"><graphic xlink:href="147728_ueqn3.gif" position="float" orientation="portrait" hwp:id="graphic-41"/></alternatives></disp-formula>
can be rewritten in all generality as
<disp-formula id="eqn34" hwp:id="disp-formula-37" hwp:rev-id="xref-disp-formula-37-1"><alternatives hwp:id="alternatives-41"><graphic xlink:href="147728_eqn34.gif" position="float" orientation="portrait" hwp:id="graphic-42"/></alternatives></disp-formula>
given the mean <italic toggle="yes">A</italic> = 〈<italic toggle="yes">A<sub>ij</sub></italic>〉 and the variance of interactions <inline-formula hwp:id="inline-formula-5"><alternatives hwp:id="alternatives-42"><inline-graphic xlink:href="147728_inline3.gif" hwp:id="inline-graphic-5"/></alternatives></inline-formula>, with the rescaled interactions <italic toggle="yes">a<sub>ij</sub></italic> = (<italic toggle="yes">A<sub>ij</sub></italic> − <italic toggle="yes">A</italic>)/<italic toggle="yes">σ<sub>A</sub></italic>.</p><p hwp:id="p-89">As we argued in <xref ref-type="sec" rid="s4b1" hwp:id="xref-sec-24-1" hwp:rel-id="sec-24">Sec. 4.2.1</xref>, the quantities that truly control the dynamics are not “bare” interactions <italic toggle="yes">A<sub>ij</sub></italic>, but couplings
<disp-formula hwp:id="disp-formula-38"><alternatives hwp:id="alternatives-43"><graphic xlink:href="147728_ueqn4.gif" position="float" orientation="portrait" hwp:id="graphic-43"/></alternatives></disp-formula>
which represent how much species <italic toggle="yes">j</italic> can cause species <italic toggle="yes">i</italic> to deviate from its baseline (logistic) trajectory controlled only by self-interaction <italic toggle="yes">D<sub>i</sub></italic>. We now rewrite
<disp-formula id="eqn35" hwp:id="disp-formula-39"><alternatives hwp:id="alternatives-44"><graphic xlink:href="147728_eqn35.gif" position="float" orientation="portrait" hwp:id="graphic-44"/></alternatives></disp-formula>
with
<disp-formula id="eqn36" hwp:id="disp-formula-40"><alternatives hwp:id="alternatives-45"><graphic xlink:href="147728_eqn36.gif" position="float" orientation="portrait" hwp:id="graphic-45"/></alternatives></disp-formula></p><p hwp:id="p-90">Then, we have
<disp-formula hwp:id="disp-formula-41"><alternatives hwp:id="alternatives-46"><graphic xlink:href="147728_ueqn5.gif" position="float" orientation="portrait" hwp:id="graphic-46"/></alternatives></disp-formula>
and instead of <xref ref-type="disp-formula" rid="eqn34" hwp:id="xref-disp-formula-37-1" hwp:rel-id="disp-formula-37">(34)</xref> we get
<disp-formula id="eqn37" hwp:id="disp-formula-42" hwp:rev-id="xref-disp-formula-42-1 xref-disp-formula-42-2"><alternatives hwp:id="alternatives-47"><graphic xlink:href="147728_eqn37.gif" position="float" orientation="portrait" hwp:id="graphic-47"/></alternatives></disp-formula>
where we have defined the effective self-interaction
<disp-formula id="eqn38" hwp:id="disp-formula-43"><alternatives hwp:id="alternatives-48"><graphic xlink:href="147728_eqn38.gif" position="float" orientation="portrait" hwp:id="graphic-48"/></alternatives></disp-formula>
and the effective carrying capacities
<disp-formula id="eqn39" hwp:id="disp-formula-44"><alternatives hwp:id="alternatives-49"><graphic xlink:href="147728_eqn39.gif" position="float" orientation="portrait" hwp:id="graphic-49"/></alternatives></disp-formula></p><p hwp:id="p-91">Following previous work [<xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-5" hwp:rel-id="ref-6">6</xref>], we use the cavity method from physics [<xref ref-type="bibr" rid="c29" hwp:id="xref-ref-29-1" hwp:rel-id="ref-29">29</xref>] to find the properties of the equilibria of <xref ref-type="disp-formula" rid="eqn37" hwp:id="xref-disp-formula-42-1" hwp:rel-id="disp-formula-42">equation (37)</xref>. Technical details are given in <xref ref-type="sec" rid="s5" hwp:id="xref-sec-27-4" hwp:rel-id="sec-27">Sec. 5</xref>. To understand the results and their limitations, it is enough to grasp the following simplified discussion, introducing some important concepts.</p><p hwp:id="p-92">Let us take an assembled state created from a pool with <italic toggle="yes">S</italic> − 1 species. When the final species <italic toggle="yes">i</italic> invades, if <italic toggle="yes">S</italic> is large, the properties of the assembled state should not change significantly<xref ref-type="fn" rid="fn10" hwp:id="xref-fn-10-1" hwp:rel-id="fn-10"><sup>10</sup></xref>. Hence, we imagine that we can move from <italic toggle="yes">S</italic> − 1 to <italic toggle="yes">S</italic> species holding everything constant, except for the fact that the other species have their final abundance <italic toggle="yes">N<sub>j</sub></italic> shifted a small amount, in the direction suggested by their couplings with <italic toggle="yes">i</italic>,
<disp-formula id="eqn40" hwp:id="disp-formula-45" hwp:rev-id="xref-disp-formula-45-1"><alternatives hwp:id="alternatives-50"><graphic xlink:href="147728_eqn40.gif" position="float" orientation="portrait" hwp:id="graphic-50"/></alternatives></disp-formula>
with <italic toggle="yes">v</italic> a positive “response coefficient” that we can compute. Inserting this shifted abundance in <xref ref-type="disp-formula" rid="eqn37" hwp:id="xref-disp-formula-42-2" hwp:rel-id="disp-formula-42">(37)</xref>, a feedback is created on species <italic toggle="yes">N<sub>i</sub></italic>. This is where the parameter <italic toggle="yes">γ</italic> enters the picture: if <italic toggle="yes">γ &gt;</italic> 0 the feedback is positive (e.g. a species reduces its competitors’ abundance, which in turn allows it to grow more), while if <italic toggle="yes">γ &lt;</italic> 0 the feedback is negative (e.g. a predator reduces its preys’ abundance, which stifles its growth). This explains how negative <italic toggle="yes">γ</italic> can play a stabilizing role in the dynamics, as we have seen above starting in <xref ref-type="sec" rid="s3c" hwp:id="xref-sec-15-3" hwp:rel-id="sec-15">Sec. 3.3</xref>.</p><p hwp:id="p-93">The finite trick is to see that this equation expresses <italic toggle="yes">N<sub>i</sub></italic> as a random variable obeying:
<disp-formula id="eqn41" hwp:id="disp-formula-46"><alternatives hwp:id="alternatives-51"><graphic xlink:href="147728_eqn41.gif" position="float" orientation="portrait" hwp:id="graphic-51"/></alternatives></disp-formula>
where <italic toggle="yes">a</italic> is a Gaussian random variable of mean 0, derived from the random walk <xref ref-type="disp-formula" rid="eqn27" hwp:id="xref-disp-formula-29-1" hwp:rel-id="disp-formula-29">(27)</xref> on the <italic toggle="yes">a<sub>ij</sub></italic>’s, and <italic toggle="yes">n</italic> is a random variable drawn from the distribution <italic toggle="yes">P</italic>(<italic toggle="yes">N</italic>) of surviving species. This simplification can be made technically precise, and relies on a crucial property of disordered systems: there is no correlation between the <italic toggle="yes">a<sub>ij</sub></italic>, which represent direct couplings, and the <italic toggle="yes">N<sub>j</sub> before</italic> the shift <xref ref-type="disp-formula" rid="eqn40" hwp:id="xref-disp-formula-45-1" hwp:rel-id="disp-formula-45">(40)</xref>, which are shaped by all the other indirect couplings in the system. These two could not be taken as independent parameters if each species depended strongly on a few others, but the disordered nature of interactions means that species abundances are shaped mostly by collective dynamics involving the whole community. A failure of this approach to correctly predict the behavior of some model could signal that local ordered dynamics prevail over collective disordered dynamics.</p><p hwp:id="p-94">The second central assumption that is made here is the existence of a single global attractor, meaning that no matter which initial condition is taken, the same assembled state is reached provided all species are given a chance to invade when they can. This premise is hidden in the fact that we assume that equilibrium species abundances do not shift drastically with the addition of a new species. As we have mentioned in <xref ref-type="sec" rid="s3c" hwp:id="xref-sec-15-4" hwp:rel-id="sec-15">Sec. 3.3</xref>, we can compute a quantity that becomes infinite precisely at parameter values for which there ceases to be a single attractor, thus signalling the appearance of potential tipping points. Methods in physics have been derived for the express purpose of investigating such multistable regimes, and quantifying the number and stability of attractors. In the case of Lotka-Volterra dynamics, however, this task is ongoing.</p><p hwp:id="p-95">The assembled state must be feasible and uninvadable, and therefore, studying it reveals what controls species coexistence. But it also contains information on the ecosystem’s sensitivity to external change: the quantities that arise naturally when computing the assembled state are long-term responses to a press perturbation, i.e. how the whole community’s equilibrium shifts in response to some species being pushed toward an abnormal abundance. This can come from durable environmental changes that affect the fitness of some species, but also from the introduction of a new invader into the system.</p></sec></sec><sec id="s5" hwp:id="sec-27" hwp:rev-id="xref-sec-27-1 xref-sec-27-2 xref-sec-27-3 xref-sec-27-4"><label>5</label><title hwp:id="title-28">Detailed calculations</title><p hwp:id="p-96">Readers who are only interested in the general spirit of the method can stop here, as we turn to the practicalities of using it and the dynamical intuitions it brings. In this section, we follow in closer detail the derivation of the equilibrium solution for a large Lotka-Volterra system first presented in [<xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">7</xref>]. For the mathematically minded reader, let us note that related calculations, using more technical methods from disordered systems, had previously been achieved for replicator equations (which are closely related to Lotka-Volterra) and mostly discussed within physics [<xref ref-type="bibr" rid="c32" hwp:id="xref-ref-32-1" hwp:rel-id="ref-32">32</xref>, <xref ref-type="bibr" rid="c41" hwp:id="xref-ref-41-1" hwp:rel-id="ref-41">41</xref>]. Earlier results relied on the “replica method”, limited to symmetrical interactions (hinging on the fact that there then exists a Lyapunov function, as noted long ago by MacArthur for resource competition [<xref ref-type="bibr" rid="c21" hwp:id="xref-ref-21-3" hwp:rel-id="ref-21">21</xref>]). Later results employed a “dynamical generating functional method” which allows to find not only equilibria but a single equation for the effective dynamics of the entire system [<xref ref-type="bibr" rid="c32" hwp:id="xref-ref-32-2" hwp:rel-id="ref-32">32</xref>], although that equation is partially implicit and can only be solved by ansatz.</p><p hwp:id="p-97">Bunin [<xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-2" hwp:rel-id="ref-7">7</xref>] proposed the first derivation for the equilibria of Lotka-Volterra systems, using a technically simple implementation of the “cavity method” [<xref ref-type="bibr" rid="c27" hwp:id="xref-ref-27-2" hwp:rel-id="ref-27">27</xref>]. This calculation is comparatively straightforward while retaining many important intuitions of disordered systems, and its application to ecological models is immediate, which makes it especially valuable for introductory purposes.</p><sec id="s5a" hwp:id="sec-28"><label>5.1</label><title hwp:id="title-29">The cavity trick</title><p hwp:id="p-98">The assembly process shapes the community by changing the abundances of species until an equilibrium is reached. From the imposed properties of the pool, assembly uses the abundances as its tool to select and reweigh species features, crafting a state that is feasible, stable and uninvadable by any other species in the pool. Hence, all the properties of the solution can be derived from the distribution of abundances and their correlations with species features (such as carrying capacities and interactions).</p><p hwp:id="p-99">The logic of the cavity method is remarkably simple: 1) we compute what happens after a single invasion in an already large community, and 2) we then require that the equilibrium features before and after the invasion be unchanged. The second part means that we are computing the fixed point of the invasion process, i.e. an equilibrium which cannot be invaded nor destabilized, rather than a single-step invasion as is often done in population genetics (testing whether a given mutant species can invade).</p><p hwp:id="p-100">As shown in <xref ref-type="fig" rid="fig6" hwp:id="xref-fig-6-1" hwp:rel-id="F6">Fig. 6</xref>, the calculation of the invasion is made simpler by assuming that, even though the invader itself retains its nonlinear dynamics, the effect of the invader on each already present species is small enough to be approximated by a <italic toggle="yes">linear</italic> change of their abundance. This assumption may seem intuitive if the final abundance of each species is the result of many interactions, so adding one more should not cause a dramatic change. A more formal justification is given in <xref ref-type="app" rid="app1" hwp:id="xref-app-1-1" hwp:rel-id="app-1">Appendix A</xref>.
<fig id="fig6" position="float" orientation="portrait" fig-type="figure" hwp:id="F6" hwp:rev-id="xref-fig-6-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;147728v3/FIG6</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F6</object-id><object-id pub-id-type="publisher-id">fig6</object-id><label>Figure 6:</label><caption hwp:id="caption-6"><p hwp:id="p-101">Cartoon of the cavity method.</p></caption><graphic xlink:href="147728_fig6" position="float" orientation="portrait" hwp:id="graphic-52"/></fig></p><p hwp:id="p-102">Let us introduce species 0 into a community of <italic toggle="yes">S</italic> − 1 species. Its equilibrium abundance <italic toggle="yes">N</italic><sub>0</sub> changes other <italic toggle="yes">N<sub>i</sub></italic> a little, as they now obey:
<disp-formula id="eqn42" hwp:id="disp-formula-47"><alternatives hwp:id="alternatives-52"><graphic xlink:href="147728_eqn42.gif" position="float" orientation="portrait" hwp:id="graphic-53"/></alternatives></disp-formula></p><p hwp:id="p-103">(where we recall that <inline-formula hwp:id="inline-formula-6"><alternatives hwp:id="alternatives-53"><inline-graphic xlink:href="147728_inline4.gif" hwp:id="inline-graphic-6"/></alternatives></inline-formula>). Formally, this looks like changing their carrying capacities <italic toggle="yes">k<sub>i</sub></italic> a little
<disp-formula id="eqn43" hwp:id="disp-formula-48"><alternatives hwp:id="alternatives-54"><graphic xlink:href="147728_eqn43.gif" position="float" orientation="portrait" hwp:id="graphic-54"/></alternatives></disp-formula>
where <inline-formula hwp:id="inline-formula-7"><alternatives hwp:id="alternatives-55"><inline-graphic xlink:href="147728_inline5.gif" hwp:id="inline-graphic-7"/></alternatives></inline-formula> is a slightly displaced carrying capacity. We now assume that <italic toggle="yes">N<sub>i</sub></italic> responds linearly to this small perturbation: using a Taylor expansion around the previous equilibrium abundance <inline-formula hwp:id="inline-formula-8"><alternatives hwp:id="alternatives-56"><inline-graphic xlink:href="147728_inline6.gif" hwp:id="inline-graphic-8"/></alternatives></inline-formula>, calculated without species 0, we can write
<disp-formula id="eqn44" hwp:id="disp-formula-49"><alternatives hwp:id="alternatives-57"><graphic xlink:href="147728_eqn44.gif" position="float" orientation="portrait" hwp:id="graphic-55"/></alternatives></disp-formula>
where we define the response coefficient,
<disp-formula id="eqn45" hwp:id="disp-formula-50"><alternatives hwp:id="alternatives-58"><graphic xlink:href="147728_eqn45.gif" position="float" orientation="portrait" hwp:id="graphic-56"/></alternatives></disp-formula></p><p hwp:id="p-104">This seems unhelpful at first, since <italic toggle="yes">v<sub>ii</sub></italic> is just another unknown in the problem, but we will show that creating this new set of unknowns actually helps us further down. To interpret <italic toggle="yes">v</italic>, let us remark that, if species were independent, then
<disp-formula id="eqn46" hwp:id="disp-formula-51"><alternatives hwp:id="alternatives-59"><graphic xlink:href="147728_eqn46.gif" position="float" orientation="portrait" hwp:id="graphic-57"/></alternatives></disp-formula></p><p hwp:id="p-105">Hence, <italic toggle="yes">v</italic> ≠ 1 indicates that species abundances are not defined solely by their intrinsic fitness, but by their effective fitness including interactions – it is possible to change their carrying capacity without affecting their abundance proportionally.</p><p hwp:id="p-106">In fact, all other species in the community perceive the effect of adding species 0, so a better approximation of the full linear response would include “cross-terms” i.e.
<disp-formula id="eqn47" hwp:id="disp-formula-52"><alternatives hwp:id="alternatives-60"><graphic xlink:href="147728_eqn47.gif" position="float" orientation="portrait" hwp:id="graphic-58"/></alternatives></disp-formula>
with
<disp-formula id="eqn48" hwp:id="disp-formula-53" hwp:rev-id="xref-disp-formula-53-1"><alternatives hwp:id="alternatives-61"><graphic xlink:href="147728_eqn48.gif" position="float" orientation="portrait" hwp:id="graphic-59"/></alternatives></disp-formula>
the long-term response of species <italic toggle="yes">i</italic> to a change in the carrying capacity of species <italic toggle="yes">j</italic>, including all the indirect effects from other species. In fact we show later that these indirect effects tend to cancel out and disappear, but let us include them for now, for the sake of completeness.</p><p hwp:id="p-107">Now, this shift in others’ abundance feeds back into the equation for <italic toggle="yes">N</italic><sub>0</sub>, which tells us how it depends on <inline-formula hwp:id="inline-formula-9"><alternatives hwp:id="alternatives-62"><inline-graphic xlink:href="147728_inline7.gif" hwp:id="inline-graphic-9"/></alternatives></inline-formula> the abundances before its invasion
<disp-formula id="eqn49" hwp:id="disp-formula-54"><alternatives hwp:id="alternatives-63"><graphic xlink:href="147728_eqn49.gif" position="float" orientation="portrait" hwp:id="graphic-60"/></alternatives></disp-formula>
<disp-formula id="eqn50" hwp:id="disp-formula-55" hwp:rev-id="xref-disp-formula-55-1"><alternatives hwp:id="alternatives-64"><graphic xlink:href="147728_eqn50.gif" position="float" orientation="portrait" hwp:id="graphic-61"/></alternatives></disp-formula></p><p hwp:id="p-108">The issue is that it contains a double sum over all the unknown <italic toggle="yes">v<sub>ij</sub></italic>, representing the overall feedback of species 0 on itself through the rest of the community. A crucial simplification is that, due to the disorder of interactions <italic toggle="yes">a<sub>ij</sub></italic>, these many unknowns collapse into a single one that can easily be determined later: this large sum tends to an average value, as we explain very roughly here and further detail in <xref ref-type="app" rid="app1" hwp:id="xref-app-1-2" hwp:rel-id="app-1">Appendix A</xref>. Since 〈<italic toggle="yes">a</italic><sub>0<italic toggle="yes">i</italic></sub>〉 = (<italic toggle="yes">a</italic><sub><italic toggle="yes">j</italic>0</sub>) = 0, all terms that have <italic toggle="yes">i</italic> ≠ <italic toggle="yes">j</italic> are fluctuations around 0, while each term 〈<italic toggle="yes">a</italic><sub><italic toggle="yes">i</italic>0</sub><italic toggle="yes">a</italic><sub>0<italic toggle="yes">i</italic></sub>〉 = <italic toggle="yes">γ</italic> has a significant contribution to the sum. Hence, as we noted before, the main contribution comes from the reponse of <italic toggle="yes">N<sub>i</sub></italic> to a change of <italic toggle="yes">k<sub>i</sub></italic>, rather than from cross-terms:
<disp-formula id="eqn51" hwp:id="disp-formula-56"><alternatives hwp:id="alternatives-65"><graphic xlink:href="147728_eqn51.gif" position="float" orientation="portrait" hwp:id="graphic-62"/></alternatives></disp-formula>
where <italic toggle="yes">s*</italic> = <italic toggle="yes">sϕ</italic> is the number of species that interact with species 0 and are still alive in the assembled state (we recall that <italic toggle="yes">ϕ</italic> is the overall fraction of surviving species). This sum is an average over all the interaction partners of species 0, and it is in fact “self-averaging”. This is physics jargon to say that, given a large number of species to interact with, it tends to become a single well-defined number for all species in the community, with fluctuations that become small as <italic toggle="yes">s</italic> becomes large,
<disp-formula id="eqn52" hwp:id="disp-formula-57"><alternatives hwp:id="alternatives-66"><graphic xlink:href="147728_eqn52.gif" position="float" orientation="portrait" hwp:id="graphic-63"/></alternatives></disp-formula>
where
<disp-formula id="eqn53" hwp:id="disp-formula-58"><alternatives hwp:id="alternatives-67"><graphic xlink:href="147728_eqn53.gif" position="float" orientation="portrait" hwp:id="graphic-64"/></alternatives></disp-formula></p><p hwp:id="p-109">Finally, we obtain the effective equation for <italic toggle="yes">N</italic><sub>0</sub> which will be solved below.
<disp-formula id="eqn54" hwp:id="disp-formula-59"><alternatives hwp:id="alternatives-68"><graphic xlink:href="147728_eqn54.gif" position="float" orientation="portrait" hwp:id="graphic-65"/></alternatives></disp-formula></p></sec><sec id="s5b" hwp:id="sec-29" hwp:rev-id="xref-sec-29-1"><label>5.2</label><title hwp:id="title-30">Universality of cavity results</title><p hwp:id="p-110">Isolating <italic toggle="yes">N</italic><sub>0</sub> on the left-hand side,
<disp-formula id="eqn55" hwp:id="disp-formula-60" hwp:rev-id="xref-disp-formula-60-1 xref-disp-formula-60-2 xref-disp-formula-60-3"><alternatives hwp:id="alternatives-69"><graphic xlink:href="147728_eqn55.gif" position="float" orientation="portrait" hwp:id="graphic-66"/></alternatives></disp-formula>
where
<disp-formula id="eqn56" hwp:id="disp-formula-61"><alternatives hwp:id="alternatives-70"><graphic xlink:href="147728_eqn56.gif" position="float" orientation="portrait" hwp:id="graphic-67"/></alternatives></disp-formula>
and we have defined
<disp-formula id="eqn57" hwp:id="disp-formula-62"><alternatives hwp:id="alternatives-71"><graphic xlink:href="147728_eqn57.gif" position="float" orientation="portrait" hwp:id="graphic-68"/></alternatives></disp-formula></p><p hwp:id="p-111">We can see in <italic toggle="yes">N</italic><sub>0</sub> two main contributions (stretched by a factor <inline-formula hwp:id="inline-formula-10"><alternatives hwp:id="alternatives-72"><inline-graphic xlink:href="147728_inline8.gif" hwp:id="inline-graphic-10"/></alternatives></inline-formula> that is common to all species in the community): the effective carrying capacity <italic toggle="yes">k</italic><sub>0</sub>, and a fitness shift Σ<sub>0</sub> arising only from to the <italic toggle="yes">heterogeneity</italic> of interspecies interactions. The former is model-dependent: we have no reason to constrain the distribution of carrying capacities <italic toggle="yes">K</italic><sub>0</sub> which is a property of the species pool (we recall that <italic toggle="yes">k</italic><sub>0</sub> = <italic toggle="yes">K</italic><sub>0</sub> − <italic toggle="yes">μ</italic> 〈<italic toggle="yes">N</italic>〉). But the latter becomes universal in the limit of many interactions. This relies on the sum <inline-formula hwp:id="inline-formula-11"><alternatives hwp:id="alternatives-73"><inline-graphic xlink:href="147728_inline9.gif" hwp:id="inline-graphic-11"/></alternatives></inline-formula> being effectively a random walk.</p><p hwp:id="p-112">Here, we are going to assume that interactions between species are not correlated <italic toggle="yes">in the pool</italic> (we discuss a weaker assumption that is still tractable in <xref ref-type="sec" rid="s7d" hwp:id="xref-sec-46-1" hwp:rel-id="sec-46">Sec. 7.4</xref>). This lack of correlation has two consequences. First, note that <italic toggle="yes">a</italic><sub>0<italic toggle="yes">i</italic></sub>. is uncorrelated with <inline-formula hwp:id="inline-formula-12"><alternatives hwp:id="alternatives-74"><inline-graphic xlink:href="147728_inline10.gif" hwp:id="inline-graphic-12"/></alternatives></inline-formula>: the abundance of species <italic toggle="yes">i before species</italic> 0 <italic toggle="yes">was introduced</italic> depends on <italic toggle="yes">a<sub>ji</sub></italic> for <italic toggle="yes">j</italic> ≠ 0, but bears no relationship to <italic toggle="yes">a</italic><sub>0<italic toggle="yes">i</italic></sub>. More importantly, <italic toggle="yes">a</italic><sub>0<italic toggle="yes">i</italic></sub> and <italic toggle="yes">a</italic><sub>0<italic toggle="yes">j</italic></sub> are uncorrelated, which means that all terms in the sum above are uncorrelated variables, and if they have finite variance, then the sum must tend to a Gaussian law by the Central Limit Theorem. This Gaussian law has mean 0 and variance <italic toggle="yes">sϕ</italic>〈<italic toggle="yes">N</italic> <sup>2</sup>〉<sup>*</sup>, where the mean is taken here over <italic toggle="yes">P</italic>(<italic toggle="yes">N*</italic>) the equilibrium distribution of values for <inline-formula hwp:id="inline-formula-13"><alternatives hwp:id="alternatives-75"><inline-graphic xlink:href="147728_inline11.gif" hwp:id="inline-graphic-13"/></alternatives></inline-formula>.</p><p hwp:id="p-113">Hence, for any model where interactions have finite variance, the final abun-dance distribution will be composed from the model-specific distribution of carrying capacities, and from a generic Gaussian term emerging from interactions<xref ref-type="fn" rid="fn11" hwp:id="xref-fn-11-1" hwp:rel-id="fn-11"><sup>11</sup></xref>. And even if <italic toggle="yes">P</italic>(<italic toggle="yes">N*</italic>) had a model-specific shape due to <italic toggle="yes">P</italic>(<italic toggle="yes">K</italic>), the interaction term, being Gaussian, is always entirely parametrized by the first two moments of <italic toggle="yes">P</italic>(<italic toggle="yes">N*</italic>), meaning that one never needs a lot of information on <italic toggle="yes">P</italic>(<italic toggle="yes">K</italic>) to correctly evaluate the effect of interactions.</p><p hwp:id="p-114">This entire reasoning however weakens if <italic toggle="yes">P</italic>(<italic toggle="yes">K</italic>) – and therefore <italic toggle="yes">P</italic>(<italic toggle="yes">N*</italic>) – have fat tails; any other structure (e.g. multimodal <italic toggle="yes">P</italic>(<italic toggle="yes">K</italic>)) will somewhat increase the necessary number of species and interactions to converge toward the Gaussian distribution of <italic toggle="yes">σ</italic><sub>0</sub>, but fat tails may prevent this convergence altogether (if variance is formally infinite) or make it dramatically slow. This possibility would call for an extreme value calculation instead: what would matter in Σ<sub>0</sub> would not be its variance anymore, but its extreme values, which obey a different but still universal distribution.</p><p hwp:id="p-115">We will now assume that <italic toggle="yes">P</italic>(<italic toggle="yes">K</italic>) is “well-behaved” (e.g. Gaussian or uniform) so that it is enough to know its mean and variance to derive <italic toggle="yes">P</italic>(<italic toggle="yes">N*</italic>). We discuss in <xref ref-type="sec" rid="s6" hwp:id="xref-sec-39-1" hwp:rel-id="sec-39">Sec. 6</xref> the sensitivty of results to choices of <italic toggle="yes">P</italic>(<italic toggle="yes">K</italic>).</p></sec><sec id="s5c" hwp:id="sec-30" hwp:rev-id="xref-sec-30-1"><label>5.3</label><title hwp:id="title-31">Abundance distribution</title><p hwp:id="p-116">Let us recall <xref ref-type="disp-formula" rid="eqn55" hwp:id="xref-disp-formula-60-1" hwp:rel-id="disp-formula-60">equation (55)</xref> which defines the equilibrium abundance <italic toggle="yes">N</italic><sub>0</sub> of a representative species in the community as a sum of two random contributions:
<disp-formula hwp:id="disp-formula-63"><alternatives hwp:id="alternatives-76"><graphic xlink:href="147728_ueqn6.gif" position="float" orientation="portrait" hwp:id="graphic-69"/></alternatives></disp-formula></p><p hwp:id="p-117">This expression allows for <italic toggle="yes">N</italic><sub>0</sub> <italic toggle="yes">&lt;</italic> 0, hence, <italic toggle="yes">N</italic><sub>0</sub> is a “virtual abundance” that signals that some species could invade and attain abundance <italic toggle="yes">N</italic><sub>0</sub> if <italic toggle="yes">N</italic><sub>0</sub> <italic toggle="yes">&gt;</italic> 0, or that the species could not invade durably if <italic toggle="yes">N</italic><sub>0</sub> ≤ 0. (Note that the more traditional approach to assembly is to check whether a species can grow immediately at the start of its invasion, without predicting the rest of its trajectory; here on the contrary we check whether it could remain at infinitely long times, after all interactions with the rest of the community have played out).</p><p hwp:id="p-118">This virtual abundance has been computed from the carrying capacities of invaders <italic toggle="yes">P</italic>(<italic toggle="yes">K</italic><sub>0</sub>) and the abundances of surviving species <italic toggle="yes">P</italic>(<italic toggle="yes">N<sup>*</sup></italic>). This means that, if species 0 itself survives, it becomes representative of survivors. If we can compute the probability distribution <italic toggle="yes">P</italic><sub>0</sub>(<italic toggle="yes">N</italic><sub>0</sub>), then <italic toggle="yes">P</italic>(<italic toggle="yes">N</italic>*), must be the same distribution restricted to positive values.</p><p hwp:id="p-119">An important conceptual trick in this approach is that, instead of computing species abundances for a given community, i.e. a fixed choice of interactions and carrying capacities, we suppose here that all abundances are fixed (even if we do not know their values yet) <italic toggle="yes">except</italic> for that of species 0, and try to compute the typical distribution of <italic toggle="yes">N</italic><sub>0</sub> over the whole range of possibilities for <italic toggle="yes">a</italic><sub>0<italic toggle="yes">i</italic></sub><italic toggle="yes">, a<sub>i</sub></italic><sub>0</sub> and <italic toggle="yes">K</italic><sub>0</sub>. From it we will compute the “typical” abundance distribution <italic toggle="yes">P</italic>(<italic toggle="yes">N<sup>*</sup></italic>), i.e. the one that we will see on average over all possible communities whose parameters are drawn from these probability distributions.</p><p hwp:id="p-120">Since we know <italic toggle="yes">N</italic><sub>0</sub> as a function of <inline-formula hwp:id="inline-formula-14"><alternatives hwp:id="alternatives-77"><inline-graphic xlink:href="147728_inline12.gif" hwp:id="inline-graphic-14"/></alternatives></inline-formula> in a given system, and <italic toggle="yes">P</italic>(<italic toggle="yes">N<sup>*</sup></italic>) as a function of the distribution <italic toggle="yes">P</italic><sub>0</sub>(<italic toggle="yes">N</italic><sub>0</sub>) over all possible choices for interactions and carrying capacities, we have a closed system that can be solved through the method of moments. First, we compute the first two moments of <italic toggle="yes">P</italic><sub>0</sub>(<italic toggle="yes">N</italic><sub>0</sub>) as a function of those of <italic toggle="yes">P</italic>(<italic toggle="yes">N<sup>*</sup></italic>). We can take the mean over <italic toggle="yes">P</italic>(<italic toggle="yes">a</italic><sub>0<italic toggle="yes">i</italic></sub>) and <italic toggle="yes">P</italic>(<italic toggle="yes">K</italic><sub>0</sub>) of both terms in <xref ref-type="disp-formula" rid="eqn55" hwp:id="xref-disp-formula-60-2" hwp:rel-id="disp-formula-60">(55)</xref>, we find
<disp-formula id="eqn58" hwp:id="disp-formula-64"><alternatives hwp:id="alternatives-78"><graphic xlink:href="147728_eqn58.gif" position="float" orientation="portrait" hwp:id="graphic-70"/></alternatives></disp-formula>
where we used (<italic toggle="yes">N</italic>) = <italic toggle="yes">ϕ</italic>〈<italic toggle="yes">N</italic>〉<sup>*</sup> (since when we introduced 〈<italic toggle="yes">N</italic>〉 earlier, we took the mean over all <italic toggle="yes">S</italic> species, including those that are dead), and the facts that 〈<italic toggle="yes">a</italic><sub>0<italic toggle="yes">j</italic></sub><italic toggle="yes">N<sub>j</sub></italic>〉 = 〈<italic toggle="yes">a</italic><sub>0<italic toggle="yes">j</italic></sub>〉 〈<italic toggle="yes">N</italic>〉 and 〈<italic toggle="yes">a</italic><sub>0<italic toggle="yes">j</italic></sub>〉 = 0. Hence
<disp-formula id="eqn59" hwp:id="disp-formula-65"><alternatives hwp:id="alternatives-79"><graphic xlink:href="147728_eqn59.gif" position="float" orientation="portrait" hwp:id="graphic-71"/></alternatives></disp-formula></p><p hwp:id="p-121">For variances, we can similarly find
<disp-formula id="eqn60" hwp:id="disp-formula-66"><alternatives hwp:id="alternatives-80"><graphic xlink:href="147728_eqn60.gif" position="float" orientation="portrait" hwp:id="graphic-72"/></alternatives></disp-formula></p><p hwp:id="p-122">Hence, if <italic toggle="yes">k</italic><sub>0</sub> and Σ<sub>0</sub> are independent variables (see below otherwise) the variance of the sum is the sum of variances and
<disp-formula id="eqn61" hwp:id="disp-formula-67" hwp:rev-id="xref-disp-formula-67-1"><alternatives hwp:id="alternatives-81"><graphic xlink:href="147728_eqn61.gif" position="float" orientation="portrait" hwp:id="graphic-73"/></alternatives></disp-formula></p><p hwp:id="p-123">Following our assumption that <italic toggle="yes">P</italic>(<italic toggle="yes">K</italic>) is well-behaved, these two moments are enough and we approximate <italic toggle="yes">P</italic><sub>0</sub>(<italic toggle="yes">N</italic><sub>0</sub>) by a Gaussian law with the mean and variance just given,
<disp-formula id="eqn62" hwp:id="disp-formula-68"><alternatives hwp:id="alternatives-82"><graphic xlink:href="147728_eqn62.gif" position="float" orientation="portrait" hwp:id="graphic-74"/></alternatives></disp-formula></p><p hwp:id="p-124">From there, we can give a definition to 〈<italic toggle="yes">N</italic>〉<italic toggle="yes">*</italic>, 〈<italic toggle="yes">N</italic><sup>2</sup>〉<sup>*</sup> and <italic toggle="yes">ϕ</italic> by restricting <italic toggle="yes">P</italic><sub>0</sub> (<italic toggle="yes">N</italic><sub>0</sub>) to its positive values
<disp-formula id="eqn63" hwp:id="disp-formula-69"><alternatives hwp:id="alternatives-83"><graphic xlink:href="147728_eqn63.gif" position="float" orientation="portrait" hwp:id="graphic-75"/></alternatives></disp-formula>
<disp-formula id="eqn64" hwp:id="disp-formula-70"><alternatives hwp:id="alternatives-84"><graphic xlink:href="147728_eqn64.gif" position="float" orientation="portrait" hwp:id="graphic-76"/></alternatives></disp-formula>
<disp-formula id="eqn65" hwp:id="disp-formula-71"><alternatives hwp:id="alternatives-85"><graphic xlink:href="147728_eqn65.gif" position="float" orientation="portrait" hwp:id="graphic-77"/></alternatives></disp-formula>
where the 1/<italic toggle="yes">ϕ</italic> factor ensures normalization. On the other hand, <italic toggle="yes">v</italic> is given by taking the derivative <xref ref-type="disp-formula" rid="eqn48" hwp:id="xref-disp-formula-53-1" hwp:rel-id="disp-formula-53">(48)</xref> in <xref ref-type="disp-formula" rid="eqn55" hwp:id="xref-disp-formula-60-3" hwp:rel-id="disp-formula-60">(55)</xref>
<disp-formula id="eqn67" hwp:id="disp-formula-72"><alternatives hwp:id="alternatives-86"><graphic xlink:href="147728_eqn67.gif" position="float" orientation="portrait" hwp:id="graphic-78"/></alternatives></disp-formula>
which is thus coupled to the rest through <italic toggle="yes">ϕ</italic> (and by appearing in <italic toggle="yes">P</italic><sub>0</sub>). We now have a closed set of four equations for four unknowns: <italic toggle="yes">v</italic>, <italic toggle="yes">ϕ</italic>, 〈<italic toggle="yes">N</italic>〉<italic toggle="yes">*</italic>, 〈<italic toggle="yes">N</italic><sup>2</sup>〉* which appear on the left-hand side of each equation and in <italic toggle="yes">P</italic><sub>0</sub> (<italic toggle="yes">N</italic><sub>0</sub>). These equations can be solved together numerically. It is then immediate to compute quantities such as total biomass
<disp-formula id="eqn68" hwp:id="disp-formula-73"><alternatives hwp:id="alternatives-87"><graphic xlink:href="147728_eqn68.gif" position="float" orientation="portrait" hwp:id="graphic-79"/></alternatives></disp-formula>
and Simpson index
<disp-formula id="eqn69" hwp:id="disp-formula-74"><alternatives hwp:id="alternatives-88"><graphic xlink:href="147728_eqn69.gif" position="float" orientation="portrait" hwp:id="graphic-80"/></alternatives></disp-formula></p><sec id="s5c1" hwp:id="sec-31"><label>5.3.1</label><title hwp:id="title-32">Correlations between <italic toggle="yes">K<sub>i</sub></italic> and <italic toggle="yes">A<sub>ij</sub></italic></title><p hwp:id="p-125">Equation <xref ref-type="disp-formula" rid="eqn61" hwp:id="xref-disp-formula-67-1" hwp:rel-id="disp-formula-67">(61)</xref> assumed <italic toggle="yes">k</italic><sub>0</sub> and Σ<sub>0</sub>, and hence <italic toggle="yes">K<sub>i</sub></italic> and <italic toggle="yes">A<sub>ij</sub></italic>, to be independent variables. If there is a correlation between them, then
<disp-formula id="eqn70" hwp:id="disp-formula-75"><alternatives hwp:id="alternatives-89"><graphic xlink:href="147728_eqn70.gif" position="float" orientation="portrait" hwp:id="graphic-81"/></alternatives></disp-formula>
where
<disp-formula id="eqn71" hwp:id="disp-formula-76"><alternatives hwp:id="alternatives-90"><graphic xlink:href="147728_eqn71.gif" position="float" orientation="portrait" hwp:id="graphic-82"/></alternatives></disp-formula></p><p hwp:id="p-126">Hence, such correlations can be accounted for, at the cost of adding a new parameter. Other simple extensions are discussed in <xref ref-type="sec" rid="s7" hwp:id="xref-sec-42-1" hwp:rel-id="sec-42">Sec. 7</xref>.</p></sec><sec id="s5c2" hwp:id="sec-32"><label>5.3.2</label><title hwp:id="title-33">Relationship to empirics</title><p hwp:id="p-127">The fact that the theoretical abundance distribution is (approximately or exactly) a truncated Gaussian contradicts much evidence on empirical abundance distributions being fat-tailed – possibly log-normal or even power-law. No fault lies with the mathematical analysis, as it is in perfect quantitative agreement with many simulation models, see [<xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-2" hwp:rel-id="ref-4">4</xref>]. Hence the issue will occur for any system with Lotka-Volterra dynamics <xref ref-type="disp-formula" rid="eqn1" hwp:id="xref-disp-formula-1-2" hwp:rel-id="disp-formula-1">(1)</xref> with random interactions and carrying capacities drawn from many usual distributions, and without noise.</p><p hwp:id="p-128">There are at least three solutions to this problem. The first is a wide distribution of carrying capacities: let us recall that in <xref ref-type="sec" rid="s2b3" hwp:id="xref-sec-11-2" hwp:rel-id="sec-11">Sec. 2.2.3</xref>, we noted that many competitive models [<xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-2" hwp:rel-id="ref-17">17</xref>, <xref ref-type="bibr" rid="c26" hwp:id="xref-ref-26-2" hwp:rel-id="ref-26">26</xref>] assume<xref ref-type="fn" rid="fn12" hwp:id="xref-fn-12-1" hwp:rel-id="fn-12"><sup>12</sup></xref> that interactions scale like
<disp-formula id="eqn72" hwp:id="disp-formula-77"><alternatives hwp:id="alternatives-91"><graphic xlink:href="147728_eqn72.gif" position="float" orientation="portrait" hwp:id="graphic-83"/></alternatives></disp-formula>
with some narrowly distributed <italic toggle="yes">B<sub>ij</sub></italic> (e.g. uniform or Gaussian). In this case, we noted that we could write
<disp-formula hwp:id="disp-formula-78"><alternatives hwp:id="alternatives-92"><graphic xlink:href="147728_ueqn7.gif" position="float" orientation="portrait" hwp:id="graphic-84"/></alternatives></disp-formula></p><p hwp:id="p-129">Hence, by having <italic toggle="yes">μ, σ</italic> and <italic toggle="yes">γ</italic> be the properties of the <italic toggle="yes">B<sub>ij</sub></italic>, the results above predict that the distribution <italic toggle="yes">P</italic>(<italic toggle="yes">N<sub>i</sub></italic>/<italic toggle="yes">K<sub>i</sub></italic>) is a truncated Gaussian. If <italic toggle="yes">K<sub>i</sub></italic> follows a lognormal distribution for instance, as seen in plant monocultures [<xref ref-type="bibr" rid="c34" hwp:id="xref-ref-34-1" hwp:rel-id="ref-34">34</xref>], then <italic toggle="yes">N<sub>i</sub></italic> at equilibrium will have an even wider distribution.</p><p hwp:id="p-130">This explanation however assumes that the wide spread of species abundances is due to some intrinsic species properties, which define <italic toggle="yes">K<sub>i</sub></italic> in a given environment. Under this explanatory scenario, our analysis is compatible with fat-tailed abundance distributions, but does not explain their emergence. However, there are at least two ways in which the dynamics themselves could produce fatter tails: first, the addition of noise, which is a central ingredient in neutral models that successfully predict abundance distributions. Second, the role of spatial aggregation in the data, as it is well known that aggregating over Gaussian distributions with different variances can create the appearance of more complex distributions and even fat tails - indeed, this is seen in an extension of this work to metacommunities (to be published).</p></sec></sec><sec id="s5d" hwp:id="sec-33"><label>5.4</label><title hwp:id="title-34">Selection by assembly: the case of carrying capacities</title><p hwp:id="p-131">Starting from this section, the core of the method is established and we simply show how various quantities of interest can be calculated using the results above.</p><p hwp:id="p-132">We have seen above that equilibrium abundances are made up of two independent contributions: one coming from the effective carrying capacity, the other a shift in abundance due to the heterogeneity of interactions
<disp-formula hwp:id="disp-formula-79"><alternatives hwp:id="alternatives-93"><graphic xlink:href="147728_ueqn8.gif" position="float" orientation="portrait" hwp:id="graphic-85"/></alternatives></disp-formula></p><p hwp:id="p-133">We also recall that
<disp-formula hwp:id="disp-formula-80"><alternatives hwp:id="alternatives-94"><graphic xlink:href="147728_ueqn9.gif" position="float" orientation="portrait" hwp:id="graphic-86"/></alternatives></disp-formula></p><p hwp:id="p-134">If we want to know the equilibrium distribution of carrying capacities <inline-formula hwp:id="inline-formula-15"><alternatives hwp:id="alternatives-95"><inline-graphic xlink:href="147728_inline13.gif" hwp:id="inline-graphic-15"/></alternatives></inline-formula>, we start from the joint distribution of abundance <italic toggle="yes">N</italic><sub>0</sub> and effective carrying capacity <italic toggle="yes">k</italic><sub>0</sub>, which we will then restrict only to surviving species <italic toggle="yes">N</italic><sub>0</sub> <italic toggle="yes">&gt;</italic> 0.
<disp-formula id="eqn73" hwp:id="disp-formula-81"><alternatives hwp:id="alternatives-96"><graphic xlink:href="147728_eqn73.gif" position="float" orientation="portrait" hwp:id="graphic-87"/></alternatives></disp-formula>
hence
<disp-formula id="eqn74" hwp:id="disp-formula-82"><alternatives hwp:id="alternatives-97"><graphic xlink:href="147728_eqn74.gif" position="float" orientation="portrait" hwp:id="graphic-88"/></alternatives></disp-formula></p><p hwp:id="p-135">Now, since Σ<sub>0</sub> and <italic toggle="yes">k</italic><sub>0</sub> are independent, <italic toggle="yes">P</italic>(Σ<sub>0</sub>, <italic toggle="yes">k</italic><sub>0</sub>) = <italic toggle="yes">P</italic>(Σ<sub>0</sub>)<italic toggle="yes">P</italic>(<italic toggle="yes">k</italic><sub>0</sub>), so
<disp-formula id="eqn75" hwp:id="disp-formula-83"><alternatives hwp:id="alternatives-98"><graphic xlink:href="147728_eqn75.gif" position="float" orientation="portrait" hwp:id="graphic-89"/></alternatives></disp-formula></p><p hwp:id="p-136">We argued above that <italic toggle="yes">P</italic>(Σ<sub>0</sub>) is Gaussian with mean 0 and variance <inline-formula hwp:id="inline-formula-16"><alternatives hwp:id="alternatives-99"><inline-graphic xlink:href="147728_inline14.gif" hwp:id="inline-graphic-16"/></alternatives></inline-formula>
<disp-formula id="eqn76" hwp:id="disp-formula-84"><alternatives hwp:id="alternatives-100"><graphic xlink:href="147728_eqn76.gif" position="float" orientation="portrait" hwp:id="graphic-90"/></alternatives></disp-formula>
with
<disp-formula id="eqn77" hwp:id="disp-formula-85"><alternatives hwp:id="alternatives-101"><graphic xlink:href="147728_eqn77.gif" position="float" orientation="portrait" hwp:id="graphic-91"/></alternatives></disp-formula></p><p hwp:id="p-137">Now, we want to isolate <italic toggle="yes">P</italic><sub>0</sub> (<italic toggle="yes">N</italic><sub>0</sub>) within <italic toggle="yes">P</italic>(<italic toggle="yes">N</italic><sub>0</sub>, <italic toggle="yes">k</italic><sub>0</sub>), so that the integral over <italic toggle="yes">N</italic><sub>0</sub> <italic toggle="yes">&gt;</italic> 0 causes the moments we have already computed, <italic toggle="yes">ϕ</italic>, 〈<italic toggle="yes">N</italic>〉 and 〈<italic toggle="yes">N</italic> <sup>2</sup>〉, to appear. We recall
<disp-formula hwp:id="disp-formula-86"><alternatives hwp:id="alternatives-102"><graphic xlink:href="147728_ueqn10.gif" position="float" orientation="portrait" hwp:id="graphic-92"/></alternatives></disp-formula></p><p hwp:id="p-138">With some manipulations (assuming a Gaussian distribution for <italic toggle="yes">K<sub>i</sub></italic>), we can see that
<disp-formula id="eqn78" hwp:id="disp-formula-87"><alternatives hwp:id="alternatives-103"><graphic xlink:href="147728_eqn78.gif" position="float" orientation="portrait" hwp:id="graphic-93"/></alternatives></disp-formula></p><p hwp:id="p-139">In particular, we find the averages over surviving species
<disp-formula id="eqn79" hwp:id="disp-formula-88"><alternatives hwp:id="alternatives-104"><graphic xlink:href="147728_eqn79.gif" position="float" orientation="portrait" hwp:id="graphic-94"/></alternatives></disp-formula>
and
<disp-formula id="eqn80" hwp:id="disp-formula-89"><alternatives hwp:id="alternatives-105"><graphic xlink:href="147728_eqn80.gif" position="float" orientation="portrait" hwp:id="graphic-95"/></alternatives></disp-formula>
where we recall 〈<italic toggle="yes">N</italic>〉 = <italic toggle="yes">ϕ</italic> 〈<italic toggle="yes">N</italic>〉<italic toggle="yes"><sup>*</sup></italic>, 〈<italic toggle="yes">N</italic><sup>2</sup>〉 = <italic toggle="yes">ϕ</italic> 〈<italic toggle="yes">N</italic><sup>2</sup>〉<italic toggle="yes"><sup>*</sup></italic>.</p></sec><sec id="s5e" hwp:id="sec-34"><label>5.5</label><title hwp:id="title-35">Productivity</title><p hwp:id="p-140">Given the abundance distribution <italic toggle="yes">P</italic>(<italic toggle="yes">N<sub>i</sub></italic>), it is possible to compute the productivity distribution – or at least the distribution of growth on external resources,
<disp-formula id="eqn81" hwp:id="disp-formula-90"><alternatives hwp:id="alternatives-106"><graphic xlink:href="147728_eqn81.gif" position="float" orientation="portrait" hwp:id="graphic-96"/></alternatives></disp-formula>
which acts as a proxy for productivity. If the quantities that are drawn independently are <italic toggle="yes">K<sub>i</sub></italic>, <italic toggle="yes">α<sub>ij</sub></italic> and <italic toggle="yes">D<sub>i</sub></italic>, then straightforwardly
<disp-formula id="eqn82" hwp:id="disp-formula-91"><alternatives hwp:id="alternatives-107"><graphic xlink:href="147728_eqn82.gif" position="float" orientation="portrait" hwp:id="graphic-97"/></alternatives></disp-formula>
<disp-formula id="eqn83" hwp:id="disp-formula-92"><alternatives hwp:id="alternatives-108"><graphic xlink:href="147728_eqn83.gif" position="float" orientation="portrait" hwp:id="graphic-98"/></alternatives></disp-formula>
<disp-formula id="eqn84" hwp:id="disp-formula-93"><alternatives hwp:id="alternatives-109"><graphic xlink:href="147728_eqn84.gif" position="float" orientation="portrait" hwp:id="graphic-99"/></alternatives></disp-formula>
and we get <italic toggle="yes">P</italic>(<italic toggle="yes">K<sub>i</sub></italic>, <italic toggle="yes">N<sub>i</sub></italic>) from the previous section. In particular, taking the average over surviving species, we find (if all <italic toggle="yes">K<sub>i</sub> &gt;</italic> 0)
<disp-formula id="eqn85" hwp:id="disp-formula-94"><alternatives hwp:id="alternatives-110"><graphic xlink:href="147728_eqn85.gif" position="float" orientation="portrait" hwp:id="graphic-100"/></alternatives></disp-formula>
where we used 〈<italic toggle="yes">D<sub>i</sub></italic>〉 = 1. If however the independent quantities are <italic toggle="yes">R<sub>i</sub></italic>, <italic toggle="yes">A<sub>ij</sub></italic> and <italic toggle="yes">D<sub>i</sub></italic>, the calculation is less straightforward: we must now start from
<disp-formula hwp:id="disp-formula-95"><alternatives hwp:id="alternatives-111"><graphic xlink:href="147728_ueqn11.gif" position="float" orientation="portrait" hwp:id="graphic-101"/></alternatives></disp-formula>
where
<disp-formula id="eqn86" hwp:id="disp-formula-96"><alternatives hwp:id="alternatives-112"><graphic xlink:href="147728_eqn86.gif" position="float" orientation="portrait" hwp:id="graphic-102"/></alternatives></disp-formula>
and we now have <inline-formula hwp:id="inline-formula-17"><alternatives hwp:id="alternatives-113"><inline-graphic xlink:href="147728_inline15.gif" hwp:id="inline-graphic-17"/></alternatives></inline-formula>, hence
<disp-formula id="eqn87" hwp:id="disp-formula-97"><alternatives hwp:id="alternatives-114"><graphic xlink:href="147728_eqn87.gif" position="float" orientation="portrait" hwp:id="graphic-103"/></alternatives></disp-formula>
and we get the total productivity
<disp-formula id="eqn88" hwp:id="disp-formula-98"><alternatives hwp:id="alternatives-115"><graphic xlink:href="147728_eqn88.gif" position="float" orientation="portrait" hwp:id="graphic-104"/></alternatives></disp-formula></p></sec><sec id="s5f" hwp:id="sec-35" hwp:rev-id="xref-sec-35-1"><label>5.6</label><title hwp:id="title-36">Response to perturbations</title><p hwp:id="p-141">Let us now assume that some small permanent (press) perturbation <italic toggle="yes">ξ<sub>i</sub></italic> is added to the system at equilibrium (acting only on the surviving species)
<disp-formula id="eqn89" hwp:id="disp-formula-99"><alternatives hwp:id="alternatives-116"><graphic xlink:href="147728_eqn89.gif" position="float" orientation="portrait" hwp:id="graphic-105"/></alternatives></disp-formula></p><p hwp:id="p-142">We can write <inline-formula hwp:id="inline-formula-18"><alternatives hwp:id="alternatives-117"><inline-graphic xlink:href="147728_inline16.gif" hwp:id="inline-graphic-18"/></alternatives></inline-formula>, with <italic toggle="yes">x<sub>i</sub></italic> the displacement around equilibrium, which obeys
<disp-formula id="eqn90" hwp:id="disp-formula-100"><alternatives hwp:id="alternatives-118"><graphic xlink:href="147728_eqn90.gif" position="float" orientation="portrait" hwp:id="graphic-106"/></alternatives></disp-formula>
a very similar equation to that obeyed by equilibrium abundances, except for the fact that the carrying capacity <italic toggle="yes">K<sub>i</sub></italic> has been replaced by the perturbation <italic toggle="yes">ξ<sub>i</sub></italic>, and of course that <italic toggle="yes">x<sub>i</sub></italic> is not constrained to be positive. Following the same logic as before, we isolate the response of species 0
<disp-formula id="eqn91" hwp:id="disp-formula-101"><alternatives hwp:id="alternatives-119"><graphic xlink:href="147728_eqn91.gif" position="float" orientation="portrait" hwp:id="graphic-107"/></alternatives></disp-formula></p><p hwp:id="p-143">If there are no constraints on <italic toggle="yes">x</italic><sub>0</sub> (see <xref ref-type="sec" rid="s5f2" hwp:id="xref-sec-37-1" hwp:rel-id="sec-37">Sec. 5.6.2</xref> below), we can simply assume
<disp-formula id="eqn92" hwp:id="disp-formula-102"><alternatives hwp:id="alternatives-120"><graphic xlink:href="147728_eqn92.gif" position="float" orientation="portrait" hwp:id="graphic-108"/></alternatives></disp-formula>
and thus get the average displacement:
<disp-formula id="eqn93" hwp:id="disp-formula-103"><alternatives hwp:id="alternatives-121"><graphic xlink:href="147728_eqn93.gif" position="float" orientation="portrait" hwp:id="graphic-109"/></alternatives></disp-formula></p><sec id="s5f1" hwp:id="sec-36"><label>5.6.1</label><title hwp:id="title-37">Multistability order parameter</title><p hwp:id="p-144">To test whether the equilibrium we are obtaining as the fixed point of the invasion process is globally stable, or might be exited through some small perturbation in the appropriate direction, we must consider the response to a random perturbation with zero mean,
<disp-formula id="eqn94" hwp:id="disp-formula-104"><alternatives hwp:id="alternatives-122"><graphic xlink:href="147728_eqn94.gif" position="float" orientation="portrait" hwp:id="graphic-110"/></alternatives></disp-formula>
representing random shifts in relative fitness that advantage some species over others, without changing the mean species fitness. Since the mean is zero, the response to the perturbation is characterized by the variance,
<disp-formula id="eqn95" hwp:id="disp-formula-105"><alternatives hwp:id="alternatives-123"><graphic xlink:href="147728_eqn95.gif" position="float" orientation="portrait" hwp:id="graphic-111"/></alternatives></disp-formula></p><p hwp:id="p-145">Now the equation above, using 〈<italic toggle="yes">x</italic>〉 = 0, can be taken to the square to get:
<disp-formula id="eqn96" hwp:id="disp-formula-106"><alternatives hwp:id="alternatives-124"><graphic xlink:href="147728_eqn96.gif" position="float" orientation="portrait" hwp:id="graphic-112"/></alternatives></disp-formula>
hence
<disp-formula id="eqn97" hwp:id="disp-formula-107"><alternatives hwp:id="alternatives-125"><graphic xlink:href="147728_eqn97.gif" position="float" orientation="portrait" hwp:id="graphic-113"/></alternatives></disp-formula>
which is seen to diverge when <italic toggle="yes">σ</italic> = <italic toggle="yes">σ<sub>c</sub></italic> such that
<disp-formula id="eqn98" hwp:id="disp-formula-108"><alternatives hwp:id="alternatives-126"><graphic xlink:href="147728_eqn98.gif" position="float" orientation="portrait" hwp:id="graphic-114"/></alternatives></disp-formula>
and by using (<italic toggle="yes">u</italic> − <italic toggle="yes">φσ</italic> <sup>2</sup><italic toggle="yes">γv</italic>)<italic toggle="yes">v</italic> = 1 we find as above in <xref ref-type="disp-formula" rid="eqn15" hwp:id="xref-disp-formula-16-2" hwp:rel-id="disp-formula-16">(15)</xref>
<disp-formula id="eqn99" hwp:id="disp-formula-109"><alternatives hwp:id="alternatives-127"><graphic xlink:href="147728_eqn99.gif" position="float" orientation="portrait" hwp:id="graphic-115"/></alternatives></disp-formula></p></sec><sec id="s5f2" hwp:id="sec-37" hwp:rev-id="xref-sec-37-1"><label>5.6.2</label><title hwp:id="title-38">Secondary extinctions</title><p hwp:id="p-146">In the case of secondary extinctions following the extinction of species 0, the perturbation is
<disp-formula id="eqn100" hwp:id="disp-formula-110"><alternatives hwp:id="alternatives-128"><graphic xlink:href="147728_eqn100.gif" position="float" orientation="portrait" hwp:id="graphic-116"/></alternatives></disp-formula></p><p hwp:id="p-147">Now however, the perturbation is potentially large enough that we may need to impose <inline-formula hwp:id="inline-formula-19"><alternatives hwp:id="alternatives-129"><inline-graphic xlink:href="147728_inline17.gif" hwp:id="inline-graphic-19"/></alternatives></inline-formula>, meaning that the response cannot cause a species’ abundance to become negative. Hence, in a way similar to our previous calculation on abundances, the average change in abundance due to the extinction is
<disp-formula id="eqn101" hwp:id="disp-formula-111"><alternatives hwp:id="alternatives-130"><graphic xlink:href="147728_eqn101.gif" position="float" orientation="portrait" hwp:id="graphic-117"/></alternatives></disp-formula>
while the fraction of secondary extinctions is given by
<disp-formula id="eqn102" hwp:id="disp-formula-112"><alternatives hwp:id="alternatives-131"><graphic xlink:href="147728_eqn102.gif" position="float" orientation="portrait" hwp:id="graphic-118"/></alternatives></disp-formula></p></sec><sec id="s5f3" hwp:id="sec-38"><label>5.6.3</label><title hwp:id="title-39">Variability</title><p hwp:id="p-148">Calculations for the variability are more technical and left in Appendix.</p></sec></sec></sec><sec id="s6" hwp:id="sec-39" hwp:rev-id="xref-sec-39-1"><label>6</label><title hwp:id="title-40">Sensitivity testing</title><sec id="s6a" hwp:id="sec-40"><label>6.1</label><title hwp:id="title-41">Distributions</title><p hwp:id="p-149">In this section, we test how sensitive the results above are to the choice of distributions for growth rates and interactions. Throughout, we have assumed that these distributions had finite mean and variance, which is not the case for, e.g., a power-law tailed distribution P(x) <italic toggle="yes">~ x</italic><sup>−<italic toggle="yes">a</italic></sup> with exponent <italic toggle="yes">a ≤</italic> 3.</p><p hwp:id="p-150">For reasons explained in <xref ref-type="sec" rid="s5b" hwp:id="xref-sec-29-1" hwp:rel-id="sec-29">Sec. 5.2</xref> above, we expect results to be more sensitive to the distribution of growth rates than to that of interactions. Indeed, <xref ref-type="fig" rid="fig7" hwp:id="xref-fig-7-1" hwp:rel-id="F7">Fig. 7</xref> shows that, while Gaussian or uniform distributions lead to very good agreement with predictions, distributions with fatter tails (e.g. exponential tails) – and a fortiori multimodal distributions – lead to significant deviations from our baseline predictions. It is however not difficult to adapt the theory to fit any distribution <italic toggle="yes">P</italic>(<italic toggle="yes">R<sub>i</sub></italic>) as long as it is known.
<fig id="fig7" position="float" orientation="portrait" fig-type="figure" hwp:id="F7" hwp:rev-id="xref-fig-7-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;147728v3/FIG7</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F7</object-id><object-id pub-id-type="publisher-id">fig7</object-id><label>Figure 7:</label><caption hwp:id="caption-7"><p hwp:id="p-151">Sensitivity of results to distribution of growth rates <italic toggle="yes">P</italic>(<italic toggle="yes">R<sub>i</sub></italic>).</p></caption><graphic xlink:href="147728_fig7" position="float" orientation="portrait" hwp:id="graphic-119"/></fig></p></sec><sec id="s6b" hwp:id="sec-41"><label>6.2</label><title hwp:id="title-42">Interaction strength</title><p hwp:id="p-152">We now test how small the interaction strength must be compared to self-interaction for cavity predictions to work. <xref ref-type="fig" rid="fig8" hwp:id="xref-fig-8-1" hwp:rel-id="F8">Fig. 8</xref> shows that when average coupling strength is significantly larger than 0.1, the method stops being as accurate, in particular with fewer species surviving than expected.
<fig id="fig8" position="float" orientation="portrait" fig-type="figure" hwp:id="F8" hwp:rev-id="xref-fig-8-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;147728v3/FIG8</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F8</object-id><object-id pub-id-type="publisher-id">fig8</object-id><label>Figure 8:</label><caption hwp:id="caption-8"><p hwp:id="p-153">Sensitivity of results to interaction strength. By varying the connectivity from 0.1 to 1, we change the average interaction strength needed to achieve the same value of <italic toggle="yes">μ.</italic> Each curve is labelled here by the average coupling strength needed to obtain <italic toggle="yes">μ</italic> = 10.</p></caption><graphic xlink:href="147728_fig8" position="float" orientation="portrait" hwp:id="graphic-120"/></fig></p></sec></sec><sec id="s7" hwp:id="sec-42" hwp:rev-id="xref-sec-42-1"><label>7</label><title hwp:id="title-43">Extending the model</title><p hwp:id="p-154">There are two main types of limitations to the model so far. The first is dynamical: we started from Lotka-Volterra dynamics, which might work as an approximation in many limits, but do not always enable us to find the equilibria reached by more complex dynamics. Since the most usual variant to Lotka-Volterra dynamics is having a nonlinear functional response, especially a saturating one, we treat that case below to show that it is still largely amenable (at least approximately or qualitatively) to our approach.</p><p hwp:id="p-155">The second limitation is structural. Even though species are heterogeneous, we have treated them as if they all belong to the same functional group: their traits are all drawn from the same distributions. These distributions may be multimodal, but that does not convey the fact that different positions in the community may be truly different in many respects at once. There are two simple ways to address this concern, one discrete and one continuous.</p><p hwp:id="p-156">The continuous approximation, which we call “ordered species”, supposes that we can characterize the network by a simple axis of possible niches or roles, knowing only how various traits (e.g. carrying capacity, interaction mean and variance) correlate to linear order with position on that axis.</p><p hwp:id="p-157">The discrete approximation, which we call “species groups”, instead divides the network into distinct groups, each disordered inside, but with deterministic patterns within and between groups. In essence, this is extending simple reductionist descriptions (e.g. one predator and one prey) by replacing each species by a group of heterogeneous but functionally similar species, treated like a disordered community.</p><sec id="s7a" hwp:id="sec-43" hwp:rev-id="xref-sec-43-1"><label>7.1</label><title hwp:id="title-44">Functional response</title><p hwp:id="p-158">The coefficients <italic toggle="yes">A<sub>ij</sub></italic> come from two distinct factors: first, how much an <italic toggle="yes">individual</italic> of species <italic toggle="yes">i</italic> can affect an individual of species <italic toggle="yes">j</italic>, which may be a property of their behavior and biology, and second, how often these individuals may meet and interact. For simplicity, let us say that the individual-level effects are fixed. Then, the frequency of pair encounters is what controls interaction strength. The interaction between species <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> is independent from any other interaction in relatively “sparse” environments where any pair can meet, and adding new individuals or new species always increases the number of such meetings. On the other hand, interactions may saturate if there is a limiting factor such as plants competing only with their neighbors, or a predator taking time to handle prey, preventing it from consuming more than a given number of prey among those available in a given timespan.</p><p hwp:id="p-159">The same reasoning led Holling [<xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">14</xref>] to postulate a saturating functional response in the interaction between two species: instead of being a number, <italic toggle="yes">A<sub>ij</sub></italic> becomes a function of abundances such as
<disp-formula id="eqn103" hwp:id="disp-formula-113"><alternatives hwp:id="alternatives-132"><graphic xlink:href="147728_eqn103.gif" position="float" orientation="portrait" hwp:id="graphic-121"/></alternatives></disp-formula>
with constants <italic toggle="yes">A<sub>ij</sub></italic>, their average 〈<italic toggle="yes">A</italic>〉 and the population threshold <italic toggle="yes">N<sub>c</sub></italic>. This means that the interaction between species <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> cannot keep growing indefinitely with <italic toggle="yes">N<sub>i</sub>N<sub>j</sub></italic> the product of their abundances, as in Lotka-Volterra equations. Hence, the sum is bounded
<disp-formula id="eqn104" hwp:id="disp-formula-114"><alternatives hwp:id="alternatives-133"><graphic xlink:href="147728_eqn104.gif" position="float" orientation="portrait" hwp:id="graphic-122"/></alternatives></disp-formula>
<disp-formula id="eqn105" hwp:id="disp-formula-115"><alternatives hwp:id="alternatives-134"><graphic xlink:href="147728_eqn105.gif" position="float" orientation="portrait" hwp:id="graphic-123"/></alternatives></disp-formula></p><p hwp:id="p-160">Analytically, it is possible to deal with the saturating functional response by a simple approximation. For each species, we replace it with a piecewise linear function:
<disp-formula id="eqn106" hwp:id="disp-formula-116"><alternatives hwp:id="alternatives-135"><graphic xlink:href="147728_eqn106.gif" position="float" orientation="portrait" hwp:id="graphic-124"/></alternatives></disp-formula>
then at the community level, we use the real saturating function to evaluate the expected fraction <italic toggle="yes">f</italic> of species whose interactions are saturated.</p><p hwp:id="p-161">For simplicity, we will “cheat” and instead apply the piecewise functional response to the <italic toggle="yes">couplings</italic> (which differ from interactions if species have heterogeneous self-interaction <italic toggle="yes">D<sub>i</sub></italic>), i.e.
<disp-formula id="eqn107" hwp:id="disp-formula-117" hwp:rev-id="xref-disp-formula-117-1"><alternatives hwp:id="alternatives-136"><graphic xlink:href="147728_eqn107.gif" position="float" orientation="portrait" hwp:id="graphic-125"/></alternatives></disp-formula></p><p hwp:id="p-162">Avoiding this simplification is possible but requires keeping track of more parameters, and does not make much of a qualitative change.</p><p hwp:id="p-163">Going through the same steps as before, then for each species
<disp-formula id="eqn108" hwp:id="disp-formula-118"><alternatives hwp:id="alternatives-137"><graphic xlink:href="147728_eqn108.gif" position="float" orientation="portrait" hwp:id="graphic-126"/></alternatives></disp-formula></p><p hwp:id="p-164">Notice the 1 <bold><italic toggle="yes">–</italic></bold> <italic toggle="yes">f</italic> factor in front of the feedback term in the denominator: only species whose interactions have not saturated will contribute to the feedback of the invader on itself through its interaction partners. The mean is now
<disp-formula id="eqn109" hwp:id="disp-formula-119"><alternatives hwp:id="alternatives-138"><graphic xlink:href="147728_eqn109.gif" position="float" orientation="portrait" hwp:id="graphic-127"/></alternatives></disp-formula>
while taking the variance, we find
<disp-formula id="eqn110" hwp:id="disp-formula-120"><alternatives hwp:id="alternatives-139"><graphic xlink:href="147728_eqn110.gif" position="float" orientation="portrait" hwp:id="graphic-128"/></alternatives></disp-formula></p><p hwp:id="p-165">The rest of the calculations follow as in <xref ref-type="sec" rid="s5c" hwp:id="xref-sec-30-1" hwp:rel-id="sec-30">Sec. 5.3</xref>, except we additionally need to know the fraction <italic toggle="yes">f</italic> of species with saturated interactions. This is where the real saturation function reappears (slightly rearranged):
<disp-formula id="eqn111" hwp:id="disp-formula-121"><alternatives hwp:id="alternatives-140"><graphic xlink:href="147728_eqn111.gif" position="float" orientation="portrait" hwp:id="graphic-129"/></alternatives></disp-formula>
where, as usual, we can approximate <italic toggle="yes">P</italic>(<italic toggle="yes">x</italic>) by a Gaussian distribution with
<disp-formula id="eqn112" hwp:id="disp-formula-122"><alternatives hwp:id="alternatives-141"><graphic xlink:href="147728_eqn112.gif" position="float" orientation="portrait" hwp:id="graphic-130"/></alternatives></disp-formula>
<disp-formula id="eqn113" hwp:id="disp-formula-123"><alternatives hwp:id="alternatives-142"><graphic xlink:href="147728_eqn113.gif" position="float" orientation="portrait" hwp:id="graphic-131"/></alternatives></disp-formula></p><p hwp:id="p-166">Note that if we want to make an equivalent model without saturation, we can apply the equivalence
<disp-formula id="eqn114" hwp:id="disp-formula-124"><alternatives hwp:id="alternatives-143"><graphic xlink:href="147728_eqn114.gif" position="float" orientation="portrait" hwp:id="graphic-132"/></alternatives></disp-formula>
which is possible only if <inline-formula hwp:id="inline-formula-20"><alternatives hwp:id="alternatives-144"><inline-graphic xlink:href="147728_inline18.gif" hwp:id="inline-graphic-20"/></alternatives></inline-formula>. Then, a Lotka-Volterra system with parameters <inline-formula hwp:id="inline-formula-21"><alternatives hwp:id="alternatives-145"><inline-graphic xlink:href="147728_inline19.gif" hwp:id="inline-graphic-21"/></alternatives></inline-formula>, <inline-formula hwp:id="inline-formula-22"><alternatives hwp:id="alternatives-146"><inline-graphic xlink:href="147728_inline20.gif" hwp:id="inline-graphic-22"/></alternatives></inline-formula> and <inline-formula hwp:id="inline-formula-23"><alternatives hwp:id="alternatives-147"><inline-graphic xlink:href="147728_inline21.gif" hwp:id="inline-graphic-23"/></alternatives></inline-formula> will have identical equilibrium properties to the system with a saturating functional response studied here. Of course, this equivalence can only be computed once we know <italic toggle="yes">f</italic> and 〈<italic toggle="yes">N</italic> 〉*, i.e. after having solved the calculation above for this system.</p><p hwp:id="p-167">In <xref ref-type="fig" rid="fig9" hwp:id="xref-fig-9-1" hwp:rel-id="F9">Fig. 9</xref>, we show that predictions from our calculations match simulation results quite well, despite many simplifications which tend to create a more abrupt transition between the saturated and unsaturated regimes. By the same reasoning, we can easily extend the approach to any functional response, including an approximation of Type-III sigmoid response, with two thresholds instead of a single one.
<fig id="fig9" position="float" orientation="portrait" fig-type="figure" hwp:id="F9" hwp:rev-id="xref-fig-9-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;147728v3/FIG9</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F9</object-id><object-id pub-id-type="publisher-id">fig9</object-id><label>Figure 9:</label><caption hwp:id="caption-9"><p hwp:id="p-168">Effect of saturating functional response. Symbols are simulations with a Holling Type II functional response, while solid lines are analytical predictions using the approximate linear-saturating functional response <xref ref-type="disp-formula" rid="eqn107" hwp:id="xref-disp-formula-117-1" hwp:rel-id="disp-formula-117">(107)</xref>.</p></caption><graphic xlink:href="147728_fig9" position="float" orientation="portrait" hwp:id="graphic-133"/></fig></p></sec><sec id="s7b" hwp:id="sec-44"><label>7.2</label><title hwp:id="title-45">Heterogeneous means</title><p hwp:id="p-169">Let us come back to the cavity method:
<disp-formula id="eqn115" hwp:id="disp-formula-125"><alternatives hwp:id="alternatives-148"><graphic xlink:href="147728_eqn115.gif" position="float" orientation="portrait" hwp:id="graphic-134"/></alternatives></disp-formula></p><p hwp:id="p-170">Now let us assume that
<disp-formula id="eqn116" hwp:id="disp-formula-126"><alternatives hwp:id="alternatives-149"><graphic xlink:href="147728_eqn116.gif" position="float" orientation="portrait" hwp:id="graphic-135"/></alternatives></disp-formula>
where the mean and the variance both depend on species 0.
<disp-formula id="eqn117" hwp:id="disp-formula-127"><alternatives hwp:id="alternatives-150"><graphic xlink:href="147728_eqn117.gif" position="float" orientation="portrait" hwp:id="graphic-136"/></alternatives></disp-formula>
where we still assume that 〈<italic toggle="yes">N</italic>〉 over partners of 0 does not differ from the community average. Then,
<disp-formula id="eqn118" hwp:id="disp-formula-128"><alternatives hwp:id="alternatives-151"><graphic xlink:href="147728_eqn118.gif" position="float" orientation="portrait" hwp:id="graphic-137"/></alternatives></disp-formula>
hence
<disp-formula id="eqn119" hwp:id="disp-formula-129"><alternatives hwp:id="alternatives-152"><graphic xlink:href="147728_eqn119.gif" position="float" orientation="portrait" hwp:id="graphic-138"/></alternatives></disp-formula>
<disp-formula id="eqn120" hwp:id="disp-formula-130"><alternatives hwp:id="alternatives-153"><graphic xlink:href="147728_eqn120.gif" position="float" orientation="portrait" hwp:id="graphic-139"/></alternatives></disp-formula>
where
<disp-formula id="eqn121" hwp:id="disp-formula-131"><alternatives hwp:id="alternatives-154"><graphic xlink:href="147728_eqn121.gif" position="float" orientation="portrait" hwp:id="graphic-140"/></alternatives></disp-formula>
and finally
<disp-formula id="eqn122" hwp:id="disp-formula-132"><alternatives hwp:id="alternatives-155"><graphic xlink:href="147728_eqn122.gif" position="float" orientation="portrait" hwp:id="graphic-141"/></alternatives></disp-formula>
<disp-formula id="eqn123" hwp:id="disp-formula-133"><alternatives hwp:id="alternatives-156"><graphic xlink:href="147728_eqn123.gif" position="float" orientation="portrait" hwp:id="graphic-142"/></alternatives></disp-formula></p></sec><sec id="s7c" hwp:id="sec-45"><label>7.3</label><title hwp:id="title-46">Species groups</title><p hwp:id="p-171">The equations can be extended to any structure comprised of discrete groups, with disordered interactions within and between groups, but different statistics for each set of interactions. Coming back to the equilibrium equation, we can write for species <italic toggle="yes">i</italic> in group <italic toggle="yes">x</italic> (which contains <italic toggle="yes">S<sup>x</sup></italic> species) as
<disp-formula id="eqn124" hwp:id="disp-formula-134"><alternatives hwp:id="alternatives-157"><graphic xlink:href="147728_eqn124.gif" position="float" orientation="portrait" hwp:id="graphic-143"/></alternatives></disp-formula></p><p hwp:id="p-172">Thus, we now have vector <bold>K</bold> and <italic toggle="yes">ζ</italic> and matrices <bold><italic toggle="yes">μ, σ, γ,</italic></bold> defined by
<disp-formula id="eqn125" hwp:id="disp-formula-135"><alternatives hwp:id="alternatives-158"><graphic xlink:href="147728_eqn125.gif" position="float" orientation="portrait" hwp:id="graphic-144"/></alternatives></disp-formula>
with
<disp-formula id="eqn126" hwp:id="disp-formula-136"><alternatives hwp:id="alternatives-159"><graphic xlink:href="147728_eqn126.gif" position="float" orientation="portrait" hwp:id="graphic-145"/></alternatives></disp-formula></p><p hwp:id="p-173">The equations to solve are the same as above, except there are now four equations per group, all coupled: for each group we solve
<disp-formula id="eqn127" hwp:id="disp-formula-137"><alternatives hwp:id="alternatives-160"><graphic xlink:href="147728_eqn127.gif" position="float" orientation="portrait" hwp:id="graphic-146"/></alternatives></disp-formula>
<disp-formula id="eqn128" hwp:id="disp-formula-138"><alternatives hwp:id="alternatives-161"><graphic xlink:href="147728_eqn128.gif" position="float" orientation="portrait" hwp:id="graphic-147"/></alternatives></disp-formula>
<disp-formula id="eqn129" hwp:id="disp-formula-139"><alternatives hwp:id="alternatives-162"><graphic xlink:href="147728_eqn129.gif" position="float" orientation="portrait" hwp:id="graphic-148"/></alternatives></disp-formula>
<disp-formula id="eqn130" hwp:id="disp-formula-140"><alternatives hwp:id="alternatives-163"><graphic xlink:href="147728_eqn130.gif" position="float" orientation="portrait" hwp:id="graphic-149"/></alternatives></disp-formula>
with
<disp-formula id="eqn131" hwp:id="disp-formula-141"><alternatives hwp:id="alternatives-164"><graphic xlink:href="147728_eqn131.gif" position="float" orientation="portrait" hwp:id="graphic-150"/></alternatives></disp-formula>
<disp-formula id="eqn132" hwp:id="disp-formula-142"><alternatives hwp:id="alternatives-165"><graphic xlink:href="147728_eqn132.gif" position="float" orientation="portrait" hwp:id="graphic-151"/></alternatives></disp-formula>
<disp-formula id="eqn133" hwp:id="disp-formula-143"><alternatives hwp:id="alternatives-166"><graphic xlink:href="147728_eqn133.gif" position="float" orientation="portrait" hwp:id="graphic-152"/></alternatives></disp-formula>
where
<disp-formula id="eqn134" hwp:id="disp-formula-144"><alternatives hwp:id="alternatives-167"><graphic xlink:href="147728_eqn134.gif" position="float" orientation="portrait" hwp:id="graphic-153"/></alternatives></disp-formula></p></sec><sec id="s7d" hwp:id="sec-46" hwp:rev-id="xref-sec-46-1"><label>7.4</label><title hwp:id="title-47">Ordered species</title><p hwp:id="p-174">We can take the continuous limit of the mixture model:
<disp-formula id="eqn135" hwp:id="disp-formula-145"><alternatives hwp:id="alternatives-168"><graphic xlink:href="147728_eqn135.gif" position="float" orientation="portrait" hwp:id="graphic-154"/></alternatives></disp-formula>
<disp-formula id="eqn136" hwp:id="disp-formula-146"><alternatives hwp:id="alternatives-169"><graphic xlink:href="147728_eqn136.gif" position="float" orientation="portrait" hwp:id="graphic-155"/></alternatives></disp-formula>
<disp-formula id="eqn137" hwp:id="disp-formula-147"><alternatives hwp:id="alternatives-170"><graphic xlink:href="147728_eqn137.gif" position="float" orientation="portrait" hwp:id="graphic-156"/></alternatives></disp-formula>
<disp-formula id="eqn138" hwp:id="disp-formula-148"><alternatives hwp:id="alternatives-171"><graphic xlink:href="147728_eqn138.gif" position="float" orientation="portrait" hwp:id="graphic-157"/></alternatives></disp-formula>
with <italic toggle="yes">P</italic><sub>0</sub>(<italic toggle="yes">n</italic>, <italic toggle="yes">x</italic>) a Gaussian with mean 〈<italic toggle="yes">N</italic><sub>0</sub>〉 (<italic toggle="yes">x</italic>) and variance <inline-formula hwp:id="inline-formula-24"><alternatives hwp:id="alternatives-172"><inline-graphic xlink:href="147728_inline22.gif" hwp:id="inline-graphic-24"/></alternatives></inline-formula>, given by
<disp-formula id="eqn139" hwp:id="disp-formula-149"><alternatives hwp:id="alternatives-173"><graphic xlink:href="147728_eqn139.gif" position="float" orientation="portrait" hwp:id="graphic-158"/></alternatives></disp-formula>
<disp-formula id="eqn140" hwp:id="disp-formula-150"><alternatives hwp:id="alternatives-174"><graphic xlink:href="147728_eqn140.gif" position="float" orientation="portrait" hwp:id="graphic-159"/></alternatives></disp-formula>
<disp-formula id="eqn141" hwp:id="disp-formula-151"><alternatives hwp:id="alternatives-175"><graphic xlink:href="147728_eqn141.gif" position="float" orientation="portrait" hwp:id="graphic-160"/></alternatives></disp-formula>
where <italic toggle="yes">ρ</italic>(<italic toggle="yes">x</italic>) is the density of species with rank <italic toggle="yes">x.</italic></p><p hwp:id="p-175">There are two cases that allow for a simple solution: first, if all functions depend only on <italic toggle="yes">x.</italic> Second, if all functions of <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic> depend only on the difference <italic toggle="yes">x − y</italic>, and these functions are either exponential or linear, see results in <xref ref-type="fig" rid="fig10" hwp:id="xref-fig-10-1" hwp:rel-id="F10">Fig. 10</xref>. By construction, in all these situation <italic toggle="yes">γ</italic>(<italic toggle="yes">x</italic>, <italic toggle="yes">y</italic>) = <italic toggle="yes">γ</italic>(<italic toggle="yes">y</italic>, <italic toggle="yes">x</italic>) must be a constant.
<fig id="fig10" position="float" orientation="portrait" fig-type="figure" hwp:id="F10" hwp:rev-id="xref-fig-10-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;147728v3/FIG10</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F10</object-id><object-id pub-id-type="publisher-id">fig10</object-id><label>Figure 10:</label><caption hwp:id="caption-10"><p hwp:id="p-176">Results for ordered species with exponential and linear scaling. The bottom-right panel is 〈<italic toggle="yes">x</italic>〉<italic toggle="yes">*</italic> the average value of the niche value for surviving species, given that niche values are initially distributed uniformly over [0, 1].</p></caption><graphic xlink:href="147728_fig10" position="float" orientation="portrait" hwp:id="graphic-161"/></fig></p></sec><sec id="s7e" hwp:id="sec-47"><label>7.5</label><title hwp:id="title-48">One-sided order</title><p hwp:id="p-177">We call one-sided order the situation where functions of <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic> depend only on <italic toggle="yes">x.</italic>
<disp-formula id="eqn142" hwp:id="disp-formula-152"><alternatives hwp:id="alternatives-176"><graphic xlink:href="147728_eqn142.gif" position="float" orientation="portrait" hwp:id="graphic-162"/></alternatives></disp-formula>
<disp-formula id="eqn143" hwp:id="disp-formula-153"><alternatives hwp:id="alternatives-177"><graphic xlink:href="147728_eqn143.gif" position="float" orientation="portrait" hwp:id="graphic-163"/></alternatives></disp-formula>
<disp-formula id="eqn144" hwp:id="disp-formula-154"><alternatives hwp:id="alternatives-178"><graphic xlink:href="147728_eqn144.gif" position="float" orientation="portrait" hwp:id="graphic-164"/></alternatives></disp-formula>
<disp-formula id="eqn145" hwp:id="disp-formula-155"><alternatives hwp:id="alternatives-179"><graphic xlink:href="147728_eqn145.gif" position="float" orientation="portrait" hwp:id="graphic-165"/></alternatives></disp-formula></p><p hwp:id="p-178">Then, we have
<disp-formula id="eqn146" hwp:id="disp-formula-156"><alternatives hwp:id="alternatives-180"><graphic xlink:href="147728_eqn146.gif" position="float" orientation="portrait" hwp:id="graphic-166"/></alternatives></disp-formula>
<disp-formula id="eqn147" hwp:id="disp-formula-157"><alternatives hwp:id="alternatives-181"><graphic xlink:href="147728_eqn147.gif" position="float" orientation="portrait" hwp:id="graphic-167"/></alternatives></disp-formula>
<disp-formula id="eqn148" hwp:id="disp-formula-158"><alternatives hwp:id="alternatives-182"><graphic xlink:href="147728_eqn148.gif" position="float" orientation="portrait" hwp:id="graphic-168"/></alternatives></disp-formula>
and we can compute
<disp-formula id="eqn149" hwp:id="disp-formula-159"><alternatives hwp:id="alternatives-183"><graphic xlink:href="147728_eqn149.gif" position="float" orientation="portrait" hwp:id="graphic-169"/></alternatives></disp-formula>
<disp-formula id="eqn150" hwp:id="disp-formula-160"><alternatives hwp:id="alternatives-184"><graphic xlink:href="147728_eqn150.gif" position="float" orientation="portrait" hwp:id="graphic-170"/></alternatives></disp-formula>
<disp-formula id="eqn151" hwp:id="disp-formula-161"><alternatives hwp:id="alternatives-185"><graphic xlink:href="147728_eqn151.gif" position="float" orientation="portrait" hwp:id="graphic-171"/></alternatives></disp-formula></p><p hwp:id="p-179">For instance, we can build a tradeoff reminiscent of competition-colonization models by having
<disp-formula id="eqn152" hwp:id="disp-formula-162"><alternatives hwp:id="alternatives-186"><graphic xlink:href="147728_eqn152.gif" position="float" orientation="portrait" hwp:id="graphic-172"/></alternatives></disp-formula>
<disp-formula id="eqn153" hwp:id="disp-formula-163"><alternatives hwp:id="alternatives-187"><graphic xlink:href="147728_eqn153.gif" position="float" orientation="portrait" hwp:id="graphic-173"/></alternatives></disp-formula>
with <italic toggle="yes">μ &gt;</italic> 0 and <italic toggle="yes">σ</italic> and <italic toggle="yes">ζ</italic> constant. In this case, low rank <italic toggle="yes">x</italic> corresponds to high competitive ability (no competition experienced) but low colonization ability.</p><sec id="s7e1" hwp:id="sec-48"><label>7.5.1</label><title hwp:id="title-49">Exponential order</title><p hwp:id="p-180">We can choose exponential functions
<disp-formula id="eqn154" hwp:id="disp-formula-164"><alternatives hwp:id="alternatives-188"><graphic xlink:href="147728_eqn154.gif" position="float" orientation="portrait" hwp:id="graphic-174"/></alternatives></disp-formula>
<disp-formula id="eqn155" hwp:id="disp-formula-165"><alternatives hwp:id="alternatives-189"><graphic xlink:href="147728_eqn155.gif" position="float" orientation="portrait" hwp:id="graphic-175"/></alternatives></disp-formula>
<disp-formula id="eqn156" hwp:id="disp-formula-166"><alternatives hwp:id="alternatives-190"><graphic xlink:href="147728_eqn156.gif" position="float" orientation="portrait" hwp:id="graphic-176"/></alternatives></disp-formula>
<disp-formula id="eqn157" hwp:id="disp-formula-167"><alternatives hwp:id="alternatives-191"><graphic xlink:href="147728_eqn157.gif" position="float" orientation="portrait" hwp:id="graphic-177"/></alternatives></disp-formula></p><p hwp:id="p-181">Then, we have
<disp-formula id="eqn158" hwp:id="disp-formula-168"><alternatives hwp:id="alternatives-192"><graphic xlink:href="147728_eqn158.gif" position="float" orientation="portrait" hwp:id="graphic-178"/></alternatives></disp-formula>
<disp-formula id="eqn159" hwp:id="disp-formula-169"><alternatives hwp:id="alternatives-193"><graphic xlink:href="147728_eqn159.gif" position="float" orientation="portrait" hwp:id="graphic-179"/></alternatives></disp-formula>
<disp-formula id="eqn160" hwp:id="disp-formula-170"><alternatives hwp:id="alternatives-194"><graphic xlink:href="147728_eqn160.gif" position="float" orientation="portrait" hwp:id="graphic-180"/></alternatives></disp-formula>
and therefore we must compute
<disp-formula id="eqn161" hwp:id="disp-formula-171"><alternatives hwp:id="alternatives-195"><graphic xlink:href="147728_eqn161.gif" position="float" orientation="portrait" hwp:id="graphic-181"/></alternatives></disp-formula>
<disp-formula id="eqn162" hwp:id="disp-formula-172"><alternatives hwp:id="alternatives-196"><graphic xlink:href="147728_eqn162.gif" position="float" orientation="portrait" hwp:id="graphic-182"/></alternatives></disp-formula>
<disp-formula id="eqn163" hwp:id="disp-formula-173"><alternatives hwp:id="alternatives-197"><graphic xlink:href="147728_eqn163.gif" position="float" orientation="portrait" hwp:id="graphic-183"/></alternatives></disp-formula>
to close the equations. A typical example is metabolic scaling in trophic interactions: given metabolic rate <italic toggle="yes">m<sub>i</sub></italic> and its scaling with to bodymass <italic toggle="yes">M<sub>i</sub></italic>, <inline-formula hwp:id="inline-formula-25"><alternatives hwp:id="alternatives-198"><inline-graphic xlink:href="147728_inline23.gif" hwp:id="inline-graphic-25"/></alternatives></inline-formula>, we expect self-interaction <italic toggle="yes">D<sub>i</sub></italic> ∝ <italic toggle="yes">m<sub>i</sub></italic> and interaction <italic toggle="yes">A<sub>ji</sub></italic> ∝ <italic toggle="yes">m<sub>j</sub></italic>, hence <italic toggle="yes">a<sub>ji</sub></italic> ∝ <italic toggle="yes">m<sub>j</sub></italic>/<italic toggle="yes">m<sub>i</sub></italic> = (1/4)<italic toggle="yes"><sup>x</sup></italic><sup>−<italic toggle="yes">y</italic></sup> with the niche values given by the logarithm of body mass <italic toggle="yes">x</italic> = log <italic toggle="yes">M<sub>i</sub></italic> and <italic toggle="yes">y</italic> = log <italic toggle="yes">M<sub>j</sub></italic>.</p></sec><sec id="s7e2" hwp:id="sec-49"><label>7.5.2</label><title hwp:id="title-50">Linear order</title><p hwp:id="p-182">If we choose linear functions instead
<disp-formula id="eqn164" hwp:id="disp-formula-174"><alternatives hwp:id="alternatives-199"><graphic xlink:href="147728_eqn164.gif" position="float" orientation="portrait" hwp:id="graphic-184"/></alternatives></disp-formula>
<disp-formula id="eqn165" hwp:id="disp-formula-175"><alternatives hwp:id="alternatives-200"><graphic xlink:href="147728_eqn165.gif" position="float" orientation="portrait" hwp:id="graphic-185"/></alternatives></disp-formula>
<disp-formula id="eqn166" hwp:id="disp-formula-176"><alternatives hwp:id="alternatives-201"><graphic xlink:href="147728_eqn166.gif" position="float" orientation="portrait" hwp:id="graphic-186"/></alternatives></disp-formula>
<disp-formula id="eqn167" hwp:id="disp-formula-177"><alternatives hwp:id="alternatives-202"><graphic xlink:href="147728_eqn167.gif" position="float" orientation="portrait" hwp:id="graphic-187"/></alternatives></disp-formula></p><p hwp:id="p-183">Then we have
<disp-formula id="eqn168" hwp:id="disp-formula-178"><alternatives hwp:id="alternatives-203"><graphic xlink:href="147728_eqn168.gif" position="float" orientation="portrait" hwp:id="graphic-188"/></alternatives></disp-formula>
<disp-formula id="eqn169" hwp:id="disp-formula-179"><alternatives hwp:id="alternatives-204"><graphic xlink:href="147728_eqn169.gif" position="float" orientation="portrait" hwp:id="graphic-189"/></alternatives></disp-formula>
<disp-formula id="eqn170" hwp:id="disp-formula-180"><alternatives hwp:id="alternatives-205"><graphic xlink:href="147728_eqn170.gif" position="float" orientation="portrait" hwp:id="graphic-190"/></alternatives></disp-formula></p><p hwp:id="p-184">(in fact <inline-formula hwp:id="inline-formula-26"><alternatives hwp:id="alternatives-206"><inline-graphic xlink:href="147728_inline24.gif" hwp:id="inline-graphic-26"/></alternatives></inline-formula> but this makes separation impossible, so we must assume that <italic toggle="yes">c<sub>σ</sub></italic> is small enough). Hence there are two sets of coupled unknowns: for Ψ = <italic toggle="yes">N</italic>, <italic toggle="yes">N</italic><sup>2</sup>, <italic toggle="yes">V</italic> we must compute
<disp-formula id="eqn171" hwp:id="disp-formula-181"><alternatives hwp:id="alternatives-207"><graphic xlink:href="147728_eqn171.gif" position="float" orientation="portrait" hwp:id="graphic-191"/></alternatives></disp-formula>
and (except for <italic toggle="yes">V</italic>),
<disp-formula id="eqn172" hwp:id="disp-formula-182"><alternatives hwp:id="alternatives-208"><graphic xlink:href="147728_eqn172.gif" position="float" orientation="portrait" hwp:id="graphic-192"/></alternatives></disp-formula></p></sec></sec></sec></body><back><ref-list hwp:id="ref-list-1"><title hwp:id="title-51">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1 xref-ref-1-2 xref-ref-1-3"><label>[1]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.1" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Allesina Stefano"><given-names>Stefano</given-names> <surname>Allesina</surname></string-name> and <string-name name-style="western" hwp:sortable="Si Tang"><surname>Si</surname> <given-names>Tang</given-names></string-name>. <article-title hwp:id="article-title-2">Stability criteria for complex ecosystems</article-title>. <source hwp:id="source-1">Nature</source>, <volume>483</volume>(<issue>7388</issue>):<fpage>205</fpage>–<lpage>208</lpage>, <year>2012</year>.</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1"><label>[2]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="Arnoldi Jean-François"><given-names>Jean-François</given-names> <surname>Arnoldi</surname></string-name>, <string-name name-style="western" hwp:sortable="Loreau Michel"><given-names>Michel</given-names> <surname>Loreau</surname></string-name>, and <string-name name-style="western" hwp:sortable="Haegeman Bart"><given-names>Bart</given-names> <surname>Haegeman</surname></string-name>. <article-title hwp:id="article-title-3">Resilience, reactivity and variability: A mathematical comparison of ecological stability measures</article-title>. <source hwp:id="source-2">Journal of theoretical biology</source>, <volume>389</volume>:<fpage>47</fpage>–<lpage>59</lpage>, <year>2016</year>.</citation></ref><ref id="c3" hwp:id="ref-3" hwp:rev-id="xref-ref-3-1"><label>[3]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.3" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Barbier Matthieu"><given-names>Matthieu</given-names> <surname>Barbier</surname></string-name>, <string-name name-style="western" hwp:sortable="Arnoldi Jeff"><given-names>Jeff</given-names> <surname>Arnoldi</surname></string-name>, and <string-name name-style="western" hwp:sortable="Bunin Guy"><given-names>Guy</given-names> <surname>Bunin</surname></string-name>. <article-title hwp:id="article-title-4">Generic assembly patterns in large ecological communities</article-title>. <source hwp:id="source-3">bioRxiv preprint 145862</source>, <year>2017</year>.</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1 xref-ref-4-2 xref-ref-4-3"><label>[4]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.4" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Barbier Matthieu"><given-names>Matthieu</given-names> <surname>Barbier</surname></string-name>, <string-name name-style="western" hwp:sortable="Arnoldi Jeff"><given-names>Jeff</given-names> <surname>Arnoldi</surname></string-name>, <string-name name-style="western" hwp:sortable="Loreau Michel"><given-names>Michel</given-names> <surname>Loreau</surname></string-name>, and <string-name name-style="western" hwp:sortable="Bunin Guy"><given-names>Guy</given-names> <surname>Bunin</surname></string-name>. <source hwp:id="source-4">Generic assembly patterns in large ecological communities</source>. <year>2017</year>.</citation></ref><ref id="c5" hwp:id="ref-5" hwp:rev-id="xref-ref-5-1"><label>[5]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.5" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Bascompte Jordi"><given-names>Jordi</given-names> <surname>Bascompte</surname></string-name> and <string-name name-style="western" hwp:sortable="Stouffer Daniel B"><given-names>Daniel B</given-names> <surname>Stouffer</surname></string-name>. <article-title hwp:id="article-title-5">The assembly and disassembly of ecological networks</article-title>. <source hwp:id="source-5">Philosophical Transactions of the Royal Society of London B: Biological Sciences</source>, <volume>364</volume>(<issue>1524</issue>):<fpage>1781</fpage>–<lpage>1787</lpage>, <year>2009</year>.</citation></ref><ref id="c6" hwp:id="ref-6" hwp:rev-id="xref-ref-6-1 xref-ref-6-2 xref-ref-6-3 xref-ref-6-4 xref-ref-6-5"><label>[6]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.6" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Bunin Guy"><given-names>Guy</given-names> <surname>Bunin</surname></string-name>. <article-title hwp:id="article-title-6">Interaction patterns and diversity in assembled ecological communities</article-title>. <source hwp:id="source-6">arXiv preprint arXiv:1 607.04734</source>, <year>2016</year>.</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1 xref-ref-7-2"><label>[7]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.7" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Bunin Guy"><given-names>Guy</given-names> <surname>Bunin</surname></string-name>. <article-title hwp:id="article-title-7">Ecological communities with lotka-volterra dynamics</article-title>. <source hwp:id="source-7">Physical Review E</source>, <volume>95</volume>(<issue>4</issue>):<fpage>042414, 2017</fpage>.</citation></ref><ref id="c8" hwp:id="ref-8" hwp:rev-id="xref-ref-8-1"><label>[8]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Gandhi Amar"><given-names>Amar</given-names> <surname>Gandhi</surname></string-name>, <string-name name-style="western" hwp:sortable="Levin Simon"><given-names>Simon</given-names> <surname>Levin</surname></string-name>, and <string-name name-style="western" hwp:sortable="Orszag Steven"><given-names>Steven</given-names> <surname>Orszag</surname></string-name>. <article-title hwp:id="article-title-8">Moment expansions in spatial ecological models and moment closure through gaussian approximation</article-title>. <source hwp:id="source-8">Bulletin of mathematical biology</source>, <volume>62</volume>(<issue>4</issue>):<fpage>595</fpage>–<lpage>632</lpage>, <year>2000</year>.</citation></ref><ref id="c9" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1"><label>[9]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.9" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Gao Jianxi"><given-names>Jianxi</given-names> <surname>Gao</surname></string-name>, <string-name name-style="western" hwp:sortable="Barzel Baruch"><given-names>Baruch</given-names> <surname>Barzel</surname></string-name>, and <string-name name-style="western" hwp:sortable="Barabási Albert-László"><given-names>Albert-László</given-names> <surname>Barabási</surname></string-name>. <article-title hwp:id="article-title-9">Universal resilience patterns in complex networks</article-title>. <source hwp:id="source-9">Nature</source>, <volume>530</volume>(<issue>7590</issue>):<fpage>307</fpage>–<lpage>312</lpage>, <year>2016</year>.</citation></ref><ref id="c10" hwp:id="ref-10" hwp:rev-id="xref-ref-10-1"><label>[10]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="Gatto M"><given-names>M</given-names> <surname>Gatto</surname></string-name>. <article-title hwp:id="article-title-10">A general minimum principle for competing populations: Some ecological and evolutionary consequences</article-title>. <source hwp:id="source-10">Theoretical Population Biology</source>, <volume>37</volume>(<issue>3</issue>):<fpage>369</fpage>–<lpage>388</lpage>, <year>1990</year>.</citation></ref><ref id="c11" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1 xref-ref-11-2"><label>[11]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.11" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="Gravel Dominique"><given-names>Dominique</given-names> <surname>Gravel</surname></string-name>, <string-name name-style="western" hwp:sortable="Massol François"><given-names>François</given-names> <surname>Massol</surname></string-name>, <string-name name-style="western" hwp:sortable="Canard Elsa"><given-names>Elsa</given-names> <surname>Canard</surname></string-name>, <string-name name-style="western" hwp:sortable="Mouillot David"><given-names>David</given-names> <surname>Mouillot</surname></string-name>, and <string-name name-style="western" hwp:sortable="Mouquet Nicolas"><given-names>Nicolas</given-names> <surname>Mouquet</surname></string-name>. <article-title hwp:id="article-title-11">Trophic theory of island biogeography</article-title>. <source hwp:id="source-11">Ecology letters</source>, <volume>14</volume>(<issue>10</issue>):<fpage>1010</fpage>–<lpage>1016</lpage>, <year>2011</year>.</citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1"><label>[12]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.12" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Grilli Jacopo"><given-names>Jacopo</given-names> <surname>Grilli</surname></string-name>, <string-name name-style="western" hwp:sortable="Rogers Tim"><given-names>Tim</given-names> <surname>Rogers</surname></string-name>, and <string-name name-style="western" hwp:sortable="Allesina Stefano"><given-names>Stefano</given-names> <surname>Allesina</surname></string-name>. <article-title hwp:id="article-title-12">Modularity and stability in ecological communities</article-title>. <source hwp:id="source-12">Nature communications</source>, <fpage>7</fpage>, <year>2016</year>.</citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1"><label>[13]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.13" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="Nathaniel Holland J"><given-names>J</given-names> <surname>Nathaniel Holland</surname></string-name>, <string-name name-style="western" hwp:sortable="DeAngelis Donald L"><given-names>Donald L</given-names> <surname>DeAngelis</surname></string-name>, and <string-name name-style="western" hwp:sortable="Bronstein Judith L"><given-names>Judith L</given-names> <surname>Bronstein</surname></string-name>. <article-title hwp:id="article-title-13">Population dynamics and mutualism: functional responses of benefits and costs</article-title>. <source hwp:id="source-13">The American Naturalist</source>, <volume>159</volume>(<issue>3</issue>):<fpage>231</fpage>–<lpage>244</lpage>, <year>2002</year>.</citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1"><label>[14]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.14" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Holling Crawford Stanley"><given-names>Crawford Stanley</given-names> <surname>Holling</surname></string-name>. <article-title hwp:id="article-title-14">The functional response of predators to prey density and its role in mimicry and population regulation</article-title>. <source hwp:id="source-14">Memoirs of the Entomological Society of Canada</source>, <volume>97</volume>(<issue>S45</issue>):<fpage>5</fpage>–<lpage>60</lpage>, <year>1965</year>.</citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1 xref-ref-15-2"><label>[15]</label><citation publication-type="book" citation-type="book" ref:id="147728v3.15" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Holt Robert D"><given-names>Robert D</given-names> <surname>Holt</surname></string-name>. <chapter-title>Community modules</chapter-title>. In <source hwp:id="source-15">Multitrophic interactions in terrestrial ecosystems, 36th Symposium of the British Ecological Society</source>, pages <fpage>333</fpage>–<lpage>349</lpage>. <publisher-name>Blackwell Science Oxford</publisher-name>, <year>1997</year>.</citation></ref><ref id="c16" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1 xref-ref-16-2 xref-ref-16-3"><label>[16]</label><citation publication-type="book" citation-type="book" ref:id="147728v3.16" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Hubbell Stephen P"><given-names>Stephen P</given-names> <surname>Hubbell</surname></string-name>. <source hwp:id="source-16">The unified neutral theory of species abundance and diversity</source>. <publisher-name>Princeton University Press</publisher-name>, <publisher-loc>Princeton</publisher-loc>, <year>2001</year>.</citation></ref><ref id="c17" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1 xref-ref-17-2"><label>[17]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.17" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="Jansen Vincent AA"><given-names>Vincent AA</given-names> <surname>Jansen</surname></string-name> and <string-name name-style="western" hwp:sortable="Kokkoris Giorgos D"><given-names>Giorgos D</given-names> <surname>Kokkoris</surname></string-name>. <article-title hwp:id="article-title-15">Complexity and stability revisited</article-title>. <source hwp:id="source-17">Ecology Letters</source>, <volume>6</volume>(<issue>6</issue>):<fpage>498</fpage>–<lpage>502</lpage>, <year>2003</year>.</citation></ref><ref id="c18" hwp:id="ref-18" hwp:rev-id="xref-ref-18-1 xref-ref-18-2 xref-ref-18-3 xref-ref-18-4 xref-ref-18-5"><label>[18]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.18" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-18"><string-name name-style="western" hwp:sortable="Kessler David A"><given-names>David A</given-names> <surname>Kessler</surname></string-name> and <string-name name-style="western" hwp:sortable="Shnerb Nadav M"><given-names>Nadav M</given-names> <surname>Shnerb</surname></string-name>. <article-title hwp:id="article-title-16">Generalized model of island biodiversity</article-title>. <source hwp:id="source-18">Physical Review E</source>, <volume>91</volume>(<issue>4</issue>):<fpage>042705, 2015</fpage>.</citation></ref><ref id="c19" hwp:id="ref-19" hwp:rev-id="xref-ref-19-1"><label>[19]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.19" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-19"><string-name name-style="western" hwp:sortable="Levins Richard"><given-names>Richard</given-names> <surname>Levins</surname></string-name> and <string-name name-style="western" hwp:sortable="Culver David"><given-names>David</given-names> <surname>Culver</surname></string-name>. <article-title hwp:id="article-title-17">Regional coexistence of species and competition between rare species</article-title>. <source hwp:id="source-19">Proceedings of the National Academy of Sciences</source>, <volume>68</volume>(<issue>6</issue>):<fpage>1246</fpage>–<lpage>1248</lpage>, <year>1971</year>.</citation></ref><ref id="c20" hwp:id="ref-20" hwp:rev-id="xref-ref-20-1"><label>[20]</label><citation publication-type="book" citation-type="book" ref:id="147728v3.20" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-20"><string-name name-style="western" hwp:sortable="Loreau Michel"><given-names>Michel</given-names> <surname>Loreau</surname></string-name>. <source hwp:id="source-20">From populations to ecosystems: Theoretical foundations for a new ecological synthesis</source>. <publisher-name>Princeton University Press</publisher-name>, <year>2010</year>.</citation></ref><ref id="c21" hwp:id="ref-21" hwp:rev-id="xref-ref-21-1 xref-ref-21-2 xref-ref-21-3"><label>[21]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.21" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-21"><string-name name-style="western" hwp:sortable="Arthur Robert Mac"><given-names>Robert Mac</given-names> <surname>Arthur</surname></string-name>. <article-title hwp:id="article-title-18">Species packing, and what competition minimizes</article-title>. <source hwp:id="source-21">Proceedings of the National Academy of Sciences</source>, <volume>64</volume>(<issue>4</issue>):<fpage>1369</fpage>–<lpage>1371</lpage>, <year>1969</year>.</citation></ref><ref id="c22" hwp:id="ref-22" hwp:rev-id="xref-ref-22-1 xref-ref-22-2"><label>[22]</label><citation publication-type="book" citation-type="book" ref:id="147728v3.22" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-22"><string-name name-style="western" hwp:sortable="MacArthur Robert H"><given-names>Robert H</given-names> <surname>MacArthur</surname></string-name> and <string-name name-style="western" hwp:sortable="Wilson Edward O"><given-names>Edward O</given-names> <surname>Wilson</surname></string-name>. <source hwp:id="source-22">Theory of Island Biogeography</source>. <publisher-name>Princeton University Press</publisher-name>, <year>2015</year>.</citation></ref><ref id="c23" hwp:id="ref-23" hwp:rev-id="xref-ref-23-1"><label>[23]</label><citation publication-type="book" citation-type="book" ref:id="147728v3.23" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-23"><string-name name-style="western" hwp:sortable="Margalef Ramon"><given-names>Ramon</given-names> <surname>Margalef</surname></string-name>. <chapter-title>Diversity, stability and maturity in natural ecosystems</chapter-title>. In <source hwp:id="source-23">Unifying concepts in ecology</source>, pages <fpage>151</fpage>–<lpage>160</lpage>. <publisher-name>Springer</publisher-name>, <year>1975</year>.</citation></ref><ref id="c24" hwp:id="ref-24" hwp:rev-id="xref-ref-24-1"><label>[24]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.24" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-24"><string-name name-style="western" hwp:sortable="May Robert M"><given-names>Robert M</given-names> <surname>May</surname></string-name>. <article-title hwp:id="article-title-19">Will a large complex system be stable?</article-title> <source hwp:id="source-24">Nature</source>, <volume>238</volume>:<fpage>413</fpage>–<lpage>414</lpage>, <year>1972</year>.</citation></ref><ref id="c25" hwp:id="ref-25" hwp:rev-id="xref-ref-25-1"><label>[25]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.25" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-25"><string-name name-style="western" hwp:sortable="May Robert M"><given-names>Robert M</given-names> <surname>May</surname></string-name> and <string-name name-style="western" hwp:sortable="Anderson Roy M"><given-names>Roy M</given-names> <surname>Anderson</surname></string-name>. <article-title hwp:id="article-title-20">Parasite—host coevolution</article-title>. <source hwp:id="source-25">Parasitology</source>, <volume>100</volume>(<issue>S1</issue>):<fpage>S89</fpage>–<lpage>S101</lpage>, <year>1990</year>.</citation></ref><ref id="c26" hwp:id="ref-26" hwp:rev-id="xref-ref-26-1 xref-ref-26-2"><label>[26]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.26" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-26"><string-name name-style="western" hwp:sortable="Mazancourt Claire"><given-names>Claire</given-names> <surname>Mazancourt</surname></string-name>, <string-name name-style="western" hwp:sortable="Isbell Forest"><given-names>Forest</given-names> <surname>Isbell</surname></string-name>, <string-name name-style="western" hwp:sortable="Larocque Allen"><given-names>Allen</given-names> <surname>Larocque</surname></string-name>, <string-name name-style="western" hwp:sortable="Berendse Frank"><given-names>Frank</given-names> <surname>Berendse</surname></string-name>, <string-name name-style="western" hwp:sortable="Luca Enrica"><given-names>Enrica</given-names> <surname>Luca</surname></string-name>, <string-name name-style="western" hwp:sortable="Grace James B"><given-names>James B</given-names> <surname>Grace</surname></string-name>, <string-name name-style="western" hwp:sortable="Haegeman Bart"><given-names>Bart</given-names> <surname>Haegeman</surname></string-name>, <string-name name-style="western" hwp:sortable="Wayne Polley H"><given-names>H</given-names> <surname>Wayne Polley</surname></string-name>, <string-name name-style="western" hwp:sortable="Roscher Christiane"><given-names>Christiane</given-names> <surname>Roscher</surname></string-name>, <string-name name-style="western" hwp:sortable="Schmid Bernhard"><given-names>Bernhard</given-names> <surname>Schmid</surname></string-name>, <etal>et al</etal>. <article-title hwp:id="article-title-21">Predicting ecosystem stability from community composition and biodiversity</article-title>. <source hwp:id="source-26">Ecology letters</source>, <volume>16</volume>(<issue>5</issue>):<fpage>617</fpage>–<lpage>625</lpage>, <year>2013</year>.</citation></ref><ref id="c27" hwp:id="ref-27" hwp:rev-id="xref-ref-27-1 xref-ref-27-2"><label>[27]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.27" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-27"><string-name name-style="western" hwp:sortable="Mézard M"><given-names>M</given-names> <surname>Mézard</surname></string-name>. <article-title hwp:id="article-title-22">The space of interactions in neural networks: Gardner’s computation with the cavity method</article-title>. <source hwp:id="source-27">Journal of Physics A: Mathematical and General</source>, <volume>22</volume>(<issue>12</issue>):<fpage>2181</fpage>, <year>1989</year>.</citation></ref><ref id="c28" hwp:id="ref-28" hwp:rev-id="xref-ref-28-1"><label>[28]</label><citation publication-type="book" citation-type="book" ref:id="147728v3.28" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-28"><string-name name-style="western" hwp:sortable="Mézard Marc"><given-names>Marc</given-names> <surname>Mézard</surname></string-name> and <string-name name-style="western" hwp:sortable="Montanari Andrea"><given-names>Andrea</given-names> <surname>Montanari</surname></string-name>. <source hwp:id="source-28">Information, physics, and computation</source>. <publisher-name>Oxford University Press</publisher-name>, <year>2009</year>.</citation></ref><ref id="c29" hwp:id="ref-29" hwp:rev-id="xref-ref-29-1 xref-ref-29-2"><label>[29]</label><citation publication-type="book" citation-type="book" ref:id="147728v3.29" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-29"><string-name name-style="western" hwp:sortable="Mézard Marc"><given-names>Marc</given-names> <surname>Mézard</surname></string-name>, <string-name name-style="western" hwp:sortable="Parisi Giorgio"><given-names>Giorgio</given-names> <surname>Parisi</surname></string-name>, and <string-name name-style="western" hwp:sortable="Virasoro Miguel"><given-names>Miguel</given-names> <surname>Virasoro</surname></string-name>. <source hwp:id="source-29">Spin glass theory and beyond: An Introduction to the Replica Method and Its Applications</source>, vol-ume <volume>9</volume>. <publisher-name>World Scientific Publishing Co Inc</publisher-name>, <year>1987</year>.</citation></ref><ref id="c30" hwp:id="ref-30" hwp:rev-id="xref-ref-30-1"><label>[30]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.30" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-30"><string-name name-style="western" hwp:sortable="Montanari Andrea"><given-names>Andrea</given-names> <surname>Montanari</surname></string-name>, <string-name name-style="western" hwp:sortable="Müller M"><given-names>M</given-names> <surname>Müller</surname></string-name>, and <string-name name-style="western" hwp:sortable="Mézard Marc"><given-names>Marc</given-names> <surname>Mézard</surname></string-name>. <article-title hwp:id="article-title-23">Phase diagram of random heteropolymers</article-title>. <source hwp:id="source-30">Physical review letters</source>, <volume>92</volume>(<issue>18</issue>):<fpage>185509, 2004</fpage>.</citation></ref><ref id="c31" hwp:id="ref-31" hwp:rev-id="xref-ref-31-1"><label>[31]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.31" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-31"><string-name name-style="western" hwp:sortable="Mouquet Nicolas"><given-names>Nicolas</given-names> <surname>Mouquet</surname></string-name> and <string-name name-style="western" hwp:sortable="Loreau Michel"><given-names>Michel</given-names> <surname>Loreau</surname></string-name>. <article-title hwp:id="article-title-24">Community patterns in source-sink metacommunities</article-title>. <source hwp:id="source-31">The american naturalist</source>, <volume>162</volume>(<issue>5</issue>):<fpage>544</fpage>–<lpage>557</lpage>, <year>2003</year>.</citation></ref><ref id="c32" hwp:id="ref-32" hwp:rev-id="xref-ref-32-1 xref-ref-32-2"><label>[32]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.32" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-32"><string-name name-style="western" hwp:sortable="Opper Manfred"><given-names>Manfred</given-names> <surname>Opper</surname></string-name> and <string-name name-style="western" hwp:sortable="Diederich Sigurd"><given-names>Sigurd</given-names> <surname>Diederich</surname></string-name>. <article-title hwp:id="article-title-25">Phase transition and 1/f noise in a game dynamical model</article-title>. <source hwp:id="source-32">Physical review letters</source>, <volume>69</volume>(<issue>10</issue>):<fpage>1616</fpage>, <year>1992</year>.</citation></ref><ref id="c33" hwp:id="ref-33" hwp:rev-id="xref-ref-33-1"><label>[33]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.33" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-33"><string-name name-style="western" hwp:sortable="Paga Pierre"><given-names>Pierre</given-names> <surname>Paga</surname></string-name> and <string-name name-style="western" hwp:sortable="Kühn Reimer"><given-names>Reimer</given-names> <surname>Kühn</surname></string-name>. <article-title hwp:id="article-title-26">Contagion in an interacting economy</article-title>. <source hwp:id="source-33">Journal of Statistical Mechanics: Theory and Experiment</source>, <volume>2015</volume>(<issue>3</issue>):<fpage>P03008</fpage>, <year>2015</year>.</citation></ref><ref id="c34" hwp:id="ref-34" hwp:rev-id="xref-ref-34-1"><label>[34]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.34" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-34"><string-name name-style="western" hwp:sortable="Schmid Bernhard"><given-names>Bernhard</given-names> <surname>Schmid</surname></string-name>, <string-name name-style="western" hwp:sortable="Hector Andy"><given-names>Andy</given-names> <surname>Hector</surname></string-name>, <string-name name-style="western" hwp:sortable="Saha Prasenjit"><given-names>Prasenjit</given-names> <surname>Saha</surname></string-name>, and <string-name name-style="western" hwp:sortable="Loreau Michel"><given-names>Michel</given-names> <surname>Loreau</surname></string-name>. <article-title hwp:id="article-title-27">Bio-diversity effects and transgressive overyielding</article-title>. <source hwp:id="source-34">Journal of Plant Ecology</source>, <volume>1</volume>(<issue>2</issue>):<fpage>95</fpage>–<lpage>102</lpage>, <year>2008</year>.</citation></ref><ref id="c35" hwp:id="ref-35" hwp:rev-id="xref-ref-35-1"><label>[35]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.35" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-35"><string-name name-style="western" hwp:sortable="Seganti Alessandro"><given-names>Alessandro</given-names> <surname>Seganti</surname></string-name>, <string-name name-style="western" hwp:sortable="Martino Andrea De"><given-names>Andrea De</given-names> <surname>Martino</surname></string-name>, and <string-name name-style="western" hwp:sortable="Ricci-Tersenghi Federico"><given-names>Federico</given-names> <surname>Ricci-Tersenghi</surname></string-name>. <article-title hwp:id="article-title-28">Boolean constraint satisfaction problems for reaction networks</article-title>. <source hwp:id="source-35">Journal of Statistical Mechanics: Theory and Experiment</source>, <volume>2013</volume>(<issue>09</issue>):<fpage>P09009</fpage>, <year>2013</year>.</citation></ref><ref id="c36" hwp:id="ref-36" hwp:rev-id="xref-ref-36-1"><label>[36]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.36" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-36"><string-name name-style="western" hwp:sortable="Thomas Torsten"><given-names>Torsten</given-names> <surname>Thomas</surname></string-name>, <string-name name-style="western" hwp:sortable="Moitinho-Silva Lucas"><given-names>Lucas</given-names> <surname>Moitinho-Silva</surname></string-name>, <string-name name-style="western" hwp:sortable="Lurgi Miguel"><given-names>Miguel</given-names> <surname>Lurgi</surname></string-name>, <string-name name-style="western" hwp:sortable="Björk Johannes R"><given-names>Johannes R</given-names> <surname>Björk</surname></string-name>, <string-name name-style="western" hwp:sortable="Easson Cole"><given-names>Cole</given-names> <surname>Easson</surname></string-name>, <string-name name-style="western" hwp:sortable="Astudillo-García Carmen"><given-names>Carmen</given-names> <surname>Astudillo-García</surname></string-name>, <string-name name-style="western" hwp:sortable="Olson Julie B"><given-names>Julie B</given-names> <surname>Olson</surname></string-name>, <string-name name-style="western" hwp:sortable="Erwin Patrick M"><given-names>Patrick M</given-names> <surname>Erwin</surname></string-name>, <string-name name-style="western" hwp:sortable="López-Legentil Susanna"><given-names>Susanna</given-names> <surname>López-Legentil</surname></string-name>, <string-name name-style="western" hwp:sortable="Luter Heidi"><given-names>Heidi</given-names> <surname>Luter</surname></string-name>, <etal>et al</etal>. <article-title hwp:id="article-title-29">Diversity, structure and convergent evolution of the global sponge microbiome</article-title>. <source hwp:id="source-36">Nature Communications</source>, <fpage>7</fpage>, <year>2016</year>.</citation></ref><ref id="c37" hwp:id="ref-37" hwp:rev-id="xref-ref-37-1 xref-ref-37-2"><label>[37]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.37" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-37"><string-name name-style="western" hwp:sortable="Tikhonov Mikhail"><given-names>Mikhail</given-names> <surname>Tikhonov</surname></string-name>. <article-title hwp:id="article-title-30">Community-level cohesion without cooperation</article-title>. <source hwp:id="source-37">Elife</source>, <volume>5</volume>:<fpage>e15747</fpage>, <year>2016</year>.</citation></ref><ref id="c38" hwp:id="ref-38" hwp:rev-id="xref-ref-38-1 xref-ref-38-2"><label>[38]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.38" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-38"><string-name name-style="western" hwp:sortable="Tikhonov Mikhail"><given-names>Mikhail</given-names> <surname>Tikhonov</surname></string-name> and <string-name name-style="western" hwp:sortable="Monasson Remi"><given-names>Remi</given-names> <surname>Monasson</surname></string-name>. <article-title hwp:id="article-title-31">A collective phase in resource competition in a highly diverse ecosystem</article-title>. <source hwp:id="source-38">arXiv preprint arXiv:1609.01270</source>, <year>2016</year>.</citation></ref><ref id="c39" hwp:id="ref-39" hwp:rev-id="xref-ref-39-1 xref-ref-39-2"><label>[39]</label><citation publication-type="book" citation-type="book" ref:id="147728v3.39" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-39"><string-name name-style="western" hwp:sortable="Tilman David"><given-names>David</given-names> <surname>Tilman</surname></string-name>. <source hwp:id="source-39">Resource competition and community structure</source>. <publisher-name>Princeton university press</publisher-name>, <year>1982</year>.</citation></ref><ref id="c40" hwp:id="ref-40" hwp:rev-id="xref-ref-40-1"><label>[40]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.40" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-40"><string-name name-style="western" hwp:sortable="Chengyi Tu"><surname>Chengyi</surname> <given-names>Tu</given-names></string-name>, <string-name name-style="western" hwp:sortable="Grilli Jacopo"><given-names>Jacopo</given-names> <surname>Grilli</surname></string-name>, and <string-name name-style="western" hwp:sortable="Suweis Samir"><given-names>Samir</given-names> <surname>Suweis</surname></string-name>. <article-title hwp:id="article-title-32">Universality of resilience patterns in generalized lotka volterra dynamics and beyond</article-title>. <source hwp:id="source-40">arXiv preprint arXiv:1606.09630</source>, <year>2016</year>.</citation></ref><ref id="c41" hwp:id="ref-41" hwp:rev-id="xref-ref-41-1"><label>[41]</label><citation publication-type="journal" citation-type="journal" ref:id="147728v3.41" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-41"><string-name name-style="western" hwp:sortable="Yoshino Yoshimi"><given-names>Yoshimi</given-names> <surname>Yoshino</surname></string-name>, <string-name name-style="western" hwp:sortable="Galla Tobias"><given-names>Tobias</given-names> <surname>Galla</surname></string-name>, and <string-name name-style="western" hwp:sortable="Tokita Kei"><given-names>Kei</given-names> <surname>Tokita</surname></string-name>. <article-title hwp:id="article-title-33">Statistical mechanics and stability of a model eco-system</article-title>. <source hwp:id="source-41">Journal of Statistical Mechanics: Theory and Experiment</source>, <volume>2007</volume>(<issue>09</issue>):<fpage>P09003</fpage>, <year>2007</year>.</citation></ref></ref-list><app-group hwp:id="app-group-1"><app id="app1" hwp:id="app-1" hwp:rev-id="xref-app-1-1 xref-app-1-2 xref-app-1-3"><label>8</label><title hwp:id="title-52">Appendices</title><sec id="app1a" hwp:id="sec-50"><label>A.</label><title hwp:id="title-53">The role of disorder</title><p hwp:id="p-185">Computing the equilibrium state in effect requires inverting the matrix <italic toggle="yes">a<sub>ij</sub></italic> in the equation:
<disp-formula id="eqn173" hwp:id="disp-formula-183"><alternatives hwp:id="alternatives-209"><graphic xlink:href="147728_eqn173.gif" position="float" orientation="portrait" hwp:id="graphic-193"/></alternatives></disp-formula></p><p hwp:id="p-186">In principle we could expand this equation, substituting
<disp-formula id="eqn174" hwp:id="disp-formula-184"><alternatives hwp:id="alternatives-210"><graphic xlink:href="147728_eqn174.gif" position="float" orientation="portrait" hwp:id="graphic-194"/></alternatives></disp-formula>
into the sum, and so on recursively, causing all paths <italic toggle="yes">a<sub>ij</sub>a<sub>jk</sub></italic>… (<italic toggle="yes">i</italic> → <italic toggle="yes">j</italic> → <italic toggle="yes">k…</italic>) in the community matrix to appear in the first equation above. The crucial idea of disordered systems methods is that, for any reasonably complex system, these paths soon lose coherence and start to interfere with each other. These interferences are so complex as to produce seemingly-random results.</p><p hwp:id="p-187">One way to see it is that each term in the sum is a (possibly very long) product of coefficients <italic toggle="yes">a<sub>kl</sub></italic> and is weakly correlated with other such terms – unless the same coefficients appear again and again in the same combinations in many terms. That can happen in a very structured community, or one with only small loops (the extreme is a collection of independent few-species motifs: in each motif, there are not enough paths for them to interfere and create a seemingly random result). This enables the cavity trick, which retains only the first-order feedback of a species on itself, and for the rest needs only the mean and variance of interactions, as the effect of interactions is essentially random.</p><p hwp:id="p-188">Let us see a precise example of these ideas. In the main text, we noted that the feedback of a species on itself through the rest of the network is a self-averaging quantity. Consider the following sum:
<disp-formula id="eqn175" hwp:id="disp-formula-185"><alternatives hwp:id="alternatives-211"><graphic xlink:href="147728_eqn175.gif" position="float" orientation="portrait" hwp:id="graphic-195"/></alternatives></disp-formula>
which occurs in <xref ref-type="disp-formula" rid="eqn50" hwp:id="xref-disp-formula-55-1" hwp:rel-id="disp-formula-55">(50)</xref> (we recall s* = <italic toggle="yes">øs</italic> is the average number of surviving interaction partners for species 0). We separate the sum into two parts:
<disp-formula id="eqn176" hwp:id="disp-formula-186"><alternatives hwp:id="alternatives-212"><graphic xlink:href="147728_eqn176.gif" position="float" orientation="portrait" hwp:id="graphic-196"/></alternatives></disp-formula></p><p hwp:id="p-189">Recall that 〈<italic toggle="yes">a</italic><sub>0<italic toggle="yes">i</italic></sub><italic toggle="yes">a</italic><sub><italic toggle="yes">i</italic>0</sub>〉 = <italic toggle="yes">γ</italic> while 〈<italic toggle="yes">a</italic><sub>0<italic toggle="yes">i</italic></sub>〉 = 0. Hence, the second sum is a random walk with <italic toggle="yes">s</italic>*(<italic toggle="yes">s</italic>* − 1) terms, and its total scales like <italic toggle="yes">s</italic>*. Now, we should note that
<disp-formula hwp:id="disp-formula-187"><alternatives hwp:id="alternatives-213"><graphic xlink:href="147728_ueqn12.gif" position="float" orientation="portrait" hwp:id="graphic-197"/></alternatives></disp-formula>
for <italic toggle="yes">i</italic> ≠ <italic toggle="yes">j</italic> is created by the interaction between species <italic toggle="yes">i</italic> and <italic toggle="yes">j,</italic> which is at best proportional to <inline-formula hwp:id="inline-formula-27"><alternatives hwp:id="alternatives-214"><inline-graphic xlink:href="147728_inline25.gif" hwp:id="inline-graphic-27"/></alternatives></inline-formula> (if the species are linked directly) or even weaker (if they interact only indirectly).</p><p hwp:id="p-190">Finally, we get the respective scalings:
<disp-formula id="eqn177" hwp:id="disp-formula-188"><alternatives hwp:id="alternatives-215"><graphic xlink:href="147728_eqn177.gif" position="float" orientation="portrait" hwp:id="graphic-198"/></alternatives></disp-formula>
<disp-formula id="eqn178" hwp:id="disp-formula-189"><alternatives hwp:id="alternatives-216"><graphic xlink:href="147728_eqn178.gif" position="float" orientation="portrait" hwp:id="graphic-199"/></alternatives></disp-formula></p><p hwp:id="p-191">In other words, even though the sum over <italic toggle="yes">i</italic> ≠ <italic toggle="yes">j</italic> has many more terms, it ends up being of order <inline-formula hwp:id="inline-formula-28"><alternatives hwp:id="alternatives-217"><inline-graphic xlink:href="147728_inline26.gif" hwp:id="inline-graphic-28"/></alternatives></inline-formula> compared to the first sum. That sum itself has variations of order <inline-formula hwp:id="inline-formula-29"><alternatives hwp:id="alternatives-218"><inline-graphic xlink:href="147728_inline27.gif" hwp:id="inline-graphic-29"/></alternatives></inline-formula> compared to its mean, depending on which species is isolated as species 0. As <italic toggle="yes">s</italic> becomes larger, the feedback thus tends to become a single number, no matter which species we consider.</p></sec><sec id="app1b" hwp:id="sec-51"><label>B.</label><title hwp:id="title-54">Linear response</title><sec id="app1b1" hwp:id="sec-52"><title hwp:id="title-55">Typical cavity method (Press)</title><p hwp:id="p-192">Notation: <inline-formula hwp:id="inline-formula-30"><alternatives hwp:id="alternatives-219"><inline-graphic xlink:href="147728_inline28.gif" hwp:id="inline-graphic-30"/></alternatives></inline-formula>. <inline-formula hwp:id="inline-formula-31"><alternatives hwp:id="alternatives-220"><inline-graphic xlink:href="147728_inline29.gif" hwp:id="inline-graphic-31"/></alternatives></inline-formula>. Let <italic toggle="yes">ξ</italic> be a random press-perturbation. Its long term effect on the equilibrium associated to the Jacobian <italic toggle="yes">B</italic> is
<disp-formula hwp:id="disp-formula-190"><alternatives hwp:id="alternatives-221"><graphic xlink:href="147728_ueqn13.gif" position="float" orientation="portrait" hwp:id="graphic-200"/></alternatives></disp-formula></p><p hwp:id="p-193">Where we isolated the effect of a generic species 0 (this is the starting point of the cavity method). Assuming a small effect of that species we may write
<disp-formula hwp:id="disp-formula-191"><alternatives hwp:id="alternatives-222"><graphic xlink:href="147728_ueqn14.gif" position="float" orientation="portrait" hwp:id="graphic-201"/></alternatives></disp-formula></p><p hwp:id="p-194">Under the replica symmetry, species 0 is generic and its addition or removal does not change any statistical properties of community, in particular <inline-formula hwp:id="inline-formula-32"><alternatives hwp:id="alternatives-223"><inline-graphic xlink:href="147728_inline30.gif" hwp:id="inline-graphic-32"/></alternatives></inline-formula>. Then
<disp-formula hwp:id="disp-formula-192"><alternatives hwp:id="alternatives-224"><graphic xlink:href="147728_ueqn15.gif" position="float" orientation="portrait" hwp:id="graphic-202"/></alternatives></disp-formula></p><p hwp:id="p-195">Taking the square
<disp-formula hwp:id="disp-formula-193"><alternatives hwp:id="alternatives-225"><graphic xlink:href="147728_ueqn16.gif" position="float" orientation="portrait" hwp:id="graphic-203"/></alternatives></disp-formula>
taking the mean over <italic toggle="yes">ξ</italic><sub>0</sub>, knowing that <inline-formula hwp:id="inline-formula-33"><alternatives hwp:id="alternatives-226"><inline-graphic xlink:href="147728_inline31.gif" hwp:id="inline-graphic-33"/></alternatives></inline-formula>;<inline-formula hwp:id="inline-formula-34"><alternatives hwp:id="alternatives-227"><inline-graphic xlink:href="147728_inline32.gif" hwp:id="inline-graphic-34"/></alternatives></inline-formula>, and by linearity, <inline-formula hwp:id="inline-formula-35"><alternatives hwp:id="alternatives-228"><inline-graphic xlink:href="147728_inline33.gif" hwp:id="inline-graphic-35"/></alternatives></inline-formula>, gives
<disp-formula hwp:id="disp-formula-194"><alternatives hwp:id="alternatives-229"><graphic xlink:href="147728_ueqn17.gif" position="float" orientation="portrait" hwp:id="graphic-204"/></alternatives></disp-formula></p><p hwp:id="p-196">Taking the mean over all species gives
<disp-formula hwp:id="disp-formula-195"><alternatives hwp:id="alternatives-230"><graphic xlink:href="147728_ueqn18.gif" position="float" orientation="portrait" hwp:id="graphic-205"/></alternatives></disp-formula></p><p hwp:id="p-197">To conclude we need <inline-formula hwp:id="inline-formula-36"><alternatives hwp:id="alternatives-231"><inline-graphic xlink:href="147728_inline34.gif" hwp:id="inline-graphic-36"/></alternatives></inline-formula>. For that we write
<disp-formula hwp:id="disp-formula-196"><alternatives hwp:id="alternatives-232"><graphic xlink:href="147728_ueqn19.gif" position="float" orientation="portrait" hwp:id="graphic-206"/></alternatives></disp-formula></p><p hwp:id="p-198">Hence it is solution to (knowing that at <italic toggle="yes">σ</italic> = 0, <inline-formula hwp:id="inline-formula-37"><alternatives hwp:id="alternatives-233"><inline-graphic xlink:href="147728_inline35.gif" hwp:id="inline-graphic-37"/></alternatives></inline-formula>)
<disp-formula hwp:id="disp-formula-197"><alternatives hwp:id="alternatives-234"><graphic xlink:href="147728_ueqn20.gif" position="float" orientation="portrait" hwp:id="graphic-207"/></alternatives></disp-formula>
we thus have
<disp-formula hwp:id="disp-formula-198"><alternatives hwp:id="alternatives-235"><graphic xlink:href="147728_ueqn21.gif" position="float" orientation="portrait" hwp:id="graphic-208"/></alternatives></disp-formula></p><p hwp:id="p-199">In the Lotka-Volterra assembly perspective, <italic toggle="yes">B</italic> is the interaction matrix and only a fraction <italic toggle="yes">ϕ</italic> of species survive. We still have <italic toggle="yes">u</italic> = 1 − <italic toggle="yes">μ</italic>/<italic toggle="yes">S</italic> but
<disp-formula hwp:id="disp-formula-199"><alternatives hwp:id="alternatives-236"><graphic xlink:href="147728_ueqn22.gif" position="float" orientation="portrait" hwp:id="graphic-209"/></alternatives></disp-formula></p></sec><sec id="app1b2" hwp:id="sec-53"><title hwp:id="title-56">Externally applied press</title><p hwp:id="p-200">In the assembly perspective, the Jacobian matrix reads
<disp-formula hwp:id="disp-formula-200"><alternatives hwp:id="alternatives-237"><graphic xlink:href="147728_ueqn23.gif" position="float" orientation="portrait" hwp:id="graphic-210"/></alternatives></disp-formula>
where <italic toggle="yes">r<sub>i</sub></italic> is the growth rate of species <italic toggle="yes">i</italic> and <italic toggle="yes">k<sub>i</sub></italic> its carrying capacity. A press acting proportionally to <inline-formula hwp:id="inline-formula-38"><alternatives hwp:id="alternatives-238"><inline-graphic xlink:href="147728_inline36.gif" hwp:id="inline-graphic-38"/></alternatives></inline-formula> will induce a displacement
<disp-formula hwp:id="disp-formula-201"><alternatives hwp:id="alternatives-239"><graphic xlink:href="147728_ueqn24.gif" position="float" orientation="portrait" hwp:id="graphic-211"/></alternatives></disp-formula>
so we can simply adapt the above calculations by replacing <italic toggle="yes">ξ<sub>i</sub></italic> by <inline-formula hwp:id="inline-formula-39"><alternatives hwp:id="alternatives-240"><inline-graphic xlink:href="147728_inline37.gif" hwp:id="inline-graphic-39"/></alternatives></inline-formula>. This gives us
<disp-formula hwp:id="disp-formula-202"><alternatives hwp:id="alternatives-241"><graphic xlink:href="147728_ueqn25.gif" position="float" orientation="portrait" hwp:id="graphic-212"/></alternatives></disp-formula></p></sec><sec id="app1b3" hwp:id="sec-54"><title hwp:id="title-57">To compute (mean case) variability we must solve the Lyapunov equa-tion</title><p hwp:id="p-201">
<disp-formula hwp:id="disp-formula-203"><alternatives hwp:id="alternatives-242"><graphic xlink:href="147728_ueqn26.gif" position="float" orientation="portrait" hwp:id="graphic-213"/></alternatives></disp-formula></p><p hwp:id="p-202">Off diagonal terms, if <inline-formula hwp:id="inline-formula-40"><alternatives hwp:id="alternatives-243"><inline-graphic xlink:href="147728_inline38.gif" hwp:id="inline-graphic-40"/></alternatives></inline-formula>, read
<disp-formula hwp:id="disp-formula-204"><alternatives hwp:id="alternatives-244"><graphic xlink:href="147728_ueqn27.gif" position="float" orientation="portrait" hwp:id="graphic-214"/></alternatives></disp-formula>
taking the mean, the self-averaging of the terms proportional to <italic toggle="yes">σ</italic> makes the problem reduce to the mean-field case, which gives us the relationship
<disp-formula hwp:id="disp-formula-205"><alternatives hwp:id="alternatives-245"><graphic xlink:href="147728_ueqn28.gif" position="float" orientation="portrait" hwp:id="graphic-215"/></alternatives></disp-formula></p><p hwp:id="p-203">The interaction diversity (<italic toggle="yes">σ</italic>) enters on the diagonal (variances):
<disp-formula hwp:id="disp-formula-206"><alternatives hwp:id="alternatives-246"><graphic xlink:href="147728_ueqn29.gif" position="float" orientation="portrait" hwp:id="graphic-216"/></alternatives></disp-formula>
in replacing <italic toggle="yes">C<sub>kj</sub></italic> in <inline-formula hwp:id="inline-formula-41"><alternatives hwp:id="alternatives-247"><inline-graphic xlink:href="147728_inline39.gif" hwp:id="inline-graphic-41"/></alternatives></inline-formula> by its expression written above, we only need to track terms proportional to <italic toggle="yes">σ</italic><sup>2</sup>, the other will self average. So:
<disp-formula hwp:id="disp-formula-207"><alternatives hwp:id="alternatives-248"><graphic xlink:href="147728_ueqn30.gif" position="float" orientation="portrait" hwp:id="graphic-217"/></alternatives></disp-formula>
so that
<disp-formula hwp:id="disp-formula-208"><alternatives hwp:id="alternatives-249"><graphic xlink:href="147728_ueqn31.gif" position="float" orientation="portrait" hwp:id="graphic-218"/></alternatives></disp-formula>
when <italic toggle="yes">μ</italic> = 0, <italic toggle="yes">u</italic> = 1, <inline-formula hwp:id="inline-formula-42"><alternatives hwp:id="alternatives-250"><inline-graphic xlink:href="147728_inline40.gif" hwp:id="inline-graphic-42"/></alternatives></inline-formula>. When <italic toggle="yes">σ</italic> = 0, the expression for the mean variance is exact (mean-field case).</p></sec><sec id="app1b4" hwp:id="sec-55"><title hwp:id="title-58">Demographic noise in the assembly perspective for identical carrying capacities and growth rates</title><p hwp:id="p-204"><italic toggle="yes">B</italic> must be replaced with the Jacobian matrix
<disp-formula hwp:id="disp-formula-209"><alternatives hwp:id="alternatives-251"><graphic xlink:href="147728_ueqn32.gif" position="float" orientation="portrait" hwp:id="graphic-219"/></alternatives></disp-formula></p><p hwp:id="p-205">Where the <inline-formula hwp:id="inline-formula-43"><alternatives hwp:id="alternatives-252"><inline-graphic xlink:href="147728_inline41.gif" hwp:id="inline-graphic-43"/></alternatives></inline-formula> are the equilibrium abundances of surviving species. The Lya-punov equation becomes
<disp-formula hwp:id="disp-formula-210"><alternatives hwp:id="alternatives-253"><graphic xlink:href="147728_ueqn33.gif" position="float" orientation="portrait" hwp:id="graphic-220"/></alternatives></disp-formula></p><p hwp:id="p-206">Off diagonal terms if <inline-formula hwp:id="inline-formula-44"><alternatives hwp:id="alternatives-254"><inline-graphic xlink:href="147728_inline42.gif" hwp:id="inline-graphic-44"/></alternatives></inline-formula>, read
<disp-formula hwp:id="disp-formula-211"><alternatives hwp:id="alternatives-255"><graphic xlink:href="147728_ueqn34.gif" position="float" orientation="portrait" hwp:id="graphic-221"/></alternatives></disp-formula>
let us write
<disp-formula hwp:id="disp-formula-212"><alternatives hwp:id="alternatives-256"><graphic xlink:href="147728_ueqn35.gif" position="float" orientation="portrait" hwp:id="graphic-222"/></alternatives></disp-formula>
then
<disp-formula hwp:id="disp-formula-213"><alternatives hwp:id="alternatives-257"><graphic xlink:href="147728_ueqn36.gif" position="float" orientation="portrait" hwp:id="graphic-223"/></alternatives></disp-formula>
taking the mean over <italic toggle="yes">k</italic> ≠ <italic toggle="yes">j</italic> gives the same approximate relationship between 〈<italic toggle="yes">C</italic><sub>≠</sub>〉 and 〈<italic toggle="yes">C</italic><sub>=</sub>〉 as for the mean field case (and is exact when <italic toggle="yes">σ</italic> = 0). On the diagonal:
<disp-formula hwp:id="disp-formula-214"><alternatives hwp:id="alternatives-258"><graphic xlink:href="147728_ueqn37.gif" position="float" orientation="portrait" hwp:id="graphic-224"/></alternatives></disp-formula></p><p hwp:id="p-207">The abundances only enter via the expression of <italic toggle="yes">C<sub>kj</sub></italic> but always as a ratio <inline-formula hwp:id="inline-formula-45"><alternatives hwp:id="alternatives-259"><inline-graphic xlink:href="147728_inline43.gif" hwp:id="inline-graphic-45"/></alternatives></inline-formula> or <inline-formula hwp:id="inline-formula-46"><alternatives hwp:id="alternatives-260"><inline-graphic xlink:href="147728_inline44.gif" hwp:id="inline-graphic-46"/></alternatives></inline-formula> whose average is 1. We get
<disp-formula hwp:id="disp-formula-215"><alternatives hwp:id="alternatives-261"><graphic xlink:href="147728_ueqn38.gif" position="float" orientation="portrait" hwp:id="graphic-225"/></alternatives></disp-formula>
taking the mean over <italic toggle="yes">j</italic> gives
<disp-formula hwp:id="disp-formula-216"><alternatives hwp:id="alternatives-262"><graphic xlink:href="147728_ueqn39.gif" position="float" orientation="portrait" hwp:id="graphic-226"/></alternatives></disp-formula>
so that
<disp-formula hwp:id="disp-formula-217"><alternatives hwp:id="alternatives-263"><graphic xlink:href="147728_ueqn40.gif" position="float" orientation="portrait" hwp:id="graphic-227"/></alternatives></disp-formula>
when <italic toggle="yes">μ</italic> = 0, <italic toggle="yes">u</italic> = 1, <inline-formula hwp:id="inline-formula-47"><alternatives hwp:id="alternatives-264"><inline-graphic xlink:href="147728_inline45.gif" hwp:id="inline-graphic-47"/></alternatives></inline-formula>. All in all the approximation for (adimensional) invariability is
<disp-formula hwp:id="disp-formula-218"><alternatives hwp:id="alternatives-265"><graphic xlink:href="147728_ueqn41.gif" position="float" orientation="portrait" hwp:id="graphic-228"/></alternatives></disp-formula></p></sec><sec id="app1b5" hwp:id="sec-56"><title hwp:id="title-59">More general case in the assembly perspective</title><p hwp:id="p-208">In general <italic toggle="yes">B</italic> must be replaced with the Jacobian matrix
<disp-formula hwp:id="disp-formula-219"><alternatives hwp:id="alternatives-266"><graphic xlink:href="147728_ueqn42.gif" position="float" orientation="portrait" hwp:id="graphic-229"/></alternatives></disp-formula></p><p hwp:id="p-209">Under stochastic perturbations scaling as <inline-formula hwp:id="inline-formula-48"><alternatives hwp:id="alternatives-267"><inline-graphic xlink:href="147728_inline46.gif" hwp:id="inline-graphic-48"/></alternatives></inline-formula> (<italic toggle="yes">v</italic> = 1 demographic noise, <italic toggle="yes">v</italic> = 2 environmental noise) the Lyapunov equation becomes
<disp-formula hwp:id="disp-formula-220"><alternatives hwp:id="alternatives-268"><graphic xlink:href="147728_ueqn43.gif" position="float" orientation="portrait" hwp:id="graphic-230"/></alternatives></disp-formula></p><p hwp:id="p-210">For off-diagonal terms we may reproduce the previous calculations by replacing <inline-formula hwp:id="inline-formula-49"><alternatives hwp:id="alternatives-269"><inline-graphic xlink:href="147728_inline47.gif" hwp:id="inline-graphic-49"/></alternatives></inline-formula> by <inline-formula hwp:id="inline-formula-50"><alternatives hwp:id="alternatives-270"><inline-graphic xlink:href="147728_inline48.gif" hwp:id="inline-graphic-50"/></alternatives></inline-formula> and
<disp-formula hwp:id="disp-formula-221"><alternatives hwp:id="alternatives-271"><graphic xlink:href="147728_ueqn44.gif" position="float" orientation="portrait" hwp:id="graphic-231"/></alternatives></disp-formula></p><p hwp:id="p-211">On the diagonal however we now have:
<disp-formula hwp:id="disp-formula-222"><alternatives hwp:id="alternatives-272"><graphic xlink:href="147728_ueqn45.gif" position="float" orientation="portrait" hwp:id="graphic-232"/></alternatives></disp-formula>
which, as above, leads us to
<disp-formula hwp:id="disp-formula-223"><alternatives hwp:id="alternatives-273"><graphic xlink:href="147728_ueqn46.gif" position="float" orientation="portrait" hwp:id="graphic-233"/></alternatives></disp-formula>
so that
<disp-formula hwp:id="disp-formula-224"><alternatives hwp:id="alternatives-274"><graphic xlink:href="147728_ueqn47.gif" position="float" orientation="portrait" hwp:id="graphic-234"/></alternatives></disp-formula></p><p hwp:id="p-212">In particular, for <italic toggle="yes">v</italic> = 0, 1, 2 (immigration, demographic and environmental noise, respectively):
<disp-formula hwp:id="disp-formula-225"><alternatives hwp:id="alternatives-275"><graphic xlink:href="147728_ueqn48.gif" position="float" orientation="portrait" hwp:id="graphic-235"/></alternatives></disp-formula></p></sec><sec id="app1b6" hwp:id="sec-57"><title hwp:id="title-60">Taylor’s law</title><p hwp:id="p-213">relates species mean abundance and their variance. In our context, under some stochastic noise acting independently on species (mean case scenario) we have that
<disp-formula hwp:id="disp-formula-226"><alternatives hwp:id="alternatives-276"><graphic xlink:href="147728_ueqn49.gif" position="float" orientation="portrait" hwp:id="graphic-236"/></alternatives></disp-formula></p><p hwp:id="p-214">We roughly approximate <inline-formula hwp:id="inline-formula-51"><alternatives hwp:id="alternatives-277"><inline-graphic xlink:href="147728_inline49.gif" hwp:id="inline-graphic-51"/></alternatives></inline-formula> and <inline-formula hwp:id="inline-formula-52"><alternatives hwp:id="alternatives-278"><inline-graphic xlink:href="147728_inline50.gif" hwp:id="inline-graphic-52"/></alternatives></inline-formula> by 1. Using that
<disp-formula hwp:id="disp-formula-227"><alternatives hwp:id="alternatives-279"><graphic xlink:href="147728_ueqn50.gif" position="float" orientation="portrait" hwp:id="graphic-237"/></alternatives></disp-formula>
so
<disp-formula hwp:id="disp-formula-228"><alternatives hwp:id="alternatives-280"><graphic xlink:href="147728_ueqn51.gif" position="float" orientation="portrait" hwp:id="graphic-238"/></alternatives></disp-formula></p><p hwp:id="p-215">If we define
<disp-formula hwp:id="disp-formula-229"><alternatives hwp:id="alternatives-281"><graphic xlink:href="147728_ueqn52.gif" position="float" orientation="portrait" hwp:id="graphic-239"/></alternatives></disp-formula></p><p hwp:id="p-216">This leads us to
<disp-formula hwp:id="disp-formula-230"><alternatives hwp:id="alternatives-282"><graphic xlink:href="147728_ueqn53.gif" position="float" orientation="portrait" hwp:id="graphic-240"/></alternatives></disp-formula>
if <italic toggle="yes">μ</italic> is of order zero in 1/<italic toggle="yes">S</italic> then <italic toggle="yes">f<sub>S</sub></italic> is of order one and for <italic toggle="yes">S</italic> large enough
<disp-formula hwp:id="disp-formula-231"><alternatives hwp:id="alternatives-283"><graphic xlink:href="147728_ueqn54.gif" position="float" orientation="portrait" hwp:id="graphic-241"/></alternatives></disp-formula></p><p hwp:id="p-217">We thus expect an exact power law <inline-formula hwp:id="inline-formula-53"><alternatives hwp:id="alternatives-284"><inline-graphic xlink:href="147728_inline51.gif" hwp:id="inline-graphic-53"/></alternatives></inline-formula> when <italic toggle="yes">γ</italic> = 0 and <italic toggle="yes">σ<sup>2</sup></italic> large enough (so that <italic toggle="yes">N<sub>j</sub></italic> and <italic toggle="yes">k<sub>j</sub></italic> become uncorrelated).</p></sec></sec><sec id="s1c" hwp:id="sec-58"><label>C.</label><title hwp:id="title-61">Other calculations</title><sec id="s1c1" hwp:id="sec-59"><title hwp:id="title-62">Generating <italic toggle="yes">A</italic> with correlation to <italic toggle="yes">K</italic></title><p hwp:id="p-218">Here is how to generate <italic toggle="yes">A<sub>ij</sub></italic> with prescribed correlation to <italic toggle="yes">K<sub>i</sub></italic>:
<disp-formula id="eqn179" hwp:id="disp-formula-232"><alternatives hwp:id="alternatives-285"><graphic xlink:href="147728_eqn179.gif" position="float" orientation="portrait" hwp:id="graphic-242"/></alternatives></disp-formula>
<disp-formula id="eqn180" hwp:id="disp-formula-233"><alternatives hwp:id="alternatives-286"><graphic xlink:href="147728_eqn180.gif" position="float" orientation="portrait" hwp:id="graphic-243"/></alternatives></disp-formula>
<disp-formula id="eqn181" hwp:id="disp-formula-234"><alternatives hwp:id="alternatives-287"><graphic xlink:href="147728_eqn181.gif" position="float" orientation="portrait" hwp:id="graphic-244"/></alternatives></disp-formula></p><p hwp:id="p-219">Let’s set 〈<italic toggle="yes">K<sub>i</sub></italic>〉 = 1, then:
<disp-formula id="eqn182" hwp:id="disp-formula-235"><alternatives hwp:id="alternatives-288"><graphic xlink:href="147728_eqn182.gif" position="float" orientation="portrait" hwp:id="graphic-245"/></alternatives></disp-formula>
<disp-formula id="eqn183" hwp:id="disp-formula-236"><alternatives hwp:id="alternatives-289"><graphic xlink:href="147728_eqn183.gif" position="float" orientation="portrait" hwp:id="graphic-246"/></alternatives></disp-formula>
<disp-formula id="eqn184" hwp:id="disp-formula-237"><alternatives hwp:id="alternatives-290"><graphic xlink:href="147728_eqn184.gif" position="float" orientation="portrait" hwp:id="graphic-247"/></alternatives></disp-formula>
<disp-formula id="eqn185" hwp:id="disp-formula-238"><alternatives hwp:id="alternatives-291"><graphic xlink:href="147728_eqn185.gif" position="float" orientation="portrait" hwp:id="graphic-248"/></alternatives></disp-formula>
<disp-formula id="eqn186" hwp:id="disp-formula-239"><alternatives hwp:id="alternatives-292"><graphic xlink:href="147728_eqn186.gif" position="float" orientation="portrait" hwp:id="graphic-249"/></alternatives></disp-formula>
<disp-formula id="eqn187" hwp:id="disp-formula-240"><alternatives hwp:id="alternatives-293"><graphic xlink:href="147728_eqn187.gif" position="float" orientation="portrait" hwp:id="graphic-250"/></alternatives></disp-formula></p><p hwp:id="p-220">Now, let’s set <italic toggle="yes">f</italic>(<italic toggle="yes">K<sub>i</sub></italic>) = <italic toggle="yes">c</italic>(<italic toggle="yes">K<sub>i</sub></italic> − 1) so that
<disp-formula id="eqn188" hwp:id="disp-formula-241"><alternatives hwp:id="alternatives-294"><graphic xlink:href="147728_eqn188.gif" position="float" orientation="portrait" hwp:id="graphic-251"/></alternatives></disp-formula>
<disp-formula id="eqn189" hwp:id="disp-formula-242"><alternatives hwp:id="alternatives-295"><graphic xlink:href="147728_eqn189.gif" position="float" orientation="portrait" hwp:id="graphic-252"/></alternatives></disp-formula>
<disp-formula id="eqn190" hwp:id="disp-formula-243"><alternatives hwp:id="alternatives-296"><graphic xlink:href="147728_eqn190.gif" position="float" orientation="portrait" hwp:id="graphic-253"/></alternatives></disp-formula></p><p hwp:id="p-221">Then
<disp-formula id="eqn191" hwp:id="disp-formula-244"><alternatives hwp:id="alternatives-297"><graphic xlink:href="147728_eqn191.gif" position="float" orientation="portrait" hwp:id="graphic-254"/></alternatives></disp-formula>
<disp-formula id="eqn192" hwp:id="disp-formula-245"><alternatives hwp:id="alternatives-298"><graphic xlink:href="147728_eqn192.gif" position="float" orientation="portrait" hwp:id="graphic-255"/></alternatives></disp-formula>
<disp-formula id="eqn193" hwp:id="disp-formula-246"><alternatives hwp:id="alternatives-299"><graphic xlink:href="147728_eqn193.gif" position="float" orientation="portrait" hwp:id="graphic-256"/></alternatives></disp-formula>
<disp-formula id="eqn194" hwp:id="disp-formula-247"><alternatives hwp:id="alternatives-300"><graphic xlink:href="147728_eqn194.gif" position="float" orientation="portrait" hwp:id="graphic-257"/></alternatives></disp-formula></p><p hwp:id="p-222">Hence, achieving a prescribed correlation <inline-formula hwp:id="inline-formula-54"><alternatives hwp:id="alternatives-301"><inline-graphic xlink:href="147728_inline52.gif" hwp:id="inline-graphic-54"/></alternatives></inline-formula> requires to generate a matrix <italic toggle="yes">a<sub>ij</sub></italic> with parameters
<disp-formula id="eqn195" hwp:id="disp-formula-248"><alternatives hwp:id="alternatives-302"><graphic xlink:href="147728_eqn195.gif" position="float" orientation="portrait" hwp:id="graphic-258"/></alternatives></disp-formula>
before inserting it into <inline-formula hwp:id="inline-formula-55"><alternatives hwp:id="alternatives-303"><inline-graphic xlink:href="147728_inline53.gif" hwp:id="inline-graphic-55"/></alternatives></inline-formula>.</p></sec></sec></app></app-group><fn-group hwp:id="fn-group-1"><fn id="fn1" hwp:id="fn-1" hwp:rev-id="xref-fn-1-1"><label>1</label><p hwp:id="p-223">It became prominent with the study of disordered materials such as glasses [<xref ref-type="bibr" rid="c29" hwp:id="xref-ref-29-2" hwp:rel-id="ref-29">29</xref>], before being applied to algorithmics and information theory [<xref ref-type="bibr" rid="c28" hwp:id="xref-ref-28-1" hwp:rel-id="ref-28">28</xref>], chemistry [<xref ref-type="bibr" rid="c30" hwp:id="xref-ref-30-1" hwp:rel-id="ref-30">30</xref>], economics [<xref ref-type="bibr" rid="c33" hwp:id="xref-ref-33-1" hwp:rel-id="ref-33">33</xref>] and systems biology [<xref ref-type="bibr" rid="c35" hwp:id="xref-ref-35-1" hwp:rel-id="ref-35">35</xref>].</p></fn><fn id="fn2" hwp:id="fn-2" hwp:rev-id="xref-fn-2-1"><label>2</label><p hwp:id="p-224">The term of “equilibrium” is ambiguous as it has been used for the Theory Island Bio-geography among others. A fully stochastic system can indeed be characterized by probability distributions that attain a stationary state – in physics, this is called a Non-Equilibrium Sta-tionary State, or driven stationary state, to distinguish it from the concept of equilibrium in deterministic dynamics and from thermodynamic equilibrium.</p></fn><fn id="fn3" hwp:id="fn-3" hwp:rev-id="xref-fn-3-1"><label>3</label><p hwp:id="p-225">Even with many local attractors, this picture may remain valid if the dynamics exhibit <italic toggle="yes">aging,</italic> i.e. the sytem is prone to falling into deeper and deeper attractors as time passes.</p></fn><fn id="fn4" hwp:id="fn-4" hwp:rev-id="xref-fn-4-1"><label>4</label><p hwp:id="p-226">Note however that in <xref ref-type="sec" rid="s7a" hwp:id="xref-sec-43-1" hwp:rel-id="sec-43">Sec. 7.1</xref>, we extend these results to a saturating functional response.</p></fn><fn id="fn5" hwp:id="fn-5" hwp:rev-id="xref-fn-5-1"><label>5</label><p hwp:id="p-227">The reader may recognize this idea as similar to that of moment equations, see e.g. [<xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-1" hwp:rel-id="ref-8">8</xref>].</p></fn><fn id="fn6" hwp:id="fn-6" hwp:rev-id="xref-fn-6-1"><label>6</label><p hwp:id="p-228">Note that keeping the same <italic toggle="yes">s</italic> for different pool sizes <italic toggle="yes">S</italic> means that connectivity <italic toggle="yes">c</italic> = <italic toggle="yes">s/S</italic> must decrease with pool size.</p></fn><fn id="fn7" hwp:id="fn-7" hwp:rev-id="xref-fn-7-1"><label>7</label><p hwp:id="p-229">It can be achieved with a power-law tail whose exponent is around or below 2, meaning that the variance of the theoretical distribution is arbitrarily large or even diverges, but in effect, a few massive outliers will be responsible for this variance, while most interactions will be negligible.</p></fn><fn id="fn8" hwp:id="fn-8" hwp:rev-id="xref-fn-8-1"><label>8</label><p hwp:id="p-230">In fact, this is a useful parametrization, since the Lotka-Volterra approximation to more realistic dynamics may not hold if couplings are too large <italic toggle="yes">|αij| &gt;</italic> 1 (e.g. mutualistic inter-actions would then cause abundances to diverge). Hence couplings also give an idea of the range of validity of the model.</p></fn><fn id="fn9" hwp:id="fn-9" hwp:rev-id="xref-fn-9-1"><label>9</label><p hwp:id="p-231">A classic case is Levins and Culvers’s colonization-competition tradeoff [<xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-1" hwp:rel-id="ref-19">19</xref>] where only a very special and asymmetrical structure ensures the survival of more than a single species. We discuss it further in [<xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-3" hwp:rel-id="ref-4">4</xref>].</p></fn><fn id="fn10" hwp:id="fn-10" hwp:rev-id="xref-fn-10-1"><label>10</label><p hwp:id="p-232">This assumption is correct if there is only one globally stable assembled state; the method should later be extended to settings with alternative stable states, where the addition of a new species could cause a sudden shift between different equilibria.</p></fn><fn id="fn11" hwp:id="fn-11" hwp:rev-id="xref-fn-11-1"><label>11</label><p hwp:id="p-233">Further clarifications on how randomness intervenes in interactions can be found in <xref ref-type="app" rid="app1" hwp:id="xref-app-1-3" hwp:rel-id="app-1">Appendix A</xref>.</p></fn><fn id="fn12" hwp:id="fn-12" hwp:rev-id="xref-fn-12-1"><label>12</label><p hwp:id="p-234">This assumption was found to be essential to allow high coexistence.</p></fn></fn-group></back></article>
