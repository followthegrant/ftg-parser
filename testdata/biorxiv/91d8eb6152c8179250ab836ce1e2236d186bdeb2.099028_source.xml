<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/099028</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;099028v1</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;099028</article-id><article-id pub-id-type="other" hwp:sub-type="slug">099028</article-id><article-id pub-id-type="other" hwp:sub-type="tag">099028</article-id><article-version>1.1</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Bioinformatics" hwp:journal="biorxiv"><subject>Bioinformatics</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">Software solutions for reproducible RNA-seq workflows</article-title></title-group><author-notes hwp:id="author-notes-1"><corresp id="cor1" hwp:id="corresp-1">Correspondence should be addressed to K.Y.Y. (<email hwp:id="email-1">kayee@uw.edu</email>)</corresp></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><name name-style="western" hwp:sortable="Meiss Trevor"><surname>Meiss</surname><given-names>Trevor</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-2"><name name-style="western" hwp:sortable="Hung Ling-Hong"><surname>Hung</surname><given-names>Ling-Hong</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-3"><name name-style="western" hwp:sortable="Xiong Yuguang"><surname>Xiong</surname><given-names>Yuguang</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-1" hwp:rel-id="aff-2">2</xref></contrib><contrib contrib-type="author" hwp:id="contrib-4"><name name-style="western" hwp:sortable="Sobie Eric"><surname>Sobie</surname><given-names>Eric</given-names></name><xref ref-type="aff" rid="a2" hwp:id="xref-aff-2-2" hwp:rel-id="aff-2">2</xref></contrib><contrib contrib-type="author" corresp="yes" hwp:id="contrib-5"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-1754-7577</contrib-id><name name-style="western" hwp:sortable="Yeung Ka Yee"><surname>Yeung</surname><given-names>Ka Yee</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-3" hwp:rel-id="aff-1">1</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0002-1754-7577"/></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2 xref-aff-1-3"><label>1</label><institution hwp:id="institution-1">Institute of Technology, University of Washington</institution>, Tacoma, Washington 98195-8070, <country>USA</country>.</aff><aff id="a2" hwp:id="aff-2" hwp:rev-id="xref-aff-2-1 xref-aff-2-2"><label>2</label><institution hwp:id="institution-2">Ichahn School of Medicine at Mount Sinai</institution>, New York, NY 10029, <country>USA</country>.</aff></contrib-group><pub-date pub-type="epub-original" hwp:start="2017"><year>2017</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2017-01-06T20:06:26-08:00">
    <day>6</day><month>1</month><year>2017</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2017-01-06T20:06:26-08:00">
    <day>6</day><month>1</month><year>2017</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2017-01-06T20:25:49-08:00">
    <day>6</day><month>1</month><year>2017</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2017-01-06T20:25:49-08:00">
    <day>6</day><month>1</month><year>2017</year>
  </pub-date><elocation-id>099028</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2017-01-06"><day>06</day><month>1</month><year>2017</year></date>
<date date-type="accepted" hwp:start="2017-01-06"><day>06</day><month>1</month><year>2017</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2017, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2017</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/" hwp:id="license-1"><p hwp:id="p-1">This pre-print is available under a Creative Commons License (Attribution-NonCommercial-NoDerivs 4.0 International), CC BY-NC-ND 4.0, as described at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://creativecommons.org/licenses/by-nc-nd/4.0/" ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/" hwp:id="ext-link-1">http://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link></p></license></permissions><self-uri xlink:href="099028.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2019/pdf/099028v1.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="099028.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2019/abstracts/099028v1/099028v1.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2019/fulltext/099028v1/099028v1.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><p hwp:id="p-2">Computational workflows typically consist of many tools that are usually distributed as compiled binaries or source code. Each of these software tools typically depends on other installed software, and performance could potentially vary due to versions, updates, and operating systems. We show here that the analysis of mRNA-seq data can depend on the computing environment, and we demonstrate that software containers represent practical solutions that ensure the reproducibility of RNAseq data analyses.</p></abstract><counts><page-count count="11"/></counts></article-meta></front><body><sec hwp:id="sec-1"><p hwp:id="p-3">Reproducibility of results is essential to scientific research. With the generation of diverse and complex biomedical “big data”, the development of computational methods and analysis workflows has become integral to biomedical research. Computational tools are usually distributed as compiled binaries or source code. However, running these binaries or compiling the provided source code requires additional software and depends on the computer environment on the user’s host system. Most importantly, modern biomedical workflows and pipelines consist of multiple applications and libraries, each with their own set of software dependencies. Simply depositing the code in a repository is often <underline>not</underline> enough to allow a researcher to replicate the analyses. Hence, suites such as Bioconductor<sup><xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">1</xref></sup>, BioPython<sup><xref ref-type="bibr" rid="c2" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">2</xref></sup>, Galaxy<sup><xref ref-type="bibr" rid="c3" hwp:id="xref-ref-3-1" hwp:rel-id="ref-3">3</xref></sup> and BioPerl,<sup><xref ref-type="bibr" rid="c4" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">4</xref></sup> where the user is assured that the dependencies for the components are properly installed, have become increasingly popular. Although these suites serve an important role, <italic toggle="yes">compatibility</italic> often becomes dependent on the version of the suite that is used. For example, Bioconductor<sup><xref ref-type="bibr" rid="c1" hwp:id="xref-ref-1-2" hwp:rel-id="ref-1">1</xref></sup> packages are typically run in the R programming environment, and hence, performance depends on the version of R and other packages installed on the host system. Therefore, published analytical results may not be reproduced if the software is deployed on a computer with different operating systems, alternative configurations, or different versions of installed software dependencies.</p><p hwp:id="p-4">The ultimate goal in ensuring reproducibility of bioinformatics analyses is to develop computer software such that an application will give 100% identical results regardless of the host environment. One simple strategy would be to distribute the entire computing environment in the form of a software computer that runs on top of the host system, a configuration called a virtual machine (VM). A VM is a self-contained computing environment that behaves as if it were a separate computer. Therefore, VMs make it possible to export and reproduce the exact environment regardless of the underlying hardware and operating system. While VMs can exactly replicate a given workflow and its dependencies, a separate VM would be needed for each workflow to be shared. This is a poor fit for the modular bioinformatics workflows where separate components are mixed and matched into analyses pipelines. Recently, a popular open-source project, Docker (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://www.docker.com/" ext-link-type="uri" xlink:href="https://www.docker.com/" hwp:id="ext-link-2">https://www.docker.com/</ext-link>), has become the <italic toggle="yes">de facto</italic> standard for container software. Docker provides a series of tools to construct, update, distribute and deploy software containers on Windows, Linux, Macintosh and cloud platforms. Docker also has a built-in version control system. It has been shown that Docker containers have only a minor impact on the performance of common genomic pipelines<sup><xref ref-type="bibr" rid="c5" hwp:id="xref-ref-5-1" hwp:rel-id="ref-5">5</xref></sup>. Our group has proposed solutions to add graphical user interfaces to the command-line based Docker to enhance the usability of containers among the biomedical community<sup><xref ref-type="bibr" rid="c6" hwp:id="xref-ref-6-1" hwp:rel-id="ref-6">6</xref>, <xref ref-type="bibr" rid="c7" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">7</xref></sup>.</p><p hwp:id="p-5">Here we have addressed whether RNA-seq analyses can be readily reproduced across different computing platforms. RNA sequencing has become the established method to measure genome-wide gene expression<sup><xref ref-type="bibr" rid="c8" hwp:id="xref-ref-8-1" hwp:rel-id="ref-8">8</xref>, <xref ref-type="bibr" rid="c9" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">9</xref></sup>. A key step in the analyses of RNA-seq data is the read mapping and expression quantification step in which RNA-seq reads are mapped and aligned to the reference genome, thereby generating a table of read counts across the genome<sup><xref ref-type="bibr" rid="c10" hwp:id="xref-ref-10-1" hwp:rel-id="ref-10">10</xref></sup>. A common subsequent step is to identify genes that are differentially expressed between different experimental conditions using these count-based transcript expression levels.</p><p hwp:id="p-6">We illustrate the challenge of reproducing results in the differential expression inference step. The LINCS (Library of Integrated Network-based Cellular Signatures) Consortium, funded by the National Institutes of Health Common Fund, aims to comprehensively quantify how a variety of cell types respond to pharmacological, environmental, and genetic perturbations<sup><xref ref-type="bibr" rid="c11" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">11</xref></sup>. The Drug Toxicity Signature Generation (DToxS) Center, at Icahn School of Medicine at Mount Sinai, is one of six data and signature generation centers within the LINCS Consortium. The goal of the DToxS Center is to provide insight into drug-induced adverse events by generating signatures of how drugs influence mRNA and protein levels, then using these data to build predictive statistical and mechanistic mathematical models. As an initial effort in this direction, DToxS has investigated kinase inhibitors used to treat cancers that may cause cardiotoxicity as an adverse event. In these experiments, drug-induced changes in gene expression in cardiac-derived cells are quantified by mRNA-seq, using a method that employs 3’ end-directed sequencing and tags each mRNA molecule with a Unique Molecular Identifier (UMI) Data are then analyzed using a workflow developed in house.</p><p hwp:id="p-7">To determine whether the analysis could be readily reproduced, two standard operating procedures (SOP), describing the generation of gene read counts and the identification of differentially expressed genes,<sup><xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">12</xref></sup> were implemented by an independent group (see <xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Figure 1</xref> for a summary of the SOP). The analysis workflow includes: (1) mapping sequence fragments onto genes using the Burrows-Wheeler Aligner (BWA)<sup><xref ref-type="bibr" rid="c13" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">13</xref>, <xref ref-type="bibr" rid="c14" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">14</xref></sup>, (2) performing quality control to remove outlier samples and genes using hierarchical clustering analysis, (3) data normalization using the Trimmed Mean of M-values (TMM)<sup><xref ref-type="bibr" rid="c15" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">15</xref></sup>, and (4) identification of differentially expressed genes using the edgeR package<sup><xref ref-type="bibr" rid="c16" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">16</xref></sup>.As with most bioinformatics workflows, this RNA-seq analysis pipeline consists of multiple components, and each component written in a different language. For instance, the Burrows-Wheeler Aligner (BWA) is a command line tool written in C, whereas edgeR is written in R. Each component that has been written by a different group and in a different language could potentially have different dependencies on other software and settings on the host system. For example, the edgeR Bioconductor package is dependent on both another Bioconductor package, LIMMA,<sup><xref ref-type="bibr" rid="c17" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">17</xref></sup> and on the version of R installed on the host computer.</p><fig id="fig1" position="float" orientation="portrait" hwp:id="F1" hwp:rev-id="xref-fig-1-1 xref-fig-1-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;099028v1/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Figure 1.</label><caption hwp:id="caption-1"><title hwp:id="title-2">Summary of the RNA-seq SOP from DToX. There are two main steps in the SOP: the sequence alignment step and the differential expression analyses step. A Docker container is created to correspond to each of these steps.</title></caption><graphic xlink:href="099028_fig1" position="float" orientation="portrait" hwp:id="graphic-1"/></fig><p hwp:id="p-8">We executed the code and scripts implementing the aforementioned DToxS workflow across multiple operating systems to test the ease of installation and reproducibility of the analysis. The outputs across multiple operating systems and versions of dependencies were compared to find differences that most researchers developing bioinformatics tools might not be aware of. The results from running the DToxS SOP using different versions of operating systems and R are shown in <bold><xref ref-type="table" rid="tbl1a" hwp:id="xref-table-wrap-1-1" hwp:rel-id="T1">Table 1a</xref>.</bold></p><table-wrap id="tbl1a" position="float" orientation="portrait" hwp:id="T1" hwp:rev-id="xref-table-wrap-1-1 xref-table-wrap-1-2 xref-table-wrap-1-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;099028v1/TBL1A</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T1</object-id><object-id pub-id-type="publisher-id">tbl1a</object-id><label>Table 1a.</label><caption hwp:id="caption-2"><p hwp:id="p-9">Reproducibility results comparing the expected results from Mount Sinai with results from two different operating systems with highlighted cells indicating a deviation. The differences in the output of 40 differentially expressed genes induced by a drug treatment (Trastuzumab) with the most significant p-values (“<monospace>Top–40.tsv</monospace>”) show how floating point calculations are not exactly the same. The output file from the alignment step (“<monospace>Read-Counts-Filtered.tsv</monospace>”) lists the counts of each transcript expressed across the samples. The ordering of transcripts in “<monospace>Read-Counts-Filtered.tsv</monospace>” is <bold>not</bold> guaranteed to be the same across different environments, creating downstream reproducibility issues where ordering is important.</p></caption><graphic xlink:href="099028_tbl1a" position="float" orientation="portrait" hwp:id="graphic-2"/></table-wrap><p hwp:id="p-10">BWA is designed to map sequence reads against a large reference genome and allows for mismatches and gaps. The input read sequences were generated by DToxS using the UMI protocol and were formatted as FASTQ files. BWA outputs the obtained alignment in the standard SAM (sequence alignment/map) format. A custom script from DToxS translates the SAM files into counts of transcripts, and the generated file “<monospace>Read-Counts-Filtered.tsv</monospace>" is one of the output files from the alignment step. This file lists the counts of each gene expressed across the samples. We experimented with Ubuntu, different versions of the operating system Mac OSX, R and the edgeR Bioconductor package (see <bold><xref ref-type="table" rid="tbl1a" hwp:id="xref-table-wrap-1-2" hwp:rel-id="T1">Table 1a</xref></bold>). We observe that the Ubuntu environment ordered the genes differently than Mac OSX. This difference in sorting is potentially problematic if the next stage processes gene counts in blocks, as splitting the genes at the points of discrepancy would lead to gene blocks that depend on the operating system. It is highly unlikely that academic researchers consider these types of discrepancy issues across operating systems when creating new bioinformatics tools.</p><p hwp:id="p-11">The file “<monospace>Top-4 0.tsv</monospace>” shows the output from the differential expression analysis stage, where the top 40 differentially expressed genes induced by a drug treatment (Trastuzumab) in cardiac-derived cells with the most significant p-values across the samples are listed. We observe differences in floating point calculations of the p-values even with the same version of R and edgeR when the version of Mac OSX is changed (see <bold><xref ref-type="table" rid="tbl1a" hwp:id="xref-table-wrap-1-3" hwp:rel-id="T1">Table 1a</xref></bold>). While the differences in floating point values were not large enough to change the ordering of genes, these small differences may be amplified as more analysis modules are added to the workflow, each outputting slightly different floating points.</p><p hwp:id="p-12">After observing the reproducibility from following each of the two steps from the DToxS SOP, we created two Docker containers, one for the alignment step, and a second for the differential expression step (see <bold><xref ref-type="fig" rid="fig1" hwp:id="xref-fig-1-2" hwp:rel-id="F1">Figure 1</xref></bold>). After creating the Docker containers and images, the two containerized steps of the DToxS workflow were run across different operating systems and computing environments so as to compare the outputs to the published results from DToxS. Specifically, we executed the containerized workflow on Mac OS, Microsoft Windows 10, Ubuntu, and the Google Cloud Container Engine. <xref ref-type="table" rid="tbl1b" hwp:id="xref-table-wrap-2-1" hwp:rel-id="T2">Table 1b</xref> shows that the containerized workflow yielded completely identical outputs across all environments that we tested.</p><table-wrap id="tbl1b" position="float" orientation="portrait" hwp:id="T2" hwp:rev-id="xref-table-wrap-2-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;099028v1/TBL1B</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T2</object-id><object-id pub-id-type="publisher-id">tbl1b</object-id><label>Table 1b.</label><caption hwp:id="caption-3"><p hwp:id="p-13">Reproducibility results on different operating systems using Docker. Here, the results are exactly the same no matter what operating system is used to run the Docker containers.</p></caption><graphic xlink:href="099028_tbl1b" position="float" orientation="portrait" hwp:id="graphic-3"/></table-wrap><p hwp:id="p-14">In summary, we show that the results of RNA-seq data analyses are dependent on the computing environment. These differences result in non-reproducible sorting of differentially expressed genes. Diagnostic tests often depend upon a profile of the top N differentially expressed genes, and even minor differences in sorting have the potential to significantly affect the final results. To address this issue, we show that software containers can be used to ensure the reproducibility of bioinformatics workflows by encapsulating the entire computing environment and software dependencies.</p></sec><sec id="s1" hwp:id="sec-2"><title hwp:id="title-3">M<sc>ethods</sc></title><sec id="s1a" hwp:id="sec-3"><title hwp:id="title-4">Generation of RNAseq data using the UMI protocol</title><p hwp:id="p-15">The DToxS Center generates mRNA-sequencing datasets through the following three steps:</p><sec id="s1a1" hwp:id="sec-4"><title hwp:id="title-5">Cell Culture</title><p hwp:id="p-16">Multiple samples of primary adult human cardiomyocytes (using a commercial cell line PromoCell) are subcultured and treated with different cancer drugs. After 48 hours, total RNA is extracted and transferred to a 96/384-well PCR plate for all cell samples. (SOP 1-4)</p></sec><sec id="s1a2" hwp:id="sec-5"><title hwp:id="title-6">Library Preparation</title><p hwp:id="p-17">The RNA sequence libraries are prepared according to the Single Cell RNA Barcoding and Sequencing method<sup><xref ref-type="bibr" rid="c18" hwp:id="xref-ref-18-1" hwp:rel-id="ref-18">18</xref></sup> by converting Poly(A)+ mRNA sequences to cDNA sequences decorated with universal adapter, sample barcode and unique molecular identifier (UMI)<sup><xref ref-type="bibr" rid="c19" hwp:id="xref-ref-19-1" hwp:rel-id="ref-19">19</xref></sup>. (SOP 5)</p></sec><sec id="s1a3" hwp:id="sec-6"><title hwp:id="title-7">cDNA Sequencing</title><p hwp:id="p-18">The constructed cDNA libraries are sequenced by Illumina HiSeq 2500 platform and the output sequence datasets are de-multiplexed into a set of customized paired-end sequence data files in FASTQ format: the first read file includes a 10-bp UMI tag and a 6-bp sample barcode, and the second read file contains 46-bp cDNA sequence fragment. (SOP 6)</p></sec><sec id="s1a4" hwp:id="sec-7"><title hwp:id="title-8">Data Analysis</title><p hwp:id="p-19">The cDNA sequence fragments contained in the paired-end FASTQ data files are first aligned with the human genome reference library to quantify genome-wide gene expression levels for all cell samples, and then the gene expression levels between control condition and drug-treated condition are compared for each gene to identify the differentially expressed genes (DEGs) whose expression levels are changed significantly due to drug treatment. (SOP 7-8)</p></sec></sec><sec id="s1b" hwp:id="sec-8"><title hwp:id="title-9">Standard Operating Procedures (SOPs)<sup><xref ref-type="bibr" rid="c12" hwp:id="xref-ref-12-2" hwp:rel-id="ref-12">12</xref></sup></title><list list-type="order" hwp:id="list-1"><list-item hwp:id="list-item-1"><p hwp:id="p-20">DToxS SOP CE – 1.0: PromoCell Cardiomyocyte Subculture</p></list-item><list-item hwp:id="list-item-2"><p hwp:id="p-21">DToxS SOP CE – 2.0: PromoCell Cardiomyocyte Plating for Drug Test</p></list-item><list-item hwp:id="list-item-3"><p hwp:id="p-22">DToxS SOP CE – 4.0: Drug Treatment and Cell Lysis</p></list-item><list-item hwp:id="list-item-4"><p hwp:id="p-23">DToxS SOP A – 1.0: Total RNA Isolation</p></list-item><list-item hwp:id="list-item-5"><p hwp:id="p-24">DToxS SOP A – 6.0: High-throughput mRNA Seq Library Construction for 3' Digital Gene Expression (DGE)</p></list-item><list-item hwp:id="list-item-6"><p hwp:id="p-25">DToxS SOP A – 7.0: Sequencing 3'-end Broad-Prepared mRNA Libraries</p></list-item><list-item hwp:id="list-item-7"><p hwp:id="p-26">DToxS SOP CO – 3.1: Generation of Transcript Read Counts</p></list-item><list-item hwp:id="list-item-8"><p hwp:id="p-27">DToxS SOP CO – 4.1: Identification of Differentially Expressed Genes</p></list-item></list><sec id="s1b1" hwp:id="sec-9"><title hwp:id="title-10">Software availability</title><p hwp:id="p-28">We created Docker containers for each of the alignment stage and the differential expression stage in the DToX SOP. This was done by creating Dockerfiles that describe the dependencies and commands used to run each stage. The Dockerfiles were then used to build a Docker image, which is stored on the Docker Hub (<ext-link l:rel="related" l:ref-type="uri" l:ref="https://hub.docker.com/u/biodepot/" ext-link-type="uri" xlink:href="https://hub.docker.com/u/biodepot/" hwp:id="ext-link-3">https://hub.docker.com/u/biodepot/</ext-link>) and is publicly available for download. Both Docker images start with a base Ubuntu image and then install the necessary dependencies. The Dockerfiles are available from <ext-link l:rel="related" l:ref-type="uri" l:ref="https://github.com/BioDepot" ext-link-type="uri" xlink:href="https://github.com/BioDepot" hwp:id="ext-link-4">https://github.com/BioDepot</ext-link>.</p></sec></sec></sec></body><back><ack hwp:id="ack-1"><title hwp:id="title-11">A<sc>cknowledgements</sc></title><p hwp:id="p-29">L.H.H. and K.Y.Y. are supported by NIH grant U54HL127624. Y.X. and E.S. are supported by NIH grant U54HG008098.</p></ack><sec id="s2" hwp:id="sec-10"><title hwp:id="title-12">A<sc>uthor contributions</sc></title><p hwp:id="p-30">T.M. implemented the Docker containers and conducted the reproducibility experiments. K.Y.Y. drafted the manuscript. K.Y.Y. and E.S. designed and coordinated the study. L.H.H. tested and refined the containers. Y.X. developed the computational analysis pipeline at DToxS. Y.X. and E.S. wrote the SOPs. All authors edited the manuscript.</p></sec><ref-list hwp:id="ref-list-1"><title hwp:id="title-13">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1 xref-ref-1-2"><label>1.</label><citation publication-type="journal" citation-type="journal" ref:id="099028v1.1" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Gentleman R.C."><surname>Gentleman</surname>, <given-names>R.C.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-2">Bioconductor: open software development for computational biology and bioinformatics</article-title>. <source hwp:id="source-1">Genome Biology</source> <volume>5</volume>, <fpage>R80</fpage> (<year>2004</year>).</citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1"><label>2.</label><citation publication-type="other" citation-type="journal" ref:id="099028v1.2" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-2"><source hwp:id="source-2">Biopython</source>. <ext-link l:rel="related" l:ref-type="uri" l:ref="http://biopython.org/wiki/Main_Page" ext-link-type="uri" xlink:href="http://biopython.org/wiki/Main_Page" hwp:id="ext-link-5">http://biopython.org/wiki/Main_Page</ext-link></citation></ref><ref id="c3" hwp:id="ref-3" hwp:rev-id="xref-ref-3-1"><label>3.</label><citation publication-type="journal" citation-type="journal" ref:id="099028v1.3" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Afgan E."><surname>Afgan</surname>, <given-names>E.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-3">The Galaxy platform for accessible, reproducible and collaborative biomedical analyses: 2016 update</article-title>. <source hwp:id="source-3">Nucleic acids research</source> <volume>44</volume>, <fpage>W3</fpage>–<lpage>W10</lpage> (<year>2016</year>).</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1"><label>4.</label><citation publication-type="journal" citation-type="journal" ref:id="099028v1.4" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-4"><source hwp:id="source-4">BioPerl</source>. <ext-link l:rel="related" l:ref-type="uri" l:ref="http://www.bioperl.org/wiki/Main_Page" ext-link-type="uri" xlink:href="http://www.bioperl.org/wiki/Main_Page" hwp:id="ext-link-6">http://www.bioperl.org/wiki/Main_Page</ext-link></citation></ref><ref id="c5" hwp:id="ref-5" hwp:rev-id="xref-ref-5-1"><label>5.</label><citation publication-type="journal" citation-type="journal" ref:id="099028v1.5" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Di Tommaso P."><surname>Di Tommaso</surname>, <given-names>P.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-4">The impact of Docker containers on the performance of genomic pipelines</article-title>. <source hwp:id="source-5">PeerJ</source> <volume>3</volume>, <fpage>e1273</fpage> (<year>2015</year>).</citation></ref><ref id="c6" hwp:id="ref-6" hwp:rev-id="xref-ref-6-1"><label>6.</label><citation publication-type="journal" citation-type="journal" ref:id="099028v1.6" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Hung L.H."><surname>Hung</surname>, <given-names>L.H.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kristiyanto D."><surname>Kristiyanto</surname>, <given-names>D.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Lee S.B."><surname>Lee</surname>, <given-names>S.B.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Yeung K.Y."><surname>Yeung</surname>, <given-names>K.Y.</given-names></string-name> <article-title hwp:id="article-title-5">GUIdock: Using Docker Containers with a Common Graphics User Interface to Address the Reproducibility of Research</article-title>. <source hwp:id="source-6">PLoS One</source> <volume>11</volume>, <fpage>e0152686</fpage> (<year>2016</year>).</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1"><label>7.</label><citation publication-type="journal" citation-type="journal" ref:id="099028v1.7" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Mittal V."><surname>Mittal</surname>, <given-names>V.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-6">GUIdock-VNC: Using a graphical desktop sharing system to provide a browser-based interface for containerized software</article-title>. <source hwp:id="source-7">To appear in Gigascience</source> (<year>2017</year>).</citation></ref><ref id="c8" hwp:id="ref-8" hwp:rev-id="xref-ref-8-1"><label>8.</label><citation publication-type="journal" citation-type="journal" ref:id="099028v1.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Wang Z."><surname>Wang</surname>, <given-names>Z.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gerstein M."><surname>Gerstein</surname>, <given-names>M.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Snyder M."><surname>Snyder</surname>, <given-names>M.</given-names></string-name> <article-title hwp:id="article-title-7">RNA-Seq: a revolutionary tool for transcriptomics</article-title>. <source hwp:id="source-8">Nature reviews. Genetics</source> <volume>10</volume>, <fpage>57</fpage>–<lpage>63</lpage> (<year>2009</year>).</citation></ref><ref id="c9" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1"><label>9.</label><citation publication-type="journal" citation-type="journal" ref:id="099028v1.9" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Ozsolak F."><surname>Ozsolak</surname>, <given-names>F.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Milos P.M."><surname>Milos</surname>, <given-names>P.M.</given-names></string-name> <article-title hwp:id="article-title-8">RNA sequencing: advances, challenges and opportunities</article-title>. <source hwp:id="source-9">Nature reviews. Genetics</source> <volume>12</volume>, <fpage>87</fpage>–<lpage>98</lpage> (<year>2011</year>).</citation></ref><ref id="c10" hwp:id="ref-10" hwp:rev-id="xref-ref-10-1"><label>10.</label><citation publication-type="journal" citation-type="journal" ref:id="099028v1.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="Garber M."><surname>Garber</surname>, <given-names>M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Grabherr M.G."><surname>Grabherr</surname>, <given-names>M.G.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Guttman M."><surname>Guttman</surname>, <given-names>M.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Trapnell C."><surname>Trapnell</surname>, <given-names>C.</given-names></string-name> <article-title hwp:id="article-title-9">Computational methods for transcriptome annotation and quantification using RNA-seq</article-title>. <source hwp:id="source-10">Nat Methods</source> <volume>8</volume>, <fpage>469</fpage>–<lpage>477</lpage> (<year>2011</year>).</citation></ref><ref id="c11" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1"><label>11.</label><citation publication-type="other" citation-type="journal" ref:id="099028v1.11" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-11"><source hwp:id="source-11">NIH LINCS Program</source>. <ext-link l:rel="related" l:ref-type="uri" l:ref="http://www.lincsproject.org/" ext-link-type="uri" xlink:href="http://www.lincsproject.org/" hwp:id="ext-link-7">http://www.lincsproject.org/</ext-link></citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1 xref-ref-12-2"><label>12.</label><citation publication-type="other" citation-type="journal" ref:id="099028v1.12" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-12"><source hwp:id="source-12">Drug Toxicity Signature Generation Center: Standard Operating Procedures (SOPs)</source>. <ext-link l:rel="related" l:ref-type="uri" l:ref="https://martip03.u.hpc.mssm.edu/sop.php" ext-link-type="uri" xlink:href="https://martip03.u.hpc.mssm.edu/sop.php" hwp:id="ext-link-8">https://martip03.u.hpc.mssm.edu/sop.php</ext-link></citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1"><label>13.</label><citation publication-type="journal" citation-type="journal" ref:id="099028v1.13" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="Li H."><surname>Li</surname>, <given-names>H.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Durbin R."><surname>Durbin</surname>, <given-names>R.</given-names></string-name> <article-title hwp:id="article-title-10">Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source hwp:id="source-13">Bioinformatics</source> <volume>25</volume>, <fpage>1754</fpage>–<lpage>1760</lpage> (<year>2009</year>).</citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1"><label>14.</label><citation publication-type="journal" citation-type="journal" ref:id="099028v1.14" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Li H."><surname>Li</surname>, <given-names>H.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Durbin R."><surname>Durbin</surname>, <given-names>R.</given-names></string-name> <article-title hwp:id="article-title-11">Fast and accurate long-read alignment with Burrows-Wheeler transform</article-title>. <source hwp:id="source-14">Bioinformatics</source> <volume>26</volume>, <fpage>589</fpage>–<lpage>595</lpage> (<year>2010</year>).</citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1"><label>15.</label><citation publication-type="journal" citation-type="journal" ref:id="099028v1.15" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Robinson M.D."><surname>Robinson</surname>, <given-names>M.D.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Oshlack A."><surname>Oshlack</surname>, <given-names>A.</given-names></string-name> <article-title hwp:id="article-title-12">A scaling normalization method for differential expression analysis of RNA-seq data</article-title>. <source hwp:id="source-15">Genome Biol</source> <volume>11</volume>, <fpage>R25</fpage> (<year>2010</year>).</citation></ref><ref id="c16" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1"><label>16.</label><citation publication-type="journal" citation-type="journal" ref:id="099028v1.16" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Robinson M.D."><surname>Robinson</surname>, <given-names>M.D.</given-names></string-name>, <string-name name-style="western" hwp:sortable="McCarthy D.J."><surname>McCarthy</surname>, <given-names>D.J.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Smyth G.K."><surname>Smyth</surname>, <given-names>G.K.</given-names></string-name> <article-title hwp:id="article-title-13">edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source hwp:id="source-16">Bioinformatics</source> <volume>26</volume>, <fpage>139</fpage>–<lpage>140</lpage> (<year>2010</year>).</citation></ref><ref id="c17" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1"><label>17.</label><citation publication-type="journal" citation-type="journal" ref:id="099028v1.17" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="Ritchie M.E."><surname>Ritchie</surname>, <given-names>M.E.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-14">limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>. <source hwp:id="source-17">Nucleic acids research</source> <volume>43</volume>, <fpage>e47</fpage> (<year>2015</year>).</citation></ref><ref id="c18" hwp:id="ref-18" hwp:rev-id="xref-ref-18-1"><label>18.</label><citation publication-type="journal" citation-type="journal" ref:id="099028v1.18" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-18"><string-name name-style="western" hwp:sortable="Soumillon M."><surname>Soumillon</surname>, <given-names>M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Cacchiarelli D."><surname>Cacchiarelli</surname>, <given-names>D.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Semrau S."><surname>Semrau</surname>, <given-names>S.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Oudenaarden A.v."><surname>Oudenaarden</surname>, <given-names>A.v.</given-names></string-name> &amp; <string-name name-style="western" hwp:sortable="Mikkelsen T.S."><surname>Mikkelsen</surname>, <given-names>T.S.</given-names></string-name> <article-title hwp:id="article-title-15">Characterization of directed differentiation by high-throughput single-cell RNA-Seq</article-title>. <source hwp:id="source-18">bioRxiv</source> <fpage>003236</fpage> (<year>2014</year>).</citation></ref><ref id="c19" hwp:id="ref-19" hwp:rev-id="xref-ref-19-1"><label>19.</label><citation publication-type="journal" citation-type="journal" ref:id="099028v1.19" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-19"><string-name name-style="western" hwp:sortable="Kivioja T."><surname>Kivioja</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal> <article-title hwp:id="article-title-16">Counting absolute numbers of molecules using unique molecular identifiers</article-title>. <source hwp:id="source-19">Nat Methods</source> <volume>9</volume>, <fpage>72</fpage>–<lpage>74</lpage> (<year>2011</year>).</citation></ref></ref-list></back></article>
