<article article-type="article" specific-use="production" xml:lang="en" xmlns:hw="org.highwire.hpp" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:ref="http://schema.highwire.org/Reference" xmlns:hwp="http://schema.highwire.org/Journal" xmlns:l="http://schema.highwire.org/Linking" xmlns:r="http://schema.highwire.org/Revision" xmlns:x="http://www.w3.org/1999/xhtml" xmlns:app="http://www.w3.org/2007/app" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:nlm="http://schema.highwire.org/NLM/Journal" xmlns:a="http://www.w3.org/2005/Atom" xmlns:c="http://schema.highwire.org/Compound" xmlns:hpp="http://schema.highwire.org/Publishing"><front><journal-meta><journal-id journal-id-type="hwp">biorxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title>bioRxiv</journal-title><abbrev-journal-title abbrev-type="publisher">bioRxiv</abbrev-journal-title><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1101/247924</article-id><article-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;247924v1</article-id><article-id pub-id-type="other" hwp:sub-type="pisa-master">biorxiv;247924</article-id><article-id pub-id-type="other" hwp:sub-type="slug">247924</article-id><article-id pub-id-type="other" hwp:sub-type="tag">247924</article-id><article-version>1.1</article-version><article-categories><subj-group subj-group-type="author-type"><subject>Regular Article</subject></subj-group><subj-group subj-group-type="heading"><subject>New Results</subject></subj-group><subj-group subj-group-type="hwp-journal-coll" hwp:journal-coll-id="Systems Biology" hwp:journal="biorxiv"><subject>Systems Biology</subject></subj-group></article-categories><title-group><article-title hwp:id="article-title-1">Hierarchical optimization for the efficient parametrization of ODE models</article-title></title-group><author-notes hwp:id="author-notes-1"><fn id="n1" fn-type="equal" hwp:id="fn-1" hwp:rev-id="xref-fn-1-1 xref-fn-1-2"><label>1</label><p hwp:id="p-1">C.L. and S.K. contributed equally to this work.</p></fn><fn id="n2" hwp:id="fn-2" hwp:rev-id="xref-fn-2-1"><label>2</label><p hwp:id="p-2">Lead contact, e-mail: <email hwp:id="email-1">jan.hasenauer@helmholtz-muenchen.de</email>.</p></fn></author-notes><contrib-group hwp:id="contrib-group-1"><contrib contrib-type="author" hwp:id="contrib-1"><name name-style="western" hwp:sortable="Loos Carolin"><surname>Loos</surname><given-names>Carolin</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-1" hwp:rel-id="aff-1">a</xref><xref ref-type="fn" rid="n1" hwp:id="xref-fn-1-1" hwp:rel-id="fn-1">1</xref></contrib><contrib contrib-type="author" hwp:id="contrib-2"><name name-style="western" hwp:sortable="Krause Sabrina"><surname>Krause</surname><given-names>Sabrina</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-2" hwp:rel-id="aff-1">a</xref><xref ref-type="fn" rid="n1" hwp:id="xref-fn-1-2" hwp:rel-id="fn-1">1</xref></contrib><contrib contrib-type="author" corresp="yes" hwp:id="contrib-3"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-4935-3312</contrib-id><name name-style="western" hwp:sortable="Hasenauer Jan"><surname>Hasenauer</surname><given-names>Jan</given-names></name><xref ref-type="aff" rid="a1" hwp:id="xref-aff-1-3" hwp:rel-id="aff-1">a</xref><xref ref-type="fn" rid="n2" hwp:id="xref-fn-2-1" hwp:rel-id="fn-2">2</xref><object-id pub-id-type="other" hwp:sub-type="orcid" xlink:href="http://orcid.org/0000-0002-4935-3312"/></contrib><aff id="a1" hwp:id="aff-1" hwp:rev-id="xref-aff-1-1 xref-aff-1-2 xref-aff-1-3">
<label>a</label><institution hwp:id="institution-1">Helmholtz Zentrum München-German Research Center for Environmental Health, Institute of Computational Biology, 85764 Neuherberg, Germany, and Technische Universität München, Center for Mathematics, Chair of Mathematical Modeling of Biological Systems</institution>, 85748 Garching, <country>Germany</country></aff></contrib-group><pub-date pub-type="epub-original" hwp:start="2018"><year>2018</year></pub-date><pub-date pub-type="hwp-created" hwp:start="2018-01-15T07:27:27-08:00">
    <day>15</day><month>1</month><year>2018</year>
  </pub-date><pub-date pub-type="hwp-received" hwp:start="2018-01-15T07:27:27-08:00">
    <day>15</day><month>1</month><year>2018</year>
  </pub-date><pub-date pub-type="epub" hwp:start="2018-01-15T07:32:46-08:00">
    <day>15</day><month>1</month><year>2018</year>
  </pub-date><pub-date pub-type="epub-version" hwp:start="2018-01-15T07:32:46-08:00">
    <day>15</day><month>1</month><year>2018</year>
  </pub-date><elocation-id>247924</elocation-id><history hwp:id="history-1">
<date date-type="received" hwp:start="2018-01-14"><day>14</day><month>1</month><year>2018</year></date>
<date date-type="rev-recd" hwp:start="2018-01-14"><day>14</day><month>1</month><year>2018</year></date>
<date date-type="accepted" hwp:start="2018-01-15"><day>15</day><month>1</month><year>2018</year></date>
</history><permissions><copyright-statement hwp:id="copyright-statement-1">© 2018, Posted by Cold Spring Harbor Laboratory</copyright-statement><copyright-year>2018</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/" hwp:id="license-1"><p hwp:id="p-3">This pre-print is available under a Creative Commons License (Attribution 4.0 International), CC BY 4.0, as described at <ext-link l:rel="related" l:ref-type="uri" l:ref="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" hwp:id="ext-link-1">http://creativecommons.org/licenses/by/4.0/</ext-link></p></license></permissions><self-uri xlink:href="247924.pdf" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/abstract" xlink:role="abstract" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:href="file:/content/biorxiv/vol0/issue2019/pdf/247924v1.pdf" hwp:variant="yes" content-type="pdf" xlink:role="full-text"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/full-text" xlink:role="full-text" content-type="xhtml+xml" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/source" xlink:role="source" content-type="xml" xlink:show="none" hwp:variant="yes"/><self-uri l:ref="forthcoming:yes" c:role="http://schema.highwire.org/variant/original" xlink:role="original" content-type="xml" xlink:show="none" hwp:variant="yes" xlink:href="247924.xml"/><self-uri content-type="abstract" xlink:href="file:/content/biorxiv/vol0/issue2019/abstracts/247924v1/247924v1.htslp"/><self-uri content-type="fulltext" xlink:href="file:/content/biorxiv/vol0/issue2019/fulltext/247924v1/247924v1.htslp"/><abstract hwp:id="abstract-1"><title hwp:id="title-1">Abstract</title><p hwp:id="p-4">Mathematical models are nowadays important tools for analyzing dynamics of cellular processes. The unknown model parameters are usually estimated from experimental data. These data often only provide information about the relative changes between conditions, hence, the observables contain scaling parameters. The unknown scaling parameters and corresponding noise parameters have to be inferred along with the dynamic parameters. The nuisance parameters often increase the dimensionality of the estimation problem substantially and cause convergence problems. In this manuscript, we propose a hierarchical optimization approach for estimating the parameters for ordinary differential equation (ODE) models from relative data. Our approach restructures the optimization problem into an inner and outer subproblem. These subproblems possess lower dimensions than the original optimization problem, and the inner problem can be solved analytically. We evaluated accuracy, robustness, and computational efficiency of the hierarchical approach by studying three signaling pathways. The proposed approach achieved better convergence than the standard approach and required a lower computation time. As the hierarchical optimization approach is widely applicable, it provides a powerful alternative to established approaches.</p></abstract><counts><page-count count="33"/></counts></article-meta></front><body><sec id="s1" hwp:id="sec-1" hwp:rev-id="xref-sec-1-1 xref-sec-1-2 xref-sec-1-3"><label>1</label><title hwp:id="title-2">Introduction</title><p hwp:id="p-5">Mechanistic mathematical models are used in systems biology to improve the understanding of biological processes. The mathematical models most frequently used in systems biology are probably ordinary differential equations (ODEs). ODE models are, among others, used to describe the dynamics of biochemical reaction networks (<xref rid="c7" ref-type="bibr" hwp:id="xref-ref-7-1" hwp:rel-id="ref-7">Kitano, 2002</xref>; <xref rid="c8" ref-type="bibr" hwp:id="xref-ref-8-1" hwp:rel-id="ref-8">Klipp et al., 2005</xref>; <xref rid="c16" ref-type="bibr" hwp:id="xref-ref-16-1" hwp:rel-id="ref-16">Sch¨oberl et al., 2009</xref>) and proliferation/differentiation processes (<xref rid="c2" ref-type="bibr" hwp:id="xref-ref-2-1" hwp:rel-id="ref-2">De Boer et al., 2006</xref>). The dynamic parameters of the underlying processes, e.g., reaction rates and initial conditions, are often unknown and need to be inferred from available experimental data. The inference provides information about the plausibility of the model topology, and the inferred parameters might for instance be used to predict latent variables or the response of the process to perturbations (<xref rid="c10" ref-type="bibr" hwp:id="xref-ref-10-1" hwp:rel-id="ref-10">Molinelli et al., 2013</xref>).</p><p hwp:id="p-6">The experimental data used for parameter estimation are produced by various experimental techniques. Most of these techniques provide relative data, meaning that the observation is proportional to a variable of interest, e.g., the concentration of a chemical species. This is for instance the case for Western blotting (<xref rid="c14" ref-type="bibr" hwp:id="xref-ref-14-1" hwp:rel-id="ref-14">Renart et al., 1979</xref>) and flow and mass cytometry (<xref rid="c6" ref-type="bibr" hwp:id="xref-ref-6-1" hwp:rel-id="ref-6">Herzenberg et al., 2006</xref>). If calibration curves are generated, the measured intensities can be converted to concentrations, however, in most studies this is not done due to increased resource demands.</p><p hwp:id="p-7">In the literature, two methods are employed to link relative data to mathematical models: (i) evaluation of relative changes (<xref rid="c3" ref-type="bibr" hwp:id="xref-ref-3-1" hwp:rel-id="ref-3">Degasperi et al., 2017</xref>) and (ii) introduction of scaling parameters (<xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-1" hwp:rel-id="ref-13">Raue et al., 2013</xref>). In (i), relative changes between conditions are compared, and the differences between observed and simulated relative changes are minimized. While this approach is intuitive and does not alter the dimension of the fitting problem, the noise distribution is non-trivial and the residuals are not uncorrelated (<xref rid="c20" ref-type="bibr" hwp:id="xref-ref-20-1" hwp:rel-id="ref-20">Thomaseth and Radde, 2016</xref>). This is often disregarded (see, e.g., (<xref rid="c3" ref-type="bibr" hwp:id="xref-ref-3-2" hwp:rel-id="ref-3">Degasperi et al., 2017</xref>)), which yields incorrect confidence intervals. In (ii), scaling parameters are introduced to replace the calibration curves. The scaling parameters are unknown and have to be inferred along with the dynamic parameters. While this increases the dimensionality of the optimization problem (see (<xref rid="c1" ref-type="bibr" hwp:id="xref-ref-1-1" hwp:rel-id="ref-1">Bachmann et al., 2011</xref>) for an example in which the number of parameters is doubled), the noise distribution is simple and the confidence intervals consistent. To address the dimensionality increase, <xref rid="c22" ref-type="bibr" hwp:id="xref-ref-22-1" hwp:rel-id="ref-22">Weber et al. (2011)</xref> proposed an approach for estimating the conditionally optimal scaling parameters given the dynamic parameters. This approach eliminated the scaling parameters, however, it is only applicable in the special case of additive Gaussian noise with known standard deviation. Unknown noise parameters and outlier-corrupted data (<xref rid="c9" ref-type="bibr" hwp:id="xref-ref-9-1" hwp:rel-id="ref-9">Maier et al., 2017</xref>) – as found in many applications – cannot be handled.</p><p hwp:id="p-8">In this study, we propose a hierachical optimization approach which generalizes the idea of <xref rid="c22" ref-type="bibr" hwp:id="xref-ref-22-2" hwp:rel-id="ref-22">Weber et al. (2011)</xref>. The proposed hierarchical approach allows for arbitrary noise distributions, with known and unknown noise parameters. For Gaussian and Laplace noise, we provide analytic solutions for the inner optimization problem, which boosts the computational efficiency. To illustrate the properties of the proposed approach, we present results for two models of JAK-STAT signaling and a model of RAF/MEK/ERK signaling.</p></sec><sec id="s2" hwp:id="sec-2" hwp:rev-id="xref-sec-2-1"><label>2</label><title hwp:id="title-3">Methods</title><p hwp:id="p-9">In this section, we describe the considered class of parameter estimation problems and introduce a hierarchical optimization method for estimating the parameters of ODE models from relative data under different measurement noise assumptions.</p><sec id="s2a" hwp:id="sec-3"><label>2.1</label><title hwp:id="title-4">Mechanistic modeling of biological systems</title><p hwp:id="p-10">We considered ODE models of biological processes, <disp-formula id="eqn1" hwp:id="disp-formula-1">
<alternatives hwp:id="alternatives-1"><graphic xlink:href="247924_eqn1.gif" position="float" orientation="portrait" hwp:id="graphic-1"/></alternatives>
</disp-formula> in which the time- and parameter-dependent state vector <inline-formula hwp:id="inline-formula-1">
<alternatives hwp:id="alternatives-2"><inline-graphic xlink:href="247924_inline1.gif" hwp:id="inline-graphic-1"/></alternatives>
</inline-formula> represents the concentrations of the species involved in the process and the vector field <inline-formula hwp:id="inline-formula-2">
<alternatives hwp:id="alternatives-3"><inline-graphic xlink:href="247924_inline2.gif" hwp:id="inline-graphic-2"/></alternatives>
</inline-formula> determines how the concentrations evolve over time. The vector <inline-formula hwp:id="inline-formula-3">
<alternatives hwp:id="alternatives-4"><inline-graphic xlink:href="247924_inline3.gif" hwp:id="inline-graphic-3"/></alternatives>
</inline-formula> denotes the parameters of the system, e.g., reaction rates. The initial conditions at time point <italic toggle="yes">t</italic><sub>0</sub> are given by the parameter-dependent function <inline-formula hwp:id="inline-formula-4">
<alternatives hwp:id="alternatives-5"><inline-graphic xlink:href="247924_inline4.gif" hwp:id="inline-graphic-4"/></alternatives>
</inline-formula>.</p><p hwp:id="p-11">Experimental data provide information about observables <inline-formula hwp:id="inline-formula-5">
<alternatives hwp:id="alternatives-6"><inline-graphic xlink:href="247924_inline5.gif" hwp:id="inline-graphic-5"/></alternatives>
</inline-formula>. These are obtained by the output function <inline-formula hwp:id="inline-formula-6">
<alternatives hwp:id="alternatives-7"><inline-graphic xlink:href="247924_inline6.gif" hwp:id="inline-graphic-6"/></alternatives>
</inline-formula>, which maps the states and parameters to the observables via
<disp-formula id="eqn2" hwp:id="disp-formula-2" hwp:rev-id="xref-disp-formula-2-1">
<alternatives hwp:id="alternatives-8"><graphic xlink:href="247924_eqn2.gif" position="float" orientation="portrait" hwp:id="graphic-2"/></alternatives>
</disp-formula>
Due to experimental limitations the experimental data is noise corrupted, <disp-formula id="eqn3" hwp:id="disp-formula-3">
<alternatives hwp:id="alternatives-9"><graphic xlink:href="247924_eqn3.gif" position="float" orientation="portrait" hwp:id="graphic-3"/></alternatives>
</disp-formula> with <italic toggle="yes">h<sub>i</sub></italic> denoting the <italic toggle="yes">i</italic>th component of the output function <bold>h</bold>, and indices <italic toggle="yes">k</italic> for the time point. In most applications, Gaussian noise is assumed, <inline-formula hwp:id="inline-formula-7">
<alternatives hwp:id="alternatives-10"><inline-graphic xlink:href="247924_inline7.gif" hwp:id="inline-graphic-7"/></alternatives>
</inline-formula>. For outlier-corrupted data, it was shown that the assumption of Laplace noise, <italic toggle="yes">∈<sub>i,k</sub></italic>∼Laplace(0,<italic toggle="yes">σ<sub>i,k</sub></italic>), yields more robust results (see (<xref rid="c9" ref-type="bibr" hwp:id="xref-ref-9-2" hwp:rel-id="ref-9">Maier et al., 2017</xref>) and references therein).</p><p hwp:id="p-12">The measurements are collected in a dataset <inline-formula hwp:id="inline-formula-8">
<alternatives hwp:id="alternatives-11"><inline-graphic xlink:href="247924_inline8.gif" hwp:id="inline-graphic-8"/></alternatives>
</inline-formula>. The vector <inline-formula hwp:id="inline-formula-9">
<alternatives hwp:id="alternatives-12"><inline-graphic xlink:href="247924_inline9.gif" hwp:id="inline-graphic-9"/></alternatives>
</inline-formula> comprises the measurements for the different observables. For the general case including different experiments and conditions, we refer to the Supplementary Information, <xref rid="s1" ref-type="sec" hwp:id="xref-sec-1-1" hwp:rel-id="sec-1">Section 1</xref>.</p></sec><sec id="s2b" hwp:id="sec-4"><label>2.2</label><title hwp:id="title-5">Relative experimental data</title><p hwp:id="p-13">Many experimental techniques provide data which are proportional to the measured concentrations. The scaling parameters are usually incorporated in <bold>h</bold>, defined in <xref ref-type="disp-formula" rid="eqn2" hwp:id="xref-disp-formula-2-1" hwp:rel-id="disp-formula-2">(2)</xref>. Here, for simplicity and without loss of generality, we unplugged the scaling parameters from the function <bold>h</bold> and write
<disp-formula id="ueqn1" hwp:id="disp-formula-4">
<alternatives hwp:id="alternatives-13"><graphic xlink:href="247924_ueqn1.gif" position="float" orientation="portrait" hwp:id="graphic-4"/></alternatives>
</disp-formula>
The scaling parameters <italic toggle="yes">s<sub>i,k</sub></italic> and the noise parameters <italic toggle="yes">σ<sub>i,k</sub></italic> are in the following combined in the matrices s and <italic toggle="yes"><bold>σ</bold></italic>, respectively. To distinguish the different parameter types, we refer to the parameters <italic toggle="yes"><bold>θ</bold></italic> further as dynamic parameters. In the following, we present results for the case that the scaling <italic toggle="yes">s<sub>i</sub></italic> and noise parameters <italic toggle="yes">σ<sub>i</sub></italic> are the same for each time point, but differ between observables. The general case is presented in the Supplementary Information, <xref ref-type="sec" rid="s1" hwp:id="xref-sec-1-2" hwp:rel-id="sec-1">Section 1</xref>.</p></sec><sec id="s2c" hwp:id="sec-5"><label>2.3</label><title hwp:id="title-6">Formulation of parameter estimation problem from relative data</title><p hwp:id="p-14">We used maximum likelihood methods, a commonly used approach to calibrate mathematical model, to estimate the parameters from experimental data. The likelihood function is given by <disp-formula id="eqn4" hwp:id="disp-formula-5">
<alternatives hwp:id="alternatives-14"><graphic xlink:href="247924_eqn4.gif" position="float" orientation="portrait" hwp:id="graphic-5"/></alternatives>
</disp-formula> with <italic toggle="yes">p</italic> denoting the conditional probability of <inline-formula hwp:id="inline-formula-10">
<alternatives hwp:id="alternatives-15"><inline-graphic xlink:href="247924_inline10.gif" hwp:id="inline-graphic-10"/></alternatives>
</inline-formula> given the observable <italic toggle="yes">y<sub>i,k</sub></italic> = <italic toggle="yes">s<sub>i</sub></italic> · <italic toggle="yes">h<sub>i</sub></italic>(x(<italic toggle="yes">t<sub>k</sub></italic>, <italic toggle="yes"><bold>θ</bold></italic>), <italic toggle="yes"><bold>θ</bold></italic>). This probability is for Gaussian noise
<disp-formula id="ueqn2" hwp:id="disp-formula-6">
<alternatives hwp:id="alternatives-16"><graphic xlink:href="247924_ueqn2.gif" position="float" orientation="portrait" hwp:id="graphic-6"/></alternatives>
</disp-formula>
with standard deviation <italic toggle="yes">σ<sub>i</sub></italic>, and for Laplace noise
<disp-formula id="ueqn3" hwp:id="disp-formula-7">
<alternatives hwp:id="alternatives-17"><graphic xlink:href="247924_ueqn3.gif" position="float" orientation="portrait" hwp:id="graphic-7"/></alternatives>
</disp-formula>
with scale parameter <italic toggle="yes">σ<sub>i</sub></italic>.</p><sec id="s2c1" hwp:id="sec-6"><label>2.3.1</label><title hwp:id="title-7">Standard approach to parameter estimation</title><p hwp:id="p-15">For the standard approach, the dynamic parameters <italic toggle="yes"><bold>θ</bold></italic>, the scaling parameters s, and the noise parameters <italic toggle="yes"><bold>σ</bold></italic> are estimated simultaneously. For numerical reasons, this is mostly done by minimizing the negative log-likelihood function,
<disp-formula id="eqn5" hwp:id="disp-formula-8">
<alternatives hwp:id="alternatives-18"><graphic xlink:href="247924_eqn5.gif" position="float" orientation="portrait" hwp:id="graphic-8"/></alternatives>
</disp-formula>
The parameters were combined as <bold>q</bold> = (<bold>θ,s,σ</bold>) and the optimization problem has the dimension: number of dynamic parameters <italic toggle="yes">n<sub>θ</sub></italic> + number of scaling parameters <italic toggle="yes">n<sub>s</sub></italic> + number of noise parameters <italic toggle="yes">n<sub>σ</sub></italic>. We solved it using multi-start local optimization, a method which has previously been shown to be computationally efficient. In each iteration the objective function and its gradient were computed. If the objective function for this parameters fulfills certain criteria, e.g., the norm of the gradient was below a certain threshold, the optimization was stopped, otherwise the parameter was updated and the procedure was continued (<xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-1" hwp:rel-id="F1">Figure 1A</xref>).</p><fig id="fig1" position="float" orientation="portrait" fig-type="figure" hwp:id="F1" hwp:rev-id="xref-fig-1-1 xref-fig-1-2 xref-fig-1-3"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;247924v1/FIG1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F1</object-id><object-id pub-id-type="publisher-id">fig1</object-id><label>Figure 1:</label><caption hwp:id="caption-1"><p hwp:id="p-16">Visualization of standard and hierarchical optimization schemes. (<bold>A</bold>) Local optimization in the standard approach with parameters <bold>q</bold> = (<bold><italic toggle="yes">θ</italic>,s,σ</bold>). A single iteration includes the numerical simulation of the ODE model for <italic toggle="yes"><bold>θ</bold></italic>, the evaluation of the objective function and its gradient, the evaluation of local optimality and stopping criteria, and the termination of the local optimization or the updating of the parameters. (<bold>B</bold>) Outer local optimization in the hierarchical approach with parameters <italic toggle="yes"><bold>θ</bold></italic>. A single iteration includes the numerical simulation of the ODE model <italic toggle="yes"><bold>θ</bold></italic>, the evaluation of the objective function and its gradient with respect to <italic toggle="yes"><bold>θ</bold></italic> using the results of the inner optimization problem, The iteration also includes the evaluation of local optimality and stopping criteria, and the termination of the local optimization or the updating of parameters. (<bold>C,D</bold>) Inner (local) optimization in the hierarchical approach to find the optimal scaling and noise parameter <inline-formula hwp:id="inline-formula-11">
<alternatives hwp:id="alternatives-19"><inline-graphic xlink:href="247924_inline11.gif" hwp:id="inline-graphic-11"/></alternatives>
</inline-formula> and <inline-formula hwp:id="inline-formula-12">
<alternatives hwp:id="alternatives-20"><inline-graphic xlink:href="247924_inline12.gif" hwp:id="inline-graphic-12"/></alternatives>
</inline-formula> for given dynamic parameters <italic toggle="yes"><bold>θ</bold></italic>. (<bold>C</bold>) Iterative local optimization to determine <inline-formula hwp:id="inline-formula-13">
<alternatives hwp:id="alternatives-21"><inline-graphic xlink:href="247924_inline13.gif" hwp:id="inline-graphic-13"/></alternatives>
</inline-formula> and <inline-formula hwp:id="inline-formula-14">
<alternatives hwp:id="alternatives-22"><inline-graphic xlink:href="247924_inline14.gif" hwp:id="inline-graphic-14"/></alternatives>
</inline-formula>. This does not require the numerical simulation of the model. (D) Calculating optimal parameters <inline-formula hwp:id="inline-formula-15">
<alternatives hwp:id="alternatives-23"><inline-graphic xlink:href="247924_inline15.gif" hwp:id="inline-graphic-15"/></alternatives>
</inline-formula> and <inline-formula hwp:id="inline-formula-16">
<alternatives hwp:id="alternatives-24"><inline-graphic xlink:href="247924_inline16.gif" hwp:id="inline-graphic-16"/></alternatives>
</inline-formula> using analytic expressions for common noise distributions.</p></caption><graphic xlink:href="247924_fig1" position="float" orientation="portrait" hwp:id="graphic-9"/></fig></sec><sec id="s2c2" hwp:id="sec-7"><label>2.3.2</label><title hwp:id="title-8">Hierarchical approach to parameter estimation</title><p hwp:id="p-17">Since the optimization problem (5) often possess a large number of optimization variables and can be difficult to solve, we exploited its structure. Instead of solving simultaneously for <bold>θ</bold>,<bold>s</bold>, and <bold>σ</bold>, we considered the hierarchical optimization problem (<xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-2" hwp:rel-id="F1">Figure 1B</xref>)
<disp-formula id="eqn6" hwp:id="disp-formula-9">
<alternatives hwp:id="alternatives-25"><graphic xlink:href="247924_eqn6.gif" position="float" orientation="portrait" hwp:id="graphic-10"/></alternatives>
</disp-formula>
<disp-formula id="eqn7" hwp:id="disp-formula-10">
<alternatives hwp:id="alternatives-26"><graphic xlink:href="247924_eqn7.gif" position="float" orientation="portrait" hwp:id="graphic-11"/></alternatives>
</disp-formula>
The inner problem (7) provides the optimal values <inline-formula hwp:id="inline-formula-17">
<alternatives hwp:id="alternatives-27"><inline-graphic xlink:href="247924_inline17.gif" hwp:id="inline-graphic-17"/></alternatives>
</inline-formula> and <inline-formula hwp:id="inline-formula-18">
<alternatives hwp:id="alternatives-28"><inline-graphic xlink:href="247924_inline18.gif" hwp:id="inline-graphic-18"/></alternatives>
</inline-formula> of <bold>s</bold> and <italic toggle="yes"><bold>σ</bold></italic> given <italic toggle="yes"><bold>θ</bold></italic>. These optimal values were used in the outer subproblem to determine the optimal value for <italic toggle="yes"><bold>θ</bold></italic> denoted by <inline-formula hwp:id="inline-formula-19">
<alternatives hwp:id="alternatives-29"><inline-graphic xlink:href="247924_inline19.gif" hwp:id="inline-graphic-19"/></alternatives>
</inline-formula>. It is apparent that a locally optimal point of the standard optimization problem (5) is also locally optimal for the hierarchical optimization problem (6,7), if the point is within the box constraints for the optimization.</p><p hwp:id="p-18">The formulation (6) might appear more involved, however, it possesses several properties which might be advantageous:</p><list list-type="roman-lower" hwp:id="list-1"><list-item hwp:id="list-item-1"><p hwp:id="p-19">The individual dimensions of the inner and outer subproblems (6,7) are lower than the dimension of the original problem (5).</p></list-item><list-item hwp:id="list-item-2"><p hwp:id="p-20">The optimization of the inner subproblem does not require the repeated numerical simulation of the ODE model.</p></list-item><list-item hwp:id="list-item-3"><p hwp:id="p-21">For several noise models, e.g., Gaussian and Laplace noise, the inner subproblem can be solved analytically.</p></list-item></list><p hwp:id="p-22">If (iii) holds, the scaling parameters s and also the noise parameters <italic toggle="yes"><bold>σ</bold></italic> can be calculated directly and the amount of parameters that need to be optimized iteratively reduces to <italic toggle="yes">n<sub>θ</sub></italic> (<xref rid="fig1" ref-type="fig" hwp:id="xref-fig-1-3" hwp:rel-id="F1">Figure 1C,D</xref>). In the following two sections, the analytic expressions for the Gaussian and Laplace noise are derived. For this, let observable index <italic toggle="yes">i</italic> be arbitrary but fixed.</p></sec></sec></sec><sec id="s3" hwp:id="sec-8"><title hwp:id="title-9">Analytic expressions for the optimal scaling and noise parameters for Gaussian noise</title><p hwp:id="p-23">In this study, we evaluated the scaling and noise parameters for Gaussian noise analytically. To derive the analytic expression for the optimal parameters, we exploited that the objective function for Gaussian noise,
<disp-formula id="ueqn4" hwp:id="disp-formula-11">
<alternatives hwp:id="alternatives-30"><graphic xlink:href="247924_ueqn4.gif" position="float" orientation="portrait" hwp:id="graphic-12"/></alternatives>
</disp-formula>
is continuously differentiable, and that the gradient of <italic toggle="yes">J</italic> at a local minimum is zero. For the inner subproblem this implies
<disp-formula id="ueqn5" hwp:id="disp-formula-12">
<alternatives hwp:id="alternatives-31"><graphic xlink:href="247924_ueqn5.gif" position="float" orientation="portrait" hwp:id="graphic-13"/></alternatives>
</disp-formula>
These equations can be solved analytically (see Supplementary Information, <xref ref-type="sec" rid="s1" hwp:id="xref-sec-1-3" hwp:rel-id="sec-1">Section 1</xref>), which yields
<disp-formula id="ueqn6" hwp:id="disp-formula-13">
<alternatives hwp:id="alternatives-32"><graphic xlink:href="247924_ueqn6.gif" position="float" orientation="portrait" hwp:id="graphic-14"/></alternatives>
</disp-formula>
with number of time points <italic toggle="yes">n<sub>k</sub></italic>. Consistent with the structure of the hierarchical problem (6), both formulas depend only on the dynamic parameters <italic toggle="yes"><bold>θ</bold></italic>.</p><p hwp:id="p-24">In many studies (e.g., (<xref rid="c1" ref-type="bibr" hwp:id="xref-ref-1-2" hwp:rel-id="ref-1">Bachmann et al., 2011</xref>)), observation functions of the form <inline-formula hwp:id="inline-formula-20">
<alternatives hwp:id="alternatives-33"><inline-graphic xlink:href="247924_inline21.gif" hwp:id="inline-graphic-20"/></alternatives>
</inline-formula> are used. In the Supplementary Information, <xref ref-type="sec" rid="s2" hwp:id="xref-sec-2-1" hwp:rel-id="sec-2">Section 2</xref>, we provide a derivation of the corresponding optimal parameters.</p></sec><sec id="s4" hwp:id="sec-9" hwp:rev-id="xref-sec-9-1 xref-sec-9-2 xref-sec-9-3"><title hwp:id="title-10">Analytic expressions for the optimal scaling and noise parameters for Laplace noise</title><p hwp:id="p-25">For Laplace noise the negative log-likelihood function is
<disp-formula id="eqn8" hwp:id="disp-formula-14">
<alternatives hwp:id="alternatives-34"><graphic xlink:href="247924_eqn8.gif" position="float" orientation="portrait" hwp:id="graphic-15"/></alternatives>
</disp-formula>
This objective function is continuous but not continuously differentiable. In this case, a sufficient condition for a local minimum is that the right limit value of the derivative is negative and the left limit value is positive. The derivative of (8) with respect to <italic toggle="yes">s<sub>i</sub></italic> can be written as
<disp-formula id="ueqn7" hwp:id="disp-formula-15">
<alternatives hwp:id="alternatives-35"><graphic xlink:href="247924_ueqn7.gif" position="float" orientation="portrait" hwp:id="graphic-16"/></alternatives>
</disp-formula>
As <italic toggle="yes">σ<sub>i</sub></italic> is positive, the locations of kinks in the objective function and the corresponding jumps in the derivative are independent of <italic toggle="yes">σ<sub>i</sub></italic> (<xref rid="fig2" ref-type="fig" hwp:id="xref-fig-2-1" hwp:rel-id="F2">Figure 2</xref>). Accordingly, the problem of finding <inline-formula hwp:id="inline-formula-21">
<alternatives hwp:id="alternatives-36"><inline-graphic xlink:href="247924_inline22.gif" hwp:id="inline-graphic-21"/></alternatives>
</inline-formula> reduced to checking the signs of the derivative before and after the jump points <inline-formula hwp:id="inline-formula-22">
<alternatives hwp:id="alternatives-37"><inline-graphic xlink:href="247924_inline23.gif" hwp:id="inline-graphic-22"/></alternatives>
</inline-formula>. We sorted <italic toggle="yes">s<sub>i,k</sub></italic> in increasing order and evaluated the derivatives at the midpoints between adjacent jumps, a procedure which is highly efficient as the ODE model does not have to be simulated. Given <inline-formula hwp:id="inline-formula-23">
<alternatives hwp:id="alternatives-38"><inline-graphic xlink:href="247924_inline24.gif" hwp:id="inline-graphic-23"/></alternatives>
</inline-formula>, the noise parameter <inline-formula hwp:id="inline-formula-24">
<alternatives hwp:id="alternatives-39"><inline-graphic xlink:href="247924_inline25.gif" hwp:id="inline-graphic-24"/></alternatives>
</inline-formula> follows from the work of <xref rid="c11" ref-type="bibr" hwp:id="xref-ref-11-1" hwp:rel-id="ref-11">Norton (1984</xref>)
<fig id="fig2" position="float" orientation="portrait" fig-type="figure" hwp:id="F2" hwp:rev-id="xref-fig-2-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;247924v1/FIG2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F2</object-id><object-id pub-id-type="publisher-id">fig2</object-id><label>Figure 2:</label><caption hwp:id="caption-2"><p hwp:id="p-26">Illustration of the computation of an optimal scaling parameter <inline-formula hwp:id="inline-formula-25">
<alternatives hwp:id="alternatives-40"><inline-graphic xlink:href="247924_inline20.gif" hwp:id="inline-graphic-25"/></alternatives>
</inline-formula> for Laplace noise. (<bold>A</bold>) Objective function <italic toggle="yes">J</italic> for different values of <italic toggle="yes">σ<sub>i</sub></italic>, showing that the kinks indicated by the dashed lines are independent of that value. (<bold>B</bold>) Derivative of the objective function with respect to the scaling parameter which is not defined at the kinks. The light red and dark red lines indicate the computed scaling parameter and the true optimal scaling parameter, respectively.</p></caption><graphic xlink:href="247924_fig2" position="float" orientation="portrait" hwp:id="graphic-17"/></fig>
<disp-formula id="ueqn8" hwp:id="disp-formula-16">
<alternatives hwp:id="alternatives-41"><graphic xlink:href="247924_ueqn8.gif" position="float" orientation="portrait" hwp:id="graphic-18"/></alternatives>
</disp-formula>
Both derived formulas depend only on the dynamic parameters <italic toggle="yes"><bold>θ</bold></italic>, in consistence with the structure of the hierarchical problem (6). In summary, we reformulated the original optimization problem (5) as a hierarchical optimization problem (6,7), and provided an analytic solution to the inner subproblem (7) for several relevant cases. Using the analytic solutions, the kinetic parameters can be inferred by solving a lower-dimensional problem.</p></sec><sec id="s5" hwp:id="sec-10"><label>3</label><title hwp:id="title-11">Results</title><p hwp:id="p-27">To study and compare the performance of parameter estimation from relative data using the standard approach and our hierarchical approach, we applied both to three published estimation problems.</p><sec id="s5a" hwp:id="sec-11"><label>3.1</label><title hwp:id="title-12">Models and experimental data</title><p hwp:id="p-28">The considered models describe biological signaling pathways, namely, the JAK-STAT (<xref rid="c19" ref-type="bibr" hwp:id="xref-ref-19-1" hwp:rel-id="ref-19">Swameye et al., 2003</xref>; <xref rid="c1" ref-type="bibr" hwp:id="xref-ref-1-3" hwp:rel-id="ref-1">Bachmann et al., 2011</xref>) and the RAF/MEK/ERK signaling pathway (<xref rid="c4" ref-type="bibr" hwp:id="xref-ref-4-1" hwp:rel-id="ref-4">Fiedler et al., 2016</xref>).</p><sec id="s5a1" hwp:id="sec-12"><label>3.1.1</label><title hwp:id="title-13">JAK-STAT signaling I</title><p hwp:id="p-29">The first application example we considered is the model of Epo-induced JAK-STAT signaling introduced by <xref rid="c19" ref-type="bibr" hwp:id="xref-ref-19-2" hwp:rel-id="ref-19">Swameye et al. (2003)</xref> (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-1" hwp:rel-id="F3">Figure 3A</xref>). Epo yields the phosphorylation of signal transducer and activator of transcription 5 (STAT5), which dimerizes, enters the nucleus to trigger the transcription of target genes, gets dephosphorylated, and is transported to the cytoplasm. We implemented the model which describes the phosphorylated Epo receptor concentration as a time-dependent spline (<xref rid="c15" ref-type="bibr" hwp:id="xref-ref-15-1" hwp:rel-id="ref-15">Schelker et al., 2012</xref>). For further details on the model, we refer to Supplementary Information, <xref rid="s4" ref-type="sec" hwp:id="xref-sec-9-1" hwp:rel-id="sec-9">Section 4.1</xref>.</p><fig id="fig3" position="float" orientation="portrait" fig-type="figure" hwp:id="F3" hwp:rev-id="xref-fig-3-1 xref-fig-3-2 xref-fig-3-3 xref-fig-3-4 xref-fig-3-5 xref-fig-3-6 xref-fig-3-7 xref-fig-3-8 xref-fig-3-9"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;247924v1/FIG3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F3</object-id><object-id pub-id-type="publisher-id">fig3</object-id><label>Figure 3:</label><caption hwp:id="caption-3"><p hwp:id="p-30">Models and experimental data. (<bold>A,B</bold>) JAK-STAT I. (<bold>A</bold>) Illustration of the model according to <xref rid="c19" ref-type="bibr" hwp:id="xref-ref-19-3" hwp:rel-id="ref-19">Swameye et al. (2003)</xref>. Arrows represent biochemical reactions, and the observables of the model used are highlighted by boxes. (<bold>B</bold>) Experimental data and fitted trajectories for the best parameter found with multi-start local optimization with 100 starts. The results are shown for the standard (dotted lines) and hierarchical (solid lines) approach for optimization for Gaussian and Laplace noise. (<bold>C,D</bold>) JAK-STAT II. (<bold>C</bold>) Illustration of the model according to <xref rid="c1" ref-type="bibr" hwp:id="xref-ref-1-4" hwp:rel-id="ref-1">Bachmann et al. (2011)</xref>. (<bold>D</bold>) Experimental data and fitted trajectories for the best parameter found with multi-start local optimization for 200 starts. 33 out of 541 data points are shown. (<bold>E-G</bold>) RAF/MEK/ERK. (<bold>E</bold>) Illustration of the model according to <xref rid="c4" ref-type="bibr" hwp:id="xref-ref-4-2" hwp:rel-id="ref-4">Fiedler et al. (2016)</xref>. (<bold>F,G</bold>) Experimental data and fitted trajectories for the best parameter found with multi-start local optimization for 500 starts. different markers indicate the different blots. The data is scaled according to the estimated scaling parameters, yielding different visualizations for different parameters, as obtained with the Gaussian and the Laplace noise assumption. (<bold>F</bold>) Fitted trajectories for Gaussian noise for the standard (dotted line) and hierarchical (solid line) approach for optimization. (<bold>G</bold>) Fitted trajectories for Laplace noise.</p></caption><graphic xlink:href="247924_fig3" position="float" orientation="portrait" hwp:id="graphic-19"/></fig><p hwp:id="p-31">The model parameters were estimated using immunoblotting data for the phosphorylated Epo receptor (pEpoR), phosphorylated STAT5 (pSTAT5), and the total amount of STAT5 in the cytoplasm (tSTAT5) (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-2" hwp:rel-id="F3">Figure 3B</xref>). Experimental data are available for 16 different time points. Since immunoblotting only provides relative data, the scaling parameters for the observables need to be estimated from the data. As proposed by <xref rid="c15" ref-type="bibr" hwp:id="xref-ref-15-2" hwp:rel-id="ref-15">Schelker et al. (2012</xref>), the scaling parameter for pEpoR has been fixed to avoid structural non-identifiabilities (<xref rid="c12" ref-type="bibr" hwp:id="xref-ref-12-1" hwp:rel-id="ref-12">Raue et al., 2009</xref>). This yields <italic toggle="yes">n<sub>θ</sub></italic> = 11 dynamic parameters (see Supplementary Information, <xref rid="s4" ref-type="sec" hwp:id="xref-sec-9-2" hwp:rel-id="sec-9">Section 4.1</xref>), <italic toggle="yes">n<sub>s</sub></italic> = 2 scaling parameters, and <italic toggle="yes">n<sub>σ</sub></italic> = 3 noise parameters.</p></sec><sec id="s5a2" hwp:id="sec-13"><label>3.1.2</label><title hwp:id="title-14">JAK-STAT signaling II</title><p hwp:id="p-32">The second application example is the model of JAK-STAT signaling introduced by <xref rid="c1" ref-type="bibr" hwp:id="xref-ref-1-5" hwp:rel-id="ref-1">Bachmann et al. (2011)</xref>. This model provides more details compared to the previous one. It includes, for instance, gene expression of cytokine-inducible SH2-containing protein (CIS) and suppressor of cytokine signaling 3 (SOCS3), and possesses more state variables and parameters (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-3" hwp:rel-id="F3">Figure 3C</xref>).</p><p hwp:id="p-33">The model parameters were estimated using immunoblotting, qRT-PCR, and quantitative mass spectrometry data (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-4" hwp:rel-id="F3">Figure 3D</xref> and Supplementary Information, <xref rid="figS4" ref-type="fig" hwp:id="xref-fig-8-1" hwp:rel-id="F8">Figure S4</xref>). To model the observables <xref rid="c1" ref-type="bibr" hwp:id="xref-ref-1-6" hwp:rel-id="ref-1">Bachmann et al. (2011)</xref> used <italic toggle="yes">n<sub>s</sub></italic> = 43 scaling parameters, and <italic toggle="yes">n<sub>σ</sub></italic> = 11 noise parameters, yielding <italic toggle="yes">n<sub>θ</sub></italic> = 58 remaining parameters. Some scaling and noise parameters are shared between experiments and some are shared between observables. For this model, most of the observables were compared at the log<sub>10</sub> scale (see Supplementary Information, <xref rid="s4" ref-type="sec" hwp:id="xref-sec-9-3" hwp:rel-id="sec-9">Section 4.2</xref>).</p></sec><sec id="s5a3" hwp:id="sec-14"><label>3.1.3</label><title hwp:id="title-15">RAF/MEK/ERK signaling</title><p hwp:id="p-34">The third application example we considered is the model of RAF/MEK/ERK signaling introduced by <xref rid="c4" ref-type="bibr" hwp:id="xref-ref-4-3" hwp:rel-id="ref-4">Fiedler et al. (2016</xref>). The model describes the phosphorylation cascade and a negative feedback of phospho-rylated ERK on RAF phosphorylation (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-5" hwp:rel-id="F3">Figure 3E</xref>).</p><p hwp:id="p-35"><xref rid="c4" ref-type="bibr" hwp:id="xref-ref-4-4" hwp:rel-id="ref-4">Fiedler et al. (2016</xref>) collected Western blot data for HeLa cells for two observables, phosphorylated MEK, and phosphorylated ERK, with four replicates at seven time points (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-6" hwp:rel-id="F3">Figure 3F,G</xref>). Each observable and replicate was assumed to have different scaling and noise parameters, yielding 16 additional parameters (<xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-1" hwp:rel-id="F4">Figure 4A</xref>).</p><fig id="fig4" position="float" orientation="portrait" fig-type="figure" hwp:id="F4" hwp:rev-id="xref-fig-4-1 xref-fig-4-2 xref-fig-4-3 xref-fig-4-4 xref-fig-4-5 xref-fig-4-6 xref-fig-4-7 xref-fig-4-8"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;247924v1/FIG4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F4</object-id><object-id pub-id-type="publisher-id">fig4</object-id><label>Figure 4:</label><caption hwp:id="caption-4"><p hwp:id="p-36">Evaluation of the standard and hierarchical approach for three application examples. (<bold>A</bold>) Number of parameters which need to be optimized numerically. (<bold>B</bold>) Likelihood waterfall plot for the JAK-STAT model I. The ascendingly sorted negative log-likelihood values are shown for both approaches (standard and hierarchical) and noise distributions (Gaussian and Laplace). (<bold>C-E</bold>) Comparison of the two optimization approaches and two noise distribution for the three models. The noise model with the better likelihood function is highlighted in the label. (<bold>C</bold>) Percentage of converged starts over all performed local optimizations. (<bold>D</bold>) Boxplot for the CPU time needed per start. (<bold>E</bold>) CPU time needed per converged start.</p></caption><graphic xlink:href="247924_fig4" position="float" orientation="portrait" hwp:id="graphic-20"/></fig></sec></sec><sec id="s5b" hwp:id="sec-15"><label>3.2</label><title hwp:id="title-16">Evaluation of the approaches</title><p hwp:id="p-37">We performed parameter estimation for the application examples using the standard and the hierarchical approach. For each example, the case of Gaussian and Laplace noise was considered. The resulting optimization problems were solved with the MATLAB toolbox PESTO (<xref rid="c18" ref-type="bibr" hwp:id="xref-ref-18-1" hwp:rel-id="ref-18">Stapor et al., 2017</xref>), using multi-start local optimization, an approach which was previously found to be computationally efficient and reliable (<xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-2" hwp:rel-id="ref-13">Raue et al., 2013</xref>). Initial points were sampled uniformly within their parameter boundaries and local optimization was performed using the interior point method implemented in the MATLAB function <monospace>fmincon.m.</monospace> Numerical simulation and forward sensitivity analysis for gradient evaluation was performed using the MATLAB toolbox AMICI (<xref rid="c5" ref-type="bibr" hwp:id="xref-ref-5-1" hwp:rel-id="ref-5">Fröhlich et al., 2017</xref>), which provides an interface to CVODES (<xref rid="c17" ref-type="bibr" hwp:id="xref-ref-17-1" hwp:rel-id="ref-17">Serban and Hindmarsh, 2005</xref>). To improve convergence and computational efficiency, log<sub>10</sub>-transformed parameters were used for the optimization.</p><sec id="s5b1" hwp:id="sec-16"><label>3.2.1</label><title hwp:id="title-17">Qualitative comparison of optimization approaches for different noise distributions</title><p hwp:id="p-38">As the standard and hierarchical approach should in principle be able to achieve the same fit, we first studied the agreement of trajectories for the optimal parameters. We found that they coincide for the JAK-STAT model I and the RAF/MEK/ERK model, indicating that the hierarchical approach is able to find the same optimal value as the standard approach (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-7" hwp:rel-id="F3">Figure 3B,F,G</xref>). Also the best likelihood values which were found for these two models by the two approaches coincide (<xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-2" hwp:rel-id="F4">Figure 4B</xref> and Supplementary Information, <xref rid="figS5" ref-type="fig" hwp:id="xref-fig-9-1" hwp:rel-id="F9">Figure S5</xref>). Only for the JAK-STAT model II for the case of Laplace noise, the fitted trajectories deviate (<xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-8" hwp:rel-id="F3">Figure 3D</xref>). Insertion of the optimum found by the hierarchical approach in the objective function of the standard approach revealed that the standard approach missed the optimal point (SupplementaryInformation, <xref rid="figS3" ref-type="fig" hwp:id="xref-fig-7-1" hwp:rel-id="F7">Figure S3</xref>). As expected, there are di erences between the results obtained with Gaussian and Laplace noise, which is visible in the trajectories and the corresponding likelihood values. Interestingly, for each model the likelihood values achieved using Laplace noise were better than for Gaussian noise (Supplementary Information, <xref rid="figS1" ref-type="fig" hwp:id="xref-fig-5-1" hwp:rel-id="F5">Figure S1C</xref>). This indicates that the Laplace distribution with its heavier tail is more appropriate than the Gaussian distribution for the considered estimation problems.</p></sec><sec id="s5b2" hwp:id="sec-17"><label>3.2.2</label><title hwp:id="title-18">Convergence of optimizers</title><p hwp:id="p-39">As the performance of multi-start local methods depends directly on the convergence of the local optimizers, we assessed for how many starting points the local optimizer reached the best objective function value found across all runs. This was done by studying the likelihood waterfall plots (<xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-3" hwp:rel-id="F4">Figure 4B</xref>). We found that the proposed hierarchical approach achieved consistently a higher fraction of converged starts than the standard approach (<xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-4" hwp:rel-id="F4">Figure 4C</xref>). Local optimization using the hierarchical approach converged on average in 25.38% of the runs while the standard approach converged on average in 12.13% of the runs.</p><p hwp:id="p-40">The application examples vary with respect to the total number of parameters and in the number of parameters which correspond to scaling or noise parameters (<xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-5" hwp:rel-id="F4">Figure 4A</xref>). While for the JAK-STAT model I only five parameters could be optimized analytically, for the JAK-STAT model II almost half of the parameters correspond to scaling or noise parameters. Interestingly, even when the dimension of the optimization problem was only reduced by few parameters, we observed a substantial improvement of the convergence (<xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-6" hwp:rel-id="F4">Figure 4C</xref>).</p></sec><sec id="s5b3" hwp:id="sec-18"><label>3.2.3</label><title hwp:id="title-19">Computational efficiency</title><p hwp:id="p-41">As computation resources are often limiting, we finally analyzed the computation time per converged start. We found that on average, the computation time per start was lower for the hierarchical approach than for the standard approach (<xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-7" hwp:rel-id="F4">Figure 4D</xref>). In combination with the improved convergence rate, this resulted in a substantially reduced computation time per converged start, aka a start which reach the minimal value observed across all starts (<xref rid="fig4" ref-type="fig" hwp:id="xref-fig-4-8" hwp:rel-id="F4">Figure 4E</xref>). Given a fixed computational budget, the hierarchical approach achieved on average 5.52 times more optimization runs which reached the best objective function values than the standard approach.</p><p hwp:id="p-42">In summary, the application of our hierarchical approach to parameter estimation from relative data to the models shows consistently that our approach yields parameter values of the same quality as the standard method, while achieving better convergence and reducing the computation time substantially.</p></sec></sec></sec><sec id="s6" hwp:id="sec-19"><label>4</label><title hwp:id="title-20">Conclusion</title><p hwp:id="p-43">The statistically rigorous estimation of model parameters from relative data requires non-standard statistical models (<xref rid="c3" ref-type="bibr" hwp:id="xref-ref-3-3" hwp:rel-id="ref-3">Degasperi et al., 2017</xref>) or scaling parameters (<xref rid="c13" ref-type="bibr" hwp:id="xref-ref-13-3" hwp:rel-id="ref-13">Raue et al., 2013</xref>). Unfortunately, the former is not supported by established toolboxes and the latter increases the dimensionality of the estimation problem. In this manuscript, we introduced a hierarchical approach which avoids the increase of dimensionality and is applicable to a broad range of noise distributions. For Gaussian and Laplace noise we provided analytic expressions. The approach can be used for combinations of relative and absolute data, and for different optimization methods, including least-squares methods or global optimization methods such as particle swarm optimization (<xref rid="c21" ref-type="bibr" hwp:id="xref-ref-21-1" hwp:rel-id="ref-21">Vaz and Vicente, 2009</xref>) (see Supplementary Information, <xref rid="figS2" ref-type="fig" hwp:id="xref-fig-6-1" hwp:rel-id="F6">Figure S2</xref>).</p><p hwp:id="p-44">We evaluated the performance of our hierarchical approach and compared it to the standard approach for three models, which vary in their complexity. For all applications, we found that our hierarchical approach yielded fits of the same or better quality. In addition, convergence was improved and the computation time was shortened substantially. We demonstrated that our approach can also be used when relative and absolute data are modeled together in an experiment, and when several observables or experiments share scaling and/or noise parameters. This renders our approach applicable to a wide range of mathematical models studied in systems and computational biology. We provided a generic implementation of the objective function for the hierarchical approach for Gaussian and Laplace noise. The objective function is provided in the Supplementary Information (along with the rest of the code) and included in the MATLAB toolbox PESTO (<xref rid="c18" ref-type="bibr" hwp:id="xref-ref-18-2" hwp:rel-id="ref-18">Stapor et al., 2017</xref>).</p><p hwp:id="p-45">In addition to the scaling and noise parameters, also other parameters which only contribute to the mapping from the states to the observables, could be optimized analytically. This includes o set parameters, which are used to model background intensities or unspecific binding. Extending our approach to also calculate these parameters analytically would decrease the parameters in the outer optimization even more.</p><p hwp:id="p-46">We employed forward sensitivities for the calculation of the objective function gradient. However, it has been shown that for large-scale models with a high number of parameters, adjoint sensitivities can reduce the computation time needed for simulation (<xref rid="c5" ref-type="bibr" hwp:id="xref-ref-5-2" hwp:rel-id="ref-5">Fröhlich et al., 2017</xref>). Thus, a further promising approach would be the combination of both complementary approaches for the handling of large-scale models.</p><p hwp:id="p-47">To summarize, employing our hierarchical approach for optimization yielded more robust results and speed up the computation time. This renders the approach valuable for estimating parameters from relative data. The proposed approach might facilitate the handling of large-scale models, which possess many measurement parameters.</p></sec><sec hwp:id="sec-20"><title hwp:id="title-21">Funding</title><p hwp:id="p-48">This work has been supported by the European Union’s Horizon 2020 research and innovation program under grant agreement no. 686282</p></sec></body><back><ref-list hwp:id="ref-list-1"><title hwp:id="title-22">References</title><ref id="c1" hwp:id="ref-1" hwp:rev-id="xref-ref-1-1 xref-ref-1-2 xref-ref-1-3 xref-ref-1-4 xref-ref-1-5 xref-ref-1-6"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.1" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-1"><string-name name-style="western" hwp:sortable="Bachmann J."><given-names>J.</given-names> <surname>Bachmann</surname></string-name>, <string-name name-style="western" hwp:sortable="Raue A."><given-names>A.</given-names> <surname>Raue</surname></string-name>, <string-name name-style="western" hwp:sortable="Schilling M."><given-names>M.</given-names> <surname>Schilling</surname></string-name>, <string-name name-style="western" hwp:sortable="Böohm M. E."><given-names>M. E.</given-names> <surname>Böohm</surname></string-name>, <string-name name-style="western" hwp:sortable="Kreutz C."><given-names>C.</given-names> <surname>Kreutz</surname></string-name>, <string-name name-style="western" hwp:sortable="Kaschek D."><given-names>D.</given-names> <surname>Kaschek</surname></string-name>, <string-name name-style="western" hwp:sortable="Busch H."><given-names>H.</given-names> <surname>Busch</surname></string-name>, <string-name name-style="western" hwp:sortable="Gretz N."><given-names>N.</given-names> <surname>Gretz</surname></string-name>, <string-name name-style="western" hwp:sortable="Lehmann W. D."><given-names>W. D.</given-names> <surname>Lehmann</surname></string-name>, <string-name name-style="western" hwp:sortable="Timmer J."><given-names>J.</given-names> <surname>Timmer</surname></string-name>, and <string-name name-style="western" hwp:sortable="Klingmüller U."><given-names>U.</given-names> <surname>Klingmüller</surname></string-name>. <article-title hwp:id="article-title-2">Division of labor by dual feedback regulators controls JAK2/STAT5 signaling over broad ligand range. Mol</article-title>. <source hwp:id="source-1">Syst. Biol</source>., <volume>7</volume>(<issue>1</issue>):<fpage>516</fpage>, <month>July</month> <year>2011</year></citation></ref><ref id="c2" hwp:id="ref-2" hwp:rev-id="xref-ref-2-1"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.2" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-2"><string-name name-style="western" hwp:sortable="De Boer R. J."><given-names>R. J.</given-names> <surname>De Boer</surname></string-name>, <string-name name-style="western" hwp:sortable="Ganusov V. V."><given-names>V. V.</given-names> <surname>Ganusov</surname></string-name>, <string-name name-style="western" hwp:sortable="Milutinoviò D."><given-names>D.</given-names> <surname>Milutinoviò</surname></string-name>, <string-name name-style="western" hwp:sortable="Hodgkin P. D."><given-names>P. D.</given-names> <surname>Hodgkin</surname></string-name>, and <string-name name-style="western" hwp:sortable="Perelson A. S."><given-names>A. S.</given-names> <surname>Perelson</surname></string-name>. <article-title hwp:id="article-title-3">Estimating lymphocyte division and death rates from CFSE data</article-title>. <source hwp:id="source-2">Bull. Math. Biol</source>., <volume>68</volume>(<issue>5</issue>):<fpage>1011</fpage>–<lpage>1031</lpage>, <year>2006</year></citation></ref><ref id="c3" hwp:id="ref-3" hwp:rev-id="xref-ref-3-1 xref-ref-3-2 xref-ref-3-3"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.3" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-3"><string-name name-style="western" hwp:sortable="Degasperi A."><given-names>A.</given-names> <surname>Degasperi</surname></string-name>, <string-name name-style="western" hwp:sortable="Fey D."><given-names>D.</given-names> <surname>Fey</surname></string-name>, and <string-name name-style="western" hwp:sortable="Kholodenko B. N."><given-names>B. N.</given-names> <surname>Kholodenko</surname></string-name>. <article-title hwp:id="article-title-4">Performance of objective functions and optimisation procedures for parameter estimation in system biology models</article-title>. <source hwp:id="source-3">npj Syst Biol Appl</source>, <volume>3</volume>(<issue>1</issue>):<fpage>20</fpage>, <year>2017</year>.</citation></ref><ref id="c4" hwp:id="ref-4" hwp:rev-id="xref-ref-4-1 xref-ref-4-2 xref-ref-4-3 xref-ref-4-4"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.4" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-4"><string-name name-style="western" hwp:sortable="Fiedler A."><given-names>A.</given-names> <surname>Fiedler</surname></string-name>, <string-name name-style="western" hwp:sortable="Raeth S."><given-names>S.</given-names> <surname>Raeth</surname></string-name>, <string-name name-style="western" hwp:sortable="Theis F. J."><given-names>F. J.</given-names> <surname>Theis</surname></string-name>, <string-name name-style="western" hwp:sortable="Hausser A."><given-names>A.</given-names> <surname>Hausser</surname></string-name>, and <string-name name-style="western" hwp:sortable="Hasenauer J."><given-names>J.</given-names> <surname>Hasenauer</surname></string-name>. <article-title hwp:id="article-title-5">Tailored parameter optimization methods for ordinary differential equation models with steady-state constraints</article-title>. <source hwp:id="source-4">BMC Syst. Biol.</source>, <volume>10</volume>(<issue>80</issue>), <month>Aug</month>. <year>2016</year>.</citation></ref><ref id="c5" hwp:id="ref-5" hwp:rev-id="xref-ref-5-1 xref-ref-5-2"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.5" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-5"><string-name name-style="western" hwp:sortable="Fröhlich F."><given-names>F.</given-names> <surname>Fröhlich</surname></string-name>, <string-name name-style="western" hwp:sortable="Kaltenbacher B."><given-names>B.</given-names> <surname>Kaltenbacher</surname></string-name>, <string-name name-style="western" hwp:sortable="Theis F. J."><given-names>F. J.</given-names> <surname>Theis</surname></string-name>, and <string-name name-style="western" hwp:sortable="Hasenauer J."><given-names>J.</given-names> <surname>Hasenauer</surname></string-name>. <article-title hwp:id="article-title-6">Scalable parameter estimation for genome-scale biochemical reaction networks</article-title>. <source hwp:id="source-5">PLoS Comput. Biol</source>., <volume>13</volume>(<issue>1</issue>):<fpage>e1005331</fpage>, <month>Jan</month>. <year>2017</year>.</citation></ref><ref id="c6" hwp:id="ref-6" hwp:rev-id="xref-ref-6-1"><citation ref:id="247924v1.6" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-6"><string-name name-style="western" hwp:sortable="Herzenberg L. A."><given-names>L. A.</given-names> <surname>Herzenberg</surname></string-name>, <string-name name-style="western" hwp:sortable="Tung J."><given-names>J.</given-names> <surname>Tung</surname></string-name>, <string-name name-style="western" hwp:sortable="Moore W. A."><given-names>W. A.</given-names> <surname>Moore</surname></string-name>, <string-name name-style="western" hwp:sortable="Herzenberg L. A."><given-names>L. A.</given-names> <surname>Herzenberg</surname></string-name>, and <string-name name-style="western" hwp:sortable="Parks D. R."><given-names>D. R.</given-names> <surname>Parks</surname></string-name>. <article-title hwp:id="article-title-7">Interpreting flow cytometry data: A guide for the perplexed</article-title>. <source hwp:id="source-6">Nat. Immunol.</source>, <volume>7</volume>(<issue>7</issue>):<fpage>681</fpage>–<lpage>685</lpage>, <month>July</month> <year>2006</year>.</citation></ref><ref id="c7" hwp:id="ref-7" hwp:rev-id="xref-ref-7-1"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.7" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-7"><string-name name-style="western" hwp:sortable="Kitano H."><given-names>H.</given-names> <surname>Kitano</surname></string-name>. <article-title hwp:id="article-title-8">Systems biology: A brief overview</article-title>. <source hwp:id="source-7">Science</source>, <volume>295</volume>(<issue>5560</issue>):<fpage>1662</fpage>–<lpage>1664</lpage>, <month>Mar</month>. <year>2002</year></citation></ref><ref id="c8" hwp:id="ref-8" hwp:rev-id="xref-ref-8-1"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.8" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-8"><string-name name-style="western" hwp:sortable="Klipp E."><given-names>E.</given-names> <surname>Klipp</surname></string-name>, <string-name name-style="western" hwp:sortable="Nordlander B."><given-names>B.</given-names> <surname>Nordlander</surname></string-name>, <string-name name-style="western" hwp:sortable="Krüger R."><given-names>R.</given-names> <surname>Krüger</surname></string-name>, <string-name name-style="western" hwp:sortable="Gennemark P."><given-names>P.</given-names> <surname>Gennemark</surname></string-name>, and <string-name name-style="western" hwp:sortable="Hohmann S."><given-names>S.</given-names> <surname>Hohmann</surname></string-name>. <article-title hwp:id="article-title-9">Integrative model of the response of yeast to osmotic shock</article-title>. <source hwp:id="source-8">Nat. Biotechnol</source>., <volume>23</volume>(<issue>8</issue>):<fpage>975</fpage>–<lpage>982</lpage>, <month>Aug</month> <year>2005</year></citation></ref><ref id="c9" hwp:id="ref-9" hwp:rev-id="xref-ref-9-1 xref-ref-9-2"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.9" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-9"><string-name name-style="western" hwp:sortable="Maier C."><given-names>C.</given-names> <surname>Maier</surname></string-name>, <string-name name-style="western" hwp:sortable="Loos C."><given-names>C.</given-names> <surname>Loos</surname></string-name>, and <string-name name-style="western" hwp:sortable="Hasenauer J."><given-names>J.</given-names> <surname>Hasenauer</surname></string-name>. <article-title hwp:id="article-title-10">Robust parameter estimation for dynamical systems from outlier-corrupted data</article-title>. <source hwp:id="source-9">Bioinformatics</source>, <volume>33</volume>(<issue>5</issue>):<fpage>718</fpage>–<lpage>725</lpage>, <month>Mar</month>. <year>2017</year>.</citation></ref><ref id="c10" hwp:id="ref-10" hwp:rev-id="xref-ref-10-1"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.10" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-10"><string-name name-style="western" hwp:sortable="Molinelli E. J."><given-names>E. J.</given-names> <surname>Molinelli</surname></string-name>, <string-name name-style="western" hwp:sortable="Korkut A."><given-names>A.</given-names> <surname>Korkut</surname></string-name>, <string-name name-style="western" hwp:sortable="Wang W."><given-names>W.</given-names> <surname>Wang</surname></string-name>, <string-name name-style="western" hwp:sortable="Miller M. L."><given-names>M. L.</given-names> <surname>Miller</surname></string-name>, <string-name name-style="western" hwp:sortable="Gauthier N. P."><given-names>N. P.</given-names> <surname>Gauthier</surname></string-name>, <string-name name-style="western" hwp:sortable="Jing X."><given-names>X.</given-names> <surname>Jing</surname></string-name>, <string-name name-style="western" hwp:sortable="Kaushik P."><given-names>P.</given-names> <surname>Kaushik</surname></string-name>, <string-name name-style="western" hwp:sortable="He Q."><given-names>Q.</given-names> <surname>He</surname></string-name>, <string-name name-style="western" hwp:sortable="Mills G."><given-names>G.</given-names> <surname>Mills</surname></string-name>, <string-name name-style="western" hwp:sortable="Solit D. B."><given-names>D. B.</given-names> <surname>Solit</surname></string-name>, <string-name name-style="western" hwp:sortable="Pratilas C. A."><given-names>C. A.</given-names> <surname>Pratilas</surname></string-name>, <string-name name-style="western" hwp:sortable="Weigt M."><given-names>M.</given-names> <surname>Weigt</surname></string-name>, <string-name name-style="western" hwp:sortable="Braunstein A."><given-names>A.</given-names> <surname>Braunstein</surname></string-name>, <string-name name-style="western" hwp:sortable="Pagnani A."><given-names>A.</given-names> <surname>Pagnani</surname></string-name>, <string-name name-style="western" hwp:sortable="Zecchina R."><given-names>R.</given-names> <surname>Zecchina</surname></string-name>, and <string-name name-style="western" hwp:sortable="Sander C."><given-names>C.</given-names> <surname>Sander</surname></string-name>. <article-title hwp:id="article-title-11">Perturbation biology: Inferring signaling networks in cellular systems</article-title>. <source hwp:id="source-10">PLoS Comput. Biol</source>., <volume>9</volume>(<issue>12</issue>):<fpage>e1003290</fpage>, <month>Dec</month>. <year>2013</year>.</citation></ref><ref id="c11" hwp:id="ref-11" hwp:rev-id="xref-ref-11-1"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.11" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-11"><string-name name-style="western" hwp:sortable="Norton R. M."><given-names>R. M.</given-names> <surname>Norton</surname></string-name>. <article-title hwp:id="article-title-12">The double exponential distribution: Using calculus to find a maximum likelihood estimator</article-title>. <source hwp:id="source-11">Am. Stat</source>., <volume>38</volume>(<issue>2</issue>):<fpage>135</fpage>–<lpage>136</lpage>, <month>May</month> <year>1984</year></citation></ref><ref id="c12" hwp:id="ref-12" hwp:rev-id="xref-ref-12-1"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.12" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-12"><string-name name-style="western" hwp:sortable="Raue A."><given-names>A.</given-names> <surname>Raue</surname></string-name>, <string-name name-style="western" hwp:sortable="Kreutz C."><given-names>C.</given-names> <surname>Kreutz</surname></string-name>, <string-name name-style="western" hwp:sortable="Maiwald T."><given-names>T.</given-names> <surname>Maiwald</surname></string-name>, <string-name name-style="western" hwp:sortable="Bachmann J."><given-names>J.</given-names> <surname>Bachmann</surname></string-name>, <string-name name-style="western" hwp:sortable="Schilling M."><given-names>M.</given-names> <surname>Schilling</surname></string-name>, <string-name name-style="western" hwp:sortable="Klingmüller U."><given-names>U.</given-names> <surname>Klingmüller</surname></string-name>, and <string-name name-style="western" hwp:sortable="Timmer J."><given-names>J.</given-names> <surname>Timmer</surname></string-name>. <article-title hwp:id="article-title-13">Structural and practical identifiability analysis of partially observed dynamical models by exploiting the profile likelihood</article-title>. <source hwp:id="source-12">Bioinformatics</source>, <volume>25</volume>(<issue>25</issue>):<fpage>1923</fpage>–<lpage>1929</lpage>, <month>May</month> <year>2009</year></citation></ref><ref id="c13" hwp:id="ref-13" hwp:rev-id="xref-ref-13-1 xref-ref-13-2 xref-ref-13-3"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.13" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-13"><string-name name-style="western" hwp:sortable="Raue A."><given-names>A.</given-names> <surname>Raue</surname></string-name>, <string-name name-style="western" hwp:sortable="Schilling M."><given-names>M.</given-names> <surname>Schilling</surname></string-name>, <string-name name-style="western" hwp:sortable="Bachmann J."><given-names>J.</given-names> <surname>Bachmann</surname></string-name>, <string-name name-style="western" hwp:sortable="Matteson A."><given-names>A.</given-names> <surname>Matteson</surname></string-name>, <string-name name-style="western" hwp:sortable="Schelke M."><given-names>M.</given-names> <surname>Schelke</surname></string-name>, <string-name name-style="western" hwp:sortable="Kaschek D."><given-names>D.</given-names> <surname>Kaschek</surname></string-name>, <string-name name-style="western" hwp:sortable="Hug S."><given-names>S.</given-names> <surname>Hug</surname></string-name>, <string-name name-style="western" hwp:sortable="Kreutz C."><given-names>C.</given-names> <surname>Kreutz</surname></string-name>, <string-name name-style="western" hwp:sortable="Harms B. D."><given-names>B. D.</given-names> <surname>Harms</surname></string-name>, <string-name name-style="western" hwp:sortable="Theis F. J."><given-names>F. J.</given-names> <surname>Theis</surname></string-name>, <string-name name-style="western" hwp:sortable="Klingmüller U."><given-names>U.</given-names> <surname>Klingmüller</surname></string-name>, and <string-name name-style="western" hwp:sortable="Timmer J."><given-names>J.</given-names> <surname>Timmer</surname></string-name>. <article-title hwp:id="article-title-14">Lessons learned from quantitative dynamical modeling in systems biology</article-title>. <source hwp:id="source-13">PLoS ONE</source>, <volume>8</volume>(<issue>9</issue>):<fpage>e74335</fpage>, <month>Sept</month>. <year>2013</year>.</citation></ref><ref id="c14" hwp:id="ref-14" hwp:rev-id="xref-ref-14-1"><citation publication-type="confproc" citation-type="confproc" ref:id="247924v1.14" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-14"><string-name name-style="western" hwp:sortable="Renart J."><given-names>J.</given-names> <surname>Renart</surname></string-name>, <string-name name-style="western" hwp:sortable="Reiser J."><given-names>J.</given-names> <surname>Reiser</surname></string-name>, and <string-name name-style="western" hwp:sortable="Stark G. R."><given-names>G. R.</given-names> <surname>Stark</surname></string-name>. <article-title hwp:id="article-title-15">Transfer of proteins from gels to diazobenzyloxymethyl-paper and detection with antisera: a method for studying antibody specificity and antigen structure</article-title>. <conf-name>Proc. Natl. Acad. Sci. USA</conf-name>, <volume>76</volume>(<issue>7</issue>):<fpage>3116</fpage>–<lpage>3120</lpage>, <conf-date>July 1979</conf-date></citation></ref><ref id="c15" hwp:id="ref-15" hwp:rev-id="xref-ref-15-1 xref-ref-15-2"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.15" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-15"><string-name name-style="western" hwp:sortable="Schelker M."><given-names>M.</given-names> <surname>Schelker</surname></string-name>, <string-name name-style="western" hwp:sortable="Raue A."><given-names>A.</given-names> <surname>Raue</surname></string-name>, <string-name name-style="western" hwp:sortable="Timmer J."><given-names>J.</given-names> <surname>Timmer</surname></string-name>, and <string-name name-style="western" hwp:sortable="Kreutz C."><given-names>C.</given-names> <surname>Kreutz</surname></string-name>. <article-title hwp:id="article-title-16">Comprehensive estimation of input signals and dynamics in biochemical reaction networks</article-title>. <source hwp:id="source-14">Bioinformatics</source>, <volume>28</volume>(<issue>18</issue>):<fpage>i529</fpage>–<lpage>i534</lpage>, <year>2012</year>.</citation></ref><ref id="c16" hwp:id="ref-16" hwp:rev-id="xref-ref-16-1"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.16" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-16"><string-name name-style="western" hwp:sortable="Schöberl B."><given-names>B.</given-names> <surname>Schöberl</surname></string-name>, <string-name name-style="western" hwp:sortable="Pace E. A."><given-names>E. A.</given-names> <surname>Pace</surname></string-name>, <string-name name-style="western" hwp:sortable="Fitzgerald J. B."><given-names>J. B.</given-names> <surname>Fitzgerald</surname></string-name>, <string-name name-style="western" hwp:sortable="Harms B. D."><given-names>B. D.</given-names> <surname>Harms</surname></string-name>, <string-name name-style="western" hwp:sortable="Xu L."><given-names>L.</given-names> <surname>Xu</surname></string-name>, <string-name name-style="western" hwp:sortable="Nie L."><given-names>L.</given-names> <surname>Nie</surname></string-name>, <string-name name-style="western" hwp:sortable="Linggi B."><given-names>B.</given-names> <surname>Linggi</surname></string-name>, <string-name name-style="western" hwp:sortable="Kalra A."><given-names>A.</given-names> <surname>Kalra</surname></string-name>, <string-name name-style="western" hwp:sortable="Paragas V."><given-names>V.</given-names> <surname>Paragas</surname></string-name>, <string-name name-style="western" hwp:sortable="Bukhalid R."><given-names>R.</given-names> <surname>Bukhalid</surname></string-name>, <string-name name-style="western" hwp:sortable="Grantcharova V."><given-names>V.</given-names> <surname>Grantcharova</surname></string-name>, <string-name name-style="western" hwp:sortable="Kohli N."><given-names>N.</given-names> <surname>Kohli</surname></string-name>, <string-name name-style="western" hwp:sortable="West K. A."><given-names>K. A.</given-names> <surname>West</surname></string-name>, <string-name name-style="western" hwp:sortable="Leszczyniecka M."><given-names>M.</given-names> <surname>Leszczyniecka</surname></string-name>, <string-name name-style="western" hwp:sortable="Feldhaus M. J."><given-names>M. J.</given-names> <surname>Feldhaus</surname></string-name>, <string-name name-style="western" hwp:sortable="Kudla A. J."><given-names>A. J.</given-names> <surname>Kudla</surname></string-name>, and <string-name name-style="western" hwp:sortable="Nielsen U. B."><given-names>U. B.</given-names> <surname>Nielsen</surname></string-name>. <article-title hwp:id="article-title-17">Therapeutically targeting ErbB3: A key node in ligand-induced activation of the ErbB receptor–PI3K axis</article-title>. <source hwp:id="source-15">Science Signaling</source>, <volume>2</volume>(<issue>77</issue>):ra<fpage>31</fpage>, <year>2009</year></citation></ref><ref id="c17" hwp:id="ref-17" hwp:rev-id="xref-ref-17-1"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.17" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-17"><string-name name-style="western" hwp:sortable="Serban R."><given-names>R.</given-names> <surname>Serban</surname></string-name> and <string-name name-style="western" hwp:sortable="Hindmarsh A. C."><given-names>A. C.</given-names> <surname>Hindmarsh</surname></string-name>. <article-title hwp:id="article-title-18">CVODES: An ODE solver with sensitivity analysis capabilities. ACM Math</article-title>. <source hwp:id="source-16">Software</source>, <volume>31</volume>(<issue>3</issue>):<fpage>363</fpage>–<lpage>396</lpage>, <year>2005</year></citation></ref><ref id="c18" hwp:id="ref-18" hwp:rev-id="xref-ref-18-1 xref-ref-18-2"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.18" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-18"><string-name name-style="western" hwp:sortable="Stapor P."><given-names>P.</given-names> <surname>Stapor</surname></string-name>, <string-name name-style="western" hwp:sortable="Weindl D."><given-names>D.</given-names> <surname>Weindl</surname></string-name>, <string-name name-style="western" hwp:sortable="Ballnus B."><given-names>B.</given-names> <surname>Ballnus</surname></string-name>, <string-name name-style="western" hwp:sortable="Hug S."><given-names>S.</given-names> <surname>Hug</surname></string-name>, <string-name name-style="western" hwp:sortable="Loos C."><given-names>C.</given-names> <surname>Loos</surname></string-name>, <string-name name-style="western" hwp:sortable="Fiedler A."><given-names>A.</given-names> <surname>Fiedler</surname></string-name>, <string-name name-style="western" hwp:sortable="Krause S."><given-names>S.</given-names> <surname>Krause</surname></string-name>, <string-name name-style="western" hwp:sortable="Hross S."><given-names>S.</given-names> <surname>Hross</surname></string-name>, <string-name name-style="western" hwp:sortable="Fröhlich F."><given-names>F.</given-names> <surname>Fröhlich</surname></string-name>, and <string-name name-style="western" hwp:sortable="Hasenauer J."><given-names>J.</given-names> <surname>Hasenauer</surname></string-name>. <article-title hwp:id="article-title-19">PESTO: Parameter EStimation TOolbox</article-title>. <source hwp:id="source-17">Bioinformatics, btx</source><volume>676</volume>, <fpage>2017</fpage>.</citation></ref><ref id="c19" hwp:id="ref-19" hwp:rev-id="xref-ref-19-1 xref-ref-19-2 xref-ref-19-3"><citation publication-type="confproc" citation-type="confproc" ref:id="247924v1.19" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-19"><string-name name-style="western" hwp:sortable="Swameye I."><given-names>I.</given-names> <surname>Swameye</surname></string-name>, <string-name name-style="western" hwp:sortable="Müller T. G."><given-names>T. G.</given-names> <surname>Müller</surname></string-name>, <string-name name-style="western" hwp:sortable="Timmer J."><given-names>J.</given-names> <surname>Timmer</surname></string-name>, <string-name name-style="western" hwp:sortable="Sandra O."><given-names>O.</given-names> <surname>Sandra</surname></string-name>, and <string-name name-style="western" hwp:sortable="Klingmüller U."><given-names>U.</given-names> <surname>Klingmüller</surname></string-name>. <article-title hwp:id="article-title-20">Identification of nucleocytoplasmic cycling as a remote sensor in cellular signaling by databased modeling</article-title>. <conf-name>Proc. Natl. Acad. Sci. USA</conf-name>, <volume>100</volume>(<issue>3</issue>):<fpage>1028</fpage>–<lpage>1033</lpage>, <conf-date>Feb 2003</conf-date>. URL <ext-link l:rel="related" l:ref-type="uri" l:ref="http://www.pnas.org/content/100/3/1028.abstract" ext-link-type="uri" xlink:href="http://www.pnas.org/content/100/3/1028.abstract" hwp:id="ext-link-2">http://www.pnas.org/content/100/3/1028.abstract</ext-link></citation></ref><ref id="c20" hwp:id="ref-20" hwp:rev-id="xref-ref-20-1"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.20" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-20"><string-name name-style="western" hwp:sortable="Thomaseth C."><given-names>C.</given-names> <surname>Thomaseth</surname></string-name> and <string-name name-style="western" hwp:sortable="Radde N."><given-names>N.</given-names> <surname>Radde</surname></string-name>. <article-title hwp:id="article-title-21">Normalization of western blot data affects the statistics of estimators</article-title>. <source hwp:id="source-18">IFAC-PapersOnLine</source>, <volume>49</volume>(<issue>26</issue>):<fpage>56</fpage>–<lpage>62</lpage>, <year>2016</year></citation></ref><ref id="c21" hwp:id="ref-21" hwp:rev-id="xref-ref-21-1"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.21" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-21"><string-name name-style="western" hwp:sortable="Vaz A. I. F."><given-names>A. I. F.</given-names> <surname>Vaz</surname></string-name> and <string-name name-style="western" hwp:sortable="Vicente L. N."><given-names>L. N.</given-names> <surname>Vicente</surname></string-name>. <article-title hwp:id="article-title-22">PSwarm: A hybrid solver for linearly constrained global derivative-free optimization</article-title>. <source hwp:id="source-19">Optim. Method. Softw</source>., <volume>24</volume>(<issue>4–5</issue>):<fpage>669</fpage>–<lpage>685</lpage>, <year>2009</year>.</citation></ref><ref id="c22" hwp:id="ref-22" hwp:rev-id="xref-ref-22-1 xref-ref-22-2"><citation publication-type="confproc" citation-type="confproc" ref:id="247924v1.22" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-22"><string-name name-style="western" hwp:sortable="Weber P."><given-names>P.</given-names> <surname>Weber</surname></string-name>, <string-name name-style="western" hwp:sortable="Hasenauer J."><given-names>J.</given-names> <surname>Hasenauer</surname></string-name>, <string-name name-style="western" hwp:sortable="Allgöwer F."><given-names>F.</given-names> <surname>Allgöwer</surname></string-name>, and <string-name name-style="western" hwp:sortable="Radde N."><given-names>N.</given-names> <surname>Radde</surname></string-name>. <chapter-title>Parameter estimation and identifiability of biological networks using relative data</chapter-title>. In <person-group person-group-type="editor" hwp:id="person-group-1"><string-name name-style="western" hwp:sortable="Bittanti S."><given-names>S.</given-names> <surname>Bittanti</surname></string-name>, <string-name name-style="western" hwp:sortable="Cenedese A."><given-names>A.</given-names> <surname>Cenedese</surname></string-name>, and <string-name name-style="western" hwp:sortable="Zampieri S."><given-names>S.</given-names> <surname>Zampieri</surname></string-name></person-group>, editors, <conf-name>Proc. of the 18th IFAC World Congress</conf-name>, volume <volume>18</volume>, pages <fpage>11648</fpage>–<lpage>11653</lpage>, <conf-loc>Milano, Italy</conf-loc>, <conf-date>Aug. 2011</conf-date>.</citation></ref></ref-list><sec id="s7" sec-type="supplementary-material" hwp:id="sec-21"><label>1</label><title hwp:id="title-23">General formula for analytic scaling and noise parameters</title><p hwp:id="p-49">In the main manuscript, we covered experimental data sets which have different time points. Here, we provide the derivation of the expressions for the general case, in which the experimental data also comprise different replicates, experiments, and conditions, e.g., varying drug doses. We considered that the ODE system also depends on an input <inline-formula hwp:id="inline-formula-26">
<alternatives hwp:id="alternatives-42"><inline-graphic xlink:href="247924_inlineS1.gif" hwp:id="inline-graphic-26"/></alternatives>
</inline-formula>,
<disp-formula id="eqnS1" hwp:id="disp-formula-17">
<alternatives hwp:id="alternatives-43"><graphic xlink:href="247924_eqnS1.gif" position="float" orientation="portrait" hwp:id="graphic-21"/></alternatives>
</disp-formula>
thus, <inline-formula hwp:id="inline-formula-27">
<alternatives hwp:id="alternatives-44"><inline-graphic xlink:href="247924_inlineS2.gif" hwp:id="inline-graphic-27"/></alternatives>
</inline-formula> which also affects the mapping to the observables
<disp-formula id="eqnS2" hwp:id="disp-formula-18">
<alternatives hwp:id="alternatives-45"><graphic xlink:href="247924_eqnS2.gif" position="float" orientation="portrait" hwp:id="graphic-22"/></alternatives>
</disp-formula>
The experimental data is then given by
<disp-formula id="eqnS3" hwp:id="disp-formula-19">
<alternatives hwp:id="alternatives-46"><graphic xlink:href="247924_eqnS3.gif" position="float" orientation="portrait" hwp:id="graphic-23"/></alternatives>
</disp-formula>
including all indices for time point <italic toggle="yes">k</italic>, replicate <italic toggle="yes">r</italic>, experiment-specific condition <italic toggle="yes">c</italic><sub><italic toggle="yes">e</italic></sub>, and experiment <italic toggle="yes">e</italic>. The indices <italic toggle="yes">I</italic><sub><italic toggle="yes">e</italic></sub> indicate which conditions correspond to a certain experiment. The measurements are mapped to the states by
<disp-formula id="ueqn9" hwp:id="disp-formula-20">
<alternatives hwp:id="alternatives-47"><graphic xlink:href="247924_ueqn9.gif" position="float" orientation="portrait" hwp:id="graphic-24"/></alternatives>
</disp-formula>
with <inline-formula hwp:id="inline-formula-28">
<alternatives hwp:id="alternatives-48"><inline-graphic xlink:href="247924_inlineS3.gif" hwp:id="inline-graphic-28"/></alternatives>
</inline-formula> or <inline-formula hwp:id="inline-formula-29">
<alternatives hwp:id="alternatives-49"><inline-graphic xlink:href="247924_inlineS4.gif" hwp:id="inline-graphic-29"/></alternatives>
</inline-formula> and <inline-formula hwp:id="inline-formula-30">
<alternatives hwp:id="alternatives-50"><inline-graphic xlink:href="247924_inlineS5.gif" hwp:id="inline-graphic-30"/></alternatives>
</inline-formula> for absolute measurements. Also, the structure of the mapping from states to observables might be experiment-specific. The negative log-likelihood is given by
<disp-formula id="eqnS4" hwp:id="disp-formula-21">
<alternatives hwp:id="alternatives-51"><graphic xlink:href="247924_eqnS4.gif" position="float" orientation="portrait" hwp:id="graphic-25"/></alternatives>
</disp-formula>
In the main manuscript, we presented the analytic formulas for the case that each observable and corresponding replicate has different scaling and noise parameters, but that these parameters do not change between conditions and time points. A more general formula is provided in the following, covering, e.g., the case that replicates share the same scaling parameters, but observables do not. This can be easily generalized to also include variability between time points.</p><sec id="s7a" hwp:id="sec-22"><label>1.1</label><title hwp:id="title-24">Gaussian noise</title><p hwp:id="p-50">The general objective function under Gaussian noise is given by
<disp-formula id="ueqn10" hwp:id="disp-formula-22">
<alternatives hwp:id="alternatives-52"><graphic xlink:href="247924_ueqn10.gif" position="float" orientation="portrait" hwp:id="graphic-26"/></alternatives>
</disp-formula>
To define which replicates, observables, and experiments share a scaling or noise parameter, we define
<disp-formula id="ueqn11" hwp:id="disp-formula-23">
<alternatives hwp:id="alternatives-53"><graphic xlink:href="247924_ueqn11.gif" position="float" orientation="portrait" hwp:id="graphic-27"/></alternatives>
</disp-formula>
for <italic toggle="yes">i</italic><sub><italic toggle="yes">s</italic></sub> = 1, …, <italic toggle="yes">n</italic><sub><italic toggle="yes">s</italic></sub> and <italic toggle="yes">i</italic><sub>σ</sub> = 1, …, <italic toggle="yes">n<sub>σ</sub></italic>. The number of replicates is denoted by n<sub>r</sub> and the number of experiments by <italic toggle="yes">n</italic><sub><italic toggle="yes">e</italic></sub>. This means, all scaling parameters <inline-formula hwp:id="inline-formula-31">
<alternatives hwp:id="alternatives-54"><inline-graphic xlink:href="247924_inlineS7.gif" hwp:id="inline-graphic-31"/></alternatives>
</inline-formula> for which the indices (i<sup>*</sup>, r<sup>*</sup>, e<sup>*</sup>) are part of the same group <italic toggle="yes">I</italic><sub>s</sub> share the same scaling parameters. This yields <italic toggle="yes">n</italic><sub><italic toggle="yes">s</italic></sub> different scaling parameters that are estimated from the data. For this we denote <inline-formula hwp:id="inline-formula-32">
<alternatives hwp:id="alternatives-55"><inline-graphic xlink:href="247924_inlineS8.gif" hwp:id="inline-graphic-32"/></alternatives>
</inline-formula> the group which includes the indices <inline-formula hwp:id="inline-formula-33">
<alternatives hwp:id="alternatives-56"><inline-graphic xlink:href="247924_inlineS6.gif" hwp:id="inline-graphic-33"/></alternatives>
</inline-formula>. This is analogously for the noise parameters. The derivative of the objective function with respect to a scaling parameter thus reads
<disp-formula id="eqnS5" hwp:id="disp-formula-24">
<alternatives hwp:id="alternatives-57"><graphic xlink:href="247924_eqnS5.gif" position="float" orientation="portrait" hwp:id="graphic-28"/></alternatives>
</disp-formula>
and was set to zero to obtain the analytic expression for the optimal scaling parameter. The solution does not depend on the noise parameters if <inline-formula hwp:id="inline-formula-34">
<alternatives hwp:id="alternatives-58"><inline-graphic xlink:href="247924_inlineS10.gif" hwp:id="inline-graphic-34"/></alternatives>
</inline-formula> and we solve the equation with respect to <inline-formula hwp:id="inline-formula-35">
<alternatives hwp:id="alternatives-59"><inline-graphic xlink:href="247924_inlineS11.gif" hwp:id="inline-graphic-35"/></alternatives>
</inline-formula> to obtain the optimal value
<disp-formula id="ueqn12" hwp:id="disp-formula-25">
<alternatives hwp:id="alternatives-60"><graphic xlink:href="247924_ueqn12.gif" position="float" orientation="portrait" hwp:id="graphic-29"/></alternatives>
</disp-formula>
For the noise parameters, we need
<disp-formula id="eqnS6" hwp:id="disp-formula-26">
<alternatives hwp:id="alternatives-61"><graphic xlink:href="247924_eqnS6.gif" position="float" orientation="portrait" hwp:id="graphic-30"/></alternatives>
</disp-formula>
We write
<disp-formula id="ueqn13" hwp:id="disp-formula-27">
<alternatives hwp:id="alternatives-62"><graphic xlink:href="247924_ueqn13.gif" position="float" orientation="portrait" hwp:id="graphic-31"/></alternatives>
</disp-formula>
in which (†), the nominator, is simply the number of observations in which <inline-formula hwp:id="inline-formula-36">
<alternatives hwp:id="alternatives-63"><inline-graphic xlink:href="247924_inlineS12.gif" hwp:id="inline-graphic-36"/></alternatives>
</inline-formula> appears. In some cases, for instance if all experiments share the same scaling parameter, we neglected the superscript <italic toggle="yes">e</italic>.</p><p hwp:id="p-51">The gradient used for optimization is given by
<disp-formula id="ueqn14" hwp:id="disp-formula-28">
<alternatives hwp:id="alternatives-64"><graphic xlink:href="247924_ueqn14.gif" position="float" orientation="portrait" hwp:id="graphic-32"/></alternatives>
</disp-formula>
for which <inline-formula hwp:id="inline-formula-37">
<alternatives hwp:id="alternatives-65"><inline-graphic xlink:href="247924_inlineS13.gif" hwp:id="inline-graphic-37"/></alternatives>
</inline-formula> is obtained by forward sensitivity equations employed in AMICI, and,
<disp-formula id="ueqn15" hwp:id="disp-formula-29">
<alternatives hwp:id="alternatives-66"><graphic xlink:href="247924_ueqn48.gif" position="float" orientation="portrait" hwp:id="graphic-33"/></alternatives>
</disp-formula>
which holds due to (5) and (6). The Hessian with respect to the dynamic parameters is
<disp-formula id="ueqn16" hwp:id="disp-formula-30">
<alternatives hwp:id="alternatives-67"><graphic xlink:href="247924_ueqn15.gif" position="float" orientation="portrait" hwp:id="graphic-34"/></alternatives>
</disp-formula>
For the remaining parameter, the Hessian is zero. We implemented an approximation of the Hessian neglecting the terms (*) that include higher-order sensitivities.</p></sec><sec id="s7b" hwp:id="sec-23"><label>1.2</label><title hwp:id="title-25">Laplace noise</title><p hwp:id="p-52">For Laplace noise, the expression for the optimal scaling and noise parameters can be generalized analogously. The objective function for the general case is
<disp-formula id="ueqn17" hwp:id="disp-formula-31">
<alternatives hwp:id="alternatives-68"><graphic xlink:href="247924_ueqn16.gif" position="float" orientation="portrait" hwp:id="graphic-35"/></alternatives>
</disp-formula>
The derivative with respect to a scaling parameter is
<disp-formula id="ueqn18" hwp:id="disp-formula-32">
<alternatives hwp:id="alternatives-69"><graphic xlink:href="247924_ueqn17.gif" position="float" orientation="portrait" hwp:id="graphic-36"/></alternatives>
</disp-formula>
with jump points
<disp-formula id="eqnS7" hwp:id="disp-formula-33">
<alternatives hwp:id="alternatives-70"><graphic xlink:href="247924_eqnS7.gif" position="float" orientation="portrait" hwp:id="graphic-37"/></alternatives>
</disp-formula>
These jump points are the candidates for the optimal scaling parameter and the candidate for which the sign of the derivative changes is chosen. For the optimal noise parameter we have
<disp-formula id="eqnS8" hwp:id="disp-formula-34">
<alternatives hwp:id="alternatives-71"><graphic xlink:href="247924_eqnS8.gif" position="float" orientation="portrait" hwp:id="graphic-38"/></alternatives>
</disp-formula>
<disp-formula id="ueqn19" hwp:id="disp-formula-35">
<alternatives hwp:id="alternatives-72"><graphic xlink:href="247924_ueqn18.gif" position="float" orientation="portrait" hwp:id="graphic-39"/></alternatives>
</disp-formula>
The gradient used for optimization is given by
<disp-formula id="ueqn20" hwp:id="disp-formula-36">
<alternatives hwp:id="alternatives-73"><graphic xlink:href="247924_ueqn19.gif" position="float" orientation="portrait" hwp:id="graphic-40"/></alternatives>
</disp-formula>
for which <inline-formula hwp:id="inline-formula-38">
<alternatives hwp:id="alternatives-74"><inline-graphic xlink:href="247924_inlineS14.gif" hwp:id="inline-graphic-38"/></alternatives>
</inline-formula>is obtained by forward sensitivity equations employed in AMICI, and <inline-formula hwp:id="inline-formula-39">
<alternatives hwp:id="alternatives-75"><inline-graphic xlink:href="247924_inlineS15.gif" hwp:id="inline-graphic-39"/></alternatives>
</inline-formula>, which holds due to (8).</p></sec></sec><sec id="s8" hwp:id="sec-24"><label>2</label><title hwp:id="title-26">Comparison of data and simulation at a logarithmic scale</title><p hwp:id="p-53">In the main manuscript and Supplementary Information, Section 1, we provided the formulas for the comparison of data and simulation on a linear scale. However, sometimes it might be more appropriate to compare experimental data and simulation on a logarithmic scale.</p><sec id="s8a" hwp:id="sec-25"><label>2.1</label><title hwp:id="title-27">Gaussian noise</title><p hwp:id="p-54">For Gaussian noise, the objective function for the comparison on the logarithmic scale is given by
<disp-formula id="ueqn21" hwp:id="disp-formula-37">
<alternatives hwp:id="alternatives-76"><graphic xlink:href="247924_ueqn20.gif" position="float" orientation="portrait" hwp:id="graphic-41"/></alternatives>
</disp-formula>
Thus, the derivative with respect to the scaling parameters is
<disp-formula id="ueqn22" hwp:id="disp-formula-38">
<alternatives hwp:id="alternatives-77"><graphic xlink:href="247924_ueqn21.gif" position="float" orientation="portrait" hwp:id="graphic-42"/></alternatives>
</disp-formula>
This yields the formula for the optimal scaling parameters
<disp-formula id="eqnS9" hwp:id="disp-formula-39">
<alternatives hwp:id="alternatives-78"><graphic xlink:href="247924_eqnS9.gif" position="float" orientation="portrait" hwp:id="graphic-43"/></alternatives>
</disp-formula>
and
<disp-formula id="eqnS10" hwp:id="disp-formula-40">
<alternatives hwp:id="alternatives-79"><graphic xlink:href="247924_eqnS10.gif" position="float" orientation="portrait" hwp:id="graphic-44"/></alternatives>
</disp-formula>
The gradient used for optimization is given by
<disp-formula id="ueqn23" hwp:id="disp-formula-41">
<alternatives hwp:id="alternatives-80"><graphic xlink:href="247924_ueqn22.gif" position="float" orientation="portrait" hwp:id="graphic-45"/></alternatives>
</disp-formula>
If the data is compared at log<sub>10</sub> scale, as, e.g., for the JAK-STAT signaling model proposed by <xref rid="sc1" ref-type="bibr" hwp:id="xref-ref-23-1" hwp:rel-id="ref-23">Bachmann et al. (2011)</xref>, the negative log-likelihood function reads
<disp-formula id="ueqn24" hwp:id="disp-formula-42">
<alternatives hwp:id="alternatives-81"><graphic xlink:href="247924_ueqn23.gif" position="float" orientation="portrait" hwp:id="graphic-46"/></alternatives>
</disp-formula>
The optimal scaling parameters here are the same as when using the natural logarithm (9). For the optimal noise parameters the log is replaced by log<sub>10</sub> in (10).</p></sec><sec id="s8b" hwp:id="sec-26"><label>2.2</label><title hwp:id="title-28">Laplace noise</title><p hwp:id="p-55">For the Laplace distribution including the logarithmic comparison
<disp-formula id="ueqn25" hwp:id="disp-formula-43">
<alternatives hwp:id="alternatives-82"><graphic xlink:href="247924_ueqn24.gif" position="float" orientation="portrait" hwp:id="graphic-47"/></alternatives>
</disp-formula>
the same procedure can be applied for the logarithmic scale as for the linear scale, with the same set of candidate scaling parameters (7) as for the linear scale. However, one has to pay attention to adapt the derivative properly, for which the change of signs is checked. The optimal noise parameters then is given by
<disp-formula id="ueqn26" hwp:id="disp-formula-44">
<alternatives hwp:id="alternatives-83"><graphic xlink:href="247924_ueqn25.gif" position="float" orientation="portrait" hwp:id="graphic-48"/></alternatives>
</disp-formula>
The gradient used for optimization is given by
<disp-formula id="ueqn27" hwp:id="disp-formula-45">
<alternatives hwp:id="alternatives-84"><graphic xlink:href="247924_ueqn26.gif" position="float" orientation="portrait" hwp:id="graphic-49"/></alternatives>
</disp-formula></p></sec></sec><sec id="s9" hwp:id="sec-27"><label>3</label><title hwp:id="title-29">Implementation</title><p hwp:id="p-56">We implemented the log-likelihood function and the analytic calculation of the scaling and noise parameters in easy-to-use MATLAB functions. The log-likelihood function is provided in <monospace>loglikelihoodHierarchical.m</monospace>, which provides the log-likelihood value, the gradient of the log-likelihood function with respect to the dynamic parameters, and in the case of Gaussian noise also an approximation to the Hessian by neglecting second-order derivatives. The functions and examples are incorporated in the toolbox PESTO (<xref rid="sc9" ref-type="bibr" hwp:id="xref-ref-31-1" hwp:rel-id="ref-31">Stapor et al., 2017</xref>)and can be found on GitHub: <ext-link l:rel="related" l:ref-type="uri" l:ref="http://github.com/ICB-DCM/PESTO" ext-link-type="uri" xlink:href="http://github.com/ICB-DCM/PESTO" hwp:id="ext-link-3">http://github.com/ICB-DCM/PESTO</ext-link>. The simulated observables, their sensitivities, the experimental data, and the specification of measurement noise, scale of comparison between simulation and data, and shared parameters needs to be supplied by the user.</p><p hwp:id="p-57">For our analysis, we employed the toolbox AMICI (<xref rid="sc3" ref-type="bibr" hwp:id="xref-ref-25-1" hwp:rel-id="ref-25">Fröhlich et al., 2017</xref>) for the simulation of the system and the simulation of the sensitivities, and the toolbox PESTO (<xref rid="sc9" ref-type="bibr" hwp:id="xref-ref-31-2" hwp:rel-id="ref-31">Stapor et al., 2017</xref>) for the estimation of the parameters.</p></sec><sec id="s10" hwp:id="sec-28"><label>4</label><title hwp:id="title-30">Models and experimental data</title><p hwp:id="p-58">In the following, we provide the details of the mathematical models. The considered models vary in their number of parameters (Figure 6A), number of data points that are used to calibrate the models (<xref rid="figS1" ref-type="fig" hwp:id="xref-fig-5-2" hwp:rel-id="F5">Figure S1A</xref>), and number of states of the underlying ODE system (<xref rid="figS1" ref-type="fig" hwp:id="xref-fig-5-3" hwp:rel-id="F5">Figure S1B</xref>).</p><sec id="s10a" hwp:id="sec-29"><label>4.1</label><title hwp:id="title-31">JAK-STAT signaling I</title><p hwp:id="p-59">For the first model, we used the model introduced by <xref rid="sc8" ref-type="bibr" hwp:id="xref-ref-30-1" hwp:rel-id="ref-30">Schelker et al. (2012)</xref>, which is defined by the ODE system
<disp-formula id="ueqn28" hwp:id="disp-formula-46">
<alternatives hwp:id="alternatives-85"><graphic xlink:href="247924_ueqn27.gif" position="float" orientation="portrait" hwp:id="graphic-50"/></alternatives>
</disp-formula>
<fig id="figS1" position="float" orientation="portrait" fig-type="figure" hwp:id="F5" hwp:rev-id="xref-fig-5-1 xref-fig-5-2 xref-fig-5-3 xref-fig-5-4 xref-fig-5-5 xref-fig-5-6"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;247924v1/FIGS1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F5</object-id><object-id pub-id-type="publisher-id">figS1</object-id><label>Supplementary Figure S1:</label><caption hwp:id="caption-5"><p hwp:id="p-60">Comparison of the three models. (A) Number of experimental data points used to calibrate the models. (B) Number of states <italic toggle="yes">n</italic><sub><italic toggle="yes">x</italic></sub>. (C) Comparison of Gaussian and Laplace noise for the three models based on the Bayesian Information Criterion (BIC) (<xref rid="sc6" ref-type="bibr" hwp:id="xref-ref-28-1" hwp:rel-id="ref-28">Raftery, 1999</xref>), which rewards high likelihood values and penalizes high number of parameters.</p></caption><graphic xlink:href="247924_figS1" position="float" orientation="portrait" hwp:id="graphic-51"/></fig>
with kinetic parameters <italic toggle="yes">p</italic><sub>1</sub>,…, <italic toggle="yes">p</italic><sub>4</sub>. The brackets indicate the concentrations of the corresponding species. The initial conditions are given by
<disp-formula id="ueqn29" hwp:id="disp-formula-47">
<alternatives hwp:id="alternatives-86"><graphic xlink:href="247924_ueqn29.gif" position="float" orientation="portrait" hwp:id="graphic-52"/></alternatives>
</disp-formula>
for which the initial condition for STAT is set to 1 in order to remove structural non-identifiabilities (<xref rid="sc8" ref-type="bibr" hwp:id="xref-ref-30-2" hwp:rel-id="ref-30">Schelker et al., 2012</xref>). The states nSTAT1, …, nSTAT5 are intermediate steps, resulting from a linear chain approximation to model the delay of STAT binding to the DNA in the nucleus. The volumes of the cytoplasm and nucleus are denoted by Ω<sub>cyt</sub> = 1.4 pl and Ω<sub>nuc</sub> = 0.45 pl, respectively (<xref rid="sc7" ref-type="bibr" hwp:id="xref-ref-29-1" hwp:rel-id="ref-29">Raue et al., 2009</xref>).</p><p hwp:id="p-61">The observables are defined by <italic toggle="yes">y</italic><sub>1</sub> for total concentration of phosphorylated STAT in the cytoplasm (pSTAT), <italic toggle="yes">y</italic><sub>2</sub> for the total concentration of STAT in the cytoplasm (tSTAT), and <italic toggle="yes">y</italic><sub>3</sub> for the phosphorylated Epo receptors (pEpoR) (see <xref rid="fig3" ref-type="fig" hwp:id="xref-fig-3-9" hwp:rel-id="F3">Figure 3A</xref> in the main manuscript). They are linked to the states of the system via
<disp-formula id="ueqn30" hwp:id="disp-formula-48">
<alternatives hwp:id="alternatives-87"><graphic xlink:href="247924_ueqn28.gif" position="float" orientation="portrait" hwp:id="graphic-53"/></alternatives>
</disp-formula>
The concentration of Epo receptors is modeled as time-dependent cubic spline function <italic toggle="yes">g</italic> with parameters <italic toggle="yes">sp</italic><sub>1</sub>, …, <italic toggle="yes">sp</italic><sub>5</sub>, which are also estimated from the data. The parameters <italic toggle="yes">o</italic><sub>1</sub> and <italic toggle="yes">o</italic><sub>2</sub> define the to offsets needed to model the background noise. The model comprises the parameters q = (<italic toggle="yes">p</italic><sub>1</sub>, <italic toggle="yes">p</italic><sub>2</sub>, <italic toggle="yes">p</italic><sub>3</sub>, <italic toggle="yes">p</italic><sub>4</sub>, sp<sub>1</sub>, <italic toggle="yes">sp</italic><sub>2</sub>, <italic toggle="yes">sp</italic><sub>3</sub>, <italic toggle="yes">sp</italic><sub>4</sub>, <italic toggle="yes">sp</italic><sub>5</sub>, <italic toggle="yes">o</italic><sub>1</sub>, <italic toggle="yes">o</italic><sub>2</sub>, <italic toggle="yes">s</italic><sub>1</sub>, <italic toggle="yes">s</italic><sub>2</sub>, <italic toggle="yes">σ</italic><sub>1</sub>, <italic toggle="yes">σ</italic><sub>2</sub>, <italic toggle="yes">σ</italic><sub>3</sub>)<sup>T</sup>, for which <italic toggle="yes">θ</italic>= (<italic toggle="yes">p</italic><sub>1</sub>, <italic toggle="yes">p</italic><sub>2</sub>, <italic toggle="yes">p</italic><sub>3</sub>, <italic toggle="yes">p</italic><sub>4</sub>, <italic toggle="yes">sp</italic><sub>1</sub>, <italic toggle="yes">sp</italic><sub>2</sub>, <italic toggle="yes">sp</italic><sub>3</sub>, <italic toggle="yes">sp</italic><sub>4</sub>, <italic toggle="yes">sp</italic><sub>5</sub>, <italic toggle="yes">o</italic><sub>1</sub>, <italic toggle="yes">o</italic><sub>2</sub>) was optimized in the outer optimization problem of the hierarchical approach. The scaling parameters s = (<italic toggle="yes">s</italic><sub>1</sub>, <italic toggle="yes">s</italic><sub>2</sub>) and noise parameters= (σ<sub>1</sub>, σ<sub>2</sub>, σ<sub>3</sub>) for observables <italic toggle="yes">y</italic><sub>1</sub>, <italic toggle="yes">y</italic><sub>2</sub>, and <italic toggle="yes">y</italic><sub>3</sub>, respectively, were optimized in the inner optimization problem. The subscript for these parameters indicates the observable. We neglected indices <italic toggle="yes">r</italic>, <italic toggle="yes">e</italic>, and <italic toggle="yes">c</italic><sub><italic toggle="yes">e</italic></sub>, since only one experiment, replicate, and condition is considered. The parameter boundaries for the optimization are given
<fig id="figS2" position="float" orientation="portrait" fig-type="figure" hwp:id="F6" hwp:rev-id="xref-fig-6-1 xref-fig-6-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;247924v1/FIGS2</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F6</object-id><object-id pub-id-type="publisher-id">figS2</object-id><label>Supplementary Figure S2:</label><caption hwp:id="caption-6"><p hwp:id="p-62">Likelihood waterfall plot for JAK-STAT signaling I using particle swarm optimization.</p></caption><graphic xlink:href="247924_figS2" position="float" orientation="portrait" hwp:id="graphic-54"/></fig>
by
<disp-formula id="ueqn31" hwp:id="disp-formula-49">
<alternatives hwp:id="alternatives-88"><graphic xlink:href="247924_ueqn30.gif" position="float" orientation="portrait" hwp:id="graphic-55"/></alternatives>
</disp-formula>
for the lower bound and
<disp-formula id="ueqn32" hwp:id="disp-formula-50">
<alternatives hwp:id="alternatives-89"><graphic xlink:href="247924_ueqn31.gif" position="float" orientation="portrait" hwp:id="graphic-56"/></alternatives>
</disp-formula>
for the upper bound (<xref rid="sc5" ref-type="bibr" hwp:id="xref-ref-27-1" hwp:rel-id="ref-27">Maier et al., 2017</xref>). We performed 100 optimizations, starting from randomly drawn parameter values. The starting points for the dynamic parameters were the same for both optimization approaches.</p><p hwp:id="p-63">The comparison between the two noise assumptions revealed that the Laplace noise is more appropriate. However, the difference in BIC values was below 10, which indicates that the improvement was not substantial (<xref rid="figS1" ref-type="fig" hwp:id="xref-fig-5-4" hwp:rel-id="F5">Figure S1C</xref>) (<xref rid="sc4" ref-type="bibr" hwp:id="xref-ref-26-1" hwp:rel-id="ref-26">Kass and Raftery, 1995</xref>).</p><p hwp:id="p-64">To evaluate the possibility of using the hierarchical optimization also within global optimization, we repeated the analysis using an particle swarm algorithm (<xref rid="sc10" ref-type="bibr" hwp:id="xref-ref-32-1" hwp:rel-id="ref-32">Vaz and Vicente, 2009</xref>). This method does not need gradient information and has been shown to outperform other global optimization methods (<xref rid="sc10" ref-type="bibr" hwp:id="xref-ref-32-2" hwp:rel-id="ref-32">Vaz and Vicente, 2009</xref>). The waterfall plots are shown in <xref rid="figS2" ref-type="fig" hwp:id="xref-fig-6-2" hwp:rel-id="F6">Figure S2</xref>. Interestingly, only the hierarchical optimization for the Gaussian noise was able to find the same optimum as the deterministic optimization. For the other settings the convergence suffered. However, as for the optimization with <monospace>fmincon</monospace>, the hierarchical approach was superior to the standard approach and the Laplace noise fitted the data better than the Gaussian noise.</p></sec><sec id="s4b" hwp:id="sec-30"><label>4.2</label><title hwp:id="title-32">JAK-STAT signaling II</title><p hwp:id="p-65">The ODE system for JAK-STAT signaling model II is given by (<xref rid="sc1" ref-type="bibr" hwp:id="xref-ref-23-2" hwp:rel-id="ref-23">Bachmann et al., 2011</xref>)
<disp-formula id="ueqn33" hwp:id="disp-formula-51">
<alternatives hwp:id="alternatives-90"><graphic xlink:href="247924_ueqn32.gif" position="float" orientation="portrait" hwp:id="graphic-57"/></alternatives>
</disp-formula>
with condition-specific initial conditions (see <xref rid="tblS1" ref-type="table" hwp:id="xref-table-wrap-1-1" hwp:rel-id="T1">Table S1</xref>) denoted by <inline-formula hwp:id="inline-formula-40">
<alternatives hwp:id="alternatives-91"><inline-graphic xlink:href="247924_inlineS16.gif" hwp:id="inline-graphic-40"/></alternatives>
</inline-formula> for observable index <italic toggle="yes">i</italic> under condition indexed by <italic toggle="yes">c</italic><sub><italic toggle="yes">e</italic></sub>:
<disp-formula id="ueqn34" hwp:id="disp-formula-52">
<alternatives hwp:id="alternatives-92"><graphic xlink:href="247924_ueqn33.gif" position="float" orientation="portrait" hwp:id="graphic-58"/></alternatives>
</disp-formula>
The observables are given by
<disp-formula id="ueqn35" hwp:id="disp-formula-53">
<alternatives hwp:id="alternatives-93"><graphic xlink:href="247924_ueqn34.gif" position="float" orientation="portrait" hwp:id="graphic-59"/></alternatives>
</disp-formula>
The parameters <italic toggle="yes">θ</italic> are
<disp-formula id="ueqn36" hwp:id="disp-formula-54">
<alternatives hwp:id="alternatives-94"><graphic xlink:href="247924_ueqn35.gif" position="float" orientation="portrait" hwp:id="graphic-60"/></alternatives>
</disp-formula>
with <italic toggle="yes">n</italic><sub>θ</sub> = 58. For experiment SHP1oe (<italic toggle="yes">e</italic> = 9), the parameter init<sub>SHP1</sub> was replaced by init<sub>SHP1</sub> · (1 + (SHP1oe · SHP1ProOE)) in the model equations. For the notation of the offset, scaling, and noise parameters, we neglected the index <italic toggle="yes">r</italic>, since these parameters are shared for the replicates. The first subscript indicates the observable, and the second the condition. However, all conditions belonging to the same experiment share the scaling and offset parameters and thus the parameters are only listed for the first condition of each experiment. The experiments and corresponding condition indices are summarizes in <xref rid="tblS1" ref-type="table" hwp:id="xref-table-wrap-1-2" hwp:rel-id="T1">Table S1</xref>. For simplicity, we note the scaling parameters as vector s which contains only the unique parameters <italic toggle="yes">s<sub>i</sub></italic>,<italic toggle="yes">c<sub>e</sub></italic> which need to be estimated from the data. Thus, it is
<fig id="figS3" position="float" orientation="portrait" fig-type="figure" hwp:id="F7" hwp:rev-id="xref-fig-7-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;247924v1/FIGS3</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F7</object-id><object-id pub-id-type="publisher-id">figS3</object-id><label>Supplementary Figure S3:</label><caption hwp:id="caption-7"><p hwp:id="p-66">Likelihood waterfall for the JAK-STAT signaling model II.</p></caption><graphic xlink:href="247924_figS3" position="float" orientation="portrait" hwp:id="graphic-61"/></fig>
<disp-formula id="ueqn37" hwp:id="disp-formula-55">
<alternatives hwp:id="alternatives-95"><graphic xlink:href="247924_ueqn36.gif" position="float" orientation="portrait" hwp:id="graphic-62"/></alternatives>
</disp-formula>
with <italic toggle="yes">n</italic><sub><italic toggle="yes">s</italic></sub> = 42. The noise parameters do not differ between experiments or replicates, thus, neglecting the subscripts for the experiment-specific condition index <italic toggle="yes">c</italic><sub><italic toggle="yes">e</italic></sub> and for the replicate index <italic toggle="yes">r</italic>, the noise parameters, which need to be estimated from the data are given by
<disp-formula id="ueqn38" hwp:id="disp-formula-56">
<alternatives hwp:id="alternatives-96"><graphic xlink:href="247924_ueqn37.gif" position="float" orientation="portrait" hwp:id="graphic-63"/></alternatives>
</disp-formula>
with <italic toggle="yes">n<sub>σ</sub></italic> = 11. Some observables have the same noise parameters:
<disp-formula id="ueqn39" hwp:id="disp-formula-57">
<alternatives hwp:id="alternatives-97"><graphic xlink:href="247924_ueqn39.gif" position="float" orientation="portrait" hwp:id="graphic-64"/></alternatives>
</disp-formula>
A minor modification from the model proposed by <xref rid="sc1" ref-type="bibr" hwp:id="xref-ref-23-3" hwp:rel-id="ref-23">Bachmann et al. (2011)</xref> is that the parameterization for the noise of pSTAT5B<sub>au</sub> did not include an additional parameter for the SOCS3oe experiment, and that the observables for RNA were fitted in linear space. The observable pSTAT5B<sub>rel</sub> was also fitted on a linear scale, while the other observables were compared at a log<sub>10</sub> scale (as done by <xref rid="sc1" ref-type="bibr" hwp:id="xref-ref-23-4" hwp:rel-id="ref-23">Bachmann et al. (2011)</xref>). In our setting, the offset parameters were also multiplied with the scaling parameters, which yielded different optimal values for the offset parameters compared to those found by <xref rid="sc1" ref-type="bibr" hwp:id="xref-ref-23-5" hwp:rel-id="ref-23">Bachmann et al. (2011)</xref>. We performed 100 multi-starts for each optimization approach and noise assumption. The
<table-wrap id="tblS1" position="float" orientation="portrait" hwp:id="T1" hwp:rev-id="xref-table-wrap-1-1 xref-table-wrap-1-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;247924v1/TBLS1</object-id><object-id pub-id-type="other" hwp:sub-type="slug">T1</object-id><object-id pub-id-type="publisher-id">tblS1</object-id><label>Supplementary Table S1:</label><caption hwp:id="caption-8"><p hwp:id="p-67">Overview for the experimental data of JAK-STAT signaling model II.</p></caption><graphic xlink:href="247924_tblS1" position="float" orientation="portrait" hwp:id="graphic-65"/></table-wrap>
parameter boundaries are log<sub>10</sub>(<italic toggle="yes">θ</italic>)<sub>lb</sub> = −3 and log<sub>10</sub>(<italic toggle="yes">θ</italic>)<sub>ub</sub> = 3, except for
<disp-formula id="ueqn40" hwp:id="disp-formula-58">
<alternatives hwp:id="alternatives-98"><graphic xlink:href="247924_ueqn40.gif" position="float" orientation="portrait" hwp:id="graphic-66"/></alternatives>
</disp-formula>
The fitted experimental data for the whole data set are shown in <xref rid="figS4" ref-type="fig" hwp:id="xref-fig-8-2" hwp:rel-id="F8">Figure S4</xref>. The comparison of Gaussian and Laplace noise showed that Laplace noise yielded a substantially improved fit of the data (<xref rid="figS1" ref-type="fig" hwp:id="xref-fig-5-5" hwp:rel-id="F5">Figure S1C</xref>).</p><fig id="figS4" position="float" orientation="portrait" fig-type="figure" hwp:id="F8" hwp:rev-id="xref-fig-8-1 xref-fig-8-2"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;247924v1/FIGS4</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F8</object-id><object-id pub-id-type="publisher-id">figS4</object-id><label>Supplementary Figure S4:</label><caption hwp:id="caption-9"><p hwp:id="p-68">Experimental data for JAK-STAT signaling model II. Boxes indicate different experiments. The lines highlight the different models (Gaussian and Laplace noise) and optimization approaches (standard and hierarchical).</p></caption><graphic xlink:href="247924_figS4" position="float" orientation="portrait" hwp:id="graphic-67"/></fig></sec><sec id="s4c" hwp:id="sec-31"><label>4.3</label><title hwp:id="title-33">RAF/MEK/ERK signaling</title><p hwp:id="p-69">The ODE system for the RAF/MEK/ERK signaling model is given by
<disp-formula id="ueqn41" hwp:id="disp-formula-59">
<alternatives hwp:id="alternatives-99"><graphic xlink:href="247924_ueqn41.gif" position="float" orientation="portrait" hwp:id="graphic-68"/></alternatives>
</disp-formula>
with states <italic toggle="yes">x</italic><sub>1</sub> = [pRaf]/[Raf]<sub>0</sub>, <italic toggle="yes">x</italic><sub>2</sub> = [pMEK]/[MEK]<sub>0</sub>, and <italic toggle="yes">x</italic><sub>3</sub> = [pERK]/[ERK]<sub>0</sub>, and
<disp-formula id="ueqn42" hwp:id="disp-formula-60">
<alternatives hwp:id="alternatives-100"><graphic xlink:href="247924_ueqn42.gif" position="float" orientation="portrait" hwp:id="graphic-69"/></alternatives>
</disp-formula>
(see (<xref rid="sc2" ref-type="bibr" hwp:id="xref-ref-24-1" hwp:rel-id="ref-24">Fiedler et al., 2016</xref>) for more details). The initial conditions were assumed to be the steady states reached without stimulation and for <italic toggle="yes">K</italic><sub>1,max</sub> = <italic toggle="yes">K</italic><sub>1,0</sub>. Defining <inline-formula hwp:id="inline-formula-41">
<alternatives hwp:id="alternatives-101"><inline-graphic xlink:href="247924_inlineS18.gif" hwp:id="inline-graphic-41"/></alternatives>
</inline-formula>
<inline-formula hwp:id="inline-formula-42">
<alternatives hwp:id="alternatives-102"><inline-graphic xlink:href="247924_inlineS19.gif" hwp:id="inline-graphic-42"/></alternatives>
</inline-formula> and
<inline-formula hwp:id="inline-formula-43">
<alternatives hwp:id="alternatives-103"><inline-graphic xlink:href="247924_inlineS20.gif" hwp:id="inline-graphic-43"/></alternatives>
</inline-formula> we obtain
<disp-formula id="ueqn43" hwp:id="disp-formula-61">
<alternatives hwp:id="alternatives-104"><graphic xlink:href="247924_ueqn43.gif" position="float" orientation="portrait" hwp:id="graphic-70"/></alternatives>
</disp-formula>
<disp-formula id="ueqn44" hwp:id="disp-formula-62">
<alternatives hwp:id="alternatives-105"><graphic xlink:href="247924_ueqn44.gif" position="float" orientation="portrait" hwp:id="graphic-71"/></alternatives>
</disp-formula>
The observables are given by
<disp-formula id="ueqn45" hwp:id="disp-formula-63">
<alternatives hwp:id="alternatives-106"><graphic xlink:href="247924_ueqn45.gif" position="float" orientation="portrait" hwp:id="graphic-72"/></alternatives>
</disp-formula>
for replicates <italic toggle="yes">r</italic> = 1,…, 4. The indices for conditions and experiments are neglected, since the scaling and noise parameters do not differ for these. The input u describes the concentrations [sora] and [UO126] and the three different conditions are <italic toggle="yes">u</italic><sub>1</sub> = (0, 0)<sup><italic toggle="yes">T</italic></sup>, <italic toggle="yes">u</italic><sub>2</sub> = (0, 30)<sup><italic toggle="yes">T</italic></sup>, and <italic toggle="yes">u</italic><sub>3</sub> = (5, 0)<sup><italic toggle="yes">T</italic></sup>. The parameters, which are estimated from the data, are
<disp-formula id="ueqn46" hwp:id="disp-formula-64">
<alternatives hwp:id="alternatives-107"><graphic xlink:href="247924_ueqn46.gif" position="float" orientation="portrait" hwp:id="graphic-73"/></alternatives>
</disp-formula>
with specific scaling and noise parameters for replicates and observables. The parameters boundaries for the optimization are
<disp-formula id="ueqn47" hwp:id="disp-formula-65">
<alternatives hwp:id="alternatives-108"><graphic xlink:href="247924_ueqn47.gif" position="float" orientation="portrait" hwp:id="graphic-74"/></alternatives>
</disp-formula>
We performed 500 multi-starts to obtain the optimal parameters for both distributions. The comparison between the two noise assumptions for the measurement noise showed that the Laplace noise yielded a substantially better fit (<xref rid="figS1" ref-type="fig" hwp:id="xref-fig-5-6" hwp:rel-id="F5">Figure S1C</xref>).</p><fig id="figS5" position="float" orientation="portrait" fig-type="figure" hwp:id="F9" hwp:rev-id="xref-fig-9-1"><object-id pub-id-type="other" hwp:sub-type="pisa">biorxiv;247924v1/FIGS5</object-id><object-id pub-id-type="other" hwp:sub-type="slug">F9</object-id><object-id pub-id-type="publisher-id">figS5</object-id><label>Supplementary Figure S5:</label><caption hwp:id="caption-10"><p hwp:id="p-70">Likelihood waterfall plot for RAF/MEK/ERK signaling.</p></caption><graphic xlink:href="247924_figS5" position="float" orientation="portrait" hwp:id="graphic-75"/></fig></sec></sec><ref-list hwp:id="ref-list-2"><title hwp:id="title-34">References</title><ref id="sc1" hwp:id="ref-23" hwp:rev-id="xref-ref-23-1 xref-ref-23-2 xref-ref-23-3 xref-ref-23-4 xref-ref-23-5"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.23" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-23"><string-name name-style="western" hwp:sortable="Bachmann J."><surname>Bachmann</surname>, <given-names>J.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Raue A."><surname>Raue</surname>, <given-names>A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Schilling M."><surname>Schilling</surname>, <given-names>M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Böhm M. E."><surname>Böhm</surname>, <given-names>M. E.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kreutz C."><surname>Kreutz</surname>, <given-names>C.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kaschek D."><surname>Kaschek</surname>, <given-names>D.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Busch H."><surname>Busch</surname>, <given-names>H.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Gretz N."><surname>Gretz</surname>, <given-names>N.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Lehmann W. D."><surname>Lehmann</surname>, <given-names>W. D.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Timmer J."><surname>Timmer</surname>, <given-names>J.</given-names></string-name>, and <string-name name-style="western" hwp:sortable="Klingm¨uller U."><surname>Klingm¨uller</surname>, <given-names>U.</given-names></string-name> (<year>2011</year>). <article-title hwp:id="article-title-23">Division of labor by dual feedback regulators controls JAK2/STAT5 signaling over broad ligand range</article-title>. <source hwp:id="source-20">Mol. Syst. Biol</source>., <volume>7</volume>(<issue>1</issue>):<fpage>516</fpage>.</citation></ref><ref id="sc2" hwp:id="ref-24" hwp:rev-id="xref-ref-24-1"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.24" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-24"><string-name name-style="western" hwp:sortable="Fiedler A."><surname>Fiedler</surname>, <given-names>A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Raeth S."><surname>Raeth</surname>, <given-names>S.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Theis F. J."><surname>Theis</surname>, <given-names>F. J.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Hausser A."><surname>Hausser</surname>, <given-names>A.</given-names></string-name>, and <string-name name-style="western" hwp:sortable="Hasenauer J."><surname>Hasenauer</surname>, <given-names>J.</given-names></string-name> (<year>2016</year>). <article-title hwp:id="article-title-24">Tailored parameter optimization methods for ordinary differential equation models with steady-state constraints</article-title>. <source hwp:id="source-21">BMC Syst. Biol</source>., <volume>10</volume>(<issue>80</issue>).</citation></ref><ref id="sc3" hwp:id="ref-25" hwp:rev-id="xref-ref-25-1"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.25" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-25"><string-name name-style="western" hwp:sortable="Fröhlich F."><surname>Fröhlich</surname>, <given-names>F.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kaltenbacher B."><surname>Kaltenbacher</surname>, <given-names>B.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Theis F. J."><surname>Theis</surname>, <given-names>F. J.</given-names></string-name>, and <string-name name-style="western" hwp:sortable="Hasenauer J."><surname>Hasenauer</surname>, <given-names>J.</given-names></string-name> (<year>2017</year>). <article-title hwp:id="article-title-25">Scalable parameter estimation for genome-scale biochemical reaction networks</article-title>. <source hwp:id="source-22">PLoS Comput. Biol</source>., <volume>13</volume>(<issue>1</issue>):<fpage>e1005331</fpage>.</citation></ref><ref id="sc4" hwp:id="ref-26" hwp:rev-id="xref-ref-26-1"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.26" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-26"><string-name name-style="western" hwp:sortable="Kass R. E."><surname>Kass</surname>, <given-names>R. E.</given-names></string-name> and <string-name name-style="western" hwp:sortable="Raftery A. E."><surname>Raftery</surname>, <given-names>A. E.</given-names></string-name> (<year>1995</year>). <article-title hwp:id="article-title-26">Bayes factors</article-title>. <source hwp:id="source-23">J. Am. Stat. Assoc</source>., <volume>90</volume>(<issue>430</issue>):<fpage>773</fpage>–<lpage>795</lpage>.</citation></ref><ref id="sc5" hwp:id="ref-27" hwp:rev-id="xref-ref-27-1"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.27" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-27"><string-name name-style="western" hwp:sortable="Maier C."><surname>Maier</surname>, <given-names>C.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Loos C."><surname>Loos</surname>, <given-names>C.</given-names></string-name>, and <string-name name-style="western" hwp:sortable="Hasenauer J."><surname>Hasenauer</surname>, <given-names>J.</given-names></string-name> (<year>2017</year>). <article-title hwp:id="article-title-27">Robust parameter estimation for dynamical systems from outlier-corrupted data</article-title>. <source hwp:id="source-24">Bioinformatics</source>, <volume>33</volume>(<issue>5</issue>):<fpage>718</fpage>–<lpage>725</lpage>.</citation></ref><ref id="sc6" hwp:id="ref-28" hwp:rev-id="xref-ref-28-1"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.28" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-28"><string-name name-style="western" hwp:sortable="Raftery A. E."><surname>Raftery</surname>, <given-names>A. E.</given-names></string-name> (<year>1999</year>). <article-title hwp:id="article-title-28">Bayes factors and BIC</article-title>. <source hwp:id="source-25">Socio. Meth. Res</source>., <volume>27</volume>(<issue>3</issue>):<fpage>411</fpage>–<lpage>417</lpage>.</citation></ref><ref id="sc7" hwp:id="ref-29" hwp:rev-id="xref-ref-29-1"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.29" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-29"><string-name name-style="western" hwp:sortable="Raue A."><surname>Raue</surname>, <given-names>A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Kreutz C."><surname>Kreutz</surname>, <given-names>C.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Maiwald T."><surname>Maiwald</surname>, <given-names>T.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Bachmann J."><surname>Bachmann</surname>, <given-names>J.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Schilling M."><surname>Schilling</surname>, <given-names>M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Klingm¨uller U."><surname>Klingm¨uller</surname>, <given-names>U.</given-names></string-name>, and <string-name name-style="western" hwp:sortable="Timmer J."><surname>Timmer</surname>, <given-names>J.</given-names></string-name> (<year>2009</year>). <article-title hwp:id="article-title-29">Structural and practical identifiability analysis of partially observed dynamical models by exploiting the profile likelihood</article-title>. <source hwp:id="source-26">Bioinformatics</source>, <volume>25</volume>(<issue>25</issue>):<fpage>1923</fpage>–<lpage>1929</lpage>.</citation></ref><ref id="sc8" hwp:id="ref-30" hwp:rev-id="xref-ref-30-1 xref-ref-30-2"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.30" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-30"><string-name name-style="western" hwp:sortable="Schelker M."><surname>Schelker</surname>, <given-names>M.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Raue A."><surname>Raue</surname>, <given-names>A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Timmer J."><surname>Timmer</surname>, <given-names>J.</given-names></string-name>, and <string-name name-style="western" hwp:sortable="Kreutz C."><surname>Kreutz</surname>, <given-names>C.</given-names></string-name> (<year>2012</year>). <article-title hwp:id="article-title-30">Comprehensive estimation of input signals and dynamics in biochemical reaction networks</article-title>. <source hwp:id="source-27">Bioinformatics</source>, <volume>28</volume>(<issue>18</issue>):<fpage>i529</fpage>–<lpage>i534</lpage>.</citation></ref><ref id="sc9" hwp:id="ref-31" hwp:rev-id="xref-ref-31-1 xref-ref-31-2"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.31" ref:linkable="no" ref:use-reference-as-is="yes" hwp:id="citation-31"><string-name name-style="western" hwp:sortable="Stapor P."><surname>Stapor</surname>, <given-names>P.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Weindl D."><surname>Weindl</surname>, <given-names>D.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Ballnus B."><surname>Ballnus</surname>, <given-names>B.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Hug S."><surname>Hug</surname>, <given-names>S.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Loos C."><surname>Loos</surname>, <given-names>C.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Fiedler A."><surname>Fiedler</surname>, <given-names>A.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Krause S."><surname>Krause</surname>, <given-names>S.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Hross S."><surname>Hross</surname>, <given-names>S.</given-names></string-name>, <string-name name-style="western" hwp:sortable="Fröhlich F."><surname>Fröhlich</surname>, <given-names>F.</given-names></string-name>, and <string-name name-style="western" hwp:sortable="Hasenauer J."><surname>Hasenauer</surname>, <given-names>J.</given-names></string-name> (<year>2017</year>). <article-title hwp:id="article-title-31">PESTO: Parameter EStimation TOolbox</article-title>. <source hwp:id="source-28">Bioinformatics, btx676</source>.</citation></ref><ref id="sc10" hwp:id="ref-32" hwp:rev-id="xref-ref-32-1 xref-ref-32-2"><citation publication-type="journal" citation-type="journal" ref:id="247924v1.32" ref:linkable="yes" ref:use-reference-as-is="yes" hwp:id="citation-32"><string-name name-style="western" hwp:sortable="Vaz A. I. F."><surname>Vaz</surname>, <given-names>A. I. F.</given-names></string-name> and <string-name name-style="western" hwp:sortable="Vicente L. N."><surname>Vicente</surname>, <given-names>L. N.</given-names></string-name> (<year>2009</year>). <article-title hwp:id="article-title-32">PSwarm: A hybrid solver for linearly constrained global derivative-free optimization</article-title>. <source hwp:id="source-29">Optim. Method. Softw</source>., <volume>24</volume>(<issue>4–5</issue>):<fpage>669</fpage>–<lpage>685</lpage>.</citation></ref></ref-list></back></article>
