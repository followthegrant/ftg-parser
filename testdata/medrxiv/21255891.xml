<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">MEDRXIV</journal-id>
<journal-title-group>
<journal-title>medRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">medRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/2021.04.21.21255891</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Epidemiology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>VGsim: scalable viral genealogy simulator for global pandemic</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Shchur</surname><given-names>Vladimir</given-names></name>
<xref ref-type="aff" rid="a1">&#x002A;</xref>
<xref ref-type="corresp" rid="cor1">&#x0026;</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Spirin</surname><given-names>Vadim</given-names></name>
<xref ref-type="aff" rid="a1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Pokrovskii</surname><given-names>Victor</given-names></name>
<xref ref-type="aff" rid="a1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Burovski</surname><given-names>Evgeni</given-names></name>
<xref ref-type="aff" rid="a1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>De Maio</surname><given-names>Nicola</given-names></name>
<xref ref-type="aff" rid="a3">&#x2021;</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Corbett-Detig</surname><given-names>Russell</given-names></name>
<xref ref-type="aff" rid="a1">&#x002A;</xref>
<xref ref-type="aff" rid="a2">&#x2020;</xref>
</contrib>
<aff id="a1"><label>&#x002A;</label><institution>National Research University Higher School of Economics</institution>, <country>Russian Federation</country></aff>
<aff id="a2"><label>&#x2020;</label><institution>Department of Biomolecular Engineering and Genomics Institute</institution>, UC Santa Cruz, California 95064</aff>
<aff id="a3"><label>&#x2021;</label><institution>European Molecular Biology Laboratory, European Bioinformatics Institute</institution>, Wellcome Genome Campus, Hinxton, Cambridgeshire, CB10 1SD, <country>UK</country></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x0026;</label>Corresponding author: <email>vshchur@hse.ru</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2021</year>
</pub-date>
<elocation-id>2021.04.21.21255891</elocation-id>
<history>
<date date-type="received">
<day>21</day>
<month>4</month>
<year>2021</year>
</date>
<date date-type="rev-recd">
<day>21</day>
<month>4</month>
<year>2021</year>
</date>
<date date-type="accepted">
<day>27</day>
<month>4</month>
<year>2021</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2021, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2021</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution-NonCommercial-NoDerivs 4.0 International), CC BY-NC-ND 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/">http://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="21255891.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>As an effort to help contain the COVID-19 pandemic, large numbers of SARS-CoV-2 genomes have been sequenced from all continents. More than one million viral sequences are publicly available as of April 2021. Many studies estimate viral genealogies from these sequences, as these can provide valuable information about the spread of the pandemic across time and space. Additionally such data are a rich source of information about molecular evolutionary processes including natural selection, for example allowing the identification and investigating the spread of new variants conferring transmissibility and immunity evasion advantages to the virus. To validate new methods and to verify results resulting from these vast datasets, one needs an efficient simulator able to simulate the pandemic to approximate world-scale scenarios and generate viral genealogies of millions of samples. Here, we introduce a new fast simulator <italic>VGsim</italic> which addresses this problem. The simulation process is split into two phases. During the forward run the algorithm generates a chain of events reflecting the dynamics of the pandemic using an hierarchical version of the Gillespie algorithm. During the backward run a coalescent-like approach generates a tree genealogy of samples conditioning on the events chain generated during the forward run. Our software can model complex population structure, epistasis and immunity escape. The code is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Genomics-HSE/VGsim">https://github.com/Genomics-HSE/VGsim</ext-link>.</p>
</abstract>
<counts>
<page-count count="16"/>
</counts>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<notes notes-type="financial-disclosure">
<title>Funding Statement</title><p>VSh, VSp, VP, RCD were funded within the framework of the HSE University Basic Research Program. This research was supported in part through computational resources of HPC facilities at NRU HSE. RCD was supported in part by NIH/NIGMS R35GM128932. NDM was supported by the European Molecular Biology Laboratory.</p></notes>
<notes notes-type="disclosures">
<title>Author Declarations</title><p>I confirm all relevant ethical guidelines have been followed, and any necessary IRB and/or ethics committee approvals have been obtained.</p><p>Yes</p><p>The details of the IRB/oversight body that provided approval or exemption for the research described are given below:</p><p>No IRB approval is necessary. No data were used in the work which relies exclusively on simulation.</p><p>All necessary patient/participant consent has been obtained and the appropriate institutional forms have been archived.</p><p>Yes</p><p>I understand that all clinical trials and any other prospective interventional studies must be registered with an ICMJE-approved registry, such as ClinicalTrials.gov. I confirm that any such study reported in the manuscript has been registered and the trial registration ID is provided (note: if posting a prospective study registered retrospectively, please provide a statement in the trial ID field explaining why the study was not registered in advance).</p><p>Yes</p><p>I have followed all appropriate research reporting guidelines and uploaded the relevant EQUATOR Network research reporting checklist(s) and other pertinent material as supplementary files, if applicable.</p><p>Yes</p></notes>
</notes>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Introduction</title>
<p>The unprecedented world-wide and timely effort in the producing and sharing of viral genomic data for the ongoing SARS-CoV-2 pandemic has given us the possibility to trace the spread and the evolution of the virus in real time, and has made apparent the need for improved computational methods to study and to simulate viral evolution. Vast sequencing efforts have now produced more than 1 million total viral genomes. In turn, these data yield important insights into the effects of population structure [<xref ref-type="bibr" rid="c10">Gonzalez-Reiche et al., 2020</xref>, <xref ref-type="bibr" rid="c23">Nadeau et al., 2021</xref>, <xref ref-type="bibr" rid="c18">Ladner et al., 2020</xref>, <xref ref-type="bibr" rid="c16">Komissarov et al., 2021</xref>], public health measures [<xref ref-type="bibr" rid="c21">Lycett et al., 2021</xref>, <xref ref-type="bibr" rid="c29">Tegally et al., 2020</xref>], immunity escape [<xref ref-type="bibr" rid="c8">Garcia-Beltran et al., 2021</xref>, <xref ref-type="bibr" rid="c2">Burioni and Topol, 2021</xref>], and complex fitness effects [<xref rid="c33" ref-type="bibr">Zeng et al., 2020</xref>, <xref ref-type="bibr" rid="c24">Rochman et al., 2021</xref>]. It is essential that we also have tools to accurately simulate viral evolutionary processes so that the research community can validate inference methods and develop novel insights into the effects of such complexities. However, to date, there are no software packages capable of simulating much of the apparent complexity of viral evolutionary dynamics that we have seen during the SARS-CoV-2 pandemic.</p>
<p>The huge amount of genomic data generated recently raises multiple important problems in designing research studies. Some of these problems are technical issues, while others are conceptual. Technical problems are associated with the scalability of methods and memory usage. There is already substantial progress in building scalable simulators and data analysis methods for human genome data. The current state-of-the-art human genome simulator msprime [<xref ref-type="bibr" rid="c11">Kelleher et al., 2016</xref>] is capable of simulating millions of sequences with length comparable with human chromosomes. Methods such as the Positional Burrows-Wheeler Transform (PBWT) [<xref ref-type="bibr" rid="c5">Durbin, 2014</xref>], its ARG-based extension tree consistent PBWT [<xref ref-type="bibr" rid="c26">Shchur et al., 2019</xref>], and tsinfer [<xref ref-type="bibr" rid="c12">Kelleher et al., 2019</xref>] can be used to efficiently process and store genomic sequences, but all of these approaches are designed primarily for actively recombining organisms. Moreover, for most of these methods, the primary population models underlying them are the Kingman coalescent [<xref ref-type="bibr" rid="c15">Kingman, 1982</xref>], the Wright-Fisher model [<xref ref-type="bibr" rid="c7">Fisher and Russell, 1922</xref>, <xref ref-type="bibr" rid="c31">Wright, 1931</xref>] and the Li-Stephens model [<xref ref-type="bibr" rid="c20">Li and Stephens, 2003</xref>]. We recently made progress by developing an approach for compressing and accessing viral genealogies that can dramatically reduce space and memory requirements [<xref ref-type="bibr" rid="c30">Turakhia et al., 2020</xref>, <xref ref-type="bibr" rid="c22">McBroome et al., 2021</xref>], but there are no methods available for simulation of viral genealogies that can efficiently simulate pandemic-scale datasets.</p>
<p>Coalescent models are powerful tools for studying humans, many other eukaryotes, and pathogen populations (<italic>e</italic>.<italic>g</italic>. [<xref rid="c4" ref-type="bibr">De Maio and Wilson, 2017</xref>]). However, their assumptions are often violated in epidemiological settings. Firstly, coalescent models explicitly assume that the sample size is much smaller than the effective population size. Given the ongoing massive sequencing efforts, this assumption is clearly violated in the context of the SARS-CoV-2 pandemic (specifically in countries with high rates of sequencing such as the UK) and likely will not hold in future pathogen surveillance programs. Second, in coalescent models the effective population size is usually modelled either as piece-wise constant, or as exponential growth. As shown in [<xref ref-type="bibr" rid="c19">Lambert and Stadler, 2013</xref>], the coalescent model with exponential growth and birth-death models do not result in equivalent genealogies. If we consider the pandemic on a longer time period, basic birth-death models (e.g. [<xref ref-type="bibr" rid="c27">Stadler, 2009</xref>]) are not an appropriate choice, since the reproductive rate usually decreases with time as collective immunity builds up or as the susceptible population is exhausted. These limitations are often addressed in epidemiology using compartmental models, such as SI, SIS and SIR [<xref ref-type="bibr" rid="c1">Brauer, 2008</xref>], which can also be considered birth-death processes.</p>
<p>Furthermore, simulating realistic selection in backward-time models is a well-known challenging problem. A common workaround is to assume a single deterministic frequency trajectory or to generate a stochastic frequency trajectory in forward time for a single selected site, and then to simulate the ancestry of the samples around the selected site in a coalescent framework (e.g., [<xref ref-type="bibr" rid="c14">Kern and Schrider, 2016</xref>, <xref ref-type="bibr" rid="c6">Ewing and Hermisson, 2010</xref>]). However, more complex models of selection, including e.g., gene-gene interactions, or epistasis, are often beyond the scope of such coalescent models. Nonetheless, epistasis is thought to be an important component of viral evolutionary processes [<xref ref-type="bibr" rid="c17">Kryazhimskiy et al., 2011</xref>, <xref rid="c25" ref-type="bibr">Sanju&#x00E1;n et al., 2004</xref>], and incorporating the effects of such complex evolutionary dynamics is clearly essential for accurate simulations of evolution.</p>
<p>In this work we introduce a novel simulation method that can be used to rapidly generate pandemic-scale viral genealogies. Our approach is based on a forward-backward algorithm where we generate a series of stochastic events forward in time, then traverse backwards through this event series to generate the realized viral genealogy for a sample taken from the full population throughout the pandemic. This framework allows the modeling of the accumulation of immunity within host populations and of viral mutations that affect the spread and fitness of their descendant lineages. Our method is extremely fast, and can produce a phylogeny with 50 million total samples in just 88.5 seconds. The genealogies output from our simulation are compatible with phastSim [<xref ref-type="bibr" rid="c3">De Maio et al., 2021</xref>], making it possible to generate realistic genome data for the simulated samples. This simulation framework will empower efficient and realistic studies of pandemic-scale viral datasets.</p>
</sec>
<sec id="s2">
<label>2</label>
<title>Model</title>
<sec id="s2a">
<label>2.1</label>
<title>Model Overview</title>
<p>Our model of epidemiological spread is built as a compartmental model [Kermack William Ogilvy and Thomas, and the random realisations of the corresponding stochastic process are drawn using the Gillespie algorithm [<xref ref-type="bibr" rid="c9">Gillespie, 2007</xref>]. The different compartments in our model are defined based on several real-world complexities that interact with each other in a complex way and can affect epidemiological dynamics: population structure (which means defining separate host populations and assigning different frequencies to within-population and between-population contacts), separate infectious groups (which means that host individuals carrying different viral haplotypes are modeled differently, since some viral variants might be more transmissible than others), and different susceptible groups (different hosts having different types of immunity response to different haplotypes).</p>
<p>To get some basic intuition behind the compartmental models, consider the simple case of a SIS model. In this model every individual can be either susceptible (S) or infectious (I). If a susceptible individual meets an infectious individual, there is a chance <italic>p</italic> that the infectious individual transmit the infection to the susceptible individual. All individuals have the same contact rate <italic>r</italic> (the number of other individuals they meet in a time unit). Assume there are <italic>S</italic>(<italic>t</italic>) and <italic>I</italic>(<italic>t</italic>) susceptible and infectious individuals at time <italic>t</italic>, and the constant total population size is <italic>N</italic>. For a single susceptible individual the chance that the next random encounter with another person would be with an infectious individual is <italic>I</italic>(<italic>t</italic>)<italic>/</italic>(<italic>N &#x2212;</italic> 1) (though <italic>N</italic> is usually large, so <italic>N &#x2212;</italic> 1 <italic>&#x2248; N</italic>). So the rate at which a single susceptible individual becomes infected is <inline-formula><alternatives><inline-graphic xlink:href="21255891v1_inline1.gif"/></alternatives></inline-formula> (contact rate times the probability that the second individual is infectious times the probability of transmission). The total rate of a new infections in the population will be <italic>&#x03BB;</italic> &#x003D; <italic>S</italic>(<italic>t</italic>)<italic>&#x03BB;</italic><sub>1</sub>. Similarly, infectious individuals recover with some rate <italic>&#x00B5;</italic><sub>1</sub>, and the total recovery rate in the population is <italic>&#x00B5;</italic> &#x003D; <italic>&#x00B5;</italic><sub>1</sub><italic>I</italic>(<italic>t</italic>). From the theory of Poisson processes, it follows that the total rate of events in the population is simply the sum <italic>&#x03BB;</italic> &#x002B; <italic>&#x00B5;</italic>, and the waiting time of the first event is distributed exponentially with rate (parameter) <italic>&#x03BB;</italic> &#x002B; <italic>&#x00B5;</italic>, and with probability <italic>&#x03BB;/</italic>(<italic>&#x03BB;</italic> &#x002B; <italic>&#x00B5;</italic>) the event is a new infection. This gives a straightforward method to simulate from this distribution. This approach is generalised to an arbitrary number of compartments. The SIS model is the basis for all the compartmental models we implemented, but we expand on the basic model (as described below in details) by allowing different types of S and I compartments in the same simulation.</p>
<p>We break the simulation into two phases. In the first (the forward pass), we generate the series of events that will determine the properties of the sampled viral genealogy. In the second phase, we collect the series of events that determine the specific viral genealogy that we sample from within the pandemic.</p>
</sec>
<sec id="s2b">
<label>2.2</label>
<title>Event Types</title>
<p>In our model, we consider the pandemic as a series of six types of events:</p>
<list list-type="bullet">
<list-item><p>New infection (transmission, birth within population): an infectious individual and a susceptible individual from the same population meet each other, and the former infects the latter with a certain probability.</p></list-item>
<list-item><p>Becoming uninfectious (recovery, death): an infectious individual recovers or is isolated and treated, so he/she is not able to further transmit the infection (unless it will be later infected again). The individual is moved to a susceptible group depending on the viral haplotype it was last infected with. Different susceptible groups might have different resistance (complete, partial or even increased) to different haplotypes.</p></list-item>
<list-item><p>Sampling: the viral genome of an infected individual is sequenced; the genealogical tree is generated only for the sampled cases. In our model, sampling also means that the individual immediately becomes uninfectious (quarantined and treated - similar to [<xref ref-type="bibr" rid="c28">Stadler et al., 2013</xref>]).</p></list-item>
<list-item><p>Mutation: mutations are modelled as nucleotide substitutions at specific positions in the viral genome. In our genealogy simulation, we track only mutations at the sites that are strongly positively selected. Later, we explain how neutral nucleotide substitution models can be overlaid on the genealogy.</p></list-item>
<list-item><p>Transition between susceptible compartments (immunity change): the direct transition between susceptible compartments might correspond to vaccination or immunity loss.</p></list-item>
<list-item><p>Migration (between-population transmission, outside introduction): migration is a birth-type event, occurring from the interaction between an infectious and a susceptible individuals from different populations.</p></list-item>
</list>
<p>When generating these events during the first forward pass, we record each event with the corresponding information. For example, we would record in which population (or between which populations) the event occurred, which haplotype and susceptibility group (if applicable) is affected etc.</p>
</sec>
<sec id="s2c">
<label>2.3</label>
<title>Mutation model</title>
<p>Because this simulation framework is focused on generating the viral genealogy we track only mutations at sites that have a large positive effect on viral fitness. That is, these mutations enhance the transmissibility of the virus or lead to immunity escape. We expect this will typically be a relatively small number of mutations relative to the size of the viral genome, simplifying the problem substantially. To efficiently model neutral genetic variation we suggest using <italic>phastSim</italic> [<xref ref-type="bibr" rid="c3">De Maio et al., 2021</xref>] on a tree generated by our algorithm, and the output produced by our method can be directly imported into phastSim for downstream processing.</p>
<p>To define the intended model of selection on new mutations, the user specifies the number of mutable sites and their specific fitness effects (i.e., their effect on the birth rate). Mutations lead to the appearance of different haplotypes with different transmission and immunological properties. Birth (transmission), death (uninfectious), and sampling rates, as well as substitution rates, susceptibility, and triggered susceptibility (immunity) types can be defined individually for every haplotype by the user. Of particular interest, gene-gene, or epistatic, interactions can be flexibly modelled using this approach.</p>
<p>We refer to sequences carrying particular sets of variants as &#x201C;haplotypes&#x201D;. We choose this term, because of the two reasons. Firstly, two identical sequences can appear as a results of different mutation events, so they might not belong to the same clade, or lineage, in the final tree.</p>
</sec>
<sec id="s2d">
<label>2.4</label>
<title>Epidemiological model</title>
<p>To model the host immunity process, we use a generalised SI-model. The compartments within each population represent different types of susceptible individuals or infectious individuals infected with different haplotypes.</p>
<p>Different susceptible compartments in the same host population are used to model different types of immunity. These compartments correspond to host individuals that have recovered from previous exposure to different viral haplotypes. We introduce a susceptibility coefficient, which multiplicatively changes the transmission (birth) rate of the corresponding haplotype. In particular, <italic>&#x03C3;</italic><sub><italic>ik</italic></sub> &#x003D; 0 correspond to absolute resistance, similar to the R-compartment in SIR-model, but specific to individuals who recovered from an infection with haplotype <italic>i</italic> and are exposed to haplotype <italic>k. &#x03C3;</italic><sub><italic>ik</italic></sub> &#x003C; 1 would correspond to partial immunity, while <italic>&#x03C3;</italic><sub><italic>ik</italic></sub> <italic>&#x003E;</italic> 1 corresponds to increased susceptibility. Each susceptible compartment <italic>S</italic><sub><italic>i</italic></sub> is characterised by the set of susceptibility coefficients <italic>&#x03C3;</italic><sub><italic>ik</italic></sub> (with <italic>k</italic> enumerating the viral haplotypes).</p>
<p>Different infectious compartments within the same host population correspond to host individuals which are infected by a haplotype and can potentially infect susceptible hosts with the same haplotype. As we mentioned in the <xref ref-type="sec" rid="s2c">section 2.3</xref>, the infectious rate, recovery rate and mutation rates can be set independently for each haplotype. After recovery, a host individual that was infected with haplotype <italic>k</italic>, and therefore was in compartment <italic>I</italic><sub><italic>k</italic></sub>, is moved to the corresponding susceptibility (immunity) compartment <italic>S</italic><sub><italic>i</italic>(<italic>k</italic>)</sub>. Different haplotypes might however lead to the same types of immunity.</p>
<p><italic>NB:</italic> The evolution of individual immunity is modeled as Markovian - it is determined only by the latest infection, and does not have memory about all other previous infections in its history. Whether this assumption provides an accurate approximation of the immunity dynamics within the host population is an important consideration and may depend in large part on the specific pathogen biology.</p>
<p>The rate of transmission, or birth, of new viral lineages within a population also depends on how frequently two host individuals contact each other. To flexibly accommodate such differences, each population also has a contact density <italic>&#x03C1;</italic> parameter. This parameter can be used to simulate differences in the local population density, social behaviours, and the effects of lockdown orders. The rate for an individual from susceptibility class <italic>S</italic><sub><italic>i</italic></sub> to be infected with haplotype <italic>k</italic> (within population) is
<disp-formula id="ueqn1">
<alternatives><graphic xlink:href="21255891v1_ueqn1.gif"/></alternatives>
</disp-formula>
where <italic>S</italic><sub><italic>i</italic></sub> is the number of individuals with immunity type <italic>i, I</italic><sub><italic>k</italic></sub> is the number of individuals infected with haplotype <italic>k</italic>, and <italic>N</italic> is the population size.</p>
<p>Direct transitions between susceptible compartments are possible. The user can specify a transition matrix for susceptible compartments. This option allows to model processes such as vaccination or loss of immunity.</p>
</sec>
<sec id="s2e">
<label>2.5</label>
<title>Population model</title>
<sec id="s2e1">
<label>2.5.1</label>
<title>Demes</title>
<p>The population model is based on an island (demic) model. Each population is described at each point in time by its total size, number of infectious individuals (with each viral haplotype), number of susceptible host individuals (of each susceptibility type), relative contact density, and lockdown strategy.</p>
</sec>
<sec id="s2e2">
<label>2.5.2</label>
<title>Lockdown</title>
<p>Several governments have imposed lockdowns during the COVID-19 pandemic as an effort to control the spread of SARS-CoV-2 and such efforts are central to many public health responses. Understanding the effects of such lockdowns is a crucial concern for designing effective public health strategies. In our simulations, lockdowns are implemented as follows. When the total number of simultaneously infectious individuals in the population surpasses a certain user-defined population-specific percentage (e.g. 1&#x0025;) of the population size, the lockdown is imposed and the contact density is changed (e.g. decreases by 10 times) to a during-lockdown value. During lockdown, when the percentage of the infectious individuals drops below a user-specified value (e.g. 0.1&#x0025;) the lockdown is lifted and the contact density reverts back to its initial value.</p>
</sec>
<sec id="s2e3">
<label>2.5.3</label>
<title>Migration</title>
<p>Migration is described by a matrix <italic>&#x00B5;</italic><sub><italic>lm</italic></sub> which defines the rate of visits from population <italic>l</italic> into population <italic>m</italic>. The rate at which new infections occur by haplotype <italic>k</italic> in population <italic>s</italic> for individuals with immunity <italic>i</italic> in population <italic>t</italic> is
<disp-formula id="eqn1">
<alternatives><graphic xlink:href="21255891v1_eqn1.gif"/></alternatives>
</disp-formula>
Since it&#x2019;s computationally demanding to keep track of how each migration rate between each pairs of compartment is affected by each simulation event, in-stead we keep track of cumulative upper bounds on such migration rates. In the case a potential migration event is sampled according to these upper bounds, we then proceed to calculate the precise migration rates and only sample a specific migration event according to its own exact rate. This saves us calculations overall in the case when cross-population transmissions (migrations) are rare compared to within-population transmissions. This algorithmic implementation is optimised for this case and might perform suboptimally if population structure is extremely weak.</p>
<p>Here we derive the upper bounds on migration rates. For this purpose, we set &#x03A3;<sub><italic>k</italic></sub> &#x003D; max<sub><italic>i</italic></sub> <italic>&#x03C3;</italic><sub><italic>ik</italic></sub>, &#x039B; &#x003D; max<sub><italic>k</italic></sub> <italic>&#x03BB;</italic><sub><italic>k</italic></sub>&#x03A3;<sub><italic>k</italic></sub>. Then the following holds
<disp-formula id="ueqn2">
<alternatives><graphic xlink:href="21255891v1_ueqn2.gif"/></alternatives>
</disp-formula>
Denote <inline-formula><alternatives><inline-graphic xlink:href="21255891v1_inline2.gif"/></alternatives></inline-formula>. So, the total migration (or introduction) rate from source population <italic>s</italic> into target population <italic>t</italic> is given the upper bound of &#x039B;<italic>M</italic><sub><italic>st</italic></sub><italic>S</italic>(<italic>t</italic>)<italic>I</italic>(<italic>s</italic>).</p>
<p>Setting diagonal elements of the migration matrix to zero <italic>&#x00B5;</italic><sub><italic>tt</italic></sub> &#x003D; 0, we finally get the upper bound for the total migration rate:
<disp-formula id="ueqn3">
<alternatives><graphic xlink:href="21255891v1_ueqn3.gif"/></alternatives>
</disp-formula>
where <italic>S</italic><sub><italic>g</italic></sub> and <italic>I</italic><sub><italic>g</italic></sub> are the total number (over all populations) of susceptible and infectious individuals in the simulation.</p>
<p>If the algorithm samples a potential migration, it samples <italic>s, t, k</italic> and <italic>i</italic> with the probabilities <inline-formula><alternatives><inline-graphic xlink:href="21255891v1_inline3.gif"/></alternatives></inline-formula>, and accepts the migration with probability <inline-formula><alternatives><inline-graphic xlink:href="21255891v1_inline4.gif"/></alternatives></inline-formula> Otherwise, the migration is discarded and the algorithm proceeds to the next iteration. The logical basis of this approach follows from the additivity of Poisson processes (similarly to the reasoning behind the standard Gillespie algorithm [<xref ref-type="bibr" rid="c9">Gillespie, 2007</xref>]).</p>
</sec>
</sec>
<sec id="s2f">
<label>2.6</label>
<title>Sampling</title>
<p>Sampling is modelled as a continuous sampling scheme. In this scheme every infectious individual has a certain sampling rate (potentially depending on its haplotype). Other sampling schemes can be implemented in our framework and will be a subject of future work.</p>
</sec>
</sec>
<sec id="s3">
<label>3</label>
<title>Algorithm</title>
<sec id="s3a">
<label>3.1</label>
<title>Forward run</title>
<p>The first stage of simulation, the forward run, generates a chain of events which reflects the dynamics of the pandemic. We use a tree-like variant of the Gillespie algorithm, and a single random number is &#x201C;sifted&#x201D; through this scheme (see <xref rid="fig1" ref-type="fig">Figure 1</xref>) to draw an event. Firstly, the algorithm decides if the next event is a within-population event (new transmission within population, new recovery, sampling or mutation) or a between-population event (migration).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><title>The scheme used to generate an event in the forward run.</title></caption>
<graphic xlink:href="21255891v1_fig1.tif"/>
</fig>
<p>If a within-population event is drawn, the algorithm subsequently chooses the population where the event occurred, the viral haplotype which produced the event, and the type of event. If a birth event is drawn, its susceptible type is chosen. If a mutation is drawn, the new haplotype is chosen.</p>
<p>If a between-population event (migration) was drawn, the algorithm draws subsequently target population <italic>t</italic>, source population <italic>s</italic>, susceptible group <italic>i</italic> and haplotype <italic>k</italic> and calculates the acceptance probability of this event as explained earlier in <xref ref-type="sec" rid="s2e3">section 2.5.3</xref>.</p>
</sec>
<sec id="s3b">
<label>3.2</label>
<title>Backward run</title>
<p>As described in the previous section, the forward run generates the pandemic dynamics represented as a chain of events. The backward run randomly builds a genealogical tree of the samples while conditioning on this chain.</p>
<p>All the ancestral lineages of the samples generated in the forward run belong to one of the infectious compartment corresponding to some haplotype <italic>k</italic> in some population <italic>p</italic>. As before, denote by <italic>I</italic><sub><italic>k</italic></sub>(<italic>p</italic>) the total number of individuals in this compartment at a given time. Denote by &#x1D543;<sub><italic>k</italic></sub>(<italic>p</italic>) the set of sample ancestral lineages in this compartment, and set <italic>L</italic><sub><italic>k</italic></sub>(<italic>p</italic>) &#x003D; &#x007C;&#x1D543;<sub><italic>k</italic></sub>(<italic>p</italic>) &#x007C; the set size. The lineages are completely interchangeable within each compartment. So, conditional on the event, it is straightforward to calculate the probability that the event affected a sample ancestral lineage or two sample ancestral lineages. This approach of generating a tree conditional on the trajectory of a random process generated by the forward run, is similar to the simulation of structured coalescent with selection [<xref ref-type="bibr" rid="c6">Ewing and Hermisson, 2010</xref>].</p>
<p>Now we describe how each event is processed during the backward run. Basically, the backward time corresponds to reversing time. So, a new infection in forward time corresponds to a coalescence between two lineages in backward direction. Becoming non-infectious in the forward time correspond to a recovered individual becomes infectious in the backward time. Mutation simply should be reverted from the derived allele back to ancestral allele. Migration moves a lineage from target population back into source population, and this lineage coalesces.</p>
<list list-type="bullet">
<list-item><p>New infection with haplotype <italic>k</italic> in population <italic>p</italic>. Two sample ancestral lineages coalesce with probability
<disp-formula id="ueqn4">
<alternatives><graphic xlink:href="21255891v1_ueqn4.gif"/></alternatives>
</disp-formula>
which is the ratio of the number of pairs of lineages over the number of pairs of infected individuals. In this case we randomly choose and remove a pair of lineages <italic>l</italic><sub>1</sub>, <italic>l</italic><sub>2</sub> from &#x1D543;<sub><italic>k</italic></sub>(<italic>p</italic>), add an ancestral node <italic>l</italic><sub><italic>a</italic></sub> into sample genealogy, and set the parent of <italic>l</italic><sub>1</sub>, <italic>l</italic><sub>2</sub> to <italic>l</italic><sub><italic>a</italic></sub>. In any case <italic>I</italic><sub><italic>k</italic></sub>(<italic>p</italic>) &#x2190; <italic>I</italic><sub><italic>k</italic></sub>(<italic>p</italic>) <italic>-</italic> 1.</p></list-item>
<list-item><p>Recovery of an individual infected with haplotype <italic>k</italic> in population <italic>p</italic>. Be-coming non-infectious corresponds to a recovered individual becoming infectious backward in time. Hence, <italic>I</italic><sub><italic>k</italic></sub>(<italic>p</italic>) &#x2190; <italic>I</italic><sub><italic>k</italic></sub>(<italic>p</italic>) &#x002B; 1.</p></list-item>
<list-item><p>Sampling an individual infected with haplotype <italic>k</italic> in population <italic>p</italic>. As with recovery, <italic>I</italic><sub><italic>k</italic></sub>(<italic>p</italic>) &#x2190; <italic>I</italic><sub><italic>k</italic></sub>(<italic>p</italic>) &#x002B; 1. Also, a new leaf node is added to the genealogy, and the corresponding lineage is added into the set L<sub><italic>k</italic></sub>(<italic>p</italic>).</p></list-item>
<list-item><p>Mutation transforming haplotype <italic>k</italic> into derived haplotype <italic>m</italic> in population <italic>p</italic>. This mutation happens to a sample ancestral lineage with probability <italic>L</italic><sub><italic>m</italic></sub>(<italic>p</italic>)<italic>/I</italic><sub><italic>m</italic></sub>(<italic>p</italic>). In this case we randomly choose a lineage from <italic>L</italic><sub><italic>m</italic></sub>(<italic>p</italic>) and move it into <italic>L</italic><sub><italic>k</italic></sub>(<italic>p</italic>). In any case update
<disp-formula id="ueqn5">
<alternatives><graphic xlink:href="21255891v1_ueqn5.gif"/></alternatives>
</disp-formula>
</p></list-item>
<list-item><p>Transition between susceptible compartments (immunity change). This does not have any effect on the genealogy.</p></list-item>
<list-item><p>Migration of haplotype <italic>k</italic> from source population <italic>p</italic> into target population <italic>t</italic>. First, with probability <italic>L</italic><sub><italic>k</italic></sub>(<italic>t</italic>)<italic>/I</italic><sub><italic>k</italic></sub>(<italic>t</italic>) a sample ancestral lineage is affected by the migration. In this case we randomly choose a lineage from &#x1D543;<sub><italic>k</italic></sub>(<italic>t</italic>) and move it into &#x1D543;<sub><italic>k</italic></sub>(<italic>p</italic>). With probability (<italic>L</italic><sub><italic>k</italic></sub>(<italic>p</italic>) <italic>-</italic> 1)<italic>/I</italic><sub><italic>k</italic></sub>(<italic>p</italic>) this lineage coalesces with a sample ancestral lineage in the source population. In this case randomly draw a lineage &#x1D543;<sub><italic>k</italic></sub>(<italic>p</italic>) (except for the one which was just moved there), and update the genealogy similarly to the new infection case. In any case update
<disp-formula id="ueqn6">
<alternatives><graphic xlink:href="21255891v1_ueqn6.gif"/></alternatives>
</disp-formula>
</p></list-item>
</list>
</sec>
</sec>
<sec id="s4">
<label>4</label>
<title>Results</title>
<sec id="s4a">
<label>4.1</label>
<title>Forward run performance</title>
<sec id="s4a1">
<label>4.1.1</label>
<title>Population model scalability</title>
<p>To test the scalability of the population model, we performed simulations with <italic>K</italic> &#x003D; 2, 5, 10, 20, 50 and 100 total host populations. There are 16 haplotypes resulting from two segregating sites with mutation rates 0.1 in each of them), and three susceptibility group with the first group corresponding to the absence of immunity, second group corresponding to partial immunity and the last one corresponding to resistance to all strains. The transmission rate is 25 for all haplotypes except one, and 40 for this last haplotype. Recovery rate is 9, sampling rate is 1 (so, effective reproductive number is 2.5 which approximately correspond to SARS-CoV-2). All the migration rates were set to <italic>M/</italic>(<italic>K -</italic> 1), where <italic>M</italic> is the cumulative migration rate from a population. That is, our migration matrix is equivalent to a symmetric island model [<xref ref-type="bibr" rid="c32">Wright, 1940</xref>]. Notice that the runtime of the forward algorithm does not depend only on the cumulative migration rate <italic>M</italic>, but also, for example, on the percentage of potential migrations rejected by the algorithm (see <xref ref-type="sec" rid="s2e3">section 2.5.3</xref> for details), which appears to grow with <italic>M</italic> and <italic>K</italic>. In fact, increasing numbers of demes or the total migration rate does result in increases to the algorithm runtime (<xref rid="tbl1" ref-type="table">table 1</xref>). However, the effect on runtime is relatively modest (the naive algorithm is quadratic in the number of populations) indicating that this approach will scale well to globally distributed pandemic simulation scenarios.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><p>Run time to generate 20 million events. The second number is the percentage of discarded events (due to migration acceptance/rejection). There are 16 haplotypes and 3 susceptible compartments. Sampling rate is set to 1, recovery rate is 9, transmission rate is 25 for 15 haplotypes and 40 for the last haplotype</p></caption>
<graphic xlink:href="21255891v1_tbl1.tif"/>
</table-wrap>
</sec>
</sec>
<sec id="s4b">
<label>4.2</label>
<title>Backward run performance</title>
<p>Our implementation of the backward run algorithm is similarly efficient as the forward run. For example, it can produce a viral genealogy with 50 million tips in just 88.5 seconds (<xref rid="tbl2" ref-type="table">Table 2</xref>). The performance of the backward run is affected by the sample size and by the dynamics of the forward run (<xref rid="tbl3" ref-type="table">Table 3</xref>). In combination, the two phases of our algorithm can produce a genealogy of 1 million sample tips with two demes in 6.2 seconds. The combined approach is therefore sufficiently fast that it can be used to generate many replicate simulations as is often required in simulation-based approaches to validate empirical methods and to train model parameters.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2:</label>
<caption><p>Run time in seconds to generate a random genealogy conditional on the event chain. There are 16 haplotypes and 3 susceptible compartments. Sampling rate is set to 1, recovery rate is 9, transmission rate is 25 for 15 haplotypes and 40 for the last haplotype.</p></caption>
<graphic xlink:href="21255891v1_tbl2.tif"/>
</table-wrap>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3:</label>
<caption><p>Total run time to generate 1 million samples. The model includes 100 populations and 16 haplotypes. Hosts do not develop immunity after recovery (SIS-model). The sum of recovery and sampling rate is set to be constant over all simulations (recovery rate is 10 minus sampling rate).</p></caption>
<graphic xlink:href="21255891v1_tbl3.tif"/>
</table-wrap>
</sec>
<sec id="s4c">
<label>4.3</label>
<title>Simulating realistic nucleotide mutation</title>
<p>Many evolutionary and genomic epidemiological inference approaches will ultimately be based on nearly complete viral genome sequences. This simulation framework generates a phylogenetic tree, and if strongly selected mutations are specified, these are included in the output, but it does not include a method for simulating all neutral variants. To facilitate studies that require full viral genome sequences we have made the output of our approach compatible with that of phastSim [<xref ref-type="bibr" rid="c3">De Maio et al., 2021</xref>]. Briefly, a user can easily load the output of our software into phastSim, and phastSim will generate neutral mutations, while leaving previously determined selected mutations unaffected. In the future, we plan to develop an API to enable users to seamlessly interact with both approaches.</p>
</sec>
</sec>
<sec id="s5">
<label>5</label>
<title>Discussion</title>
<p>We developed a fast simulator <italic>VGsim</italic> which can be used to produce genealogies of millions of samples from world-scale pandemic scenarios. Our method allows to build flexible models which simultaneously take into account many major aspects of epidemiological dynamics: complex viral molecular evolution, host population structure, host immunity, and social processes (lockdown orders, vaccination). We expect that <italic>VGsim</italic> will be a useful tool in method validation and in simulation-based statistical inference.</p>
<p>We are working on adding more features and a more flexible interface.</p>
<p>The comparison with existing simulator will also be added soon.</p>
</sec>
</body>
<back>
<sec sec-type="data-availability">
<title>Data Availability</title>
<p>There is no data and reagent used in the paper.</p>
</sec>
<ack>
<label>6</label>
<title>Acknowledgment</title>
<p>VSh, VSp, VP, RCD were funded within the framework of the HSE University Basic Research Program. This research was supported in part through computational resources of HPC facilities at NRU HSE. RCD was supported in part by NIH/NIGMS R35GM128932. NDM was supported by the European Molecular Biology Laboratory.</p>
</ack>
<sec id="s6">
<label>7</label>
<title>Data availability statement</title>
<p>There is no data and reagent used in the paper. The code is available at the GitHub repository associated with this project <ext-link ext-link-type="uri" xlink:href="https://github.com/Genomics-HSE/VGsim">https://github.com/Genomics-HSE/VGsim</ext-link>.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="book"><string-name><surname>Brauer</surname>, <given-names>F.</given-names></string-name> (<year>2008</year>). <chapter-title>Compartmental models in epidemiology</chapter-title>. <source>In Mathematical epidemiology, pages</source> <fpage>19</fpage>&#x2013;<lpage>79</lpage>. <publisher-name>Springer</publisher-name>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Burioni</surname>, <given-names>R.</given-names></string-name> and <string-name><surname>Topol</surname>, <given-names>E. J.</given-names></string-name> (<year>2021</year>). <article-title>Assessing the human immune response to sars-cov-2 variants</article-title>. <source>Nature Medicine</source>, <volume>27</volume>(<issue>4</issue>):<fpage>571</fpage>&#x2013; <lpage>572</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="other"><string-name><surname>De Maio</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Weilguny</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Walker</surname>, <given-names>C. R.</given-names></string-name>, <string-name><surname>Turakhia</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Corbett-Detig</surname>, <given-names>R.</given-names></string-name>, and <string-name><surname>Goldman</surname>, <given-names>N.</given-names></string-name> (<year>2021</year>). <article-title>phastsim: efficient simulation of sequence evolution for pandemic-scale datasets</article-title>. <source>bioRxiv</source>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>De Maio</surname>, <given-names>N.</given-names></string-name> and <string-name><surname>Wilson</surname>, <given-names>D. J.</given-names></string-name> (<year>2017</year>). <article-title>The Bacterial Sequential Markov Coalescent</article-title>. <source>Genetics</source>, <volume>206</volume>(<issue>1</issue>):<fpage>333</fpage>&#x2013;<lpage>343</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Durbin</surname>, <given-names>R.</given-names></string-name> (<year>2014</year>). <article-title>Efficient haplotype matching and storage using the positional Burrows&#x2013;Wheeler transform (PBWT)</article-title>. <source>Bioinformatics</source>, <volume>30</volume>(<issue>9</issue>):<fpage>1266</fpage>&#x2013;<lpage>1272</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Ewing</surname>, <given-names>G.</given-names></string-name> and <string-name><surname>Hermisson</surname>, <given-names>J.</given-names></string-name> (<year>2010</year>). <article-title>MSMS: a coalescent simulation program including recombination, demographic structure and selection at a single locus</article-title>. <source>Bioinformatics</source>, <volume>26</volume>(<issue>16</issue>):<fpage>2064</fpage>&#x2013;<lpage>2065</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Fisher</surname>, <given-names>R. A.</given-names></string-name> and <string-name><surname>Russell</surname>, <given-names>E. J.</given-names></string-name> (<year>1922</year>). <article-title>On the mathematical foundations of theoretical statistics</article-title>. <source>Philosophical Transactions of the Royal Society of London. Series A, Containing Papers of a Mathematical or Physical Character</source>, <volume>222</volume>(<issue>594-604</issue>):<fpage>309</fpage>&#x2013;<lpage>368</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="other"><string-name><surname>Garcia-Beltran</surname>, <given-names>W. F.</given-names></string-name>, <string-name><surname>Lam</surname>, <given-names>E. C.</given-names></string-name>, <string-name><surname>St. Denis</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Nitido</surname>, <given-names>A. D.</given-names></string-name>, <string-name><surname>Garcia</surname>, <given-names>Z. H.</given-names></string-name>, <string-name><surname>Hauser</surname>, <given-names>B. M.</given-names></string-name>, <string-name><surname>Feldman</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Pavlovic</surname>, <given-names>M. N.</given-names></string-name>, <string-name><surname>Gregory</surname>, <given-names>D. J.</given-names></string-name>, <string-name><surname>Poznansky</surname>, <given-names>M. C.</given-names></string-name>, <string-name><surname>Sigal</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Schmidt</surname>, <given-names>A. G.</given-names></string-name>, <string-name><surname>Iafrate</surname>, <given-names>A. J.</given-names></string-name>, <string-name><surname>Naranbhai</surname>, <given-names>V.</given-names></string-name>, and <string-name><surname>Balazs</surname>, <given-names>A. B.</given-names></string-name> (<year>2021</year>). <article-title>Multiple sars-cov-2 variants escape neutralization by vaccine-induced humoral immunity</article-title>. <source>Cell</source>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Gillespie</surname>, <given-names>D. T.</given-names></string-name> (<year>2007</year>). <article-title>Stochastic simulation of chemical kinetics</article-title>. <source>Annual Review of Physical Chemistry</source>, <volume>58</volume>(<issue>1</issue>):<fpage>35</fpage>&#x2013;<lpage>55</lpage>. PMID: <pub-id pub-id-type="pmid">17037977</pub-id>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Gonzalez-Reiche</surname>, <given-names>A. S.</given-names></string-name>, <string-name><surname>Hernandez</surname>, <given-names>M. M.</given-names></string-name>, <string-name><surname>Sul-livan</surname>, <given-names>M. J.</given-names></string-name>, <string-name><surname>Ciferri</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Alshammary</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Obla</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Fabre</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Kleiner</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Polanco</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Khan</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Alburquerque</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>van de Guchte</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Dutta</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Fran-coeur</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Melo</surname>, <given-names>B. S.</given-names></string-name>, <string-name><surname>Oussenko</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Deikus</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Soto</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Sridhar</surname>, <given-names>S. H.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>Y.-C.</given-names></string-name>, <string-name><surname>Twyman</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Kasarskis</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Altman</surname>, <given-names>D. R.</given-names></string-name>, <string-name><surname>Smith</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Se-bra</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Aberg</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Krammer</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Garc&#x00ED;ia-Sastre</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Luksza</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Patel</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Paniz-Mondolfi</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Gitman</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Sordillo</surname>, <given-names>E. M.</given-names></string-name>, <string-name><surname>Simon</surname>, <given-names>V.</given-names></string-name>, and <string-name><surname>van Bakel</surname>, <given-names>H.</given-names></string-name> (<year>2020</year>). <article-title>Introductions and early spread of sars-cov-2 in the new york city area</article-title>. <source>Science</source>, <volume>369</volume>(<issue>6501</issue>):<fpage>297</fpage>&#x2013;<lpage>301</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Kelleher</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Etheridge</surname>, <given-names>A. M.</given-names></string-name>, and <string-name><surname>McVean</surname>, <given-names>G.</given-names></string-name> (<year>2016</year>). <article-title>Efficient coalescent simulation and genealogical analysis for large sample sizes</article-title>. <source>PLOS Computational Biology</source>, <volume>12</volume>(<issue>5</issue>):<fpage>1</fpage>&#x2013;<lpage>22</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Kelleher</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Wong</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Wohns</surname>, <given-names>A. W.</given-names></string-name>, <string-name><surname>Fadil</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Albers</surname>, <given-names>P. K.</given-names></string-name>, and <string-name><surname>McVean</surname>, <given-names>G.</given-names></string-name> (<year>2019</year>). <article-title>Inferring whole-genome histories in large population datasets</article-title>. <source>Nature Genetics</source>, <volume>51</volume>(<issue>9</issue>):<fpage>1330</fpage>&#x2013;<lpage>1338</lpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Kermack William Ogilvy</surname>, <given-names>M. A. G.</given-names></string-name> and <string-name><surname>Thomas</surname>, <given-names>W. G.</given-names></string-name> (<year>1927</year>). <article-title>Thomas a contribution to the mathe-matical theory of epidemics</article-title>. <source>Proceedings of Royal Society A</source>, <volume>115</volume>:<fpage>700</fpage> &#x2013; <lpage>721</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><surname>Kern</surname>, <given-names>A. D.</given-names></string-name> and <string-name><surname>Schrider</surname>, <given-names>D. R.</given-names></string-name> (<year>2016</year>). <article-title>Discoal: flexible coalescent simulations with selection</article-title>. <source>Bioinformatics</source>, <volume>32</volume>(<issue>24</issue>):<fpage>3839</fpage>&#x2013; <lpage>3841</lpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Kingman</surname>, <given-names>J. F. C.</given-names></string-name> (<year>1982</year>). <article-title>On the genealogy of large populations</article-title>. <source>Journal of Applied Probability</source>, <volume>19</volume>(A):<fpage>27</fpage>&#x2013;<lpage>43</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Komissarov</surname>, <given-names>A. B.</given-names></string-name>, <string-name><surname>Safina</surname>, <given-names>K. R.</given-names></string-name>, <string-name><surname>Garushyants</surname>, <given-names>S. K.</given-names></string-name>, <string-name><surname>Fadeev</surname>, <given-names>A. V.</given-names></string-name>, <string-name><surname>Sergeeva</surname>, <given-names>M. V.</given-names></string-name>, <string-name><surname>Ivanova</surname>, <given-names>A. A.</given-names></string-name>, <string-name><surname>Danilenko</surname>, <given-names>D. M.</given-names></string-name>, <string-name><surname>Lioznov</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Shneider</surname>, <given-names>O. V.</given-names></string-name>, <string-name><surname>Shvyrev</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Spirin</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Glyzin</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Shchur</surname>, <given-names>V.</given-names></string-name>, and <string-name><surname>Bazykin</surname>, <given-names>G. A.</given-names></string-name> (<year>2021</year>). <article-title>Genomic epidemiology of the early stages of the sars-cov-2 outbreak in russia</article-title>. <source>Nature Communications</source>, <volume>12</volume>(<issue>1</issue>):<fpage>649</fpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Kryazhimskiy</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Dushoff</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Bazykin</surname>, <given-names>G. A.</given-names></string-name>, and <string-name><surname>Plotkin</surname>, <given-names>J. B.</given-names></string-name> (<year>2011</year>). <article-title>Prevalence of epistasis in the evolution of influenza a surface proteins</article-title>. <source>PLOS Genetics</source>, <volume>7</volume>(<issue>2</issue>):<fpage>1</fpage>&#x2013;<lpage>11</lpage>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Ladner</surname>, <given-names>J. T.</given-names></string-name>, <string-name><surname>Larsen</surname>, <given-names>B. B.</given-names></string-name>, <string-name><surname>Bowers</surname>, <given-names>J. R.</given-names></string-name>, <string-name><surname>Hepp</surname>, <given-names>C. M.</given-names></string-name>, <string-name><surname>Bolyen</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Folkerts</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Sheridan</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Pfeiffer</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Yaglom</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Lemmer</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Sahl</surname>, <given-names>J. W.</given-names></string-name>, <string-name><surname>Kaelin</surname>, <given-names>E. A.</given-names></string-name>, <string-name><surname>Maqsood</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Bokulich</surname>, <given-names>N. A.</given-names></string-name>, <string-name><surname>Quirk</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Watts</surname>, <given-names>T. D.</given-names></string-name>, <string-name><surname>Komatsu</surname>, <given-names>K. K.</given-names></string-name>, <string-name><surname>Waddell</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Lim</surname>, <given-names>E. S.</given-names></string-name>, <string-name><surname>Caporaso</surname>, <given-names>J. G.</given-names></string-name>, <string-name><surname>Engelthaler</surname>, <given-names>D. M.</given-names></string-name>, <string-name><surname>Worobey</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Keim</surname>, <given-names>P.</given-names></string-name> (<year>2020</year>). <article-title>An early pandemic analysis of sars-cov-2 population structure and dynamics in arizona</article-title>. <source>mBio</source>, <volume>11</volume>(<issue>5</issue>).</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Lambert</surname>, <given-names>A.</given-names></string-name> and <string-name><surname>Stadler</surname>, <given-names>T.</given-names></string-name> (<year>2013</year>). <article-title>Birth&#x2013;death models and coalescent point processes: The shape and probability of reconstructed phylogenies</article-title>. <source>Theoretical Population Biology</source>, <volume>90</volume>:<fpage>113</fpage>&#x2013;<lpage>128</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Li</surname>, <given-names>N.</given-names></string-name> and <string-name><surname>Stephens</surname>, <given-names>M.</given-names></string-name> (<year>2003</year>). <article-title>Modeling linkage disequilibrium and identifying recombination hotspots using single-nucleotide polymorphism data</article-title>. <source>Genetics</source>, <volume>165</volume>(<issue>4</issue>):<fpage>2213</fpage>&#x2013;<lpage>2233</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="other"><string-name><surname>Lycett</surname>, <given-names>S. J.</given-names></string-name>, <string-name><surname>Hughes</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>McHugh</surname>, <given-names>M. P.</given-names></string-name>, <string-name><surname>da Silva Filipe</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Dewar</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Lu</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Doherty</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Shepherd</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Inward</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Rossi</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Balaz</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Kao</surname>, <given-names>R. R.</given-names></string-name>, <string-name><surname>Rooke</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Cotton</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Gallagher</surname>, <given-names>M. D.</given-names></string-name>, <string-name><surname>Lopez</surname>, <given-names>C. B.</given-names></string-name>, <string-name><surname>O&#x2019;Toole</surname>, <given-names>A&#x2019;
s.</given-names></string-name>, <string-name><surname>Scher</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Hill</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>McCrone</surname>, <given-names>J. T.</given-names></string-name>, <string-name><surname>Colquhoun</surname>, <given-names>R. M.</given-names></string-name>, <string-name><surname>Jackson</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Williams</surname>, <given-names>T. C.</given-names></string-name>, <string-name><surname>Williamson</surname>, <given-names>K. A.</given-names></string-name>, <string-name><surname>Johnson</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Smollett</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Mair</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Carmichael</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Tong</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Nichols</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Brunker</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Shepherd</surname>, <given-names>J. G.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Aranday-Cortes</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Parr</surname>, <given-names>Y. A.</given-names></string-name>, <string-name><surname>Broos</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Nomikou</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>McDonald</surname>, <given-names>S. E.</given-names></string-name>, <string-name><surname>Niebel</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Asamaphan</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Starinskij</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Jesudason</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Shah</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Sreenu</surname>, <given-names>V. B.</given-names></string-name>, <string-name><surname>Stanton</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Shaaban</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>MacLean</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Woolhouse</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Gunson</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Templeton</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Thomson</surname>, <given-names>E. C.</given-names></string-name>, <string-name><surname>Rambaut</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Holden</surname>, <given-names>M. T.</given-names></string-name>, and <string-name><surname>Robertson</surname>, <given-names>D. L.</given-names></string-name> (<year>2021</year>). <article-title>Epidemic waves of covid-19 in scotland: a genomic perspective on the impact of the introduction and relaxation of lockdown on sars-cov-2</article-title>. <source>medRxiv</source>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="other"><string-name><surname>McBroome</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Thornlow</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Hinrichs</surname>, <given-names>A. S.</given-names></string-name>, <string-name><surname>De Maio</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Goldman</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Haussler</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Corbett-Detig</surname>, <given-names>R.</given-names></string-name>, and <string-name><surname>Turakhia</surname>, <given-names>Y.</given-names></string-name> (<year>2021</year>). <article-title>matutils: Tools to interpret and manipulate mutation annotated trees</article-title>. <source>bioRxiv</source>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Nadeau</surname>, <given-names>S. A.</given-names></string-name>, <string-name><surname>Vaughan</surname>, <given-names>T. G.</given-names></string-name>, <string-name><surname>Scire</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Huisman</surname>, <given-names>J. S.</given-names></string-name>, and <string-name><surname>Stadler</surname>, <given-names>T.</given-names></string-name> (<year>2021</year>). <article-title>The origin and early spread of sars-cov-2 in europe</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>118</volume>(<issue>9</issue>).</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="other"><string-name><surname>Rochman</surname>, <given-names>N. D.</given-names></string-name>, <string-name><surname>Wolf</surname>, <given-names>Y. I.</given-names></string-name>, <string-name><surname>Faure</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Mutz</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Zhang</surname>, <given-names>F.</given-names></string-name>, and <string-name><surname>Koonin</surname>, <given-names>E. V.</given-names></string-name> (<year>2021</year>). <article-title>Ongoing global and regional adaptive evolution of sars-cov-2</article-title>. <source>bioRxiv</source>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Sanju&#x00E1;n</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Moya</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Elena</surname>, <given-names>S. F.</given-names></string-name> (<year>2004</year>). <article-title>The contribution of epistasis to the architecture of fitness in an rna virus</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>101</volume>(<issue>43</issue>):<fpage>15376</fpage>&#x2013;<lpage>15379</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="other"><string-name><surname>Shchur</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Ziganurova</surname>, <given-names>L.</given-names></string-name>, and <string-name><surname>Durbin</surname>, <given-names>R.</given-names></string-name> (<year>2019</year>). <article-title>Fast and scalable genome-wide inference of local tree topologies from large number of haplotypes based on tree consistent pbwt data structure</article-title>. <source>bioRxiv</source>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Stadler</surname>, <given-names>T.</given-names></string-name> (<year>2009</year>). <article-title>On incomplete sampling under birth&#x2013;death models and connections to the sampling-based coalescent</article-title>. <source>Journal of Theoretical Biology</source>, <volume>261</volume>(<issue>1</issue>):<fpage>58</fpage>&#x2013;<lpage>66</lpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Stadler</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>K&#x00FC;hnert</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Bonhoeffer</surname>, <given-names>S.</given-names></string-name>, and <string-name><surname>Drummond</surname>, <given-names>A. J.</given-names></string-name> (<year>2013</year>). <article-title>Birth&#x2013;death skyline plot reveals temporal changes of epidemic spread in hiv and hepatitis c virus (hcv)</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>110</volume>(<issue>1</issue>):<fpage>228</fpage>&#x2013;<lpage>233</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="other"><string-name><surname>Tegally</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Wilkinson</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Lessells</surname>, <given-names>R. R.</given-names></string-name>, <string-name><surname>Giandhari</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Pillay</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Msomi</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Mlisana</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Bhiman</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Allam</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Ismail</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Engelbrecht</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Van Zyl</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Preiser</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Williamson</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Pettruccione</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Sigal</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Gazy</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Hardie</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Hsiao</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Martin</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>York</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Goedhals</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>San</surname>, <given-names>E. J.</given-names></string-name>, <string-name><surname>Giovanetti</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Lourenco</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Alcantara</surname>, <given-names>L. C. J.</given-names></string-name>, and <string-name><surname>de Oliveira</surname>, <given-names>T.</given-names></string-name> (<year>2020</year>). <article-title>Major new lineages of sars-cov-2 emerge and spread in south africa during lockdown</article-title>. <source>medRxiv</source>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="other"><string-name><surname>Turakhia</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Thornlow</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Hinrichs</surname>, <given-names>A. S.</given-names></string-name>, <string-name><surname>De Maio</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Gozashti</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Lanfear</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Haussler</surname>, <given-names>D.</given-names></string-name>, and <string-name><surname>Corbett-Detig</surname>, <given-names>R.</given-names></string-name> (<year>2020</year>). <article-title>Ultrafast sample placement on existing trees (usher) empowers real-time phylogenetics for the sars-cov-2 pandemic</article-title>. <source>bioRxiv</source>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Wright</surname>, <given-names>S.</given-names></string-name> (<year>1931</year>). <article-title>Evolution in mendelian populations</article-title>. <source>Genetics</source>, <volume>16</volume>(<issue>2</issue>):<fpage>97</fpage>&#x2013;<lpage>159</lpage>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Wright</surname>, <given-names>S.</given-names></string-name> (<year>1940</year>). <article-title>Breeding structure of populations in relation to speciation</article-title>. <source>The American Naturalist</source>, <volume>74</volume>(<issue>752</issue>):<fpage>232</fpage>&#x2013;<lpage>248</lpage>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><surname>Zeng</surname>, <given-names>H.-L.</given-names></string-name>, <string-name><surname>Dichio</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Rodr&#x00ED;guez Horta</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Thorell</surname>, <given-names>K.</given-names></string-name>, and <string-name><surname>Aurell</surname>, <given-names>E.</given-names></string-name> (<year>2020</year>). <article-title>Global analysis of more than 50,000 sars-cov-2 genomes reveals epistasis between eight viral genes</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>117</volume>(<issue>49</issue>):<fpage>31519</fpage>&#x2013;<lpage>31526</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>