<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">MEDRXIV</journal-id>
<journal-title-group>
<journal-title>medRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">medRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/2021.10.08.21264756</article-id>
<article-version>1.2</article-version>
<article-categories>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Public and Global Health</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>ToxPi&#x002A;GIS Toolkit: Creating, viewing, and sharing integrative visualizations for geospatial data using ArcGIS</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Fleming</surname><given-names>Jonathon</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Marvel</surname><given-names>Skylar W.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Motsinger-Reif</surname><given-names>Alison A.</given-names></name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7815-6767</contrib-id>
<name><surname>Reif</surname><given-names>David M.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Bioinformatics Research Center, Department of Biological Sciences, North Carolina State University</institution></aff>
<aff id="a2"><label>2</label><institution>Biostatistics and Computational Biology Branch, National Institute of Environmental Health Sciences, National Institutes of Health</institution></aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Corresponding Author Email: <email>dmreif@ncsu.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2021</year>
</pub-date>
<elocation-id>2021.10.08.21264756</elocation-id>
<history>
<date date-type="received">
<day>08</day>
<month>10</month>
<year>2021</year>
</date>
<date date-type="rev-recd">
<day>12</day>
<month>10</month>
<year>2021</year>
</date>
<date date-type="accepted">
<day>12</day>
<month>10</month>
<year>2021</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2021, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2021</copyright-year>
<license license-type="creative-commons" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/"><license-p>This article is a US Government work. It is not subject to copyright under 17 USC 105 and is also made available for use under a CC0 license</license-p></license>
</permissions>
<self-uri xlink:href="21264756.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<sec>
<title>Background</title>
<p>Presenting a comprehensive picture of geographic data comprising multiple factors is an inherently integrative undertaking. Visualizing such data in an interactive form is essential for public sharing and geographic information systems (GIS) analysis. The Toxicological Prioritization Index (ToxPi) framework has been used as an integrative model layered atop geospatial data, and its deployment within the dynamic ArcGIS universe would open up powerful new avenues for sophisticated, interactive GIS analysis.</p>
</sec>
<sec>
<title>Objective</title>
<p>We propose an actively developed suite of software, the ToxPi&#x002A;GIS Toolkit, for creating, viewing, sharing, and analyzing interactive ToxPi figures in ArcGIS.</p>
</sec>
<sec>
<title>Methods</title>
<p>The ToxPi&#x002A;GIS Toolkit is a collection of methods for creating interactive feature layers that contain ToxPi diagrams. It currently includes an ArcGIS Toolbox (<italic>ToxPiToolbox</italic>.<italic>tbx</italic>) for drawing geographically located ToxPi diagrams onto a feature layer, a collection of modular Python scripts that create predesigned layer files containing ToxPi feature layers from the command line, and a collection of Python routines for useful data manipulation and preprocessing. We present workflows documenting ToxPi feature layer creation, sharing, and embedding for both novice and advanced users looking for additional customizability.</p>
</sec>
<sec>
<title>Results</title>
<p>Map visualizations created with the ToxPi&#x002A;GIS Toolkit can be made freely available on public URLs, allowing users without ArcGIS Pro access or expertise to view and interact with them. Novice users with ArcGIS Pro access can create <italic>de novo</italic> custom maps, and advanced users can exploit additional customization options. The ArcGIS Toolbox provides a simple means for generating ToxPi feature layers. We illustrate its usage with current COVID-19 data to compare drivers of pandemic vulnerability in counties across the United States.</p>
</sec>
<sec>
<title>Significance</title>
<p>Development of new features, which will advance the interests of the scientific community in many fields, is ongoing for the ToxPi&#x002A;GIS Toolkit, which can be accessed from <ext-link ext-link-type="uri" xlink:href="http://www.toxpi.org">www.toxpi.org</ext-link>.</p>
</sec>
<sec>
<title>Impact Statement</title>
<p>Presenting a comprehensive picture of geographic data comprising multiple factors is an inherently integrative undertaking. Visualizing this data in an interactive form is essential for public sharing and geographic analysis. The ToxPi framework provides such integration, and ArcGIS offers interactive geographic mapping capability, but, so far, producing ToxPi figures in ArcGIS maps has not been possible. We propose the ToxPi&#x002A;ArcGIS Toolkit, which enables the generation of ArcGIS feature layers that include interactive ToxPi figures. Further, we document the living code repository created for this method and outline workflows for sharing, creating, and embedding maps within a web dashboard.</p>
</sec>
<sec>
<title>Availability and Implementation</title>
<p>All applications, usage instructions, sample data, example visualizations, and open-source code are freely available from a dedicated GitHub page linked from <ext-link ext-link-type="uri" xlink:href="http://www.toxpi.org">www.toxpi.org</ext-link>. ArcGIS Pro can be obtained at <ext-link ext-link-type="uri" xlink:href="https://www.esri.com/en-us/arcgis/products/arcgis-pro/overview">https://www.esri.com/en-us/arcgis/products/arcgis-pro/overview</ext-link>.</p>
</sec>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>Visual Analytics</kwd>
<kwd>Geographic Information Systems</kwd>
<kwd>Data Integration</kwd>
</kwd-group>
<counts>
<page-count count="25"/>
</counts>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<notes notes-type="financial-disclosure">
<title>Funding Statement</title><p>This research was supported by the National Institutes of Health (NIH) grant awards ES030007 and ES025128, and by intramural funds from the National Institute of Environmental Health Sciences and the National Institute for Allergy and Infectious Diseases.</p></notes>
<notes notes-type="disclosures">
<title>Author Declarations</title><p>I confirm all relevant ethical guidelines have been followed, and any necessary IRB and/or ethics committee approvals have been obtained.</p><p>Yes</p><p>I confirm that all necessary patient/participant consent has been obtained and the appropriate institutional forms have been archived, and that any patient/participant/sample identifiers included were not known to anyone (e.g., hospital staff, patients or participants themselves) outside the research group so cannot be used to identify individuals.</p><p>Yes</p><p>I understand that all clinical trials and any other prospective interventional studies must be registered with an ICMJE-approved registry, such as ClinicalTrials.gov. I confirm that any such study reported in the manuscript has been registered and the trial registration ID is provided (note: if posting a prospective study registered retrospectively, please provide a statement in the trial ID field explaining why the study was not registered in advance).</p><p>Yes</p><p>I have followed all appropriate research reporting guidelines and uploaded the relevant EQUATOR Network research reporting checklist(s) and other pertinent material as supplementary files, if applicable.</p><p>Yes</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Fixed a typo in the main body text that referred to Figure 3 instead of the intended Figure 4.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Geographic data are used to support decisions and inform analysis at many scales, from neighborhoods and larger communities to states and nations. Combined with sophisticated GIS tools, these data can be a powerful means of communicating issues affecting communities and their drivers and can act as a catalyst for change. Because of the complexity of places and their underlying environments, data from a single source is often insufficient for accurately communicating a geographical area&#x2019;s issues and the drivers of problems such as health disparities. To remedy this, summary quantitative layers, or scores, can be created by aggregating multiple data sources. While these layers or scores convey the combined effect of numerous factors on a population, there is typically no mechanism to account for the contributions of individual factors to the overall score. For a truly comprehensive picture of geographic data comprising multiple factors, visual analytics are needed that present both integrated scores and the contributions of the distinct factors driving these scores.</p>
<p>One such integrative visual analytic is the Toxicological Prioritization Index (ToxPi) framework, which displays results as radar charts composed of &#x201C;slices&#x201D; (ref. <xref rid="c1" ref-type="bibr">1</xref>). The flexible ToxPi framework accepts continuous and ordinal data for integration as sets of related, user-defined factors into slice-wise and overall scores (see <xref rid="fig1" ref-type="fig">Figure 1</xref>). The framework is integrated into the ToxPi GUI, a Java application with an easy-to-use graphical interface for analyzing and visualizing diverse data into ToxPi profiles (<ext-link ext-link-type="uri" xlink:href="http://www.toxpi.org">www.toxpi.org</ext-link>) (ref. <xref rid="c2" ref-type="bibr">2</xref>).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><p>(Top) Overview of the ToxPi framework for COVID-19 vulnerability in the new &#x2018;PVI with Vaccine Model&#x2019; with four domains (color families) and 14 subdomains (slices) and vaccine data. (Bottom) Schematic of the ToxPi&#x002A;GIS Toolkit workflow Methods 1 and 2, from raw data to map sharing.</p></caption>
<graphic xlink:href="21264756v2_fig1.tif"/>
</fig>
<p>The ToxPi framework provides an integrative model layer atop geospatial data, for a compact summary of the factors driving differences in analysis results among regions. It has been deployed within custom-built dashboards created to assess vulnerability to COVID-19 at the county level across the United States (ref. <xref rid="c3" ref-type="bibr">3</xref>), to compare hurricane susceptibility at the census-tract level in the greater Houston area (ref. <xref rid="c4" ref-type="bibr">4</xref>), and to visualize the interplay of stressors related to children&#x2019;s environmental health across North Carolina (ref. <xref rid="c5" ref-type="bibr">5</xref>). The ToxPi&#x002A;GIS web application can also be used in tandem with ArcGIS tools/dashboards for parallel analysis (ref. <xref rid="c6" ref-type="bibr">6</xref>). These applications demonstrate the utility of graphics that integrate geographic and multivariate data for addressing the disparate effects of various drivers on vulnerability and susceptibility in different locations.</p>
<p>ArcGIS Pro provides advanced capabilities for geospatial data analysis and map production, and ArcGIS Online is a user-friendly interface that can be used to share these maps. Despite these advantages, so far, there has been no tool for integrating interactive ToxPi figures within an ArcGIS map. To solve this issue, we developed an ArcGIS Pro Toolbox that draws location-based ToxPi figures as feature layers for placement on an ArcGIS map. The use of ArcGIS tools often requires preliminary data manipulation and several sequential, often complicated geoprocessing steps for feature layer preparation, making map creation a daunting task for inexperienced ArcGIS users. To simplify map creation, we developed a custom Python script, <italic>ToxPi_creation</italic>.<italic>py</italic>, that handles all data preparation, generates a layer file containing the drawn ToxPi figures, and displays the layer based on the user&#x2019;s choices in the ToxPi GUI. We combined the toolbox and the Python script to create the ToxPi&#x002A;GIS Toolkit, a continuously developed repository of software for integrating ToxPi statistics and the results of geospatial analysis.</p>
<p>The applications are detailed for those without ArcGIS Pro access, novice users with ArcGIS Pro access but limited expertise, and advanced users looking to create customized, integrated ArcGIS workflows and distributable dashboards. Novice users of ArcGIS Pro can generate shareable maps with limited knowledge of the software, and advanced users can use the Toolkit to generate ToxPi feature layers with options for customization, integration, and distribution. Created maps can be made freely available on public URLs so that ArcGIS Pro access is not required to view and interact with them. Here, we illustrate applications of the ToxPi&#x002A;GIS Toolkit using publicly available COVID-19 data to compare the pandemic vulnerability of counties across the United States. All applications, usage instructions, sample data, example visualizations, and open-source code are freely available from a dedicated GitHub page linked on <ext-link ext-link-type="uri" xlink:href="http://www.toxpi.org">www.toxpi.org</ext-link>.</p>
</sec>
<sec id="s2">
<title>Methods</title>
<p>The ToxPi&#x002A;GIS Toolkit is an addendum of methods to be used alongside ToxPi GUI, a free, platform-independent Java application for recombining diverse source data into ToxPi profiles (<ext-link ext-link-type="uri" xlink:href="http://www.toxpi.org">www.toxpi.org</ext-link>). The toolbox methods proposed in this paper can be used to produce interactive feature layers containing ToxPi diagrams for map creation and visualization.</p>
<sec id="s2a">
<title>Toxicological Priority Index (ToxPi)</title>
<p>The ToxPi framework provides a method for transparently integrating and visualizing data across disparate information domains and is often used to determine risk values for the data being analyzed. Data that are not normally compared are combined into a data matrix comprising various data domains, or slice categories, with varying weights that represent the different data categories. Each slice category, represented by a color scheme, can then be separated into subdomains. The data matrix is then analyzed to produce a score ranging from 0 to 1 for each slice that represents a data record&#x2019;s (e.g. a single county) score (e.g. vulnerability to COVID-19 driven by this subset of factors). The slices are then combined into a normalized overall score that represents the record&#x2019;s total risk from all slices (i.e. the entire ToxPi profile for a county). These scores are displayed in a ToxPi diagram (shown at the top of <italic><xref rid="fig1" ref-type="fig">Figure 1</xref></italic>) for each record. Although these visualizations allow the easy comparison of records, when integrated with geospatial data, a large number of figures, which cannot be quickly compared, is generated. Further, these figures do not geographically represent the source of the data or indicate what underlying data was used to generate each slice.</p>
</sec>
<sec id="s2b">
<title>ToxPi&#x002A;GIS Toolkit</title>
<p>The ToxPi&#x002A;GIS Toolkit uses custom Python scripts combined with ArcGIS Pro methods and a custom ArcGIS Pro Toolbox to generate feature layers that contain ToxPi figures drawn at the location where each record was obtained, enabling the geospatial comparison of records. These feature layers can be loaded onto a new map or one with existing data, enabling new comparisons. Furthermore, each slice is drawn as a separate polygon, which allows users to select an individual slice to obtain more information about the feature it represents. These details are displayed in popups that can be easily reconfigured to display important, underlying data used in the analysis. The ToxPi&#x002A;GIS Toolkit currently includes two suggested methods for generating these feature layers, which are described below. The pipelines for the use cases are outlined at the bottom of <italic><xref rid="fig1" ref-type="fig">Figure 1</xref></italic>.</p>
</sec>
<sec id="s2c">
<title>Method 1- Creation of ToxPi feature layers using Python scripts</title>
<p>Method 1 consists of a Python script, <italic>ToxPi_creation</italic>.<italic>py</italic>, that can be run from the Windows command prompt. The output of ToxPi GUI is used as input to produce ToxPi feature layers. The script automates all geoprocessing and data manipulation steps required for ToxPi feature layer production and has only two required parameters&#x2014;the location of the input data file and the location for the script output. Furthermore, it provides an option to scale the size of ToxPi figures so users can make adjustments based on their data&#x2019;s scope and density.</p>
<p>The simplicity of this method allows users of all experience levels to quickly and easily produce feature layers that are ready to be shared as a map. These feature layers are saved to a layer file (.lyrx) that can be opened with ArcGIS Pro and shared to ArcGIS Online for public viewing. Users can create a shareable map by opening an output layer file in ArcGIS Pro and selecting the option to publicly share it to ArcGIS Online, allowing anyone with the URL to view and interact with the map. A map owner can also allow users to copy and further analyze the map and its underlying data to produce new, interactive visualizations.</p>
<p>This method is suggested for users who are unfamiliar with ArcGIS Pro as well as those who do not require significant customization and want to bypass manual data and feature class preparation. The script&#x2019;s input-data formatting requirements are outlined in the Toolkit documentation, and an evolving Utilities folder contains information that can help with these requirements.</p>
</sec>
<sec id="s2d">
<title>Method 2- Creation of ToxPi feature layers using an ArcGIS Toolbox</title>
<p>Method 2 consists of an ArcGIS Pro Toolbox, <italic>ToxPiToolbox</italic>.<italic>tbx</italic>. This method outputs a feature layer that can be integrated into other analysis pipelines and shared to ArcGIS Online for public viewing. While the method allows more customization of feature layers than the Python script, including the ability to draw a subset of slices and use different coordinate systems, it requires more data preparation. The Toolkit documentation contains an example walkthrough of the steps for data preparation and the creation of ToxPi feature layers. While experienced ArcGIS Pro users can easily customize some layers during preparation, including associating more underlying data with each ToxPi figure, several steps are compulsory for preparing toolbox input data.</p>
<p>Notably, feature classes or layers prepared for the tool must be converted into a projected coordinate system prior to input. <italic><xref rid="fig2" ref-type="fig">Figure 2</xref></italic> describes the interface for the toolbox and describes each parameter. <italic><xref rid="fig3" ref-type="fig">Figure 3</xref></italic> provides an example map of local vulnerability to COVID-19 produced by running the python script or toolbox with COVID-19 data.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><p>Interface for ToxPi construction using the ToxPi Toolbox. Parameters: inFeatures&#x2013;the name of the input feature layer; outFeatures&#x2013;the name of the output feature class; uniqueID&#x2013;the unique identifier for each data point; inFields&#x2013;a list of the slices to be included in the ToxPi figures; inputWeights&#x2013;a string of weights that correspond to the list of fields for determining radial width; inputRadius&#x2013;optional value to scale ToxPi size; outFeaturesRings&#x2013;optional name of the maximum radius rings feature layer</p></caption>
<graphic xlink:href="21264756v2_fig2.tif"/>
</fig>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><p>Output of <italic>ToxPi_creation</italic>.<italic>py</italic> for COVID-19 vulnerability data zoomed in on a section of North Carolina</p></caption>
<graphic xlink:href="21264756v2_fig3.tif"/>
</fig>
</sec>
<sec id="s2e">
<title>Advancement and versatility of ToxPi_creation.py</title>
<p>To demonstrate the versatility of the ToxPi&#x002A;GIS Toolkit and the customization capacity provided by ArcGIS, we added advanced geoprocessing steps and analysis for use with county- or census-tract-level data to the <italic>ToxPi_creation</italic>.<italic>py</italic> script for Method 1. The resulting script, <italic>ToxPi_creation_customized</italic>.<italic>py</italic>, can be run with the same workflow as Method 1 but produces more advanced maps for a specific geographic data type. This method generates extra layers for visualization, including two separately-sized layers of ToxPi features to account for areas of different geographic boundaries, from local to state to regional. These include a local choropleth layer representing the ToxPi score, a state-level ToxPi layer containing the state medians as ToxPi features, and a state-level choropleth layer representing the ToxPi score. <italic><xref rid="fig4" ref-type="fig">Figure 4</xref></italic> contains static images of a map at different zoom extents that was produced by running the altered script with COVID-19 vulnerability data, thus showing the multilayer capability of the altered script and demonstrating the integration of ToxPi_creation.py with other advanced geoprocessing steps.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><p>Output of <italic>ToxPi_creation_customized</italic>.<italic>py</italic> with COVID-19 vulnerability data showing the switching of feature layers based on zoom extent. The top left (zoomed out) is a state median feature layer, the middle (zoomed in) is a local ToxPi feature layer, and the bottom right (zoomed in further) is a local ToxPi feature layer that accounts for overlap in high-density areas. A popup with important information appears when selecting a ToxPi feature.</p></caption>
<graphic xlink:href="21264756v2_fig4.tif"/>
</fig>
</sec>
<sec id="s2f">
<title>Data collection</title>
<p>We obtained data for the COVID-19 vulnerability map from the Pandemic Vulnerability Index (PVI) Dashboard at <ext-link ext-link-type="uri" xlink:href="https://covid19pvi.niehs.nih.gov/">https://covid19pvi.niehs.nih.gov/</ext-link>. While the PVI Dashboard was introduced prior to the availability of vaccines, it now contains a new model that includes slices representing vaccination data available starting January 2021, so we focused on data since that time. In this model, risk components are split into four domains&#x2014;infection rate, population concentration, intervention measures, and health and environment&#x2014;that comprise 14 categories. <italic><xref rid="fig1" ref-type="fig">Figure 1</xref></italic> shows each category&#x2019;s corresponding weight. This model accounts for vaccine data in the intervention measures domain, allowing for a more accurate representation of COVID-19 risk than previous models. More information about the model, including the underlying components for each slice category, can be found at the National Institutes of Health (NIH) Pandemic Vulnerability Index (PVI) Dashboard details page (<ext-link ext-link-type="uri" xlink:href="https://www.niehs.nih.gov/research/programs/coronavirus/covid19pvi/details/">https://www.niehs.nih.gov/research/programs/coronavirus/covid19pvi/details/</ext-link>). We used these data to demonstrate the extended capabilities of the ToxPi&#x002A;GIS Toolkit, including its integration with powerful analysis methods available in ArcGIS and the visualization capabilities of ArcGIS Online.</p>
</sec>
<sec id="s2g">
<title>New advanced analysis options provided by ArcGIS Pro</title>
<p>To demonstrate the powerful statistical analysis methods ArcGIS Pro provides, we performed hotspot analysis using ToxPi scores and county-level results from the COVID-19 vulnerability model created with <italic>ToxPi_creation_customized</italic>.<italic>py</italic>. We conducted the hotspot analysis in ArcGIS Pro using the Optimized Hotspot Analysis tool with a distance band of 50 miles. Given incident points or weighted features (points or polygons), this tool creates a map of statistically significant hotspots and coldspots using the Getis-Ord Gi&#x002A; statistic and evaluates the characteristics of the input feature class to produce optimal results. The tool creates a confidence-level bin with a corresponding z-score and p-value for each feature within the input feature class (ref. <xref rid="c7" ref-type="bibr">7</xref>). In this case, each county was placed into a Gi_Bin based on the confidence level that it was clustered in a hotspot or coldspot according to the ToxPi score. By default, seven bins were generated, &#x002B;/-3, &#x002B;/-2, &#x002B;/-1, and 0, where &#x002B; denotes a hotspot, - demotes a cold spot, 3 denotes a 99&#x0025; confidence interval, 2 denotes a 95&#x0025; confidence interval, 1 denotes a 90&#x0025; confidence interval, and 0 denotes no statistical significance.</p>
<p>The result is a choropleth layer of counties that can easily be used to determine clusters of high and low risk for COVID-19, as shown in <italic><xref rid="fig5" ref-type="fig">Figure 5</xref></italic>. Zooming in on this layer displays the ToxPi figures, which can be used as a visual reference for further analysis of the factors causing these clusters. Although the analysis was conducted using the overall ToxPi score, it could easily be repeated using a specific slice to allow for more specific statistical analysis of how individual factors compare across a geographic region. To demonstrate some of the powerful hosting and visualization capabilities ArcGIS provides, we joined the hotspot analysis results with raw data and displayed the result in an ArcGIS dashboard for public viewing.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><p>Hotspot analysis provided by ArcGIS integrated with the ToxPi&#x002A;GIS Toolkit. A national view of hotspots and coldspots is shown, where color represents high-risk (hotspot) and low-risk (coldspot) areas. The two insets show ToxPi images for example coldspot (blue) and hotspot (red) counties with a 99&#x0025; confidence level, providing an easy means of visually comparing the areas based on slice scores.</p></caption>
<graphic xlink:href="21264756v2_fig5.tif"/>
</fig>
</sec>
</sec>
<sec id="s3">
<title>Results</title>
<p>All interactive maps and visualizations are linked from <ext-link ext-link-type="uri" xlink:href="http://www.toxpi.org">www.toxpi.org</ext-link> to the dedicated Github page. <italic><xref rid="fig3" ref-type="fig">Figure 3</xref></italic> is a static image, zoomed in on a portion of North Carolina, of the model created with COVID-19 data using <italic>ToxPi_creation</italic>.<italic>py</italic>. This method results in an interactive feature layer of ToxPi figures that visually matches the results of <italic>ToxPiToolbox</italic>.<italic>tbx</italic>. However, minor visualization differences are described in the Toolkit documentation.</p>
<p><italic><xref rid="fig4" ref-type="fig">Figure 4</xref></italic> is a static image of the result of the model created by <italic>ToxPi_creation_customized</italic>.<italic>py</italic> with COVID-19 data. The figure shows local to regional to state displays that aggregate data by user-selected zoom extent. Because of the interactive nature of these diagrams, users can select individual slices to learn more about the risk factors they represent, enabling quick analysis of the factors driving COVID-19 risk at different geographic scales of interest.</p>
<p><italic><xref rid="fig5" ref-type="fig">Figure 5</xref></italic> is a static image of hotspot analysis results and shows that cold spots are primarily clustered in Nebraska and the edges of South Dakota and Kansas. Hotspots are primarily clustered in Missouri, the border of Texas, Arkansas, Georgia, and Tennessee. The zoomed-in views show the ToxPi feature layer for an example hotspot and a coldspot, allowing direct visual comparison of the different factors affecting the regions. The ToxPi radar charts clearly show that transmissible cases, disease spread, residential density, social distancing, population demographics, and health disparities are highly different between the hotspot and coldspot.</p>
<p><italic><xref rid="fig6" ref-type="fig">Figure 6</xref></italic> is a static image of hotspot analysis results displayed on a publicly viewable dashboard. Important statistics can be easily retrieved for a county of interest. The flexible customization of this powerful visualization technique enables users to tell a story about a location based on a dataset. The figure shows COVID-19 statistics, including cases, deaths, sickness scores, and disease spread rate for Greene County, Missouri, a major hotspot.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
<caption><p>Example dashboard created by joining the hotspot analysis results with the raw data in an ArcGIS Online Dashboard and configuring panels to show important statistics for each county. By selecting a county, users can see its ToxPi score, disease spread rate, sickness score, number of cases and deaths, and the Gi_Bin it was placed in to determine the confidence level of its status as a hotspot or coldspot.</p></caption>
<graphic xlink:href="21264756v2_fig6.tif"/>
</fig>
</sec>
<sec id="s4">
<title>Discussion</title>
<p>We developed two new methods using ArcGIS Pro to create feature layers containing ToxPi diagrams. The first method comprises a Python script, <italic>ToxPi_creation</italic>.<italic>py</italic>, that is user-friendly and suitable for ArcGIS users of all experience levels as well as those who want to produce a feature layer containing only ToxPi figures. The script automates the required geoprocessing steps, so after loading the ArcGIS Pro environment, users simply run the script with the results of the ToxPi GUI as input. Further, as the script uses the underlying code for the toolbox, users are not required to download and add the toolbox to the proper environment, making it especially accessible for inexperienced ArcGIS users. Because the script is open source, experienced Python users can easily access both the toolbox code and the code used for data preparation and thus develop new related methods and analysis procedures. This flexibility opens the door for new advancements and the creation of complex workflows that will benefit many fields.</p>
<p>The second method comprises an ArcGIS Pro Toolbox, <italic>ToxPiToolbox</italic>.<italic>tbx</italic>, and is recommended for advanced ArcGIS users due to the geoprocessing steps required for data preparation. The method allows customization of the output feature layer and can be easily integrated into existing workflows for ArcGIS models. It is extremely useful as a means for the further advancement of analysis and visualization in existing workflows, as there is no current method for generating ToxPi feature layers in ArcGIS maps.</p>
<p>The <italic>ToxPi_creation_customized</italic>.<italic>py</italic> script is an example of potential user alterations to <italic>ToxPi_creation</italic>.<italic>py</italic>. The script uses both geoprocessing procedures and Python analysis to create advanced maps and is useful for county- and census-tract-level data. Methods such as using joins and altering the zoom extent for feature layers are useful for creating interactive maps with multiple feature layers that show varying levels of data. The choice of COVID-19 data as an example use case of this script is a relatable demonstration and a useful visualization of data of interest to the general public.</p>
<p>Using COVID-19 data, results from the powerful hotspot analysis option in ArcGIS revealed that significant high-risk clusters are located in Missouri, the border of Texas, Arkansas, Georgia, and Tennessee. Combined with the ToxPi&#x002A;GIS Toolkit, this method enables the easy visualization of factors affecting high-risk areas. The results can help with decisions regarding how resources should be allocated in counties to address the health disparities contributing to their vulnerability to COVID-19. Although the results displayed here are for a selected time period (June 2021), the intention was to demonstrate a topical use case rich in public data for how the ToxPi&#x002A;GIS Toolkit can be coupled with ArcGIS analysis methods.</p>
<p>ArcGIS dashboards represent powerful ArcGIS customizations that enable visualization to portray the story behind data. A dashboard offers many advantages over a stand-alone map, namely customization and the ability to include extra analysis to indicate the importance of certain information in a particular context. Visualization options that include web applications and story maps allow for further versatility based on a user&#x2019;s needs.</p>
<p>The ToxPi&#x002A;GIS Toolkit, as well as instructions for its use, are freely available on a dedicated GitHub page. Development of this living software Toolkit will continue, with the objective of developing new methods that integrate ToxPi statistics. We provide open-source code to enable users to create new methods, with the objective of advancing the interests of the scientific community. All example visualizations and the dedicated GitHub page are linked at <ext-link ext-link-type="uri" xlink:href="http://www.toxpi.org">www.toxpi.org</ext-link>, which will be regularly updated with advancements related to ToxPi statistics. Future goals are to develop options for scaling and filtering ToxPi figures, methods for separating overlapping ToxPi figures, the ability to integrate timescale data, and the direct provision of map creation and analysis options on ArcGIS Online website for users without ArcGIS Pro access.</p>
</sec>
</body>
<back>
<sec sec-type="data-availability">
<title>Data Availability</title>
<p>All applications, usage instructions, sample data, example visualizations, and opensource code are freely available from a dedicated GitHub page linked from www.toxpi.org.</p>
<p>
<ext-link ext-link-type="uri" xlink:href="https://toxpi.org">https://toxpi.org</ext-link>
</p>
</sec>
<ack>
<title>Acknowledgments</title>
<p>We thank the PVI project team for data provision and the Baker Lab at NCSU for software testing. We also thank Dan Schmitt and Logan Wenzel for their expertise in implementation. This research was supported by the National Institutes of Health (NIH) grant awards ES030007 and ES025128, and by intramural funds from the National Institute of Environmental Health Sciences and the National Institute for Allergy and Infectious Diseases.</p>
</ack>
<sec id="s5">
<title>Conflict of Interest</title>
<p>The authors declare there are no conflicts of interest.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Reif</surname>, <given-names>David M.</given-names></string-name>, <string-name><given-names>Matthew T.</given-names> <surname>Martin</surname></string-name>, <string-name><given-names>Shirlee W.</given-names> <surname>Tan</surname></string-name>, <string-name><given-names>Keith A.</given-names> <surname>Houck</surname></string-name>, <string-name><given-names>Richard S.</given-names> <surname>Judson</surname></string-name>, <string-name><given-names>Ann M.</given-names> <surname>Richard</surname></string-name>, <string-name><given-names>Thomas B.</given-names> <surname>Knudsen</surname></string-name>, <string-name><given-names>David J.</given-names> <surname>Dix</surname></string-name>, and <string-name><given-names>Robert J.</given-names> <surname>Kavlock</surname></string-name>. &#x201C;<article-title>Endocrine Profiling and Prioritization of Environmental Chemicals Using ToxCast Data</article-title>.&#x201D; <source>Environmental Health Perspectives</source> <volume>118</volume>, no. <issue>12</issue> (<year>2010</year>): <fpage>1714</fpage>&#x2013;<lpage>20</lpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Marvel</surname>, <given-names>Skylar W.</given-names></string-name>, <string-name><given-names>Kimberly</given-names> <surname>To</surname></string-name>, <string-name><given-names>Fabian A.</given-names> <surname>Grimm</surname></string-name>, <string-name><given-names>Fred A.</given-names> <surname>Wright</surname></string-name>, <string-name><given-names>Ivan</given-names> <surname>Rusyn</surname></string-name>, and <string-name><given-names>David M.</given-names> <surname>Reif</surname></string-name>. &#x201C;<article-title>ToxPi Graphical User Interface 2.0: Dynamic Exploration, Visualization, and Sharing of Integrated Data Models</article-title>.&#x201D; <source>BMC Bioinformatics</source> <volume>19</volume>, no. <issue>1</issue> (<month>March</month> 5, <year>2018</year>): <fpage>80</fpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12859-018-2089-2">https://doi.org/10.1186/s12859-018-2089-2</ext-link>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="website"><string-name><surname>Marvel</surname>, <given-names>Skylar W.</given-names></string-name>, <string-name><given-names>John S.</given-names> <surname>House</surname></string-name>, <string-name><given-names>Matthew</given-names> <surname>Wheeler</surname></string-name>, <string-name><given-names>Kuncheng</given-names> <surname>Song</surname></string-name>, <string-name><given-names>Yihui</given-names> <surname>Zhou</surname></string-name>, <string-name><given-names>Fred A.</given-names> <surname>Wright</surname></string-name>, <string-name><given-names>Weihsueh A.</given-names> <surname>Chiu</surname></string-name>, <string-name><given-names>Ivan</given-names> <surname>Rusyn</surname></string-name>, <string-name><given-names>Alison</given-names> <surname>Motsinger-Reif</surname></string-name>, and <string-name><given-names>David M.</given-names> <surname>Reif</surname></string-name>. &#x201C;<article-title>The COVID-19 Pandemic Vulnerability Index (PVI) Dashboard: Monitoring County-Level Vulnerability Using Visualization, Statistical Modeling, and Machine Learning</article-title>.&#x201D; <source>MedRxiv</source>, <month>September</month> 13, <year>2020</year>, 2020.08.10.20169649. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/2020.08.10.20169649">https://doi.org/10.1101/2020.08.10.20169649</ext-link>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Bhandari</surname>, <given-names>Sharmila</given-names></string-name>, <string-name><given-names>P.</given-names> <surname>Grace Tee Lewis</surname></string-name>, <string-name><given-names>Elena</given-names> <surname>Craft</surname></string-name>, <string-name><given-names>Skylar W.</given-names> <surname>Marvel</surname></string-name>, <string-name><given-names>David M.</given-names> <surname>Reif</surname></string-name>, and <string-name><given-names>Weihsueh A.</given-names> <surname>Chiu</surname></string-name>. &#x201C;<article-title>HGBEnviroScreen: Enabling Community Action through Data Integration in the Houston-Galveston-Brazoria Region</article-title>.&#x201D; <source>International Journal of Environmental Research and Public Health</source> <volume>17</volume>, no. <issue>4</issue> (<month>February</month> 11, <year>2020</year>): <fpage>E1130</fpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/ijerph17041130">https://doi.org/10.3390/ijerph17041130</ext-link>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><given-names>Cohen</given-names> <surname>Hubal</surname></string-name>, <string-name><surname>Elaine</surname> <given-names>A.</given-names></string-name>, <string-name><given-names>David M.</given-names> <surname>Reif</surname></string-name>, <string-name><given-names>Rachel</given-names> <surname>Slover</surname></string-name>, <string-name><given-names>Ashley</given-names> <surname>Mullikin</surname></string-name>, and <string-name><given-names>John C.</given-names> <surname>Little</surname></string-name>. &#x201C;<article-title>Children&#x2019;s Environmental Health: A Systems Approach for Anticipating Impacts from Chemicals</article-title>.&#x201D; <source>International Journal of Environmental Research and Public Health</source> <volume>17</volume>, no. <issue>22</issue> (<month>November</month> 11, <year>2020</year>): <fpage>E8337</fpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/ijerph17228337">https://doi.org/10.3390/ijerph17228337</ext-link>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Newman</surname>, <given-names>Galen</given-names></string-name>, <string-name><given-names>Matthew</given-names> <surname>Malecha</surname></string-name>, and <string-name><given-names>Kayode</given-names> <surname>Atoba</surname></string-name>. &#x201C;<article-title>Integrating ToxPi Outputs with ArcGIS Dashboards to Identify Neighborhood Threat Levels of Contaminant Transferal during Flood Events</article-title>.&#x201D; <source>Journal of Spatial Science</source> <volume>0</volume>, no. <issue>0</issue> (<month>February</month> 28, <year>2021</year>): <fpage>1</fpage>&#x2013;<lpage>13</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/14498596.2021.1891149">https://doi.org/10.1080/14498596.2021.1891149</ext-link>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="website"><source>&#x201C;Optimized Hot Spot Analysis (Spatial Statistics)&#x2014;ArcGIS Pro &#x007C; Documentation.&#x201D;</source> Accessed <date-in-citation content-type="access-date">August 19, 2021</date-in-citation>. <ext-link ext-link-type="uri" xlink:href="https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-statistics/optimized-hot-spot-analysis.htm">https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-statistics/optimized-hot-spot-analysis.htm</ext-link>.</mixed-citation></ref>
</ref-list>
<sec id="s6">
<title>SUPPLEMENTAL and OTHER OPTIONAL MATERIAL</title>
<p>All applications, usage instructions, sample data, example visualizations, and open-source code are freely available from a dedicated GitHub page linked from <ext-link ext-link-type="uri" xlink:href="http://www.toxpi.org">www.toxpi.org</ext-link>. Direct links to specific elements described above are provided here.</p>
<p>ToxPi&#x002A;GIS Toolkit Github</p>
<p><ext-link ext-link-type="uri" xlink:href="https://github.com/Jonathon-Fleming/ToxPi-GIS">https://github.com/Jonathon-Fleming/ToxPi-GIS</ext-link></p>
<p>Vignette1: <italic>ToxPi_creation</italic>.<italic>py</italic> Demonstration</p>
<p><ext-link ext-link-type="uri" xlink:href="https://ncsu.maps.arcgis.com/home/item.html?id=7c0365b3f75949369b46c07ae4ecf10c">https://ncsu.maps.arcgis.com/home/item.html?id=7c0365b3f75949369b46c07ae4ecf10c</ext-link></p>
<p>Vignette2: <italic>ToxPi_creation_customized</italic>.<italic>py</italic> Demonstration</p>
<p><ext-link ext-link-type="uri" xlink:href="https://ncsu.maps.arcgis.com/home/item.html?id=1518637a0b454036a3d0d2fc8239ff08">https://ncsu.maps.arcgis.com/home/item.html?id=1518637a0b454036a3d0d2fc8239ff08</ext-link></p>
<p>HotSpot/Dashboard Demonstration</p>
<p><ext-link ext-link-type="uri" xlink:href="https://ncsu.maps.arcgis.com/home/item.html?id=022416cbc74d430691ad7d2a4cbec229">https://ncsu.maps.arcgis.com/home/item.html?id=022416cbc74d430691ad7d2a4cbec229</ext-link></p>
</sec>
</back>
</article>