<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">MEDRXIV</journal-id>
<journal-title-group>
<journal-title>medRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">medRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/2021.03.29.21254233</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Epidemiology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Estimating the strength of selection for new SARS-CoV-2 variants</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7504-9947</contrib-id>
<name><surname>van Dorp</surname><given-names>Christiaan H.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7311-9606</contrib-id>
<name><surname>Goldberg</surname><given-names>Emma E.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4157-134X</contrib-id>
<name><surname>Hengartner</surname><given-names>Nick</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5307-8934</contrib-id>
<name><surname>Ke</surname><given-names>Ruian</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8082-1225</contrib-id>
<name><surname>Romero-Severson</surname><given-names>Ethan O.</given-names></name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="corresp" rid="cor1">&#x2020;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Theoretical Biology and Biophysics (T-6)</institution>, Los Alamos National Laboratory, Los Alamos NM, <country>USA</country></aff>
<aff id="a2"><label>2</label><institution>New Mexico Consortium</institution>, Los Alamos NM, <country>USA</country></aff>
</contrib-group>
<author-notes>
<fn id="n1" fn-type="equal"><label>&#x002A;</label><p>These authors contributed equally to this work</p></fn>
<corresp id="cor1"><label>&#x2020;</label>Correspondence: <email>eoromero@lanl.gov</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2021</year>
</pub-date>
<elocation-id>2021.03.29.21254233</elocation-id>
<history>
<date date-type="received">
<day>29</day>
<month>3</month>
<year>2021</year>
</date>
<date date-type="rev-recd">
<day>29</day>
<month>3</month>
<year>2021</year>
</date>
<date date-type="accepted">
<day>01</day>
<month>4</month>
<year>2021</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2021, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2021</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution-NonCommercial-NoDerivs 4.0 International), CC BY-NC-ND 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/">http://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="21254233.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>Abstract</title>
<p>A challenge to controlling the SARS-CoV-2 pandemic is the ability of the virus to adapt to its new human hosts, with novel and more transmissible strains of the virus being continually identified. Yet there are no generally accepted methods to consistently estimate the relative magnitude of the change in transmissiblity of newly emerging variants. In this paper we consider three methods for examining and quantifying positive selection of new and emerging strains of SARS-CoV-2 over an existing wild-type strain. We consider replication at the level of countries and allow for the action of other processes that can change variants&#x2019; frequencies, specifically migration and drift. We apply these methods to the D614G spike mutation and the variant designated B.1.1.7, in every country where there is sufficient sequence data. For each of D614G and B.1.1.7, we find evidence for strong selection (greater than 25&#x0025; increased contagiousness) in more than half of countries analyzed. Our results also shows that the selective advantages of these strains are highly heterogeneous at the country level, suggesting the need for a truly global perspective on the molecular epidemiology of SARS-CoV-2.</p>
</abstract>
<counts>
<page-count count="25"/>
</counts>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<notes notes-type="financial-disclosure">
<title>Funding Statement</title><p>Portions of this work were done under the auspices of the U.S. Department of Energy under contract 89233218CNA000001 and supported by National Institutes of Health (<ext-link ext-link-type="uri" xlink:href="http://www.nih.gov">www.nih.gov</ext-link>) grants P01-AI131365, R01-OD011095, and R01-AI028433 (CHvD). RK, NH, and ERS were funded by the US National Science Foundation RAPID grant PHY-2031756.</p></notes>
<notes notes-type="disclosures">
<title>Author Declarations</title><p>I confirm all relevant ethical guidelines have been followed, and any necessary IRB and/or ethics committee approvals have been obtained.</p><p>Yes</p><p>The details of the IRB/oversight body that provided approval or exemption for the research described are given below:</p><p>n/a</p><p>All necessary patient/participant consent has been obtained and the appropriate institutional forms have been archived.</p><p>Yes</p><p>I understand that all clinical trials and any other prospective interventional studies must be registered with an ICMJE-approved registry, such as <ext-link ext-link-type="uri" xlink:href="http://ClinicalTrials.gov">ClinicalTrials.gov</ext-link>. I confirm that any such study reported in the manuscript has been registered and the trial registration ID is provided (note: if posting a prospective study registered retrospectively, please provide a statement in the trial ID field explaining why the study was not registered in advance).</p><p>Yes</p><p>I have followed all appropriate research reporting guidelines and uploaded the relevant EQUATOR Network research reporting checklist(s) and other pertinent material as supplementary files, if applicable.</p><p>Yes</p></notes>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Recently, several genetic variants of SARS-CoV-2 have been identified that are either suspected or confirmed to have mutations that increase the contagiousness of the virus above the current circulating variants [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c2">2</xref>, <xref ref-type="bibr" rid="c3">3</xref>]. For a short while after the emergence of SARS-CoV-2, it was believed that the adaptive evolution of SARS-CoV-2 was limited, as evidence for purifying selection was found at most sites, with the clear exception of position 614 of the spike protein [<xref ref-type="bibr" rid="c4">4</xref>]. However, the emergence and rise of more complex variants such as B.1.1.7 in the United Kingdom (UK) has shifted this understanding. As SARS-CoV-2 continues to adapt to transmission among humans, we can expect to see further mutations that alter the phenotype of the circulating virus [<xref ref-type="bibr" rid="c5">5</xref>]. Likewise, the gradual roll-out of vaccination programs globally will slowly change the immunological landscape, possibly leading to the emergence of escape strains that are partially or fully resistant to existing vaccinations [<xref ref-type="bibr" rid="c6">6</xref>, <xref ref-type="bibr" rid="c7">7</xref>, <xref ref-type="bibr" rid="c8">8</xref>].</p>
<p>Molecular epidemiology is a powerful framework comprised of a broad collection of methods and software designed to facilitate the analysis of pathogen genetic sequence data [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c2">2</xref>, <xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c9">9</xref>]. These methods allow us to peer beyond what is provided by traditional epidemiological data such as case counts and death time-series, into the substructure of an epidemic by tracking the emergence and transmission of new genetic variants. Given the high extent of population mixing at both local and global levels, the time between the emergence of a new strain in one country and its global dissemination is short. Given that rapid spread, the ongoing fight against COVID-19 needs new, global tools focused on rapid modeling and assessment of the risk associated with new strains of SARS-CoV-2 to support global public health action.</p>
<p>Several groups have investigated the selective advantage of particular SARS-CoV-2 variants, such as D614G and B.1.1.7, either qualitatively or quantitatively. The global spread of the D614G variant was first described by Korber et al. [<xref ref-type="bibr" rid="c10">10</xref>]. Specifically for the UK, the selection coefficient for the D614G variant has been estimated using various phylogenetic and phylodynamic methods [<xref ref-type="bibr" rid="c3">3</xref>]. Estimates from these methods are highly variable, often producing inconclusive answers. The increased infectiousness of the D614G variant has also been functionally explained in terms of ACE2 receptor binding [<xref ref-type="bibr" rid="c11">11</xref>]. The selection coefficient of the B.1.1.7 variant has been estimated for England using a highly detailed deterministic epidemic model [<xref ref-type="bibr" rid="c12">12</xref>]. Phylodynamic approaches have led to similar results [<xref ref-type="bibr" rid="c2">2</xref>]. More worryingly, the B.1.1.7 variant is associated with increased mortality [<xref ref-type="bibr" rid="c13">13</xref>]. These changes to the SARS-CoV-2 phenotype embodied in D614G and B.1.1.7 likely represent only a small fraction of the phenotypic variability in the broader population.</p>
<p>In this paper we consider three different approaches for analyzing global sequence data to estimate the evidence for increased contagiousness of existing strains in the context of potentially high levels of between-country movement of people. Our goal is to test the robustness of results to different modeling assumptions, and to asses these different approaches as molecular surveillance tools.</p>
<sec id="s1a">
<title>Methods</title>
<p>We use three distinct methods to study the change in frequency over time of a SARS-CoV-2 genetic variant: isotonic regression, a population genetics model, and a stochastic epidemiological model. These models represent trade-offs in mechanistic detail and computational efficiency. The first takes a descriptive approach to the rise and fall of variant frequency based around rejecting a null hypothesis of limited or no change in frequency. The second incorporates the processes of selection and migration in the context of a deterministic theoretical population. The third additionally includes stochastic effects and more explicit epidemiological processes. By comparing results from these three models, we assess the robustness of our findings to the assumptions of particular methods. In all models, we compare a new variant with the circulating background variants. The new and background variants are labeled mt (for &#x201C;mutant&#x201D;) and wt (for &#x201C;wild type&#x201D;) respectively. All data and scripts can be downloaded from <monospace><ext-link ext-link-type="uri" xlink:href="https://github.com/eeg-lanl/sarscov2-selection">https://github.com/eeg-lanl/sarscov2-selection</ext-link></monospace></p>
</sec>
<sec id="s1b">
<title>Data</title>
<p>All epidemiological data was taken from the COVID-19 Data Repository curated by the Center for Systems Science and Engineering (CSSE) at Johns Hopkins University [<xref ref-type="bibr" rid="c14">14</xref>], aggregated by week to reduce noise. The D614G and B.1.1.7 variant data were taken from the Los Alamos COVID-19 Viral Genome Analysis Pipeline [<xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c15">15</xref>] and GISAID [<xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c17">17</xref>], respectively.</p>
</sec>
<sec id="s1c">
<title>Isotonic regression</title>
<p>The logic behind the isotonic regression method is that, if a variant is under selection strong enough to be worrying, then we should see a continual increase in its relative frequency. That is, for a variant under selection in a given country, we should be able to reject the hypothesis that it shows no increase with respect to its background.</p>
<p>Let us consider modeling the time series of pairs <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline1.gif"/></alternatives></inline-formula> that count the number of samples identified as the new variant <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline2.gif"/></alternatives></inline-formula> and all other background sequences <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline3.gif"/></alternatives></inline-formula> observed on a given day <italic>t</italic>. If we assume that the individuals whose SARS-CoV-2 virus is sequenced are randomly selected from the pool of infected individuals, then the number of observed variant sequences <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline4.gif"/></alternatives></inline-formula>, conditional on the total number of sequenced individuals <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline5.gif"/></alternatives></inline-formula>, is binomial with probability <italic>p</italic><sub><italic>t</italic></sub> and size <italic>F</italic><sub><italic>t</italic></sub>. If the mutations that define the new variant (i.e., the genotype) are neutral, being neither beneficial nor deleterious, then the proportion <italic>p</italic><sub><italic>t</italic></sub> performs a random walk with constant expectation. However, if the variant has an evolutionary advantage, then the proportion <italic>p</italic><sub><italic>t</italic></sub> will have a non-decreasing expectation over time.</p>
<p>Here, we use that observation to devise a statistical test for the null hypothesis that a genotype is not advantageous. This approach does not, however, provide us with an estimate of how advantageous a genotype is because it does not model the competition between variants.</p>
<p>Let (<italic>t</italic><sub><italic>i</italic></sub>,<italic>V</italic><sub><italic>i</italic></sub>), <italic>i</italic> = 1,&#x2026;,<italic>K</italic> denote the date and variant <italic>V</italic><sub><italic>i</italic></sub> &#x2208; {wt, mt} from each of the <italic>K</italic> tested individuals. Our test is based on fitting isotonic logistic regressions to estimate a monotone non-decreasing probability <italic>p</italic><sub><italic>t</italic></sub> to that data, and use the logarithm of the likelihood ratio of the fitted isotonic model and model with constant <italic>p</italic><sub><italic>t</italic></sub> as the test statistic. Unlike in regular parametric cases, that statistic does not have an asymptotic chi-square distribution.</p>
<p>For that reason, we empirically evaluate the null distribution of the test statistic by refitting the isotonic regres-sion to <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline6.gif"/></alternatives></inline-formula>, where <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline7.gif"/></alternatives></inline-formula> is a random permutation of the original data <italic>V</italic><sub>1</sub>,&#x2026;,<italic>V</italic><sub><italic>K</italic></sub>. Fitting the isotonic logistic regression to <italic>M</italic> random permutations allows us to calculate empirically the country level p-value for the null hypothesis of no evolutionary advantage that are reported in Results. These were calculated in R 3.6.3 using the package <monospace>cgam</monospace> [<xref ref-type="bibr" rid="c18">18</xref>] to perform the isotonic logistic regression.</p>
</sec>
<sec id="s1d">
<title>Population genetics model</title>
<p>The goal of this modeling approach is to provide a rapid means of estimating the selective advantage of a new genetic variant while also allowing for some contribution from migration. We first describe the model within each country. Then we explain how we fit it to data from all countries.</p>
<p>The model assumes that time is measured in discrete units of generations. Within each generation, we let selection act first and then migration. Say that <italic>p</italic> and <italic>q</italic> are the frequencies of new and background variants, respectively, at the beginning of the generation (<italic>p</italic> &#x002B; <italic>q</italic> = 1). Then say that <italic>p</italic><sup>&#x002A;</sup> and <italic>q</italic><sup>&#x002A;</sup> are the variant frequencies after selection, and <italic>p</italic>&#x2032; and <italic>q</italic>&#x2032; are the frequencies after migration and hence at the beginning of the next generation.</p>
</sec>
<sec id="s1e">
<title>Selection</title>
<p>Define the absolute fitnesses of the two variants as <italic>W</italic><sub>wt</sub> = <italic>&#x03B2;</italic> and <italic>W</italic><sub>mt</sub> = <italic>&#x03B2;</italic> (1 &#x002B; <italic>s</italic>). So <italic>&#x03B2;</italic> is the geometric growth rate in number of infected people for the original genotype, and <italic>s</italic> is the selective advantage (if <italic>s &#x003E;</italic> 0) or disadvantage (if <italic>s &#x003C;</italic> 0) of the new variant.</p>
<p>For the moment, let us be explicit about population size. Define <italic>N</italic><sub>mt</sub> = <italic>Np</italic> and <italic>N</italic><sub>wt</sub> = <italic>Nq</italic> as the numbers of infected people with each variant at the beginning of this generation, where <italic>N</italic> is the total number of infected people in the population. After the selective event, which is transmission of each of the variants to new hosts, the numbers of infected people become
<disp-formula id="eqn1">
<alternatives><graphic xlink:href="21254233v1_eqn1a.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn2">
<alternatives><graphic xlink:href="21254233v1_eqn1b.gif"/></alternatives>
</disp-formula>
Even if transmission (and recovery) alters the number of infected people, this change in population size does not affect the new variant frequencies, i.e.,
<disp-formula id="eqn3">
<alternatives><graphic xlink:href="21254233v1_eqn1c.gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn4">
<alternatives><graphic xlink:href="21254233v1_eqn1d.gif"/></alternatives>
</disp-formula>
is independent of <italic>N</italic> and of <italic>&#x03B2;</italic>. So even with arbitrary changes in the number of infected people over time, this simple deterministic model can track only the variant frequencies. Of course, drift can have large effects when <italic>N</italic> is small, and also when a population of any size is growing rapidly. But we leave stochastic effects to our subsequent, more complex epidemic model.</p>
</sec>
<sec id="s1f">
<title>Migration</title>
<p>Next, a fraction <italic>m</italic> of our population is replaced by immigrants. That is, some number of infected people leave our population, and an equal number of infected people arrive from elsewhere. We say that immigration is balanced by emigration because we are applying this same model to many populations (countries) simultaneously, and travel itself does not change the total number of infected people.</p>
<p>The change in frequency of the new variant due to migration is
<disp-formula id="eqn5">
<alternatives><graphic xlink:href="21254233v1_eqn2a.gif"/></alternatives>
</disp-formula>
where <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline8.gif"/></alternatives></inline-formula> is the frequency of the new variant among the immigrants. To be most generous to the alternative explanation that immigration is the driving force behind increases in <italic>p</italic>, we set <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline9.gif"/></alternatives></inline-formula> so
<disp-formula id="eqn6">
<alternatives><graphic xlink:href="21254233v1_eqn2b.gif"/></alternatives>
</disp-formula>
Note that if the number of infected people is increasing over time (<italic>&#x03B2; &#x003E;</italic> 1 in the description of selection, above), our formulation with constant migration fraction <italic>m</italic> means that the number of infected travelers is also increasing over time.</p>
<p>Putting together the total effects of selection and migration for this generation, by substituting <xref ref-type="disp-formula" rid="eqn1">Eq. (1c)</xref> into <xref ref-type="disp-formula" rid="eqn2">Eq. (2b)</xref>,
<disp-formula id="eqn7">
<alternatives><graphic xlink:href="21254233v1_eqn3.gif"/></alternatives>
</disp-formula>
At any time <italic>t</italic>,
<disp-formula id="eqn8">
<alternatives><graphic xlink:href="21254233v1_eqn4.gif"/></alternatives>
</disp-formula>
(see <xref ref-type="disp-formula" rid="eqn20">Eq. (A-6)</xref>). We define <italic>t</italic> = 0 as the time at which the new variant first appears in any country. Notice that without migration (<italic>m</italic> = 0), <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> reduces to the logistic model derived in [<xref ref-type="bibr" rid="c19">19</xref>].</p>
</sec>
<sec id="s1g">
<title>Fitting to data</title>
<p>For each country, the data we use are the numbers of observations of the background <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline10.gif"/></alternatives></inline-formula> and the new variant <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline11.gif"/></alternatives></inline-formula> each day (<italic>t</italic>). We fit these data with Bayesian binomial regression, using <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref>, with country as a random effect. This yields separate estimates of <italic>s, m</italic>, and <italic>p</italic><sub>0</sub> for each country.</p>
<p>Because the time unit for our data is days, the estimates of <italic>s</italic> and <italic>m</italic> from the model fit must be multiplied by the generation time in order to be interpreted as per-generation processes. The mean serial interval for SARS-CoV-2 is most likely between 4 and 7.8 days [<xref ref-type="bibr" rid="c20">20</xref>], so we use a normal distribution with mean 5.9 and standard deviation 1.15 for the mean generation time.</p>
<p>When selection truly favors a variant due to its genetic composition, it should have a similar advantage in any country. There may be differences from country to country, though, due to chance effects. For example, if the early-infected people happen to be from a demographic with higher transmission or a city with looser enforcement of social distancing, selection may appear to be stronger. We therefore use a hierarchical model in which <italic>s</italic> is drawn for each country from a normal distribution, whose mean and variance we estimate in order to infer the consistency of selection.</p>
<p>The migration rate, <italic>m</italic>, is the proportion of the country&#x2019;s population swapped out for the new variant each generation. This is surely quite small, especially considering travel restrictions. We therefore set an exponential prior on <italic>m</italic> with mean 0.001.</p>
<p>For numerical stability, we transform all frequencies to the logit scale (see Appendix A). Models were fit with Stan [<xref ref-type="bibr" rid="c21">21</xref>], using 4 parallel chains of length 2000, with a warm-up phase of a 1000 iterations.</p>
</sec>
<sec id="s1h">
<title>Stochastic epidemic model</title>
<p>To take more detailed population dynamics into account, we use a stochastic compartmental Kermack-McKendrick-type model. In addition to susceptible (S), exposed (E), infectious (I), and removed (R) individuals, we keep track of individuals with severe disease (H), and stratify the exposed and infected populations into individuals infected with the background (wt) or the new variant (mt). The compartment of severe infections is used to model the observed delay between infection and death. The two strata are used to keep track of the new variant&#x2019;s frequency in the population, and model its selective advantage (<italic>s</italic>).</p>
<p>The compartmental model keeps track of the number of individuals <italic>S, E, I, H, R</italic> in the disease states S, E, I, H, R, respectively. An individual starts out susceptible, and upon infection enters the exposed compartment and then becomes infectious at rate <italic>&#x03B1;</italic>. An infectious individual can either become severely infected at rate <italic>&#x03BD;</italic>, or recover at rate <italic>&#x03B3;</italic>. Severely infected individuals either recover or die at rate <italic>&#x03C9;</italic>. The total population size is denoted by <italic>N</italic>, and we write <italic>X</italic> = (<italic>S, E</italic><sub>wt</sub>, <italic>E</italic><sub>mt</sub>, <italic>I</italic><sub>wt</sub>, <italic>I</italic><sub>mt</sub>, <italic>H, R</italic>). The transition rates <italic>&#x03B7;</italic><sub><italic>j</italic></sub>(<italic>X, t</italic>) between the compartments are indicated by the following diagram, and the parameters are listed in <xref rid="tbl1" ref-type="table">Table 1</xref>.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><p>Parameters for the epidemic model for the United Kingdom (UK) and the Netherlands (NL) and the D614G and B.1.1.7 variants. Notes: <sup>a</sup>Estimated. <sup>b</sup>For the Dutch B.1.1.7 model, the initial frequency is fixed to 0. Instead, the variant is introduced due to travel from the UK. <sup>c</sup>More recent estimates for sero-prevalence in the Netherlands are taken from <ext-link ext-link-type="uri" xlink:href="https://www.rivm.nl/pienter-corona-studie/resultaten">https://www.rivm.nl/pienter-corona-studie/resultaten</ext-link>. <sup>d</sup>The generation interval in the SEIHR model with exponentially distributed transition times is equal to 1<italic>/&#x03B1;</italic> &#x002B; (<italic>&#x03B3;</italic> &#x002B; <italic>&#x03BD;</italic>)<sup>&#x2212;1</sup> &#x2248; 1<italic>/&#x03B1;</italic> &#x002B; 1<italic>/&#x03B3;</italic>. Hence, with an average incubation period of 3 days, we need an average infectious period of 4 days to get an average generation time of 7 days. <sup>e</sup>By taking the probability of developing severe infection equal to 0.02 and the probability of dying from severe infection equal to 0.3, we arrive at a case fatality rate of 0.6&#x0025;. Our choice is also comparable to mortality rates for ICU patients [<xref ref-type="bibr" rid="c31">31</xref>]. <sup>f</sup>The average time between symptom onset and death is 16.5 days. After subtracting the duration of the infections period (<italic>&#x03B3;</italic> &#x002B; <italic>&#x03BD;</italic>)<sup>&#x2212;1</sup> &#x2248; 1<italic>/&#x03B3;</italic>, we get an average duration of severe infection of 12.5 days.</p></caption>
<graphic xlink:href="21254233v1_tbl1.tif"/>
</table-wrap>
<p>
<disp-formula id="eqn9">
<alternatives><graphic xlink:href="21254233v1_eqn5.gif"/></alternatives>
</disp-formula>
Here the indicated rates are <italic>per capita</italic> and should be multiplied by the size of the source compartment (e.g., <italic>&#x03B7;</italic><sub>H&#x2192;R</sub>(<italic>X, t</italic>) = <italic>H&#x03C9;</italic>). The selective advantage of the new variant is equal to <italic>s</italic>; when <italic>s &#x003E;</italic> 0, the mutant has a higher infection rate <italic>&#x03B2;</italic> (1 &#x002B; <italic>s</italic>) than to the wild-type (<italic>&#x03B2;</italic>). The other life-history traits of the virus are assumed to be identical between wild-type and mutant. To model the effects of non-pharmaceutical interventions (NPI) such as lock-downs, the infection rate <italic>&#x03B2;</italic> is a smoothed, piece-wise constant function of time [<xref ref-type="bibr" rid="c22">22</xref>]. To account for migration, we added time-dependent terms <italic>&#x03BB;</italic><sub>wt</sub> and <italic>&#x03BB;</italic><sub>mt</sub> to the <italic>per-capita</italic> infection rate, representing the exposure of individuals in the population to SARS-CoV-2 from other regions. The precise definitions of the time-dependent parameters <italic>&#x03B2;, &#x03BB;</italic><sub>wt</sub>, and <italic>&#x03BB;</italic><sub>mt</sub> are given in Appendix B.</p>
</sec>
<sec id="s1i">
<title>Observation model</title>
<p>The model is fit to two data streams. The first data stream consists of weekly incidence of COVID-19 deaths <italic>D</italic>. For this reason, we keep track of an auxiliary accumulator variable &#x0398;<sup>HR</sup>, which keeps track of all transitions from H to R within a week. After each time the incidence is observed, the accumulator variable &#x0398;<sup>HR</sup> is set to 0. Let <italic>&#x03B4;</italic> denote the probability that a severe infection leads to death and not recovery. To account for variability in <italic>&#x03B4;</italic> between demographic groups or reporting errors, we use an over-dispersed negative binomial instead of a binomial or Poisson likelihood function for the observed death counts. At the time of the <italic>n</italic>-th observation <italic>t</italic><sub><italic>n</italic></sub>, we then get
<disp-formula id="eqn10">
<alternatives><graphic xlink:href="21254233v1_eqn6.gif"/></alternatives>
</disp-formula>
where the parameterization of the NegBinom(&#x1D4C1;, <italic>r</italic>) distribution is such that it has &#x1D4C1; mean and variance &#x1D4C1; &#x002B; &#x1D4C1;<sup>2</sup><italic>/r</italic>.</p>
<p>The second data stream consists of the number viral samples <italic>F</italic> that were sequenced each week, and the number sequences <italic>F</italic><sup>mt</sup> identified as the new variant. We assume that these sequences are collected from individuals that transition from the exposed to the infectious compartment, and hence we again define accumulator variables <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline12.gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline13.gif"/></alternatives></inline-formula> to keep track of such transitions (for wild-type and mutant infections, respectively) during the week between subsequent observation times. We define <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline14.gif"/></alternatives></inline-formula> for the fraction of individuals that were infected with the new variant. To allow for over-dispersion of sampling, we use a beta-binomial likelihood function:
<disp-formula id="eqn11">
<alternatives><graphic xlink:href="21254233v1_eqn7.gif"/></alternatives>
</disp-formula>
where the parameter <italic>r<sub>F</sub></italic> determines the level of over-dispersion of the sampling process.</p>
<p>We fit the model to the two data streams using sequential Monte-Carlo (SMC), where parameters are estimated with iterated particle filtering as described in [<xref ref-type="bibr" rid="c32">32</xref>]. The details of the procedure are given in Appendix B.</p>
</sec>
<sec id="s1j">
<title>Diffusion approximation of the epidemic model</title>
<p>Exact simulation of the Markov jump process (MJP) that defines our stochastic epidemic model is very computationally intensive. We therefore switch to a diffusion approximation of the MJP when population sizes become large in order to do inference more efficiently. This formalism allows us to incorporate two sources of noise. The first being the process noise inherent to the MJP, which becomes negligible when the sizes of the compartments are large. We therefore introduce a second noise term that captures other origins of stochasticity that the MJP can not account for and acts on predominantly large population sizes.</p>
<p>As above, we denote the state of the <italic>n</italic>-dimensional model (where <italic>n</italic> = 7) by <italic>X</italic><sup><italic>i</italic></sup>(<italic>t</italic>) with <italic>i</italic> = 1,&#x2026;,<italic>n</italic>. The discrete, stochastic model is defined by <italic>k</italic> = 9 state transitions
<disp-formula id="eqn12">
<alternatives><graphic xlink:href="21254233v1_eqn8.gif"/></alternatives>
</disp-formula>
where <italic>&#x03B5;</italic> <sub><italic>j</italic></sub> &#x2208; &#x2124;<sup><italic>n</italic></sup> is the increment of the <italic>j</italic>-th transition. For instance, the transition H &#x2192; R corresponds to the increment (0,&#x2026;, 0, &#x2212;1, 1). Using the Kramers-Moyal expansion of the master equation, the MJP is mapped to a system of stochastic differential equations (SDE) that can be derived from the transitions <italic>&#x03B7;</italic><sub><italic>j</italic></sub> and increments <italic>&#x03B5;</italic> <sub><italic>j</italic></sub> as follows [<xref ref-type="bibr" rid="c33">33</xref>]
<disp-formula id="eqn13">
<alternatives><graphic xlink:href="21254233v1_eqn9.gif"/></alternatives>
</disp-formula>
where <italic>B</italic><sub><italic>t</italic></sub> is a 9-dimensional Brownian motion, corresponding to the 9 transitions of the MJP in <xref ref-type="disp-formula" rid="eqn5">Eq. (5)</xref>. The SDE in <xref ref-type="disp-formula" rid="eqn9">Eq. (9)</xref> is of the form d<italic>X</italic> = <italic>&#x00B5;</italic>(<italic>X, t</italic>)d<italic>t</italic> &#x002B; <italic>&#x03C3;</italic> (<italic>X, t</italic>)d<italic>B</italic><sub><italic>t</italic></sub>, where <italic>&#x00B5;</italic> and <italic>&#x03C3;</italic> describe the drift and volatility, respectively. The volatility matrix <italic>&#x03C3;</italic> (<italic>X, t</italic>) encodes the intrinsic noise of the MJP, which is negligible compared to <italic>X</italic> when <italic>X</italic> is large. We therefore add a small second noise term to the system of SDEs that is proportional to <italic>X</italic>. After this adjustment, the SDE becomes
<disp-formula id="eqn14">
<alternatives><graphic xlink:href="21254233v1_eqn10.gif"/></alternatives>
</disp-formula>
where <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline15.gif"/></alternatives></inline-formula> is a <italic>n</italic>-dimensional Brownian motion, independent of <italic>B</italic><sub><italic>t</italic></sub>. The parameter &#x03C4; &#x226A; 1 determines the magnitude of the additional noise term.</p>
<p>In Appendix B, we further describe in detail the algorithm used to switch from a discrete (MJP) to a continuous (SDE) model, and the way the initial condition of the system is determined.</p>
</sec>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Isotonic regression results</title>
<p>Our first approach, isotonic regression, provides a simple statistical test for relative increase of a new variant. The null hypothesis is that the daily proportion of SARS-CoV-2 cases that are the mutant variant does not increase over time. The isotonic regression method rejected this null hypothesis in 33 of 38 countries with sufficient data for D614G and all 24 of the countries with sufficient data for B.1.1.7 at the 5&#x0025; significance level. The results are shown as a map in <xref rid="fig1" ref-type="fig">Fig. 1CD</xref>. In general the isotonic regression method identifies the same set of countries as the population genetic method (see below). However the computed p-value is not directly translated into an estimate for the strength of selection that is estimated from the other methods.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><p>Map of the results of the population genetic model and isotonic regression method. Panels A and B show the estimated selection strength for D614G and B.1.1.7 respectively. Yellow, orange, and red indicated selection coefficient less than 0.3, between 0.3 and 0.6, and above 0.6 respectively. Panels C and D show the p-values from the isotonic regression method for D614G and B.1.1.7 respectively. Red and green show p-values below and above 0.05 respectively.</p></caption>
<graphic xlink:href="21254233v1_fig1.tif"/>
</fig>
</sec>
<sec id="s2b">
<title>Population genetic model results</title>
<p>Our hierarchical population genetics model estimates a normal distribution from which is drawn the selection coefficient for each country. The mean of that global distribution for <italic>s</italic> is 0.25 (90&#x0025; credible interval (CrI): [0.14, 0.35]) for D614G and 0.26 (90&#x0025; CrI: [0.14, 0.36]) for B.1.1.7, both confidently greater than zero (<xref rid="fig2" ref-type="fig">Fig. 2AD</xref>). After allowing for variance around that mean, however (<xref rid="fig2" ref-type="fig">Fig. 2BE</xref>), the overall global distribution of <italic>s</italic> is substantially wider, both for D614G (90&#x0025; CrI: [&#x2212;0.16, 0.68], <xref rid="fig2" ref-type="fig">Fig. 2C</xref>) and for B.1.1.7 (90&#x0025; CrI: [&#x2212;0.07, 0.60], <xref rid="fig2" ref-type="fig">Fig. 2F</xref>). Uncertainty in our estimates of global <italic>s</italic> come from noise in the data, uncertainty in the mean generation time, and heterogeneity among countries.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><p>Estimated global distribution of selection coefficients for the D614G and B.1.1.7 variants from the population genetics model. The hierarchical model estimates the mean (left column) and standard deviation (middle column) of a normal distribution from which the selection coefficient, <italic>s</italic>, of each country is drawn. To compose the overall (posterior predictive) distribution of <italic>s</italic> (right column), we sampled many values of the mean and standard deviation from the posterior distribution of the model, and for each drew many samples from the normal distribution it defines. Thus, panels A and D provide the estimated mean selection coefficient across countries, while panels C and F provide the overall distribution for each country&#x2019;s selection coefficient. In each panel, dark vertical lines mark the median, and the 90&#x0025; CrIs are shaded.</p></caption>
<graphic xlink:href="21254233v1_fig2.tif"/>
</fig>
<p>The overall selective advantages of these two variants are estimated to be very similar, but that does not mean that they are equally transmissible. The strength of selection for a variant is measured relative to all the other genotypes present over that time frame. Because B.1.1.7 emerged after D614G became globally common, the absolute fitness of B.1.1.7 is likely greater.</p>
<p>Estimates of the selection strength for each variant in each country are shown in <xref rid="fig3" ref-type="fig">Fig. 3</xref>. Each variant shows much heterogeneity among countries. Our model allows for a random component in country-to-country variation in <italic>s</italic>, but the differences in estimated <italic>s</italic> among the countries likely overstates the differences in actual transmission advantage. Each country surely experiences many processes that are not included in our simple model&#x2014;such as superspreader events, nonrandom sampling, or waves of travellers arriving from places with different variant frequencies&#x2014;and all of this heterogeneity is bundled by the model into differences in <italic>s</italic> (and <italic>m</italic>, which is constrained to be small). Furthermore, strong selection for one variant in one country does not necessarily correspond to strong selection for the other variant in that country (Fig. S2), suggesting that factors beyond country-level covariates underlie the overall heterogeneity.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption><p>Selection coefficients for each country, from the population genetic model. Points mark the median, and thick and thin lines are 90&#x0025; and 95&#x0025; CrIs, respectively. Corresponding estimates of migration are in Fig. S1.</p></caption>
<graphic xlink:href="21254233v1_fig3.tif"/>
</fig>
<p>In estimating the selective advantage of each variant, our model allows for a contribution of migration in elevating the variant frequencies (see Methods). Because selection and migration to some extent provide alternative explanations for change in variant frequency, we find some negative correlation between these two processes (Figs. S3 and S4). The estimates of migration are not particularly distinguishable among countries (Fig. S1), but estimates of selection nevertheless show clear differences among countries (<xref rid="fig3" ref-type="fig">Fig. 3</xref>). We thus conclude that the selective effect of a variant can be estimated even allowing for a reasonable amount migration.</p>
<p>Fits of the population genetic model to each country are shown in Figs. S5 and S6 for D614G and B.1.1.7, respectively. The countries differ dramatically in sampling effort and data availability over time. The robustness of the population genetic model is tested with a more detailed epidemic model below. For this analysis, we focused on two countries&#x2014;the United Kingdom and the Netherlands&#x2014;for which a lot of data is available. Our focal countries show different stages of the variant trajectories, but in both the model fits show relatively narrow credible intervals.</p>
</sec>
<sec id="s2c">
<title>Stochastic model results</title>
<p>The overall stochastic model fits to D614G and B.1.1.7 for the UK and Netherlands are shown in <xref rid="fig4" ref-type="fig">Fig. 4</xref> and <xref rid="fig5" ref-type="fig">5</xref> respectively. The models provide very good fits to the data in both cases matching both the death time series and the change in proportions of the mutant variant in both countries. D614G shows a very similar pattern in the UK and Netherlands where the mutant was spreading in a way that is nearly indistinguishable from the wild-type strains for a period of several weeks in the early epidemic period. However, in both countries the model predicts that the mutant strain very quickly outpaces the wild-type strains and continues to become more relatively prevalent even when the overall prevalence is declining by orders of magnitude.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><p>Mechanistic model fit to D614G data in the Netherlands and UK. Panels A and B show many realizations of the prevalence of the background, <italic>I</italic><sub>wt</sub>, and D614G variant, <italic>I</italic><sub>mt</sub> for the maximum likelihood model fit. Panels C and D show the number of deaths accumulated up to the week scale (black dots) and the model fits to those data. The bars around the points indicate the 95&#x0025; predictive interval for the data according to the model. Panels E and F show the proportion of sequenced genomes with a glycine on position 614 of the spike protein in a given week. The blue lines are realizations of the model fit to the data. Vertical bars on the data indicate the 95&#x0025; confidence intervals (CI) for the proportion based on the number of sampled genomes.</p></caption>
<graphic xlink:href="21254233v1_fig4.tif"/>
</fig>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5:</label>
<caption><p>Mechanistic model fit to B.1.1.7 data in the Netherlands and UK. Panels A and B show many realizations of the prevalence of the background, <italic>I</italic><sub>wt</sub>, and B.1.1.7 variant, <italic>I</italic><sub>mt</sub> for the maximum likelihood model fit. Panels C and D show the number of deaths accumulated up to the week scale (black dots) and the model fits to those data. The bars around the points indicated the 95&#x0025; predictive internal for the data according to the model. Panels E and F show the proportion of sequenced genomes classified as the B.1.1.7 variant in a given week. The blue lines are realizations of the model fit to the data. Vertical bars on the data indicate the 95&#x0025; CI for the proportion based on the number of sampled genomes.</p></caption>
<graphic xlink:href="21254233v1_fig5.tif"/>
</fig>
<p>The dynamics of B.1.1.7 in the UK and Netherlands are substantially different from both D614G and each other. In both cases the mutant strain is much slower to rise, occurring over a period of months rather than weeks as was the case with D614G. In both countries, the mutant strain rises exponentially despite the large changes in the overall prevalence of COVID-19 due to changing policies and behaviors during this time. Specifically in the UK, the rise in death incidence after December 14 2020 is preceded by the rapid increase of the B.1.1.7 strain, both in frequency and absolute numbers (<xref rid="fig5" ref-type="fig">Fig 5</xref>). This suggests that the interventions ongoing in the UK were sufficient to bring the background strains below threshold but not B.1.1.7.</p>
<p>To further substantiate this, we calculated the instantaneous effective reproduction number (<italic>R</italic><sub><italic>e</italic></sub>) using the inferred trajectories of the stochastic model (Fig S7). The effective reproduction number of the wild-type fluctuates abound the threshold value 1 between November and December, following the increased NPI (non-pharmaceutical intervention) initiated end October [<xref ref-type="bibr" rid="c34">34</xref>]. As the B.1.1.7 variant has a &#x223C; 50&#x0025; higher reproduction number, these NPI were not sufficient for controlling the growth of the variant, leading to a doubling of the death incidence in January 2021 and the necessity of further stringent restrictions. This suggests that new variants with an increased fitness are particularly dangerous when in-place NPI are only resulting in a marginal control of the epidemic.</p>
<p>As the B.1.1.7 variant was most likely introduced to the Netherlands from the UK, we incorporated external forces of infection in the Netherlands (<italic>&#x03BB;</italic><sub>wt</sub> and <italic>&#x03BB;</italic><sub>mt</sub> in <xref ref-type="disp-formula" rid="eqn5">Eq. (5)</xref>) to account for this fact (see Appendix B). This process allows a source of infection in the Netherlands, governed by rate <italic>&#x03BB;</italic><sub>0</sub> (<xref rid="tbl1" ref-type="table">Table 1</xref>), that is proportional to the prevalence of B.1.1.7 in the UK. We forced the migration process to zero after December 21, 2020 to account for travel restrictions from the UK to the Netherlands. Based on a sample of 100 reconstructed trajectories of the stochastic model (<xref rid="fig5" ref-type="fig">Fig. 5B</xref>, green curves), we estimate that at that time of the travel restriction being in place, 6694&#x2013;10287 individuals were infected with the B.1.1.7 variant in the Netherlands. That is, the model suggests that the establishment of B.1.1.7 in the Netherlands was facilitated by migration from the UK, however, the major factor in the spread of B.1.1.7 in the Netherlands is its selective advantage <italic>s</italic>.</p>
<p>The profile likelihoods of <italic>s</italic>, the increase in contagiousness for the mutant variant, for the D614G and B.1.1.7 are shown in <xref rid="fig6" ref-type="fig">Fig. 6</xref> and <xref rid="fig7" ref-type="fig">7</xref>. The profile likelihoods show well constrained estimates of <italic>s</italic>. In general the confidence intervals in the mechanistic model are comparable with or more narrow than the population genetic model, which is consistent with the model being both more constrained and using more data. In addition, the population genetics model takes the uncertainty in the average length of the generation interval into account. The point estimates of <italic>s</italic> from both models are close to one another with the largest difference being about 0.12 for B.1.1.7 in the UK. Point estimates of the other model parameters are listed in <xref rid="tbl1" ref-type="table">Table 1</xref>. The fact that the population genetics model results in smaller estimates of <italic>s</italic> in some cases can be understand by looking at the population dynamics. The emergence of the variant is in all cases followed by increased NPI, leading to a decrease in the number of infected individuals, and also the relative growth rate of the variant. This is interpreted by the population genetics model as a smaller selection coefficient.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6:</label>
<caption><p>Profile likelihood for the selection effect of D614G in the UK and Netherlands. The maximum likelihood estimate (MLE) is indicated by a dashed line and the 95&#x0025;CI is indicated by a grey box. For the UK, we estimated a selection coefficient <italic>s</italic> = 0.28 (95&#x0025; CI: [0.23, 0.33]), and for the Netherlands we estimated <italic>s</italic> = 0.27 (95&#x0025; CI: [0.20, 0.35]). The red box plots show the estimates from the population genetics model (<xref rid="fig3" ref-type="fig">Fig. 3</xref>).</p></caption>
<graphic xlink:href="21254233v1_fig6.tif"/>
</fig>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7:</label>
<caption><p>Profile likelihood for the selection effect of B.1.1.7 in the UK and Netherlands. The MLE is indicated by a dashed line and the 95&#x0025;CI is indicated by a grey box. For the UK, we estimated a selection coefficient <italic>s</italic> = 0.55 (95&#x0025; CI: [0.50, 0.60]), and for the Netherlands we estimated <italic>s</italic> = 0.28 (95&#x0025; CI: [0.20, 0.38]). The red box plots show the estimates from the population genetics model (<xref rid="fig3" ref-type="fig">Fig. 3</xref>).</p></caption>
<graphic xlink:href="21254233v1_fig7.tif"/>
</fig>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>We have illustrated three different approaches to measuring selection effects from the global SARS-CoV-2 genetic sequence data. Our analyses all point to very strong but heterogeneous selective advantages for the D614G and variants at the country level, even allowing for both migration and drift. It is important to note that our methods look for an advantage of a given variant over whatever variants are circulating at the time, rather than against a fixed reference strain. This means that the estimates of a fitness advantage of B.1.1.7 in many countries is relative to a background that consists mostly of D614G. Thus, the fitness of B.1.1.7 exceeds that of D614G, which itself exceeds the original genotype. Our stochastic epidemiologic model suggests that the level of transmissibility of currently circulating variants is sufficient to reduce the qualitative effect of non-pharmaceutical interventions (NPIs) in Europe.</p>
<p>SARS-CoV-2 is rapidly adapting to its new human hosts, and strains with elevated contagiousness will likely continue to emerge as the virus continues to adapt. This situation is challenging as elevated contagiousness narrows the range under which vaccination programs can eliminate the virus, and it also opens up the possibility of escape mutations allowing infection among vaccinated persons. Integrating molecular epidemiology surveillance into SARS-CoV-2 pipelines is essential for not only monitoring the emergence of new strains, but for establishing an early warning system to monitor for escape mutations in the era of vaccine roll-out. Each approach that we examined has its own strengths and weaknesses for how it can fit into an expanded molecular epidemiology surveillance system.</p>
<p>The isotonic regression method is easy to compute and based on the very straightforward premise that a consistent selective advantage should produce a continually increasing frequency of the new variant in all countries where it has been observed. However, because the method is based on a hypothesis-testing framework, there is no way to determine the strength of selection relative to the background strains. Likewise, the method could be misleading in a context where the genetic background is rapidly changing (e.g., other strains under positive selection are introduced into the population during the study period). We believe that a regression-based approach is, nevertheless, very useful for rapidly evaluating evidence of selection potentially in large-scale molecular surveillance pipelines.</p>
<p>The population genetic model is more mechanistically explicit than the regression approach and, therefore, gives a direct estimate of the selection effect. The model also allowed us to integrate a simple migration process and to jointly estimate the parameters of selection and migration. The population genetic model is also simple enough that it was coded in a popular statistical language and fit to the global data in a matter of hours on a standard laptop computer. Its framework to estimate country-level selection effects shaped by an overall global distribution makes it potentially quite useful for general molecular surveillance purposes. However the primary weakness of the population genetic model is that it does not account for random fluctuations in the underlying populations, which, given that the point of estimating selection effects in near real-time is to give warning before the new variant becomes widespread, is potentially a problem.</p>
<p>The stochastic mechanistic model solves this problem by explicitly modeling stochastic effects that could produce changes in variant frequency by chance alone, in addition to selection and migration. Our approach takes this idea one step further by allowing noise above what would be expected in a typical homogeneous stochastic model; our logic behind this choice is that the epidemiological model assumes homogeneous mixing at the state level, which we know to be unrealistic. In reality, transmission is occurring at much smaller local scales that can lead to sudden jumps in both the number of cases and number of observed variants; allowing for extra noise in the stochastic model makes the method less sensitive to mis-specifications such as an over-simplified population structure. Despite being more complex and using additional data, we found that the mechanistic model was in agreement with the population genetic model, suggesting that the population genetic model is a reasonable balance between computability and accuracy.</p>
<p>All of our models (and most of the other published models) make the assumption that genomes are selected at random from the set of all possible cases. If, for example, samples were sequenced specifically because they were in contact with someone that was known to be infected by the variant under study, the data may be biased toward over-estimating the spread and hence selective advantage of the new variant. There is almost certainly some bias from the non-random processes by which samples are obtained and sequenced; however, we believe that our results are still overall valid for three reasons. First, it is unlikely that the same level of bias from non-random sampling would occur in each country to produce a similar pattern in each country; that is, countries represent semi-independent systems. Second, the evidence for selection effects includes parts of the time series before people were concerned about the spread of new variants, and, therefore, were unlikely to preferentially sequence the new variants. Third, the UK has put effort into developing a representative sample of SARS-CoV-2 genomes in their country and the estimates for the selection effects in the UK for D614G and B.1.1.7 are very close and slightly above the population average for these lineages.</p>
<p>Several studies using other methods have similarly found D614G and B.1.1.7 to each have a selective advantage over other variants circulating contemporaneously [<xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c19">19</xref>, <xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c2">2</xref>]. In contrast, however, van Dorp et al. [<xref ref-type="bibr" rid="c35">35</xref>] found no support for a selective advantage of any of the variants they tested, including D614G. We suspect this is because their statistical test required the repeated emergence of a variant in order to draw any power. Although phylogenetic replication is an appropriate requirement in many situations, it is too conservative for identifying variants of concern on the timescale at which they emerge. Instead, to test for a selective advantage of variants that have arisen only once, power can be obtained from fitting explicitly epidemiological models within one location (e.g., our stochastic model, and others [<xref ref-type="bibr" rid="c19">19</xref>, <xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c2">2</xref>]) or looking for consistent effects in multiple locations with largely-distinct conditions (e.g., our isotonic regression and population genetic models, and Korber et al. [<xref ref-type="bibr" rid="c10">10</xref>]).</p>
<p>A central question in any modelling endeavor is how much detail is required to accurately address the problem in question. In the last year, a large number of models have been developed to study various aspects of the SARS-CoV-2 pandemic, ranging from very simple [<xref ref-type="bibr" rid="c25">25</xref>] to extremely detailed [<xref ref-type="bibr" rid="c12">12</xref>]. For the purpose of estimating selective advantages of variants, we argued that (relatively) simple models are sufficient. With our most complex model, we took a pragmatic approach and incorporated an additional noise term that can account for some of the unavoidable model misspecification. Such a noise term could potentially also be included in methods that allow for more efficient Bayesian inference with stochastic models [<xref ref-type="bibr" rid="c36">36</xref>].</p>
<p>The emergence of new variants with increased contagiousness or resistance mutations has the potential for significant implications for control of COVID-19 especially given that very few countries have been able to use NPIs alone to bring the viral growth rate sub-critical for extended periods of time. Integrating modeling into surveillance systems will help facilitate early-warning systems and improve our ability to design both pharmaceutical and non-pharmaceutical interventions that can stop the spread of COVID-19.</p>
</sec>
<sec sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material>
<label>Supporting Information</label>
<media xlink:href="supplements/254233_file02.pdf" />
</supplementary-material>
</sec>
</body>
<back>
<sec sec-type="data-availability">
<title>Data Availability</title>
<p>All data and scripts are publicly available</p>
<p>
<ext-link ext-link-type="uri" xlink:href="https://github.com/eeg-lanl/sarscov2-selection">https://github.com/eeg-lanl/sarscov2-selection</ext-link>
</p>
</sec>
<ack>
<title>Acknowledgements</title>
<p>Portions of this work were done under the auspices of the U.S. Department of Energy under contract 89233218CNA000001 and supported by National Institutes of Health (<ext-link ext-link-type="uri" xlink:href="http://www.nih.gov">www.nih.gov</ext-link>) grants P01-AI131365, R01-OD011095, and R01-AI028433 (CHvD). RK, NH, and ERS were funded by the US National Science Foundation RAPID grant PHY-2031756.</p>
</ack>
<ref-list>
<title>Literature Cited</title>
<ref id="c1"><label>[1]</label><mixed-citation publication-type="journal"><string-name><surname>Tegally</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal> <article-title>Emergence and rapid spread of a new severe acute respiratory syndrome-related coronavirus 2 (SARS-CoV-2) lineage with multiple spike mutations in South Africa</article-title>. <source>medRxiv</source> (<year>2020</year>).</mixed-citation></ref>
<ref id="c2"><label>[2]</label><mixed-citation publication-type="journal"><string-name><surname>Volz</surname>, <given-names>E.</given-names></string-name> <etal>et al.</etal> <article-title>Transmission of SARS-CoV-2 lineage B.1.1.7 in England: Insights from linking epidemiological and genetic data</article-title>. <source>medRxiv</source> (<year>2021</year>).</mixed-citation></ref>
<ref id="c3"><label>[3]</label><mixed-citation publication-type="journal"><string-name><surname>Volz</surname>, <given-names>E.</given-names></string-name> <etal>et al.</etal> <article-title>Evaluating the Effects of SARS-CoV-2 Spike Mutation D614G on Transmissibility and Pathogenicity</article-title>. <source>Cell</source> <volume>184</volume>, <fpage>64</fpage>&#x2013;<lpage>75</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c4"><label>[4]</label><mixed-citation publication-type="journal"><string-name><surname>Dearlove</surname>, <given-names>B.</given-names></string-name> <etal>et al.</etal> <article-title>A SARS-CoV-2 vaccine candidate would likely match all currently circulating variants</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>117</volume>, <fpage>23652</fpage>&#x2013;<lpage>23662</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c5"><label>[5]</label><mixed-citation publication-type="journal"><string-name><surname>Fontanet</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>SARS-CoV-2 variants and ending the COVID-19 pandemic</article-title>. <source>Lancet</source> (<year>2021</year>).</mixed-citation></ref>
<ref id="c6"><label>[6]</label><mixed-citation publication-type="journal"><string-name><surname>McCarthy</surname>, <given-names>K. R.</given-names></string-name> <etal>et al.</etal> <article-title>Recurrent deletions in the SARS-CoV-2 spike glycoprotein drive antibody escape</article-title>. <source>Science</source> (<year>2021</year>).</mixed-citation></ref>
<ref id="c7"><label>[7]</label><mixed-citation publication-type="journal"><string-name><surname>Wibmer</surname>, <given-names>C. K.</given-names></string-name> <etal>et al.</etal> <article-title>SARS-CoV-2 501Y.V2 escapes neutralization by South African COVID-19 donor plasma</article-title>. <source>bioRxiv</source> (<year>2021</year>).</mixed-citation></ref>
<ref id="c8"><label>[8]</label><mixed-citation publication-type="journal"><string-name><surname>Weisblum</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal> <article-title>Escape from neutralizing antibodies by SARS-CoV-2 spike protein variants</article-title>. <source>eLife</source> <volume>9</volume>, <fpage>e61312</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c9"><label>[9]</label><mixed-citation publication-type="journal"><string-name><surname>Grubaugh</surname>, <given-names>N. D.</given-names></string-name> <etal>et al.</etal> <article-title>Tracking virus outbreaks in the twenty-first century</article-title>. <source>Nat Microbiol</source> <volume>4</volume>, <fpage>10</fpage>&#x2013;<lpage>19</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c10"><label>[10]</label><mixed-citation publication-type="journal"><string-name><surname>Korber</surname>, <given-names>B.</given-names></string-name> <etal>et al.</etal> <article-title>Tracking Changes in SARS-CoV-2 Spike: Evidence that D614G Increases Infectivity of the COVID-19 Virus</article-title>. <source>Cell</source> <volume>182</volume>, <fpage>812</fpage>&#x2013;<lpage>827</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c11"><label>[11]</label><mixed-citation publication-type="journal"><string-name><surname>Yurkovetskiy</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal> <article-title>Structural and Functional Analysis of the D614G SARS-CoV-2 Spike Protein Variant</article-title>. <source>Cell</source> <volume>183</volume>, <fpage>739</fpage>&#x2013;<lpage>751</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c12"><label>[12]</label><mixed-citation publication-type="journal"><string-name><surname>Davies</surname>, <given-names>N. G.</given-names></string-name> <etal>et al.</etal> <article-title>Estimated transmissibility and impact of SARS-CoV-2 lineage B.1.1.7 in England</article-title>. <source>Science</source> (<year>2021</year>).</mixed-citation></ref>
<ref id="c13"><label>[13]</label><mixed-citation publication-type="journal"><string-name><surname>Davies</surname>, <given-names>N. G.</given-names></string-name> <etal>et al.</etal> <article-title>Increased mortality in community-tested cases of SARS-CoV-2 lineage B.1.1.7</article-title>. <source>Nature</source> (<year>2021</year>).</mixed-citation></ref>
<ref id="c14"><label>[14]</label><mixed-citation publication-type="journal"><string-name><surname>Dong</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Du</surname>, <given-names>H.</given-names></string-name> &#x0026; <string-name><surname>Gardner</surname>, <given-names>L.</given-names></string-name> <article-title>An interactive web-based dashboard to track COVID-19 in real time</article-title>. <source>The Lancet Infectious Diseases</source> <volume>20</volume>, <fpage>533</fpage>&#x2013;<lpage>534</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c15"><label>[15]</label><mixed-citation publication-type="website"><collab>COVID-19 Viral Genome Analysis Pipeline</collab>. <ext-link ext-link-type="uri" xlink:href="https://cov.lanl.gov">https://cov.lanl.gov</ext-link> (<year>2020</year>).</mixed-citation></ref>
<ref id="c16"><label>[16]</label><mixed-citation publication-type="journal"><string-name><surname>Elbe</surname>, <given-names>S.</given-names></string-name> &#x0026; <string-name><surname>Buckland-Merrett</surname>, <given-names>G.</given-names></string-name> <article-title>Data, disease and diplomacy: GISAID&#x2019;s innovative contribution to global health</article-title>. <source>Glob Chall</source> <volume>1</volume>, <fpage>33</fpage>&#x2013;<lpage>46</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c17"><label>[17]</label><mixed-citation publication-type="website"><collab>Global Initiative on Sharing All Influenza Data</collab>. <ext-link ext-link-type="uri" xlink:href="http://www.gisaid.org/">http://www.gisaid.org/</ext-link> (<year>2008</year>).</mixed-citation></ref>
<ref id="c18"><label>[18]</label><mixed-citation publication-type="journal"><string-name><surname>Liao</surname>, <given-names>X.</given-names></string-name> &#x0026; <string-name><surname>Meyer</surname>, <given-names>M. C.</given-names></string-name> <article-title>cgam: An r package for the constrained generalized additive model</article-title>. <source>Journal of Statistical Software, Articles</source> <volume>89</volume>, <fpage>1</fpage>&#x2013;<lpage>24</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c19"><label>[19]</label><mixed-citation publication-type="journal"><string-name><surname>Chen</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal> <article-title>Quantification of the spread of SARS-CoV-2 variant B.1.1.7 in Switzerland</article-title>. <source>medRxiv</source> (<year>2021</year>).</mixed-citation></ref>
<ref id="c20"><label>[20]</label><mixed-citation publication-type="journal"><string-name><surname>Ali</surname>, <given-names>S. T.</given-names></string-name> <etal>et al.</etal> <article-title>Serial interval of SARS-CoV-2 was shortened over time by nonpharmaceutical interventions</article-title>. <source>Science</source> <volume>369</volume>, <fpage>1106</fpage>&#x2013;<lpage>1109</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c21"><label>[21]</label><mixed-citation publication-type="journal"><string-name><surname>Carpenter</surname>, <given-names>B.</given-names></string-name> <etal>et al.</etal> <article-title>Stan: A probabilistic programming language</article-title>. <source>J. Stat. Softw</source>. <volume>76</volume>, <fpage>1</fpage>&#x2013;<lpage>32</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c22"><label>[22]</label><mixed-citation publication-type="journal"><string-name><surname>Rozhnova</surname>, <given-names>G.</given-names></string-name> <etal>et al.</etal> <article-title>Model-based evaluation of school-and non-school-related measures to control the COVID-19 pandemic</article-title>. <source>Nature Communications</source> <volume>12</volume>, <fpage>1614</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c23"><label>[23]</label><mixed-citation publication-type="journal"><string-name><surname>Ward</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal> <article-title>Antibody prevalence for SARS-CoV-2 following the peak of the pandemic in england: REACT2 study in 100,000 adults</article-title>. <source>medRxiv</source> (<year>2020</year>).</mixed-citation></ref>
<ref id="c24"><label>[24]</label><mixed-citation publication-type="journal"><string-name><surname>Vos</surname>, <given-names>E. R. A.</given-names></string-name> <etal>et al.</etal> <article-title>Nationwide seroprevalence of SARS-CoV-2 and identification of risk factors in the general population of the Netherlands during the first epidemic wave</article-title>. <source>J Epidemiol Community Health</source> (<year>2020</year>).</mixed-citation></ref>
<ref id="c25"><label>[25]</label><mixed-citation publication-type="journal"><string-name><surname>Sanche</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>High Contagiousness and Rapid Spread of Severe Acute Respiratory Syndrome Coronavirus 2</article-title>. <source>Emerg Infect Dis</source> <volume>26</volume>, <fpage>1470</fpage>&#x2013;<lpage>1477</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c26"><label>[26]</label><mixed-citation publication-type="journal"><string-name><surname>Zhou</surname>, <given-names>F.</given-names></string-name> <etal>et al.</etal> <article-title>Clinical course and risk factors for mortality of adult inpatients with COVID-19 in Wuhan, China: a retrospective cohort study</article-title>. <source>Lancet</source> <volume>395</volume>, <fpage>1054</fpage>&#x2013;<lpage>1062</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c27"><label>[27]</label><mixed-citation publication-type="journal"><string-name><surname>Ali</surname>, <given-names>S. T.</given-names></string-name> <etal>et al.</etal> <article-title>Serial interval of SARS-CoV-2 was shortened over time by nonpharmaceutical interventions</article-title>. <source>Science</source> <volume>369</volume>, <fpage>1106</fpage>&#x2013;<lpage>1109</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c28"><label>[28]</label><mixed-citation publication-type="journal"><string-name><surname>Lavezzo</surname>, <given-names>E.</given-names></string-name> <etal>et al.</etal> <article-title>Suppression of a SARS-CoV-2 outbreak in the Italian municipality of Vo&#x2019;</article-title>. <source>Nature</source> <volume>584</volume>, <fpage>425</fpage>&#x2013;<lpage>429</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c29"><label>[29]</label><mixed-citation publication-type="journal"><string-name><surname>Wu</surname>, <given-names>J. T.</given-names></string-name> <etal>et al.</etal> <article-title>Estimating clinical severity of COVID-19 from the transmission dynamics in Wuhan, China</article-title>. <source>Nat Med</source> <volume>26</volume>, <fpage>506</fpage>&#x2013;<lpage>510</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c30"><label>[30]</label><mixed-citation publication-type="journal"><string-name><surname>Verity</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal> <article-title>Estimates of the severity of coronavirus disease 2019: a model-based analysis</article-title>. <source>Lancet Infect Dis</source> <volume>20</volume>, <fpage>669</fpage>&#x2013;<lpage>677</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c31"><label>[31]</label><mixed-citation publication-type="journal"><string-name><surname>Grasselli</surname>, <given-names>G.</given-names></string-name> <etal>et al.</etal> <article-title>Baseline Characteristics and Outcomes of 1591 Patients Infected With SARS-CoV-2 Admitted to ICUs of the Lombardy Region, Italy</article-title>. <source>JAMA</source> <volume>323</volume>, <fpage>1574</fpage>&#x2013;<lpage>1581</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c32"><label>[32]</label><mixed-citation publication-type="journal"><string-name><surname>Ionides</surname>, <given-names>E. L.</given-names></string-name>, <string-name><surname>Nguyen</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Atchad&#x00E9;</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Stoev</surname>, <given-names>S.</given-names></string-name> &#x0026; <string-name><surname>King</surname>, <given-names>A.</given-names></string-name> <article-title>A. Inference for dynamic and latent variable models via iterated, perturbed Bayes maps</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>112</volume>, <fpage>719</fpage>&#x2013;<lpage>724</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c33"><label>[33]</label><mixed-citation publication-type="book"><string-name><surname>van Kampen</surname>, <given-names>N. G.</given-names></string-name> <source>Stochastic processes in physics and chemistry</source>. <publisher-name>Elsevier</publisher-name>, <publisher-loc>Amsterdam, 3rd edition</publisher-loc> (<year>2007</year>).</mixed-citation></ref>
<ref id="c34"><label>[34]</label><mixed-citation publication-type="journal"><string-name><surname>Hale</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Webster</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Petherick</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Phillips</surname>, <given-names>T.</given-names></string-name> &#x0026; <string-name><surname>Kira</surname>, <given-names>B.</given-names></string-name> <source>Oxford COVID-19 Government Response Tracker</source> (<year>2020</year>).</mixed-citation></ref>
<ref id="c35"><label>[35]</label><mixed-citation publication-type="journal"><string-name><surname>van Dorp</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal> <article-title>No evidence for increased transmissibility from recurrent mutations in SARS-CoV-2</article-title>. <source>Nature Communications</source> <volume>11</volume>, <fpage>5986</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c36"><label>[36]</label><mixed-citation publication-type="other"><string-name><surname>Fintzi</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal> <article-title>Using multiple data streams to estimate and forecast SARS-CoV-2 transmission dynamics, with application to the virus spread in Orange County, California</article-title> (<year>2020</year>).</mixed-citation></ref>
<ref id="c37"><label>[37]</label><mixed-citation publication-type="book"><string-name><surname>Mumford</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Series</surname>, <given-names>C.</given-names></string-name> &#x0026; <string-name><surname>Wright</surname>, <given-names>D.</given-names></string-name> <source>Indra&#x2019;s Pearls: The Vision of Felix Klein</source>. <publisher-name>Cambridge University Press</publisher-name> (<year>2002</year>).</mixed-citation></ref>
<ref id="c38"><label>[38]</label><mixed-citation publication-type="confproc"><string-name><surname>Douc</surname>, <given-names>R.</given-names></string-name> &#x0026; <string-name><surname>Cappe</surname>, <given-names>O.</given-names></string-name> <article-title>Comparison of resampling schemes for particle filtering</article-title>. In <source>ISPA 2005</source>. <conf-name>Proceedings of the 4th International Symposium on Image and Signal Processing and Analysis</conf-name>, <volume>2005</volume>., <fpage>64</fpage>&#x2013;<lpage>69</lpage> (<year>2005</year>).</mixed-citation></ref>
</ref-list>
<app-group>
<app id="app1">
<label>Appendix A</label>
<title>Population genetics model</title>
<sec id="s4">
<title>Variant frequencies over time</title>
<p>Here we derive the equation for the mutant frequency <italic>p</italic><sub><italic>n</italic></sub> as a function of the generation <italic>n</italic> under the population genetics model with both selection and migration (<xref ref-type="disp-formula" rid="eqn4">Eq 4</xref>). In the main text, we derived that the new variant&#x2019;s frequency <italic>p</italic>&#x2032; in the next generation is
<disp-formula id="eqn15">
<alternatives><graphic xlink:href="21254233v1_eqnA1.gif"/></alternatives>
</disp-formula>
We can write this slightly differently as a M&#x00F6;bius transformation of <italic>p</italic>:
<disp-formula id="eqn16">
<alternatives><graphic xlink:href="21254233v1_eqnA2.gif"/></alternatives>
</disp-formula>
In general a M&#x00F6;bius transformation has the form
<disp-formula id="eqn17">
<alternatives><graphic xlink:href="21254233v1_eqnA3.gif"/></alternatives>
</disp-formula>
and it has the nice property that <italic>A</italic> &#x00B7; (<italic>B</italic> &#x00B7; <italic>x</italic>) = (<italic>AB</italic>) &#x00B7; <italic>x</italic> for two matrices <italic>A</italic> and <italic>B</italic> (see e.g., [<xref ref-type="bibr" rid="c37">37</xref>]). Hence, in order to find the variant frequency in the <italic>n</italic>-th generation, we need the <italic>n</italic>-th matrix power of
<disp-formula id="eqn18">
<alternatives><graphic xlink:href="21254233v1_eqnA4.gif"/></alternatives>
</disp-formula>
For this we have to diagonalize <italic>M</italic>. The eigenvalues of <italic>M</italic> are equal to 1 &#x002B; <italic>s</italic> and 1 &#x2212; <italic>m</italic>. Then eigenvectors are given by (1, 1)<sup><italic>T</italic></sup> and (<italic>m</italic>, &#x2212;<italic>s</italic>)<sup><italic>T</italic></sup>. Hence, we can write <italic>M</italic> = <italic>U</italic> &#x039B;<italic>U</italic> <sup>&#x2212;1</sup> where
<disp-formula id="eqn19">
<alternatives><graphic xlink:href="21254233v1_eqnA5.gif"/></alternatives>
</disp-formula>
Then <italic>M</italic><sup><italic>n</italic></sup> &#x00B7; <italic>p</italic><sub>0</sub> = <italic>U</italic> &#x039B;<sup><italic>n</italic></sup><italic>U</italic> <sup>&#x2212;1</sup> &#x00B7; <italic>p</italic><sub>0</sub>, which is equal to
<disp-formula id="eqn20">
<alternatives><graphic xlink:href="21254233v1_eqnA6.gif"/></alternatives>
</disp-formula>
</p>
</sec>
<sec id="s5">
<title>Transformation to the logit scale</title>
<p>To avoid numerical issues during inference, we transform the mutant frequency to the logit-scale, and re-parameterize the model. Let <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline16.gif"/></alternatives></inline-formula> Then
<disp-formula id="eqn21">
<alternatives><graphic xlink:href="21254233v1_eqnA7.gif"/></alternatives>
</disp-formula>
Let <italic>r</italic><sub>0</sub> = <italic>R</italic> &#x00B7; <italic>p</italic><sub>0</sub> and <italic>r</italic><sub><italic>n</italic></sub> = <italic>R</italic> &#x00B7; <italic>p</italic><sub><italic>n</italic></sub>. Then
<disp-formula id="eqn22">
<alternatives><graphic xlink:href="21254233v1_eqnA8.gif"/></alternatives>
</disp-formula>
and we have <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline17.gif"/></alternatives></inline-formula>. Hence,
<disp-formula id="eqn23">
<alternatives><graphic xlink:href="21254233v1_eqnA9.gif"/></alternatives>
</disp-formula>
and therefore
<disp-formula id="eqn24">
<alternatives><graphic xlink:href="21254233v1_eqnA10.gif"/></alternatives>
</disp-formula>
This equation has a removable singularity at <italic>s</italic> = &#x2212;<italic>m</italic>. To see this, we write
<disp-formula id="eqn25">
<alternatives><graphic xlink:href="21254233v1_eqnA11.gif"/></alternatives>
</disp-formula>
Now we define <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline18.gif"/></alternatives></inline-formula> and <italic>&#x00B5;</italic> = <italic>m/</italic>(1 &#x2212; <italic>m</italic>). Then we get the following re-parameterized model:
<disp-formula id="eqn26">
<alternatives><graphic xlink:href="21254233v1_eqnA12.gif"/></alternatives>
</disp-formula>
</p>
</sec>
</app>
<app id="app2">
<label>Appendix B</label>
<title>Stochastic epidemiological model</title>
<sec id="s6">
<title>Time-dependent infection rate</title>
<p>To model the effects of government restrictions such as lock-downs, the infection rate <italic>&#x03B2;</italic> is a (smoothed) piece-wise constant function of time. We allow for <italic>n</italic> &#x2208; {3, 4} epidemic stages to model e.g. unrestricted spread, lockdown, and relaxation of the lockdown [<xref ref-type="bibr" rid="c22">22</xref>]. We let <italic>&#x03B2;</italic> vary smoothly between the epidemic stages, thereby allowing for an uptake period for (release of) restrictions. More precisely, <italic>&#x03B2;</italic> = <italic>&#x03B2;</italic> (<italic>t</italic>) is defined as
<disp-formula id="eqn27">
<alternatives><graphic xlink:href="21254233v1_eqnB1.gif"/></alternatives>
</disp-formula>
where <italic>H</italic><sub><italic>&#x03C5;</italic></sub> is a smoothed Heaviside function defined by <italic>H</italic><sub><italic>&#x03C5;</italic></sub> (<italic>t</italic>) = (1 &#x002B; exp(&#x2212;<italic>t/&#x03C5;</italic>))<sup>&#x2212;1</sup>, with parameter <italic>&#x03C5;</italic> determining the duration of the transition period between different epidemic stages. The time-varying infection rate <italic>&#x03B2;</italic> is illustrated in Fig. S7A. To determine the parameter <italic>&#x03C5;</italic>, we require that <italic>H</italic><sub><italic>&#x03C5;</italic></sub> (&#x0394;<italic>t/</italic>2) = 95&#x0025;, where &#x0394;<italic>t</italic> is the length of the uptake period. Solving for <italic>&#x03C5;</italic>, we find <italic>&#x03C5;</italic> = &#x0394;<italic>t/</italic>(2 &#x00B7; logit(0.95)). We set &#x0394;<italic>t</italic> = 7 days, hence the uptake period takes a week.</p>
<p>In the case of variant B.1.1.7 in the Netherlands, we added an external force of infection, <italic>&#x03BB;</italic><sub>wt</sub> and <italic>&#x03BB;</italic><sub>mt</sub> for wild-type and mutant respectively, to account for contacts with infectious individuals from the UK. Because the number of infected individuals the UK varied over time, the external infection forces of infection <italic>&#x03BB;</italic><sub>wt</sub> and <italic>&#x03BB;</italic><sub>mt</sub> depend on time as follows
<disp-formula id="eqn28">
<alternatives><graphic xlink:href="21254233v1_eqnB2.gif"/></alternatives>
</disp-formula>
Here, the trajectories <italic>I</italic><sub>wt</sub>(<italic>t</italic>)<italic>/N</italic>(<italic>t</italic>) and <italic>I</italic><sub>mt</sub>(<italic>t</italic>)<italic>/N</italic>(<italic>t</italic>) correspond to the fraction of individuals in the UK that are infected with wild-type and mutant respectively. The expectation is taken over the filtered trajectories that were reconstructed with the SMC algorithm. Finally, the scaling parameter <italic>&#x03BB;</italic><sub>0</sub> represents the product of the contact rate between individuals in the two countries, and the probability of infection per contact. When we fit the model to the Dutch data, the parameter <italic>&#x03BB;</italic><sub>0</sub> is estimated, but the fraction of infectious UK citizens is assumed known.</p>
</sec>
<sec id="s7">
<title>Initial condition</title>
<p>To complete the description of the dynamic model, we have to specify the initial conditions. Let <italic>&#x03B6;</italic> and <italic>&#x03BE;</italic> denote the fractions of infected and removed individuals at time <italic>t</italic><sub>0</sub>, respectively. To determine the correct balance between exposed, infectious, and severely infected individuals, we compute the eigenvalues of the Jacobian matrix of the infinite population limit of the MJP model. The linearized system without the S and R compartments around the disease-free steady state with <italic>S</italic> = (1 &#x2212; <italic>&#x03BE;</italic>)<italic>N</italic> and <italic>R</italic> = <italic>&#x03BE; N</italic> equals
<disp-formula id="eqn29">
<alternatives><graphic xlink:href="21254233v1_eqnB3.gif"/></alternatives>
</disp-formula>
We use the eigenvector <italic>X</italic><sub>0</sub> = (<italic>E</italic><sub>0</sub>, <italic>I</italic><sub>0</sub>, <italic>H</italic><sub>0</sub>)<sup><italic>T</italic></sup> with <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline19.gif"/></alternatives></inline-formula> corresponding to the dominant eigenvalue of the Jacobian matrix in <xref ref-type="disp-formula" rid="eqn29">Eq. (B-3)</xref> to define the initial condition of the model. The parameter <italic>p</italic><sub>0</sub> determines the initial fraction of infections with the mutant virus, and hence we have <italic>E</italic><sub>mt,0</sub> = <italic>p</italic><sub>0</sub><italic>E</italic><sub>0</sub>, <italic>I</italic><sub>mt,0</sub> = <italic>p</italic><sub>0</sub><italic>I</italic><sub>0</sub>, <italic>E</italic><sub>wt,0</sub> = (1 &#x2212; <italic>p</italic><sub>0</sub>)<italic>E</italic><sub>0</sub>, and <italic>I</italic><sub>wt,0</sub> = (1 &#x2212; <italic>p</italic><sub>0</sub>)<italic>I</italic><sub>0</sub>. We then set <italic>S</italic><sub>0</sub> = (1 &#x2212; <italic>&#x03BE;</italic> &#x2212; <italic>&#x03B6;</italic>)<italic>N</italic> and <italic>R</italic><sub>0</sub> = <italic>&#x03BE; N</italic>. Finally, the initial state of the stochastic model is randomized by sampling from a Poisson distribution with mean equal to the deterministic initial value.</p>
</sec>
<sec id="s8">
<title>Hybrid model simulation</title>
<p>Because for small population sizes the diffusion approximation defined by the system of SDEs in <xref ref-type="disp-formula" rid="eqn9">Eq. (9)</xref> breaks down, as it e.g., does not allow for fixation of the mutant, we model small population sizes discretely using an adaptive tau-leap approximation of the Markov jump process (<xref ref-type="disp-formula" rid="eqn5">Eq. (5)</xref>). Hence, we implemented a hybrid algorithm in which variables can switch between a discrete and continuous type.</p>
<p>At any particular time <italic>t</italic>, the system consists of continuous components <italic>X</italic><sup><italic>i</italic></sup> for <italic>i</italic> &#x2208; <italic>&#x1D49E;</italic> (<italic>t</italic>) and discrete elements <italic>X</italic><sup><italic>i</italic></sup> for <italic>i</italic> &#x2208; <italic>&#x1D49F;</italic> (<italic>t</italic>) = {1,&#x2026;, <italic>n</italic>} \ <italic>&#x1D49E;</italic> (<italic>t</italic>). Since for <italic>i</italic> &#x2208; <italic>&#x1D49E;</italic> (<italic>t</italic>), the continuous element <italic>X</italic><sup><italic>i</italic></sup>(<italic>t</italic>) is generally non-constant, the transition rates <italic>&#x03B7;</italic><sub><italic>j</italic></sub>(<italic>X, t</italic>) will in general be time dependent. This means that we have to integrate the following system of SDEs and ODEs
<disp-formula id="eqn30">
<alternatives><graphic xlink:href="21254233v1_eqnB4.gif"/></alternatives>
</disp-formula>
Hence, we have to keep track of those transition rates <italic>&#x03B7;</italic><sub><italic>j</italic></sub> for which the increment <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline20.gif"/></alternatives></inline-formula> is non-zero for a discrete com-ponent <italic>X</italic><sup><italic>i</italic></sup>. The initial conditions for the hybrid system Eq B-4 are given by <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline21.gif"/></alternatives></inline-formula> and <italic>H</italic><sub><italic>j</italic></sub>(<italic>t</italic><sub><italic>m</italic></sub>) = 0. We then integrate the system until time <italic>t</italic><sub><italic>m</italic>&#x002B;1</sub> = <italic>t</italic><sub><italic>m</italic></sub> &#x002B; <italic>h</italic><sub><italic>m</italic></sub>. At this point, we sample the number of stochastic events <italic>Y</italic><sub><italic>m</italic></sub> that occurred in the time interval (<italic>t</italic><sub><italic>m</italic></sub>, <italic>t</italic><sub><italic>m</italic>&#x002B;1</sub>], from the Poisson distribution
<disp-formula id="eqn31">
<alternatives><graphic xlink:href="21254233v1_eqnB5.gif"/></alternatives>
</disp-formula>
Thereafter, <italic>Y</italic><sub><italic>m</italic></sub> events with index <italic>j</italic> are sampled from the categorical distribution, with probability proportional to the cumulative transition rate <italic>H</italic><sub><italic>j</italic></sub>(<italic>t</italic><sub><italic>m</italic>&#x002B;1</sub>). The increments <italic>&#x03B5;</italic> <sub><italic>j</italic></sub> are then added to the discrete part of the state <italic>X</italic>
<disp-formula id="eqn32">
<alternatives><graphic xlink:href="21254233v1_eqnB6.gif"/></alternatives>
</disp-formula>
After applying these <italic>Y</italic><sub><italic>m</italic></sub> discrete transitions, we have to re-evaluate which components of the state are discrete and which are continuous. We choose a fixed threshold <italic>T</italic> = 50 below and above the populations are discrete and continuous, respectively. Hence, at time <italic>t</italic><sub><italic>m</italic>&#x002B;1</sub> we update the partition of {1,&#x2026;, <italic>n</italic>} as follows
<disp-formula id="eqn33">
<alternatives><graphic xlink:href="21254233v1_eqnB7.gif"/></alternatives>
</disp-formula>
Finally, we set the next initial condition <italic>x</italic><sub><italic>m</italic>&#x002B;1</sub> = <italic>X</italic> (<italic>t</italic><sub><italic>m</italic>&#x002B;1</sub>) and <italic>H</italic>(<italic>t</italic><sub><italic>m</italic>&#x002B;1</sub>) = 0 and repeat the process.</p>
<p>The tau-leap step size <italic>h</italic><sub><italic>m</italic></sub> is chosen adaptively such that the expected number of events &#x1D53C;[<italic>Y</italic><sub><italic>m</italic></sub>] within each <italic>&#x03C4;</italic>-leap interval (<italic>t</italic><sub><italic>m</italic></sub>, <italic>t</italic><sub><italic>m</italic>&#x002B;1</sub>] is approximately equal to 1. To accomplish this, we choose
<disp-formula id="eqn34">
<alternatives><graphic xlink:href="21254233v1_eqnB8.gif"/></alternatives>
</disp-formula>
where <italic>h</italic><sub>max</sub> = 1d. Between jumps, the hybrid system (Eq B-4) is integrated using the Euler-Mayurama method with a step size of min{0.01, <italic>h</italic><sub><italic>m</italic></sub>}.</p>
</sec>
<sec id="s9">
<title>Sequential Monte-Carlo</title>
<p>The method used for inference is described in full detail and generality elsewhere [<xref ref-type="bibr" rid="c32">32</xref>]. Here we give a brief description highlighting some of the choices made for this particular model and data set.</p>
<p>In order to reconstruct the latent epidemic trajectories <italic>X</italic>, given the observed data <italic>O</italic>, consisting of death in-cidence data <italic>D</italic> and genetic data <italic>F</italic><sup>mt</sup> and <italic>F</italic>, we use sequential Monte-Carlo (SMC). We simulate <italic>J</italic> = 10<sup>4</sup> replicates of the model (particles) forward in time from one observation time (<italic>t</italic><sub><italic>i</italic>&#x2212;1</sub>) to the next (<italic>t</italic><sub><italic>i</italic></sub>), each with different initial conditions <italic>X</italic><sub><italic>j</italic></sub>(<italic>t</italic><sub><italic>i</italic>&#x2212;1</sub>). Given each of the <italic>J</italic> predicted states <italic>X</italic><sub><italic>j</italic></sub>(<italic>t</italic><sub><italic>i</italic></sub>) of the model at time <italic>t</italic><sub><italic>i</italic></sub>, we calculate the likelihood <italic>w</italic><sub><italic>j</italic></sub> = <italic>L</italic>(<italic>O</italic><sub><italic>i</italic></sub>&#x007C;<italic>X</italic><sub><italic>j</italic></sub>(<italic>t</italic><sub><italic>i</italic></sub>), <italic>&#x03B8;</italic>). We then sample with replacement <italic>J</italic> particles with probability proportional to the weight <italic>w</italic><sub><italic>j</italic></sub> using a systematic resampling method [<xref ref-type="bibr" rid="c38">38</xref>]. The re-sampled particles are used as initial condition at time <italic>t</italic><sub><italic>i</italic></sub>, and we repeat the above steps until we reach the final observation.</p>
<p>The Monte-Carlo estimate of the conditional likelihood of observation <italic>O</italic><sub><italic>i</italic></sub>&#x007C;<italic>O</italic><sub><italic>i</italic>&#x2212;1</sub>, is given by the average of the weights
<disp-formula id="eqn35">
<alternatives><graphic xlink:href="21254233v1_eqnB9.gif"/></alternatives>
</disp-formula>
where we write <italic>L</italic>(<italic>O</italic><sub>1</sub>&#x007C;<italic>O</italic><sub>0</sub>, <italic>&#x03B8;</italic>) &#x2261; <italic>L</italic>(<italic>O</italic><sub>1</sub>&#x007C;<italic>&#x03B8;</italic>). The total likelihood of the time series given <italic>&#x03B8;</italic> is equal to
<disp-formula id="eqn36">
<alternatives><graphic xlink:href="21254233v1_eqnB10.gif"/></alternatives>
</disp-formula>
All likelihood computations are done on the log-scale to minimize floating-point errors.</p>
<p>To estimate parameters, we extended the state <italic>X</italic> with the parameter vector <italic>&#x03B8;</italic>, allowing the parameters to be perturbed after each observation time. For the <italic>j</italic>-th particle, we now have a state (<italic>X</italic><sub><italic>j</italic></sub>, <italic>&#x03B8;</italic><sub><italic>j</italic></sub>), and weight <italic>w</italic><sub><italic>j</italic></sub> = <italic>L</italic>(<italic>O</italic><sub><italic>i</italic></sub>&#x007C;<italic>X</italic><sub><italic>j</italic></sub>(<italic>t</italic><sub><italic>i</italic></sub>), <italic>&#x03B8;</italic><sub><italic>j</italic></sub>). The extended-SMC algorithm is then iterated <italic>M</italic> = 200 times, and after each iteration <italic>m</italic> the magnitude of the parameter perturbations is reduced. The perturbations are Gaussian <italic>&#x03B8;</italic><sub><italic>j</italic></sub> 1&#x21A6; <italic>&#x03B8;</italic><sub><italic>j</italic></sub> &#x002B; <italic>a</italic><sup><italic>m</italic></sup><italic>&#x03B5;</italic>, with <italic>&#x03B5;</italic> &#x223C; <italic>&#x1D4A9;</italic> (0, &#x03A3;). Here, &#x03A3; is a diagonal matrix with diagonal elements given in Table S1. For bounded parameters, the perturbations are reflected in the boundary of the domain. The ratio <italic>a</italic> &#x2208; (0, 1) reduces the magnitude of the parameter perturbations. We choose <inline-formula><alternatives><inline-graphic xlink:href="21254233v1_inline22.gif"/></alternatives></inline-formula> such that after <italic>M</italic> iterations the magnitude of the perturbations is reduced by 99&#x0025;. After each iteration of the extended-SMC algorithm, for each particle we reset the state <italic>X</italic><sub><italic>j</italic></sub> to the a randomly sampled initial state of the epidemic model, while <italic>&#x03B8;</italic><sub><italic>j</italic></sub> is inherited from the previous extended-SMC iteration. To speed-up the computations, we implemented the model and SMC algorithm in C&#x002B;&#x002B; and used multi-threading to update particles between observations in parallel.</p>
</sec>
</app>
</app-group>
</back>
</article>