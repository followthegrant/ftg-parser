<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2d1 20170631//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="article" dtd-version="1.2d1" specific-use="production" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">MEDRXIV</journal-id>
<journal-title-group>
<journal-title>medRxiv</journal-title>
<abbrev-journal-title abbrev-type="publisher">medRxiv</abbrev-journal-title>
</journal-title-group>
<publisher>
<publisher-name>Cold Spring Harbor Laboratory</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1101/2020.10.29.20222539</article-id>
<article-version>1.1</article-version>
<article-categories>
<subj-group subj-group-type="hwp-journal-coll">
<subject>Ophthalmology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>AI-Powered Effective Lens Position Prediction Improves the Accuracy of Existing Lens Formulas</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2559-184X</contrib-id>
<name><surname>Li</surname><given-names>Tingyang</given-names></name>
<degrees>BS</degrees>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Stein</surname><given-names>Joshua D.</given-names></name>
<degrees>MD, MS</degrees>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7501-7198</contrib-id>
<name><surname>Nallasamy</surname><given-names>Nambi</given-names></name>
<degrees>MD</degrees>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="corresp" rid="cor1">&#x002A;</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Computational Medicine and Bioinformatics, University of Michigan</institution></aff>
<aff id="a2"><label>2</label><institution>Kellogg Eye Center, Department of Ophthalmology and Visual Sciences, University of Michigan</institution></aff>
<aff id="a3"><label>3</label><institution>Center for Eye Policy and Innovation, University of Michigan</institution>, Ann Arbor, MI</aff>
<aff id="a4"><label>4</label><institution>Department of Health Management and Policy, University of Michigan School of Public Health</institution>, Ann Arbor, MI</aff>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>&#x002A;</label>Corresponding Author: Nambi Nallasamy, MD, Kellogg Eye Center, University of Michigan, 1000 Wall St, Ann Arbor, MI 48105, Phone: (734) 763-5506, Fax: (734) 936-2340 <email>nnallasa@med.umich.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<year>2020</year>
</pub-date>
<elocation-id>2020.10.29.20222539</elocation-id>
<history>
<date date-type="received">
<day>29</day>
<month>10</month>
<year>2020</year>
</date>
<date date-type="rev-recd">
<day>29</day>
<month>10</month>
<year>2020</year>
</date>
<date date-type="accepted">
<day>03</day>
<month>11</month>
<year>2020</year>
</date>
</history>
<permissions>
<copyright-statement>&#x00A9; 2020, Posted by Cold Spring Harbor Laboratory</copyright-statement>
<copyright-year>2020</copyright-year>
<license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><license-p>This pre-print is available under a Creative Commons License (Attribution-NonCommercial-NoDerivs 4.0 International), CC BY-NC-ND 4.0, as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/">http://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link></license-p></license>
</permissions>
<self-uri xlink:href="20222539.pdf" content-type="pdf" xlink:role="full-text"/>
<abstract>
<title>ABSTRACT</title>
<sec>
<title>Aims</title>
<p>To assess whether incorporating a machine learning (ML) method for accurate prediction of postoperative anterior chamber depth (ACD) improves the refraction prediction performance of existing intraocular lens (IOL) calculation formulas.</p></sec>
<sec>
<title>Methods</title>
<p>A dataset of 4806 cataract patients were gathered at the Kellogg Eye Center, University of Michigan, and split into a training set (80&#x0025; of patients, 5761 eyes) and a testing set (20&#x0025; of patients, 961 eyes). A previously developed ML-based method was used to predict the postoperative ACD based on preoperative biometry. This ML-based postoperative ACD was integrated into new effective lens position (ELP) predictions using regression models to rescale the ML output for each of four existing formulas (Haigis, Hoffer Q, Holladay, and SRK/T). The performance of the formulas with ML-modified ELP was compared using a testing dataset. Performance was measured by the mean absolute error (MAE) in refraction prediction.</p></sec>
<sec>
<title>Results</title>
<p>When the ELP was replaced with a linear combination of the original ELP and the ML-predicted ELP, the MAEs &#x00B1; SD (in Diopters) in the testing set were: 0.356 &#x00B1; 0.329 for Haigis, 0.352 &#x00B1; 0.319 for Hoffer Q, 0.371 &#x00B1; 0.336 for Holladay, and 0.361 &#x00B1; 0.331 for SRK/T which were significantly lower than those of the original formulas: 0.373 &#x00B1; 0.328 for Haigis, 0.408 &#x00B1; 0.337 for Hoffer Q, 0.384 &#x00B1; 0.341 for Holladay, and 0.394 &#x00B1; 0.351 for SRK/T.</p></sec>
<sec>
<title>Conclusion</title>
<p>Using a more accurately predicted postoperative ACD significantly improves the prediction accuracy of four existing IOL power formulas.</p></sec>
</abstract>
<counts>
<page-count count="12"/>
</counts>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<notes notes-type="financial-disclosure">
<title>Funding Statement</title><p>This work was supported by the Lighthouse Guild, New York, NY (JDS) and National Eye Institute, Bethesda, MD, 1R01EY026641-01A1 (JDS).</p></notes>
<notes notes-type="disclosures">
<title>Author Declarations</title><p>I confirm all relevant ethical guidelines have been followed, and any necessary IRB and/or ethics committee approvals have been obtained.</p><p>Yes</p><p>The details of the IRB/oversight body that provided approval or exemption for the research described are given below:</p><p>This study has been approved by the IRB at the University of Michigan</p><p>All necessary patient/participant consent has been obtained and the appropriate institutional forms have been archived.</p><p>Yes</p><p>I understand that all clinical trials and any other prospective interventional studies must be registered with an ICMJE-approved registry, such as ClinicalTrials.gov. I confirm that any such study reported in the manuscript has been registered and the trial registration ID is provided (note: if posting a prospective study registered retrospectively, please provide a statement in the trial ID field explaining why the study was not registered in advance).</p><p>Yes</p><p>I have followed all appropriate research reporting guidelines and uploaded the relevant EQUATOR Network research reporting checklist(s) and other pertinent material as supplementary files, if applicable.</p><p>Yes</p></notes>
</notes>
</front>
<body>
<sec id="s1">
<title>INTRODUCTION</title>
<p>The estimation of postoperative intraocular lens position is essential to intraocular lens power calculations for cataract surgery. Norrby and Olsen have reported that inaccuracy in the prediction of the postoperative anterior chamber depth (ACD) is the number one source of error for postoperative refraction prediction.[<xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c2">2</xref>] In addition to its vital role in intraocular lens (IOL) formulas, the postoperative ACD is also a critical variable in ray tracing, where the uncertainty in the postoperative ACD directly affects the accuracy of the results. Methods to improve the accuracy of the prediction of postoperative ACD have been studied for decades. In first-generation formulas, the lens position was represented by a constant. Later, more and more preoperative biometric variables such as the axial length and the corneal power were added to calculate the postoperative IOL position. In 1993, Holladay first proposed the name &#x201C;effective lens position (ELP)&#x201D; to indicate the location of the lens as it relates to a given optical model of the eye.[<xref ref-type="bibr" rid="c3">3</xref>] Although the ELP was constructed to estimate the position of the IOL, practically the ELPs calculated using existing formulas (e.g., SRK/T) are not accurate estimates of the physical location of the IOL.[<xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c4">4</xref>] This is mainly because the ELPs in those formulas were formulated to account for different formula-specific assumptions and regression results.[<xref ref-type="bibr" rid="c1">1</xref>] In view of the limitations of the ELP in existing formulas, recently, more efforts have been devoted to constructing ELPs that better reflect the true location of the IOL.[<xref ref-type="bibr" rid="c5">5</xref>&#x2013;<xref ref-type="bibr" rid="c9">9</xref>] New IOL power prediction methods have also been developed based on the new-generation ELP prediction methods, and they have shown that using a more accurately predicted IOL position helps to improve the IOL power prediction accuracy.[<xref ref-type="bibr" rid="c5">5</xref>]</p>
<p>It is so far largely unexplored whether inserting a more accurately predicted ELP into existing formulas improves refraction prediction accuracy. This is an important question because: (1) it provides a fast and efficient way to modify and improve on existing IOL formulas whose reliability has been tested extensively. (2) such research can provide supports for translating the continued improvements in accuracy in postoperative ACD prediction into better refraction predictions in published formulas. Several previous studies had modified the ELPs in existing formulas in order to achieve better refraction prediction results in certain cataract cases. Modification of ELP calculation in the Haigis formula for sulcus-implanted IOLs was reported to improve performance.[<xref ref-type="bibr" rid="c10">10</xref>] Kim et al. adjusted the ELP estimation in SRK/T formulas with the corneal height in post-refractive patients and achieved satisfactory accuracy.[<xref ref-type="bibr" rid="c11">11</xref>] It remains to be explored whether improvement of ELP estimates for in-the-bag IOL placement can improve IOL power calculations of existing formulas for general cataract patients.</p>
<p>Since most recently published IOL formulas (e.g., Barrett Universal II[<xref ref-type="bibr" rid="c12">12</xref>,<xref ref-type="bibr" rid="c13">13</xref>], Holladay 2, Olsen formula[<xref ref-type="bibr" rid="c14">14</xref>]) are either not disclosed to the public or do not have the option to customize the value of ELP during the prediction of postoperative refraction, here we applied our previously developed postoperative ACD prediction methods to a dataset of 4806 cataract surgery patients and replaced the ELP estimates in 4 existing IOL formulas: Haigis, Hoffer Q, Holladay, and SRK/T. We combined our machine learning (ML) prediction of true postoperative ACD with the original ELP estimated by each formula and substituted this updated ELP prediction for each formula. We then compared the refraction prediction performance of each formula using its original and enhanced ELP estimates. The findings reported here demonstrate that existing formulas can benefit from improved methods for predicting true postoperative ACD.</p>
</sec>
<sec id="s2">
<title>MATERIALS AND METHODS</title>
<sec id="s2a">
<title>Postoperative ACD prediction machine learning model</title>
<p>In previous work,[<xref ref-type="bibr" rid="c15">15</xref>] we developed a machine learning-based postoperative anterior chamber depth (ACD) prediction model, which predicts the postoperative anterior chamber depth (in mm) based on preoperative biometry. Here in the presented study, an ACD prediction machine learning model was trained using the method and dataset (847 patients, 4137 eyes) described in the previous research. The dataset was composed of the preoperative and postoperative biometry measured by the Lenstar LS900 optical biometers (Haag-Streit USA Inc, EyeSuite software version i9.1.0.0) at the University of Michigan&#x2019;s Kellogg Eye Center. The postoperative ACD was defined as the distance from the front surface of the cornea to the front surface of the intraocular lens (IOL). The postoperative ACD predicted by the machine learning model is referred to as <italic>ELP</italic><sub><italic>ML</italic></sub> in this manuscript.</p>
</sec>
<sec id="s2b">
<title>Data collection</title>
<p>In this study, biometry records were collected using the same approach as for the development of the ML postoperative ACD prediction model.[<xref ref-type="bibr" rid="c15">15</xref>] The inclusion criteria were: (1) patients who had cataract surgery (CPT = 66984 or 66982) but no prior refractive surgery and no additional surgical procedures at the time of cataract surgery. (2) the implanted lens was an Alcon SN60WF single-piece acrylic monofocal lens (Alcon, USA). Each case in the dataset corresponds to one operation of a single eye with preoperative and postoperative information. The preoperative information includes the measurements of the axial length (AL), lens thickness (LT), anterior chamber depth (ACD), flat keratometry (K1), steep keratometry (K2), and the average keratometry which was calculated as <inline-formula><alternatives><inline-graphic xlink:href="20222539v1_inline1.gif"/></alternatives></inline-formula>. The postoperative information includes the postoperative refraction (spherical component SC and cylindrical component CC) where the time when it was recorded was closest to one month (30 days) after surgery. Since the patients were measured in a lane of 10 feet long (3.048 meters), which was shorter than the standard length of 20 feet (6 meters), the SC was adjusted for the vergence distance by adding <inline-formula><alternatives><inline-graphic xlink:href="20222539v1_inline2.gif"/></alternatives></inline-formula> according to Simpson and Charman&#x2019;s recommendation.[<xref ref-type="bibr" rid="c16">16</xref>] The spherical equivalent (SE) refraction was therefore calculated as <italic>SE refraction = (SC</italic> &#x2212; 0.1614) &#x002B; 0.5<italic>CC</italic>. Samples that were used to train the postoperative ACD prediction machine learning model were excluded from the dataset so that the dataset better simulates unseen samples.</p>
<p>The dataset in total consisted of 4806 patients (<bold><xref rid="fig1" ref-type="fig">Figure 1</xref></bold>). The dataset was split into a training dataset used for the development of the methods and a testing dataset used for performance comparison. 80&#x0025; of the patients were randomly assigned to the training set, and the rest of the patients (20&#x0025;) were assigned to the testing set. For patients who had more than one associated case in the testing set (i.e., patients who had both eyes operated on), one case was randomly selected to ensure each patient had the same weight when the prediction performance was evaluated. At the end of this process, the training set had 3845 patients (5761 eyes), and the testing set had 961 patients (961 eyes).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1</label>
<caption><p>The analysis pipeline of the presented study. <italic>ELP</italic><sub><italic>F</italic></sub> = the effective lens position (ELP) estimated by the existing formulas. <italic>ELP</italic><sub><italic>ML</italic></sub> = the postoperative anterior chamber depth (ACD) predicted by the machine learning method. <italic>ELP</italic><sub><italic>BC</italic></sub> = the back-calculated ELP (see main text). <inline-formula><alternatives><inline-graphic xlink:href="20222539v1_inline15.gif"/></alternatives></inline-formula> is a term that refers to a new ELP that is used to replace the <italic>ELP</italic><sub><italic>F</italic></sub> in the existing formulas.</p></caption>
<graphic xlink:href="20222539v1_fig1.tif"/>
</fig>
</sec>
<sec id="s2c">
<title>Linear regression model</title>
<p>We implemented four existing formulas (Haigis, Hoffer Q, Holladay, and SRK/T) in Python based on their publications.[<xref ref-type="bibr" rid="c17">17</xref>&#x2013;<xref ref-type="bibr" rid="c24">24</xref>] The existing formulas calculated the effective lens position (<italic>ELP</italic><sub><italic>F</italic></sub>) as a function of the preoperative biometry (<bold><xref rid="fig1" ref-type="fig">Figure 1</xref></bold>): <italic>ELP</italic><sub><italic>F</italic></sub> <italic>= f</italic><sub>0</sub><italic>(biometry)</italic>. The predicted ELP (<italic>ELP</italic><sub><italic>F</italic></sub>) was then used to predict the postoperative refraction: <italic>refraction = f</italic><sub>1</sub><italic>(ELP</italic><sub><italic>F</italic></sub>, <italic>biometry)</italic>. Here, the goal was to reduce the refraction prediction error by replacing <italic>ELP</italic><sub><italic>F</italic></sub> with a different value, <inline-formula><alternatives><inline-graphic xlink:href="20222539v1_inline3.gif"/></alternatives></inline-formula>. Our approach involves two steps: (1) finding the theoretically most optimal ELP values, (2) modeling the most optimal ELP with <italic>ELP</italic><sub><italic>F</italic></sub> and the ML-predicted postoperative ACD, denoted <italic>ELP</italic><sub><italic>ML</italic></sub>.</p>
<p>In the first step, the most optimal ELP (denoted <italic>ELP</italic><sub><italic>BC</italic></sub>) was found by the standard method of back-calculating the ELP when the predicted refraction was set to equal the true refraction (i.e., <italic>f</italic><sub>1</sub> <italic>(ELP</italic><sub><italic>BC</italic></sub>, <italic>biometry) = true refraction</italic>). In other words, when <inline-formula><alternatives><inline-graphic xlink:href="20222539v1_inline4.gif"/></alternatives></inline-formula>, the refraction prediction errors of all patients equal zero. More details on the computation of <italic>ELP</italic><sub><italic>BC</italic></sub> can be found in <bold>Supplementary materials</bold>.</p>
<p>After the computation of <italic>ELP</italic><sub><italic>F</italic></sub>, <italic>ELP</italic><sub><italic>ML</italic></sub>, and <italic>ELP</italic><sub><italic>BC</italic></sub>, we modeled <italic>ELP</italic><sub><italic>BC</italic></sub> using a linear function of <italic>ELP</italic><sub><italic>F</italic></sub> and/or <italic>ELP</italic><sub><italic>ML</italic></sub> so as to obtain an approximation of the most optimal ELP using available variables. We compared four different approaches of approximating <italic>ELP</italic><sub><italic>BC</italic></sub> : (1) Original, <inline-formula><alternatives><inline-graphic xlink:href="20222539v1_inline5.gif"/></alternatives></inline-formula> : using the original <italic>ELP</italic><sub><italic>F</italic></sub>, (2) Formula LR, <inline-formula><alternatives><inline-graphic xlink:href="20222539v1_inline6.gif"/></alternatives></inline-formula> : using linearly adjusted <italic>ELP</italic><sub><italic>F</italic></sub>, (3) ML LR, <inline-formula><alternatives><inline-graphic xlink:href="20222539v1_inline7.gif"/></alternatives></inline-formula>: using linearly adjusted <italic>ELP</italic><sub><italic>F</italic></sub>, (4) Formula &#x0026; ML LR, <inline-formula><alternatives><inline-graphic xlink:href="20222539v1_inline8.gif"/></alternatives></inline-formula>: using a linear combination of <italic>ELP</italic><sub><italic>F</italic></sub> and <italic>ELP</italic><sub><italic>ML</italic></sub>. Here <italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>, and <italic>c</italic><sub>3</sub> are constants. Outliers with large refraction errors (i.e., <italic>error</italic> &#x2265; <italic>mean error &#x002B; 2 &#x00B7; standard deviation</italic> or <italic>error</italic> &#x2265; <italic>mean error</italic> &#x2212; <italic>2 &#x00B7; standard deviation</italic>) were excluded for each formula before establishing the linear regression model, in order to obtain better modeling results. The refraction prediction errors were calculated as <italic>error = predicted refraction</italic> &#x2212; <italic>true refraction</italic>. The linear regression was performed using scikit-learn 0.20.3.</p>
<p>On the testing set, <inline-formula><alternatives><inline-graphic xlink:href="20222539v1_inline9.gif"/></alternatives></inline-formula> was calculated based on the values of <italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>, and <italic>c</italic><sub>3</sub> obtained through linear regression. The predicted refraction was calculated as <italic>refraction = f</italic><sub>1</sub><italic>(ELP</italic><sub><italic>F</italic></sub> <italic>&#x2032;, biometry)</italic>. The mean absolute error (MAE), median absolute error (MedAE) and mean error (ME) were calculated for performance comparison.</p>
</sec>
<sec id="s2d">
<title>A-constant optimization</title>
<p>The A-constants for the formulas were optimized based on the training dataset so that the mean error in refraction prediction was closest to zero. The A-constants were optimized separately for the unmodified formulas and formulas with a modified ELP estimate (see <bold>Supplementary Materials</bold>). The optimized A-constants for the original formulas were: a0 = &#x2212;0.733, a1 = &#x2212;0.234, a2 = 0.217 for Haigis, ACD constant = 5.724 for Hoffer Q, surgeon factor = 1.864 for Holladay, and A = 119.089 for SRK/T (<bold>Table S1</bold>).</p>
</sec>
<sec id="s2e">
<title>Statistical analysis</title>
<p>Linear regression analysis was used to assess the significance of the correlation between <italic>ELP</italic><sub><italic>F</italic></sub>, <italic>ELP</italic><sub><italic>ML</italic></sub>, and <italic>ELP</italic><sub><italic>BC</italic></sub>. To test whether the MAE and ME of different methods were significantly different, a Friedman test followed by a post hoc paired Wilcoxon signed-rank test with Bonferroni correction was used. Statistical significance was defined as the p-value &#x003C;0.05. All the above analyses were performed with Python 3.7.3.</p>
</sec>
</sec>
<sec id="s3">
<title>RESULTS</title>
<sec id="s3a">
<title>Dataset overview</title>
<p>The cases in the training and testing datasets had a similar distribution according to the summary statistics shown in <bold><xref rid="tbl1" ref-type="table">Table 1</xref></bold>. As elaborated in <bold>Materials and Methods</bold>, we calculated <italic>ELP</italic><sub><italic>F</italic></sub>, <italic>ELP</italic><sub><italic>ML</italic></sub>, and <italic>ELP</italic><sub><italic>BC</italic></sub> based on the formulas and their optimized A-constants. The mean and standard deviation of the ELPs calculated based on the original formulas were summarized in <bold>Table S2</bold>. <italic>ELP</italic><sub><italic>BC</italic></sub> and <italic>ELP</italic><sub><italic>F</italic></sub> had similar mean values in contrast to <italic>ELP</italic><sub><italic>ML</italic></sub>.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1</label>
<caption><p>The summary statistics for the patient demographics for the training and testing dataset. For the age at surgery, preoperative biometry, and postoperative refraction, the mean &#x00B1; SD (standard deviation) is shown in the table.</p></caption>
<graphic xlink:href="20222539v1_tbl1.tif"/>
</table-wrap>
<p>The Pearson correlation coefficients (<italic>R</italic>) between <italic>ELP</italic><sub><italic>F</italic></sub>, <italic>ELP</italic><sub><italic>ML</italic></sub>, and <italic>ELP</italic><sub><italic>BC</italic></sub> were shown in <bold><xref rid="tbl2" ref-type="table">Table 2</xref></bold>. Three ELP-related variables were positively intercorrelated with each other. The correlation coefficients, <italic>R</italic>, between <italic>ELP</italic><sub><italic>BC</italic></sub> and <italic>ELP</italic><sub><italic>ML</italic></sub> were the weakest among the three pairs of variables across all formulas.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2</label>
<caption><p>The Pearson correlation coefficients (<italic>R</italic>) between <italic>ELP</italic><sub><italic>F</italic></sub>, <italic>ELP</italic><sub><italic>ML</italic></sub>, and <italic>ELP</italic><sub><italic>BC</italic></sub>. The <italic>ELP</italic><sub><italic>BC</italic></sub> and <italic>ELP</italic><sub><italic>F</italic></sub> were calculated using the A constants optimized based on the original formulas. P-values of all correlations were &#x003C; 0.05. The corresponding scatter plots are shown in <bold>Figure S1</bold>. All <italic>R</italic> were rounded to three decimal places.</p></caption>
<graphic xlink:href="20222539v1_tbl2.tif"/>
</table-wrap>
</sec>
<sec id="s3b">
<title>Linear regression results on the training set</title>
<p>Linear regression models were established based on the training set and the <italic>R</italic><sup>2</sup> of alternative linear models were shown in <bold><xref rid="tbl3" ref-type="table">Table 3</xref></bold>. The coefficients of the fitted linear regression line are shown in <bold>Table S3</bold>. The mean and SD of the <inline-formula><alternatives><inline-graphic xlink:href="20222539v1_inline10.gif"/></alternatives></inline-formula> resulting from different models are shown in <bold>Table S4</bold>. For &#x201C;Formula LR&#x201D;, the <italic>R</italic><sup>2</sup> was larger than that of &#x201C;ML LR&#x201D; for all four formulas. For &#x201C;Formula &#x0026; ML LR&#x201D;, the <italic>R</italic><sup>2</sup> was larger than that when one of <italic>ELP</italic><sub><italic>F</italic></sub> and <italic>ELP</italic><sub><italic>ML</italic></sub> was excluded from the linear combination for all four formulas.</p>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3</label>
<caption><p>The <italic>R</italic><sup>2</sup> of alternative least-squares linear regression models in the training set. The outlier cases were removed before calculating the above values. The largest <italic>R</italic><sup>2</sup> among three methods is marked in bold for each formula. P-values of all correlations were &#x003C; 0.05.</p></caption>
<graphic xlink:href="20222539v1_tbl3.tif"/>
</table-wrap>
</sec>
<sec id="s3c">
<title>Refraction prediction performance comparison on the testing set</title>
<p>We tested the performance of four scenarios on the testing set and summarized the MAE and SD <bold><xref rid="tbl4" ref-type="table">Table 4</xref></bold>. The mean error (ME) and median absolute error (MedAE) were shown in <bold>Table S5 and Table S6</bold>. Statistical tests were used to compare the difference in the MAEs of different models (see <bold>Materials and Methods</bold>). Using a linear combination of <italic>ELP</italic><sub><italic>F</italic></sub> and <italic>ELP</italic><sub><italic>ML</italic></sub>, the refraction prediction results of four existing formulas were significantly improved compared to original <italic>ELP</italic><sub><italic>F</italic></sub> (statistical test results shown in <bold>Table S7</bold> and <bold>Table S8</bold>).</p>
<table-wrap id="tbl4" orientation="portrait" position="float">
<label>Table 4</label>
<caption><p>Performance in the testing set. The mean absolute error (MAE) &#x00B1; standard deviation (SD) and the percentage reduction in MAE compared to &#x201C;Original&#x201D; for alternative linear models in the testing set. All MAE and SD were rounded to three decimal places. The percentage reduction was calculated as <inline-formula><alternatives><inline-graphic xlink:href="20222539v1_inline16.gif"/></alternatives></inline-formula>. All percentage reduction values were rounded to one decimal place. The method with the smallest MAE among four alternative methods is marked in bold for each formula.</p></caption>
<graphic xlink:href="20222539v1_tbl4.tif"/>
</table-wrap>
<p>We further compared the MAEs of &#x201C;Original&#x201D; and &#x201C;Formula &#x0026; ML LR&#x201D; among patients with short, medium, and long axial length (<bold>Table S9</bold>). It was observed that the short and medium axial length groups had a higher percentage decrease in MAE than the long axial length group for Hoffer Q and SRK/T. For Haigis, the medium AL group achieved higher decrease than the other two groups. And for Holladay, the long AL group achieved more decrease in MAE than the other two groups.</p>
</sec>
</sec>
<sec id="s4">
<title>DISCUSSION</title>
<p>In this study, we applied a previously developed machine learning method for postoperative anterior chamber depth (ACD) prediction to an unseen dataset of 4806 cataract surgery patients to assess whether it was possible to improve the performance of existing IOL formulas (Haigis, Hoffer Q, Holladay, and SRK/T) by replacing each formula&#x2019;s ELP estimate.</p>
<p>We computed three ELP-related quantities: the machine learning-predicted postoperative ACD (<italic>ELP</italic><sub><italic>ML</italic></sub>), formula-predicted ELP (<italic>ELP</italic><sub><italic>F</italic></sub>), and a back-calculated ELP (<italic>ELP</italic><sub><italic>BC</italic></sub>) that minimized the refraction error for each eye in the dataset. They are strongly correlated with each other (<bold><xref rid="tbl2" ref-type="table">Table 2</xref></bold>), which indicates that (1) <italic>ELP</italic><sub><italic>F</italic></sub> and <italic>ELP</italic><sub><italic>ML</italic></sub> are both predictive of the most optimal ELP <italic>ELP</italic><sub><italic>BC</italic></sub>, (2) <italic>ELP</italic><sub><italic>F</italic></sub> and <italic>ELP</italic><sub><italic>ML</italic></sub> contain partially overlapping information, which is consistent with our expectation. <italic>ELP</italic><sub><italic>ML</italic></sub> is an estimation of the value of the true postoperative ACD. On the other hand, the <italic>ELP</italic><sub><italic>F</italic></sub> was designed by the originators of each formula to serve a similar purpose but was based on the theoretical assumptions in each formula. Our findings are consistent with observations of previous studies that the ELP estimates made by IOL formulas were numerically different from the true postoperative ACD.[<xref ref-type="bibr" rid="c9">9</xref>]</p>
<p>Using a training dataset of 3845 patients, we sought to evaluate whether the machine-predicted postoperative ACD, <italic>ELP</italic><sub><italic>ML</italic></sub>, was able to provide information that could be used to refine each formula&#x2019;s predicted ELP, <italic>ELP</italic><sub><italic>F</italic></sub>. We established regression models between the <italic>ELP</italic><sub><italic>ML</italic></sub>, <italic>ELP</italic><sub><italic>F</italic></sub>, and <italic>ELP</italic><sub><italic>BC</italic></sub> to evaluate whether a linear combination of <italic>ELP</italic><sub><italic>ML</italic></sub> and <italic>ELP</italic><sub><italic>F</italic></sub> used in place of the original <italic>ELP</italic><sub><italic>F</italic></sub> could lower the refraction prediction error. Using the modified ELPs, we obtained significantly lower mean absolute errors (MAE) in refraction prediction compared to the formulas with the original ELPs on the unseen testing set (<bold><xref rid="tbl4" ref-type="table">Table 4</xref></bold>). Notably, the accurately predicted postoperative ACD (<italic>ELP</italic><sub><italic>ML</italic></sub>) alone did not outperform the original ELP (<italic>ELP</italic><sub><italic>F</italic></sub>) when it was inserted into the formulas (<bold><xref rid="tbl4" ref-type="table">Table 4</xref></bold>, row 3 compared to row 1). This is likely because the original method of calculating ELP in each formula compensates for its particular model of the eye and its associated assumptions. Our <italic>ELP</italic><sub><italic>ML</italic></sub>, however, does not have any components that compensate for the assumptions and constants in the formulas. On the other hand, <italic>ELP</italic><sub><italic>ML</italic></sub> has information about the true postoperative ACD, which it appears can beneficially alter the original ELP estimate.</p>
<p>In this study, the A-constants were optimized separately when <italic>ELP</italic><sub><italic>F</italic></sub> was replaced with different <inline-formula><alternatives><inline-graphic xlink:href="20222539v1_inline11.gif"/></alternatives></inline-formula>. The means of <inline-formula><alternatives><inline-graphic xlink:href="20222539v1_inline12.gif"/></alternatives></inline-formula>, as shown in <bold>Table S4</bold> were numerically close to those of <italic>ELP</italic><sub><italic>F</italic></sub> as shown in <bold>Table S2</bold>. However, in our method, the similarity between <inline-formula><alternatives><inline-graphic xlink:href="20222539v1_inline13.gif"/></alternatives></inline-formula> and <italic>ELP</italic><sub><italic>F</italic></sub> was not among the restrictions and goals of the optimization. The reason that <inline-formula><alternatives><inline-graphic xlink:href="20222539v1_inline14.gif"/></alternatives></inline-formula> and the original <italic>ELP</italic><sub><italic>F</italic></sub> have similar means might be that the other parts of each formula put restrictions on the values of ELP in order to obtain reasonable results. This could also be the reason why <italic>ELP</italic><sub><italic>BC</italic></sub> and <italic>ELP</italic><sub><italic>F</italic></sub> had similar means as shown in <bold>Table S2</bold>.</p>
<p>The presented method of replacing ELP estimates provides a simple way of improving the prediction performance of existing formulas. While it would be ideal to evaluate this method on modern formulas such as Barrett Universal II or Holladay 2, the absence of published equations for these formulas prevents such a study. As such, we studied the application of the machine learning predicted postoperative ACD in four existing formulas whose mathematical equations were published. Although it awaits to be further validated, similar results can likely be transferred to other refraction prediction methods, since many modern IOL power formulas use predicted postoperative ACD as an intermediate step for predicting postoperative refraction.</p>
<p>In summary, the results of this study demonstrate that a machine learning method for postoperative ACD prediction based on postoperative optical biometry can be incorporated into a variety of existing IOL power formulas to improve their accuracy in refraction prediction.</p>
</sec>
<sec sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material>
<label>Supplementary materials</label>
<media xlink:href="supplements/222539_file03.pdf" />
</supplementary-material>
</sec>
</body>
<back>
<sec sec-type="data-availability">
<title>Data Availability</title>
<p>Data are not publicly available.</p>
</sec>
<ack>
<title>ACKNOWLEDGMENTS</title>
<p>None</p>
</ack>
<sec id="s5">
<title>CONTRIBUTIONS</title>
<p>TL: data analysis, programming, and writing of the manuscript; JDS: data collection; NN: data collection, guidance on method development, and writing of the manuscript</p>
</sec>
<sec id="s6">
<title>FUNDING</title>
<p>This work was supported by the Lighthouse Guild, New York, NY (JDS) and National Eye Institute, Bethesda, MD, 1R01EY026641-01A1 (JDS).</p>
</sec>
<sec id="s7">
<title>COMPETING INTERESTS</title>
<p>None declared</p>
</sec>
<sec id="s8">
<title>DATA AVAILABILITY STATEMENT</title>
<p>Data are not publicly available</p>
</sec>
<ref-list>
<title>REFERENCES</title>
<ref id="c1"><label>1</label><mixed-citation publication-type="journal"><string-name><surname>Norrby</surname> <given-names>S.</given-names></string-name> <article-title>Sources of error in intraocular lens power calculation</article-title>. <source>J Cataract Refract Surg</source> <year>2008</year>;<volume>34</volume>:<fpage>368</fpage>&#x2013;<lpage>76</lpage>.</mixed-citation></ref>
<ref id="c2"><label>2</label><mixed-citation publication-type="journal"><string-name><surname>Olsen</surname> <given-names>T.</given-names></string-name> <article-title>Sources of error in intraocular lens power calculation</article-title>. <source>J Cataract Refract Surg</source> <year>1992</year>;<volume>18</volume>:<fpage>125</fpage>&#x2013;<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c3"><label>3</label><mixed-citation publication-type="journal"><string-name><surname>Holladay</surname> <given-names>JT</given-names></string-name>. <article-title>Refractive power calculations for intraocular lenses in the phakic eye</article-title>. <source>Am J Ophthalmol</source> <year>1993</year>;<volume>116</volume>:<fpage>63</fpage>&#x2013;<lpage>6</lpage>.</mixed-citation></ref>
<ref id="c4"><label>4</label><mixed-citation publication-type="journal"><string-name><surname>Norrby</surname> <given-names>S</given-names></string-name>, <string-name><surname>Bergman</surname> <given-names>R</given-names></string-name>, <string-name><surname>Hirnschall</surname> <given-names>N</given-names></string-name>, <etal>et al.</etal> <article-title>Prediction of the true IOL position</article-title>. <source>Br J Ophthalmol</source> <year>2017</year>;<volume>101</volume>:<fpage>1440</fpage>&#x2013;<lpage>6</lpage>.</mixed-citation></ref>
<ref id="c5"><label>5</label><mixed-citation publication-type="journal"><string-name><surname>Martinez-Enriquez</surname> <given-names>E</given-names></string-name>, <string-name><surname>P&#x00E9;rez-Merino</surname> <given-names>P</given-names></string-name>, <string-name><surname>Dur&#x00E1;n-Poveda</surname> <given-names>S</given-names></string-name>, <etal>et al.</etal> <article-title>Estimation of intraocular lens position from full crystalline lens geometry: towards a new generation of intraocular lens power calculation formulas</article-title>. <source>Sci Rep</source> <year>2018</year>;<volume>8</volume>:<fpage>9829</fpage>.</mixed-citation></ref>
<ref id="c6"><label>6</label><mixed-citation publication-type="journal"><string-name><surname>Hirnschall</surname> <given-names>N</given-names></string-name>, <string-name><surname>Amir-Asgari</surname> <given-names>S</given-names></string-name>, <string-name><surname>Maedel</surname> <given-names>S</given-names></string-name>, <etal>et al.</etal> <article-title>Predicting the postoperative intraocular lens position using continuous intraoperative optical coherence tomography measurements</article-title>. <source>Invest Ophthalmol Vis Sci</source> <year>2013</year>;<volume>54</volume>:<fpage>5196</fpage>&#x2013;<lpage>203</lpage>.</mixed-citation></ref>
<ref id="c7"><label>7</label><mixed-citation publication-type="journal"><string-name><surname>Chang</surname> <given-names>Y-C</given-names></string-name>, <string-name><surname>Cabot</surname> <given-names>F</given-names></string-name>, <string-name><surname>Williams</surname> <given-names>S</given-names></string-name>, <etal>et al.</etal> <article-title>Pre-operative Prediction of Post-cataract Surgery IOL Position Using Anterior Chamber Depth and Lens Thickness Determined with Extended-depth OCT</article-title>. <source>Invest Ophthalmol Vis Sci</source> <year>2017</year>;<volume>58</volume>:<fpage>2717</fpage>.</mixed-citation></ref>
<ref id="c8"><label>8</label><mixed-citation publication-type="journal"><string-name><surname>Satou</surname> <given-names>T</given-names></string-name>, <string-name><surname>Shimizu</surname> <given-names>K</given-names></string-name>, <string-name><surname>Tsunehiro</surname> <given-names>S</given-names></string-name>, <etal>et al.</etal> <article-title>Development of a new intraocular lens power calculation method based on lens position estimated with optical coherence tomography</article-title>. <source>Sci Rep</source> <year>2020</year>;<volume>10</volume>:<fpage>6501</fpage>.</mixed-citation></ref>
<ref id="c9"><label>9</label><mixed-citation publication-type="journal"><string-name><surname>Tamaoki</surname> <given-names>A</given-names></string-name>, <string-name><surname>Kojima</surname> <given-names>T</given-names></string-name>, <string-name><surname>Tanaka</surname> <given-names>Y</given-names></string-name>, <etal>et al.</etal> <article-title>Prediction of effective lens position using multiobjective evolutionary algorithm</article-title>. <source>Transl Vis Sci Technol</source> <year>2019;8</year>.</mixed-citation></ref>
<ref id="c10"><label>10</label><mixed-citation publication-type="journal"><string-name><surname>Eom</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Song</surname> <given-names>JS</given-names></string-name>, <string-name><surname>Kim</surname> <given-names>HM</given-names></string-name>. <article-title>Modified Haigis Formula Effective Lens Position Equation for Ciliary Sulcus-Implanted Intraocular Lenses</article-title>. <source>Am J Ophthalmol</source> <year>2016</year>;<volume>161</volume>:<fpage>142</fpage>.</mixed-citation></ref>
<ref id="c11"><label>11</label><mixed-citation publication-type="journal"><string-name><surname>Kim</surname> <given-names>DH</given-names></string-name>, <string-name><surname>Kim</surname> <given-names>MK</given-names></string-name>, <string-name><surname>Wee</surname> <given-names>WR</given-names></string-name>. <article-title>Estimation of intraocular lens power calculation after myopic corneal refractive surgery: using corneal height in anterior segment optical coherence tomography</article-title>. <source>Korean J Ophthalmol</source> <year>2015</year>;<volume>29</volume>:<fpage>195</fpage>&#x2013;<lpage>202</lpage>.</mixed-citation></ref>
<ref id="c12"><label>12</label><mixed-citation publication-type="journal"><string-name><surname>Barrett</surname> <given-names>GD</given-names></string-name>. <article-title>Intraocular lens calculation formulas for new intraocular lens implants</article-title>. <source>J Cataract Refract Surg</source> <year>1987</year>;<volume>13</volume>:<fpage>389</fpage>&#x2013;<lpage>96</lpage>.</mixed-citation></ref>
<ref id="c13"><label>13</label><mixed-citation publication-type="journal"><string-name><surname>Barrett</surname> <given-names>GD</given-names></string-name>. <article-title>An improved universal theoretical formula for intraocular lens power prediction</article-title>. <source>J Cataract Refract Surg</source> <year>1993</year>;<volume>19</volume>:<fpage>713</fpage>&#x2013;<lpage>20</lpage>.</mixed-citation></ref>
<ref id="c14"><label>14</label><mixed-citation publication-type="journal"><string-name><surname>Olsen</surname> <given-names>T.</given-names></string-name> <article-title>The Olsen formula</article-title>. In: <source>Intraocular Lens Power Calculations</source>. <year>2004</year>. <fpage>27</fpage>&#x2013;<lpage>40</lpage>.</mixed-citation></ref>
<ref id="c15"><label>15</label><mixed-citation publication-type="journal"><string-name><surname>Li</surname> <given-names>T</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>K</given-names></string-name>, <string-name><surname>Stein</surname> <given-names>J</given-names></string-name>, <etal>et al.</etal> <article-title>Gradient Boosting Decision Tree Algorithm for the Prediction of Postoperative Intraocular Lens Position in Cataract Surgery</article-title>. <source>medRxiv</source> Published Online First: <year>2020</year>.</mixed-citation></ref>
<ref id="c16"><label>16</label><mixed-citation publication-type="journal"><string-name><surname>Simpson</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Charman</surname> <given-names>WN</given-names></string-name>. <article-title>The effect of testing distance on intraocular lens power calculation. J. Refract</article-title>. <source>Surg</source>. <year>2014</year>;<volume>30</volume>:<fpage>726</fpage>.</mixed-citation></ref>
<ref id="c17"><label>17</label><mixed-citation publication-type="journal"><string-name><surname>Retzlaff</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Sanders</surname> <given-names>DR</given-names></string-name>, <string-name><surname>Kraff</surname> <given-names>MC</given-names></string-name>. <article-title>Development of the SRK/T intraocular lens implant power calculation formula</article-title>. <source>J Cataract Refract Surg</source> <year>1990</year>;<volume>16</volume>:<fpage>333</fpage>&#x2013;<lpage>40</lpage>.</mixed-citation></ref>
<ref id="c18"><label>18</label><mixed-citation publication-type="journal"><string-name><surname>Hoffer</surname> <given-names>KJ</given-names></string-name>. <article-title>The Hoffer Q formula: A comparison of theoretic and regression formulas</article-title>. <source>J Cataract Refract Surg</source> <year>1993</year>;<volume>19</volume>:<fpage>700</fpage>&#x2013;<lpage>12</lpage>.</mixed-citation></ref>
<ref id="c19"><label>19</label><mixed-citation publication-type="journal"><string-name><surname>Haigis</surname> <given-names>W</given-names></string-name>, <string-name><surname>Lege</surname> <given-names>B</given-names></string-name>, <string-name><surname>Miller</surname> <given-names>N</given-names></string-name>, <etal>et al.</etal> <article-title>Comparison of immersion ultrasound biometry and partial coherence interferometry for intraocular lens calculation according to Haigis</article-title>. <source>Graefe&#x2019;s Arch Clin Exp Ophthalmol</source> <year>2000</year>;<volume>238</volume>:<fpage>765</fpage>&#x2013;<lpage>73</lpage>.</mixed-citation></ref>
<ref id="c20"><label>20</label><mixed-citation publication-type="journal"><string-name><surname>Holladay</surname> <given-names>JT</given-names></string-name>, <string-name><surname>Musgrove</surname> <given-names>KH</given-names></string-name>, <string-name><surname>Prager</surname> <given-names>TC</given-names></string-name>, <etal>et al.</etal> <article-title>A three-part system for refining intraocular lens power calculations</article-title>. <source>J Cataract Refract Surg</source> <year>1988</year>;<volume>14</volume>:<fpage>17</fpage>&#x2013;<lpage>24</lpage>.</mixed-citation></ref>
<ref id="c21"><label>21</label><mixed-citation publication-type="journal"><article-title>Correction</article-title>. <source>J Cataract Refract Surg</source> <year>1994</year>;<volume>20</volume>:<fpage>677</fpage>.</mixed-citation></ref>
<ref id="c22"><label>22</label><mixed-citation publication-type="journal"><article-title>Erratum</article-title>. <source>J Cataract Refract Surg</source> <year>1990</year>;<volume>16</volume>:<fpage>528</fpage>.</mixed-citation></ref>
<ref id="c23"><label>23</label><mixed-citation publication-type="journal"><string-name><surname>Hoffer</surname> <given-names>KJ</given-names></string-name>. <article-title>Reply: Errata in printed Hoffer Q formula</article-title>. <source>J Cataract Refract Surg</source> <year>2007</year>;<volume>33</volume>.</mixed-citation></ref>
<ref id="c24"><label>24</label><mixed-citation publication-type="journal"><string-name><surname>Zuberbuhler</surname> <given-names>B</given-names></string-name>, <string-name><surname>Morrell</surname> <given-names>AJ</given-names></string-name>. <article-title>Errata in printed Hoffer Q formula</article-title>. <source>J Cataract Refract Surg</source> <year>2007</year>;<volume>33</volume>:<fpage>2</fpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>