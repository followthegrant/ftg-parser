<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Algorithmica</journal-id><journal-id journal-id-type="iso-abbrev">Algorithmica</journal-id><journal-title-group><journal-title>Algorithmica</journal-title></journal-title-group><issn pub-type="ppub">0178-4617</issn><issn pub-type="epub">1432-0541</issn><publisher><publisher-name>Springer US</publisher-name><publisher-loc>New York</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">30956379</article-id><article-id pub-id-type="pmc">6428404</article-id><article-id pub-id-type="publisher-id">384</article-id><article-id pub-id-type="doi">10.1007/s00453-017-0384-3</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Finding Pairwise Intersections Inside a Query Range</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>de Berg</surname><given-names>Mark</given-names></name><address><email>mdberg@win.tue.nl</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Gudmundsson</surname><given-names>Joachim</given-names></name><address><email>joachim.gudmundsson@gmail.com</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Mehrabi</surname><given-names>Ali D.</given-names></name><address><email>amehrabi@win.tue.nl</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0398 8763</institution-id><institution-id institution-id-type="GRID">grid.6852.9</institution-id><institution>Department of Computer Science, </institution><institution>TU Eindhoven, </institution></institution-wrap>Eindhoven, The Netherlands </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 834X</institution-id><institution-id institution-id-type="GRID">grid.1013.3</institution-id><institution>School of IT, </institution><institution>University of Sydney, </institution></institution-wrap>Sydney, Australia </aff></contrib-group><pub-date pub-type="epub"><day>31</day><month>10</month><year>2017</year></pub-date><pub-date pub-type="pmc-release"><day>31</day><month>10</month><year>2017</year></pub-date><pub-date pub-type="ppub"><year>2018</year></pub-date><volume>80</volume><issue>11</issue><fpage>3253</fpage><lpage>3269</lpage><history><date date-type="received"><day>27</day><month>5</month><year>2016</year></date><date date-type="accepted"><day>13</day><month>10</month><year>2017</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2017</copyright-statement><license license-type="OpenAccess"><license-p>
<bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>/), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">We study the following problem: preprocess a set <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq1.gif"/></alternatives></inline-formula> of objects into a data structure that allows us to efficiently report all pairs of objects from <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq2.gif"/></alternatives></inline-formula> that intersect inside an axis-aligned query range <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M6"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq3.gif"/></alternatives></inline-formula>. We present data structures of size <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\cdot {{\mathrm{polylog\,}}}n)$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mi mathvariant="normal">polylog</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq4.gif"/></alternatives></inline-formula> and with query time <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O((k+1)\cdot {{\mathrm{polylog\,}}}n)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mi mathvariant="normal">polylog</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq5.gif"/></alternatives></inline-formula> time, where <italic>k</italic> is the number of reported pairs, for two classes of objects in <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^2$$\end{document}</tex-math><mml:math id="M12"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq6.gif"/></alternatives></inline-formula>: axis-aligned rectangles and objects with small union complexity. For the 3-dimensional case where the objects and the query range are axis-aligned boxes in&#x000a0;<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^3$$\end{document}</tex-math><mml:math id="M14"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq7.gif"/></alternatives></inline-formula>, we present a data structure of size <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\sqrt{n}\cdot {{\mathrm{polylog\,}}}n)$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mi mathvariant="normal">polylog</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq8.gif"/></alternatives></inline-formula> and query time <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O((\sqrt{n}+k)\cdot {{\mathrm{polylog\,}}}n)$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mi mathvariant="normal">polylog</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq9.gif"/></alternatives></inline-formula>. When the objects and query are fat, we obtain <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O((k+1)\cdot {{\mathrm{polylog\,}}}n)$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mi mathvariant="normal">polylog</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq10.gif"/></alternatives></inline-formula> query time using <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\cdot {{\mathrm{polylog\,}}}n)$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mi mathvariant="normal">polylog</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq11.gif"/></alternatives></inline-formula> storage.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Data structures</kwd><kwd>Computational geometry</kwd><kwd>Intersection searching</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003246</institution-id><institution>Nederlandse Organisatie voor Wetenschappelijk Onderzoek</institution></institution-wrap></funding-source><award-id>612.001.118</award-id><award-id>024.002.003</award-id><principal-award-recipient><name><surname>de Berg</surname><given-names>Mark</given-names></name><name><surname>Mehrabi</surname><given-names>Ali D.</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000923</institution-id><institution>Australian Research Council</institution></institution-wrap></funding-source><award-id>FT100100755</award-id><award-id>DP150101134</award-id><principal-award-recipient><name><surname>Gudmundsson</surname><given-names>Joachim</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; Springer Science+Business Media, LLC, part of Springer Nature 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2">The study of geometric data structures is an important subarea within computational geometry, and range searching forms one of the most widely studied topics within this area&#x000a0;[<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR15">15</xref>]. In a range-searching query, the goal is to report or count all points from a given set <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq12.gif"/></alternatives></inline-formula> that lie inside a query range&#x000a0;<inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M26"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq13.gif"/></alternatives></inline-formula>. The more general version, where <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M28"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq14.gif"/></alternatives></inline-formula> contains other objects than just points and the goal is to report all objects intersecting&#x000a0;<inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M30"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq15.gif"/></alternatives></inline-formula>, is often called intersection searching and it has been studied extensively as well. A common characteristic of almost all range-searching and intersection-searching problems studied so far, is that whether an object <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i\in \mathcal {O}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq16.gif"/></alternatives></inline-formula> should be reported (or counted) depends only on <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq17.gif"/></alternatives></inline-formula> and&#x000a0;<inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M36"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq18.gif"/></alternatives></inline-formula>. In this paper we study a range-searching variant where we are interested in reporting <italic>pairs</italic> of objects that satisfy a certain criterion. In particular, we want to preprocess a set <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}=\{o_1,\ldots ,o_n\}$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq19.gif"/></alternatives></inline-formula> of <italic>n</italic> objects in <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^2$$\end{document}</tex-math><mml:math id="M40"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq20.gif"/></alternatives></inline-formula> or <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^3$$\end{document}</tex-math><mml:math id="M42"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq21.gif"/></alternatives></inline-formula> such that, given a query range&#x000a0;<inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M44"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq22.gif"/></alternatives></inline-formula>, we can efficiently report all pairs of objects <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i,o_j$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq23.gif"/></alternatives></inline-formula> that intersect inside&#x000a0;<inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M48"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq24.gif"/></alternatives></inline-formula>.</p><p id="Par3">Our motivation for studying these problems is the following. Suppose we are given a collection of <italic>n</italic> discrete trajectories representing the movements of, say, people. Each trajectory is a sequence of locations (points in <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^2$$\end{document}</tex-math><mml:math id="M50"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq25.gif"/></alternatives></inline-formula>) with a corresponding time stamp; for discrete trajectories the movement in between consecutive locations is not considered. The query we are interested in is: which pairs of people met inside a given rectangular query region&#x000a0;<inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M52"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq26.gif"/></alternatives></inline-formula>? A natural way to define that two people meet is to require that they are within a given distance&#x000a0;<italic>D</italic> from each other. When we restrict our attention to a fixed time instance, we can place a disk of radius <italic>D</italic>&#x000a0;/&#x000a0;2 around the location of each person and the question becomes: which pairs of disks intersect within&#x000a0;<inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M54"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq27.gif"/></alternatives></inline-formula>? When we consider the <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _{\infty }$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>&#x02113;</mml:mi><mml:mi>&#x0221e;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq28.gif"/></alternatives></inline-formula> metric, we get the same problem but now for squares instead of disks. A more general version of the query also specifies a time interval&#x000a0;<italic>I</italic>: which pairs of people met within a region&#x000a0;<inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}'$$\end{document}</tex-math><mml:math id="M58"><mml:msup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq29.gif"/></alternatives></inline-formula> during time interval&#x000a0;<italic>I</italic>? To deal with the fact that the time stamps may not be synchronized for the different trajectories, we assume that each location is valid for some interval of time. If we then model time as the third dimension and consider distances in the <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _{\infty }$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>&#x02113;</mml:mi><mml:mi>&#x0221e;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq30.gif"/></alternatives></inline-formula> metric, we get the question: which pairs of boxes (which are the product of a square around a location and a time interval) intersect with the query box&#x000a0;<inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}:= {Q}'\times I$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x000d7;</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq31.gif"/></alternatives></inline-formula>?</p><p id="Par4">An obvious approach to our problem is to precompute all intersections between the objects and store the intersections in a suitable intersection-searching data structure. This may give fast query times, but in the worst case any two objects intersect, so <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega (n^2)$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq32.gif"/></alternatives></inline-formula> is a lower bound on the storage for this approach. The main question is thus: can we achieve fast query times with a data structure that uses subquadratic (and preferably near-linear) storage in the worst case?</p><p id="Par5">Rahul et&#x000a0;al.&#x000a0;[<xref ref-type="bibr" rid="CR21">21</xref>] answered this question affirmatively when <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M66"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq33.gif"/></alternatives></inline-formula> is an axis-aligned rectangle in <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^2$$\end{document}</tex-math><mml:math id="M68"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq34.gif"/></alternatives></inline-formula> and the objects are axis-aligned line segments. Their data structure uses <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\log n)$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq35.gif"/></alternatives></inline-formula> storage and answers queries in time <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n + k)$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq36.gif"/></alternatives></inline-formula>, where <italic>k</italic> is the number of answers. Our contribution is to obtain similar results for a broader class of objects than those of&#x000a0;[<xref ref-type="bibr" rid="CR21">21</xref>], namely axis-aligned rectangles and objects with small union complexity. For axis-aligned rectangles our data structure uses <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\log n)$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq37.gif"/></alternatives></inline-formula> storage and has <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n\log ^* n + k\log n)$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mo>log</mml:mo><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq38.gif"/></alternatives></inline-formula> query time,<xref ref-type="fn" rid="Fn1">1</xref> where <italic>k</italic> is the number of reported pairs of objects. Our data structure for classes of objects with small union complexity&#x02014;disks and other types of fat objects are examples&#x02014;uses <inline-formula id="IEq40"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(U(n)\log n)$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq40.gif"/></alternatives></inline-formula> storage, where <italic>U</italic>(<italic>n</italic>) is maximum union complexity of <italic>n</italic> objects from the given class, and it has <inline-formula id="IEq41"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O((k+1)\log ^2 n)$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq41.gif"/></alternatives></inline-formula> query time. We also consider a 3-dimensional version of the problem, where the range <inline-formula id="IEq42"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M82"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq42.gif"/></alternatives></inline-formula> and the objects in <inline-formula id="IEq43"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M84"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq43.gif"/></alternatives></inline-formula> are axis-aligned boxes. Here our data structure uses <inline-formula id="IEq44"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\sqrt{n}\log n)$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq44.gif"/></alternatives></inline-formula> storage and <inline-formula id="IEq45"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O((\sqrt{n}+k)\log ^2 n)$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq45.gif"/></alternatives></inline-formula> query time. When the query range and the objects are fat, we improve this to <inline-formula id="IEq46"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\log ^2 n)$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq46.gif"/></alternatives></inline-formula> storage and <inline-formula id="IEq47"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O((k+1)\log ^2 n)$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq47.gif"/></alternatives></inline-formula> query time.</p><p id="Par7">
<italic>Related work</italic> The paper by Rahul&#x000a0;et al.&#x000a0;[<xref ref-type="bibr" rid="CR21">21</xref>] mentioned above studies the same problem as we do (in a less general setting). There are a few more papers dealing with related problems. Das&#x000a0;et al.&#x000a0;[<xref ref-type="bibr" rid="CR10">10</xref>] have studied the problem of preprocessing a set <italic>H</italic> of <italic>n</italic> horizontal and <italic>V</italic> of <italic>n</italic> vertical segments in the plane into a data structure such that given an axis-parallel query rectangle <inline-formula id="IEq48"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M94"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq48.gif"/></alternatives></inline-formula> and a parameter <inline-formula id="IEq49"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta $$\end{document}</tex-math><mml:math id="M96"><mml:mi mathvariant="italic">&#x003b4;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq49.gif"/></alternatives></inline-formula>, all the triples (<italic>h</italic>,&#x000a0;<italic>v</italic>,&#x000a0;<italic>p</italic>) where <inline-formula id="IEq50"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h\in H$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi>h</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq50.gif"/></alternatives></inline-formula>, <inline-formula id="IEq51"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v\in V$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>v</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq51.gif"/></alternatives></inline-formula>, and <italic>p</italic> is an endpoint of either of the segments and <inline-formula id="IEq52"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h\cap v\cap {Q}\ne \emptyset $$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mi>h</mml:mi><mml:mo>&#x02229;</mml:mo><mml:mi>v</mml:mi><mml:mo>&#x02229;</mml:mo><mml:mi>Q</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi mathvariant="normal">&#x02205;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq52.gif"/></alternatives></inline-formula> and <inline-formula id="IEq53"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dist(h\cap v,p)\leqslant \delta $$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo>&#x02229;</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02a7d;</mml:mo><mml:mi mathvariant="italic">&#x003b4;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq53.gif"/></alternatives></inline-formula> can be reported efficiently. Their data structure needs <inline-formula id="IEq54"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\log ^3 n)$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mo>log</mml:mo><mml:mn>3</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq54.gif"/></alternatives></inline-formula> space and is able to answer the desired queries in <inline-formula id="IEq55"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log ^2 n+\#\text{ answers })$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mo>#</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>answers</mml:mtext><mml:mspace width="0.333333em"/><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq55.gif"/></alternatives></inline-formula> time. Abam&#x000a0;et al.&#x000a0;[<xref ref-type="bibr" rid="CR1">1</xref>], Gupta&#x000a0;[<xref ref-type="bibr" rid="CR16">16</xref>], and Gupta&#x000a0;et al.&#x000a0;[<xref ref-type="bibr" rid="CR17">17</xref>] have presented data structures that return the closest pair inside a query range.</p></sec><sec id="Sec2"><title>Axis-Aligned Objects</title><p id="Par8">In this section we study the case where the set <inline-formula id="IEq56"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M110"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq56.gif"/></alternatives></inline-formula> is a set of <italic>n</italic> axis-aligned rectangles in <inline-formula id="IEq57"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^2$$\end{document}</tex-math><mml:math id="M112"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq57.gif"/></alternatives></inline-formula> or boxes in&#x000a0;<inline-formula id="IEq58"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^3$$\end{document}</tex-math><mml:math id="M114"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq58.gif"/></alternatives></inline-formula>. We assume throughout the paper that the objects in <inline-formula id="IEq59"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M116"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq59.gif"/></alternatives></inline-formula> as well as the query rectangles are closed sets. Our approach for these cases is the same and uses the following two-step query process.<list list-type="order"><list-item><p id="Par9">Compute a <italic>seed set</italic>
<inline-formula id="IEq60"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})\subseteq \mathcal {O}$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02286;</mml:mo><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq60.gif"/></alternatives></inline-formula> of objects such that the following holds: for any two objects <inline-formula id="IEq61"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i,o_j$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq61.gif"/></alternatives></inline-formula> in <inline-formula id="IEq62"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M122"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq62.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq63"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i$$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq63.gif"/></alternatives></inline-formula> and <inline-formula id="IEq64"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_j$$\end{document}</tex-math><mml:math id="M126"><mml:msub><mml:mi>o</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq64.gif"/></alternatives></inline-formula> intersect inside&#x000a0;<inline-formula id="IEq65"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M128"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq65.gif"/></alternatives></inline-formula>, at least one of <inline-formula id="IEq66"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i,o_j$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq66.gif"/></alternatives></inline-formula> is in <inline-formula id="IEq67"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq67.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par10">For each seed object <inline-formula id="IEq68"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i\in \mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq68.gif"/></alternatives></inline-formula>, perform an intersection query with the range <inline-formula id="IEq69"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i\cap {Q}$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq69.gif"/></alternatives></inline-formula> in the set <inline-formula id="IEq70"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M138"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq70.gif"/></alternatives></inline-formula>, to find all objects <inline-formula id="IEq71"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_j\ne o_i$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x02260;</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq71.gif"/></alternatives></inline-formula> intersecting <inline-formula id="IEq72"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq72.gif"/></alternatives></inline-formula> inside&#x000a0;<inline-formula id="IEq73"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M144"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq73.gif"/></alternatives></inline-formula>.</p></list-item></list>For this approach to be efficient,&#x000a0;<inline-formula id="IEq74"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq74.gif"/></alternatives></inline-formula> should not contain too many objects that do not give an answer in Step 2. For the planar case we will ensure <inline-formula id="IEq75"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\mathcal {O}^*({Q})| =O(1+k)$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq75.gif"/></alternatives></inline-formula>, where <italic>k</italic> is the number of pairs of objects intersecting inside&#x000a0;<inline-formula id="IEq76"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M150"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq76.gif"/></alternatives></inline-formula>, while for the 3-dimensional case we will have <inline-formula id="IEq77"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\mathcal {O}^*({Q})| =O(\sqrt{n}+k)$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq77.gif"/></alternatives></inline-formula>.</p><sec id="Sec3"><title>The Planar Case</title><p id="Par11">Let <inline-formula id="IEq78"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}=\{r_1,\ldots ,r_n\}$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq78.gif"/></alternatives></inline-formula> be a set of axis-aligned rectangles in <inline-formula id="IEq79"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^2$$\end{document}</tex-math><mml:math id="M156"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq79.gif"/></alternatives></inline-formula>. The key to our approach is to be able to efficiently find the seed set <inline-formula id="IEq80"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq80.gif"/></alternatives></inline-formula>. To this end, during the preprocessing we compute a set&#x000a0;<italic>W</italic> of axis-aligned <italic>witness segments</italic>. For each rectangle <inline-formula id="IEq81"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i\in \mathcal {O}$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq81.gif"/></alternatives></inline-formula> we define at most ten witness segments, two for each edge of <inline-formula id="IEq82"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq82.gif"/></alternatives></inline-formula> and two in the interior of <inline-formula id="IEq83"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq83.gif"/></alternatives></inline-formula>, as follows&#x02014;see also Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Gray areas are intersections of other rectangles with&#x000a0;<inline-formula id="IEq84"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq84.gif"/></alternatives></inline-formula> black segments indicate witness segments</p></caption><graphic xlink:href="453_2017_384_Fig1_HTML" id="MO1"/></fig>
</p><p id="Par12">Let <italic>e</italic> be an edge of <inline-formula id="IEq85"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M168"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq85.gif"/></alternatives></inline-formula>, and consider the set&#x000a0;<inline-formula id="IEq86"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S(e) := e \cap \left( \cup _{j\ne i} r_j\right) $$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mo>&#x02229;</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mo>&#x0222a;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq86.gif"/></alternatives></inline-formula>, that is, the part of <italic>e</italic> covered by the other rectangles. The set <italic>S</italic>(<italic>e</italic>) consists of a number of sub-edges of&#x000a0;<italic>e</italic>. If <italic>e</italic> is vertical then we add the topmost and bottommost sub-edge from <italic>S</italic>(<italic>e</italic>) (if any) to&#x000a0;<italic>W</italic>; if <italic>e</italic> is horizontal we add the leftmost and rightmost sub-edge to&#x000a0;<italic>W</italic>. The two witness segments in the interior of <inline-formula id="IEq87"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M172"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq87.gif"/></alternatives></inline-formula> are defined as follows. Suppose there are vertical edges (belonging to other rectangles&#x000a0;<inline-formula id="IEq88"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq88.gif"/></alternatives></inline-formula>) completely crossing <inline-formula id="IEq89"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M176"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq89.gif"/></alternatives></inline-formula> from top to bottom. Then we put <inline-formula id="IEq90"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e'\cap r_i$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq90.gif"/></alternatives></inline-formula> into&#x000a0;<italic>W</italic>, where <inline-formula id="IEq91"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e'$$\end{document}</tex-math><mml:math id="M180"><mml:msup><mml:mi>e</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq91.gif"/></alternatives></inline-formula> is the rightmost such crossing edge. Similarly, we put into <italic>W</italic> the topmost horizontal edge <inline-formula id="IEq92"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e''$$\end{document}</tex-math><mml:math id="M182"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq92.gif"/></alternatives></inline-formula> completely crossing <inline-formula id="IEq93"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq93.gif"/></alternatives></inline-formula> from left to right. Our data structure to find the seed set <inline-formula id="IEq94"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq94.gif"/></alternatives></inline-formula> now consists of the following components.<list list-type="bullet"><list-item><p id="Par13">We store the witness set <italic>W</italic> in a data structure <inline-formula id="IEq95"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_1$$\end{document}</tex-math><mml:math id="M188"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq95.gif"/></alternatives></inline-formula> that allows us to report the witness segments that intersect the query rectangle <inline-formula id="IEq96"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M190"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq96.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par14">We store the vertical edges of the rectangles in <inline-formula id="IEq97"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M192"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq97.gif"/></alternatives></inline-formula> in a data structure&#x000a0;<inline-formula id="IEq98"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_2$$\end{document}</tex-math><mml:math id="M194"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq98.gif"/></alternatives></inline-formula> that allows us to decide if the set <inline-formula id="IEq99"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textsf {V}}({Q})$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mi mathvariant="sans-serif">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq99.gif"/></alternatives></inline-formula> of edges that completely cross a query rectangle <inline-formula id="IEq100"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M198"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq100.gif"/></alternatives></inline-formula> from top to bottom, is non-empty. The data structure should also be able to report all (rectangles corresponding to) the edges in&#x000a0;<inline-formula id="IEq101"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textsf {V}}({Q})$$\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:mi mathvariant="sans-serif">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq101.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par15">We store the horizontal edges of the rectangles in <inline-formula id="IEq102"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M202"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq102.gif"/></alternatives></inline-formula> in a data structure&#x000a0;<inline-formula id="IEq103"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_3$$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq103.gif"/></alternatives></inline-formula> that allows us to decide if the set <inline-formula id="IEq104"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {H}({Q})$$\end{document}</tex-math><mml:math id="M206"><mml:mrow><mml:mi mathvariant="sans-serif">H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq104.gif"/></alternatives></inline-formula> of edges that completely cross a query rectangle <inline-formula id="IEq105"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M208"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq105.gif"/></alternatives></inline-formula> from left to right, is non-empty.</p></list-item><list-item><p id="Par16">We store the set <inline-formula id="IEq106"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M210"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq106.gif"/></alternatives></inline-formula> in a data structure <inline-formula id="IEq107"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_4$$\end{document}</tex-math><mml:math id="M212"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq107.gif"/></alternatives></inline-formula> that allows us to report the rectangles that contain a query point&#x000a0;<italic>q</italic>.</p><p id="Par17">Step&#x000a0;1 of the query procedure, where we compute <inline-formula id="IEq108"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq108.gif"/></alternatives></inline-formula>, proceeds as follows.<list list-type="order"><list-item><p id="Par18">Perform a query in <inline-formula id="IEq109"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_1$$\end{document}</tex-math><mml:math id="M216"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq109.gif"/></alternatives></inline-formula> to find all witness segments intersecting&#x000a0;<inline-formula id="IEq110"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M218"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq110.gif"/></alternatives></inline-formula>. For each reported witness segment, insert the corresponding rectangle into <inline-formula id="IEq111"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M220"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq111.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par19">Perform queries in <inline-formula id="IEq112"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_2$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq112.gif"/></alternatives></inline-formula> and <inline-formula id="IEq113"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_3$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq113.gif"/></alternatives></inline-formula> to decide if the sets <inline-formula id="IEq114"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textsf {V}}({Q})$$\end{document}</tex-math><mml:math id="M226"><mml:mrow><mml:mi mathvariant="sans-serif">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq114.gif"/></alternatives></inline-formula> and <inline-formula id="IEq115"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {H}({Q})$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:mi mathvariant="sans-serif">H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq115.gif"/></alternatives></inline-formula> are both non-empty. If so, report all rectangles corresponding to edges in <inline-formula id="IEq116"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textsf {V}}({Q})$$\end{document}</tex-math><mml:math id="M230"><mml:mrow><mml:mi mathvariant="sans-serif">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq116.gif"/></alternatives></inline-formula> and put them into&#x000a0;<inline-formula id="IEq117"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq117.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par20">For each corner point <italic>q</italic> of <inline-formula id="IEq118"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M234"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq118.gif"/></alternatives></inline-formula>, perform a query in <inline-formula id="IEq119"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_4$$\end{document}</tex-math><mml:math id="M236"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq119.gif"/></alternatives></inline-formula> to report all rectangles in <inline-formula id="IEq120"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M238"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq120.gif"/></alternatives></inline-formula> that contain <italic>q</italic>, and put them into&#x000a0;<inline-formula id="IEq121"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M240"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq121.gif"/></alternatives></inline-formula>.</p></list-item></list>
</p></list-item></list>The following lemma proves the correctness of our query procedure.</p><sec id="FPar1"><title>Lemma 1</title><p id="Par21">Let <inline-formula id="IEq122"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i,r_j$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq122.gif"/></alternatives></inline-formula> be two rectangles in <inline-formula id="IEq123"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M244"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq123.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq124"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(r_i\cap r_j) \cap {Q}\ne \emptyset $$\end{document}</tex-math><mml:math id="M246"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02229;</mml:mo><mml:mi>Q</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi mathvariant="normal">&#x02205;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq124.gif"/></alternatives></inline-formula>. Then at least one of <inline-formula id="IEq125"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i,r_j$$\end{document}</tex-math><mml:math id="M248"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq125.gif"/></alternatives></inline-formula> is put into <inline-formula id="IEq126"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M250"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq126.gif"/></alternatives></inline-formula> by the above query procedure.</p><p>
<fig id="Fig2"><label>Fig. 2</label><caption><p>Example of Case&#x000a0;B-3-I</p></caption><graphic xlink:href="453_2017_384_Fig2_HTML" id="MO2"/></fig>
</p></sec><sec id="FPar2"><title>Proof</title><p id="Par23">Let <inline-formula id="IEq127"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I:=(r_i\cap r_j) \cap {Q}$$\end{document}</tex-math><mml:math id="M252"><mml:mrow><mml:mi>I</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02229;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq127.gif"/></alternatives></inline-formula>. Each edge of <italic>I</italic> is either contributed by <inline-formula id="IEq128"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq128.gif"/></alternatives></inline-formula> or <inline-formula id="IEq129"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M256"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq129.gif"/></alternatives></inline-formula>, or by&#x000a0;<inline-formula id="IEq130"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M258"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq130.gif"/></alternatives></inline-formula>. Let <italic>E</italic>(<italic>I</italic>) denote the (possibly empty) set of edges of <inline-formula id="IEq131"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq131.gif"/></alternatives></inline-formula> and <inline-formula id="IEq132"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M262"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq132.gif"/></alternatives></inline-formula> that contribute an edge to&#x000a0;<italic>I</italic>. We distinguish two cases, with various subcases.</p><p id="Par24">
<sc>Case A:</sc> At least one edge <inline-formula id="IEq133"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e\in E(I)$$\end{document}</tex-math><mml:math id="M264"><mml:mrow><mml:mi>e</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq133.gif"/></alternatives></inline-formula> has an endpoint, <italic>v</italic>, inside <inline-formula id="IEq134"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M266"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq134.gif"/></alternatives></inline-formula>. Now the witness sub-edge on <italic>e</italic> closest to <italic>v</italic> must intersect <inline-formula id="IEq135"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M268"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq135.gif"/></alternatives></inline-formula> and, hence, the corresponding rectangle will be put into <inline-formula id="IEq136"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq136.gif"/></alternatives></inline-formula> in Step&#x000a0;1(i).</p><p id="Par25">
<sc>Case B:</sc> All edges in <italic>E</italic>(<italic>I</italic>) cross <inline-formula id="IEq137"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M272"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq137.gif"/></alternatives></inline-formula> completely. We now have several subcases.</p><p id="Par26">
<sc>Case B-1:</sc>
<inline-formula id="IEq138"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|E(I)|\leqslant 1$$\end{document}</tex-math><mml:math id="M274"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02a7d;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq138.gif"/></alternatives></inline-formula>. Now <inline-formula id="IEq139"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M276"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq139.gif"/></alternatives></inline-formula> contributes at least three edges to <italic>I</italic>, so at least one corner of&#x000a0;<italic>I</italic> is a corner of&#x000a0;<inline-formula id="IEq140"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M278"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq140.gif"/></alternatives></inline-formula>. Hence, both <inline-formula id="IEq141"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M280"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq141.gif"/></alternatives></inline-formula> and <inline-formula id="IEq142"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M282"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq142.gif"/></alternatives></inline-formula> are put into <inline-formula id="IEq143"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M284"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq143.gif"/></alternatives></inline-formula> in Step&#x000a0;1(iii).</p><p id="Par27">
<sc>Case B-2:</sc>
<inline-formula id="IEq144"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|E(I)|\geqslant 3$$\end{document}</tex-math><mml:math id="M286"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02a7e;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq144.gif"/></alternatives></inline-formula>. Since each edge of <italic>E</italic>(<italic>I</italic>) crosses <inline-formula id="IEq145"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M288"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq145.gif"/></alternatives></inline-formula> completely and <inline-formula id="IEq146"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|E(I)|\geqslant 3$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02a7e;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq146.gif"/></alternatives></inline-formula>, both <inline-formula id="IEq147"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textsf {V}}({Q})$$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:mi mathvariant="sans-serif">V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq147.gif"/></alternatives></inline-formula> and <inline-formula id="IEq148"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textsf {H}({Q})$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mi mathvariant="sans-serif">H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq148.gif"/></alternatives></inline-formula> are non-empty. Thus at least one of <inline-formula id="IEq149"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M296"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq149.gif"/></alternatives></inline-formula> and <inline-formula id="IEq150"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq150.gif"/></alternatives></inline-formula> is put into <inline-formula id="IEq151"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M300"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq151.gif"/></alternatives></inline-formula> in Step&#x000a0;2(ii).</p><p id="Par28">
<sc>Case B-3:</sc>
<inline-formula id="IEq152"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|E(I)|=2$$\end{document}</tex-math><mml:math id="M302"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq152.gif"/></alternatives></inline-formula>. Let <inline-formula id="IEq153"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_1$$\end{document}</tex-math><mml:math id="M304"><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq153.gif"/></alternatives></inline-formula> and <inline-formula id="IEq154"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_2$$\end{document}</tex-math><mml:math id="M306"><mml:msub><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq154.gif"/></alternatives></inline-formula> denote the segments in&#x000a0;<italic>E</italic>(<italic>I</italic>). If one of <inline-formula id="IEq155"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_1,e_2$$\end{document}</tex-math><mml:math id="M308"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq155.gif"/></alternatives></inline-formula> is vertical and the other is horizontal, we can use the argument from Case&#x000a0;B-2. It remains to handle the case where <inline-formula id="IEq156"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_1$$\end{document}</tex-math><mml:math id="M310"><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq156.gif"/></alternatives></inline-formula> and <inline-formula id="IEq157"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_2$$\end{document}</tex-math><mml:math id="M312"><mml:msub><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq157.gif"/></alternatives></inline-formula> have the same orientation, say vertical.</p><p id="Par29">
<sc>Case B-3-i:</sc> Edges <inline-formula id="IEq158"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_1$$\end{document}</tex-math><mml:math id="M314"><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq158.gif"/></alternatives></inline-formula> and <inline-formula id="IEq159"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_2$$\end{document}</tex-math><mml:math id="M316"><mml:msub><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq159.gif"/></alternatives></inline-formula> belong to the same rectangle, say <inline-formula id="IEq160"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M318"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq160.gif"/></alternatives></inline-formula>, as in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>. If <inline-formula id="IEq161"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_1$$\end{document}</tex-math><mml:math id="M320"><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq161.gif"/></alternatives></inline-formula> has an endpoint, <italic>v</italic>, inside <inline-formula id="IEq162"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M322"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq162.gif"/></alternatives></inline-formula>, then <inline-formula id="IEq163"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_1$$\end{document}</tex-math><mml:math id="M324"><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq163.gif"/></alternatives></inline-formula> has a witness sub-edge starting at <italic>v</italic> that intersects <inline-formula id="IEq164"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M326"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq164.gif"/></alternatives></inline-formula>, so <inline-formula id="IEq165"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M328"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq165.gif"/></alternatives></inline-formula> is put into <inline-formula id="IEq166"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M330"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq166.gif"/></alternatives></inline-formula> in Step 1(i). If <inline-formula id="IEq167"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M332"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq167.gif"/></alternatives></inline-formula> contains a corner of <inline-formula id="IEq168"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M334"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq168.gif"/></alternatives></inline-formula> then <inline-formula id="IEq169"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M336"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq169.gif"/></alternatives></inline-formula> will be put into <inline-formula id="IEq170"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M338"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq170.gif"/></alternatives></inline-formula> in Step&#x000a0;1(iii). In the remaining case the right edge of <inline-formula id="IEq171"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M340"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq171.gif"/></alternatives></inline-formula> crosses <inline-formula id="IEq172"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M342"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq172.gif"/></alternatives></inline-formula> and there are vertical edges completely crossing <inline-formula id="IEq173"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M344"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq173.gif"/></alternatives></inline-formula> (namely <inline-formula id="IEq174"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_1$$\end{document}</tex-math><mml:math id="M346"><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq174.gif"/></alternatives></inline-formula> and <inline-formula id="IEq175"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_2$$\end{document}</tex-math><mml:math id="M348"><mml:msub><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq175.gif"/></alternatives></inline-formula>). Hence, the rightmost edge completely crossing <inline-formula id="IEq176"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M350"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq176.gif"/></alternatives></inline-formula>, which is a witness for <inline-formula id="IEq177"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq177.gif"/></alternatives></inline-formula>, intersects&#x000a0;<inline-formula id="IEq178"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M354"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq178.gif"/></alternatives></inline-formula>. Thus <inline-formula id="IEq179"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M356"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq179.gif"/></alternatives></inline-formula> is put into <inline-formula id="IEq180"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M358"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq180.gif"/></alternatives></inline-formula> in Step&#x000a0;1(i).</p><p id="Par30">
<sc>Case B-3-ii:</sc> Edge <inline-formula id="IEq181"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_1$$\end{document}</tex-math><mml:math id="M360"><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq181.gif"/></alternatives></inline-formula> is an edge of <inline-formula id="IEq182"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq182.gif"/></alternatives></inline-formula> and <inline-formula id="IEq183"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_2$$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq183.gif"/></alternatives></inline-formula> is an edge of&#x000a0;<inline-formula id="IEq184"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M366"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq184.gif"/></alternatives></inline-formula> (or vice versa). Assume without loss of generality that the <italic>y</italic>-coordinate of the top endpoint of <inline-formula id="IEq185"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_1$$\end{document}</tex-math><mml:math id="M368"><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq185.gif"/></alternatives></inline-formula> is less than or equal to the <italic>y</italic>-coordinate of the top endpoint of <inline-formula id="IEq186"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_2$$\end{document}</tex-math><mml:math id="M370"><mml:msub><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq186.gif"/></alternatives></inline-formula>. Then the top endpoint, <italic>v</italic>, of <inline-formula id="IEq187"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_1$$\end{document}</tex-math><mml:math id="M372"><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq187.gif"/></alternatives></inline-formula> must lie in <inline-formula id="IEq188"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M374"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq188.gif"/></alternatives></inline-formula>, and so <inline-formula id="IEq189"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_1$$\end{document}</tex-math><mml:math id="M376"><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq189.gif"/></alternatives></inline-formula> has a witness sub-edge starting at <italic>v</italic> that intersects&#x000a0;<inline-formula id="IEq190"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M378"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq190.gif"/></alternatives></inline-formula>. Hence, <inline-formula id="IEq191"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M380"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq191.gif"/></alternatives></inline-formula> is put into <inline-formula id="IEq192"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M382"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq192.gif"/></alternatives></inline-formula> in Step&#x000a0;1(i). <inline-formula id="IEq193"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M384"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq193.gif"/></alternatives></inline-formula>
</p><p>In the second part of the query procedure we need to report, for each rectangle&#x000a0;<inline-formula id="IEq194"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M386"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq194.gif"/></alternatives></inline-formula> in the seed set&#x000a0;<inline-formula id="IEq195"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M388"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq195.gif"/></alternatives></inline-formula>, the rectangles <inline-formula id="IEq196"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j\in \mathcal {O}$$\end{document}</tex-math><mml:math id="M390"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq196.gif"/></alternatives></inline-formula> intersecting <inline-formula id="IEq197"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i\cap {Q}$$\end{document}</tex-math><mml:math id="M392"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq197.gif"/></alternatives></inline-formula>. Thus we store <inline-formula id="IEq198"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M394"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq198.gif"/></alternatives></inline-formula> in a data structure <inline-formula id="IEq199"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_5$$\end{document}</tex-math><mml:math id="M396"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq199.gif"/></alternatives></inline-formula> that can report all rectangles intersecting a query rectangle. Putting everything together we obtain the following theorem.</p></sec><sec id="FPar3"><title>Theorem 1</title><p id="Par32">Let <inline-formula id="IEq200"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M398"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq200.gif"/></alternatives></inline-formula> be a set of <italic>n</italic> axis-aligned rectangles in <inline-formula id="IEq201"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^2$$\end{document}</tex-math><mml:math id="M400"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq201.gif"/></alternatives></inline-formula>. There is a data structure that uses <inline-formula id="IEq202"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\log n)$$\end{document}</tex-math><mml:math id="M402"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq202.gif"/></alternatives></inline-formula> storage and can report, for any axis-aligned query rectangle&#x000a0;<inline-formula id="IEq203"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M404"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq203.gif"/></alternatives></inline-formula>, all pairs of rectangles <inline-formula id="IEq204"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i,r_j$$\end{document}</tex-math><mml:math id="M406"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq204.gif"/></alternatives></inline-formula> in <inline-formula id="IEq205"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M408"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq205.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq206"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M410"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq206.gif"/></alternatives></inline-formula> intersects <inline-formula id="IEq207"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M412"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq207.gif"/></alternatives></inline-formula> inside <inline-formula id="IEq208"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M414"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq208.gif"/></alternatives></inline-formula> in <inline-formula id="IEq209"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O((k+1)\log n)$$\end{document}</tex-math><mml:math id="M416"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq209.gif"/></alternatives></inline-formula> time, where <italic>k</italic> denotes the number of answers.</p></sec><sec id="FPar4"><title>Proof</title><p id="Par33">For the data structure <inline-formula id="IEq210"><alternatives><tex-math id="M417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_1$$\end{document}</tex-math><mml:math id="M418"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq210.gif"/></alternatives></inline-formula> on the set&#x000a0;<italic>W</italic> we use the data structure developed by Edelsbrunner&#x000a0;et al.&#x000a0;[<xref ref-type="bibr" rid="CR13">13</xref>], which uses <inline-formula id="IEq211"><alternatives><tex-math id="M419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\log n)$$\end{document}</tex-math><mml:math id="M420"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq211.gif"/></alternatives></inline-formula> preprocessing time and storage, and has <inline-formula id="IEq212"><alternatives><tex-math id="M421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n + \#\text{ answers })$$\end{document}</tex-math><mml:math id="M422"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mo>#</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>answers</mml:mtext><mml:mspace width="0.333333em"/><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq212.gif"/></alternatives></inline-formula> query time. For data structure <inline-formula id="IEq213"><alternatives><tex-math id="M423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_2$$\end{document}</tex-math><mml:math id="M424"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq213.gif"/></alternatives></inline-formula> (and, similarly, <inline-formula id="IEq214"><alternatives><tex-math id="M425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_3$$\end{document}</tex-math><mml:math id="M426"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq214.gif"/></alternatives></inline-formula>) we note that a vertical segment <inline-formula id="IEq215"><alternatives><tex-math id="M427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_i := x_i \times [y_i,y'_i]$$\end{document}</tex-math><mml:math id="M428"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq215.gif"/></alternatives></inline-formula> crosses <inline-formula id="IEq216"><alternatives><tex-math id="M429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}:= [x_{{Q}},x'_{{Q}}]\times [y_{{Q}},y'_{{Q}}]$$\end{document}</tex-math><mml:math id="M430"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>Q</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>Q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>Q</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>Q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq216.gif"/></alternatives></inline-formula> if and only if the point <inline-formula id="IEq217"><alternatives><tex-math id="M431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(x_i,y_i,y'_i)$$\end{document}</tex-math><mml:math id="M432"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq217.gif"/></alternatives></inline-formula> lies in the range <inline-formula id="IEq218"><alternatives><tex-math id="M433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[x_{{Q}},x'_{{Q}}]\times [-\infty ,y_{{Q}}]\times [y'_{{Q}},\infty ]$$\end{document}</tex-math><mml:math id="M434"><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>Q</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>Q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>-</mml:mo><mml:mi>&#x0221e;</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>Q</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>Q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi>&#x0221e;</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq218.gif"/></alternatives></inline-formula>. Hence, we can use the data structure of Afshani&#x000a0;et al.&#x000a0;[<xref ref-type="bibr" rid="CR2">2</xref>], which uses <inline-formula id="IEq219"><alternatives><tex-math id="M435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\log n/\log \log n)$$\end{document}</tex-math><mml:math id="M436"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mo>log</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq219.gif"/></alternatives></inline-formula> storage and has <inline-formula id="IEq220"><alternatives><tex-math id="M437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n + \#\text{ answers })$$\end{document}</tex-math><mml:math id="M438"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mo>#</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>answers</mml:mtext><mml:mspace width="0.333333em"/><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq220.gif"/></alternatives></inline-formula> query time. For data structure <inline-formula id="IEq221"><alternatives><tex-math id="M439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_4$$\end{document}</tex-math><mml:math id="M440"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq221.gif"/></alternatives></inline-formula> we use the point-enclosure data structure developed by Chazelle&#x000a0;[<xref ref-type="bibr" rid="CR6">6</xref>], which uses <italic>O</italic>(<italic>n</italic>) storage and can be used to report all rectangles in <inline-formula id="IEq222"><alternatives><tex-math id="M441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M442"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq222.gif"/></alternatives></inline-formula> containing a query point in <inline-formula id="IEq223"><alternatives><tex-math id="M443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n +\# \text{ answers })$$\end{document}</tex-math><mml:math id="M444"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mo>#</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>answers</mml:mtext><mml:mspace width="0.333333em"/><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq223.gif"/></alternatives></inline-formula> time.</p><p id="Par34">Note that <inline-formula id="IEq224"><alternatives><tex-math id="M445">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\mathcal {O}^*({Q})|\leqslant 2k+4$$\end{document}</tex-math><mml:math id="M446"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02a7d;</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq224.gif"/></alternatives></inline-formula> where <italic>k</italic> is the total number of reported pairs. Indeed, each rectangle in <inline-formula id="IEq225"><alternatives><tex-math id="M447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M448"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq225.gif"/></alternatives></inline-formula> intersects at least one other rectangle inside <inline-formula id="IEq226"><alternatives><tex-math id="M449">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M450"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq226.gif"/></alternatives></inline-formula> and for every reported pair we put at most two rectangles into the seed set; the extra term &#x0201c;+4&#x0201d; is because in Step&#x000a0;1 (iii) we may report at most one rectangle per corner of&#x000a0;<inline-formula id="IEq227"><alternatives><tex-math id="M451">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M452"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq227.gif"/></alternatives></inline-formula> that does not have an intersection inside&#x000a0;<inline-formula id="IEq228"><alternatives><tex-math id="M453">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M454"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq228.gif"/></alternatives></inline-formula>. Hence, the time for Step&#x000a0;1 is <inline-formula id="IEq229"><alternatives><tex-math id="M455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n + |\mathcal {O}^*({Q})|) = O(\log n +k)$$\end{document}</tex-math><mml:math id="M456"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq229.gif"/></alternatives></inline-formula>.</p><p id="Par35">It remains to analyze Step&#x000a0;2 of the query procedure, where we need to find for a given <inline-formula id="IEq230"><alternatives><tex-math id="M457">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i \in \mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M458"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq230.gif"/></alternatives></inline-formula> all <inline-formula id="IEq231"><alternatives><tex-math id="M459">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j\in \mathcal {O}$$\end{document}</tex-math><mml:math id="M460"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq231.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq232"><alternatives><tex-math id="M461">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i\cap {Q}$$\end{document}</tex-math><mml:math id="M462"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq232.gif"/></alternatives></inline-formula> intersects <inline-formula id="IEq233"><alternatives><tex-math id="M463">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M464"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq233.gif"/></alternatives></inline-formula>. First notice that a rectangle <inline-formula id="IEq234"><alternatives><tex-math id="M465">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M466"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq234.gif"/></alternatives></inline-formula> intersects a rectangle <inline-formula id="IEq235"><alternatives><tex-math id="M467">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r'_i := r_i\cap Q$$\end{document}</tex-math><mml:math id="M468"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq235.gif"/></alternatives></inline-formula> if and only if (i) a corner of <inline-formula id="IEq236"><alternatives><tex-math id="M469">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M470"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq236.gif"/></alternatives></inline-formula> is inside <inline-formula id="IEq237"><alternatives><tex-math id="M471">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r'_i$$\end{document}</tex-math><mml:math id="M472"><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq237.gif"/></alternatives></inline-formula>, or (ii) a corner of <inline-formula id="IEq238"><alternatives><tex-math id="M473">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r'_i$$\end{document}</tex-math><mml:math id="M474"><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq238.gif"/></alternatives></inline-formula> is inside <inline-formula id="IEq239"><alternatives><tex-math id="M475">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M476"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq239.gif"/></alternatives></inline-formula>, or (iii) an edge of <inline-formula id="IEq240"><alternatives><tex-math id="M477">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M478"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq240.gif"/></alternatives></inline-formula> intersects an edge of <inline-formula id="IEq241"><alternatives><tex-math id="M479">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r'_i$$\end{document}</tex-math><mml:math id="M480"><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq241.gif"/></alternatives></inline-formula>. Thus <inline-formula id="IEq242"><alternatives><tex-math id="M481">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_5$$\end{document}</tex-math><mml:math id="M482"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq242.gif"/></alternatives></inline-formula> consists of three components: All <inline-formula id="IEq243"><alternatives><tex-math id="M483">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M484"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq243.gif"/></alternatives></inline-formula> satisfying&#x000a0;(i) can be found in <inline-formula id="IEq244"><alternatives><tex-math id="M485">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n +\# \text{ answers })$$\end{document}</tex-math><mml:math id="M486"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mo>#</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>answers</mml:mtext><mml:mspace width="0.333333em"/><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq244.gif"/></alternatives></inline-formula> time using a range tree with fractional cascading&#x000a0;[<xref ref-type="bibr" rid="CR11">11</xref>], which uses <inline-formula id="IEq245"><alternatives><tex-math id="M487">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\log n)$$\end{document}</tex-math><mml:math id="M488"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq245.gif"/></alternatives></inline-formula> storage. All <inline-formula id="IEq246"><alternatives><tex-math id="M489">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M490"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq246.gif"/></alternatives></inline-formula> satisfying&#x000a0;(ii) and (iii) can be found using, respectively, the data structure by Chazelle&#x000a0;[<xref ref-type="bibr" rid="CR6">6</xref>] and the one by Edelsbrunner&#x000a0;et al.&#x000a0;[<xref ref-type="bibr" rid="CR13">13</xref>]. Thus the running time of Step&#x000a0;2 is <inline-formula id="IEq247"><alternatives><tex-math id="M491">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{r_i\in \mathcal {O}^*({Q})} O(\log n + k_i)$$\end{document}</tex-math><mml:math id="M492"><mml:mrow><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq247.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq248"><alternatives><tex-math id="M493">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_i$$\end{document}</tex-math><mml:math id="M494"><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq248.gif"/></alternatives></inline-formula> denotes the number of rectangles in <inline-formula id="IEq249"><alternatives><tex-math id="M495">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M496"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq249.gif"/></alternatives></inline-formula> that intersect <inline-formula id="IEq250"><alternatives><tex-math id="M497">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i$$\end{document}</tex-math><mml:math id="M498"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq250.gif"/></alternatives></inline-formula> inside <inline-formula id="IEq251"><alternatives><tex-math id="M499">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M500"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq251.gif"/></alternatives></inline-formula>, and so the total time for Step&#x000a0;2 is <inline-formula id="IEq252"><alternatives><tex-math id="M501">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O((k+1)\log n)$$\end{document}</tex-math><mml:math id="M502"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq252.gif"/></alternatives></inline-formula>. <inline-formula id="IEq253"><alternatives><tex-math id="M503">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M504"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq253.gif"/></alternatives></inline-formula>
</p></sec></sec><sec id="Sec4"><title>The 3-Dimensional Case</title><p id="Par36">We now study the case where the set <inline-formula id="IEq254"><alternatives><tex-math id="M505">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M506"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq254.gif"/></alternatives></inline-formula> of objects and the query range <inline-formula id="IEq255"><alternatives><tex-math id="M507">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M508"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq255.gif"/></alternatives></inline-formula> are axis-aligned boxes in <inline-formula id="IEq256"><alternatives><tex-math id="M509">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^3$$\end{document}</tex-math><mml:math id="M510"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq256.gif"/></alternatives></inline-formula>. We first present a solution for the general case, and then an improved solution for the special case where the input as well as the query are cubes. Both solutions use the same query strategy as above: we first find a seed set <inline-formula id="IEq257"><alternatives><tex-math id="M511">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M512"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq257.gif"/></alternatives></inline-formula> that contains at least one object <inline-formula id="IEq258"><alternatives><tex-math id="M513">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i$$\end{document}</tex-math><mml:math id="M514"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq258.gif"/></alternatives></inline-formula> from every pair that intersects inside&#x000a0;<inline-formula id="IEq259"><alternatives><tex-math id="M515">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M516"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq259.gif"/></alternatives></inline-formula> and then we find all other objects intersecting&#x000a0;<inline-formula id="IEq260"><alternatives><tex-math id="M517">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i$$\end{document}</tex-math><mml:math id="M518"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq260.gif"/></alternatives></inline-formula> inside <inline-formula id="IEq261"><alternatives><tex-math id="M519">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M520"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq261.gif"/></alternatives></inline-formula>.</p><p id="Par37">
<bold>The general case</bold> Let <inline-formula id="IEq262"><alternatives><tex-math id="M521">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}:= \{b_1,\ldots ,b_n\}$$\end{document}</tex-math><mml:math id="M522"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq262.gif"/></alternatives></inline-formula> be a set of axis-aligned boxes. The pairs of boxes <inline-formula id="IEq263"><alternatives><tex-math id="M523">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i,b_j$$\end{document}</tex-math><mml:math id="M524"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq263.gif"/></alternatives></inline-formula> intersecting inside <inline-formula id="IEq264"><alternatives><tex-math id="M525">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M526"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq264.gif"/></alternatives></inline-formula> come in three types: (i)&#x000a0;<inline-formula id="IEq265"><alternatives><tex-math id="M527">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i\cap b_j$$\end{document}</tex-math><mml:math id="M528"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq265.gif"/></alternatives></inline-formula> fully contains <inline-formula id="IEq266"><alternatives><tex-math id="M529">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M530"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq266.gif"/></alternatives></inline-formula>, (ii)&#x000a0;<inline-formula id="IEq267"><alternatives><tex-math id="M531">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i\cap b_j$$\end{document}</tex-math><mml:math id="M532"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq267.gif"/></alternatives></inline-formula> lies completely inside <inline-formula id="IEq268"><alternatives><tex-math id="M533">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M534"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq268.gif"/></alternatives></inline-formula>, (iii)&#x000a0;<inline-formula id="IEq269"><alternatives><tex-math id="M535">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i\cap b_j$$\end{document}</tex-math><mml:math id="M536"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq269.gif"/></alternatives></inline-formula> intersects a face of <inline-formula id="IEq270"><alternatives><tex-math id="M537">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M538"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq270.gif"/></alternatives></inline-formula>.</p><p id="Par38">Type&#x000a0;(i) is easy to handle without using seed sets: we simply store <inline-formula id="IEq271"><alternatives><tex-math id="M539">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M540"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq271.gif"/></alternatives></inline-formula> in a data structure for 3-dimensional point-enclosure queries&#x000a0;[<xref ref-type="bibr" rid="CR19">19</xref>], which allows us to report all boxes <inline-formula id="IEq272"><alternatives><tex-math id="M541">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i\in \mathcal {O}$$\end{document}</tex-math><mml:math id="M542"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq272.gif"/></alternatives></inline-formula> containing a query point in <inline-formula id="IEq273"><alternatives><tex-math id="M543">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log ^2 n\cdot \log \log n+\#\text{ answers })$$\end{document}</tex-math><mml:math id="M544"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mo>log</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mo>#</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>answers</mml:mtext><mml:mspace width="0.333333em"/><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq273.gif"/></alternatives></inline-formula> time. If we query this structure with a corner&#x000a0;<italic>q</italic> of <inline-formula id="IEq274"><alternatives><tex-math id="M545">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M546"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq274.gif"/></alternatives></inline-formula> and report all pairs of boxes containing&#x000a0;<italic>q</italic> then we have found all intersecting pairs of Type&#x000a0;(i).</p><sec id="FPar5"><title>Lemma 2</title><p id="Par39">We can find all intersecting pairs of boxes of Type&#x000a0;(i) in <inline-formula id="IEq275"><alternatives><tex-math id="M547">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log ^2 n\cdot \log \log n+k)$$\end{document}</tex-math><mml:math id="M548"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mo>log</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq275.gif"/></alternatives></inline-formula> time, where <italic>k</italic> is the number of such pairs, with a structure of size&#x000a0;<inline-formula id="IEq276"><alternatives><tex-math id="M549">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\log ^* n)$$\end{document}</tex-math><mml:math id="M550"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mo>log</mml:mo><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq276.gif"/></alternatives></inline-formula>.</p></sec><sec id="FPar6"><title>Remark</title><p id="Par40">The query bound in Lemma&#x000a0;<xref ref-type="sec" rid="FPar5">2</xref> can be improved to <inline-formula id="IEq277"><alternatives><tex-math id="M551">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log ^2 n+k)$$\end{document}</tex-math><mml:math id="M552"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq277.gif"/></alternatives></inline-formula> at the cost of <inline-formula id="IEq278"><alternatives><tex-math id="M553">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\log n)$$\end{document}</tex-math><mml:math id="M554"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq278.gif"/></alternatives></inline-formula> storage, by using the data structure of Afshani&#x000a0;et al.&#x000a0;[<xref ref-type="bibr" rid="CR3">3</xref>] instead of that of Rahul&#x000a0;[<xref ref-type="bibr" rid="CR19">19</xref>].</p><p id="Par41">For Type&#x000a0;(ii) we proceed as follows. Note that a vertex of <inline-formula id="IEq279"><alternatives><tex-math id="M555">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i\cap b_j$$\end{document}</tex-math><mml:math id="M556"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq279.gif"/></alternatives></inline-formula> is either a vertex of <inline-formula id="IEq280"><alternatives><tex-math id="M557">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i$$\end{document}</tex-math><mml:math id="M558"><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq280.gif"/></alternatives></inline-formula> or <inline-formula id="IEq281"><alternatives><tex-math id="M559">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_j$$\end{document}</tex-math><mml:math id="M560"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq281.gif"/></alternatives></inline-formula>, or it is the intersection of an edge&#x000a0;<italic>e</italic> of one of these two boxes and a face&#x000a0;<italic>f</italic> of the other box. To handle the first case we create a set <italic>W</italic> of witness points, which contains for each box <inline-formula id="IEq282"><alternatives><tex-math id="M561">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i$$\end{document}</tex-math><mml:math id="M562"><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq282.gif"/></alternatives></inline-formula> all its vertices that are contained in at least one other box. We store&#x000a0;<italic>W</italic> in a data structure for 3-dimensional orthogonal range reporting&#x000a0;[<xref ref-type="bibr" rid="CR3">3</xref>]. In the query phase we then query this data structure with&#x000a0;<inline-formula id="IEq283"><alternatives><tex-math id="M563">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M564"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq283.gif"/></alternatives></inline-formula>, and put all boxes corresponding to the witness vertices inside&#x000a0;<inline-formula id="IEq284"><alternatives><tex-math id="M565">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M566"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq284.gif"/></alternatives></inline-formula> into the seed set&#x000a0;<inline-formula id="IEq285"><alternatives><tex-math id="M567">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M568"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq285.gif"/></alternatives></inline-formula>. For the second case we show next how to find the intersecting pairs <italic>e</italic>,&#x000a0;<italic>f</italic> where <italic>e</italic> is a vertical edge (that is, parallel to the <italic>z</italic>-axis) and <italic>f</italic> is a horizontal face (that is, parallel to the <italic>xy</italic>-plane); the intersecting pairs with other orientations can be found in a similar way.</p><p id="Par42">Let <italic>E</italic> be the set of vertical edges of the boxes in <inline-formula id="IEq286"><alternatives><tex-math id="M569">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M570"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq286.gif"/></alternatives></inline-formula> and let <italic>F</italic> be the set of horizontal faces. We sort <italic>F</italic> by <italic>z</italic>-coordinate&#x02014;we assume for simplicity that all <italic>z</italic>-coordinates of the faces are distinct&#x02014;and partition <italic>F</italic> into <inline-formula id="IEq287"><alternatives><tex-math id="M571">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\sqrt{n})$$\end{document}</tex-math><mml:math id="M572"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq287.gif"/></alternatives></inline-formula>
<italic>clusters</italic>: the cluster&#x000a0;<inline-formula id="IEq288"><alternatives><tex-math id="M573">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_1$$\end{document}</tex-math><mml:math id="M574"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq288.gif"/></alternatives></inline-formula> contains the first <inline-formula id="IEq289"><alternatives><tex-math id="M575">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sqrt{n}$$\end{document}</tex-math><mml:math id="M576"><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq289.gif"/></alternatives></inline-formula> faces in the sorted order, the second cluster&#x000a0;<inline-formula id="IEq290"><alternatives><tex-math id="M577">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_2$$\end{document}</tex-math><mml:math id="M578"><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq290.gif"/></alternatives></inline-formula> contains the next <inline-formula id="IEq291"><alternatives><tex-math id="M579">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sqrt{n}$$\end{document}</tex-math><mml:math id="M580"><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq291.gif"/></alternatives></inline-formula> faces, and so on. We call the range between the minimum and maximum <italic>z</italic>-coordinate in a cluster its <italic>z-range</italic>. For each cluster <inline-formula id="IEq292"><alternatives><tex-math id="M581">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_i$$\end{document}</tex-math><mml:math id="M582"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq292.gif"/></alternatives></inline-formula> we store, besides its <italic>z</italic>-range and the set <inline-formula id="IEq293"><alternatives><tex-math id="M583">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_i$$\end{document}</tex-math><mml:math id="M584"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq293.gif"/></alternatives></inline-formula> itself, the following information. Let <inline-formula id="IEq294"><alternatives><tex-math id="M585">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_i\subseteq E$$\end{document}</tex-math><mml:math id="M586"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02286;</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq294.gif"/></alternatives></inline-formula> be the subset of edges that intersect at least one face in&#x000a0;<inline-formula id="IEq295"><alternatives><tex-math id="M587">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_i$$\end{document}</tex-math><mml:math id="M588"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq295.gif"/></alternatives></inline-formula>, and let <inline-formula id="IEq296"><alternatives><tex-math id="M589">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{E_i}$$\end{document}</tex-math><mml:math id="M590"><mml:mover><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq296.gif"/></alternatives></inline-formula> denote the set of points obtained by projecting the edges in <inline-formula id="IEq297"><alternatives><tex-math id="M591">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_i$$\end{document}</tex-math><mml:math id="M592"><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq297.gif"/></alternatives></inline-formula> onto the <italic>xy</italic>-plane. We store <inline-formula id="IEq298"><alternatives><tex-math id="M593">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{E_i}$$\end{document}</tex-math><mml:math id="M594"><mml:mover><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq298.gif"/></alternatives></inline-formula> in a data structure <inline-formula id="IEq299"><alternatives><tex-math id="M595">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}(\overline{E_i})$$\end{document}</tex-math><mml:math id="M596"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq299.gif"/></alternatives></inline-formula> for 2-dimensional orthogonal range reporting. Note that for a query box&#x000a0;<inline-formula id="IEq300"><alternatives><tex-math id="M597">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M598"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq300.gif"/></alternatives></inline-formula> whose <italic>z</italic>-range contains the <italic>z</italic>-range of <inline-formula id="IEq301"><alternatives><tex-math id="M599">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_i$$\end{document}</tex-math><mml:math id="M600"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq301.gif"/></alternatives></inline-formula> we have: an edge <inline-formula id="IEq302"><alternatives><tex-math id="M601">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e\in E$$\end{document}</tex-math><mml:math id="M602"><mml:mrow><mml:mi>e</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq302.gif"/></alternatives></inline-formula> intersects at least one face <inline-formula id="IEq303"><alternatives><tex-math id="M603">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f\in F_i$$\end{document}</tex-math><mml:math id="M604"><mml:mrow><mml:mi>f</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq303.gif"/></alternatives></inline-formula> inside <inline-formula id="IEq304"><alternatives><tex-math id="M605">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M606"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq304.gif"/></alternatives></inline-formula> if and only if <inline-formula id="IEq305"><alternatives><tex-math id="M607">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e\in E_i$$\end{document}</tex-math><mml:math id="M608"><mml:mrow><mml:mi>e</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq305.gif"/></alternatives></inline-formula> and <inline-formula id="IEq306"><alternatives><tex-math id="M609">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{e}$$\end{document}</tex-math><mml:math id="M610"><mml:mover><mml:mi>e</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq306.gif"/></alternatives></inline-formula> lies in <inline-formula id="IEq307"><alternatives><tex-math id="M611">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{{Q}}$$\end{document}</tex-math><mml:math id="M612"><mml:mover><mml:mi>Q</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq307.gif"/></alternatives></inline-formula>, the projection of <inline-formula id="IEq308"><alternatives><tex-math id="M613">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M614"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq308.gif"/></alternatives></inline-formula> onto the <italic>xy</italic>-plane.</p><p id="Par43">A query with a box&#x000a0;<inline-formula id="IEq309"><alternatives><tex-math id="M615">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}=[x_1:x_2]\times [y_1:y_2]\times [z_1:z_2]$$\end{document}</tex-math><mml:math id="M616"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq309.gif"/></alternatives></inline-formula> is now answered as follows. We first find the clusters <inline-formula id="IEq310"><alternatives><tex-math id="M617">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_i$$\end{document}</tex-math><mml:math id="M618"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq310.gif"/></alternatives></inline-formula> and <inline-formula id="IEq311"><alternatives><tex-math id="M619">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_j$$\end{document}</tex-math><mml:math id="M620"><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq311.gif"/></alternatives></inline-formula> whose <italic>z</italic>-range contains <inline-formula id="IEq312"><alternatives><tex-math id="M621">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_1$$\end{document}</tex-math><mml:math id="M622"><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq312.gif"/></alternatives></inline-formula> and&#x000a0;<inline-formula id="IEq313"><alternatives><tex-math id="M623">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_2$$\end{document}</tex-math><mml:math id="M624"><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq313.gif"/></alternatives></inline-formula>, respectively, and we put (the boxes corresponding to) the faces in these clusters into the seed set <inline-formula id="IEq314"><alternatives><tex-math id="M625">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M626"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq314.gif"/></alternatives></inline-formula>. Next we perform, for each <inline-formula id="IEq315"><alternatives><tex-math id="M627">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i&#x0003c;t&#x0003c;j$$\end{document}</tex-math><mml:math id="M628"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq315.gif"/></alternatives></inline-formula>, a query with the projected range <inline-formula id="IEq316"><alternatives><tex-math id="M629">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{{Q}}$$\end{document}</tex-math><mml:math id="M630"><mml:mover><mml:mi>Q</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq316.gif"/></alternatives></inline-formula> in the data structure&#x000a0;<inline-formula id="IEq317"><alternatives><tex-math id="M631">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}(\overline{E_t})$$\end{document}</tex-math><mml:math id="M632"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover><mml:msub><mml:mi>E</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq317.gif"/></alternatives></inline-formula>. For each of the reported points <inline-formula id="IEq318"><alternatives><tex-math id="M633">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{e}$$\end{document}</tex-math><mml:math id="M634"><mml:mover><mml:mi>e</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq318.gif"/></alternatives></inline-formula> we put the box corresponding to the edge <italic>e</italic> into the seed set&#x000a0;<inline-formula id="IEq319"><alternatives><tex-math id="M635">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M636"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq319.gif"/></alternatives></inline-formula>. Finally, we remove any duplicates from the seed set. This leads to the following lemma.</p></sec><sec id="FPar7"><title>Lemma 3</title><p id="Par44">Using a data structure of size <inline-formula id="IEq320"><alternatives><tex-math id="M637">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\sqrt{n}\log ^\varepsilon n)$$\end{document}</tex-math><mml:math id="M638"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:msup><mml:mo>log</mml:mo><mml:mi mathvariant="italic">&#x003b5;</mml:mi></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq320.gif"/></alternatives></inline-formula> we can find in time <inline-formula id="IEq321"><alternatives><tex-math id="M639">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\sqrt{n}\log n + k)$$\end{document}</tex-math><mml:math id="M640"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq321.gif"/></alternatives></inline-formula> a seed set <inline-formula id="IEq322"><alternatives><tex-math id="M641">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M642"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq322.gif"/></alternatives></inline-formula> of <inline-formula id="IEq323"><alternatives><tex-math id="M643">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\sqrt{n}+k)$$\end{document}</tex-math><mml:math id="M644"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq323.gif"/></alternatives></inline-formula> boxes containing at least one box from every intersecting pair of Type&#x000a0;(ii), where <italic>k</italic> is the number of such pairs. Here <inline-formula id="IEq324"><alternatives><tex-math id="M645">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon &#x0003e;0$$\end{document}</tex-math><mml:math id="M646"><mml:mrow><mml:mi mathvariant="italic">&#x003b5;</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq324.gif"/></alternatives></inline-formula> is an arbitrary small, but fixed, positive constant.</p></sec><sec id="FPar8"><title>Proof</title><p id="Par45">The Type&#x000a0;(ii) intersections <inline-formula id="IEq325"><alternatives><tex-math id="M647">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i \cap b_j$$\end{document}</tex-math><mml:math id="M648"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq325.gif"/></alternatives></inline-formula> either have a vertex that is a vertex of <inline-formula id="IEq326"><alternatives><tex-math id="M649">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i$$\end{document}</tex-math><mml:math id="M650"><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq326.gif"/></alternatives></inline-formula> or <inline-formula id="IEq327"><alternatives><tex-math id="M651">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_j$$\end{document}</tex-math><mml:math id="M652"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq327.gif"/></alternatives></inline-formula> inside&#x000a0;<inline-formula id="IEq328"><alternatives><tex-math id="M653">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M654"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq328.gif"/></alternatives></inline-formula>, or they have an edge-face pair intersecting inside&#x000a0;<inline-formula id="IEq329"><alternatives><tex-math id="M655">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M656"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq329.gif"/></alternatives></inline-formula>. To find seed objects for the former pairs we used <inline-formula id="IEq330"><alternatives><tex-math id="M657">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n(\log n/\log \log n)^2)$$\end{document}</tex-math><mml:math id="M658"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mo>log</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq330.gif"/></alternatives></inline-formula> storage and <inline-formula id="IEq331"><alternatives><tex-math id="M659">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n + k)$$\end{document}</tex-math><mml:math id="M660"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq331.gif"/></alternatives></inline-formula> query time&#x000a0;[<xref ref-type="bibr" rid="CR3">3</xref>], and we put <italic>O</italic>(<italic>k</italic>) boxes into the seed set. For the latter pairs, we used an approach based on clusters. For each cluster&#x000a0;<inline-formula id="IEq332"><alternatives><tex-math id="M661">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_i$$\end{document}</tex-math><mml:math id="M662"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq332.gif"/></alternatives></inline-formula> we have a data structure <inline-formula id="IEq333"><alternatives><tex-math id="M663">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}(\overline{E_i})$$\end{document}</tex-math><mml:math id="M664"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq333.gif"/></alternatives></inline-formula>, namely the 2-dimensional orthogonal range reporting structure of Chazelle&#x000a0;[<xref ref-type="bibr" rid="CR7">7</xref>], that uses <inline-formula id="IEq334"><alternatives><tex-math id="M665">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\log ^\varepsilon n)$$\end{document}</tex-math><mml:math id="M666"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mo>log</mml:mo><mml:mi mathvariant="italic">&#x003b5;</mml:mi></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq334.gif"/></alternatives></inline-formula> storage, giving <inline-formula id="IEq335"><alternatives><tex-math id="M667">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\sqrt{n}\log ^\varepsilon n)$$\end{document}</tex-math><mml:math id="M668"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:msup><mml:mo>log</mml:mo><mml:mi mathvariant="italic">&#x003b5;</mml:mi></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq335.gif"/></alternatives></inline-formula> storage in total. Besides the <inline-formula id="IEq336"><alternatives><tex-math id="M669">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\sqrt{n})$$\end{document}</tex-math><mml:math id="M670"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq336.gif"/></alternatives></inline-formula> boxes in the two clusters <inline-formula id="IEq337"><alternatives><tex-math id="M671">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_i$$\end{document}</tex-math><mml:math id="M672"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq337.gif"/></alternatives></inline-formula> and <inline-formula id="IEq338"><alternatives><tex-math id="M673">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_j$$\end{document}</tex-math><mml:math id="M674"><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq338.gif"/></alternatives></inline-formula>, we put boxes into the seed set for the clusters <inline-formula id="IEq339"><alternatives><tex-math id="M675">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_t$$\end{document}</tex-math><mml:math id="M676"><mml:msub><mml:mi>F</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq339.gif"/></alternatives></inline-formula> with <inline-formula id="IEq340"><alternatives><tex-math id="M677">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i&#x0003c;t&#x0003c;j$$\end{document}</tex-math><mml:math id="M678"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq340.gif"/></alternatives></inline-formula>, namely when querying the data structures&#x000a0;<inline-formula id="IEq341"><alternatives><tex-math id="M679">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}(\overline{E_t})$$\end{document}</tex-math><mml:math id="M680"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover><mml:msub><mml:mi>E</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq341.gif"/></alternatives></inline-formula>. This means that the same box may be put into <inline-formula id="IEq342"><alternatives><tex-math id="M681">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M682"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq342.gif"/></alternatives></inline-formula> up to <inline-formula id="IEq343"><alternatives><tex-math id="M683">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sqrt{n}$$\end{document}</tex-math><mml:math id="M684"><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq343.gif"/></alternatives></inline-formula> times. (Note that these duplicates are later removed.) However, each copy we put into the seed set for some <inline-formula id="IEq344"><alternatives><tex-math id="M685">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_t$$\end{document}</tex-math><mml:math id="M686"><mml:msub><mml:mi>F</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq344.gif"/></alternatives></inline-formula> corresponds to a different intersecting pair. Together with the fact that the query time in each <inline-formula id="IEq345"><alternatives><tex-math id="M687">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}(\overline{E_t})$$\end{document}</tex-math><mml:math id="M688"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover><mml:msub><mml:mi>E</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq345.gif"/></alternatives></inline-formula> is <inline-formula id="IEq346"><alternatives><tex-math id="M689">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n +\# \text{ answers })$$\end{document}</tex-math><mml:math id="M690"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mo>#</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>answers</mml:mtext><mml:mspace width="0.333333em"/><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq346.gif"/></alternatives></inline-formula> this means the total query time and size of the seed set are as claimed. <inline-formula id="IEq347"><alternatives><tex-math id="M691">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M692"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq347.gif"/></alternatives></inline-formula>
</p><p>It remains to handle the Type&#x000a0;(iii) pairs, in which <inline-formula id="IEq348"><alternatives><tex-math id="M693">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i\cap b_j$$\end{document}</tex-math><mml:math id="M694"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq348.gif"/></alternatives></inline-formula> intersects a face of&#x000a0;<inline-formula id="IEq349"><alternatives><tex-math id="M695">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M696"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq349.gif"/></alternatives></inline-formula>. We describe how to find the pairs such that <inline-formula id="IEq350"><alternatives><tex-math id="M697">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i\cap b_j$$\end{document}</tex-math><mml:math id="M698"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq350.gif"/></alternatives></inline-formula> intersects the bottom face of&#x000a0;<inline-formula id="IEq351"><alternatives><tex-math id="M699">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M700"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq351.gif"/></alternatives></inline-formula>; the pairs intersecting the other faces can be found in a similar way.</p><p>We first sort the <italic>z</italic>-coordinates of the horizontal faces of the boxes in <inline-formula id="IEq352"><alternatives><tex-math id="M701">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M702"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq352.gif"/></alternatives></inline-formula>. For <inline-formula id="IEq353"><alternatives><tex-math id="M703">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\leqslant i\leqslant 2\sqrt{n}$$\end{document}</tex-math><mml:math id="M704"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02a7d;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02a7d;</mml:mo><mml:mn>2</mml:mn><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq353.gif"/></alternatives></inline-formula>, let <inline-formula id="IEq354"><alternatives><tex-math id="M705">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h_i$$\end{document}</tex-math><mml:math id="M706"><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq354.gif"/></alternatives></inline-formula> be a horizontal plane containing the <inline-formula id="IEq355"><alternatives><tex-math id="M707">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(i\sqrt{n})$$\end{document}</tex-math><mml:math id="M708"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq355.gif"/></alternatives></inline-formula>th horizontal face. These planes partition <inline-formula id="IEq356"><alternatives><tex-math id="M709">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^3$$\end{document}</tex-math><mml:math id="M710"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq356.gif"/></alternatives></inline-formula> into <inline-formula id="IEq357"><alternatives><tex-math id="M711">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\sqrt{n})$$\end{document}</tex-math><mml:math id="M712"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq357.gif"/></alternatives></inline-formula> horizontal slabs <inline-formula id="IEq358"><alternatives><tex-math id="M713">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _0,\ldots ,\Sigma _{2\sqrt{n}+1}$$\end{document}</tex-math><mml:math id="M714"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x003a3;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x003a3;</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq358.gif"/></alternatives></inline-formula>. We call a box <inline-formula id="IEq359"><alternatives><tex-math id="M715">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b\in \mathcal {O}$$\end{document}</tex-math><mml:math id="M716"><mml:mrow><mml:mi>b</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq359.gif"/></alternatives></inline-formula>
<italic>short</italic> at&#x000a0;<inline-formula id="IEq360"><alternatives><tex-math id="M717">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _i$$\end{document}</tex-math><mml:math id="M718"><mml:msub><mml:mi mathvariant="normal">&#x003a3;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq360.gif"/></alternatives></inline-formula> if it has a horizontal face inside&#x000a0;<inline-formula id="IEq361"><alternatives><tex-math id="M719">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _i$$\end{document}</tex-math><mml:math id="M720"><mml:msub><mml:mi mathvariant="normal">&#x003a3;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq361.gif"/></alternatives></inline-formula>, and we call it <italic>long</italic> if it completely crosses&#x000a0;<inline-formula id="IEq362"><alternatives><tex-math id="M721">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _i$$\end{document}</tex-math><mml:math id="M722"><mml:msub><mml:mi mathvariant="normal">&#x003a3;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq362.gif"/></alternatives></inline-formula>. For each <inline-formula id="IEq363"><alternatives><tex-math id="M723">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _i$$\end{document}</tex-math><mml:math id="M724"><mml:msub><mml:mi mathvariant="normal">&#x003a3;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq363.gif"/></alternatives></inline-formula>, we store the short boxes in a list. We store the projections of the long boxes onto the <italic>xy</italic>-plane in a data structure <inline-formula id="IEq364"><alternatives><tex-math id="M725">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}(\Sigma _i)$$\end{document}</tex-math><mml:math id="M726"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x003a3;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq364.gif"/></alternatives></inline-formula> for the 2-dimensional version of the problem, namely the structure of Theorem&#x000a0;<xref ref-type="sec" rid="FPar3">1</xref>.</p><p>A query with the bottom face of&#x000a0;<inline-formula id="IEq365"><alternatives><tex-math id="M727">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M728"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq365.gif"/></alternatives></inline-formula> is now answered as follows. We first find the slab <inline-formula id="IEq366"><alternatives><tex-math id="M729">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _i$$\end{document}</tex-math><mml:math id="M730"><mml:msub><mml:mi mathvariant="normal">&#x003a3;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq366.gif"/></alternatives></inline-formula> containing the face. We put all short boxes of <inline-formula id="IEq367"><alternatives><tex-math id="M731">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _i$$\end{document}</tex-math><mml:math id="M732"><mml:msub><mml:mi mathvariant="normal">&#x003a3;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq367.gif"/></alternatives></inline-formula> into our seed set <inline-formula id="IEq368"><alternatives><tex-math id="M733">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M734"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq368.gif"/></alternatives></inline-formula>. We then perform a query with <inline-formula id="IEq369"><alternatives><tex-math id="M735">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{{Q}}$$\end{document}</tex-math><mml:math id="M736"><mml:mover><mml:mi>Q</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq369.gif"/></alternatives></inline-formula>, the projection of <inline-formula id="IEq370"><alternatives><tex-math id="M737">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M738"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq370.gif"/></alternatives></inline-formula> onto the <italic>xy</italic>-plane, in the data structure <inline-formula id="IEq371"><alternatives><tex-math id="M739">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}(\Sigma _i)$$\end{document}</tex-math><mml:math id="M740"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x003a3;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq371.gif"/></alternatives></inline-formula>. For each answer we get from this 2-dimensional query&#x02014;that is, each pair of projections intersecting inside <inline-formula id="IEq372"><alternatives><tex-math id="M741">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{Q}$$\end{document}</tex-math><mml:math id="M742"><mml:mover><mml:mi>Q</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq372.gif"/></alternatives></inline-formula>&#x02014;we directly report the corresponding pair of long boxes. (There is no need to go through the seed set for these pairs.) This leads to the following lemma for the Type&#x000a0;(iii) pairs.</p></sec><sec id="FPar9"><title>Lemma 4</title><p id="Par49">Using a data structure of size <inline-formula id="IEq373"><alternatives><tex-math id="M743">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\sqrt{n}\log n)$$\end{document}</tex-math><mml:math id="M744"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq373.gif"/></alternatives></inline-formula> we can find in time <inline-formula id="IEq374"><alternatives><tex-math id="M745">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\sqrt{n}+k\log n)$$\end{document}</tex-math><mml:math id="M746"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq374.gif"/></alternatives></inline-formula> a seed set <inline-formula id="IEq375"><alternatives><tex-math id="M747">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M748"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq375.gif"/></alternatives></inline-formula> of <inline-formula id="IEq376"><alternatives><tex-math id="M749">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\sqrt{n})$$\end{document}</tex-math><mml:math id="M750"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq376.gif"/></alternatives></inline-formula> boxes plus a collection <inline-formula id="IEq377"><alternatives><tex-math id="M751">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B({Q})$$\end{document}</tex-math><mml:math id="M752"><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq377.gif"/></alternatives></inline-formula> of pairs of boxes intersecting inside <inline-formula id="IEq378"><alternatives><tex-math id="M753">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M754"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq378.gif"/></alternatives></inline-formula> such that, for each pair of Type&#x000a0;(iii) boxes, either at least one of these boxes is in <inline-formula id="IEq379"><alternatives><tex-math id="M755">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M756"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq379.gif"/></alternatives></inline-formula> or <inline-formula id="IEq380"><alternatives><tex-math id="M757">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i,b_j$$\end{document}</tex-math><mml:math id="M758"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq380.gif"/></alternatives></inline-formula> is a pair in <inline-formula id="IEq381"><alternatives><tex-math id="M759">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B({Q})$$\end{document}</tex-math><mml:math id="M760"><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq381.gif"/></alternatives></inline-formula>.</p><p>In Step&#x000a0;2 of our query procedure we need to report all boxes <inline-formula id="IEq382"><alternatives><tex-math id="M761">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_j\in \mathcal {O}$$\end{document}</tex-math><mml:math id="M762"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq382.gif"/></alternatives></inline-formula> intersecting a query box <inline-formula id="IEq383"><alternatives><tex-math id="M763">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B:={Q}\cap b_i$$\end{document}</tex-math><mml:math id="M764"><mml:mrow><mml:mi>B</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>Q</mml:mi><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq383.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq384"><alternatives><tex-math id="M765">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i\in \mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M766"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq384.gif"/></alternatives></inline-formula>. Note that <italic>B</italic> intersects <inline-formula id="IEq385"><alternatives><tex-math id="M767">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_j$$\end{document}</tex-math><mml:math id="M768"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq385.gif"/></alternatives></inline-formula> if (i)&#x000a0;<italic>B</italic> contains a vertex of <inline-formula id="IEq386"><alternatives><tex-math id="M769">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_j$$\end{document}</tex-math><mml:math id="M770"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq386.gif"/></alternatives></inline-formula>, or (ii)&#x000a0;a vertex of <italic>B</italic> is contained in&#x000a0;<inline-formula id="IEq387"><alternatives><tex-math id="M771">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_j$$\end{document}</tex-math><mml:math id="M772"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq387.gif"/></alternatives></inline-formula>, or (iii)&#x000a0;an edge <italic>e</italic> of <italic>B</italic> intersects a face of <inline-formula id="IEq388"><alternatives><tex-math id="M773">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_j$$\end{document}</tex-math><mml:math id="M774"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq388.gif"/></alternatives></inline-formula>, or (iv)&#x000a0;a face <italic>f</italic> of <italic>B</italic> intersects an edge of <inline-formula id="IEq389"><alternatives><tex-math id="M775">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_j$$\end{document}</tex-math><mml:math id="M776"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq389.gif"/></alternatives></inline-formula>. We build a data structure <inline-formula id="IEq390"><alternatives><tex-math id="M777">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}^*$$\end{document}</tex-math><mml:math id="M778"><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq390.gif"/></alternatives></inline-formula> consisting of several components to handle all of the cases.</p><p>All <inline-formula id="IEq391"><alternatives><tex-math id="M779">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_j$$\end{document}</tex-math><mml:math id="M780"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq391.gif"/></alternatives></inline-formula> satisfying&#x000a0;(i) and&#x000a0;(ii) can be found using a 3-dimensional range reporting data structure and the 3-dimensional point-enclosure data structure of Afshani&#x000a0;et al.&#x000a0;[<xref ref-type="bibr" rid="CR3">3</xref>]. Next we present the components of <inline-formula id="IEq392"><alternatives><tex-math id="M781">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}^*$$\end{document}</tex-math><mml:math id="M782"><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq392.gif"/></alternatives></inline-formula> needed to deal with (iii) and (iv).</p><p>For&#x000a0;(iii), assume <italic>e</italic> is parallel to the <italic>z</italic>-axis and consider the faces of <inline-formula id="IEq393"><alternatives><tex-math id="M783">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_j$$\end{document}</tex-math><mml:math id="M784"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq393.gif"/></alternatives></inline-formula> parallel to the <italic>xy</italic>-plane. Then we can use a 2-level structure whose first level is a tree on the <italic>z</italic>-coordinates of the faces, and whose second-level structures are 2-dimensional point-enclosure structures&#x000a0;[<xref ref-type="bibr" rid="CR6">6</xref>] on the projections onto the <italic>xy</italic>-plane. Note that <italic>e</italic> intersects a face <italic>f</italic> if and only if the <italic>z</italic>-coordinate of <italic>f</italic> lies in the <italic>z</italic>-range of <italic>e</italic>, and the projection of <italic>e</italic> onto the <italic>xy</italic>-plane lies inside the projection of <italic>f</italic> onto the <italic>xy</italic>-plane. A query with an edge <italic>e</italic> is now answered as follows. We first query the first level of tree with the <italic>z</italic>-range of <italic>e</italic> to locate <inline-formula id="IEq394"><alternatives><tex-math id="M785">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n)$$\end{document}</tex-math><mml:math id="M786"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq394.gif"/></alternatives></inline-formula> canonical nodes whose union covers the set of all faces whose <italic>z</italic>-coordinates lie in the queried range. We then query the associated structures of each of the selected nodes with the projection of <italic>e</italic> onto the <italic>xy</italic>-plane to report all faces that contain the point corresponding to the projected edge. Since the point-enclosure data structure uses <inline-formula id="IEq395"><alternatives><tex-math id="M787">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\log n)$$\end{document}</tex-math><mml:math id="M788"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq395.gif"/></alternatives></inline-formula> storage and has <inline-formula id="IEq396"><alternatives><tex-math id="M789">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n)$$\end{document}</tex-math><mml:math id="M790"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq396.gif"/></alternatives></inline-formula> query time, this component of <inline-formula id="IEq397"><alternatives><tex-math id="M791">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}^*$$\end{document}</tex-math><mml:math id="M792"><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq397.gif"/></alternatives></inline-formula> needs <inline-formula id="IEq398"><alternatives><tex-math id="M793">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\log ^2 n)$$\end{document}</tex-math><mml:math id="M794"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq398.gif"/></alternatives></inline-formula> storage and a query can be answered in <inline-formula id="IEq399"><alternatives><tex-math id="M795">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log ^2 n + \# \text{ answers })$$\end{document}</tex-math><mml:math id="M796"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mo>#</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>answers</mml:mtext><mml:mspace width="0.333333em"/><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq399.gif"/></alternatives></inline-formula> time.</p><p>For (iv), we build a 2-level structure whose first level is a segment tree storing all the edges of all boxes. Each node <inline-formula id="IEq400"><alternatives><tex-math id="M797">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu $$\end{document}</tex-math><mml:math id="M798"><mml:mi mathvariant="italic">&#x003bd;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq400.gif"/></alternatives></inline-formula> of the first level is then associated with a 2D range tree storing the points corresponding to projections of the edges stored at the subtree rooted at <inline-formula id="IEq401"><alternatives><tex-math id="M799">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu $$\end{document}</tex-math><mml:math id="M800"><mml:mi mathvariant="italic">&#x003bd;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq401.gif"/></alternatives></inline-formula> onto the <italic>xy</italic>-plane. Now a query with a face <italic>f</italic> parallel to <italic>xy</italic>-plane can be answered as follows. We first query the first level of the structure with the <italic>z</italic>-coordinate of <italic>f</italic> to find a collection of <inline-formula id="IEq402"><alternatives><tex-math id="M801">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n)$$\end{document}</tex-math><mml:math id="M802"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq402.gif"/></alternatives></inline-formula> canonical nodes that together contain the set of edges whose <italic>z</italic>-ranges contain the queried <italic>y</italic>-coordinate. We then query the associated structures of each of the selected nodes with the projection of <italic>f</italic> onto the <italic>xy</italic>-plane to report all edges whose corresponding projections onto the <italic>xy</italic>-plane lie inside the queried projected range. Since this component of <inline-formula id="IEq403"><alternatives><tex-math id="M803">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}^*$$\end{document}</tex-math><mml:math id="M804"><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq403.gif"/></alternatives></inline-formula> needs <inline-formula id="IEq404"><alternatives><tex-math id="M805">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\log ^2 n)$$\end{document}</tex-math><mml:math id="M806"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq404.gif"/></alternatives></inline-formula> storage and a query can be answered in only <inline-formula id="IEq405"><alternatives><tex-math id="M807">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log ^2 n +\# \text{ answers })$$\end{document}</tex-math><mml:math id="M808"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mo>#</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>answers</mml:mtext><mml:mspace width="0.333333em"/><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq405.gif"/></alternatives></inline-formula> time we end up with the following theorem.</p></sec><sec id="FPar10"><title>Theorem 2</title><p id="Par54">Let <inline-formula id="IEq406"><alternatives><tex-math id="M809">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M810"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq406.gif"/></alternatives></inline-formula> be a set of <italic>n</italic> axis-aligned boxes in&#x000a0;<inline-formula id="IEq407"><alternatives><tex-math id="M811">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^3$$\end{document}</tex-math><mml:math id="M812"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq407.gif"/></alternatives></inline-formula>. Then there is a data structure that uses <inline-formula id="IEq408"><alternatives><tex-math id="M813">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\sqrt{n}\log n)$$\end{document}</tex-math><mml:math id="M814"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq408.gif"/></alternatives></inline-formula> storage and that allows us to report, for any axis-aligned query box&#x000a0;<inline-formula id="IEq409"><alternatives><tex-math id="M815">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M816"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq409.gif"/></alternatives></inline-formula>, all pairs of boxes <inline-formula id="IEq410"><alternatives><tex-math id="M817">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i,b_j$$\end{document}</tex-math><mml:math id="M818"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq410.gif"/></alternatives></inline-formula> in <inline-formula id="IEq411"><alternatives><tex-math id="M819">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M820"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq411.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq412"><alternatives><tex-math id="M821">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i$$\end{document}</tex-math><mml:math id="M822"><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq412.gif"/></alternatives></inline-formula> intersects <inline-formula id="IEq413"><alternatives><tex-math id="M823">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_j$$\end{document}</tex-math><mml:math id="M824"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq413.gif"/></alternatives></inline-formula> inside <inline-formula id="IEq414"><alternatives><tex-math id="M825">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M826"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq414.gif"/></alternatives></inline-formula> in <inline-formula id="IEq415"><alternatives><tex-math id="M827">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O((\sqrt{n} + k)\log ^2 n)$$\end{document}</tex-math><mml:math id="M828"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq415.gif"/></alternatives></inline-formula> time, where <italic>k</italic> denotes the number of answers.</p><p>As observed by Rahul&#x000a0;[<xref ref-type="bibr" rid="CR20">20</xref>] one can prove a conditional lower bound for our 3-dimensional queries by a reduction from set intersection queries. The set intersection query problem is to preprocess <italic>m</italic> sets <inline-formula id="IEq416"><alternatives><tex-math id="M829">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_1,S_2,\ldots ,S_m$$\end{document}</tex-math><mml:math id="M830"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq416.gif"/></alternatives></inline-formula> of positive real numbers into a data structure that supports set intersection queries asking whether or not the sets <inline-formula id="IEq417"><alternatives><tex-math id="M831">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i$$\end{document}</tex-math><mml:math id="M832"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq417.gif"/></alternatives></inline-formula> and <inline-formula id="IEq418"><alternatives><tex-math id="M833">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_j$$\end{document}</tex-math><mml:math id="M834"><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq418.gif"/></alternatives></inline-formula> are disjoint, for given query indices <italic>i</italic> and <italic>j</italic>. Davoodi&#x000a0;et al.&#x000a0;[<xref ref-type="bibr" rid="CR9">9</xref>] make the following conjecture. Here <inline-formula id="IEq419"><alternatives><tex-math id="M835">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{O}(\cdot )$$\end{document}</tex-math><mml:math id="M836"><mml:mrow><mml:mover accent="true"><mml:mi>O</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq419.gif"/></alternatives></inline-formula> and <inline-formula id="IEq420"><alternatives><tex-math id="M837">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\mathrm{\Omega }}(\cdot )$$\end{document}</tex-math><mml:math id="M838"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq420.gif"/></alternatives></inline-formula> hide polylog-factors.</p></sec><sec id="FPar11"><title>Conjecture 1</title><p id="Par56">Given a collection of <italic>m</italic> sets of <italic>N</italic> real numbers in total, where the maximum cardinality of the sets in polylogarithmic in <italic>m</italic>, any real-RAM data structure that supports set intersection queries in <inline-formula id="IEq421"><alternatives><tex-math id="M839">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{O}(t)$$\end{document}</tex-math><mml:math id="M840"><mml:mrow><mml:mover accent="true"><mml:mi>O</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq421.gif"/></alternatives></inline-formula> time without using the floor function, requires <inline-formula id="IEq422"><alternatives><tex-math id="M841">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\mathrm{\Omega }}((N/t)^2)$$\end{document}</tex-math><mml:math id="M842"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq422.gif"/></alternatives></inline-formula> storage, for <inline-formula id="IEq423"><alternatives><tex-math id="M843">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\leqslant t\leqslant N$$\end{document}</tex-math><mml:math id="M844"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02a7d;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02a7d;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq423.gif"/></alternatives></inline-formula>.</p><p>Davoodi&#x000a0;et al.&#x000a0;[<xref ref-type="bibr" rid="CR9">9</xref>] use this conjecture for a conditional lower bound for diameter queries. As observed by Rahul&#x000a0;[<xref ref-type="bibr" rid="CR20">20</xref>], we can also use it to prove a conditional lower bound for our problem, as described next.</p><p>Let <inline-formula id="IEq424"><alternatives><tex-math id="M845">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_1,S_2,\ldots ,S_m$$\end{document}</tex-math><mml:math id="M846"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq424.gif"/></alternatives></inline-formula> be a collection of sets and let <inline-formula id="IEq425"><alternatives><tex-math id="M847">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=\sum _{i=1}^{m}|S_i|$$\end{document}</tex-math><mml:math id="M848"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq425.gif"/></alternatives></inline-formula>. We transform the sets into a set of 2<italic>N</italic> boxes in <inline-formula id="IEq426"><alternatives><tex-math id="M849">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^3$$\end{document}</tex-math><mml:math id="M850"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq426.gif"/></alternatives></inline-formula>. We map each element <inline-formula id="IEq427"><alternatives><tex-math id="M851">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_r\in S_i$$\end{document}</tex-math><mml:math id="M852"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq427.gif"/></alternatives></inline-formula> into two boxes <inline-formula id="IEq428"><alternatives><tex-math id="M853">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_1(i,z_r)$$\end{document}</tex-math><mml:math id="M854"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq428.gif"/></alternatives></inline-formula> and <inline-formula id="IEq429"><alternatives><tex-math id="M855">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_2(i,z_r)$$\end{document}</tex-math><mml:math id="M856"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq429.gif"/></alternatives></inline-formula> as follows, letting <inline-formula id="IEq430"><alternatives><tex-math id="M857">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M:=2m+1$$\end{document}</tex-math><mml:math id="M858"><mml:mrow><mml:mi>M</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq430.gif"/></alternatives></inline-formula>. We set <inline-formula id="IEq431"><alternatives><tex-math id="M859">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_1(i,z_r):=[2i-1,2i]\times [0,M]\times z_r$$\end{document}</tex-math><mml:math id="M860"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq431.gif"/></alternatives></inline-formula>, and we set <inline-formula id="IEq432"><alternatives><tex-math id="M861">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_2(i,z_r):=[0,M]\times [2i-1,2i]\times z_r$$\end{document}</tex-math><mml:math id="M862"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq432.gif"/></alternatives></inline-formula>. Note that the boxes of all elements of <inline-formula id="IEq433"><alternatives><tex-math id="M863">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i$$\end{document}</tex-math><mml:math id="M864"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq433.gif"/></alternatives></inline-formula> will have the same <italic>xy</italic>-projections. Only their <italic>z</italic>-ranges are different. See Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>a for an example. In addition, notice that for <inline-formula id="IEq434"><alternatives><tex-math id="M865">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_r\in S_i$$\end{document}</tex-math><mml:math id="M866"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq434.gif"/></alternatives></inline-formula> and <inline-formula id="IEq435"><alternatives><tex-math id="M867">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_r\in S_j$$\end{document}</tex-math><mml:math id="M868"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq435.gif"/></alternatives></inline-formula> with <inline-formula id="IEq436"><alternatives><tex-math id="M869">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\ne j$$\end{document}</tex-math><mml:math id="M870"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq436.gif"/></alternatives></inline-formula> the boxes <inline-formula id="IEq437"><alternatives><tex-math id="M871">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_1(i,z_r)$$\end{document}</tex-math><mml:math id="M872"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq437.gif"/></alternatives></inline-formula> and <inline-formula id="IEq438"><alternatives><tex-math id="M873">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_2(j,z_r)$$\end{document}</tex-math><mml:math id="M874"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq438.gif"/></alternatives></inline-formula> (as well as the boxes <inline-formula id="IEq439"><alternatives><tex-math id="M875">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_1(j,z_r)$$\end{document}</tex-math><mml:math id="M876"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq439.gif"/></alternatives></inline-formula> and <inline-formula id="IEq440"><alternatives><tex-math id="M877">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_2(i,z_r)$$\end{document}</tex-math><mml:math id="M878"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq440.gif"/></alternatives></inline-formula>) intersect each other at <inline-formula id="IEq441"><alternatives><tex-math id="M879">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z=z_r$$\end{document}</tex-math><mml:math id="M880"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq441.gif"/></alternatives></inline-formula>. Also, for <inline-formula id="IEq442"><alternatives><tex-math id="M881">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_r\in S_i$$\end{document}</tex-math><mml:math id="M882"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq442.gif"/></alternatives></inline-formula> and <inline-formula id="IEq443"><alternatives><tex-math id="M883">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z'_r\in S_j$$\end{document}</tex-math><mml:math id="M884"><mml:mrow><mml:msubsup><mml:mi>z</mml:mi><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq443.gif"/></alternatives></inline-formula> with <inline-formula id="IEq444"><alternatives><tex-math id="M885">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_r\ne z'_r$$\end{document}</tex-math><mml:math id="M886"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>&#x02260;</mml:mo><mml:msubsup><mml:mi>z</mml:mi><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq444.gif"/></alternatives></inline-formula> none of the corresponding boxes of <inline-formula id="IEq445"><alternatives><tex-math id="M887">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i$$\end{document}</tex-math><mml:math id="M888"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq445.gif"/></alternatives></inline-formula> and <inline-formula id="IEq446"><alternatives><tex-math id="M889">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_j$$\end{document}</tex-math><mml:math id="M890"><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq446.gif"/></alternatives></inline-formula> intersect each other, since they have different <italic>z</italic>-ranges. Therefore, to verify the disjointness of <inline-formula id="IEq447"><alternatives><tex-math id="M891">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i$$\end{document}</tex-math><mml:math id="M892"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq447.gif"/></alternatives></inline-formula> and <inline-formula id="IEq448"><alternatives><tex-math id="M893">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_j$$\end{document}</tex-math><mml:math id="M894"><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq448.gif"/></alternatives></inline-formula>, we ask to check if there is a pair of boxes that intersect each other inside the range <inline-formula id="IEq449"><alternatives><tex-math id="M895">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[2i-3/4,2i-1/4] \times [2j-3/4,2j-1/4] \times (-\infty ,+\infty )$$\end{document}</tex-math><mml:math id="M896"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>&#x0221e;</mml:mi><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi>&#x0221e;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq449.gif"/></alternatives></inline-formula>. See Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>b for an illustration.<fig id="Fig3"><label>Fig. 3</label><caption><p>Left figure: the two boxes at height <inline-formula id="IEq450"><alternatives><tex-math id="M897">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_r$$\end{document}</tex-math><mml:math id="M898"><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq450.gif"/></alternatives></inline-formula> (resp. <inline-formula id="IEq451"><alternatives><tex-math id="M899">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_{r'}$$\end{document}</tex-math><mml:math id="M900"><mml:msub><mml:mi>z</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq451.gif"/></alternatives></inline-formula>) are the boxes <inline-formula id="IEq452"><alternatives><tex-math id="M901">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_1(i,z_r)$$\end{document}</tex-math><mml:math id="M902"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq452.gif"/></alternatives></inline-formula> and <inline-formula id="IEq453"><alternatives><tex-math id="M903">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_2(i,z_r)$$\end{document}</tex-math><mml:math id="M904"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq453.gif"/></alternatives></inline-formula> (resp. <inline-formula id="IEq454"><alternatives><tex-math id="M905">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_1(i,z_{r'}),b_2(i,z_{r'})$$\end{document}</tex-math><mml:math id="M906"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq454.gif"/></alternatives></inline-formula>) for some integer <inline-formula id="IEq455"><alternatives><tex-math id="M907">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\leqslant i\leqslant m$$\end{document}</tex-math><mml:math id="M908"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02a7d;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02a7d;</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq455.gif"/></alternatives></inline-formula> and <inline-formula id="IEq456"><alternatives><tex-math id="M909">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_r\in S_i$$\end{document}</tex-math><mml:math id="M910"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq456.gif"/></alternatives></inline-formula> (resp. <inline-formula id="IEq457"><alternatives><tex-math id="M911">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_{r'}\in S_i$$\end{document}</tex-math><mml:math id="M912"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq457.gif"/></alternatives></inline-formula>). Right figure: the two blue boxes are the boxes <inline-formula id="IEq458"><alternatives><tex-math id="M913">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_1(i,z_r)$$\end{document}</tex-math><mml:math id="M914"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq458.gif"/></alternatives></inline-formula> and <inline-formula id="IEq459"><alternatives><tex-math id="M915">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_2(i,z_r)$$\end{document}</tex-math><mml:math id="M916"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq459.gif"/></alternatives></inline-formula> for some integer <inline-formula id="IEq460"><alternatives><tex-math id="M917">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\leqslant i\leqslant m$$\end{document}</tex-math><mml:math id="M918"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02a7d;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02a7d;</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq460.gif"/></alternatives></inline-formula> and <inline-formula id="IEq461"><alternatives><tex-math id="M919">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_r\in S_i$$\end{document}</tex-math><mml:math id="M920"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq461.gif"/></alternatives></inline-formula>. The two red boxes are the boxes <inline-formula id="IEq462"><alternatives><tex-math id="M921">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_1(j,z_r)$$\end{document}</tex-math><mml:math id="M922"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq462.gif"/></alternatives></inline-formula> and <inline-formula id="IEq463"><alternatives><tex-math id="M923">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_2(j,z_r)$$\end{document}</tex-math><mml:math id="M924"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq463.gif"/></alternatives></inline-formula> for some integer <inline-formula id="IEq464"><alternatives><tex-math id="M925">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\leqslant j\leqslant m$$\end{document}</tex-math><mml:math id="M926"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02a7d;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02a7d;</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq464.gif"/></alternatives></inline-formula> with <inline-formula id="IEq465"><alternatives><tex-math id="M927">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j\ne i$$\end{document}</tex-math><mml:math id="M928"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq465.gif"/></alternatives></inline-formula> and <inline-formula id="IEq466"><alternatives><tex-math id="M929">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_r\in S_j$$\end{document}</tex-math><mml:math id="M930"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq466.gif"/></alternatives></inline-formula>. Either of the two red-blue intersections verifies the non-disjointness of <inline-formula id="IEq467"><alternatives><tex-math id="M931">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_i$$\end{document}</tex-math><mml:math id="M932"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq467.gif"/></alternatives></inline-formula> and <inline-formula id="IEq468"><alternatives><tex-math id="M933">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_j$$\end{document}</tex-math><mml:math id="M934"><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq468.gif"/></alternatives></inline-formula> (Color figure online)</p></caption><graphic xlink:href="453_2017_384_Fig3_HTML" id="MO3"/></fig>
</p><p>The above reduction implies the following result.</p></sec><sec id="FPar12"><title>Theorem 3</title><p id="Par60">Suppose we have a data structure storing a set <inline-formula id="IEq469"><alternatives><tex-math id="M935">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M936"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq469.gif"/></alternatives></inline-formula> of <italic>n</italic> axis-aligned boxes in <inline-formula id="IEq470"><alternatives><tex-math id="M937">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^3$$\end{document}</tex-math><mml:math id="M938"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq470.gif"/></alternatives></inline-formula> that uses <italic>s</italic>(<italic>n</italic>) storage and that can decide in <italic>t</italic>(<italic>n</italic>) time for a given query axis-aligned box <inline-formula id="IEq471"><alternatives><tex-math id="M939">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M940"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq471.gif"/></alternatives></inline-formula> if there is a pair of boxes from <inline-formula id="IEq472"><alternatives><tex-math id="M941">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M942"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq472.gif"/></alternatives></inline-formula> that intersect inside&#x000a0;<inline-formula id="IEq473"><alternatives><tex-math id="M943">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M944"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq473.gif"/></alternatives></inline-formula>. Then we can build a data structure of size <italic>s</italic>(2<italic>N</italic>) supporting set intersection queries in <italic>t</italic>(2<italic>N</italic>) time, for input sets containing <italic>N</italic> elements in total.</p><p>Now Theorem&#x000a0;<xref ref-type="sec" rid="FPar12">3</xref> along with Conjecture 1 imply the following result.</p></sec><sec id="FPar13"><title>Theorem 4</title><p id="Par62">Let <inline-formula id="IEq474"><alternatives><tex-math id="M945">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M946"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq474.gif"/></alternatives></inline-formula> be a set of <italic>n</italic> axis-aligned boxes in <inline-formula id="IEq475"><alternatives><tex-math id="M947">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^3$$\end{document}</tex-math><mml:math id="M948"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq475.gif"/></alternatives></inline-formula>. Assuming Conjecture 1, any real-RAM data structure that can decide for a given query box&#x000a0;<inline-formula id="IEq476"><alternatives><tex-math id="M949">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M950"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq476.gif"/></alternatives></inline-formula> in <inline-formula id="IEq477"><alternatives><tex-math id="M951">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{O}(t)$$\end{document}</tex-math><mml:math id="M952"><mml:mrow><mml:mover accent="true"><mml:mi>O</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq477.gif"/></alternatives></inline-formula> time, and without using the floor function, if there is a pair of boxes from <inline-formula id="IEq478"><alternatives><tex-math id="M953">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M954"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq478.gif"/></alternatives></inline-formula> that intersect inside&#x000a0;<inline-formula id="IEq479"><alternatives><tex-math id="M955">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M956"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq479.gif"/></alternatives></inline-formula>, requires <inline-formula id="IEq480"><alternatives><tex-math id="M957">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\mathrm{\Omega }}((n/t)^2)$$\end{document}</tex-math><mml:math id="M958"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq480.gif"/></alternatives></inline-formula> storage.</p><p>
<italic>Fat boxes</italic> Next we obtain better bounds when the boxes in <inline-formula id="IEq481"><alternatives><tex-math id="M959">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M960"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq481.gif"/></alternatives></inline-formula> and the query box&#x000a0;<inline-formula id="IEq482"><alternatives><tex-math id="M961">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M962"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq482.gif"/></alternatives></inline-formula> are fat, that is, when their <italic>aspect ratio</italic>&#x02014;the ratio between the length of the longest edge and the length of the shortest edge&#x02014;is bounded by a constant&#x000a0;<inline-formula id="IEq483"><alternatives><tex-math id="M963">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><mml:math id="M964"><mml:mi mathvariant="italic">&#x003b1;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq483.gif"/></alternatives></inline-formula>. First we consider the case of cubes.</p><p>Let <inline-formula id="IEq484"><alternatives><tex-math id="M965">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}:= \{c_1, \ldots , c_n\}$$\end{document}</tex-math><mml:math id="M966"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq484.gif"/></alternatives></inline-formula> be a set of <italic>n</italic> cubes in <inline-formula id="IEq485"><alternatives><tex-math id="M967">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^3$$\end{document}</tex-math><mml:math id="M968"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq485.gif"/></alternatives></inline-formula> and let <inline-formula id="IEq486"><alternatives><tex-math id="M969">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M970"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq486.gif"/></alternatives></inline-formula> be the query cube. We compute a set <italic>W</italic> of witness points for each cube&#x000a0;<inline-formula id="IEq487"><alternatives><tex-math id="M971">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M972"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq487.gif"/></alternatives></inline-formula>, as follows. Let <italic>e</italic> be an edge of&#x000a0;<inline-formula id="IEq488"><alternatives><tex-math id="M973">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M974"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq488.gif"/></alternatives></inline-formula>, and consider the set&#x000a0;<inline-formula id="IEq489"><alternatives><tex-math id="M975">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S(e) := e \cap \left( \cup _{j\ne i} c_j\right) $$\end{document}</tex-math><mml:math id="M976"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mo>&#x02229;</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mo>&#x0222a;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq489.gif"/></alternatives></inline-formula>, that is, the part of <italic>e</italic> covered by the other cubes. We put the two extreme points from <italic>S</italic>(<italic>e</italic>)&#x02014;in other words, the two points closest to the endpoints of <italic>e</italic>&#x02014;into&#x000a0;<italic>W</italic>. Similarly, we assign each face <italic>f</italic> of&#x000a0;<inline-formula id="IEq490"><alternatives><tex-math id="M977">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M978"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq490.gif"/></alternatives></inline-formula> at most four witness points, namely points from&#x000a0;<inline-formula id="IEq491"><alternatives><tex-math id="M979">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S(f) := f\cap (\cup _{j\ne i} c_j)$$\end{document}</tex-math><mml:math id="M980"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>&#x02229;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mo>&#x0222a;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq491.gif"/></alternatives></inline-formula> that are extreme in the axis-aligned directions parallel to&#x000a0;<italic>f</italic>. For example, if <italic>f</italic> is parallel to the <italic>xy</italic>-plane, then we take points of maximum and minimum <italic>x</italic>-coordinate in <italic>S</italic>(<italic>f</italic>) and points of maximum and minimum <italic>y</italic>-coordinate in <italic>S</italic>(<italic>f</italic>) as witnesses. Our data structure to find the seed set <inline-formula id="IEq492"><alternatives><tex-math id="M981">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M982"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq492.gif"/></alternatives></inline-formula> now consists of the following components.<list list-type="bullet"><list-item><p id="Par65">We store the set&#x000a0;<italic>W</italic> of witness points in a data structure <inline-formula id="IEq493"><alternatives><tex-math id="M983">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_1$$\end{document}</tex-math><mml:math id="M984"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq493.gif"/></alternatives></inline-formula> for 3-dimensional orthogonal range queries.</p></list-item><list-item><p id="Par66">We store <inline-formula id="IEq494"><alternatives><tex-math id="M985">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M986"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq494.gif"/></alternatives></inline-formula> in a data structure <inline-formula id="IEq495"><alternatives><tex-math id="M987">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_2$$\end{document}</tex-math><mml:math id="M988"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq495.gif"/></alternatives></inline-formula> that allows us to report the set of cubes that contain a query point <italic>q</italic>.</p></list-item></list>The first step of the query procedure, where we compute <inline-formula id="IEq496"><alternatives><tex-math id="M989">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M990"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq496.gif"/></alternatives></inline-formula>, now proceeds as follows.<list list-type="order"><list-item><p id="Par67">Perform a query in <inline-formula id="IEq497"><alternatives><tex-math id="M991">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_1$$\end{document}</tex-math><mml:math id="M992"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq497.gif"/></alternatives></inline-formula> to find all witness points inside&#x000a0;<inline-formula id="IEq498"><alternatives><tex-math id="M993">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M994"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq498.gif"/></alternatives></inline-formula>. For each reported witness point, insert the corresponding cube into <inline-formula id="IEq499"><alternatives><tex-math id="M995">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M996"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq499.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par68">For each corner point <italic>q</italic> of <inline-formula id="IEq500"><alternatives><tex-math id="M997">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M998"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq500.gif"/></alternatives></inline-formula>, perform a query in <inline-formula id="IEq501"><alternatives><tex-math id="M999">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_2$$\end{document}</tex-math><mml:math id="M1000"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq501.gif"/></alternatives></inline-formula> to report all cubes in <inline-formula id="IEq502"><alternatives><tex-math id="M1001">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M1002"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq502.gif"/></alternatives></inline-formula> that contain <italic>q</italic>, and put them into&#x000a0;<inline-formula id="IEq503"><alternatives><tex-math id="M1003">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M1004"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq503.gif"/></alternatives></inline-formula>.</p></list-item></list>The next lemma proves correctness of this procedure.</p></sec><sec id="FPar14"><title>Lemma 5</title><p id="Par69">Let <inline-formula id="IEq504"><alternatives><tex-math id="M1005">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i,c_j$$\end{document}</tex-math><mml:math id="M1006"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq504.gif"/></alternatives></inline-formula> be two cubes in <inline-formula id="IEq505"><alternatives><tex-math id="M1007">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M1008"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq505.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq506"><alternatives><tex-math id="M1009">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(c_i\cap c_j) \cap {Q}\ne \emptyset $$\end{document}</tex-math><mml:math id="M1010"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02229;</mml:mo><mml:mi>Q</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi mathvariant="normal">&#x02205;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq506.gif"/></alternatives></inline-formula>. Then at least one of <inline-formula id="IEq507"><alternatives><tex-math id="M1011">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i,c_j$$\end{document}</tex-math><mml:math id="M1012"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq507.gif"/></alternatives></inline-formula> is put into <inline-formula id="IEq508"><alternatives><tex-math id="M1013">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M1014"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq508.gif"/></alternatives></inline-formula> by the above query procedure.</p></sec><sec id="FPar15"><title>Proof</title><p id="Par70">Suppose <inline-formula id="IEq509"><alternatives><tex-math id="M1015">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i\cap c_j$$\end{document}</tex-math><mml:math id="M1016"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq509.gif"/></alternatives></inline-formula> intersects <inline-formula id="IEq510"><alternatives><tex-math id="M1017">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1018"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq510.gif"/></alternatives></inline-formula>, and assume without loss of generality that <inline-formula id="IEq511"><alternatives><tex-math id="M1019">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1020"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq511.gif"/></alternatives></inline-formula> is not larger than <inline-formula id="IEq512"><alternatives><tex-math id="M1021">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_j$$\end{document}</tex-math><mml:math id="M1022"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq512.gif"/></alternatives></inline-formula>. If <inline-formula id="IEq513"><alternatives><tex-math id="M1023">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1024"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq513.gif"/></alternatives></inline-formula> or <inline-formula id="IEq514"><alternatives><tex-math id="M1025">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_j$$\end{document}</tex-math><mml:math id="M1026"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq514.gif"/></alternatives></inline-formula> contains a corner <italic>q</italic> of <inline-formula id="IEq515"><alternatives><tex-math id="M1027">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1028"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq515.gif"/></alternatives></inline-formula> then the corresponding cube will be put into the seed set when we perform a point-enclosure query with&#x000a0;<italic>q</italic>, so assume <inline-formula id="IEq516"><alternatives><tex-math id="M1029">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1030"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq516.gif"/></alternatives></inline-formula> and <inline-formula id="IEq517"><alternatives><tex-math id="M1031">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_j$$\end{document}</tex-math><mml:math id="M1032"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq517.gif"/></alternatives></inline-formula> do not contain a corner. We have two cases.</p><p id="Par71">
<sc>Case A:</sc>
<inline-formula id="IEq518"><alternatives><tex-math id="M1033">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1034"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq518.gif"/></alternatives></inline-formula> does not intersect any edge of <inline-formula id="IEq519"><alternatives><tex-math id="M1035">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1036"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq519.gif"/></alternatives></inline-formula>. Because <inline-formula id="IEq520"><alternatives><tex-math id="M1037">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1038"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq520.gif"/></alternatives></inline-formula> and <inline-formula id="IEq521"><alternatives><tex-math id="M1039">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1040"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq521.gif"/></alternatives></inline-formula> are cubes, this implies that <inline-formula id="IEq522"><alternatives><tex-math id="M1041">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1042"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq522.gif"/></alternatives></inline-formula> is contained in&#x000a0;<inline-formula id="IEq523"><alternatives><tex-math id="M1043">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1044"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq523.gif"/></alternatives></inline-formula> or <inline-formula id="IEq524"><alternatives><tex-math id="M1045">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1046"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq524.gif"/></alternatives></inline-formula> intersects exactly one face of <inline-formula id="IEq525"><alternatives><tex-math id="M1047">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1048"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq525.gif"/></alternatives></inline-formula>. Assume that <inline-formula id="IEq526"><alternatives><tex-math id="M1049">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1050"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq526.gif"/></alternatives></inline-formula> intersects the bottom face of <inline-formula id="IEq527"><alternatives><tex-math id="M1051">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1052"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq527.gif"/></alternatives></inline-formula>; the cases where <inline-formula id="IEq528"><alternatives><tex-math id="M1053">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1054"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq528.gif"/></alternatives></inline-formula> intersects another face and where <inline-formula id="IEq529"><alternatives><tex-math id="M1055">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1056"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq529.gif"/></alternatives></inline-formula> is contained in <inline-formula id="IEq530"><alternatives><tex-math id="M1057">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1058"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq530.gif"/></alternatives></inline-formula> can be handled similarly. We claim that at least one of the vertical faces of <inline-formula id="IEq531"><alternatives><tex-math id="M1059">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1060"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq531.gif"/></alternatives></inline-formula> contributes a witness point inside <inline-formula id="IEq532"><alternatives><tex-math id="M1061">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1062"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq532.gif"/></alternatives></inline-formula>. To see this, observe that <inline-formula id="IEq533"><alternatives><tex-math id="M1063">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_j$$\end{document}</tex-math><mml:math id="M1064"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq533.gif"/></alternatives></inline-formula> will intersect at least one vertical face, <italic>f</italic>, of <inline-formula id="IEq534"><alternatives><tex-math id="M1065">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1066"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq534.gif"/></alternatives></inline-formula> inside <inline-formula id="IEq535"><alternatives><tex-math id="M1067">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1068"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq535.gif"/></alternatives></inline-formula>, since <inline-formula id="IEq536"><alternatives><tex-math id="M1069">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_j$$\end{document}</tex-math><mml:math id="M1070"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq536.gif"/></alternatives></inline-formula> intersects <inline-formula id="IEq537"><alternatives><tex-math id="M1071">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1072"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq537.gif"/></alternatives></inline-formula> inside&#x000a0;<inline-formula id="IEq538"><alternatives><tex-math id="M1073">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1074"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq538.gif"/></alternatives></inline-formula> and <inline-formula id="IEq539"><alternatives><tex-math id="M1075">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1076"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq539.gif"/></alternatives></inline-formula> is not larger than&#x000a0;<inline-formula id="IEq540"><alternatives><tex-math id="M1077">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_j$$\end{document}</tex-math><mml:math id="M1078"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq540.gif"/></alternatives></inline-formula>. Hence, the witness point on <italic>f</italic> with maximum <italic>z</italic>-coordinate will be inside <inline-formula id="IEq541"><alternatives><tex-math id="M1079">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1080"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq541.gif"/></alternatives></inline-formula>. Thus <inline-formula id="IEq542"><alternatives><tex-math id="M1081">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1082"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq542.gif"/></alternatives></inline-formula> will be put into <inline-formula id="IEq543"><alternatives><tex-math id="M1083">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M1084"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq543.gif"/></alternatives></inline-formula>.<fig id="Fig4"><label>Fig. 4</label><caption><p>Case&#x000a0;B in the proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar14">5</xref>; <inline-formula id="IEq544"><alternatives><tex-math id="M1085">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_j$$\end{document}</tex-math><mml:math id="M1086"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq544.gif"/></alternatives></inline-formula> is not shown</p></caption><graphic xlink:href="453_2017_384_Fig4_HTML" id="MO4"/></fig>
</p><p id="Par72">
<sc>Case B:</sc>
<inline-formula id="IEq545"><alternatives><tex-math id="M1087">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1088"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq545.gif"/></alternatives></inline-formula> intersects one edge of <inline-formula id="IEq546"><alternatives><tex-math id="M1089">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1090"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq546.gif"/></alternatives></inline-formula>. (If <inline-formula id="IEq547"><alternatives><tex-math id="M1091">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1092"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq547.gif"/></alternatives></inline-formula> intersects more than one edge of <inline-formula id="IEq548"><alternatives><tex-math id="M1093">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1094"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq548.gif"/></alternatives></inline-formula> then it would contain a corner of&#x000a0;<inline-formula id="IEq549"><alternatives><tex-math id="M1095">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1096"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq549.gif"/></alternatives></inline-formula>.) Assume without loss of generality that <inline-formula id="IEq550"><alternatives><tex-math id="M1097">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1098"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq550.gif"/></alternatives></inline-formula> intersects the bottom edge of the front face of <inline-formula id="IEq551"><alternatives><tex-math id="M1099">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1100"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq551.gif"/></alternatives></inline-formula>; see Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>. Observe that if <inline-formula id="IEq552"><alternatives><tex-math id="M1101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_j$$\end{document}</tex-math><mml:math id="M1102"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq552.gif"/></alternatives></inline-formula> intersects the top face of <inline-formula id="IEq553"><alternatives><tex-math id="M1103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1104"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq553.gif"/></alternatives></inline-formula> then the witness point of the face with minimum <italic>x</italic>-coordinate is inside&#x000a0;<inline-formula id="IEq554"><alternatives><tex-math id="M1105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1106"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq554.gif"/></alternatives></inline-formula>. Similarly, if <inline-formula id="IEq555"><alternatives><tex-math id="M1107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_j$$\end{document}</tex-math><mml:math id="M1108"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq555.gif"/></alternatives></inline-formula> intersects the back face of&#x000a0;<inline-formula id="IEq556"><alternatives><tex-math id="M1109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1110"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq556.gif"/></alternatives></inline-formula> (the face parallel to the <italic>yz</italic>-plane and with minimum <italic>x</italic>-coordinate) then the witness point of the face with maximum <italic>z</italic>-coordinate is inside&#x000a0;<inline-formula id="IEq557"><alternatives><tex-math id="M1111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1112"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq557.gif"/></alternatives></inline-formula>. Otherwise, as illustrated in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>, <inline-formula id="IEq558"><alternatives><tex-math id="M1113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_j$$\end{document}</tex-math><mml:math id="M1114"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq558.gif"/></alternatives></inline-formula> must have an edge&#x000a0;<italic>e</italic> parallel to the <italic>y</italic>-axis that intersects <inline-formula id="IEq559"><alternatives><tex-math id="M1115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1116"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq559.gif"/></alternatives></inline-formula> inside <inline-formula id="IEq560"><alternatives><tex-math id="M1117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1118"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq560.gif"/></alternatives></inline-formula>, and one of the witness points on&#x000a0;<italic>e</italic> will be inside <inline-formula id="IEq561"><alternatives><tex-math id="M1119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1120"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq561.gif"/></alternatives></inline-formula>&#x02014;note that <italic>e</italic> lies fully inside <inline-formula id="IEq562"><alternatives><tex-math id="M1121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1122"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq562.gif"/></alternatives></inline-formula> because <inline-formula id="IEq563"><alternatives><tex-math id="M1123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_j$$\end{document}</tex-math><mml:math id="M1124"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq563.gif"/></alternatives></inline-formula> does not contain a corner of&#x000a0;<inline-formula id="IEq564"><alternatives><tex-math id="M1125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1126"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq564.gif"/></alternatives></inline-formula>. <inline-formula id="IEq565"><alternatives><tex-math id="M1127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M1128"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq565.gif"/></alternatives></inline-formula>
</p><p>
<fig id="Fig5"><label>Fig. 5</label><caption><p>Cross-section of&#x000a0;<inline-formula id="IEq566"><alternatives><tex-math id="M1129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1130"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq566.gif"/></alternatives></inline-formula>, <inline-formula id="IEq567"><alternatives><tex-math id="M1131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1132"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq567.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq568"><alternatives><tex-math id="M1133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_j$$\end{document}</tex-math><mml:math id="M1134"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq568.gif"/></alternatives></inline-formula> with a plane parallel to the <italic>xz</italic>-plane. The gray area indicates <inline-formula id="IEq569"><alternatives><tex-math id="M1135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}\cap c_i$$\end{document}</tex-math><mml:math id="M1136"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq569.gif"/></alternatives></inline-formula> in the cross-section</p></caption><graphic xlink:href="453_2017_384_Fig5_HTML" id="MO5"/></fig>
</p><p>To handle fat boxes, we need the following observation.</p></sec><sec id="FPar16"><title>Observation 1</title><p id="Par75">Let <italic>b</italic> be a box of aspect ratio <inline-formula id="IEq570"><alternatives><tex-math id="M1137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><mml:math id="M1138"><mml:mi mathvariant="italic">&#x003b1;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq570.gif"/></alternatives></inline-formula>. Then we can cover <italic>b</italic> by <inline-formula id="IEq571"><alternatives><tex-math id="M1139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\alpha ^2)$$\end{document}</tex-math><mml:math id="M1140"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="italic">&#x003b1;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq571.gif"/></alternatives></inline-formula> cubes such that any cube in the covering intersects at most three other cubes from the covering.</p><p>To adapt the above solution to boxes of aspect ratio at most <inline-formula id="IEq572"><alternatives><tex-math id="M1141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><mml:math id="M1142"><mml:mi mathvariant="italic">&#x003b1;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq572.gif"/></alternatives></inline-formula>, we cover each box <inline-formula id="IEq573"><alternatives><tex-math id="M1143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i\in \mathcal {O}$$\end{document}</tex-math><mml:math id="M1144"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq573.gif"/></alternatives></inline-formula> by <inline-formula id="IEq574"><alternatives><tex-math id="M1145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\alpha ^2)$$\end{document}</tex-math><mml:math id="M1146"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="italic">&#x003b1;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq574.gif"/></alternatives></inline-formula> cubes, and preprocess the resulting collection <inline-formula id="IEq575"><alternatives><tex-math id="M1147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\mathcal {O}}$$\end{document}</tex-math><mml:math id="M1148"><mml:mover accent="true"><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq575.gif"/></alternatives></inline-formula> of cubes as described above, making sure we do not introduce witness points for pairs of cubes used in the covering of the same box&#x000a0;<inline-formula id="IEq576"><alternatives><tex-math id="M1149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i$$\end{document}</tex-math><mml:math id="M1150"><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq576.gif"/></alternatives></inline-formula>. To perform a query, we cover&#x000a0;<inline-formula id="IEq577"><alternatives><tex-math id="M1151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1152"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq577.gif"/></alternatives></inline-formula> by <inline-formula id="IEq578"><alternatives><tex-math id="M1153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\alpha ^2)$$\end{document}</tex-math><mml:math id="M1154"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="italic">&#x003b1;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq578.gif"/></alternatives></inline-formula> query cubes and compute a seed set for each query cube. We take the union of these seed sets, replace the cubes from <inline-formula id="IEq579"><alternatives><tex-math id="M1155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\mathcal {O}}$$\end{document}</tex-math><mml:math id="M1156"><mml:mover accent="true"><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq579.gif"/></alternatives></inline-formula> in the seed set by the corresponding boxes in <inline-formula id="IEq580"><alternatives><tex-math id="M1157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M1158"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq580.gif"/></alternatives></inline-formula>, and filter out duplicates. This gives us our seed set <inline-formula id="IEq581"><alternatives><tex-math id="M1159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M1160"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq581.gif"/></alternatives></inline-formula> for the second phase of the query procedure.</p><p>In the second phase we take each <inline-formula id="IEq582"><alternatives><tex-math id="M1161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i\in \mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M1162"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq582.gif"/></alternatives></inline-formula> and report all <inline-formula id="IEq583"><alternatives><tex-math id="M1163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_j\in \mathcal {O}$$\end{document}</tex-math><mml:math id="M1164"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq583.gif"/></alternatives></inline-formula> intersecting&#x000a0;<inline-formula id="IEq584"><alternatives><tex-math id="M1165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i\cap {Q}$$\end{document}</tex-math><mml:math id="M1166"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq584.gif"/></alternatives></inline-formula>, using the data structure <inline-formula id="IEq585"><alternatives><tex-math id="M1167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}^*$$\end{document}</tex-math><mml:math id="M1168"><mml:msup><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq585.gif"/></alternatives></inline-formula> described just before Theorem&#x000a0;<xref ref-type="sec" rid="FPar10">2</xref>. We obtain the following theorem.</p></sec><sec id="FPar17"><title>Theorem 5</title><p id="Par78">Let <inline-formula id="IEq586"><alternatives><tex-math id="M1169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M1170"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq586.gif"/></alternatives></inline-formula> be a set of <italic>n</italic> axis-aligned boxes in&#x000a0;<inline-formula id="IEq587"><alternatives><tex-math id="M1171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^3$$\end{document}</tex-math><mml:math id="M1172"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq587.gif"/></alternatives></inline-formula> of aspect ratio at most&#x000a0;<inline-formula id="IEq588"><alternatives><tex-math id="M1173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><mml:math id="M1174"><mml:mi mathvariant="italic">&#x003b1;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq588.gif"/></alternatives></inline-formula>. Then there is a data structure that uses <inline-formula id="IEq589"><alternatives><tex-math id="M1175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\alpha ^2 n\log ^2 n)$$\end{document}</tex-math><mml:math id="M1176"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="italic">&#x003b1;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq589.gif"/></alternatives></inline-formula> storage and that allows us to report, for any axis-aligned query box&#x000a0;<inline-formula id="IEq590"><alternatives><tex-math id="M1177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1178"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq590.gif"/></alternatives></inline-formula> of aspect ratio at most <inline-formula id="IEq591"><alternatives><tex-math id="M1179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><mml:math id="M1180"><mml:mi mathvariant="italic">&#x003b1;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq591.gif"/></alternatives></inline-formula>, all pairs of cubes <inline-formula id="IEq592"><alternatives><tex-math id="M1181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i,c_j$$\end{document}</tex-math><mml:math id="M1182"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq592.gif"/></alternatives></inline-formula> in <inline-formula id="IEq593"><alternatives><tex-math id="M1183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M1184"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq593.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq594"><alternatives><tex-math id="M1185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M1186"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq594.gif"/></alternatives></inline-formula> intersects <inline-formula id="IEq595"><alternatives><tex-math id="M1187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_j$$\end{document}</tex-math><mml:math id="M1188"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq595.gif"/></alternatives></inline-formula> inside <inline-formula id="IEq596"><alternatives><tex-math id="M1189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1190"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq596.gif"/></alternatives></inline-formula> in <inline-formula id="IEq597"><alternatives><tex-math id="M1191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\alpha ^2(k+1)\log ^2 n)$$\end{document}</tex-math><mml:math id="M1192"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="italic">&#x003b1;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq597.gif"/></alternatives></inline-formula> time, where <italic>k</italic> denotes the number of answers.</p></sec><sec id="FPar18"><title>Proof</title><p id="Par79">The data structures <inline-formula id="IEq598"><alternatives><tex-math id="M1193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_1$$\end{document}</tex-math><mml:math id="M1194"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq598.gif"/></alternatives></inline-formula> and <inline-formula id="IEq599"><alternatives><tex-math id="M1195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {D}_2$$\end{document}</tex-math><mml:math id="M1196"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq599.gif"/></alternatives></inline-formula> can be implemented such that they use <inline-formula id="IEq600"><alternatives><tex-math id="M1197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n(\log n/\log \log n)^2)$$\end{document}</tex-math><mml:math id="M1198"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mo>log</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq600.gif"/></alternatives></inline-formula> storage in total, and have <inline-formula id="IEq601"><alternatives><tex-math id="M1199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n + \#\text{ answers })$$\end{document}</tex-math><mml:math id="M1200"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mo>#</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>answers</mml:mtext><mml:mspace width="0.333333em"/><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq601.gif"/></alternatives></inline-formula> and <inline-formula id="IEq602"><alternatives><tex-math id="M1201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log ^2 n/\log \log n + \#\text{ answers })$$\end{document}</tex-math><mml:math id="M1202"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mo>log</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mo>#</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>answers</mml:mtext><mml:mspace width="0.333333em"/><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq602.gif"/></alternatives></inline-formula> query time, respectively&#x000a0;[<xref ref-type="bibr" rid="CR3">3</xref>]. Since Step&#x000a0;2 of the query procedure is the same as the second step of query procedure of Sect.&#x000a0;<xref rid="Sec4" ref-type="sec">2.2</xref> we can use the data structures that we designed there, which need <inline-formula id="IEq603"><alternatives><tex-math id="M1203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\log ^2 n)$$\end{document}</tex-math><mml:math id="M1204"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq603.gif"/></alternatives></inline-formula> storage and have <inline-formula id="IEq604"><alternatives><tex-math id="M1205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log ^2 n + \#\text{ answers })$$\end{document}</tex-math><mml:math id="M1206"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mo>#</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>answers</mml:mtext><mml:mspace width="0.333333em"/><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq604.gif"/></alternatives></inline-formula> query time. The conversion of boxes of aspect ratio <inline-formula id="IEq605"><alternatives><tex-math id="M1207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><mml:math id="M1208"><mml:mi mathvariant="italic">&#x003b1;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq605.gif"/></alternatives></inline-formula> to cubes give an additional factor <inline-formula id="IEq606"><alternatives><tex-math id="M1209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\alpha ^2)$$\end{document}</tex-math><mml:math id="M1210"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="italic">&#x003b1;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq606.gif"/></alternatives></inline-formula>. Each input box now has <inline-formula id="IEq607"><alternatives><tex-math id="M1211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\alpha ^2)$$\end{document}</tex-math><mml:math id="M1212"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="italic">&#x003b1;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq607.gif"/></alternatives></inline-formula> witness points, but each witness point will be reported by at most three of the query cubes, by Observation&#x000a0;<xref ref-type="sec" rid="FPar16">1</xref>. Similarly, each corner of a query cube is inside at most two cubes from the covering of any box <inline-formula id="IEq608"><alternatives><tex-math id="M1213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_i\in \mathcal {O}$$\end{document}</tex-math><mml:math id="M1214"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq608.gif"/></alternatives></inline-formula>. <inline-formula id="IEq609"><alternatives><tex-math id="M1215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M1216"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq609.gif"/></alternatives></inline-formula>
</p></sec></sec></sec><sec id="Sec5"><title>Objects with Small Union Complexity in <inline-formula id="IEq610"><alternatives><tex-math id="M1217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^2$$\end{document}</tex-math><mml:math id="M1218"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq610.gif"/></alternatives></inline-formula></title><p id="Par80">In the previous section we presented efficient solutions for the case where <inline-formula id="IEq611"><alternatives><tex-math id="M1219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M1220"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq611.gif"/></alternatives></inline-formula> consists of axis-aligned rectangles. In this section we obtain results for classes of constant-complexity objects (which may have curved boundaries) with small union complexity. More precisely, we need that <italic>U</italic>(<italic>n</italic>), the maximum union complexity of any set of <italic>n</italic> objects from the class, is small. This is for instance the case for disks (where <inline-formula id="IEq612"><alternatives><tex-math id="M1221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U(m)=O(m)$$\end{document}</tex-math><mml:math id="M1222"><mml:mrow><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq612.gif"/></alternatives></inline-formula>&#x000a0;[<xref ref-type="bibr" rid="CR18">18</xref>]) and for locally fat objects (where <inline-formula id="IEq613"><alternatives><tex-math id="M1223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U(m)=m2^{O(\log ^* m)}$$\end{document}</tex-math><mml:math id="M1224"><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mo>log</mml:mo><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq613.gif"/></alternatives></inline-formula>&#x000a0;[<xref ref-type="bibr" rid="CR5">5</xref>]).</p><p id="Par81">In Step&#x000a0;2 of the query algorithm of the previous section, we performed a range query with <inline-formula id="IEq614"><alternatives><tex-math id="M1225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i\cap {Q}$$\end{document}</tex-math><mml:math id="M1226"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq614.gif"/></alternatives></inline-formula> for each&#x000a0;<inline-formula id="IEq615"><alternatives><tex-math id="M1227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i\in \mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M1228"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq615.gif"/></alternatives></inline-formula>. When we are dealing with arbitrary objects, this will be expensive, so we modify our query procedure.<list list-type="order"><list-item><p id="Par82">Compute a seed set <inline-formula id="IEq616"><alternatives><tex-math id="M1229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})\subseteq \mathcal {O}$$\end{document}</tex-math><mml:math id="M1230"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02286;</mml:mo><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq616.gif"/></alternatives></inline-formula> of objects such that, for any two objects <inline-formula id="IEq617"><alternatives><tex-math id="M1231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i,o_j$$\end{document}</tex-math><mml:math id="M1232"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq617.gif"/></alternatives></inline-formula> in <inline-formula id="IEq618"><alternatives><tex-math id="M1233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M1234"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq618.gif"/></alternatives></inline-formula> intersecting inside&#x000a0;<inline-formula id="IEq619"><alternatives><tex-math id="M1235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1236"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq619.gif"/></alternatives></inline-formula>, both <inline-formula id="IEq620"><alternatives><tex-math id="M1237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i$$\end{document}</tex-math><mml:math id="M1238"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq620.gif"/></alternatives></inline-formula> and <inline-formula id="IEq621"><alternatives><tex-math id="M1239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_j$$\end{document}</tex-math><mml:math id="M1240"><mml:msub><mml:mi>o</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq621.gif"/></alternatives></inline-formula> are in <inline-formula id="IEq622"><alternatives><tex-math id="M1241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M1242"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq622.gif"/></alternatives></inline-formula>. (Contrary to before, where we only required one of <inline-formula id="IEq623"><alternatives><tex-math id="M1243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i,o_j$$\end{document}</tex-math><mml:math id="M1244"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq623.gif"/></alternatives></inline-formula> to be in the seed set.)</p></list-item><list-item><p id="Par83">Compute all intersecting pairs of objects in the set <inline-formula id="IEq624"><alternatives><tex-math id="M1245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ o_i\cap {Q}: o_i \in \mathcal {O}^*({Q}) \}$$\end{document}</tex-math><mml:math id="M1246"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:mi>Q</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq624.gif"/></alternatives></inline-formula> by a plane-sweep algorithm.</p></list-item></list>
<fig id="Fig6"><label>Fig. 6</label><caption><p>An illustration of the regions <inline-formula id="IEq625"><alternatives><tex-math id="M1247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1248"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq625.gif"/></alternatives></inline-formula> for disks. Only <inline-formula id="IEq626"><alternatives><tex-math id="M1249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_1^*$$\end{document}</tex-math><mml:math id="M1250"><mml:msubsup><mml:mi>o</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq626.gif"/></alternatives></inline-formula> and <inline-formula id="IEq627"><alternatives><tex-math id="M1251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_3^*$$\end{document}</tex-math><mml:math id="M1252"><mml:msubsup><mml:mi>o</mml:mi><mml:mn>3</mml:mn><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq627.gif"/></alternatives></inline-formula> are shown. <inline-formula id="IEq628"><alternatives><tex-math id="M1253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_1^*$$\end{document}</tex-math><mml:math id="M1254"><mml:msubsup><mml:mi>o</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq628.gif"/></alternatives></inline-formula> is shown in red, and <inline-formula id="IEq629"><alternatives><tex-math id="M1255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_3^*$$\end{document}</tex-math><mml:math id="M1256"><mml:msubsup><mml:mi>o</mml:mi><mml:mn>3</mml:mn><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq629.gif"/></alternatives></inline-formula> is shown in blue (Color figure online)</p></caption><graphic xlink:href="453_2017_384_Fig6_HTML" id="MO6"/></fig>
</p><p id="Par84">Next we describe how to efficiently find&#x000a0;<inline-formula id="IEq630"><alternatives><tex-math id="M1257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*({Q})$$\end{document}</tex-math><mml:math id="M1258"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq630.gif"/></alternatives></inline-formula>, which should contain all objects intersecting at least one other object inside <inline-formula id="IEq631"><alternatives><tex-math id="M1259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1260"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq631.gif"/></alternatives></inline-formula>, when the union complexity <italic>U</italic>(<italic>n</italic>) is small. For each object <inline-formula id="IEq632"><alternatives><tex-math id="M1261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i\in \mathcal {O}$$\end{document}</tex-math><mml:math id="M1262"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq632.gif"/></alternatives></inline-formula> we define <inline-formula id="IEq633"><alternatives><tex-math id="M1263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ o_i^* := \bigcup _{{o_j\in \mathcal {O}},{j \ne i}} (o_i \cap o_j) $$\end{document}</tex-math><mml:math id="M1264"><mml:mrow><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mo>&#x022c3;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq633.gif"/></alternatives></inline-formula> as the union of all intersections between <inline-formula id="IEq634"><alternatives><tex-math id="M1265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i$$\end{document}</tex-math><mml:math id="M1266"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq634.gif"/></alternatives></inline-formula> and all other objects in <inline-formula id="IEq635"><alternatives><tex-math id="M1267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M1268"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq635.gif"/></alternatives></inline-formula>. See Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref> for an illustration. Let <inline-formula id="IEq636"><alternatives><tex-math id="M1269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|o_i^*|$$\end{document}</tex-math><mml:math id="M1270"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq636.gif"/></alternatives></inline-formula> denote the complexity (that is, number of vertices and edges) of <inline-formula id="IEq637"><alternatives><tex-math id="M1271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1272"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq637.gif"/></alternatives></inline-formula>.</p><sec id="FPar19"><title>Lemma 6</title><p id="Par85">
<inline-formula id="IEq638"><alternatives><tex-math id="M1273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{i=1}^n |o_i^*| = O(U(n))$$\end{document}</tex-math><mml:math id="M1274"><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>U</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq638.gif"/></alternatives></inline-formula>.</p></sec><sec id="FPar20"><title>Proof</title><p id="Par86">Consider the arrangement induced by the objects in&#x000a0;<inline-formula id="IEq639"><alternatives><tex-math id="M1275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M1276"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq639.gif"/></alternatives></inline-formula>. We define the <italic>level</italic> of a vertex <italic>v</italic> in this arrangement as the number of objects from <inline-formula id="IEq640"><alternatives><tex-math id="M1277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M1278"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq640.gif"/></alternatives></inline-formula> that contain&#x000a0;<italic>v</italic> in their interior. We claim that every vertex of any <inline-formula id="IEq641"><alternatives><tex-math id="M1279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1280"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq641.gif"/></alternatives></inline-formula> is a level-0 or level-1 vertex. Indeed, a level-<italic>k</italic> vertex for <inline-formula id="IEq642"><alternatives><tex-math id="M1281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k&#x0003e;1$$\end{document}</tex-math><mml:math id="M1282"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq642.gif"/></alternatives></inline-formula> is in the interior of more than one object, which implies it cannot be a vertex of any&#x000a0;<inline-formula id="IEq643"><alternatives><tex-math id="M1283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1284"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq643.gif"/></alternatives></inline-formula>.</p><p id="Par87">Since the level-0 vertices are exactly the vertices of the union of <inline-formula id="IEq644"><alternatives><tex-math id="M1285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M1286"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq644.gif"/></alternatives></inline-formula>, the total number of level-0 vertices is <italic>U</italic>(<italic>n</italic>). It follows from the Clarkson&#x02013;Shor technique&#x000a0;[<xref ref-type="bibr" rid="CR8">8</xref>] that the number of level-1 vertices is <italic>O</italic>(<italic>U</italic>(<italic>n</italic>)) as well. The lemma now follows, because each level-0 or level-1 vertex contributes to at most two different <inline-formula id="IEq645"><alternatives><tex-math id="M1287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1288"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq645.gif"/></alternatives></inline-formula>&#x02019;s. <inline-formula id="IEq646"><alternatives><tex-math id="M1289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M1290"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq646.gif"/></alternatives></inline-formula>
</p><p>Our goal in Step&#x000a0;1 is to find all objects&#x000a0;<inline-formula id="IEq647"><alternatives><tex-math id="M1291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i$$\end{document}</tex-math><mml:math id="M1292"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq647.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq648"><alternatives><tex-math id="M1293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1294"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq648.gif"/></alternatives></inline-formula> intersects&#x000a0;<inline-formula id="IEq649"><alternatives><tex-math id="M1295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1296"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq649.gif"/></alternatives></inline-formula>. To this end consider the connected components of&#x000a0;<inline-formula id="IEq650"><alternatives><tex-math id="M1297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1298"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq650.gif"/></alternatives></inline-formula>. If <inline-formula id="IEq651"><alternatives><tex-math id="M1299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1300"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq651.gif"/></alternatives></inline-formula> intersects&#x000a0;<inline-formula id="IEq652"><alternatives><tex-math id="M1301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1302"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq652.gif"/></alternatives></inline-formula> then one of these components lies completely inside&#x000a0;<inline-formula id="IEq653"><alternatives><tex-math id="M1303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1304"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq653.gif"/></alternatives></inline-formula> or an edge of <inline-formula id="IEq654"><alternatives><tex-math id="M1305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1306"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq654.gif"/></alternatives></inline-formula> intersects&#x000a0;<inline-formula id="IEq655"><alternatives><tex-math id="M1307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1308"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq655.gif"/></alternatives></inline-formula>.</p></sec><sec id="FPar21"><title>Lemma 7</title><p id="Par89">We can find all <inline-formula id="IEq656"><alternatives><tex-math id="M1309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1310"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq656.gif"/></alternatives></inline-formula> that have a component completely inside <inline-formula id="IEq657"><alternatives><tex-math id="M1311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1312"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq657.gif"/></alternatives></inline-formula> in <inline-formula id="IEq658"><alternatives><tex-math id="M1313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n + k)$$\end{document}</tex-math><mml:math id="M1314"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq658.gif"/></alternatives></inline-formula> time, where <italic>k</italic> is the number of pairs of objects that intersect inside&#x000a0;<inline-formula id="IEq659"><alternatives><tex-math id="M1315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1316"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq659.gif"/></alternatives></inline-formula>, with a data structure that uses <inline-formula id="IEq660"><alternatives><tex-math id="M1317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(U(n)\log n)$$\end{document}</tex-math><mml:math id="M1318"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq660.gif"/></alternatives></inline-formula> storage.</p></sec><sec id="FPar22"><title>Proof</title><p id="Par90">For each <inline-formula id="IEq661"><alternatives><tex-math id="M1319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i$$\end{document}</tex-math><mml:math id="M1320"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq661.gif"/></alternatives></inline-formula>, take an arbitrary representative point inside each component of&#x000a0;<inline-formula id="IEq662"><alternatives><tex-math id="M1321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1322"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq662.gif"/></alternatives></inline-formula>, and store all the representative points in a structure for orthogonal range reporting. By Lemma&#x000a0;<xref ref-type="sec" rid="FPar19">6</xref> we store <italic>O</italic>(<italic>U</italic>(<italic>n</italic>)) points, and so the structure for orthogonal range reporting uses <inline-formula id="IEq663"><alternatives><tex-math id="M1323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(U(n)\log n)$$\end{document}</tex-math><mml:math id="M1324"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq663.gif"/></alternatives></inline-formula> storage.</p><p id="Par91">The query time is <inline-formula id="IEq664"><alternatives><tex-math id="M1325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n + t)$$\end{document}</tex-math><mml:math id="M1326"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq664.gif"/></alternatives></inline-formula>, where <italic>t</italic> is the number of representative points inside&#x000a0;<inline-formula id="IEq665"><alternatives><tex-math id="M1327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1328"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq665.gif"/></alternatives></inline-formula>. This implies the query time is <inline-formula id="IEq666"><alternatives><tex-math id="M1329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n + k)$$\end{document}</tex-math><mml:math id="M1330"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq666.gif"/></alternatives></inline-formula>, because if <inline-formula id="IEq667"><alternatives><tex-math id="M1331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1332"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq667.gif"/></alternatives></inline-formula> has <inline-formula id="IEq668"><alternatives><tex-math id="M1333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_i$$\end{document}</tex-math><mml:math id="M1334"><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq668.gif"/></alternatives></inline-formula> representative points inside&#x000a0;<inline-formula id="IEq669"><alternatives><tex-math id="M1335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1336"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq669.gif"/></alternatives></inline-formula> then <inline-formula id="IEq670"><alternatives><tex-math id="M1337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i$$\end{document}</tex-math><mml:math id="M1338"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq670.gif"/></alternatives></inline-formula> intersects <inline-formula id="IEq671"><alternatives><tex-math id="M1339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\Omega }(t_i)$$\end{document}</tex-math><mml:math id="M1340"><mml:mrow><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq671.gif"/></alternatives></inline-formula> other objects inside&#x000a0;<inline-formula id="IEq672"><alternatives><tex-math id="M1341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1342"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq672.gif"/></alternatives></inline-formula>. This is true because the objects have constant complexity, so a single object <inline-formula id="IEq673"><alternatives><tex-math id="M1343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_j$$\end{document}</tex-math><mml:math id="M1344"><mml:msub><mml:mi>o</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq673.gif"/></alternatives></inline-formula> cannot generate more than a constant number of components of&#x000a0;<inline-formula id="IEq674"><alternatives><tex-math id="M1345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1346"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq674.gif"/></alternatives></inline-formula>. <inline-formula id="IEq675"><alternatives><tex-math id="M1347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M1348"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq675.gif"/></alternatives></inline-formula>
</p><p>Next we describe a data structure for reporting all <inline-formula id="IEq676"><alternatives><tex-math id="M1349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1350"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq676.gif"/></alternatives></inline-formula> intersecting a vertical edge of&#x000a0;<inline-formula id="IEq677"><alternatives><tex-math id="M1351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1352"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq677.gif"/></alternatives></inline-formula>; the horizontal edges of&#x000a0;<inline-formula id="IEq678"><alternatives><tex-math id="M1353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1354"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq678.gif"/></alternatives></inline-formula> can be handled similarly. The data structure is a balanced binary tree <inline-formula id="IEq679"><alternatives><tex-math id="M1355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {T}$$\end{document}</tex-math><mml:math id="M1356"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq679.gif"/></alternatives></inline-formula>, whose leaves are in one-to-one correspondence to the objects in <inline-formula id="IEq680"><alternatives><tex-math id="M1357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M1358"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq680.gif"/></alternatives></inline-formula>. For an (internal or leaf) node <inline-formula id="IEq681"><alternatives><tex-math id="M1359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu $$\end{document}</tex-math><mml:math id="M1360"><mml:mi mathvariant="italic">&#x003bd;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq681.gif"/></alternatives></inline-formula> in <inline-formula id="IEq682"><alternatives><tex-math id="M1361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {T}$$\end{document}</tex-math><mml:math id="M1362"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq682.gif"/></alternatives></inline-formula>, let <inline-formula id="IEq683"><alternatives><tex-math id="M1363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {T}(\nu )$$\end{document}</tex-math><mml:math id="M1364"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq683.gif"/></alternatives></inline-formula> denote the subtree rooted at&#x000a0;<inline-formula id="IEq684"><alternatives><tex-math id="M1365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu $$\end{document}</tex-math><mml:math id="M1366"><mml:mi mathvariant="italic">&#x003bd;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq684.gif"/></alternatives></inline-formula> and let <inline-formula id="IEq685"><alternatives><tex-math id="M1367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}(\nu )$$\end{document}</tex-math><mml:math id="M1368"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq685.gif"/></alternatives></inline-formula> denote the set of objects corresponding to the leaves of <inline-formula id="IEq686"><alternatives><tex-math id="M1369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {T}(\nu )$$\end{document}</tex-math><mml:math id="M1370"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq686.gif"/></alternatives></inline-formula>. Define <inline-formula id="IEq687"><alternatives><tex-math id="M1371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {U}(\nu ) := \cup _{o_i \in \mathcal {O}(\nu )} o_i^*$$\end{document}</tex-math><mml:math id="M1372"><mml:mrow><mml:mi mathvariant="script">U</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mo>&#x0222a;</mml:mo><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq687.gif"/></alternatives></inline-formula>. At node <inline-formula id="IEq688"><alternatives><tex-math id="M1373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu $$\end{document}</tex-math><mml:math id="M1374"><mml:mi mathvariant="italic">&#x003bd;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq688.gif"/></alternatives></inline-formula>, we store a point-location data structure&#x000a0;[<xref ref-type="bibr" rid="CR12">12</xref>] on the trapezoidal map of <inline-formula id="IEq689"><alternatives><tex-math id="M1375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {U}(\nu )$$\end{document}</tex-math><mml:math id="M1376"><mml:mrow><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq689.gif"/></alternatives></inline-formula>. (If the objects are curved, then the &#x0201c;trapezoids&#x0201d; may have curved top and bottom edges.)</p></sec><sec id="FPar23"><title>Lemma 8</title><p id="Par93">The tree <inline-formula id="IEq690"><alternatives><tex-math id="M1377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {T}$$\end{document}</tex-math><mml:math id="M1378"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq690.gif"/></alternatives></inline-formula> uses <inline-formula id="IEq691"><alternatives><tex-math id="M1379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(U(n)\log n)$$\end{document}</tex-math><mml:math id="M1380"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq691.gif"/></alternatives></inline-formula> storage and allows us to report all <inline-formula id="IEq692"><alternatives><tex-math id="M1381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1382"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq692.gif"/></alternatives></inline-formula> intersecting a vertical edge <italic>s</italic> of <inline-formula id="IEq693"><alternatives><tex-math id="M1383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1384"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq693.gif"/></alternatives></inline-formula> in <inline-formula id="IEq694"><alternatives><tex-math id="M1385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O((t+1)\log ^2 n)$$\end{document}</tex-math><mml:math id="M1386"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq694.gif"/></alternatives></inline-formula> time, where <italic>t</italic> is the number of answers.</p></sec><sec id="FPar24"><title>Proof</title><p id="Par94">To report all <inline-formula id="IEq695"><alternatives><tex-math id="M1387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1388"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq695.gif"/></alternatives></inline-formula> intersecting&#x000a0;<italic>s</italic> we walk down <inline-formula id="IEq696"><alternatives><tex-math id="M1389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {T}$$\end{document}</tex-math><mml:math id="M1390"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq696.gif"/></alternatives></inline-formula>, only visiting the nodes&#x000a0;<inline-formula id="IEq697"><alternatives><tex-math id="M1391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu $$\end{document}</tex-math><mml:math id="M1392"><mml:mi mathvariant="italic">&#x003bd;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq697.gif"/></alternatives></inline-formula> such that <italic>s</italic> intersects&#x000a0;<inline-formula id="IEq698"><alternatives><tex-math id="M1393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {U}(\nu )$$\end{document}</tex-math><mml:math id="M1394"><mml:mrow><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq698.gif"/></alternatives></inline-formula>. This way we end up in the leaves corresponding to the&#x000a0;<inline-formula id="IEq699"><alternatives><tex-math id="M1395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1396"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq699.gif"/></alternatives></inline-formula> intersecting&#x000a0;<italic>s</italic>. To decide if we have to visit a child&#x000a0;<inline-formula id="IEq700"><alternatives><tex-math id="M1397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu $$\end{document}</tex-math><mml:math id="M1398"><mml:mi mathvariant="italic">&#x003bd;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq700.gif"/></alternatives></inline-formula> of an already visited node, we do a point location with both endpoints of <italic>s</italic> in the trapezoidal map of&#x000a0;<inline-formula id="IEq701"><alternatives><tex-math id="M1399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {U}(\nu )$$\end{document}</tex-math><mml:math id="M1400"><mml:mrow><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq701.gif"/></alternatives></inline-formula>. Now <italic>s</italic> intersects <inline-formula id="IEq702"><alternatives><tex-math id="M1401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {U}(\nu )$$\end{document}</tex-math><mml:math id="M1402"><mml:mrow><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq702.gif"/></alternatives></inline-formula> if and only if one of these endpoints lies in a trapezoid inside <inline-formula id="IEq703"><alternatives><tex-math id="M1403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {U}(\nu )$$\end{document}</tex-math><mml:math id="M1404"><mml:mrow><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq703.gif"/></alternatives></inline-formula> and/or the two endpoints lie in different trapezoids. Thus we spend <inline-formula id="IEq704"><alternatives><tex-math id="M1405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n)$$\end{document}</tex-math><mml:math id="M1406"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq704.gif"/></alternatives></inline-formula> time for the decision. Since we visit <inline-formula id="IEq705"><alternatives><tex-math id="M1407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(t\log n)$$\end{document}</tex-math><mml:math id="M1408"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq705.gif"/></alternatives></inline-formula> nodes, the total query time is as claimed.</p><p id="Par95">To analyze the storage we claim that the sum of the complexities of <inline-formula id="IEq706"><alternatives><tex-math id="M1409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {U}(\nu )$$\end{document}</tex-math><mml:math id="M1410"><mml:mrow><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq706.gif"/></alternatives></inline-formula> over all nodes <inline-formula id="IEq707"><alternatives><tex-math id="M1411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu $$\end{document}</tex-math><mml:math id="M1412"><mml:mi mathvariant="italic">&#x003bd;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq707.gif"/></alternatives></inline-formula> at any fixed height of <inline-formula id="IEq708"><alternatives><tex-math id="M1413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {T}$$\end{document}</tex-math><mml:math id="M1414"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq708.gif"/></alternatives></inline-formula> is <italic>O</italic>(<italic>U</italic>(<italic>n</italic>)). The bound on the storage then follows because the point-location data structures take linear space&#x000a0;[<xref ref-type="bibr" rid="CR12">12</xref>] and the height of&#x000a0;<inline-formula id="IEq709"><alternatives><tex-math id="M1415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {T}$$\end{document}</tex-math><mml:math id="M1416"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq709.gif"/></alternatives></inline-formula> is <inline-formula id="IEq710"><alternatives><tex-math id="M1417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n)$$\end{document}</tex-math><mml:math id="M1418"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq710.gif"/></alternatives></inline-formula>. It remains to prove the claim. Consider a node <inline-formula id="IEq711"><alternatives><tex-math id="M1419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu $$\end{document}</tex-math><mml:math id="M1420"><mml:mi mathvariant="italic">&#x003bd;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq711.gif"/></alternatives></inline-formula> at a given height&#x000a0;<italic>h</italic> in <inline-formula id="IEq712"><alternatives><tex-math id="M1421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {T}$$\end{document}</tex-math><mml:math id="M1422"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq712.gif"/></alternatives></inline-formula>. Lemma&#x000a0;<xref ref-type="sec" rid="FPar25">9</xref> argues that each vertex in&#x000a0;<inline-formula id="IEq713"><alternatives><tex-math id="M1423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {U}(\nu )$$\end{document}</tex-math><mml:math id="M1424"><mml:mrow><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq713.gif"/></alternatives></inline-formula> is either a level-0 or level-1 vertex of the arrangement induced by the objects in <inline-formula id="IEq714"><alternatives><tex-math id="M1425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}(\nu )$$\end{document}</tex-math><mml:math id="M1426"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq714.gif"/></alternatives></inline-formula>, or a vertex of <inline-formula id="IEq715"><alternatives><tex-math id="M1427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o^*_i$$\end{document}</tex-math><mml:math id="M1428"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq715.gif"/></alternatives></inline-formula>, for some <inline-formula id="IEq716"><alternatives><tex-math id="M1429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i$$\end{document}</tex-math><mml:math id="M1430"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq716.gif"/></alternatives></inline-formula> in <inline-formula id="IEq717"><alternatives><tex-math id="M1431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}(\nu )$$\end{document}</tex-math><mml:math id="M1432"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq717.gif"/></alternatives></inline-formula>. The proof of the claim then follows from the following two facts. First, the number of vertices of the former type is <inline-formula id="IEq718"><alternatives><tex-math id="M1433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(U(|\mathcal {O}(\nu )|))$$\end{document}</tex-math><mml:math id="M1434"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq718.gif"/></alternatives></inline-formula>, which sums to <italic>O</italic>(<italic>U</italic>(<italic>n</italic>)) over all nodes at height&#x000a0;<italic>h</italic>. Second, by Lemma&#x000a0;<xref ref-type="sec" rid="FPar19">6</xref> the number of vertices of the latter type over all nodes at height&#x000a0;<italic>h</italic> sums to <italic>O</italic>(<italic>U</italic>(<italic>n</italic>)). <inline-formula id="IEq719"><alternatives><tex-math id="M1435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M1436"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq719.gif"/></alternatives></inline-formula>
</p><p>
<fig id="Fig7"><label>Fig. 7</label><caption><p>Different cases in the proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar25">9</xref>. To simplify the presentation we assumed the objects are disks. <inline-formula id="IEq720"><alternatives><tex-math id="M1437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o^*_i$$\end{document}</tex-math><mml:math id="M1438"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq720.gif"/></alternatives></inline-formula> and <inline-formula id="IEq721"><alternatives><tex-math id="M1439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o^*_j$$\end{document}</tex-math><mml:math id="M1440"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>j</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq721.gif"/></alternatives></inline-formula> are surrounded by dark green and dark red, respectively. Regular arcs are in solid and irregular arcs are in dashed. The blue vertex refers to vertex <italic>u</italic> in the proof. <bold>a</bold> Case A in the Proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar25">9</xref>. <bold>b</bold> Case B in the Proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar25">9</xref> (Color figure online)</p></caption><graphic xlink:href="453_2017_384_Fig7_HTML" id="MO7"/></fig>
</p></sec><sec id="FPar25"><title>Lemma 9</title><p id="Par97">Each vertex in&#x000a0;<inline-formula id="IEq722"><alternatives><tex-math id="M1441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {U}(\nu )$$\end{document}</tex-math><mml:math id="M1442"><mml:mrow><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq722.gif"/></alternatives></inline-formula> is either a level-0 or level-1 vertex of the arrangement induced by the objects in <inline-formula id="IEq723"><alternatives><tex-math id="M1443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}(\nu )$$\end{document}</tex-math><mml:math id="M1444"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq723.gif"/></alternatives></inline-formula>, or a vertex of <inline-formula id="IEq724"><alternatives><tex-math id="M1445">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o^*_i$$\end{document}</tex-math><mml:math id="M1446"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq724.gif"/></alternatives></inline-formula>, for some <inline-formula id="IEq725"><alternatives><tex-math id="M1447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i$$\end{document}</tex-math><mml:math id="M1448"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq725.gif"/></alternatives></inline-formula> in <inline-formula id="IEq726"><alternatives><tex-math id="M1449">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}(\nu )$$\end{document}</tex-math><mml:math id="M1450"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq726.gif"/></alternatives></inline-formula>.</p></sec><sec id="FPar26"><title>Proof</title><p id="Par98">Define <inline-formula id="IEq727"><alternatives><tex-math id="M1451">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}^*(\nu ) := \{ o_i^* : o_i \in \mathcal {O}(\nu ) \}$$\end{document}</tex-math><mml:math id="M1452"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>:</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq727.gif"/></alternatives></inline-formula>. Any vertex <italic>u</italic> of <inline-formula id="IEq728"><alternatives><tex-math id="M1453">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {U}(\nu )$$\end{document}</tex-math><mml:math id="M1454"><mml:mrow><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq728.gif"/></alternatives></inline-formula> that is not a vertex of some <inline-formula id="IEq729"><alternatives><tex-math id="M1455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^* \in \mathcal {O}^*(\nu )$$\end{document}</tex-math><mml:math id="M1456"><mml:mrow><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq729.gif"/></alternatives></inline-formula> must be an intersection of the boundaries of some <inline-formula id="IEq730"><alternatives><tex-math id="M1457">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*,o_j^*\in \mathcal {O}(\nu )$$\end{document}</tex-math><mml:math id="M1458"><mml:mrow><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>o</mml:mi><mml:mi>j</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq730.gif"/></alternatives></inline-formula>. Note that the boundary <inline-formula id="IEq731"><alternatives><tex-math id="M1459">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial o_i^*$$\end{document}</tex-math><mml:math id="M1460"><mml:mrow><mml:mi mathvariant="italic">&#x02202;</mml:mi><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq731.gif"/></alternatives></inline-formula> of an object <inline-formula id="IEq732"><alternatives><tex-math id="M1461">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1462"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq732.gif"/></alternatives></inline-formula> consists of two types of pieces: <italic>regular arcs</italic>, which are parts of the boundary of <inline-formula id="IEq733"><alternatives><tex-math id="M1463">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i$$\end{document}</tex-math><mml:math id="M1464"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq733.gif"/></alternatives></inline-formula> itself, and <italic>irregular arcs</italic>, which are parts of the boundary of some other object <inline-formula id="IEq734"><alternatives><tex-math id="M1465">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_k$$\end{document}</tex-math><mml:math id="M1466"><mml:msub><mml:mi>o</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq734.gif"/></alternatives></inline-formula>. To bound the number of vertices of <inline-formula id="IEq735"><alternatives><tex-math id="M1467">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {U}(\nu )$$\end{document}</tex-math><mml:math id="M1468"><mml:mrow><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq735.gif"/></alternatives></inline-formula> of the form <inline-formula id="IEq736"><alternatives><tex-math id="M1469">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial o_i^* \cap \partial o_j^*$$\end{document}</tex-math><mml:math id="M1470"><mml:mrow><mml:mi mathvariant="italic">&#x02202;</mml:mi><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>&#x02229;</mml:mo><mml:mi mathvariant="italic">&#x02202;</mml:mi><mml:msubsup><mml:mi>o</mml:mi><mml:mi>j</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq736.gif"/></alternatives></inline-formula> we now distinguish three cases.</p><p id="Par99">
<sc>Case A: </sc>Intersections between two regular arcs. In this case <italic>u</italic> is either a level-0 vertex of the arrangement defined by <inline-formula id="IEq737"><alternatives><tex-math id="M1471">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}(\nu )$$\end{document}</tex-math><mml:math id="M1472"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq737.gif"/></alternatives></inline-formula> (namely when <italic>u</italic> is contained in no other object <inline-formula id="IEq738"><alternatives><tex-math id="M1473">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_k\in \mathcal {O}(\nu )$$\end{document}</tex-math><mml:math id="M1474"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq738.gif"/></alternatives></inline-formula>), or a level-1 vertex of that arrangement (when <italic>u</italic> is contained in a single object <inline-formula id="IEq739"><alternatives><tex-math id="M1475">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_k\in \mathcal {O}(\nu )$$\end{document}</tex-math><mml:math id="M1476"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq739.gif"/></alternatives></inline-formula>). Note that <italic>u</italic> cannot be contained in two objects from <inline-formula id="IEq740"><alternatives><tex-math id="M1477">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}(\nu )$$\end{document}</tex-math><mml:math id="M1478"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq740.gif"/></alternatives></inline-formula>, because then <italic>u</italic> would be in the interior of some <inline-formula id="IEq741"><alternatives><tex-math id="M1479">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_k^*\in \mathcal {O}^*(\nu )$$\end{document}</tex-math><mml:math id="M1480"><mml:mrow><mml:msubsup><mml:mi>o</mml:mi><mml:mi>k</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">O</mml:mi></mml:mrow><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq741.gif"/></alternatives></inline-formula>, contradicting that <italic>u</italic> is a vertex of <inline-formula id="IEq742"><alternatives><tex-math id="M1481">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {U}(\nu )$$\end{document}</tex-math><mml:math id="M1482"><mml:mrow><mml:mi mathvariant="script">U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">&#x003bd;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq742.gif"/></alternatives></inline-formula>. See Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>a.</p><p id="Par100">
<sc>Case B: </sc>Intersections between a regular arc and an irregular arc. Without loss of generality, assume that <italic>u</italic> is the intersection of a regular arc of <inline-formula id="IEq743"><alternatives><tex-math id="M1483">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial o_i^*$$\end{document}</tex-math><mml:math id="M1484"><mml:mrow><mml:mi mathvariant="italic">&#x02202;</mml:mi><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq743.gif"/></alternatives></inline-formula> and an irregular arc of <inline-formula id="IEq744"><alternatives><tex-math id="M1485">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial o_j^*$$\end{document}</tex-math><mml:math id="M1486"><mml:mrow><mml:mi mathvariant="italic">&#x02202;</mml:mi><mml:msubsup><mml:mi>o</mml:mi><mml:mi>j</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq744.gif"/></alternatives></inline-formula>. Note that this implies that <italic>u</italic> lies in the interior of <inline-formula id="IEq745"><alternatives><tex-math id="M1487">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_j$$\end{document}</tex-math><mml:math id="M1488"><mml:msub><mml:mi>o</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq745.gif"/></alternatives></inline-formula>. If there is no other object <inline-formula id="IEq746"><alternatives><tex-math id="M1489">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_k\in \mathcal {O}$$\end{document}</tex-math><mml:math id="M1490"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq746.gif"/></alternatives></inline-formula> containing&#x000a0;<italic>u</italic> then <italic>u</italic> would be a vertex of <inline-formula id="IEq747"><alternatives><tex-math id="M1491">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_j^*$$\end{document}</tex-math><mml:math id="M1492"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>j</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq747.gif"/></alternatives></inline-formula>, and if there is at least one object <inline-formula id="IEq748"><alternatives><tex-math id="M1493">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_k\in \mathcal {O}$$\end{document}</tex-math><mml:math id="M1494"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq748.gif"/></alternatives></inline-formula> containing&#x000a0;<italic>u</italic> then <italic>u</italic> would not lie on <inline-formula id="IEq749"><alternatives><tex-math id="M1495">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial o_j^*$$\end{document}</tex-math><mml:math id="M1496"><mml:mrow><mml:mi mathvariant="italic">&#x02202;</mml:mi><mml:msubsup><mml:mi>o</mml:mi><mml:mi>j</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq749.gif"/></alternatives></inline-formula>. So, under the assumption that <italic>u</italic> is not already a vertex of <inline-formula id="IEq750"><alternatives><tex-math id="M1497">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_j^*$$\end{document}</tex-math><mml:math id="M1498"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>j</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq750.gif"/></alternatives></inline-formula>, Case B does not happen. See Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>b.</p><p id="Par101">
<sc>Case C:</sc> Intersections between two irregular arcs. In this case <italic>u</italic> lies in the interior of both <inline-formula id="IEq751"><alternatives><tex-math id="M1499">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i$$\end{document}</tex-math><mml:math id="M1500"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq751.gif"/></alternatives></inline-formula> and <inline-formula id="IEq752"><alternatives><tex-math id="M1501">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_j$$\end{document}</tex-math><mml:math id="M1502"><mml:msub><mml:mi>o</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq752.gif"/></alternatives></inline-formula>. But then <italic>u</italic> should also be in the interior of <inline-formula id="IEq753"><alternatives><tex-math id="M1503">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i^*$$\end{document}</tex-math><mml:math id="M1504"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq753.gif"/></alternatives></inline-formula> and <inline-formula id="IEq754"><alternatives><tex-math id="M1505">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_j^*$$\end{document}</tex-math><mml:math id="M1506"><mml:msubsup><mml:mi>o</mml:mi><mml:mi>j</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq754.gif"/></alternatives></inline-formula>, so this case cannot happen. <inline-formula id="IEq755"><alternatives><tex-math id="M1507">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M1508"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq755.gif"/></alternatives></inline-formula>
</p><p>Putting everything together we obtain the following result.</p></sec><sec id="FPar27"><title>Theorem 6</title><p id="Par103">Let <inline-formula id="IEq756"><alternatives><tex-math id="M1509">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M1510"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq756.gif"/></alternatives></inline-formula> be a set of <italic>n</italic> constant-complexity objects in <inline-formula id="IEq757"><alternatives><tex-math id="M1511">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^2$$\end{document}</tex-math><mml:math id="M1512"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq757.gif"/></alternatives></inline-formula> from a class of objects such that the maximum union complexity of any <italic>m</italic> objects from the class is <italic>U</italic>(<italic>m</italic>). Then there is a data structure that uses <inline-formula id="IEq758"><alternatives><tex-math id="M1513">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(U(n)\log n)$$\end{document}</tex-math><mml:math id="M1514"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq758.gif"/></alternatives></inline-formula> storage and that allows us to report for any axis-aligned query rectangle&#x000a0;<inline-formula id="IEq759"><alternatives><tex-math id="M1515">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1516"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq759.gif"/></alternatives></inline-formula>, in <inline-formula id="IEq760"><alternatives><tex-math id="M1517">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O((k+1)\log ^2 n)$$\end{document}</tex-math><mml:math id="M1518"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq760.gif"/></alternatives></inline-formula> time all pairs of objects <inline-formula id="IEq761"><alternatives><tex-math id="M1519">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i,o_j$$\end{document}</tex-math><mml:math id="M1520"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq761.gif"/></alternatives></inline-formula> in <inline-formula id="IEq762"><alternatives><tex-math id="M1521">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M1522"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq762.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq763"><alternatives><tex-math id="M1523">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_i$$\end{document}</tex-math><mml:math id="M1524"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq763.gif"/></alternatives></inline-formula> intersects <inline-formula id="IEq764"><alternatives><tex-math id="M1525">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_j$$\end{document}</tex-math><mml:math id="M1526"><mml:msub><mml:mi>o</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq764.gif"/></alternatives></inline-formula> inside <inline-formula id="IEq765"><alternatives><tex-math id="M1527">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}$$\end{document}</tex-math><mml:math id="M1528"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq765.gif"/></alternatives></inline-formula>, where <italic>k</italic> denotes the number of answers.</p></sec></sec><sec id="Sec6"><title>Discussion</title><p id="Par104">We presented data structures for finding intersecting pairs of objects inside a query rectangle. An obvious open problem is whether our bounds can be improved. In particular, one would hope that better solutions are possible for 3-dimensional boxes, where we obtained <inline-formula id="IEq766"><alternatives><tex-math id="M1529">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O((k+\sqrt{n})\cdot {{\mathrm{polylog\,}}}n)$$\end{document}</tex-math><mml:math id="M1530"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mi mathvariant="normal">polylog</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq766.gif"/></alternatives></inline-formula> query time with <inline-formula id="IEq767"><alternatives><tex-math id="M1531">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\sqrt{n}\log n)$$\end{document}</tex-math><mml:math id="M1532"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq767.gif"/></alternatives></inline-formula> storage. (We can reduce the query time to <inline-formula id="IEq768"><alternatives><tex-math id="M1533">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O((k+m)\cdot {{\mathrm{polylog\,}}}n)$$\end{document}</tex-math><mml:math id="M1534"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mi mathvariant="normal">polylog</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq768.gif"/></alternatives></inline-formula>, for any <inline-formula id="IEq769"><alternatives><tex-math id="M1535">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\leqslant m\leqslant \sqrt{n}$$\end{document}</tex-math><mml:math id="M1536"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02a7d;</mml:mo><mml:mi>m</mml:mi><mml:mo>&#x02a7d;</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq769.gif"/></alternatives></inline-formula>, but at the cost of increasing the storage to <inline-formula id="IEq770"><alternatives><tex-math id="M1537">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O((n^2/m)\cdot {{\mathrm{polylog\,}}}n)$$\end{document}</tex-math><mml:math id="M1538"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mi mathvariant="normal">polylog</mml:mi><mml:mspace width="0.166667em"/></mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq770.gif"/></alternatives></inline-formula>.)</p><p id="Par105">Two settings where we have not been able to obtain efficient solutions are when the objects are balls in <inline-formula id="IEq771"><alternatives><tex-math id="M1539">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^3$$\end{document}</tex-math><mml:math id="M1540"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq771.gif"/></alternatives></inline-formula>, and when they are arbitrary segments in <inline-formula id="IEq772"><alternatives><tex-math id="M1541">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb R}^2$$\end{document}</tex-math><mml:math id="M1542"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq772.gif"/></alternatives></inline-formula>. Especially the latter case is challenging. Indeed, suppose <inline-formula id="IEq773"><alternatives><tex-math id="M1543">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}$$\end{document}</tex-math><mml:math id="M1544"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq773.gif"/></alternatives></inline-formula> consists of <italic>n</italic>&#x000a0;/&#x000a0;2 horizontal lines and <italic>n</italic>&#x000a0;/&#x000a0;2 lines of slope&#x000a0;1. Suppose furthermore that the query is a vertical line&#x000a0;<inline-formula id="IEq774"><alternatives><tex-math id="M1545">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell $$\end{document}</tex-math><mml:math id="M1546"><mml:mi>&#x02113;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq774.gif"/></alternatives></inline-formula> and that we only want to check if <inline-formula id="IEq775"><alternatives><tex-math id="M1547">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell $$\end{document}</tex-math><mml:math id="M1548"><mml:mi>&#x02113;</mml:mi></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq775.gif"/></alternatives></inline-formula> contains at least one intersection. A data structure for this can be used to solve the following <sc>3Sum</sc>-hard problem: given three sets of parallel lines, decide if there is a triple intersection&#x000a0;[<xref ref-type="bibr" rid="CR14">14</xref>]. Thus it is unlikely that we can obtain a solution with sublinear query time and subquadratic preprocessing time. However, storage is not the same as preprocessing time. This raises the following question: is it possible to obtain sublinear query time with subquadratic storage? Another interesting question would be to see whether or not the query time in Theorem&#x000a0;<xref ref-type="sec" rid="FPar3">1</xref> can be improved to <inline-formula id="IEq776"><alternatives><tex-math id="M1549">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log n +k)$$\end{document}</tex-math><mml:math id="M1550"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq776.gif"/></alternatives></inline-formula>.</p></sec></body><back><fn-group><fn id="Fn1"><label>1</label><p id="Par6">Here <inline-formula id="IEq39"><alternatives><tex-math id="M1551">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log ^* n$$\end{document}</tex-math><mml:math id="M1552"><mml:mrow><mml:msup><mml:mo>log</mml:mo><mml:mo>&#x02217;</mml:mo></mml:msup><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq39.gif"/></alternatives></inline-formula> denotes the iterated logarithm.</p></fn></fn-group><ack><title>Acknowledgements</title><p>M.&#x000a0;de Berg and A.&#x000a0;D.&#x000a0;Mehrabi were supported by the Netherlands Organization for Scientific Research (NWO) under Grants 024.002.003 and 612.001.118, respectively. J.&#x000a0;Gudmundsson was supported by the Australian Research Council (Project Nos. FT100100755 and DP150101134). The authors also thank the anonymous reviewers for useful comments.</p></ack><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abam</surname><given-names>M</given-names></name><name><surname>Carmi</surname><given-names>P</given-names></name><name><surname>Farshi</surname><given-names>M</given-names></name><name><surname>Smid</surname><given-names>M</given-names></name></person-group><article-title>On the power of semi-separated pair decomposition</article-title><source>Comput. Geom.</source><year>2013</year><volume>46</volume><fpage>631</fpage><lpage>639</lpage><pub-id pub-id-type="doi">10.1016/j.comgeo.2013.02.003</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><mixed-citation publication-type="other">Afshani, P., Arge, L., Larsen, K.D.: Orthogonal range reporting in three and higher dimensions. In: Proceedings of IEEE Symposium, pp. 149&#x02013;158 (2009)</mixed-citation></ref><ref id="CR3"><label>3.</label><mixed-citation publication-type="other">Afshani, P., Arge, L., Larsen, K.D.: Orthogonal range reporting: query lower bounds, optimal structures in 3-d, and higher-dimensional improvements. In: Proceedings of ACM Symposium on Computational Geometry, pp.&#x000a0;240&#x02013;246 (2010)</mixed-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Agarwal</surname><given-names>PK</given-names></name><name><surname>Erickson</surname><given-names>J</given-names></name></person-group><article-title>Geometric range searching and its relatives</article-title><source>Contemp. Math.</source><year>1999</year><volume>223</volume><fpage>1</fpage><lpage>56</lpage><pub-id pub-id-type="doi">10.1090/conm/223/03131</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aronov</surname><given-names>B</given-names></name><name><surname>de Berg</surname><given-names>M</given-names></name><name><surname>Ezra</surname><given-names>E</given-names></name><name><surname>Sharir</surname><given-names>M</given-names></name></person-group><article-title>Improved bounds for the union of locally fat objects in the plane</article-title><source>SIAM J. Comput.</source><year>2014</year><volume>43</volume><issue>2</issue><fpage>543</fpage><lpage>572</lpage><pub-id pub-id-type="doi">10.1137/120891241</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chazelle</surname><given-names>B</given-names></name></person-group><article-title>Filtering search: a new approach to query-answering</article-title><source>SIAM J. Comput.</source><year>1986</year><volume>15</volume><issue>3</issue><fpage>703</fpage><lpage>724</lpage><pub-id pub-id-type="doi">10.1137/0215051</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chazelle</surname><given-names>B</given-names></name></person-group><article-title>A functional approach to data structures and its use in multidimensional searching</article-title><source>SIAM J. Comput.</source><year>1988</year><volume>17</volume><fpage>427</fpage><lpage>462</lpage><pub-id pub-id-type="doi">10.1137/0217026</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clarkson</surname><given-names>KL</given-names></name><name><surname>Shor</surname><given-names>PW</given-names></name></person-group><article-title>Applications of random sampling in computational geometry. II</article-title><source>Discrete Comput. Geom.</source><year>1989</year><volume>4</volume><fpage>387</fpage><lpage>421</lpage><pub-id pub-id-type="doi">10.1007/BF02187740</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="other">Davoodi, P., Smid, M., van Walderveen, F.: Two-dimensional range diameter queries. In: Proceedings of Latin American Symposium on Theoretical Informatics, pp. 219-230 (2012)</mixed-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Das</surname><given-names>AS</given-names></name><name><surname>Gupta</surname><given-names>P</given-names></name><name><surname>Srinathan</surname><given-names>K</given-names></name></person-group><article-title>Data structures for extension violations in a query range</article-title><source>J. Math. Model. Algorithms</source><year>2011</year><volume>10</volume><issue>1</issue><fpage>79</fpage><lpage>107</lpage><pub-id pub-id-type="doi">10.1007/s10852-010-9144-y</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>de Berg</surname><given-names>M</given-names></name><name><surname>Cheong</surname><given-names>O</given-names></name><name><surname>van Kreveld</surname><given-names>M</given-names></name><name><surname>Overmars</surname><given-names>M</given-names></name></person-group><source>Computational Geometry: Algorithms and Applications</source><year>2008</year><edition>3</edition><publisher-loc>Berlin</publisher-loc><publisher-name>Springer</publisher-name></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edelsbrunner</surname><given-names>H</given-names></name><name><surname>Guibas</surname><given-names>LJ</given-names></name><name><surname>Stolfi</surname><given-names>J</given-names></name></person-group><article-title>Optimal point location in a monotone subdivision</article-title><source>SIAM J. Comput.</source><year>1986</year><volume>15</volume><fpage>317</fpage><lpage>340</lpage><pub-id pub-id-type="doi">10.1137/0215023</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edelsbrunner</surname><given-names>H</given-names></name><name><surname>Overmars</surname><given-names>MH</given-names></name><name><surname>Seidel</surname><given-names>R</given-names></name></person-group><article-title>Some methods of computational geometry applied to computer graphics</article-title><source>Comput. Vis. Graphics Image Proc.</source><year>1984</year><volume>28</volume><fpage>92</fpage><lpage>108</lpage><pub-id pub-id-type="doi">10.1016/0734-189X(84)90142-7</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gajentaan</surname><given-names>A</given-names></name><name><surname>Overmars</surname><given-names>MH</given-names></name></person-group><article-title>On a class of <inline-formula id="IEq779"><alternatives><tex-math id="M1553">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n^2)$$\end{document}</tex-math><mml:math id="M1554"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq779.gif"/></alternatives></inline-formula> problems in computational geometry</article-title><source>Comput. Geom. Theory Appl.</source><year>1995</year><volume>5</volume><fpage>165</fpage><lpage>185</lpage><pub-id pub-id-type="doi">10.1016/0925-7721(95)00022-2</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><mixed-citation publication-type="other">Goodman, J.E., O&#x02019;Rourke, J.: Range searching. In: Handbook of Discrete and Computational Geometry, Chapter&#x000a0;36, 2nd edn (2004)</mixed-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>P</given-names></name></person-group><article-title>Range-aggregate query problems involving geometric aggregation operations</article-title><source>Nord. J. Comput.</source><year>2006</year><volume>13</volume><issue>4</issue><fpage>294</fpage><lpage>308</lpage></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>P</given-names></name><name><surname>Janardan</surname><given-names>R</given-names></name><name><surname>Kumar</surname><given-names>Y</given-names></name><name><surname>Smid</surname><given-names>M</given-names></name></person-group><article-title>Data structures for range-aggregate extent queries</article-title><source>Comput. Geom. Theory Appl.</source><year>2014</year><volume>47</volume><fpage>329</fpage><lpage>347</lpage><pub-id pub-id-type="doi">10.1016/j.comgeo.2009.08.001</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keden</surname><given-names>K</given-names></name><name><surname>Livne</surname><given-names>R</given-names></name><name><surname>Pach</surname><given-names>J</given-names></name><name><surname>Sharir</surname><given-names>M</given-names></name></person-group><article-title>On the union of Jordan regions and collision-free translational motion amidst polygonal obstacles</article-title><source>Discr. Comput. Geom.</source><year>1986</year><volume>1</volume><fpage>59</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1007/BF02187683</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><mixed-citation publication-type="other">Rahul, S.: Improved bounds for orthogonal point enclosure query and point location in orthogonal subdivisions in <inline-formula id="IEq781"><alternatives><tex-math id="M1555">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{R}}^3$$\end{document}</tex-math><mml:math id="M1556"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="453_2017_384_Article_IEq781.gif"/></alternatives></inline-formula>. In: ACM-SIAM Symposium on Discrete Algorithms,&#x000a0;pp. 200&#x02013;211 (2015)</mixed-citation></ref><ref id="CR20"><label>20.</label><mixed-citation publication-type="other">Rahul, S.: Personal communication</mixed-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="other">Rahul, S., Das, A.S., Rajan, K.S., Srinatan, K.: Range-aggregate queries involving geometric aggregation operations. In: Workshop on Algorithms and Computation, vol. 1, pp. 122&#x02013;133 (2011)</mixed-citation></ref></ref-list></back></article>