<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">23460894</article-id><article-id pub-id-type="pmc">3583903</article-id><article-id pub-id-type="publisher-id">PONE-D-12-19756</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0057684</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Computational Biology</subject><subj-group><subject>Genomics</subject><subj-group><subject>Comparative Genomics</subject><subject>Genome Analysis Tools</subject><subject>Genome Databases</subject></subj-group></subj-group><subj-group><subject>Biological Data Management</subject><subject>Sequence Analysis</subject></subj-group></subj-group><subj-group><subject>Microbiology</subject><subj-group><subject>Virology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Computer Science</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Medicine</subject><subj-group><subject>Infectious Diseases</subject><subj-group><subject>Viral Diseases</subject><subj-group><subject>Influenza</subject></subj-group></subj-group></subj-group></subj-group></article-categories><title-group><article-title>Resampling Nucleotide Sequences with Closest-Neighbor Trimming and Its Comparison to Other Methods</article-title><alt-title alt-title-type="running-head">The Closest-Neighbor Trimming Method</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Yonezawa</surname><given-names>Kouki</given-names></name><xref ref-type="aff" rid="aff1">
<sup>1</sup>
</xref></contrib><contrib contrib-type="author"><name><surname>Igarashi</surname><given-names>Manabu</given-names></name><xref ref-type="aff" rid="aff2">
<sup>2</sup>
</xref></contrib><contrib contrib-type="author"><name><surname>Ueno</surname><given-names>Keisuke</given-names></name><xref ref-type="aff" rid="aff2">
<sup>2</sup>
</xref></contrib><contrib contrib-type="author"><name><surname>Takada</surname><given-names>Ayato</given-names></name><xref ref-type="aff" rid="aff3">
<sup>3</sup>
</xref></contrib><contrib contrib-type="author"><name><surname>Ito</surname><given-names>Kimihito</given-names></name><xref ref-type="aff" rid="aff2">
<sup>2</sup>
</xref><xref ref-type="corresp" rid="cor1">
<sup>*</sup>
</xref></contrib></contrib-group><aff id="aff1">
<label>1</label>
<addr-line>Department of Computer Bioscience, Nagahama Institute of Bio-science and Technology, Nagahama, Shiga-pref, Japan</addr-line>
</aff><aff id="aff2">
<label>2</label>
<addr-line>Division of Bioinformatics, Hokkaido University Research Center for Zoonosis Control, Kita-ku, Sapporo, Japan</addr-line>
</aff><aff id="aff3">
<label>3</label>
<addr-line>Division of Global Epidemiology, Hokkaido University Research Center for Zoonosis Control, Kita-ku, Sapporo, Japan</addr-line>
</aff><contrib-group><contrib contrib-type="editor"><name><surname>Schnur</surname><given-names>Joel M.</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">
<addr-line>George Mason University, United States of America</addr-line>
</aff><author-notes><corresp id="cor1">* E-mail: <email>itok@czc.hokudai.ac.jp</email></corresp><fn fn-type="COI-statement"><p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p></fn><fn fn-type="con"><p>Conceived and designed the experiments: KI MI AT. Performed the experiments: KY KI. Analyzed the data: KY KI. Wrote the paper: KY KI MI KU.</p></fn></author-notes><pub-date pub-type="collection"><year>2013</year></pub-date><pub-date pub-type="epub"><day>27</day><month>2</month><year>2013</year></pub-date><volume>8</volume><issue>2</issue><elocation-id>e57684</elocation-id><history><date date-type="received"><day>29</day><month>6</month><year>2012</year></date><date date-type="accepted"><day>27</day><month>1</month><year>2013</year></date></history><permissions><copyright-statement>&#x000a9; 2013 Yonezawa et al</copyright-statement><copyright-year>2013</copyright-year><copyright-holder>Yonezawa et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p></license></permissions><abstract><p>A large number of nucleotide sequences of various pathogens are available in public databases. The growth of the datasets has resulted in an enormous increase in computational costs. Moreover, due to differences in surveillance activities, the number of sequences found in databases varies from one country to another and from year to year. Therefore, it is important to study resampling methods to reduce the sampling bias. A novel algorithm&#x02013;called the closest-neighbor trimming method&#x02013;that resamples a given number of sequences from a large nucleotide sequence dataset was proposed. The performance of the proposed algorithm was compared with other algorithms by using the nucleotide sequences of human H3N2 influenza viruses. We compared the closest-neighbor trimming method with the naive hierarchical clustering algorithm and <inline-formula><inline-graphic xlink:href="pone.0057684.e001.jpg"/></inline-formula>-medoids clustering algorithm. Genetic information accumulated in public databases contains sampling bias. The closest-neighbor trimming method can thin out densely sampled sequences from a given dataset. Since nucleotide sequences are among the most widely used materials for life sciences, we anticipate that our algorithm to various datasets will result in reducing sampling bias.</p></abstract><funding-group><funding-statement>This work was supported by the Global COE Program "Establishment of International Collaboration Centers for Zoonosis Control", the Japan Initiative for Global Research Network on Infectious Diseases (J-GRID), KAKENHI 24700289, all from the Ministry of Education, Culture, Sports, Science and Technology (MEXT), Japan, and PRESTO and SORST from Japan Science and Technology Agency (JST) Basic Research Programs. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="7"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>When investigating the transmission of an infectious disease, researchers utilize the similarity among nucleotide sequences of its causative agent. Remarkable efforts have been made at both the national and international levels to collect genetic information on important pathogens. As a result, a large number of pathogen-related sequences have been accumulated in public databases. There exist more than 170000 nucleotide sequences of influenza viruses in the NCBI Influenza Virus Resources <xref rid="pone.0057684-Bao1" ref-type="bibr">[1]</xref> and more than 410000 sequences of human immunodeficiency viruses in the HIV sequence database <xref rid="pone.0057684-HIV1" ref-type="bibr">[2]</xref>.</p><p>The rapid growth in the number of nucleotide sequences poses two critical problems. One is an enormous increase in computational costs. Sequence data analyses&#x02013;including the multiple sequence alignment, phylogenetic analysis, and similarity searches of nucleotide sequences&#x02013;involve time-consuming computations. Multiple sequence alignment is an NP-complete problem <xref rid="pone.0057684-Pevzner1" ref-type="bibr">[3]</xref>. Phylogenetic analysis using the neighbor-joining method takes <inline-formula><inline-graphic xlink:href="pone.0057684.e002.jpg"/></inline-formula> time, where <inline-formula><inline-graphic xlink:href="pone.0057684.e003.jpg"/></inline-formula> denotes the number of sequences <xref rid="pone.0057684-Saitou1" ref-type="bibr">[4]</xref>. The similarity searches using BLAST take <inline-formula><inline-graphic xlink:href="pone.0057684.e004.jpg"/></inline-formula> time, where <inline-formula><inline-graphic xlink:href="pone.0057684.e005.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0057684.e006.jpg"/></inline-formula> denote the length of the subsequence of queries and the number of sequences, respectively <xref rid="pone.0057684-Altschul1" ref-type="bibr">[5]</xref>.</p><p>The other problem is sampling bias in public databases, which occurs when sequences are not sampled randomly. One factor is the difference in surveillance activities among countries. Developed countries having high surveillance activities submit more sequences than other countries. Another factor is the advance in sequencing technologies in the last two decades. The databases tends to contain more sequences from recent strains than from old strains. Therefore it is important to study resampling methods to reduce sampling bias.</p><p>There are several methods that might be used for resampling tasks. Zaslavsky et al. proposed a resampling method that was used to display large phylogenetic trees in a limited screen area <xref rid="pone.0057684-Zaslavsky1" ref-type="bibr">[6]</xref>. Some clustering algorithms, including naive hierarchical clustering (cf. <xref rid="pone.0057684-Socal1" ref-type="bibr">[7]</xref>) and <inline-formula><inline-graphic xlink:href="pone.0057684.e007.jpg"/></inline-formula>-medoids clustering <xref rid="pone.0057684-Vinod1" ref-type="bibr">[8]</xref>, select certain data points as representatives of clusters. These clustering algorithms can be used for resampling large datasets. One simple idea to reduce sampling bias is to remove more sequences from densely sampled ones than from sparsely sampled ones.</p><p>In this paper we propose a novel algorithm&#x02013;called the closest-neighbor trimming method&#x02013;that resamples a given number of sequences from a large nucleotide sequence dataset. The method first constructs a phylogenetic tree with the whole sequence dataset. It finds the pair of neighbors having the shortest distance among all pairs of neighbors, and trims one leaf away. By repeating this procedure, the algorithm thins out densely sampled sequences in the dataset. We compare the performance of the closest-neighbor trimming method with those of other methods with respect to the average maximum similarities of discarded sequences to the resampled sequences, nucleotide diversities of the resampled sequences, and standard deviations for the number of resampled sequences in a year.</p></sec><sec sec-type="materials|methods" id="s2"><title>Materials and Methods</title><sec id="s2a"><title>The Resampling Problem</title><p>Before describing the algorithms, we define the resampling problem. Given a set of <inline-formula><inline-graphic xlink:href="pone.0057684.e008.jpg"/></inline-formula> sequences <inline-formula><inline-graphic xlink:href="pone.0057684.e009.jpg"/></inline-formula>, resampling is a task to select a subset of <inline-formula><inline-graphic xlink:href="pone.0057684.e010.jpg"/></inline-formula> sequences <inline-formula><inline-graphic xlink:href="pone.0057684.e011.jpg"/></inline-formula>. We assume that all the sequences in <inline-formula><inline-graphic xlink:href="pone.0057684.e012.jpg"/></inline-formula> are of the same length or already aligned. <inline-formula><inline-graphic xlink:href="pone.0057684.e013.jpg"/></inline-formula> might not be randomly sampled from the population. The characteristics of sequences in the population are often unknown except for some features. The goal of resampling is to find <inline-formula><inline-graphic xlink:href="pone.0057684.e014.jpg"/></inline-formula>, which reflects original characteristics of sequences in the population.</p></sec><sec id="s2b"><title>The Closest-neighbor Trimming (CNT) Method</title><p>We propose a resampling algorithm&#x02013;called the closest-neighbor trimming (CNT) method&#x02013;that removes densely sampled sequences. First, CNT constructs a phylogenetic tree from all the sequences in the dataset. CNT does not assume a particular tree construction method. If the phylogenetic tree is not binary, CNT arbitrarily arranges the tree so that it is binary. We denote a binary phylogenetic tree by <inline-formula><inline-graphic xlink:href="pone.0057684.e015.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0057684.e016.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0057684.e017.jpg"/></inline-formula> represent a set of nodes and a set of edges, respectively. Given <inline-formula><inline-graphic xlink:href="pone.0057684.e018.jpg"/></inline-formula>, CNT repeats the following procedures until the number of remaining sequences reaches <inline-formula><inline-graphic xlink:href="pone.0057684.e019.jpg"/></inline-formula>. First CNT finds the pair of neighbors with the shortest distance among all pairs of neighbors. Then it removes one of the neighbors. After that it removes the parent and connects the upper branches of the remaining leaf so that the resulting tree <inline-formula><inline-graphic xlink:href="pone.0057684.e020.jpg"/></inline-formula> is binary. Whether the CNT removes one of the neighbors further from their parent or one closer to it can be specified. In this paper, we call it the CNT-closer algorithm when it trims the neighbor further from the parent, that is, it leaves the closer one. We call it the CNT-further algorithm when it leaves the further neighbor. In the case that it randomly chooses one of the neighbors to be trimmed, it is called the CNT-random algorithm. However, for simplicity we treat only the CNT-further algorithm (CNT for short) in the main paper and all types of CNT algorithms are dealt with in Supporting Information S1. The pseudocode and a schematic image of the CNT-further method are shown in <xref ref-type="fig" rid="pone-0057684-g001">Figure 1</xref>.</p><fig id="pone-0057684-g001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0057684.g001</object-id><label>Figure 1</label><caption><title>Description of the CNT algorithm. (A) the pseudocode and (B) a schematic image.</title></caption><graphic xlink:href="pone.0057684.g001"/></fig></sec><sec id="s2c"><title>Comparison of the CNT Method with Other Methods</title><sec id="s2c1"><title>The method proposed by Zaslavsky et al. (ZAS05)</title><p>We denote the algorithm proposed by Zaslavsky et al. <xref rid="pone.0057684-Zaslavsky1" ref-type="bibr">[6]</xref> as ZAS05. Given a phylogenetic tree <inline-formula><inline-graphic xlink:href="pone.0057684.e021.jpg"/></inline-formula>, ZAS05 first selects two sequences. One is the closest to the root and the other is the furthest from the root. After that, it selects a sequence at each step until the number of selected sequences reaches <inline-formula><inline-graphic xlink:href="pone.0057684.e022.jpg"/></inline-formula> as follows: Suppose <inline-formula><inline-graphic xlink:href="pone.0057684.e023.jpg"/></inline-formula> is the set of already selected sequences. For sequence <inline-formula><inline-graphic xlink:href="pone.0057684.e024.jpg"/></inline-formula>, the distance between <inline-formula><inline-graphic xlink:href="pone.0057684.e025.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0057684.e026.jpg"/></inline-formula> is defined as the minimum distance between <inline-formula><inline-graphic xlink:href="pone.0057684.e027.jpg"/></inline-formula> and the one belonging to <inline-formula><inline-graphic xlink:href="pone.0057684.e028.jpg"/></inline-formula>. Their algorithm finds the sequence that has the maximum distance to <inline-formula><inline-graphic xlink:href="pone.0057684.e029.jpg"/></inline-formula>.</p></sec><sec id="s2c2"><title>The naive hierarchical clustering (NHC) algorithm</title><p>The naive hierarchical clustering (NHC) or UPGMA (cf. <xref rid="pone.0057684-Socal1" ref-type="bibr">[7]</xref>) selects some data points as representatives of clusters. By removing the data points other than selected representatives, this algorithm can be used for resampling. Giving an <inline-formula><inline-graphic xlink:href="pone.0057684.e030.jpg"/></inline-formula> dissimilarity matrix <inline-formula><inline-graphic xlink:href="pone.0057684.e031.jpg"/></inline-formula>, NHC finds the pair having the shortest distance among all the pairs of sequences. Then NHC discards the one having longer distance to all the other sequences. NHC repeats this procedure until the number of remaining sequences reaches <inline-formula><inline-graphic xlink:href="pone.0057684.e032.jpg"/></inline-formula>. When there is more than one pair with the shortest distance, NHC selects the pair that contains the sequence appearing earliest in the dataset among all the pairs with the shortest distance.</p></sec><sec id="s2c3"><title>The <inline-formula><inline-graphic xlink:href="pone.0057684.e033.jpg"/></inline-formula>-medoids clustering (kMC) algorithm</title><p>We also apply the <inline-formula><inline-graphic xlink:href="pone.0057684.e034.jpg"/></inline-formula>-medoids clustering (kMC) method <xref rid="pone.0057684-Vinod1" ref-type="bibr">[8]</xref> for resampling sequences. Given an <inline-formula><inline-graphic xlink:href="pone.0057684.e035.jpg"/></inline-formula> distance matrix <inline-formula><inline-graphic xlink:href="pone.0057684.e036.jpg"/></inline-formula>, first kMC randomly selects <inline-formula><inline-graphic xlink:href="pone.0057684.e037.jpg"/></inline-formula> sequences as medoids. Then kMC repeats the following procedures. It assigns each sequence to the closest medoid. For each cluster it updates the medoid so that the total distance from the medoid to other members becomes the smallest. kMC repeats these procedures until no medoids change or the number of repetitions reaches a given threshold (1000 times in this paper).</p></sec><sec id="s2c4"><title>The dataset and the construction of phylogenetic trees</title><p>Nucleotide sequences of the hemagglutinin (HA) gene of human H3N2 influenza viruses were downloaded from the NCBI Influenza Virus Resource <xref rid="pone.0057684-Bao1" ref-type="bibr">[1]</xref>. The sequences of the HA1 domain were aligned using the MAFFT program <xref rid="pone.0057684-Katoh1" ref-type="bibr">[9]</xref>. The original dataset included sequences with the ambiguous nucleotide N, making it impossible to calculate the distance matrix of the dataset. Thus the sequences having ambiguous symbols N were removed. After that, we obtained 4655 sequences of 984 nucleotides. The dataset is as the same as that used in <xref rid="pone.0057684-Ito1" ref-type="bibr">[10]</xref>.</p><p>CNT and ZAS05 do not assume a particular method to construct phylogenetic trees. In our analysis the neighbor-joining method <xref rid="pone.0057684-Saitou1" ref-type="bibr">[4]</xref> was used. PHYLIP <xref rid="pone.0057684-Felsenstein1" ref-type="bibr">[11]</xref> was employed for constructing the phylogenetic trees. Here, the Jukes-Cantor model <xref rid="pone.0057684-Jukes1" ref-type="bibr">[12]</xref> was applied for constructing distance matrices. The resulting phylogenetic tree is shown in Figure 9A. Like this one, phylogenetic trees constructed with nucleotide sequences of influenza A viruses tend to have a very high fraction of sequences having other very similar ones and a characteristically unbalanced distribution of ancestral nodes.</p></sec></sec><sec id="s2d"><title>Evaluation of the Performances of the Resampling Algorithms</title><sec id="s2d1"><title>Average maximum similarities of discarded sequences to the resampled sequences</title><p>We need to evaluate the performances of resampling algorithms with respect to preservation the nature of the original dataset and reduction of sampling bias. Regardless how the trimmed sequence data are used, they should cover the original dataset. For this task, we introduced two measurements. The first measure was the average identity from the <inline-formula><inline-graphic xlink:href="pone.0057684.e038.jpg"/></inline-formula> discarded sequences to the <inline-formula><inline-graphic xlink:href="pone.0057684.e039.jpg"/></inline-formula> resampled sequences. We denote the number of different nucleotides between sequences <inline-formula><inline-graphic xlink:href="pone.0057684.e040.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0057684.e041.jpg"/></inline-formula> by <inline-formula><inline-graphic xlink:href="pone.0057684.e042.jpg"/></inline-formula>. The identity between two sequences <inline-formula><inline-graphic xlink:href="pone.0057684.e043.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0057684.e044.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0057684.e045.jpg"/></inline-formula>, is defined as the ratio of the same nucleotides in the two sequences, that is, <inline-formula><inline-graphic xlink:href="pone.0057684.e046.jpg"/></inline-formula>. We define the identity from the discarded sequences <inline-formula><inline-graphic xlink:href="pone.0057684.e047.jpg"/></inline-formula> to the resampled sequences <inline-formula><inline-graphic xlink:href="pone.0057684.e048.jpg"/></inline-formula> as follows:<disp-formula id="pone.0057684.e049"><graphic xlink:href="pone.0057684.e049.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p></sec><sec id="s2d2"><title>Nucleotide diversities of resampled sequences</title><p>We introduced nucleotide diversity proposed by Nei and Li <xref rid="pone.0057684-Nei1" ref-type="bibr">[13]</xref> for verifying whether the resampled sequences had enough variety. Resampled sequences with low nucleotide diversity may lead to different results from the original sequences. Let <inline-formula><inline-graphic xlink:href="pone.0057684.e050.jpg"/></inline-formula> be the number of nucleotide differences per nucleotide site between the <inline-formula><inline-graphic xlink:href="pone.0057684.e051.jpg"/></inline-formula>th and <inline-formula><inline-graphic xlink:href="pone.0057684.e052.jpg"/></inline-formula>th sequences and <inline-formula><inline-graphic xlink:href="pone.0057684.e053.jpg"/></inline-formula> be the total number of nucleotide sequences. Then the nucleotide diversity <inline-formula><inline-graphic xlink:href="pone.0057684.e054.jpg"/></inline-formula> is defined as follows:<disp-formula id="pone.0057684.e055"><graphic xlink:href="pone.0057684.e055.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p></sec><sec id="s2d3"><title>Standard deviations for the number of resampled sequences in a year</title><p>We utilize the distribution of years when the viruses in the dataset were isolated. In the ideal dataset the number of nucleotide sequences of an organism should be proportional to the number of individuals. In this paper we use a simplified assumption that the dataset should contain equal numbers of sequences. Although the numbers of patients and infection isolates vary extremely from year to year <xref rid="pone.0057684-Ferguson1" ref-type="bibr">[14]</xref>, the fluctuation in the number of sequences registered to the databases each year does not seem to be relative to the fluctuation of the number of patients or infection isolates. Thus we use the standard deviation of the number of sequences to evaluate the resampling algorithms with respect to reduction of sampling bias.</p></sec></sec></sec><sec id="s3"><title>Results</title><sec id="s3a"><title>Distribution of the Sequence Dataset</title><p>The dataset contained nucleotide sequences of human H3N2 influenza viruses isolated during the period from 1968 to 2011. Sequences from 1968 to 1991 accounted for about 7% of the dataset and about 93% were sequences from 1992 to 2011 (<xref ref-type="fig" rid="pone-0057684-g002">Figure 2A</xref>). This skewed distribution could be attributed to sampling bias due to the rapid development of sequencing technology around 1992 <xref rid="pone.0057684-Saiki1" ref-type="bibr">[15]</xref>. Additionally, more than 30% were sequences of influenza viruses isolated from the USA (<xref ref-type="fig" rid="pone-0057684-g002">Figure 2B</xref>). This large percentage would be associated with sampling bias due to the high surveillance activity in the United States <xref rid="pone.0057684-Ghedin1" ref-type="bibr">[16]</xref>. Moreover, from <xref ref-type="fig" rid="pone-0057684-g002">Figure 2C</xref>, it can be seen that there is a large gap between the numbers of the nucleotide sequences isolated before 1991 and after 1992. This is not because the number of infections drastically increased after 1992 but because the use of the PCR technique became widespread around 1992. Thus the number of sequences is not associated with the number of infections by these viruses.</p><fig id="pone-0057684-g002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0057684.g002</object-id><label>Figure 2</label><caption><title>Statistics of the sequences of HA of human H3N2 influenza virus. (A) distribution of isolation years and (B) distribution of isolation countries.</title><p>More than 92% were sequences isolated after 1992 and more than 30% were sequences of influenza viruses isolated from the USA. Moreover, there is a large gap on the number of nucleotide sequences of HA of human H3N2 influenza virus isolated before 1991 and after 1992, when the PCR technique had been in widespread use.</p></caption><graphic xlink:href="pone.0057684.g002"/></fig><p>
<xref ref-type="fig" rid="pone-0057684-g003">Figure 3</xref> shows the changes of distributions of isolation years as CNT, NHC, and kMC proceed with trimming. This figure demonstrates that all of them flatten the distributions of isolation years. In the following section we will present more precise analyses.</p><fig id="pone-0057684-g003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0057684.g003</object-id><label>Figure 3</label><caption><title>Changes of the distribution of the isolation years by means of (A) CNT, (B) NHC, and (C) kMC.</title></caption><graphic xlink:href="pone.0057684.g003"/></fig></sec><sec id="s3b"><title>Evaluation of Resampled Sequences</title><p>In the following analyses, we executed the algorithms with randomization, namely kMC, 100 times each and calculated the average maximum similarities, nucleotide diversities, and standard deviations for the number of resampled sequences in a year.</p><sec id="s3b1"><title>Average maximum similarities of discarded sequences to the resampled sequences</title><p>First we investigated the average sequence identity of discarded sequences against resampled sequences. Let <inline-formula><inline-graphic xlink:href="pone.0057684.e056.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0057684.e057.jpg"/></inline-formula> be the sets of the discarded and the remaining sequences, respectively. If a resampling algorithm discards one of the densely sampled sequences, <inline-formula><inline-graphic xlink:href="pone.0057684.e058.jpg"/></inline-formula>, the average maximum identity from the discarded sequences to the remaining ones, is expected to remain closer to 100%. Since the lowest identity among all pairs of nucleotide sequences was larger than 82.3%, no pair of sequences had an identity lower than 82.3%. Thus the average of maximum identity of the discarded sequences to the resampled sequences, <inline-formula><inline-graphic xlink:href="pone.0057684.e059.jpg"/></inline-formula>, never becomes smaller than 82.3%. <xref ref-type="fig" rid="pone-0057684-g004">Figure 4</xref> shows the values of <inline-formula><inline-graphic xlink:href="pone.0057684.e060.jpg"/></inline-formula> against the numbers of the discarded sequences. <inline-formula><inline-graphic xlink:href="pone.0057684.e061.jpg"/></inline-formula> of the CNT, NHC, and kMC algorithms remained near 100% until 90% of the sequences were discarded. On the other hand, <inline-formula><inline-graphic xlink:href="pone.0057684.e062.jpg"/></inline-formula> of ZAS05 fell more quickly than with the other three resampling algorithms. Therefore, in the following analysis, we excluded ZAS05.</p><fig id="pone-0057684-g004" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0057684.g004</object-id><label>Figure 4</label><caption><title>Relationship between average sequence identity between <inline-formula><inline-graphic xlink:href="pone.0057684.e063.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0057684.e064.jpg"/></inline-formula> sequences and the fraction of discarded sequences.</title><p>The horizontal axis represents the percentage of discarded sequences and the vertical axis represents identity <inline-formula><inline-graphic xlink:href="pone.0057684.e065.jpg"/></inline-formula>. It can be seen that the performance of ZAS05 is worse than those of the other three algorithms.</p></caption><graphic xlink:href="pone.0057684.g004"/></fig></sec><sec id="s3b2"><title>Nucleotide diversities of resampled sequences</title><p>
<xref ref-type="fig" rid="pone-0057684-g005">Figure 5</xref> shows the relationship between <inline-formula><inline-graphic xlink:href="pone.0057684.e066.jpg"/></inline-formula> and the fraction of discarded sequences. As trimming proceeded, the diversity of the sequences resampled by CNT or NHC increased. On the other hand, the diversity of the sequences resampled by kMC remained similar to the original value. We consider that the reason for this discrepancy is that the kMC algorithm does not always select medoids from densely sampled sequences, and this would be a disadvantage of the kMC algorithm. The NHC algorithm shows good performance with respect to <inline-formula><inline-graphic xlink:href="pone.0057684.e067.jpg"/></inline-formula> but it fluctuates. A possible reason is the fact that there are many possible pairs of sequences that have the same Hamming distances. The diversity <inline-formula><inline-graphic xlink:href="pone.0057684.e068.jpg"/></inline-formula> increases or decreases, depending on the sequence diversity around the removed sequences. When NHC is processing a pair in densely sampled clusters, the sequence diversity increases. But when it processes a pair in sparsely sampled ones, the sequence diversity decreases even if the pair has the smallest Hamming distance. Our implementation of NHC processes the first pair found in the dataset when there is more than one pair of sequences that have same Hamming distance. This is the cause of the fluctuation seen in the result for the NHC algorithm.</p><fig id="pone-0057684-g005" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0057684.g005</object-id><label>Figure 5</label><caption><title>Relationship between nucleotide diversity <inline-formula><inline-graphic xlink:href="pone.0057684.e069.jpg"/></inline-formula> and the fraction of discarded sequences.</title></caption><graphic xlink:href="pone.0057684.g005"/></fig></sec><sec id="s3b3"><title>Standard deviations for the number of resampled sequences in a year</title><p>We focus on the statistics of resampled sequences from 1968 to 2011. In the original dataset, the average number of sequences for one year was about 106, with a standard deviation of around 142. As described in the background section, the database had more recent sequences. This large standard deviation is due to sampling bias, because most of the sequences in the dataset were derived from viruses isolated after 1992, as the dataset contained fewer sequences before 1991. The standard deviation of the number of sequences decreases almost linearly as more sequences are discarded by all of the resampling algorithms (<xref ref-type="fig" rid="pone-0057684-g006">Figure 6</xref>). For example, when the CNT trimmed 80% of the sequences, the average number of sequences for one year was about 21, with a standard deviation of around 23. This result indicated that the kMC algorithm had the worst performance in removing densely sampled sequences from the dataset.</p><fig id="pone-0057684-g006" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0057684.g006</object-id><label>Figure 6</label><caption><title>Standard deviations for the number of resampled sequences in a year.</title><p>In each figures, the horizontal axis represents the ratio of discarded sequences. The vertical axis represents standard deviation for the number of resampled sequences in a year.</p></caption><graphic xlink:href="pone.0057684.g006"/></fig></sec></sec><sec id="s3c"><title>Evaluation of Execution Time</title><p>To evaluate the computational cost of the CNT algorithm, we measured the total execution times of the CNT, NHC, kMC, and ZAS05 algorithms (<xref ref-type="table" rid="pone-0057684-t001">Table 1</xref>). The CNT and ZAS05 methods need to construct a phylogenetic tree from the given sequence dataset before resampling. The execution time was measured using a resampling task that selected 1000 of the 4655 sequences in the dataset. The phylogenetic trees constructed from the resulting 1000 sequences showed similar shapes and topologies (<xref ref-type="supplementary-material" rid="pone.0057684.s002">Figure S2</xref>). As can be seen in <xref ref-type="table" rid="pone-0057684-t001">Table 1</xref>, the kMC algorithm was the fastest among the four algorithms. The CNT and ZAS05 algorithms take longer to process because they need to construct a phylogenetic tree before resampling.</p><table-wrap id="pone-0057684-t001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0057684.t001</object-id><label>Table 1</label><caption><title>Execution time of the four resampling algorithms against the nucleotide sequences of human H3N2 influenza virus with 1000 sequences.</title></caption><alternatives><graphic id="pone-0057684-t001-1" xlink:href="pone.0057684.t001"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1"/><td colspan="4" align="left" rowspan="1">algorithm</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">CNT</td><td align="left" rowspan="1" colspan="1">ZAS05</td><td align="left" rowspan="1" colspan="1">NHC</td><td align="left" rowspan="1" colspan="1">kMC</td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">Constructing adistance matrix</td><td align="left" rowspan="1" colspan="1">183</td><td align="left" rowspan="1" colspan="1">183</td><td align="left" rowspan="1" colspan="1">183</td><td align="left" rowspan="1" colspan="1">183</td></tr><tr><td align="left" rowspan="1" colspan="1">Constructing a tree</td><td align="left" rowspan="1" colspan="1">1072</td><td align="left" rowspan="1" colspan="1">1072</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td></tr><tr><td align="left" rowspan="1" colspan="1">Resampling</td><td align="left" rowspan="1" colspan="1">54</td><td align="left" rowspan="1" colspan="1">2011</td><td align="left" rowspan="1" colspan="1">198</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">Reconstructinga tree</td><td align="left" rowspan="1" colspan="1">16</td><td align="left" rowspan="1" colspan="1">16</td><td align="left" rowspan="1" colspan="1">16</td><td align="left" rowspan="1" colspan="1">16</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt101"><label/><p>The time units are seconds.</p></fn></table-wrap-foot></table-wrap></sec></sec><sec id="s4"><title>Discussion</title><p>Due to the large amount of genetic information accumulated in public databases, researchers have to wait a long time, when conducting analyses using whole datasets. Compact subsets of nucleotide sequences can be obtained by resampling algorithms, and the subsets could reduce the computational time needed for the analyses. Sampling bias may affect the results of computational analyses using a large number of nucleotide sequences. If we can remove the sampling bias contained in datasets, more correct analyses could be achieved than those using the original datasets. Thus we believe that the capability for reducing sampling bias is more important than execution time for resampling algorithms.</p><p>In this paper, we proposed a novel resampling algorithm&#x02013;called the closest-neighbor trimming (CNT) method&#x02013;that removes densely sampled sequences from a given dataset. We discussed the performance of our algorithm, comparing it with three other algorithms. With respect to the average maximum similarities of discarded sequences to the resampled sequences (see <xref ref-type="fig" rid="pone-0057684-g004">Figure 4</xref>), ZAS05 seems less useful for resampling from a large number of nucleotide sequences than CNT, NHC, and kMC. From the experiment on the nucleotide diversity <inline-formula><inline-graphic xlink:href="pone.0057684.e070.jpg"/></inline-formula> (see <xref ref-type="fig" rid="pone-0057684-g005">Figure 5</xref>), kMC looks less powerful than CNT and NHC. Measuring standard deviations for the number of resampled sequences in a year shows that CNT is more useful for reduction of sampling bias than NHC. In fact, <xref ref-type="fig" rid="pone-0057684-g003">Figure 3A</xref> shows that the nucleotide sequences resampled by CNT have more balanced distribution than the original ones. Therefore, we conclude that the CNT algorithm can be used for resampling nucleotide sequences in large datasets.</p><p>The dataset we used consisted of 4655 sequences of 984 nucleotides. Our method is applicable to any kind of nucleotide sequence dataset as long as the dataset can produce a reasonable phylogenetic tree.</p><p>We consider that the main reason for its superior performance is that the CNT algorithm tends to remove densely sampled new sequences and to conserve sparsely sampled old sequences. Because of the sparseness of sequences, there are more short pairs of neighbors of densely sampled new sequences than of sparsely sampled old sequences. Therefore the CNT method tends to trim newer sequences in the early steps.</p><p>It is difficult to select which of the closest neighbors to be trimmed with the CNT algorithm. In the case that no outlier sequence is included in the dataset, CNT should trim the closest neighbor with the shorter length to the parent. Moreover, CNT-further preserves the overall length of the phylogenetic tree whereas CNT-closer may shrink the tree. However, CNT-further resamples outlier sequences. This might harm the performance of the CNT-further.</p><p>One may wonder how many sequences should be discarded when analyzing a dataset. However, we have no clear answer for this question because the proper number of sequences to be discarded depends on what the user wants to do in the subsequent analyses. It might be proper to set the threshold where the nucleotide diversity <inline-formula><inline-graphic xlink:href="pone.0057684.e071.jpg"/></inline-formula> of the trimmed data is the highest.</p><p>In this paper, a dataset consisting of nucleotide sequences of human H3N2 influenza viruses was used to evaluate resampling algorithms. Through the resampling tests, we found an interesting phenomenon. When we resampled 1000 of 4655 sequences with CNT, the ratios of sequences of influenza viruses isolated from Hong Kong and China increased and those of viruses from the USA and Japan decreased (<xref ref-type="fig" rid="pone-0057684-g007">Figure 7</xref>). These results lead to two hypotheses. One is that USA and Japan had higher surveillance activities than other countries and that the sequences from these two countries were sampled more densely than for other countries. The other is that China has a large variation of influenza A viruses.</p><fig id="pone-0057684-g007" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0057684.g007</object-id><label>Figure 7</label><caption><title>Distribution of the isolation countries for 1000 sequences resampled by the CNT algorithm.</title></caption><graphic xlink:href="pone.0057684.g007"/></fig><sec id="s4a"><title>Conclusion</title><p>In this paper, we proposed a novel algorithm. The proposed method, called the closest-neighbor trimming method, thins out nucleotide sequences by trimming a phylogenetic tree. The performance of our algorithm was compared with other algorithms by using the nucleotide sequences of human H3N2 influenza viruses. We have demonstrated that the CNT algorithm can be used to remove densely sampled sequences from a given dataset, together with removing sampling bias. Since nucleotide sequences are among the most widely used material for life science, the application of our algorithm to various datasets is expected to be useful for reducing sampling bias.</p></sec></sec><sec sec-type="supplementary-material" id="s5"><title>Supporting Information</title><supplementary-material content-type="local-data" id="pone.0057684.s001"><label>Figure S1</label><caption><p>
<bold>Performances of the resampling results including the CNT-shorter and the CNT-random methods, (A) identities <inline-formula><inline-graphic xlink:href="pone.0057684.e072.jpg"/></inline-formula>, (B) nucleotide diversities <inline-formula><inline-graphic xlink:href="pone.0057684.e073.jpg"/></inline-formula>, and (C) standard deviations for the number of resampled sequences in a year.</bold> In (C), the median values are indicated by the center lines. The top and bottom edges of each box mark indicates the first and the third quatile, respectively. The whiskers extending from the box indicate the highest and lowest values.</p><p>(PPT)</p></caption><media xlink:href="pone.0057684.s001.ppt"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0057684.s002"><label>Figure S2</label><caption><p>
<bold>Phylogenetic trees with (A) the original dataset with 4655 sequences and the resampling results of (B) CNT, (C) ZAS05, (D) NHC, and (E) kMC, with 1000 sequences.</bold> All trees were drawn using Dendroscope <xref rid="pone.0057684-Huson1" ref-type="bibr">[17]</xref>.</p><p>(PPT)</p></caption><media xlink:href="pone.0057684.s002.ppt"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ref-list><title>References</title><ref id="pone.0057684-Bao1"><label>1</label><mixed-citation publication-type="journal">
<name><surname>Bao</surname><given-names>Y</given-names></name>, <name><surname>Bolotov</surname><given-names>P</given-names></name>, <name><surname>Dernovoy</surname><given-names>D</given-names></name>, <name><surname>Kiryutin</surname><given-names>B</given-names></name>, <name><surname>Zaslavsky</surname><given-names>L</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>The inuenza virus resource at the national center for biotechnology information</article-title>. <source>Journal of Virology</source>
<volume>82(2)</volume>: <fpage>596</fpage>&#x02013;<lpage>601</lpage>.<pub-id pub-id-type="pmid">17942553</pub-id></mixed-citation></ref><ref id="pone.0057684-HIV1"><label>2</label><mixed-citation publication-type="book">HIV sequence compendium 2010 (2010) Los Alamos National Laboratory, Los Alamos.</mixed-citation></ref><ref id="pone.0057684-Pevzner1"><label>3</label><mixed-citation publication-type="book">Pevzner PA (2001) Computational Molecular Biology, The MIT Press, chapter 7. 2nd edition, 123&#x02013;132.</mixed-citation></ref><ref id="pone.0057684-Saitou1"><label>4</label><mixed-citation publication-type="journal">
<name><surname>Saitou</surname><given-names>N</given-names></name>, <name><surname>Nei</surname><given-names>M</given-names></name> (<year>1987</year>) <article-title>The neighbor-joining method: A new method for reconstructing phyloge- netic trees</article-title>. <source>Molecular Biology and Evolution</source>
<volume>4(4)</volume>: <fpage>406</fpage>&#x02013;<lpage>435</lpage>.<pub-id pub-id-type="pmid">3447015</pub-id></mixed-citation></ref><ref id="pone.0057684-Altschul1"><label>5</label><mixed-citation publication-type="journal">
<name><surname>Altschul</surname><given-names>SF</given-names></name>, <name><surname>Gish</surname><given-names>W</given-names></name>, <name><surname>Miller</surname><given-names>W</given-names></name>, <name><surname>Myers</surname><given-names>EW</given-names></name>, <name><surname>Lipman</surname><given-names>DJ</given-names></name> (<year>1990</year>) <article-title>Basic local alignment search tool</article-title>. <source>Journal of Molecular Biology</source>
<volume>215(3)</volume>: <fpage>403</fpage>&#x02013;<lpage>410</lpage>.<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation></ref><ref id="pone.0057684-Zaslavsky1"><label>6</label><mixed-citation publication-type="book">Zaslavsky L, Bao Y, Tatusova TA (2008) Visualization of large inuenza virus sequence datasets using adaptively aggregated trees with sampling-based subscale representation. BMC Bioinformatics 9(237).</mixed-citation></ref><ref id="pone.0057684-Socal1"><label>7</label><mixed-citation publication-type="journal">
<name><surname>Socal</surname><given-names>RR</given-names></name>, <name><surname>Michener</surname><given-names>CD</given-names></name> (<year>1958</year>) <article-title>A statistical method for evaluating systematic relationships</article-title>. <source>University of Kansas Science Bulletin</source>
<volume>38</volume>: <fpage>1409</fpage>&#x02013;<lpage>1438</lpage>.</mixed-citation></ref><ref id="pone.0057684-Vinod1"><label>8</label><mixed-citation publication-type="journal">
<name><surname>Vinod</surname><given-names>HD</given-names></name> (<year>1969</year>) <article-title>Integer programming and the theory of grouping</article-title>. <source>Journal of the American Statistical Association</source>
<volume>64(326)</volume>: <fpage>506</fpage>&#x02013;<lpage>519</lpage>.</mixed-citation></ref><ref id="pone.0057684-Katoh1"><label>9</label><mixed-citation publication-type="journal">
<name><surname>Katoh</surname><given-names>K</given-names></name>, <name><surname>Misawa</surname><given-names>K</given-names></name>, <name><surname>Kuma</surname><given-names>K</given-names></name>, <name><surname>Miyata</surname><given-names>T</given-names></name> (<year>2002</year>) <article-title>Mafft: A novel method for rapid multiple sequence alignment based on fast Fourier transform</article-title>. <source>Nucleic Acid Research</source>
<volume>30(14)</volume>: <fpage>3059</fpage>&#x02013;<lpage>3066</lpage>.</mixed-citation></ref><ref id="pone.0057684-Ito1"><label>10</label><mixed-citation publication-type="book">Ito K, Igarashi M, Miyazaki Y, Murakami T, Iida S, et al.. (2011) Gnarled-trunk evolutionary model of inuenza a virus hemagglutinin. PLoS One 6(10).</mixed-citation></ref><ref id="pone.0057684-Felsenstein1"><label>11</label><mixed-citation publication-type="book">Felsenstein J (1993) Phylip: Phylogenetic inference package, version 3.5c.</mixed-citation></ref><ref id="pone.0057684-Jukes1"><label>12</label><mixed-citation publication-type="book">Jukes TH, Cantor CR (1969) Evolution of protein molecules, New York Academic Press. 21&#x02013;132.</mixed-citation></ref><ref id="pone.0057684-Nei1"><label>13</label><mixed-citation publication-type="journal">
<name><surname>Nei</surname><given-names>M</given-names></name>, <name><surname>Li</surname><given-names>WH</given-names></name> (<year>1979</year>) <article-title>Mathematical model for studying genetic variation in terms of restriction endonucleases</article-title>. <source>Proc Natl Acad Sci</source>
<volume>76(10)</volume>: <fpage>5269</fpage>&#x02013;<lpage>5273</lpage>.<pub-id pub-id-type="pmid">291943</pub-id></mixed-citation></ref><ref id="pone.0057684-Ferguson1"><label>14</label><mixed-citation publication-type="journal">
<name><surname>Ferguson</surname><given-names>NM</given-names></name>, <name><surname>Galvani</surname><given-names>AP</given-names></name>, <name><surname>Bush</surname><given-names>RM</given-names></name> (<year>2003</year>) <article-title>Ecological and immunological determinants of inuenza evolution</article-title>. <source>Nature</source>
<volume>422</volume>: <fpage>428</fpage>&#x02013;<lpage>433</lpage>.<pub-id pub-id-type="pmid">12660783</pub-id></mixed-citation></ref><ref id="pone.0057684-Saiki1"><label>15</label><mixed-citation publication-type="journal">
<name><surname>Saiki</surname><given-names>RK</given-names></name>, <name><surname>Gelfand</surname><given-names>DH</given-names></name>, <name><surname>Stoffel</surname><given-names>S</given-names></name>, <name><surname>Scharf</surname><given-names>SJ</given-names></name>, <name><surname>Higuchi</surname><given-names>R</given-names></name>, <etal>et al</etal> (<year>1998</year>) <article-title>Primer-directed enzymatic amplification of dna with a thermostable dna polymerase</article-title>. <source>Science</source>
<volume>239(4839)</volume>: <fpage>487</fpage>&#x02013;<lpage>491</lpage>.</mixed-citation></ref><ref id="pone.0057684-Ghedin1"><label>16</label><mixed-citation publication-type="journal">
<name><surname>Ghedin</surname><given-names>E</given-names></name>, <name><surname>Sengamalay</surname><given-names>NA</given-names></name>, <name><surname>Shumway</surname><given-names>M</given-names></name>, <name><surname>Zaborsky</surname><given-names>J</given-names></name>, <name><surname>Feldblyum</surname><given-names>T</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>Large-scale sequencing of human infuenza reveals the dynamic nature of viral genome evolution</article-title>. <source>Nature</source>
<volume>437</volume>: <fpage>1162</fpage>&#x02013;<lpage>1166</lpage>.<pub-id pub-id-type="pmid">16208317</pub-id></mixed-citation></ref><ref id="pone.0057684-Huson1"><label>17</label><mixed-citation publication-type="book">Huson DH, Richter DC, Rausch C, Dezulian T, Franz M, et al.. (2007) Dendroscope: An interactive viewer for large phylogenetic trees. BMC Bioinformatics, 8(460).</mixed-citation></ref></ref-list></back></article>