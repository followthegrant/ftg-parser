<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Sci Rep</journal-id><journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id><journal-title-group><journal-title>Scientific Reports</journal-title></journal-title-group><issn pub-type="epub">2045-2322</issn><publisher><publisher-name>Nature Publishing Group</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">25387525</article-id><article-id pub-id-type="pmc">4230738</article-id><article-id pub-id-type="pii">srep06874</article-id><article-id pub-id-type="doi">10.1038/srep06874</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Further Improvements to Linear Mixed Models for Genome-Wide Association
Studies</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Widmer</surname><given-names>Christian</given-names></name><xref ref-type="corresp" rid="c1">a</xref><xref ref-type="aff" rid="a1">1</xref><xref ref-type="author-notes" rid="n1">*</xref></contrib><contrib contrib-type="author"><name><surname>Lippert</surname><given-names>Christoph</given-names></name><xref ref-type="corresp" rid="c2">b</xref><xref ref-type="aff" rid="a1">1</xref><xref ref-type="author-notes" rid="n1">*</xref></contrib><contrib contrib-type="author"><name><surname>Weissbrod</surname><given-names>Omer</given-names></name><xref ref-type="aff" rid="a2">2</xref></contrib><contrib contrib-type="author"><name><surname>Fusi</surname><given-names>Nicolo</given-names></name><xref ref-type="aff" rid="a1">1</xref></contrib><contrib contrib-type="author"><name><surname>Kadie</surname><given-names>Carl</given-names></name><xref ref-type="aff" rid="a3">3</xref></contrib><contrib contrib-type="author"><name><surname>Davidson</surname><given-names>Robert</given-names></name><xref ref-type="aff" rid="a3">3</xref></contrib><contrib contrib-type="author"><name><surname>Listgarten</surname><given-names>Jennifer</given-names></name><xref ref-type="aff" rid="a1">1</xref></contrib><contrib contrib-type="author"><name><surname>Heckerman</surname><given-names>David</given-names></name><xref ref-type="corresp" rid="c3">c</xref><xref ref-type="aff" rid="a1">1</xref><xref ref-type="author-notes" rid="n1">*</xref></contrib><aff id="a1"><label>1</label><institution>eScience Group, Microsoft Research</institution>, 1100 Glendon Avenue, Suite
PH1, Los Angeles, CA, 90024, <country>United States</country></aff><aff id="a2"><label>2</label><institution>Computer Science Department, Technion - Israel Institute of
Technology</institution>, Haifa 32000, <country>Israel</country></aff><aff id="a3"><label>3</label><institution>eScience Group, Microsoft Research</institution>, One Microsoft Way, Redmond,
WA, 98052, <country>United States</country></aff></contrib-group><author-notes><corresp id="c1"><label>a</label>
<email>chwidmer@microsoft.com</email>
</corresp><corresp id="c2"><label>b</label>
<email>lippert@microsoft.com</email>
</corresp><corresp id="c3"><label>c</label>
<email>heckerma@microsoft.com</email>
</corresp><fn id="n1"><label>*</label><p>These authors contributed equally to this work.</p></fn></author-notes><pub-date pub-type="epub"><day>12</day><month>11</month><year>2014</year></pub-date><pub-date pub-type="collection"><year>2014</year></pub-date><volume>4</volume><elocation-id>6874</elocation-id><history><date date-type="received"><day>09</day><month>08</month><year>2013</year></date><date date-type="accepted"><day>14</day><month>10</month><year>2014</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2014, Macmillan Publishers Limited. All rights reserved</copyright-statement><copyright-year>2014</copyright-year><copyright-holder>Macmillan Publishers Limited. All rights reserved</copyright-holder><license xmlns:xlink="http://www.w3.org/1999/xlink" license-type="open-access" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><!--author-paid--><license-p>This work is licensed under a Creative Commons
Attribution-NonCommercial-NoDerivs 4.0 International License. The images or other third
party material in this article are included in the article's Creative Commons license,
unless indicated otherwise in the credit line; if the material is not included under the
Creative Commons license, users will need to obtain permission from the license holder in
order to reproduce the material. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/">http://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link></license-p></license></permissions><abstract><p>We examine improvements to the linear mixed model (LMM) that better correct for population
structure and family relatedness in genome-wide association studies (GWAS). LMMs rely on the
estimation of a genetic similarity matrix (GSM), which encodes the pairwise similarity
between every two individuals in a cohort. These similarities are estimated from single
nucleotide polymorphisms (SNPs) or other genetic variants. Traditionally, all available SNPs
are used to estimate the GSM. In empirical studies across a wide range of synthetic and real
data, we find that modifications to this approach improve GWAS performance as measured by
type I error control and power. Specifically, when only population structure is present, a
GSM constructed from SNPs that well predict the phenotype in combination with principal
components as covariates controls type I error and yields more power than the traditional
LMM. In any setting, with or without population structure or family relatedness, a GSM
consisting of a mixture of two component GSMs, one constructed from all SNPs and another
constructed from SNPs that well predict the phenotype again controls type I error and yields
more power than the traditional LMM. Software implementing these improvements and the
experimental comparisons are available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://microsoft.com/science">http://microsoft.com/science</ext-link>.</p></abstract></article-meta></front><body><p>There has been a great deal of interest in statistical methods for genome-wide association
studies (GWAS). While linear or logistic regression have been commonly used for this task, the
need to move beyond these models has become clear. One important motivation for more
sophisticated models is the existence of confounding structure, including population structure
and family relatedness. Recently, the linear mixed model (LMM) has emerged as the model of
choice to correct for such confounding structure<xref ref-type="bibr" rid="b1">1</xref><xref ref-type="bibr" rid="b2">2</xref><xref ref-type="bibr" rid="b3">3</xref><xref ref-type="bibr" rid="b4">4</xref><xref ref-type="bibr" rid="b5">5</xref><xref ref-type="bibr" rid="b6">6</xref><xref ref-type="bibr" rid="b7">7</xref><xref ref-type="bibr" rid="b8">8</xref><xref ref-type="bibr" rid="b9">9</xref>.
Despite its rapid acceptance, however, there remain concerns about its use, and several
improvements have been proposed.</p><p>One suggested improvement is the inclusion of principal components (PCs) as covariates to
better capture population structure<xref ref-type="bibr" rid="b8">8</xref>. Another proposed improvement is to use
only a subset of single nucleotide polymorphisms (SNPs) for inclusion in the LMM<xref ref-type="bibr" rid="b4">4</xref><xref ref-type="bibr" rid="b5">5</xref><xref ref-type="bibr" rid="b6">6</xref><xref ref-type="bibr" rid="b7">7</xref><xref ref-type="bibr" rid="b10">10</xref>. In particular, the LMM relies on an estimate of the genetic
similarity matrix (GSM), which encodes the pairwise similarity between every two individuals
in the data set. These similarities are estimated from SNPs or other genetic variants. While
traditionally all available SNPs are used to estimate the GSM, researchers have considered
using a subset, chosen in at least two different ways.</p><p>In one approach, SNPs are chosen such that they are roughly equally spaced across the
genome<xref ref-type="bibr" rid="b4">4</xref>. The idea behind this approach is that linkage disequilibrium (LD)
among the SNPs mitigates the need to use all of them. One motivation underlying this approach
is computational efficiency. Namely, when the number of selected SNPs is less than the sample
size of the data, then the computation of <italic>P</italic> values becomes linear in sample size,
rather than quadratic<xref ref-type="bibr" rid="b4">4</xref>. We shall refer this to form of subsetting as LD
sampling.</p><p>A second approach to subsetting is based on a mathematical equivalence between the LMM and
linear regression<xref ref-type="bibr" rid="b4">4</xref><xref ref-type="bibr" rid="b7">7</xref><xref ref-type="bibr" rid="b11">11</xref>. Specifically, an LMM is equivalent to a form of
linear regression in which the SNPs that determine the GSM in the LMM view are covariates in
the linear-regression view. The linear-regression view suggests including in the GSM only
those covariates that are correlated to the phenotype<xref ref-type="bibr" rid="b5">5</xref><xref ref-type="bibr" rid="b7">7</xref>. The inclusion of
causal or tagging SNPs could improve GWAS power by reducing the model misspecification that
would otherwise result from their exclusion. Inclusion of SNPs that tag confounding structure
could help correct for confounding by effectively using these SNPs as covariates<xref ref-type="bibr" rid="b5">5</xref><xref ref-type="bibr" rid="b10">10</xref>. Perhaps most importantly, omitting irrelevant SNPs, which introduce noise,
could amplify these benefits<xref ref-type="bibr" rid="b7">7</xref>. We refer to this form of subsetting as SNP
selection. A second motivation for SNP selection is the potential for computational efficiency
as just mentioned for LD sampling. We note that, despite these motivations, there has been
debate about its usefulness<xref ref-type="bibr" rid="b12">12</xref>.</p><p>Here, we thoroughly investigate these potential improvements under conditions spanning a wide
range of population structure and family structure. In our experiments, we also consider how
the distribution of effect sizes affects the usefulness of these improvements. Although we
offer some theoretical insights, this work is primarily empirical. For these empirical
investigations, we employ three types of data sets: synthetic SNPs with synthetic phenotypes,
real SNPs with synthetic phenotypes, and real SNPs with real phenotypes.</p><p>We concentrate our investigations on real-valued phenotypes and data that are randomly
ascertained. While an LMM can often be successfully applied to binary phenotypes (e.g.,
containing cases and controls)<xref ref-type="bibr" rid="b3">3</xref><xref ref-type="bibr" rid="b13">13</xref><xref ref-type="bibr" rid="b14">14</xref>, in preliminary studies not presented
here, we find that our results generally do not extend to situations with substantial
ascertainment bias.</p><p>In our experiments, we first generate a suite of data sets having various degrees of
confounding structure and distributions of effect sizes. Next, we apply each of the models
under investigation as described in <xref ref-type="table" rid="t1">Table 1</xref> to each of the data sets,
performing GWAS (computing SNP-phenotype association <italic>P</italic> values) for each combination of
model and data set. Finally, we evaluate empirical type I error rate and power for each model
based on the <italic>P</italic> values obtained over the suite of datasets.</p><p><xref ref-type="table" rid="t1">Table 1</xref> summarizes the main results. Selection on its own did not
live up to its promise. In the presence of population structure, family relatedness, or both,
selected SNPs did not sufficiently correct for confounding in that the resulting model failed
to control for type I error. Interestingly, however, when combined with a second fixed or
random effect, we found that the use of SNP selection controls for type I error and increases
power. Specifically, when only population structure was present, using selection in
combination with PCs included as (fixed-effect) covariates, yielded more power than the
traditional LMM. When family structure was present (with or without population structure), SNP
selection was again useful, but only when used with a new improvement&#x02014;namely, a mixture of two
GSMs, one constructed from all SNPs and another constructed from SNPs identified by selection.
This GSM-mixture model both controlled type I error well and yielded more power than the
traditional LMM. This model also performed well when no confounding structure was present and
when only population structure was present.</p><p>Another notable finding was that the improvements to power afforded by SNP selection
manifested most strongly when the number of causal SNPs was low and they had large effect
sizes. Finally, on data with real SNPs (where LD was present), we found that replacing a GSM
based on all SNPs with one based on LD sampling improved run time without degradation in type
I error or power.</p><sec disp-level="1" sec-type="results"><title>Results</title><p>We evaluated various GWAS models across three broad sets of experiments: those involving
synthetic SNPs and synthetic phenotypes, those involving real SNPs and synthetic phenotypes,
and those involving real SNPs and real phenotypes. As noted in the introduction, we focused
on data that were randomly ascertained. Also, we concentrated on genome-wide association
analyses that test for associations between a single SNP and a phenotype, although the
methods we considered should also be applicable to a variety of association tests, such as
those between sets of SNPs and a phenotype<xref ref-type="bibr" rid="b15">15</xref>. Herein, we use the term GWAS to
refer to univariate association analyses only.</p><sec disp-level="2"><title>Synthetic SNPs and phenotypes</title><p>We generated synthetic SNPs and phenotypes under four settings: no population structure
or family relatedness, population structure only, family relatedness only, and both
population structure and family relatedness. We generated each data set with <italic>M</italic> =
50,000 SNPs and <italic>N</italic> = 4,000 individuals, typical of many GWASs. (Note that ref.
<xref ref-type="bibr" rid="b12">12</xref> suggests that there are effectively 60,000 independent
SNPs in the human genome.) We generated SNPs such that there was no physical linkage to
avoid any confusion about the identity of true causal SNPs. In our data generation, we
varied the degree of population structure, family structure, number of causal SNPs and
signal strength over a wide range of plausible parameters, including ones yielding strong
confounding from population structure and family relatedness, so as to challenge and
thereby uncover weaknesses of the various models examined. Results varied depending on the
presence of population structure and on the presence of family relatedness, so we consider
the four possible cases separately.</p><sec disp-level="3"><title>No population or family relatedness</title><p>For each data set, we generated SNPs with a minor allele frequency (MAF) sampled
uniformly from the range [0.05, 0.5]. For each individual, a continuous phenotype was
then constructed by generating causal and noise components, and summing them. The causal
component was generated from a linear model with a varying number of causal SNPs
<italic>C</italic>. The causal SNPs were normalized to have mean zero and variance one, and the
effect sizes were drawn identically and independently from a Gaussian distribution with
mean zero and variance <inline-formula id="m2"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e284" xlink:href="srep06874-m2.jpg"/></inline-formula>. The independent noise component was generated independently and identically
from a Gaussian distribution with mean zero and variance <inline-formula id="m3"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e287" xlink:href="srep06874-m3.jpg"/></inline-formula>.</p><p>Parameter values used in our simulations were as follows:<list id="l1" list-type="bullet"><list-item><p>Number of causal SNPs: 10, 50, 100, 500, 1000 </p></list-item><list-item><p>Narrow-sense
heritability (causal signal) <inline-formula id="m4"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e297" xlink:href="srep06874-m4.jpg"/></inline-formula>: 0.1, 0.2, 0.3, 0.4, 0.5, 0.6 </p></list-item></list></p><p>Three data sets for each possible combination of parameters were generated, yielding 3
&#x000d7; 5 &#x000d7; 6 = 90 data sets. Note that different random seeds were used to generate each set
of SNPs so that no two sets were the same.</p><p>We used these datasets to measure empirical type I error rate and power for three
models: linear regression (Linreg), an LMM with a GSM based on all SNPs (LMM(all)), and
an LMM with a GSM based on SNP selection (LMM(select)). See Methods for a detailed
description of the LMM model. As motivated in the introduction by the correspondence
between an LMM and regression, SNPs were selected so as to maximize prediction accuracy
on the phenotype. In particular, SNPs were identified by searching over multiple sets of
SNPs to identify those that maximized out-of-sample prediction accuracy as measured by
the log likelihood of the phenotype under the LMM. To keep the search practical, we
ordered SNPs for each fold by their increasing univariate linear-regression <italic>P</italic>
values, and then considered increasing numbers of SNPs in this order (see Methods for
details). This approach is known as marginal regression<xref ref-type="bibr" rid="b16">16</xref>. The
computational complexity of the algorithm is
<italic>O</italic>(<italic>N</italic><sup>2</sup><italic>M</italic>).</p><p>For each of the three models, we measured empirical type I error rate (the proportion
of non-causal SNPs deemed significant) as a function of <italic>P</italic>-value threshold. In
addition, we measured empirical power (the proportion of causal SNPs deemed significant)
as a function of empirical type I error (<xref ref-type="fig" rid="f1">Figure 1</xref>; note that a
fourth method shown in the figure, LMM(all + select), will be introduced in the
following section). Results are shown for different numbers of causal SNPs. All models
controlled type I error well. Furthermore, LMM(select) yielded the most power,
especially when the number of causal SNPs was small (and thus the effect sizes were
large). That LMM(select) had more power than Linreg is not surprising when thinking
about the LMM as linear regression with selected SNPs as covariates. Namely,
conditioning on selected SNPs reduces noise in the phenotype. That LMM(select) had more
power than LMM(all) when there were few causal SNPs is also expected, as presumably the
use of all SNPs in the GSM obfuscated the true causal signal, a phenomenon called
&#x0201c;dilution&#x0201d;<xref ref-type="bibr" rid="b7">7</xref>.</p><p>One interesting finding was that SNP selection would select all SNPs in many data sets
when only a relatively small number of the SNPs in the generating data were causal
(<xref ref-type="fig" rid="f2">Figure 2</xref>). One explanation is that, as the number of causal
SNPs increases for a fixed narrow-sense heritability, the signal in each SNP decreases.
Therefore, even for a relatively small number of causal SNPs (<italic>e.g.</italic>, less than
1000), the SNP selection algorithms may not be able to detect the signal at the
individual-SNP level, thus finding all SNPs to be optimal. (See ref. <xref ref-type="bibr" rid="b17">17</xref> for a theoretical discussion.) Indeed, when we used 1000 causal SNPs and
increased narrow-sense heritability beyond 0.4, less than all SNPs (in fact, less than
1000) were selected.</p></sec><sec disp-level="3"><title>Population structure but no family relatedness</title><p>To introduce population structure, all SNPs were generated from the Balding-Nichols
model<xref ref-type="bibr" rid="b18">18</xref> with a 50:50 population ratio, a baseline MAF sampled uniformly
from [0.05, 0.5], and a value for Wright's <italic>F<sub>ST</sub></italic> that varied across the
generated data sets. The data was otherwise generated as described for the previous
setting of no population structure.</p><p>Parameter values used in these simulations were as follows:<list id="l2" list-type="bullet"><list-item><p>Number of causal SNPs: 10, 50, 100, 500, 1000 </p></list-item><list-item><p>Narrow-sense
heritability <inline-formula id="m5"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e359" xlink:href="srep06874-m5.jpg"/></inline-formula>:
0.1, 0.2, 0.3, 0.4, 0.5, 0.6 </p></list-item><list-item><p>Degree of population structure
<italic>F<sub>ST</sub></italic>: 0.005, 0.01, 0.05, and 0.1 </p></list-item></list></p><p>Three data sets for each possible combination of parameters were generated, yielding 3
&#x000d7; 5 &#x000d7; 6 &#x000d7; 4 = 360 data sets. As under the previous setting of no population structure
and no family relatedness, different random seeds were used to generate each set of SNPs
so that no two sets were the same.</p><p>For each of the three models considered previously (Linreg, LMM(all), LMM(select)), we
examined exclusion and inclusion of PCs as fixed-effect covariates. In <xref ref-type="supplementary-material" rid="s1">Supplemental Material</xref>, we compared two methods for estimating PCs. In one
approach, PC estimation was guided by the accuracy of phenotype prediction, similar to
the approach of refs. <xref ref-type="bibr" rid="b19">19</xref>,<xref ref-type="bibr" rid="b20">20</xref>,<xref ref-type="bibr" rid="b21">21</xref> for estimating PCs for linear and
logistic regression. In the second approach, PC estimation was guided by the prediction
accuracy of PCs on SNPs rather than the phenotype, based on a Probabilistic Principal
Components (PPC) model<xref ref-type="bibr" rid="b22">22</xref>. This second approach yielded better control of
type I error and power, and herein we concentrate on only this approach. The algorithm,
described in Methods, has a computational complexity
<italic>O</italic>(<italic>N</italic><sup>2</sup><italic>M</italic>) in the simple case where all <italic>N</italic> PCs
are computed.</p><p>The inclusion of PCs had differing effects on the performance of the models (<xref ref-type="supplementary-material" rid="s1">Supplementary Figure 1</xref>). LMM(all) controlled type I error well, whether
or not PCs were included as fixed effects, and inclusion did not affect power. In
contrast, for Linreg, inclusion of PCs led to control of type I error, consistent with
the results in ref. <xref ref-type="bibr" rid="b23">23</xref>, and had little effect on power.
Furthermore, the inclusion of PCs led to control of type I error and improved power for
LMM(select), as was recently reported in an independent investigation<xref ref-type="bibr" rid="b24">24</xref>.</p><p>One way to understand these results is through consideration of the graphical-model
structure<xref ref-type="bibr" rid="b25">25</xref> for our data-generation process (<xref ref-type="fig" rid="f3">Figure
3a</xref>). Here, <italic>l</italic> is a hidden (latent) variable denoting which of the two
Balding-Nichols populations the individual is in, <italic>y</italic> is the phenotype, and
<italic>c</italic> and <italic>s</italic> with subscripts denote the causal and non-causal SNPs,
respectively. The graphical-model structure conveys assertions of conditional
independence among the variables represented. For example, when <italic>l</italic> is unobserved,
there are open paths between the SNP variables, reflecting induced correlation among the
SNPs. In contrast, if <italic>l</italic> were observed, these paths would be closed, reflecting
the lack of correlation among SNPs within each population. Ref. <xref ref-type="bibr" rid="b25">25</xref> describes generally how to determine correlations from the graph based
on what is and is not observed.</p><p>The graph offers a simple explanation for the inflation of <italic>P</italic> values
(<italic>i.e.</italic>, the lack of type I control) when using Linreg. In particular, because
<italic>l</italic> is unobserved, there are open paths in the graph from the non-causal SNPs to
<italic>y</italic>, indicating a correlation between the non-causal SNPs and <italic>y</italic>. The graph
also offers two possible explanations for why LMM(all) without PCs leads to good control
of type I error. One is that, as described in the introduction, the use of LMM(all) is
equivalent to a form of linear regression where all SNPs condition the phenotype. By
conditioning on all the SNPs and thus the causal ones, we block all paths from <italic>l</italic>
to <italic>y</italic>, again making the non-causal SNPs and y independent. The other is that a GSM
based on all SNPs may accurately represent the latent variable <italic>l</italic>, again blocking
the paths from non-causal SNPs to <italic>y</italic>. Later in this section, we will see evidence
that at least the second explanation holds true. The graph also explains results for
LMM(select). Namely, the SNP selection algorithm presumably failed to select some of the
causal SNPs, resulting in paths from the non-causal SNPs to <italic>y</italic>. To validate this
hypothesis, we estimated a GSM from only the true causal SNPs (those generating the
phenotype), observing no inflation (<xref ref-type="supplementary-material" rid="s1">Supplemental Figure 2</xref>). In
addition, when PCs were included with LMM(select), they accurately represented the
latent variable (see <xref ref-type="supplementary-material" rid="s1">Supplemental Material</xref>), thus blocking the paths
from non-causal SNPs to y and yielding control of type I error.</p><p>Similar to what we observed in the case of no population or family relatedness, SNP
selection selected fewer than all SNPs in most data sets only when there were a few
causal SNPs with large effect size (<xref ref-type="fig" rid="f2">Figure 2</xref>). Furthermore, in
these situations, LMM(select) with PCs yielded more power than LMM(all) (<xref ref-type="supplementary-material" rid="s1">Supplemental Figure 2</xref>).</p><p>So far, our simulations have assumed that confounding has resulted only from
differences in SNP allele frequencies between populations. In practice, however, there
may be additional confounding effects due to correlations between the Balding-Nichols
populations (represented by <italic>l</italic> in <xref ref-type="fig" rid="f3">Figure 3</xref>) and the
phenotype. For example, environmental effects may differ between the two populations. To
investigate such additional confounding effects, we simulated data as before, but now
added a direct correlation between <italic>l</italic> and <italic>y</italic> as shown in <xref ref-type="fig" rid="f3">Figure 3b</xref> (see Methods). To do so, we first generated 100 additional SNPs in
the same way as the other SNPs except with a fixed <italic>F<sub>ST</sub></italic> of 0.2. We then
used these 100 SNPs to generate a component added to the phenotype with variance <inline-formula id="m6"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e511" xlink:href="srep06874-m6.jpg"/></inline-formula>, such that <inline-formula id="m7"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e514" xlink:href="srep06874-m7.jpg"/></inline-formula>. These SNPs were used
only in the generation of the phenotype. They were excluded from the GWAS analysis.</p><p>Consistent with results just presented, we found that the use of PCs led to good
control of type I error. In addition, we found that use of a GSM based on all SNPs led
to good control (<xref ref-type="supplementary-material" rid="s1">Supplemental Figure 3</xref>). This observation indicates
that a GSM based on all SNPs can accurately represent (<italic>i.e.</italic>, block paths through)
the hidden variable <italic>l</italic>.</p><p>In summary, on purely synthetic data with population structure but no family
relatedness, we found that LMM(select) yielded better GWAS performance than LMM(all),
but only when PCs were used as covariates.</p></sec><sec disp-level="3"><title>Family relatedness but no population structure</title><p>We generated data as described for the first setting of no confounding structure,
except that we created family relatedness by mating randomly selected synthetic
individuals, producing 10 offspring per parent pair. The fraction of offspring in the
population was varied across the generated data sets so as to yield a degree of
inflation for Linreg similar to that in the population-structure setting. In a single
mating, the genotype of the child was constructed by selecting one copy of the genotype
from the mother and one copy from the father. Matings were performed in two passes,
creating equal numbers of offspring in each pass. In the first pass, each mother and
father pair was selected from the same population. In the second pass, each pair was
selected randomly from the existing set of individuals, possibly from different
populations.</p><p>Parameter values used in these simulations were as follows:<list id="l3" list-type="bullet"><list-item><p>Number of causal SNPs: 10, 50, 100, 500, 1000 </p></list-item><list-item><p>Narrow-sense
heritability <inline-formula id="m8"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e543" xlink:href="srep06874-m8.jpg"/></inline-formula>:
0.1, 0.2, 0.3, 0.4, 0.5, 0.6 </p></list-item><list-item><p>Degree of family relatedness; fraction of
individuals belonging to a family: 0.5, 0.6, 0.7, 0.8, 0.9 </p></list-item></list></p><p>Three data sets for each possible combination of parameters were generated, yielding 3
&#x000d7; 5 &#x000d7; 6 &#x000d7; 5 = 450 data sets. Again, different random seeds were used to generate each
set of SNPs so that no two sets were the same.</p><p>Under this setting, we evaluated Linreg + PCs, LMM(all), and LMM(select) + PCs. Linreg
+ PCs and LMM(select) + PCs failed to control type I error, in contrast to the setting
with population structure, whereas LMM(all) controlled type I error (<xref ref-type="fig" rid="f4">Figure 4</xref> and <xref ref-type="supplementary-material" rid="s1">Supplementary Figure 4</xref>). Again, we can
understand these results in terms of the graphical-model structure for the
data-generation process, which is that of <xref ref-type="fig" rid="f3">Figure 3a</xref> where now the
hidden variable corresponds to family relatedness. In terms of this graph, inflation
observed for Linreg + PCs (also seen in Ref. <xref ref-type="bibr" rid="b8">8</xref>) indicates
that the use of PCs as fixed effects failed to block the paths through <italic>l</italic> from
non-causal SNPs to <italic>y</italic>. Similarly, inflation observed for LMM(select) + PCs
indicates that neither PCs as fixed effects nor selected SNPs blocked the paths through
<italic>l</italic>. Only LMM(all) blocked all paths from the non-causal SNPs to <italic>y</italic>, either
by conditioning on all SNPs, having a GSM that fully captures family relatedness
<italic>l</italic>, or both. Later in this section, we will see evidence supporting at least the
second explanation.</p><p>Turning to power, we found that LMM(select) performed best (<xref ref-type="supplementary-material" rid="s1">Supplementary
Figure 4</xref>). Thus, interestingly, no model performed best in terms of both type I
control and power. Based on this observation, we developed a new LMM model having a GSM
made up of a mixture of two GSMs ((1 &#x02212; &#x003c0;) <bold>K</bold><sub>0</sub> + &#x003c0;
<bold>K</bold><sub>1</sub>), one based on all SNPs (<bold>K</bold><sub>0</sub>) and one based on SNP
selection (<bold>K</bold><sub>1</sub>). Methods provides a detailed description of the
algorithm for creating this model, called LMM(all + select).</p><p>Because we included a mixture component based on all SNPs, the algorithm considered
only a relatively small number of SNPs for the selected component. Nonetheless, because
one of the components was based on all SNPs, the computational complexity of this
algorithm was the same as that of LMM(select):
<italic>O</italic>(<italic>N</italic><sup>2</sup><italic>M</italic>). Note that this model is closely related to
those in refs. <xref ref-type="bibr" rid="b26">26</xref>,<xref ref-type="bibr" rid="b27">27</xref>, and is
also related to the model of ref. <xref ref-type="bibr" rid="b10">10</xref> who added SNPs as
fixed effects identified with forward-backward selection conditioned on a GSM estimated
from all SNPs.</p><p>This new model yielded the benefits of both a GSM based on selected SNPs and one based
on all SNPs. It controlled type I error and had power equal to that of an LMM with
selected SNPs (<xref ref-type="fig" rid="f4">Figure 4</xref> and <xref ref-type="supplementary-material" rid="s1">Supplementary Figure
4</xref>). As before, the power advantage was greater when a relatively small number of
the SNPs in the generated data were causal. The model also performed well in the
settings of no confounding structure and population structure only (<xref ref-type="fig" rid="f1">Figures 1</xref> and <xref ref-type="fig" rid="f4">4</xref>, and <xref ref-type="supplementary-material" rid="s1">Supplemental Figure
2</xref>).</p><p>Interestingly, the number of SNPs selected first increased and then decreased with the
number of causal SNPs (<xref ref-type="fig" rid="f2">Figure 2</xref>). Presumably, the decrease was due
to the fact that one of the components of the mixture GSM is based on all SNPs and that
this component can well represent larger numbers of causal SNPs with smaller effect
size, as we have seen under the previous settings of confounding structure. This
explanation is consistent with the mixing weights <italic>&#x003c0;</italic> estimated for the mixture GSM
(<xref ref-type="fig" rid="f2">Figure 2</xref>). Namely, when there were a small number of causal
SNPs with large effect size, the estimated mixing weight was high, favouring the GSM
based on SNP selection. When there were a large number of causal SNPs with small effect
sizes, the estimated mixing weight was low, favoring the GSM based on all SNPs.</p><p>As before, we explored additional confounding due to family relatedness, corresponding
to a direct arc from <italic>l</italic> to <italic>y</italic> in <xref ref-type="fig" rid="f3">Figure 3b</xref>. Such
confounding could result from, for example, family-related environmental effects. To
create this additional confounding structure, we first generated 100 additional SNPs
subject to the same family relatedness as the other SNPs, and then used these 100 SNPs
to generate a component added to the phenotype with variance <inline-formula id="m9"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e667" xlink:href="srep06874-m9.jpg"/></inline-formula>, such that <inline-formula id="m10"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e670" xlink:href="srep06874-m10.jpg"/></inline-formula>.</p><p>Linreg and LMM(select) failed to control type I error due to the open paths from
non-causal SNPs to <italic>y</italic>. In contrast, LMM(all) and LMM(all + select) controlled type
I error (<xref ref-type="supplementary-material" rid="s1">Supplementary Figure 5</xref>), indicating that a GSM based on all
SNPs is capable of blocking the paths through <italic>l</italic>&#x02014;that is, a GSM based on all SNPs
is capable of capturing family relatedness.</p></sec><sec disp-level="3"><title>Population structure and family relatedness</title><p>We generated data as described for the setting of population structure and no family
relatedness, except we added family relatedness by mating randomly selected individuals
as described in the previous section. Parameter values used in these simulations were as
follows:<list id="l4" list-type="bullet"><list-item><p>Number of causal SNPs: 10, 50, 100, 500, 1000
</p></list-item><list-item><p>Narrow-sense heritability <inline-formula id="m11"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e694" xlink:href="srep06874-m11.jpg"/></inline-formula>: 0.1, 0.2, 0.3, 0.4, 0.5, 0.6 </p></list-item><list-item><p>Degree of
population structure; <italic>F<sub>ST</sub></italic>: 0.005, 0.01, 0.05, and 0.1
</p></list-item><list-item><p>Degree of family relatedness; fraction of individuals belonging to a
family: 0.5, 0.6, 0.7, 0.8, 0.9 </p></list-item></list></p><p>Three data sets for each possible combination of parameters was generated, yielding 3 &#x000d7;
5 &#x000d7; 6 &#x000d7; 4 &#x000d7; 5 = 1800 data sets. Again, no two sets of SNPs were the same.</p><p>Using this data, we examined four models: Linreg + PCs, LMM(all), LMM(select) + PCs,
and LMM(all + select). The model LMM(all + select), which performed best for the setting
of family relatedness without population structure, also performed best here (<xref ref-type="fig" rid="f4">Figure 4</xref> and <xref ref-type="supplementary-material" rid="s1">Supplementary Figure 6</xref>). These
results indicate that the inclusion of all SNPs as part of the mixture GSM led to good
control of type I error for both forms of confounding structure, consistent with our
findings for family relatedness alone and population structure alone. Furthermore, the
inclusion of selected SNPs as part of the mixture GSM led to improved power, again most
notably so when there were a small number of causal SNPs with large effect size (<xref ref-type="supplementary-material" rid="s1">Supplementary Figure 6</xref>). Finally, as we saw for the setting of family
structure alone, the number of SNPs selected first increased and then decreased with the
number of causal SNPs (<xref ref-type="fig" rid="f2">Figure 2</xref>).</p></sec></sec><sec disp-level="2"><title>Real SNPs and synthetic phenotypes</title><p>We next compared models using data sets based on real SNPs and synthetic phenotypes. We
used real SNPs to determine whether our results on synthetic SNPs would hold under more
realistic conditions, including those where SNPs were in LD. We continued to use synthetic
phenotypes to maintain a gold standard as to which SNPs were causal.</p><p>We used real SNPs from three cohorts, two from human studies&#x02014;the Northern Finnish Birth
Cohort from 1966 (Finnish) and CIDR Visceral Adiposity Study (VAS)&#x02014;and one from a mouse
cross (Mouse) (see Methods). These data contain various degrees of population structure
and family relatedness. From a hierarchical clustering performed on each of these three
data sets (<xref ref-type="fig" rid="f5">Figure 5</xref>), we see that Finnish contains little population
structure or family relatedness, VAS contains mostly population structure as illustrated
by the broad bands of similarity, and the mouse data contains both forms of confounding
structure as illustrated by the combination of broad and narrow bands. We generated the
phenotype in essentially the same manner as for purely synthetic data sets, always using
<italic>h</italic><sup>2</sup> = 0.5.</p><p>To understand our strategy for measuring empirical type I error rate and power, it is
useful to first understand an effect that can lead to loss in power. When computing an
association <italic>P</italic> value for a given SNP, that SNP and SNPs nearby from the GSM should
not be included<xref ref-type="bibr" rid="b4">4</xref><xref ref-type="bibr" rid="b5">5</xref><xref ref-type="bibr" rid="b14">14</xref>. If these SNPs are included, then (as follows from
the linear-regression view of the LMM) they effectively become covariates in the test and
reduce power. This effect is called proximal contamination<xref ref-type="bibr" rid="b4">4</xref><xref ref-type="bibr" rid="b5">5</xref>. In the
experiments with synthetic SNPs, which contained no LD due to recombination, it was
sufficient to exclude only the single SNP tested from the GSM in order to avoid proximal
contamination. We did so using the method in ref. <xref ref-type="bibr" rid="b5">5</xref>. In the
experiments with real SNPs in LD, we could have used a similar approach and excluded SNPs
from the GSM that were close to the SNP being tested. However, this approach was somewhat
computationally expensive. Thus, instead we excluded from the GSM all SNPs on the
chromosomes being tested, as has been described previously<xref ref-type="bibr" rid="b4">4</xref><xref ref-type="bibr" rid="b5">5</xref><xref ref-type="bibr" rid="b12">12</xref>.
Specifically, we measured type I error rate with SNPs from chromosome 1 and power with
SNPs from chromosome 2, after first sampling causal SNPs from all but chromosome 1 and
constructing the GSM with SNPs from all but chromosomes 1 and 2 (repeating this procedure
multiple times to obtain good estimates). One potential problem with this approach is that
leaving out chromosome 2 from the GSM when measuring type I error rate on chromosome 1
would lead to open paths from the non-causal SNPs on chromosome 1 to the phenotype
(through causal SNPs on chromosome 2). These exclusions could then result in inflated
<italic>P</italic> values due not to a poor model, but rather to this expedient approach of
avoiding proximal contamination. We will examine this potential problem in more detail
after considering the main results of the analysis, but for purposes of evaluating the
various models, we avoided this problem by making sure that no causal SNPs were on
chromosome 2 when evaluating type I error rate on chromosome 1.</p><p>We applied the models Linreg, Linreg + PCs, LMM(select), LMM(select) + PCs, LMM(all), and
LMM(all + select) to each of these data sets, yielding results that were consistent with
our findings on the purely synthetic data. In particular, for the Finnish SNPs, which had
little population structure or family relatedness, all models controlled type I error, and
models using SNP selection had more power than models that did not (<xref ref-type="fig" rid="f6">Figure
6</xref> and <xref ref-type="supplementary-material" rid="s1">Supplementary Figure 7</xref>). For the VAS SNPs, which
contained mostly population structure, all models except Linreg and LMM(select) controlled
type I error, and again models using SNP selection had more power than models that did not
(<xref ref-type="fig" rid="f6">Figure 6</xref> and <xref ref-type="supplementary-material" rid="s1">Supplementary Figure 8</xref>). For the
Mouse SNPs, which exhibited both forms of confounding structure, only LMM(all) and LMM(all
+ select) controlled type I error, and LMM(all + select) had the most power, presumably
because it was the only model that both used SNP selection and controlled type I error
(<xref ref-type="fig" rid="f6">Figure 6</xref> and <xref ref-type="supplementary-material" rid="s1">Supplementary Figure 9</xref>).</p><p>Returning to the potential problem of leaving out one chromosome to avoid proximal
contamination, we investigated this problem by repeating our experiments on Mouse data but
now allowing causal SNPs to be sampled from chromosome 2 when evaluating type I error rate
on chromosome 1. The result was that the leave-out-one-chromosome approach did indeed lead
to inflated <italic>P</italic> values (<xref ref-type="supplementary-material" rid="s1">Supplementary Figure 10</xref>). Consequently,
although we were able to avoid the bad effects of leaving out one chromosome in our
synthetic experiments, we recommend that, in practice, the method only be used when
avoiding proximal contamination with a small window around the tested SNP is not
computationally feasible.</p><p>Finally, LD among the SNPs in this data allowed us to investigate the usefulness of
replacing a GSM estimated from all SNPs with one estimated after LD sampling, as first
suggested in ref. <xref ref-type="bibr" rid="b4">4</xref>. We did so for the Mouse SNPs, where we
had found a GSM based on all SNPs to be most needed for control of type I error. A sample
of only one fourth of the available 10,000 SNPs yielded good control of type I error
(<xref ref-type="fig" rid="f7">Figure 7</xref>), suggesting that, at least for this SNP data, LD
sampling can be an effective approach to improving the run time of GWAS.</p></sec><sec disp-level="2"><title>Real SNPs and phenotypes</title><p>We applied our models to fully real data to check for consistency with our findings on
synthetic data. In general, evaluation of real data is difficult, because the gold
standard (<italic>i.e.</italic>, the identity of the causal SNPs) is unknown. Nonetheless, some real
data sets have a bronze standard&#x02014;a validated collection of causal SNPs or SNPs that tag
causal ones&#x02014;making a partially informative analysis possible, with the limitation that the
list of validated SNPs is incomplete. In this work, we analysed the Finnish data set with
phenotypes low density lipoprotein (LDL), high density lipoprotein (HDL), and
triglycerides (Trig), and the VAS data set with phenotype BMI. The causal SNPs and
associated loci for the bronze standard were obtained from the NHGRI GWAS catalog
(<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.genome.gov/gwastudies">http://www.genome.gov/gwastudies</ext-link>). We examined four models: Linreg,
LMM(select) + PCs, LMM(all), and LMM(all + select).</p><p>To get a sense of type I error rate, we counted apparent false positive loci. A locus was
considered a false positive if it contained a below threshold SNP more than two million
bases away from any catalog SNP. To get a sense of power, we counted the number of loci
deemed to be true positives. A locus was considered a true positive if it was in the
catalog and contained a below threshold SNP. There were no significant differences (<xref ref-type="supplementary-material" rid="s1">Supplementary Table 1</xref>). For the VAS data set, LMM(select) + PCs selected
all SNPs. This observation is consistent with our results from synthetic data, as the BMI
phenotype is thought to have many causal SNPs. For the Finnish data set, all methods
yielded zero false positives at thresholds of 5 &#x000d7; 10<sup>&#x02212;7</sup> and 5 &#x000d7;
10<sup>&#x02212;8</sup>, consistent with our understanding that the Finnish data has little
population structure or family relatedness.</p></sec></sec><sec disp-level="1" sec-type="discussion"><title>Discussion</title><p>Traditionally, when an LMM is used for GWAS, its GSM is estimated from all available SNPs.
In this work, we have evaluated potential improvements to this approach on a broad set of
data, both synthetic and real.</p><p>One potential improvement, building a GSM based on selected SNPs that well predict the
phenotype failed rather dramatically. In particular, when population structure, family
relatedness, or both were present, this approach failed to control for type I error.
Presumably, SNPs sufficient for good prediction are not sufficient for good GWAS
performance. These results are in contrast to our previous findings<xref ref-type="bibr" rid="b7">7</xref>, which
used less realistic simulations. Nonetheless, when SNP selection was used in combination
with other improvements, it proved useful. Specifically, in the presence of population
structure alone, SNP selection in combination with PCs used as covariates controlled type I
error and also yielded more power than the traditional approach. In all settings, with or
without population structure or family relatedness, a mixture of two GSMs, one constructed
from all SNPs and another constructed from SNPs identified by SNP selection both controlled
type I error and yielded more power than the traditional LMM. Furthermore, the improvements
to power afforded by SNP selection were the strongest when some SNPs had a large effect
size.</p><p>Of course, when analyzing real data, there will be uncertainty about the distribution of
effect sizes and about how much population structure and family relatedness are present.
Consequently, we recommend using the mixture GSM when feasible. One drawback of this
approach is computational expense: run time is <italic>O</italic>(<italic>N</italic><sup>2</sup><italic>M</italic>),
where <italic>N</italic> and <italic>M</italic> are the sample size and number of tested SNPs, respectively. One
observation that could mitigate this problem is that the GSM component based on all
available SNPs can be replaced with one based on a set of SNPs sampled across the genome (LD
sampling). Depending on the degree of LD among the SNPs, a subject for further
investigation, the sample could in principle be small enough such that the number of sampled
SNPs <italic>k</italic> would be less than <italic>N</italic>, yielding a <italic>O</italic>(<italic>NMk</italic>) computational
complexity<xref ref-type="bibr" rid="b4">4</xref>. A second benefit implied by the potential effectiveness of LD
sampling is that the measurement of a large number of SNPs (e.g., whole-genome sequencing)
would be unnecessary for building the GSM.</p><p>Another way to improve run time would be to remove closely related individuals (if any)
from the analysis and then employ LMM(select) + PCs. This approach has several drawbacks.
First, there would be a loss in power due to the removal of individuals. Also, inflation
could remain due to distant family relatedness (cryptic relatedness). In addition, the
approach may not work well in a setting where population structure deviates from the
idealized Balding-Nichols structure employed in our investigations. Finally, although its
run time is less than GSM-mixture approach, its computation complexity is no better:
<italic>O</italic>(<italic>N</italic><sup>2</sup><italic>M</italic>).</p><p>We also found that avoiding proximal contamination by excluding SNPs from the GSM that are
in the same chromosome as the SNP being tested can lead to inflated <italic>P</italic> values. When
feasible, we recommend excluding SNPs in a small window around the SNP being tested. Ref.
<xref ref-type="bibr" rid="b5">5</xref> provides a relatively efficient algorithm for doing so.</p><p>Interestingly, we found that a GSM based on all SNPs (or LD-sampled SNPs) could account for
population structure just as well as PCs. Consequently, if SNP selection picks all SNPs,
then there is no need to add PCs to the LMM. We note that ref. <xref ref-type="bibr" rid="b8">8</xref>
showed that adding PCs could be beneficial, but only in rare situations where some SNPs are
unusually differentiated.</p><p>Our experiments suggest that good GWAS performance across multiple settings requires two
model components: a component based on all (or LD sampled) SNPs to control type I error, and
a component based on selected SNPs to improve power. These two components are random effects
in our mixture GSM, but ref. <xref ref-type="bibr" rid="b10">10</xref> has had success with a model
wherein one component is a GSM based on all SNPs and the other component is a set of
fixed-effect SNPs identified by forward-backward selection. (The use of a fixed-effect
component rather than a random-effect component should be particularly useful when the
number of SNPs with large effect size is very small.) Other approaches for creating
two-component models including alternative methods for selecting SNPs (<italic>e.g.</italic>, refs.
<xref ref-type="bibr" rid="b28">28</xref>,<xref ref-type="bibr" rid="b29">29</xref>,<xref ref-type="bibr" rid="b30">30</xref>), seem worthy of investigation.</p><p>Finally, we emphasize that our empirical investigations covered only randomly ascertained
data. Initial investigations suggest that many of our conclusions do not apply when there is
strong ascertainment bias as can be found in case-control studies<xref ref-type="bibr" rid="b12">12</xref>.
Identifying improvements for the ascertained case is a subject for further
investigation.</p><p>Software implementing the traditional LMM and the improvements discussed here as well as
the simulations and evaluations are available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://microsoft.com/science">http://microsoft.com/science</ext-link>.</p></sec><sec disp-level="1" sec-type="methods"><title>Methods</title><sec disp-level="2"><title>Description of real data</title><p>The Finnish data comes from the NFBC1966 Study<xref ref-type="bibr" rid="b31">31</xref> and was pre-processed as
described in ref. <xref ref-type="bibr" rid="b32">32</xref>, yielding 328,517 SNPs for 5,256
individuals. No covariates were used, as they were regressed out during pre-processing.
The VAS data (dbGap phs000169.v1.p1) was filtered with individual missingness &#x0003c; 0.1,
MAF &#x0003e; 0.05, SNP missingness &#x0003c; 0.1, and Hardy-Weinberg disequilibrium <italic>P</italic> values
&#x0003e; 0.00001, yielding 720,036 SNPs for 2,802 individuals. The real BMI phenotype was
analyzed with age, gender, race, site, smoking amount, drinking amount, and education as
covariates. The Mouse data and its pre-processing is described in ref. <xref ref-type="bibr" rid="b33">33</xref> yielding 10,150 SNPs for 1,940 individuals.</p></sec><sec disp-level="2"><title>The linear mixed model</title><p>An LMM decomposes the variance associated with phenotype <bold><italic>y</italic></bold> into the sum of
a linear additive genetic and residual component. The distribution of <bold><italic>y</italic></bold> is
given by <disp-formula id="m1"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e940" xlink:href="srep06874-m1.jpg"/></disp-formula>where <bold><italic>X</italic></bold> is the <italic>N</italic> &#x000d7; <italic>Q</italic> matrix of <italic>&#x0039d;</italic> individuals
and <italic>Q</italic> covariates (<italic>e.g.</italic>, gender, age) including an offset term,
<bold><italic>&#x003b2;</italic></bold> is the <italic>Q</italic> &#x000d7; 1 vector of fixed effects, <bold><italic>I</italic></bold> is the
<italic>N</italic> &#x000d7; <italic>N</italic> identity matrix, <bold><italic>K</italic></bold> is the GSM of size <italic>N</italic> &#x000d7;
<italic>N</italic> (determined from a set of SNPs), <inline-formula id="m12"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e992" xlink:href="srep06874-m12.jpg"/></inline-formula> is the variance of the genetic component, and <inline-formula id="m13"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e995" xlink:href="srep06874-m13.jpg"/></inline-formula> is the variance
residual component.</p><p>As discussed in the main text, the LMM model (<xref ref-type="disp-formula" rid="m1">equation 1</xref>) is
equivalent to a form of linear regression. In particular, consider the phenotype as a
linear regression of SNPs <bold><italic>Z</italic></bold> (<italic>N</italic> &#x000d7; <italic>S</italic>) on phenotype, with
mutually independent effect sizes <bold><italic>&#x003b1;</italic></bold> distributed <inline-formula id="m14"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1018" xlink:href="srep06874-m14.jpg"/></inline-formula>. Assuming the values for each SNP are
standardized, the log likelihood can be written as <disp-formula id="m15"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1021" xlink:href="srep06874-m15.jpg"/></disp-formula>Identifying <inline-formula id="m16"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1024" xlink:href="srep06874-m16.jpg"/></inline-formula>, we recover <xref ref-type="disp-formula" rid="m1">equation
(1)</xref>. Note that, when <inline-formula id="m17"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1030" xlink:href="srep06874-m17.jpg"/></inline-formula>, <bold><italic>K</italic></bold> is called the realized relationship matrix
(RRM)<xref ref-type="bibr" rid="b34">34</xref>. The RRM is commonly used in genetic studies<xref ref-type="bibr" rid="b11">11</xref> and
we do so here. For a detailed discussion of the LMM, see ref. <xref ref-type="bibr" rid="b35">35</xref>.</p><p>As discussed, we concentrated on genome-wide association analyses that test for
associations between a single SNP and a phenotype. When using the LMM to compute a
<italic>P</italic> value for the association between a test SNP and the phenotype, we used an
F-test where parameters were estimated using restricted maximum likelihood (REML). The
value for <inline-formula id="m18"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e1050" xlink:href="srep06874-m18.jpg"/></inline-formula> estimated
for the null model was also applied to the alternative models<xref ref-type="bibr" rid="b3">3</xref><xref ref-type="bibr" rid="b36">36</xref>. We
assumed an additive effect of a SNP on the phenotype. In particular, the value of a SNP
for a given individual was encoded as the number of minor alleles of the SNP for that
individual (0, 1 or 2).</p></sec><sec disp-level="2"><title>Description of algorithms</title><p>The algorithm for SNP selection was as follows:<list id="l5" list-type="order"><list-item><p>Create
random train-test partitions of the data samples (corresponding to individuals).
</p></list-item><list-item><p>For each partition <list id="l6" list-type="alpha-lower"><list-item><p>Use the training data to
compute univariate linear-regression <italic>P</italic> values on each SNP. </p></list-item><list-item><p>Order
the SNPs by increasing <italic>P</italic> value. </p></list-item><list-item><p>For numSNPs in {0, 1, 2, 4, &#x02026;,
1024, all} (the default values), use the first numSNPs as features for the LMM:
<list id="l7" list-type="roman-lower"><list-item><p>Optimize the parameters of the LMM using REML.
</p></list-item><list-item><p>Use the LMM to compute the predictive log likelihood of the test data
(the log joint probability density of the test data given the training data).
</p></list-item></list>
</p></list-item></list>
</p></list-item><list-item><p>Choose the value of numSNPs that maximizes the sum over the partitions of the
predictive log likelihood of the test data. </p></list-item></list></p><p>In step 1, we use a 90%&#x02013;10% train-test partition of the data with enough partitions such
that there are 10,000 samples in the test sets overall. In practice, this number of
samples leads to the selection of a similar number of SNPs for different random seeds.
This default applies to the other method that uses random train-test partitions as well.
The most time consuming step in the algorithm is the evaluation of the predictive log
likelihood when all SNPs are used in step 2c. The computational complexity of this step is
<italic>O</italic>(<italic>N</italic><sup>2</sup><italic>M</italic>). In the experiments with synthetic SNPs and
phenotypes, we used the search grid {0, 1, 5, 10, 20, 50, 100, 500, 1000, 2000, 5000,
10000, all} in step 2c. In the experiments with real SNPs and synthetic phenotypes, we
used the search grid {0, 1, 3, 10, 32, 101, 322, 1024, all}. In the experiments with real
data, we used the default values above.</p><p>The algorithm for estimating PCs was a follows:<list id="l9" list-type="order"><list-item><p>Remove
individuals that are closely related. Our default removes individuals until no two
individuals have an estimated kinship coefficient from a GSM computed from all
genome-wide variants of less than 0.1. </p></list-item><list-item><p>One dimension of the matrix of SNPs
indexes multivariate samples, while the other indexes variables of the samples. To
avoid problems due to the high dimensionality of the SNPs of each individual, treat
the SNPs as samples and the individuals as variables. </p></list-item><list-item><p>Partition the samples
into subsamples for cross-validation. Partition SNPs across chromosomes to reduce
correlation between the partitions. When evaluating prediction accuracy for a given
subsample, the subsample is used for testing, while the other subsamples are used for
training. Each train-and-test constitutes a <italic>fold</italic>. </p></list-item><list-item><p>For numPCs = 0 <list id="l10" list-type="alpha-lower"><list-item><p>For each fold <list id="l11" list-type="roman-lower"><list-item><p>Use the
training data to compute maximum likelihood estimates for a PPC model.
</p></list-item><list-item><p>Compute the log likelihood of the test data according to this model.
</p></list-item></list>
</p></list-item></list>
</p></list-item><list-item><p>Repeat step 4 with increasing numPCs until either (1) the sum over the folds of
log likelihood decreases twice in a row or (2) this sum first increases and the
decreases below the starting value. </p></list-item><list-item><p>Select the PPC model that maximizes the
sum over the folds of the log likelihood. </p></list-item><list-item><p>Project the individuals who were
removed in step 1 onto the subspace defined by the optimal PPCA model (see <xref ref-type="supplementary-material" rid="s1">Supplementary Material</xref>). </p></list-item></list></p><p>The algorithm for creating LMM(all + select) was as follows:<list id="l13" list-type="order"><list-item><p>Create random train-test partitions of the individuals. </p></list-item><list-item><p>For each
partition<list id="l" list-type="alpha-lower"><list-item><p>Use the training data to compute <italic>P</italic>
values on each SNP based on an LMM with a GSM using all SNPs.</p></list-item><list-item><p>Order the
SNPs by increasing <italic>P</italic> value.</p></list-item><list-item><p>For numSNPs in {0, 1, 2, 4, &#x02026;, 128}
(the default values), use the first numSNPs as features for the LMM: <list id="l15" list-type="roman-lower"><list-item><p>Optimize the parameters of the LMM including the
mixing weight <italic>&#x003c0;</italic> by REML. </p></list-item><list-item><p>Use the LMM to compute the predictive
log likelihood of the test data (the log probability density of the test data
given the training data). </p></list-item></list>
</p></list-item></list>
</p></list-item><list-item><p>Choose the value of numSNPs that maximizes the sum over the partitions of the
predictive log likelihood of the test data. </p></list-item></list></p><p>Because we included a mixture component based on all SNPs, the algorithm considered only
a relatively small number of SNPs for the select component (see step 2c).</p></sec></sec><sec disp-level="1"><title>Author Contributions</title><p>C.W. designed research, conducted experiments, contributed analytic tools, analyzed data,
and wrote the paper. C.L. designed research, conducted experiments, contributed analytic
tools, analyzed data, and wrote the paper. O.W. designed research, conducted experiments,
analyzed data, and wrote the paper. N.F. designed research and wrote the paper. C.K. and
R.D. contributed analytic tools. J.L. designed research, contributed analytic tools, and
wrote the paper. D.H. designed research, conducted experiments, contributed analytic tools,
analyzed data, and wrote the paper. All authors reviewed the manuscript.</p></sec><sec sec-type="supplementary-material" id="s1"><title>Supplementary Material</title><supplementary-material id="d33e47" content-type="local-data"><caption><title>Supplementary Information</title><p>Supplementary Information</p></caption><media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep06874-s1.pdf"/></supplementary-material></sec></body><back><ack><p>We thank Alkes Price and Noah Zaitlen for useful discussions. The NFBC1966 Study is
conducted and supported by the National Heart, Lung, and Blood Institute (NHLBI) in
collaboration with the Broad Institute, UCLA, University of Oulu, and the National Institute
for Health and Welfare in Finland. This manuscript was not prepared in collaboration with
investigators of the NFBC1966 Study and does not necessarily reflect the opinions or views
of the NFBC1966 Study Investigators, Broad Institute, UCLA, University of Oulu, National
Institute for Health and Welfare in Finland, or the NHLBI. Funding support for the CIDR
Visceral Adiposity Study was provided through the Division of Aging Biology and the Division
of Geriatrics and Clinical Gerontology, NIA. The CIDR Visceral Adiposity Study includes a
genome-wide association study funded as part of the Division of Aging Biology and the
Division of Geriatrics and Clinical Gerontology, NIA. Assistance with phenotype
harmonization and genotype cleaning as well as with general study coordination was provided
by Heath ABC Study Investigators.</p></ack><ref-list><ref id="b1"><mixed-citation publication-type="journal"><name><surname>Yu</surname><given-names>J.</given-names></name>
<italic>et al.</italic>
<article-title>A unified mixed-model method for association mapping that accounts for
multiple levels of relatedness</article-title>. <source>Nat. Genet.</source>
<volume>38</volume>, <fpage>203</fpage>&#x02013;<lpage>8</lpage> (<year>2006</year>).<pub-id pub-id-type="pmid">16380716</pub-id></mixed-citation></ref><ref id="b2"><mixed-citation publication-type="journal"><name><surname>Kang</surname><given-names>H. M.</given-names></name>
<italic>et al.</italic>
<article-title>Efficient control of population structure in model organism
association mapping</article-title>. <source>Genetics</source>
<volume>178</volume>, <fpage>1709</fpage>&#x02013;<lpage>23</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18385116</pub-id></mixed-citation></ref><ref id="b3"><mixed-citation publication-type="journal"><name><surname>Kang</surname><given-names>H. M.</given-names></name>
<italic>et al.</italic>
<article-title>Variance component model to account for sample structure in
genome-wide association studies</article-title>. <source>Nat. Genet.</source>
<volume>42</volume>, <fpage>348</fpage>&#x02013;<lpage>54</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20208533</pub-id></mixed-citation></ref><ref id="b4"><mixed-citation publication-type="journal"><name><surname>Lippert</surname><given-names>C.</given-names></name>
<italic>et al.</italic>
<article-title>FaST linear mixed models for genome-wide association studies</article-title>.
<source>Nat. Methods</source>
<volume>8</volume>, <fpage>833</fpage>&#x02013;<lpage>5</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21892150</pub-id></mixed-citation></ref><ref id="b5"><mixed-citation publication-type="journal"><name><surname>Listgarten</surname><given-names>J.</given-names></name>
<italic>et al.</italic>
<article-title>Improved linear mixed models for genome-wide association
studies</article-title>. <source>Nat. Methods</source>
<volume>9</volume>, <fpage>525</fpage>&#x02013;<lpage>6</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22669648</pub-id></mixed-citation></ref><ref id="b6"><mixed-citation publication-type="journal"><name><surname>Listgarten</surname><given-names>J.</given-names></name>, <name><surname>Lippert</surname><given-names>C.</given-names></name> &#x00026; <name><surname>Heckerman</surname><given-names>D.</given-names></name>
<article-title>FaST-LMM-Select for addressing confounding from spatial structure and
rare variants</article-title>. <source>Nat. Genet.</source>
<volume>45</volume>, <fpage>470</fpage>&#x02013;<lpage>1</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23619783</pub-id></mixed-citation></ref><ref id="b7"><mixed-citation publication-type="journal"><name><surname>Lippert</surname><given-names>C.</given-names></name>
<italic>et al.</italic>
<article-title>The benefits of selecting phenotype-specific variants for applications
of mixed models in genomics</article-title>. <source>Sci. Rep.</source>
<volume>3</volume>, <fpage>1815</fpage>; 10.1038/srep01815 (<year>2013</year>).<pub-id pub-id-type="pmid">23657357</pub-id></mixed-citation></ref><ref id="b8"><mixed-citation publication-type="journal"><name><surname>Price</surname><given-names>A.</given-names></name>, <name><surname>Zaitlen</surname><given-names>N.</given-names></name>, <name><surname>Reich</surname><given-names>D.</given-names></name> &#x00026;
<name><surname>Patterson</surname><given-names>N.</given-names></name>
<article-title>New approaches to population stratification in genome-wide association
studies</article-title>. <source>Nat. Rev. Genet.</source>
<volume>11</volume>, <fpage>459</fpage>&#x02013;<lpage>63</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20548291</pub-id></mixed-citation></ref><ref id="b9"><mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>X.</given-names></name> &#x00026; <name><surname>Stephens</surname><given-names>M.</given-names></name>
<article-title>Genome-wide efficient mixed-model analysis for association
studies</article-title>. <source>Nat. Genet.</source>
<volume>44</volume>, <fpage>821</fpage>&#x02013;<lpage>4</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22706312</pub-id></mixed-citation></ref><ref id="b10"><mixed-citation publication-type="journal"><name><surname>Segura</surname><given-names>V.</given-names></name>
<italic>et al.</italic>
<article-title>An efficient multi-locus mixed-model approach for genome-wide
association studies in structured populations</article-title>. <source>Nat. Genet.</source>
<volume>44</volume>, <fpage>825</fpage>&#x02013;<lpage>30</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22706313</pub-id></mixed-citation></ref><ref id="b11"><mixed-citation publication-type="journal"><name><surname>Hayes</surname><given-names>B. J.</given-names></name>, <name><surname>Visscher</surname><given-names>P. M.</given-names></name> &#x00026; <name><surname>Goddard</surname><given-names>M. E.</given-names></name>
<article-title>Increased accuracy of artificial selection by using the realized
relationship matrix</article-title>. <source>Genet. Res. (Camb).</source>
<volume>91</volume>, <fpage>47</fpage>&#x02013;<lpage>60</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19220931</pub-id></mixed-citation></ref><ref id="b12"><mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>J.</given-names></name>, <name><surname>Zaitlen</surname><given-names>N.
A.</given-names></name>, <name><surname>Goddard</surname><given-names>M. E.</given-names></name>,
<name><surname>Visscher</surname><given-names>P. M.</given-names></name> &#x00026; <name><surname>Price</surname><given-names>A. L.</given-names></name>
<article-title>Advantages and pitfalls in the application of mixed-model association
methods</article-title>. <source>Nat. Genet.</source>
<volume>46</volume>, <fpage>100</fpage>&#x02013;<lpage>6</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">24473328</pub-id></mixed-citation></ref><ref id="b13"><mixed-citation publication-type="book"><name><surname>Agresti</surname><given-names>A.</given-names></name>
<source>Categorical Data Analysis</source>. (Wiley, <year>2002</year>).</mixed-citation></ref><ref id="b14"><mixed-citation publication-type="journal"><name><surname>Sawcer</surname><given-names>S.</given-names></name>
<italic>et al.</italic>
<article-title>Genetic risk and a primary role for cell-mediated immune mechanisms in
multiple sclerosis</article-title>. <source>Nature</source>
<volume>476</volume>, <fpage>214</fpage>&#x02013;<lpage>219</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21833088</pub-id></mixed-citation></ref><ref id="b15"><mixed-citation publication-type="journal"><name><surname>Listgarten</surname><given-names>J.</given-names></name>
<italic>et al.</italic>
<article-title>A powerful and efficient set test for genetic markers that handles
confounders</article-title>. <source>Bioinformatics</source>
<volume>29</volume>, <fpage>1526</fpage>&#x02013;<lpage>33</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23599503</pub-id></mixed-citation></ref><ref id="b16"><mixed-citation publication-type="journal"><name><surname>Genovese</surname><given-names>C.</given-names></name> &#x00026; <name><surname>Wasserman</surname><given-names>L.</given-names></name>
<source>A Comparison of the Lasso and Marginal Regression. J. Mach. Learn. Res</source>.
<volume>13</volume>, <fpage>2107</fpage>&#x02013;<lpage>2143</lpage> (<year>2011</year>).</mixed-citation></ref><ref id="b17"><mixed-citation publication-type="journal"><name><surname>Helmbold</surname><given-names>D.</given-names></name> &#x00026; <name><surname>Long</surname><given-names>P.</given-names></name>
<article-title>On the Necessity of Irrelevant Variables</article-title>. <source>J. Mach. Learn.
Res.</source>
<volume>13</volume>, <fpage>2145</fpage>&#x02013;<lpage>2170</lpage> (<year>2012</year>).</mixed-citation></ref><ref id="b18"><mixed-citation publication-type="journal"><name><surname>Balding</surname><given-names>D. J.</given-names></name> &#x00026; <name><surname>Nichols</surname><given-names>R. A.</given-names></name>
<article-title>A method for quantifying differentiation between populations at
multi-allelic loci and its implications for investigating identity and paternity</article-title>.
<source>Genetica</source>
<volume>96</volume>, <fpage>3</fpage>&#x02013;<lpage>12</lpage> (<year>1995</year>).<pub-id pub-id-type="pmid">7607457</pub-id></mixed-citation></ref><ref id="b19"><mixed-citation publication-type="journal"><name><surname>Novembre</surname><given-names>J.</given-names></name> &#x00026; <name><surname>Stephens</surname><given-names>M.</given-names></name>
<article-title>Interpreting principal component analyses of spatial population
genetic variation</article-title>. <source>Nat. Genet.</source>
<volume>40</volume>, <fpage>646</fpage>&#x02013;<lpage>9</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18425127</pub-id></mixed-citation></ref><ref id="b20"><mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>S.</given-names></name>, <name><surname>Wright</surname><given-names>F.
A.</given-names></name> &#x00026; <name><surname>F.</surname><given-names>Z.</given-names></name>
<article-title>Control of population stratification by correlation-selected principal
components</article-title>. <source>Biometrics</source>
<volume>67</volume>, <fpage>967</fpage>&#x02013;<lpage>974</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21133882</pub-id></mixed-citation></ref><ref id="b21"><mixed-citation publication-type="journal"><name><surname>Hoffman</surname><given-names>G. E.</given-names></name>
<article-title>Correcting for population structure and kinship using the linear mixed
model: theory and extensions</article-title>. <source>PLoS One</source>
<volume>8</volume>, <fpage>e75707</fpage> (<year>2013</year>).<pub-id pub-id-type="pmid">24204578</pub-id></mixed-citation></ref><ref id="b22"><mixed-citation publication-type="journal"><name><surname>Tipping</surname><given-names>M. E.</given-names></name> &#x00026; <name><surname>Bishop</surname><given-names>C. M.</given-names></name>
<article-title>Probabilistic Principal Component Analysis</article-title>. <source>Analysis</source>
<fpage>1</fpage>&#x02013;<lpage>13</lpage> (<year>1999</year>).</mixed-citation></ref><ref id="b23"><mixed-citation publication-type="journal"><name><surname>Price</surname><given-names>A. L.</given-names></name>
<italic>et al.</italic>
<article-title>Principal components analysis corrects for stratification in
genome-wide association studies</article-title>. <source>Nat. Genet.</source>
<volume>38</volume>, <fpage>904</fpage>&#x02013;<lpage>9</lpage> (<year>2006</year>).<pub-id pub-id-type="pmid">16862161</pub-id></mixed-citation></ref><ref id="b24"><mixed-citation publication-type="journal"><name><surname>Tucker</surname><given-names>G.</given-names></name>, <name><surname>Price</surname><given-names>A.
L.</given-names></name> &#x00026; <name><surname>Berger</surname><given-names>B.</given-names></name>
<article-title>Improving the Power of GWAS and Avoiding Confounding from Population
Stratification with PC-Select</article-title>. <source>Genetics</source>
<volume>197</volume>, <fpage>1045</fpage>&#x02013;<lpage>1049</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">24788602</pub-id></mixed-citation></ref><ref id="b25"><mixed-citation publication-type="book"><name><surname>Pearl</surname><given-names>J.</given-names></name>
<source>Probabilistic Reasoning in Intelligent Systems: Networks of Plausible
Inference</source>. (Morgan Kaufmann, <year>1988</year>).</mixed-citation></ref><ref id="b26"><mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>X.</given-names></name>, <name><surname>Carbonetto</surname><given-names>P.</given-names></name> &#x00026; <name><surname>Stephens</surname><given-names>M.</given-names></name>
<source>Polygenic Modeling with Bayesian Sparse Linear Mixed Models. PLoS Genet</source>.
<volume>9</volume> (<year>2013</year>).</mixed-citation></ref><ref id="b27"><mixed-citation publication-type="journal"><name><surname>Speed</surname><given-names>D.</given-names></name> &#x00026; <name><surname>Balding</surname><given-names>D. J.</given-names></name>
<article-title>MultiBLUP: improved SNP-based prediction for complex traits</article-title>.
<source>Genome Res.</source> (<year>2014</year>).</mixed-citation></ref><ref id="b28"><mixed-citation publication-type="journal"><name><surname>Hoggart</surname><given-names>C. J.</given-names></name>, <name><surname>Whittaker</surname><given-names>J. C.</given-names></name>, <name><surname>De Iorio</surname><given-names>M.</given-names></name> &#x00026;
<name><surname>Balding</surname><given-names>D. J.</given-names></name>
<article-title>Simultaneous analysis of all SNPs in genome-wide and re-sequencing
association studies</article-title>. <source>PLoS Genet.</source>
<volume>4</volume>, <fpage>e1000130</fpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18654633</pub-id></mixed-citation></ref><ref id="b29"><mixed-citation publication-type="journal"><name><surname>Rakitsch</surname><given-names>B.</given-names></name>, <name><surname>Lippert</surname><given-names>C.</given-names></name>, <name><surname>Stegle</surname><given-names>O.</given-names></name> &#x00026;
<name><surname>Borgwardt</surname><given-names>K.</given-names></name>
<article-title>A Lasso multi-marker mixed model for association mapping with
population structure correction</article-title>. <source>Bioinformatics</source>
<volume>29</volume>, <fpage>206</fpage>&#x02013;<lpage>214</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23175758</pub-id></mixed-citation></ref><ref id="b30"><mixed-citation publication-type="journal"><name><surname>Dolejsi</surname><given-names>E.</given-names></name>, <name><surname>Bodenstorfer</surname><given-names>B.</given-names></name> &#x00026; <name><surname>Frommlet</surname><given-names>F.</given-names></name>
<article-title>Analyzing genome-wide association studies with an FDR controlling
modification of the Bayesian Information Criterion</article-title>. <source>PLoS One</source>
<volume>9</volume>, <fpage>e103322</fpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25061809</pub-id></mixed-citation></ref><ref id="b31"><mixed-citation publication-type="journal"><name><surname>Sabatti</surname><given-names>C.</given-names></name>
<italic>et al.</italic>
<article-title>Genome-wide association analysis of metabolic traits in a birth cohort
from a founder population</article-title>. <source>Nat. Genet.</source>
<volume>41</volume>, <fpage>35</fpage>&#x02013;<lpage>46</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19060910</pub-id></mixed-citation></ref><ref id="b32"><mixed-citation publication-type="other"><name><surname>Fusi</surname><given-names>N.</given-names></name>, <name><surname>Lippert</surname><given-names>C.</given-names></name>, <name><surname>Lawrence</surname><given-names>N. D.</given-names></name> &#x00026;
<name><surname>Stegle</surname><given-names>O.</given-names></name>
<article-title>Genetic Analysis of Transformed Phenotypes</article-title>. <italic>arXiv</italic> (<year>2014</year>).</mixed-citation></ref><ref id="b33"><mixed-citation publication-type="journal"><name><surname>Valdar</surname><given-names>W.</given-names></name>
<italic>et al.</italic>
<article-title>Genetic and environmental effects on complex traits in mice</article-title>.
<source>Genetics</source>
<volume>174</volume>, <fpage>959</fpage>&#x02013;<lpage>84</lpage> (<year>2006</year>).<pub-id pub-id-type="pmid">16888333</pub-id></mixed-citation></ref><ref id="b34"><mixed-citation publication-type="journal"><name><surname>Hayes</surname><given-names>B. J.</given-names></name>, <name><surname>Visscher</surname><given-names>P. M.</given-names></name> &#x00026; <name><surname>Goddard</surname><given-names>M. E.</given-names></name>
<article-title>Increased accuracy of artificial selection by using the realized
relationship matrix</article-title>. <source>Genet. Res. (Camb).</source>
<volume>91</volume>, <fpage>47</fpage>&#x02013;<lpage>60</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19220931</pub-id></mixed-citation></ref><ref id="b35"><mixed-citation publication-type="journal"><name><surname>Lippert</surname><given-names>C.</given-names></name>
<source>Linear mixed models for genome-wide association studies. Ph.D. Diss. Tuebingen</source>
(<year>2013</year>).</mixed-citation></ref><ref id="b36"><mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Z.</given-names></name>
<italic>et al.</italic>
<article-title>Mixed linear model approach adapted for genome-wide association
studies</article-title>. <source>Nat. Genet.</source>
<volume>42</volume>, <fpage>355</fpage>&#x02013;<lpage>60</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20208535</pub-id></mixed-citation></ref></ref-list><fn-group><fn fn-type="conflict"><p>C.W., C.L., N.F., C.K., R.D., J.L., and D.H. were employed by Microsoft while
performing this work.</p></fn></fn-group></back><floats-group><fig id="f1"><label>Figure 1</label><caption><title>Empirical type I error rate and power for no population or family relatedness with
purely synthetic data.</title><p>Type I error rate is plotted as a function of <italic>P</italic> value cutoff <italic>&#x003b1;</italic>. Each
point represents the average type I error rate or power across 18 data sets with
different degrees of signal (narrow-sense heritability). Shading on the curves for type
I error rate represent the 95% confidence interval assuming type I error is controlled.
All power curves that are visibly separated have significant differences between them.
For example, comparing power for Linreg and LMM(all) for 10 causal SNPs at a type I
error of 10<sup>&#x02212;3</sup>, the <italic>P</italic> value from a two-sided binomial test applied
to the number of true positives is 0.03.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep06874-f1"/></fig><fig id="f2"><label>Figure 2</label><caption><title>Box plots showing number of SNPs selected and mixing weight as a function of the
number of causal SNPs with purely synthetic data.</title><p>The first column shows log<sub>10</sub> of the number of SNPs selected by LMM(select).
The highest point corresponds to the selection of all SNPs. The second and third columns
show the number of selected SNPs and mixing weights for LMM(all + select). A mixing
weight of 1 corresponds to using a GSM based only on SNP selection. A mixing weight of 0
corresponds to using a GSM based only on all SNPs.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep06874-f2"/></fig><fig id="f3"><label>Figure 3</label><caption><title>Graphical models for the data-generation process.</title><p>The variable <italic>l</italic> is hidden (latent) and corresponds to confounding structure,
either population structure of family relatedness. The variables <italic>c</italic> and <italic>s</italic>
with subscripts correspond to causal and non-causal SNPs, respectively.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep06874-f3"/></fig><fig id="f4"><label>Figure 4</label><caption><title>Empirical type I error rate and power with and without population structure (PS) and
family relatedness (FR) with purely synthetic data.</title><p>Type I error rate is plotted as a function of P value cutoff <italic>&#x003b1;</italic>. Each point
represents the average type I error rate or power across multiple data sets with varying
numbers of causal SNPs and varying degrees of heritability, population structure, and
family relatedness.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep06874-f4"/></fig><fig id="f5"><label>Figure 5</label><caption><title>The GSM for three real SNP data sets.</title><p>Each point in the matrix corresponds to the similarity between a pair of individuals.
Lighter colors correspond to greater similarity. The ordering was obtained by a
hierarchical clustering, as indicated by the dendrograms on the axes, where different
colors reflect substantially different clusters.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep06874-f5"/></fig><fig id="f6"><label>Figure 6</label><caption><title>Empirical type I error rate and power for three real SNP data sets and synthetic
phenotypes with 10 causal SNPs.</title><p>Each point represents the average type I error rate or power across multiple synthetic
phenotypes (400 for Finnish and AVS, and 4,000 for Mouse). In the Finnish power plot,
methods that include select have greater power than those that do not.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep06874-f6"/></fig><fig id="f7"><label>Figure 7</label><caption><title>Empirical type I error rate and power for phenotypes synthetically generated from
SNPs from the Mouse data with 10 causal SNPs.</title><p>GSMs were estimated from SNPs sampled uniformly across the genome (every <italic>k</italic>th
SNP). Each point represents average type I error rate or power across 4,000 synthetic
phenotypes.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep06874-f7"/></fig><table-wrap position="float" id="t1"><label>Table 1</label><caption><title>Model performance in the presence of population structure or family
relatedness</title></caption><table frame="hsides" rules="groups" border="1"><colgroup><col align="left"/><col align="center"/><col align="center"/><col align="center"/><col align="center"/><col align="center"/></colgroup><thead valign="bottom"><tr><th align="justify" valign="top" charoff="50">&#x000a0;</th><th align="center" valign="top" charoff="50">&#x000a0;</th><th colspan="2" align="center" valign="top" charoff="50">&#x02003;population
structure</th><th colspan="2" align="center" valign="top" charoff="50">&#x02003;family
relatedness</th></tr><tr><th align="justify" valign="top" charoff="50">Name of model</th><th align="center" valign="top" charoff="50">Model description</th><th align="center" valign="top" charoff="50">controls type I error</th><th align="center" valign="top" charoff="50">good power</th><th align="center" valign="top" charoff="50">controls type I error</th><th align="center" valign="top" charoff="50">good power</th></tr></thead><tbody valign="top"><tr><td align="center" valign="top" charoff="50">Linreg</td><td align="left" valign="top" charoff="50">Linear regression</td><td align="center" valign="top" charoff="50">&#x000a0;</td><td align="center" valign="top" charoff="50">&#x000a0;</td><td align="center" valign="top" charoff="50">&#x000a0;</td><td align="center" valign="top" charoff="50">&#x000a0;</td></tr><tr><td align="center" valign="top" charoff="50">LMM(all)</td><td align="left" valign="top" charoff="50">LMM with GSM based on all
SNPs</td><td align="center" valign="top" charoff="50">&#x02713;</td><td align="center" valign="top" charoff="50">&#x000a0;</td><td align="center" valign="top" charoff="50">&#x02713;</td><td align="center" valign="top" charoff="50">&#x000a0;</td></tr><tr><td align="center" valign="top" charoff="50">LMM(select)</td><td align="left" valign="top" charoff="50">LMM with GSM based on SNP
selection</td><td align="center" valign="top" charoff="50">&#x000a0;</td><td align="center" valign="top" charoff="50">&#x000a0;</td><td align="center" valign="top" charoff="50">&#x000a0;</td><td align="center" valign="top" charoff="50">&#x000a0;</td></tr><tr><td align="center" valign="top" charoff="50">LMM(select) + PCs</td><td align="left" valign="top" charoff="50">LMM(select) with PCs added as
fixed effects</td><td align="center" valign="top" charoff="50">&#x02713;</td><td align="center" valign="top" charoff="50">&#x02713;</td><td align="center" valign="top" charoff="50">&#x000a0;</td><td align="center" valign="top" charoff="50">&#x000a0;</td></tr><tr><td align="center" valign="top" charoff="50">LMM(all + select)</td><td align="left" valign="top" charoff="50">LMM with a mixture of two
GSMs</td><td align="center" valign="top" charoff="50">&#x02713;</td><td align="center" valign="top" charoff="50">&#x02713;</td><td align="center" valign="top" charoff="50">&#x02713;</td><td align="center" valign="top" charoff="50">&#x02713;</td></tr></tbody></table></table-wrap></floats-group></article>