<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id><journal-id journal-id-type="iso-abbrev">Brief. Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bib</journal-id><journal-id journal-id-type="hwp">bib</journal-id><journal-title-group><journal-title>Briefings in Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1467-5463</issn><issn pub-type="epub">1477-4054</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">23413432</article-id><article-id pub-id-type="pmc">4103537</article-id><article-id pub-id-type="doi">10.1093/bib/bbt002</article-id><article-id pub-id-type="publisher-id">bbt002</article-id><article-categories><subj-group subj-group-type="heading"><subject>Papers</subject></subj-group></article-categories><title-group><article-title>Gene set analysis methods: statistical models and methodological differences</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><name><surname>Maciejewski</surname><given-names>Henryk</given-names></name><xref ref-type="bio" rid="d35e36">*</xref></contrib></contrib-group><author-notes><corresp>Corresponding author. Henryk Maciejewski, Institute of Computer Engineering, Control and Robotics, Wroclaw University of Technology, ul. Wybrzeze Wyspianskiego 27, 50-370 Wroclaw, Poland. Tel.: <phone>+48-71-320-2681</phone>; Fax: <fax>+48-71-321-2677</fax>; E-mail: <email>Henryk.Maciejewski@pwr.wroc.pl</email></corresp></author-notes><pub-date pub-type="ppub"><month>7</month><year>2014</year></pub-date><pub-date pub-type="epub"><day>09</day><month>2</month><year>2013</year></pub-date><pub-date pub-type="pmc-release"><day>09</day><month>2</month><year>2013</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. --><volume>15</volume><issue>4</issue><fpage>504</fpage><lpage>518</lpage><history><date date-type="received"><day>5</day><month>10</month><year>2012</year></date><date date-type="accepted"><day>4</day><month>1</month><year>2013</year></date></history><permissions><copyright-statement>&#x000a9; The Author 2013. Published by Oxford University Press.</copyright-statement><copyright-year>2013</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p>Many methods of gene set analysis developed in recent years have been compared empirically in a number of comprehensive review articles. Although it is recognized that different methods tend to identify different gene sets as significant, no consensus has been worked out as to which method is preferable, as the recommendations are often contradictory. In this article, we want to group and compare different methods in terms of the methodological assumptions pertaining to definition of a sample and formulation of the actual null hypothesis. We discuss four models of statistical experiment explicitly or implicitly assumed by most if not all currently available methods of gene set analysis. We analyse validity of the models in the context of the actual biological experiment. Based on this, we recommend a group of methods that provide biologically interpretable results in statistically sound way. Finally, we demonstrate how correlated or low signal-to-noise data affects performance of different methods, observed in terms of the false-positive rate and power.</p></abstract><kwd-group><kwd>gene set analysis</kwd><kwd>high-throughput data</kwd><kwd>gene expression</kwd><kwd>GWAS</kwd><kwd>competitive methods</kwd><kwd>self-contained methods</kwd></kwd-group><counts><page-count count="15"/></counts></article-meta></front><body><sec sec-type="intro"><title>INTRODUCTION</title><p>Massive throughput techniques, such as microarrays, allow to study genome-wide associations of gene expression with diseases or phenotypes. The focus in expression data analysis has shifted in recent years from single gene to the gene-set level. This important change has been motivated biologically, as many diseases are believed to be associated with modest regulation in a set of related genes rather than a strong increase in a single gene [<xref rid="bbt002-B1" ref-type="bibr">1</xref>]. Gene-set analysis is also expected to ease common limitations of standard single gene studies, such as the difficulty in interpretation of multiple testing corrected lists of differentially expressed genes, or poor reproducibility of important gene lists yielded by independent studies [<xref rid="bbt002-B2" ref-type="bibr">2</xref>, <xref rid="bbt002-B3" ref-type="bibr">3</xref>].</p><p>A variety of methods for gene-set analysis have been developed. These methods incorporate previous biological knowledge about the sets of presumably related genes in the analysis of data. The methods can be broadly categorized as &#x02018;self-contained&#x02019; or &#x02018;competitive&#x02019; [<xref rid="bbt002-B4" ref-type="bibr">4</xref>]. The former analyses association between the phenotype and expression in the gene set of interest while ignoring genes not in the gene set. Examples include the Globaltest [<xref rid="bbt002-B5" ref-type="bibr">5</xref>, <xref rid="bbt002-B6" ref-type="bibr">6</xref>], the ANCOVA [<xref rid="bbt002-B7" ref-type="bibr">7</xref>] or a number of tests described by Fridley <italic>et al.</italic> [<xref rid="bbt002-B8" ref-type="bibr">8</xref>]. Competitive methods compare the gene set with its complement in terms of association with the phenotype. Examples include the popular GSEA algorithm [<xref rid="bbt002-B1" ref-type="bibr">1</xref>], GSA (gene-set analysis) [<xref rid="bbt002-B9" ref-type="bibr">9</xref>], SAFE [<xref rid="bbt002-B10" ref-type="bibr">10</xref>] and Random set methods [<xref rid="bbt002-B11" ref-type="bibr">11</xref>].</p><p>Although the numerous gene-set analysis methods propose different measures of association (statistics), they all attempt to use the framework of statistical hypothesis testing to assess significance of association and, hence, assign a <italic>P</italic>-value to the gene set. The null hypotheses commonly assumed were classified by Goeman and Buehlmann [<xref rid="bbt002-B12" ref-type="bibr">12</xref>] as &#x02018;self-contained&#x02019; or &#x02018;competitive&#x02019;. The self-contained null hypothesis assumes that no genes in the gene set are associated with the phenotype. Obviously, self-contained methods are designed to test this hypothesis. The competitive null hypothesis assumes that genes in the gene set are not more associated with the phenotype than genes outside the gene set. It is commonly taken for granted that competitive methods test this hypothesis. We consider this further in this article.</p><p>Different procedures are proposed to derive distribution of the test statistic under the null hypothesis: using randomization of samples (phenotype labels) [<xref rid="bbt002-B1" ref-type="bibr">1</xref>, <xref rid="bbt002-B5" ref-type="bibr">5</xref>, <xref rid="bbt002-B10" ref-type="bibr">10</xref>]; using randomization of genes [<xref rid="bbt002-B13" ref-type="bibr">13</xref>] or Tian&#x02019;s Q2 statistic [<xref rid="bbt002-B14" ref-type="bibr">14</xref>]; or using different parametric assumptions PAGE [<xref rid="bbt002-B12" ref-type="bibr">12</xref>, <xref rid="bbt002-B15" ref-type="bibr">15</xref>, <xref rid="bbt002-B16" ref-type="bibr">16</xref>].</p><p>We refer the reader to the study conducted by Nam and Kim [<xref rid="bbt002-B4" ref-type="bibr">4</xref>] for a comprehensive list of algorithms and tools available for gene-set analysis. We observe that vast majority of the tools reported implement competitive algorithms, and roughly half of the methods estimate significance by sample randomization, with the remaining half based on gene randomization or on parametric models.</p><p>A number of review articles have been published in recent years comparing performance of the methods based on real or simulated data sets [<xref rid="bbt002-B8" ref-type="bibr">8</xref>, <xref rid="bbt002-B12" ref-type="bibr">12</xref>, <xref rid="bbt002-B17" ref-type="bibr">17&#x02013;22</xref>]. However, they often provide contradictory usage guidelines and recommendations as to which methods should be preferred. In the important methodological article [<xref rid="bbt002-B12" ref-type="bibr">12</xref>], Goeman and Buehlmann strongly recommend to use self-contained methods, as they provide statistically interpretable results. In contrast, they argue that methods based on gene randomization &#x02018;lead to wildly misleading interpretations and should be discouraged in the strongest terms&#x02019;. Nam and Kim [<xref rid="bbt002-B4" ref-type="bibr">4</xref>] recommend to use GSEA or similar methods, such as GSA or SAFE, all of which belong to competitive sample-randomization methods. However, for small sample sizes, they recommend gene-randomization instead. The authors also point that sample-randomization methods may be over-powerful, as they tend to declare gene sets as significant based on only a few differentially expressed genes. Liu <italic>et al.</italic> [<xref rid="bbt002-B17" ref-type="bibr">17</xref>] empirically compared three self-contained methods&#x02014;Globaltest, ANCOVA and SAM-GS&#x02014;and concluded that they show similar performance in terms of size and power, provided that data are properly standardized to stabilize per-gene variance.</p><p>Fridley <italic>et al.</italic> [<xref rid="bbt002-B8" ref-type="bibr">8</xref>] evaluated a number of self-contained methods using an extensive simulation study and demonstrated that the Globaltest and the Fisher&#x02019;s method aggregating <italic>P</italic>-values from individual genes were the most powerful.</p><p>In their recent study [<xref rid="bbt002-B22" ref-type="bibr">22</xref>], Hung <italic>et al.</italic> recommended using enrichment score statistic as defined in GSEA [<xref rid="bbt002-B1" ref-type="bibr">1</xref>], or alternatively the Wilcoxon rank-sum statistic, with empirical rather than analytical null distribution. Their recommendation was based on the Mutual Coverage criterion they defined to measure the extent to which gene sets deemed significant by one method are reproduced by other methods analysed by the authors, based on a collection of &#x0003e;100 experimental data sets.</p><p>Ackermann and Strimmer [<xref rid="bbt002-B21" ref-type="bibr">21</xref>] recommend to use simple univariate procedures, such as the mean of the squared <italic>t</italic>-statistics of genes in the gene set, with either sample or gene randomization. They argue against using the popular GSEA method, strongly rejecting the recommendation put forward by Nam and Kim [<xref rid="bbt002-B4" ref-type="bibr">4</xref>]. Their guidelines are based on a comprehensive simulation study in which they extensively used gene randomization as the means to estimate significance of their findings.</p><p>Irizarry <italic>et al.</italic> [<xref rid="bbt002-B16" ref-type="bibr">16</xref>] also advise against using the GSEA algorithm and propose to use simple parametric tests instead: the <italic>z</italic>-score and the <italic>&#x003c7;</italic><sup>2</sup> test to detect changes in location and scale. They argue that their approach leads to more powerful and much simpler procedure than the popular GSEA.</p><p>Wu and Lin [<xref rid="bbt002-B20" ref-type="bibr">20</xref>] showed that selection of the gene-set analysis method matters, as different methods are likely to produce different, hardly overlapping results. For instance, based on the diabetes data set [<xref rid="bbt002-B23" ref-type="bibr">23</xref>], GSEA and Globaltest methods report 18 and 4 significant data sets, respectively, with only 1 gene set reported by both methods.</p><p>In this work, we want to analyse methodological differences between gene-set analysis methods. We divide the methods into four groups: self-contained, competitive with sample randomization, competitive with gene randomization and parametric. We analyse the statistical models underlying these different methods and discus whether the models agree with the actual experiment that produced the data. We show that gene randomization and some parametric methods are based on a statistical model that does not follow the underlying biological experiment; hence, what the methods name as &#x02018;significance&#x02019; or &#x02018;<italic>P</italic>-value&#x02019; should not be interpreted as such. We then propose a different interpretation of these procedures, no longer based on the statistical hypothesis testing, which leads to biologically relevant interpretation of results.</p><p>In this article, we extend the methodological analysis of gene-set methods presented by Goeman and Buehlmann [<xref rid="bbt002-B12" ref-type="bibr">12</xref>] who clarified fundamental differences between self-contained and competitive hypotheses, and between subject-sampling and gene-sampling approaches. They elaborated the urn model, which underlies the earliest, overrepresentation methods of gene-set enrichment. Based on this model, they formulated fundamental criticism of <italic>P</italic>-values based on gene sampling.</p><p>The extensions provided in this article are 3-fold. First, we clarify the statistical models and null hypotheses of most if not all currently available methods of gene-set enrichment, and we discuss which of the models disagree with the biological experiment. We show that popular competitive methods do not actually test the competitive null hypothesis formulated by Goeman and Buehlmann [<xref rid="bbt002-B12" ref-type="bibr">12</xref>]. Second, we propose a different interpretation of results of some popular methods based on gene randomization, which does not violate the organization of the biological experiment, but gives up the concepts of significance or <italic>P</italic>-values. Third, we present a simple simulation study to illustrate performance of selected self-contained, comparative and parametric methods in terms of size and power, focusing on correlated and low signal-to-noise data.</p></sec><sec sec-type="methods"><title>METHODS</title><p>We introduce the following notation. Let <inline-formula><inline-graphic xlink:href="bbt002i1.jpg"/></inline-formula> denote the matrix with results of a massive throughput study (e.g. gene expression data), with <italic>d</italic> dimensional vectors of gene expression measured for <italic>n</italic> samples. We also define <inline-formula><inline-graphic xlink:href="bbt002i2.jpg"/></inline-formula> as the (1 &#x000d7; n) target vector of class labels for samples. <italic>Y</italic> often represents tumour versus control samples; however, it can also contain continuous measurements. We use here the convention common in bioinformatics literature with samples represented by columns and genes (features) by rows. Let <inline-formula><inline-graphic xlink:href="bbt002i3.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i4.jpg"/></inline-formula> represent the <italic>i</italic>th row and the <italic>j</italic>th column of <italic>W</italic>.</p><p>We want to analyse the association of a given gene set <italic>G</italic> with the target. Let <italic>G</italic> represent the set of indices of rows of <italic>W</italic> that correspond to genes in the gene set <italic>G</italic>, and <italic>G<sup>C</sup></italic>&#x02014;indices of the remaining genes (i.e. complement of <italic>G</italic>). Let <inline-formula><inline-graphic xlink:href="bbt002i5.jpg"/></inline-formula> be the number of elements in <italic>G</italic>.</p><p>It is convenient to represent the matrix of gene expressions for genes in <italic>G</italic> as <inline-formula><inline-graphic xlink:href="bbt002i6.jpg"/></inline-formula>, so that <inline-formula><inline-graphic xlink:href="bbt002i7.jpg"/></inline-formula>. Similarly, we define <inline-formula><inline-graphic xlink:href="bbt002i8.jpg"/></inline-formula>.</p><p>We also define as <inline-formula><inline-graphic xlink:href="bbt002i9.jpg"/></inline-formula>, the measure of association between genes in the gene set and the target (e.g. the t-statistic for binary <italic>Y</italic>), and as <inline-formula><inline-graphic xlink:href="bbt002i10.jpg"/></inline-formula>, the corresponding <italic>P</italic>-values. Similarly, association of genes in <italic>G<sup>C</sup></italic> with the target will be represented by the vectors <italic>t<sup>C</sup></italic> and <italic>P<sup>C</sup></italic>.</p><p>In <xref ref-type="table" rid="bbt002-T1">Table 1</xref>, we present competitive, self-contained and parametric methods of gene-set analysis. As we do not aim to evaluate all published methods, we only illustrate the groups by some popular or representative statistics.
<table-wrap id="bbt002-T1" position="float"><label>Table 1:</label><caption><p>Examples of competitive, self-contained and parametric methods</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Method</th><th rowspan="1" colspan="1">Statistic</th><th rowspan="1" colspan="1">Significance assessment</th></tr></thead><tbody align="left"><tr><td colspan="3" rowspan="1"><bold>Competitive with gene randomization</bold></td></tr><tr><td rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;Q1 (Tian <italic>et al.</italic> [<xref rid="bbt002-B14" ref-type="bibr">14</xref>])</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="bbt002i11.jpg"/></inline-formula></td><td rowspan="1" colspan="1">Gene randomization</td></tr><tr><td rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;FCS&#x02014;Functional Class Score (Pavlidis <italic>et al.</italic> [<xref rid="bbt002-B24" ref-type="bibr">24</xref>])</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="bbt002i12.jpg"/></inline-formula></td><td rowspan="1" colspan="1">Gene randomization</td></tr><tr><td colspan="3" rowspan="1"><bold>Competitive with sample randomization</bold></td></tr><tr><td rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;GSEA (Subramanian <italic>et al.</italic> [<xref rid="bbt002-B1" ref-type="bibr">1</xref>])</td><td rowspan="1" colspan="1">Kolmogorov&#x02013;Smirnov statistic comparing ranks of <italic>P</italic>-values of genes in gene set versus uniform distribution</td><td rowspan="1" colspan="1">Sample randomization</td></tr><tr><td rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;GSA (Efron and Tibshirani [<xref rid="bbt002-B9" ref-type="bibr">9</xref>])</td><td rowspan="1" colspan="1">The <italic>maxmean</italic> statistic <italic>S</italic><sub>max</sub> equal: <inline-formula><inline-graphic xlink:href="bbt002i13.jpg"/></inline-formula></td><td rowspan="1" colspan="1">Sample randomization for standardized test statistics</td></tr><tr><td rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;SAFE (Barry <italic>et al.</italic> [<xref rid="bbt002-B10" ref-type="bibr">10</xref>])</td><td rowspan="1" colspan="1">Kolmogorov&#x02013;Smirnov or Wilcoxon rank-sum statistic comparing <italic>t</italic> versus <italic>t<sup>C</sup></italic></td><td rowspan="1" colspan="1">Sample randomization</td></tr><tr><td colspan="3" rowspan="1"><bold>Self-contained</bold></td></tr><tr><td rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;Globaltest (Goeman <italic>et al.</italic> [<xref rid="bbt002-B5" ref-type="bibr">5</xref>])</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="bbt002i14.jpg"/></inline-formula>where <italic>&#x000b5;</italic> and <italic>&#x000b5;<sub>2</sub></italic> are the are the first and second central moment of <italic>Y</italic></td><td rowspan="1" colspan="1">Asymptotic normal distribution, or for small sample approximation by scaled <italic>&#x003c7;</italic><sup>2</sup> distribution, or randomization of samples</td></tr><tr><td rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;Q2 (Tian <italic>et al.</italic> [<xref rid="bbt002-B14" ref-type="bibr">14</xref>])</td><td rowspan="1" colspan="1">Same as Q1</td><td rowspan="1" colspan="1">Sample randomization</td></tr><tr><td rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;FCS.SC&#x02014;self-contained version of FCS (Pavlidis <italic>et al.</italic> [<xref rid="bbt002-B24" ref-type="bibr">24</xref>])</td><td rowspan="1" colspan="1">Same as FCS</td><td rowspan="1" colspan="1">Sample randomization</td></tr><tr><td rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;ES.SC&#x02014;self-contained version of the enrichment score (Subramanian <italic>et al.</italic> [<xref rid="bbt002-B1" ref-type="bibr">1</xref>])</td><td rowspan="1" colspan="1">Kolmogorov&#x02013;Smirnov statistic comparing <inline-formula><inline-graphic xlink:href="bbt002i15.jpg"/></inline-formula> versus the uniform distribution</td><td rowspan="1" colspan="1">Analytical Kolmogorov&#x02013;Smirnov distribution or randomization of samples</td></tr><tr><td colspan="3" rowspan="1"><bold>Parametric</bold></td></tr><tr><td rowspan="2" colspan="1">&#x02003;PAGE (Kim and Volksy [<xref rid="bbt002-B15" ref-type="bibr">15</xref>])</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="bbt002i16.jpg"/></inline-formula></td><td rowspan="2" colspan="1">Null distribution of <italic>z&#x0223c;N</italic>(0,1)</td></tr><tr><td rowspan="1" colspan="1">where <italic>&#x003bc;, &#x003b4;</italic> are the mean and standard deviation of fold changes calculated for all genes, and <italic>&#x003bc;<sub>G</sub></italic> is the mean of fold changes for genes in <italic>G</italic></td></tr><tr><td rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;CATEGORY (Jiang <italic>et al.</italic> [<xref rid="bbt002-B25" ref-type="bibr">25</xref>], Irizarry <italic>et al.</italic> [<xref rid="bbt002-B16" ref-type="bibr">16</xref>])</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="bbt002i17.jpg"/></inline-formula></td><td rowspan="1" colspan="1">Null distribution of <italic>z&#x0223c;N</italic>(0,1)</td></tr><tr><td rowspan="1" colspan="1">&#x02003;&#x02003;&#x02003;&#x02003;Other parametric tests proposed by Irizarry <italic>et al.</italic> [<xref rid="bbt002-B16" ref-type="bibr">16</xref>]</td><td rowspan="1" colspan="1">Wilcoxon rank-sum statistic or <italic>&#x003c7;</italic><sup>2</sup> statistic comparing <italic>t</italic> versus <italic>t<sup>C</sup></italic></td><td rowspan="1" colspan="1">Corresponding analytical distributions</td></tr></tbody></table></table-wrap></p></sec><sec><title>COMPETITIVE METHODS WITH RANDOMIZATION OF GENES OR SAMPLES</title><p>Competitive methods aim to test the null hypothesis that genes in the gene set <italic>G</italic> are at most as often differentially expressed as the genes in <italic>G<sup>C</sup></italic> [<xref rid="bbt002-B12" ref-type="bibr">12</xref>]. Rejection of the hypothesis (i.e. <italic>P</italic>-value &#x0003c; 0.05) indicates that the gene set includes significantly more differentially expressed genes than the remaining collection of genes in the experiment, and therefore can be declared as activated.</p><p>The basic idea of these methods is well illustrated by the Q1 statistic proposed by Tian <italic>et al.</italic> [<xref rid="bbt002-B14" ref-type="bibr">14</xref>]. The statistic aggregates the measures of association of individual genes in <italic>G</italic> with the target. Significance of the Q1 statistic is calculated by permutation of genes (rows of the matrix <italic>W</italic>), with the <italic>P</italic>-value calculated as
<disp-formula id="bbt002-M1"><label>(1)</label><graphic xlink:href="bbt002m1.jpg" position="float"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="bbt002i18.jpg"/></inline-formula> is the value of the <italic>Q1</italic> statistic recomputed for the gene set after the <italic>i</italic>th permutation of genes, and <italic>B</italic> is the total number of permutations.</p><p>Another group of competitive methods calculate the test statistic based on <italic>X</italic> and <italic>X<sup>C</sup></italic>, and estimate its significance by permuting subjects (elements of <italic>Y</italic>). The most popular example is the GSEA method [<xref rid="bbt002-B1" ref-type="bibr">1</xref>]. The statistic (enrichment score, ES) is the weighted Kolmogorov&#x02013;Smirnov statistic comparing the ranks of genes in <italic>G</italic> with the uniform distribution. This is motivated by the observation that for the null hypothesis, the members of the gene set should be uniformly distributed among all the genes (all the rows of <italic>W</italic>). Significance is estimated as in <xref ref-type="disp-formula" rid="bbt002-M1">Equation (1)</xref>, with permutation of samples instead of genes.</p><p>Another interesting method is the GSA proposed by Efron and Tibshirani [<xref rid="bbt002-B9" ref-type="bibr">9</xref>]. The method attempts to combine gene and sample randomization in one procedure called &#x02018;re-standardization&#x02019;. For a gene set <italic>G</italic>, the method calculates the test statistic (gene set score) <italic>S</italic> as, preferably, the maxmean statistic <italic>S</italic><sub>max</sub> (<xref ref-type="table" rid="bbt002-T1">Table 1</xref>); however, simpler choices are also considered (such as the mean of individual gene scores in <italic>G</italic>, essentially as in the Q1 statistic). Significance is estimated using permutation of samples; however, the test statistic is standardized using gene scores calculated for all the genes in the study. Specifically, the <italic>P</italic>-value is calculated as:
<disp-formula id="bbt002-M2"><label>(2)</label><graphic xlink:href="bbt002m2.jpg" position="float"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="bbt002i19.jpg"/></inline-formula> is the gene set score for the <italic>i</italic>th permutation of samples, <inline-formula><inline-graphic xlink:href="bbt002i20.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i21.jpg"/></inline-formula> are the mean and standard deviation of individual gene scores for all genes in the study, and <inline-formula><inline-graphic xlink:href="bbt002i22.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i23.jpg"/></inline-formula> are the mean and standard deviation of individual gene scores calculated over all genes in the study and a large number of permutations [<xref rid="bbt002-B9" ref-type="bibr">9</xref>]. Standardization of the gene-set scores makes this method competitive, i.e. allows us to compare scores of genes in <italic>G</italic> with those outside <italic>G</italic>. Strictly, the <xref ref-type="disp-formula" rid="bbt002-M2">Equation (2)</xref> is used if the test statistic <italic>S</italic> is defined as the mean gene score or mean absolute gene score. For the maxmean statistic <inline-formula><inline-graphic xlink:href="bbt002i24.jpg"/></inline-formula>, as defined in <xref ref-type="table" rid="bbt002-T1">Table 1</xref>, the re-standardized statistic <inline-formula><inline-graphic xlink:href="bbt002i25.jpg"/></inline-formula> is calculated as <inline-formula><inline-graphic xlink:href="bbt002i26.jpg"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="bbt002i27.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="bbt002i28.jpg"/></inline-formula> is the element <inline-formula><inline-graphic xlink:href="bbt002i29.jpg"/></inline-formula> of the maxmean statistic calculated for the <italic>i</italic>th permutation of samples (the same re-standardization applies for <inline-formula><inline-graphic xlink:href="bbt002i30.jpg"/></inline-formula>). Then the <italic>P</italic>-value is calculated as the fraction of sample permutations in which <inline-formula><inline-graphic xlink:href="bbt002i31.jpg"/></inline-formula>.</p></sec><sec><title>SELF-CONTAINED METHODS</title><p>Self-contained methods test the null hypothesis that no genes in the gene set are associated with the target. The hypothesis is verified based on the data <inline-formula><inline-graphic xlink:href="bbt002i32.jpg"/></inline-formula> while ignoring <italic>X<sup>C</sup></italic>.</p><p>A prominent example is the Globaltest [<xref rid="bbt002-B5" ref-type="bibr">5</xref>] based on generalized linear model of the relationship between <italic>X</italic> and <italic>Y</italic>, with the null hypothesis assuming that all the coefficients in the model are zero. The Globaltest is derived as the score test, which guarantees high power for gene sets with many genes moderately associated with the target. Similar multivariate procedure was proposed by Mansmann and Meister [<xref rid="bbt002-B7" ref-type="bibr">7</xref>].</p><p>Other self-contained approaches define the test statistic as the aggregate of individual gene scores (such as the Q2), with the null distribution derived by permutation of samples. Following this idea, a modification of popular competitive methods can be proposed that makes them self-contained. For instance, the FCS statistic [<xref rid="bbt002-B24" ref-type="bibr">24</xref>] with sample-randomization null distribution becomes self-contained, and the ES statistic based on raw <italic>P</italic>-values instead of ranks also becomes self-contained.</p><p>Other self-contained approaches were proposed by Fridley <italic>et al.</italic>, Dinu <italic>et al.</italic> and Kong <italic>et al.</italic> [<xref rid="bbt002-B8" ref-type="bibr">8</xref>, <xref rid="bbt002-B26" ref-type="bibr">26</xref>, <xref rid="bbt002-B27" ref-type="bibr">27</xref>].</p></sec><sec><title>PARAMETRIC METHODS</title><p>Several authors criticized empirical null distribution of the GSEA or related methods and argued that simpler statistics can be used for which parametric null distributions are known. For instance, Irizarry <italic>et al.</italic> [<xref rid="bbt002-B16" ref-type="bibr">16</xref>] proposed to directly compare the vectors of associations with the target <italic>t</italic> and <italic>t<sup>C</sup></italic> using more powerful tests for location and scale instead of the K&#x02013;S test, with their analytical null distributions rather than empirical distributions. Similar idea was suggested by Jiang and Gentleman [<xref rid="bbt002-B25" ref-type="bibr">25</xref>].</p><p>Another example of the parametric approach is the PAGE [<xref rid="bbt002-B15" ref-type="bibr">15</xref>]. The method calculates the mean fold change for all genes in the experiment and compares this mean with the mean fold change for the genes in <italic>G</italic>. Under the null hypothesis, the <italic>z</italic>-score should follow the normal distribution, which is used to estimate the <italic>P</italic>-value.</p></sec><sec><title>MODELS OF STATISTICAL EXPERIMENT ASSUMED BY DIFFERENT METHODS</title><p>Although different in nature, virtually all methods of gene-set analysis interpret their results in terms of <italic>significance</italic> or <italic>P</italic><italic>-values</italic>&#x02014;the concepts that are meaningful in the context of statistical hypothesis testing. To correctly interpret the results, it is essential that the underlying statistical assumptions are clearly stated regarding: the null and alternative hypotheses, the sample (size and independence) and derivation of the null distribution of the test statistic. In this section, we analyse the models of statistical experiment explicitly or implicitly assumed by different gene-set analysis methods. We use here the notation introduced in the &#x02018;Methods&#x02019; section.</p><sec><title>Model 1</title><p>In this model, we analyse association between two random variables: <inline-formula><inline-graphic xlink:href="bbt002i33.jpg"/></inline-formula>, phenotype of the subject (patient), and <inline-formula><inline-graphic xlink:href="bbt002i34.jpg"/></inline-formula>, expression of genes in set <italic>G</italic>. We consider the experiment data <italic>X</italic>,<italic>Y</italic> as the sample of <italic>n</italic> independent realizations of these variables:
<disp-formula id="bbt002-M3"><label>(3)</label><graphic xlink:href="bbt002m3.jpg" position="float"/></disp-formula>
The null hypothesis assumes that <inline-formula><inline-graphic xlink:href="bbt002i35.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i36.jpg"/></inline-formula> are independent.</p><p>If <italic>T</italic> is the test statistic, then the null distribution of the statistic can be non-parametrically estimated by re-calculating the statistic based on (many) samples as in <xref ref-type="disp-formula" rid="bbt002-M3">Equation (3)</xref>, with the values of <italic>Y</italic> randomly permuted.</p><p>It should be noted that the permutation null distribution of <italic>T</italic> is available only when <inline-formula><inline-graphic xlink:href="bbt002i37.jpg"/></inline-formula> can be considered independent samples from <inline-formula><inline-graphic xlink:href="bbt002i38.jpg"/></inline-formula>, which is not true for time-series studies.</p><p>This model of statistical experiment underlies the following gene-set analysis methods (<xref ref-type="table" rid="bbt002-T1">Table 1</xref>):
<list list-type="bullet"><list-item><p>Globaltest,</p></list-item><list-item><p>Q2,</p></list-item><list-item><p>FCS.SC,</p></list-item><list-item><p>ES.SC with the null distribution obtained by randomization of samples.</p></list-item></list>
</p><p>Indeed, these methods calculate the test statistic based on expression of genes <italic>G</italic>, <inline-formula><inline-graphic xlink:href="bbt002i39.jpg"/></inline-formula>, which are samples from <inline-formula><inline-graphic xlink:href="bbt002i40.jpg"/></inline-formula>, with significance calculated using the null distribution obtained by calculating (many) values of the statistic under permutations of sample labels. Thus, by using the sample randomization, we <italic>de facto</italic> assume the null hypothesis that expression of genes for a subject <inline-formula><inline-graphic xlink:href="bbt002i41.jpg"/></inline-formula> and the subject&#x02019;s phenotype <inline-formula><inline-graphic xlink:href="bbt002i42.jpg"/></inline-formula> is independent, as stated in Model 1.</p><p>Note, however, that this model does not apply to the ES.SC when the analytical null distribution is used. Model 2 is appropriate for this case.</p></sec><sec><title>Model 2</title><p>In this model, we analyse association between the random variables: <inline-formula><inline-graphic xlink:href="bbt002i43.jpg"/></inline-formula>, phenotype of the subject, and <inline-formula><inline-graphic xlink:href="bbt002i44.jpg"/></inline-formula>, expression of a gene in the gene set <italic>G</italic> for the subject. We assume that expression of <italic>m</italic> genes in <italic>G</italic> measured for a subject <italic>i</italic>, denoted <inline-formula><inline-graphic xlink:href="bbt002i45.jpg"/></inline-formula>, consists of <italic>m</italic> independent samples from <inline-formula><inline-graphic xlink:href="bbt002i46.jpg"/></inline-formula>, i.e. we assume that the genes in <italic>G</italic> are independent and governed by the same distribution.</p><p>The null hypothesis assumes that <inline-formula><inline-graphic xlink:href="bbt002i47.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i48.jpg"/></inline-formula> are independent.</p><p>The experiment data <italic>X</italic>, <italic>Y</italic> represents results of <italic>m</italic> independent tests each with <italic>n</italic> samples from <inline-formula><inline-graphic xlink:href="bbt002i49.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i50.jpg"/></inline-formula>:
<disp-formula id="bbt002-M4"><label>(4)</label><graphic xlink:href="bbt002m4.jpg" position="float"/></disp-formula>
</p><p>These tests produce <inline-formula><inline-graphic xlink:href="bbt002i51.jpg"/></inline-formula>&#x02014;<italic>m</italic> independent gene scores, i.e. measures of association between <inline-formula><inline-graphic xlink:href="bbt002i52.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i53.jpg"/></inline-formula>, with their corresponding <italic>P</italic>-values <inline-formula><inline-graphic xlink:href="bbt002i54.jpg"/></inline-formula>.</p><p>Under the null hypothesis in this model, the <italic>P</italic>-values come from the Uniform(0,1) distribution. Hence, any gene-set analysis method that tests for uniformity of <italic>P<sub>i</sub></italic>, or for some other analytical distribution of the combination of independent <italic>t</italic>-statistics, or <italic>P</italic>-values calculated for genes in the gene set <italic>G</italic> actually realizes this model of statistical experiment. Examples of such methods include:
<list list-type="bullet"><list-item><p>ES.SC with the analytical null distribution (<xref ref-type="table" rid="bbt002-T1">Table 1</xref>),</p></list-item><list-item><p>The parametric method proposed by Irizarry <italic>et al.</italic> and Jiang and Gentleman [<xref rid="bbt002-B16" ref-type="bibr">16</xref>, <xref rid="bbt002-B25" ref-type="bibr">25</xref>] (CATEGORY in <xref ref-type="table" rid="bbt002-T1">Table 1</xref>),</p></list-item><list-item><p>Fisher&#x02019;s method for combining independent <italic>P</italic>-values, using the <italic>&#x003c7;</italic><sup>2</sup> null distribution [<xref rid="bbt002-B8" ref-type="bibr">8</xref>],</p></list-item><list-item><p>Testing for normality of <italic>t<sub>i</sub></italic> (as proposed by Irizarry <italic>et al.</italic> [<xref rid="bbt002-B16" ref-type="bibr">16</xref>]).</p></list-item></list>
</p><p>The last two methods, suggested in literature, are not reported in <xref ref-type="table" rid="bbt002-T1">Table 1</xref>.</p><p>All these methods realize Model 2, as they consider the values <inline-formula><inline-graphic xlink:href="bbt002i55.jpg"/></inline-formula> (or <inline-formula><inline-graphic xlink:href="bbt002i56.jpg"/></inline-formula>) as independent samples from some distribution, and test whether the sample comes from the null distribution that is based on the assumption that the <italic>m</italic> tests which produced <inline-formula><inline-graphic xlink:href="bbt002i57.jpg"/></inline-formula> or <inline-formula><inline-graphic xlink:href="bbt002i58.jpg"/></inline-formula> tested independent variables: <inline-formula><inline-graphic xlink:href="bbt002i59.jpg"/></inline-formula> (which represent expression of a given gene in <italic>G</italic>) and <inline-formula><inline-graphic xlink:href="bbt002i60.jpg"/></inline-formula> (phenotype). Hence, by using this procedure to estimate significance, we <italic>de facto</italic> assume that genes in <italic>G</italic> are iid, as stated in Model 2.</p></sec><sec><title>Model 3</title><p>In this model, we consider the data <inline-formula><inline-graphic xlink:href="bbt002i61.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i62.jpg"/></inline-formula><inline-formula><inline-graphic xlink:href="bbt002i62b.jpg"/></inline-formula><inline-formula><inline-graphic xlink:href="bbt002i62a.jpg"/></inline-formula> as iid samples drawn from two unknown distributions denoted <inline-formula><inline-graphic xlink:href="bbt002i63.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i64.jpg"/></inline-formula>. Although it is hard to interpret these random variables in the context of the actual biological study, we loosely describe <inline-formula><inline-graphic xlink:href="bbt002i65.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i66.jpg"/></inline-formula> as association of genes in <italic>G</italic> and outside <italic>G</italic>, respectively, with the target.</p><p>Different null hypotheses are defined in this model, e.g. that the variables <inline-formula><inline-graphic xlink:href="bbt002i67.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i68.jpg"/></inline-formula> have the same distribution, or that they do not differ in some specific parameter (e.g. mean).</p><p>The gene-set analysis methods that are based on this model use different tests to compare <italic>t</italic> and <italic>t<sup>C</sup></italic> and different procedures to obtain the null distribution of the test statistic. Examples include (<xref ref-type="table" rid="bbt002-T1">Table 1</xref>):
<list list-type="bullet"><list-item><p>Statistical tests directly comparing <italic>t</italic> and <italic>t<sup>C</sup></italic> (e.g. using the <italic>t</italic>-test, Wilcoxon rank-sum, <italic>&#x003c7;</italic><sup>2</sup> tests), as proposed by Irizarry <italic>et al.</italic> [<xref rid="bbt002-B16" ref-type="bibr">16</xref>],</p></list-item><list-item><p>PAGE [<xref rid="bbt002-B15" ref-type="bibr">15</xref>],</p></list-item><list-item><p>Competitive methods with gene randomization, such as the Q1 or FCS.</p></list-item></list>
</p><p>It should be noted that although the Q1 or FCS statistics are based only on <italic>t</italic> and do not take <italic>t<sup>C</sup></italic> into account, the methods are competitive because of the gene randomization procedure used to derive the null distribution. Indeed, if the gene permutation-based distribution is used as the null distribution to obtain the <italic>P</italic>-value as in <xref ref-type="disp-formula" rid="bbt002-M1">Equation (1)</xref>, then this is equivalent to the assumption that <italic>t</italic> and <italic>t<sup>C</sup></italic> have been drawn from the same distribution. Additionally, by using elements of <italic>t</italic> and elements of <italic>t<sup>C</sup></italic> as samples from their underlying distributions, we <italic>de facto</italic> assume that elements of <italic>t</italic> are independent, and elements of <italic>t<sup>C</sup></italic> are independent, which further implies independence of genes.</p></sec><sec><title>Model 4</title><p>In this model, we consider the experiment data <italic>Y</italic>, <italic>X</italic> and <italic>X<sup>C</sup></italic> as <italic>n</italic> independent realizations of the random variables <inline-formula><inline-graphic xlink:href="bbt002i69.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="bbt002i70.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i71.jpg"/></inline-formula>, which represent phenotype of the subject, the subject&#x02019;s expression of genes in <italic>G</italic> and expression of genes not in <italic>G</italic>:
<disp-formula id="bbt002-M5"><label>(5)</label><graphic xlink:href="bbt002m5.jpg" position="float"/></disp-formula>
</p><p>The test statistic is calculated based on <italic>X</italic> and <italic>X<sup>C</sup></italic>, with its null distribution obtained by randomization of samples, as in Model 1. This procedure to obtain the null distribution implies that the actual null hypothesis assumes that <inline-formula><inline-graphic xlink:href="bbt002i72.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i73.jpg"/></inline-formula> are independent and <inline-formula><inline-graphic xlink:href="bbt002i74.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i75.jpg"/></inline-formula> are independent.</p><p>This model of statistical experiment is valid for competitive methods with randomization of samples, such as:
<list list-type="bullet"><list-item><p>GSEA,</p></list-item><list-item><p>SAFE.</p></list-item></list>
</p><p>This model differs from Model 1 in how the test statistic is constructed: in Model 1, it is based only on <italic>X</italic>, whereas in Model 4, it includes <italic>X</italic> and <italic>X<sup>C</sup></italic>. Note that by permuting sample labels assigned to the data vectors <inline-formula><inline-graphic xlink:href="bbt002i76.jpg"/></inline-formula>,<inline-formula><inline-graphic xlink:href="bbt002i77.jpg"/></inline-formula> to calculate the null distribution of the test statistic, we <italic>de facto</italic> assume independence of the phenotype and genes in <italic>G</italic> and also independence of the phenotype and genes in <italic>G<sup>C</sup></italic>.</p><p>Finally, we want to analyse the model of statistical experiment realized by the GSA method. The method uses sample permutation test [<xref ref-type="disp-formula" rid="bbt002-M2">Equation (2)</xref>] to empirically obtain the null distribution of the test statistic. Referring to <xref ref-type="disp-formula" rid="bbt002-M2">Equation (2)</xref>, we consider the standardized score <inline-formula><inline-graphic xlink:href="bbt002i78.jpg"/></inline-formula> as the test statistic, whose significance we want to obtain non-parametrically through sample permutations. Note that this statistic compares differential expression of genes in <italic>G</italic> with the mean level of differential expression observed for all genes (hence, the statistic is <italic>competitive</italic>). Significance of this statistic <italic>could be</italic> obtained by calculating many possible values <italic>of this statistic</italic> using sample permutations:
<disp-formula id="bbt002-M6"><label>(6)</label><graphic xlink:href="bbt002m6.jpg" position="float"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="bbt002i79.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i80.jpg"/></inline-formula> denotes the mean and standard deviation of the gene scores over all genes calculated for the <italic>i</italic>th permutation of samples. Small <italic>P</italic>2 leads to rejection of H0 of no association of expression in subjects and their class labels, which we interpret that <italic>G</italic> is enhanced (contains more differentially expressed genes than expected by looking at the proportion of DE genes in the list of all genes), as this is what <inline-formula><inline-graphic xlink:href="bbt002i81.jpg"/></inline-formula> actually measures. However, we note that, strictly, the original GSA method [<xref ref-type="disp-formula" rid="bbt002-M2">Equation (2)</xref>] does not produce the permutation-based null distribution of the test statistic <inline-formula><inline-graphic xlink:href="bbt002i82.jpg"/></inline-formula> needed to derive the <italic>P</italic>-value. Instead, the method produces the null distribution of <inline-formula><inline-graphic xlink:href="bbt002i83.jpg"/></inline-formula>, which complicates rigid interpretation of the <italic>P</italic>-value produced by <xref ref-type="disp-formula" rid="bbt002-M2">Equation (2)</xref>. We will return to this in &#x02018;Empirical Comparison&#x02019; section.</p></sec></sec><sec><title>VALIDITY OF THE MODELS IN THE CONTEXT OF BIOLOGICAL STUDY</title><p>Significant result (i.e. <italic>P</italic>-value <italic>P</italic> &#x0003c; 0.05) obtained by any gene-set analysis method means that if the actual null hypothesis of the particular method was true, then only the fraction of <italic>P</italic> repetitions of the experiment would return the data (i.e. the test statistic) more extreme than actually observed. Obviously, repetition of the experiment as perceived by the biologist consists in taking a new sample of subjects (e.g. patients) and taking a new sample of measurements from these subjects, as described in <xref ref-type="disp-formula" rid="bbt002-M3">Equations (3)</xref> or <xref ref-type="disp-formula" rid="bbt002-M5">(5)</xref>.</p><p>The research question posed by the biologist is related to whether (i) expression of genes in <italic>G</italic> is associated with the phenotype, or (ii) frequency of differentially expressed genes in <italic>G</italic> is higher than in <italic>G<sup>C</sup></italic>. Question (i) is related to the self-contained null hypothesis, whereas question (ii) is related to the competitive null hypothesis, as formulated by Goeman and Buehlmann [<xref rid="bbt002-B12" ref-type="bibr">12</xref>].</p><p>Analysing models of the statistical experiment developed in the previous section in the context of the biological experiment, we make the following observations:
<list list-type="order"><list-item><p>Models 1 and 4 directly correspond to the organization of the biological experiment, where the sample [considering Model 1, <xref ref-type="disp-formula" rid="bbt002-M3">Equation (3)</xref>] represents expression of <italic>m</italic> genes in <italic>G</italic> measured for <italic>n</italic> independent subjects (<inline-formula><inline-graphic xlink:href="bbt002i84.jpg"/></inline-formula>), together with the subjects phenotypes (<inline-formula><inline-graphic xlink:href="bbt002i85.jpg"/></inline-formula>). <italic>P</italic>-value <italic>P</italic> produced by tests under Model 1 have clear biological interpretation described earlier in the text, where repeating experiments can be realized by taking new samples from <inline-formula><inline-graphic xlink:href="bbt002i86.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i87.jpg"/></inline-formula>, i.e. testing new patients. Significant result declared by gene-set analysis methods based on Model 1 indicates that the gene set concerned contains genes associated with the phenotype. Significant result according to Model 4 indicates that either the gene set or its complement contain genes associated with the phenotype. Hence, the methods based on Model 1 directly answer the research question (i). If we make (often reasonable) assumption that (most of) genes in <italic>G<sup>C</sup></italic> are not differentially expressed, then methods based on Model 4 also answer the research question (i).</p></list-item><list-item><p>Model 2 also closely mimics organization of the biological experiment in terms of how a sample is taken and how experiment is repeated (which is essentially done as in Model 1). However, gene-set analysis methods based on this model rely on the assumption that genes in <italic>G</italic> are independent and identically distributed&#x02014;both of which seems highly unrealistic in expression studies. However, if the assumptions were true, then methods based on Model 2 would answer the research question (i).</p></list-item><list-item><p>Model 3 compares two samples of size <italic>m</italic> and <italic>d &#x02212; m</italic>, where genes are the sampling units. In this model, we compare distributions of two unknown random variables (denoted previously <inline-formula><inline-graphic xlink:href="bbt002i88.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i89.jpg"/></inline-formula>), which produced the samples <italic>t</italic> and <italic>t<sup>C</sup></italic>. As we use statistical tests to compare <inline-formula><inline-graphic xlink:href="bbt002i90.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i91.jpg"/></inline-formula>, we implicitly assume that elements in each of the samples <italic>t</italic> and <italic>t<sup>C</sup></italic> are iid, which implies that expression of genes in <italic>G</italic> are independent and identically distributed (which can be weakened for gene permutation procedures, as we only require that genes are exchangeable). The most fundamental problem with interpretation of this model is the biological meaning of the variables <inline-formula><inline-graphic xlink:href="bbt002i92.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="bbt002i93.jpg"/></inline-formula>. It is also not clear how repeating the biological experiment (i.e. testing new patients) could bring more samples from these variables.</p></list-item></list>
</p><p>In summary, only methods based on Model 1 address the research question (i), which is related to the self-contained null hypothesis. Methods based on Model 4 (this group includes popular methods such as GSEA) also address the same question, although an additional assumption is made of no association of genes outside <italic>G</italic> with the phenotype. Methods based on Model 2 also test the self-contained null hypothesis, but they make the assumption that expression of genes in <italic>G</italic> is iid. Methods based on Model 3 compare two random variables with unclear biological meaning, and, additionally, they assume that genes in <italic>G</italic> are independent and identically distributed. <italic>This leads to the conclusion that none of the methods discussed in the previous section seems to address the research question (ii), related to competitive null hypothesis, in statistically sound way</italic><italic>.</italic></p></sec><sec><title>PROPOSED INTERPRETATION OF GENE SAMPLING PROCEDURES</title><p>As the methods of gene-set analysis that use gene sampling to test the competitive null hypothesis are popular (see the review [<xref rid="bbt002-B4" ref-type="bibr">4</xref>]), it seems compelling to find some interpretation of their results in line with the actual biological experiment.</p><p>Here, we propose such interpretation. The sample in the model is a set of <italic>n</italic> subjects. For this sample, we measure association of expression of genes in the gene set <italic>G</italic> with the phenotype, denoted <italic>t</italic>. We consider <italic>t</italic> as one realization of a random variable <inline-formula><inline-graphic xlink:href="bbt002i94.jpg"/></inline-formula>. In the same experiment, we measure association of genes outside <italic>G</italic> with the phenotype, denoted <italic>t<sup>C</sup></italic>.</p><p>We want to assess whether <italic>G</italic> is enhanced, i.e. whether genes in <italic>G</italic> are more associated with the target than the remaining genes. To do this, we randomly draw many <italic>m</italic>-element subsets from <italic>t<sup>C</sup></italic>, denoted <italic>tm<sub>i</sub></italic>, <italic>i</italic> = 1,&#x02026;,<italic>B</italic>. Now we can calculate a heuristic measure of enhancement of <italic>G</italic> defined as:
<disp-formula id="bbt002-M7"><label>(7)</label><graphic xlink:href="bbt002m7.jpg" position="float"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="bbt002i95.jpg"/></inline-formula>, [e.g. <inline-formula><inline-graphic xlink:href="bbt002i96.jpg"/></inline-formula> equals <inline-formula><inline-graphic xlink:href="bbt002i97.jpg"/></inline-formula> or the mean absolute value of elements of <italic>t</italic>].</p><p>Note that <italic>s</italic> intuitively addresses the question formulated in the competitive null-hypothesis, where small values of <italic>s</italic> say that it is unlikely that a randomly selected gene set of size <italic>m</italic> composed of genes from <italic>G<sup>C</sup></italic> realizes stronger association with the target than <italic>G</italic>, which suggests enhancement of the gene set <italic>G</italic>.</p><p>However, we should be careful not to use the language of statistical hypothesis testing while interpreting <italic>s</italic>, i.e. <italic>s</italic> is <italic>not</italic> a <italic>P</italic>-value, and <italic>s</italic> &#x0003c; 0.05 has nothing to do with &#x02018;statistical significance&#x02019; of results. Result <italic>s</italic> &#x0003c; 0.05 means that only 5% of subsets (gene sets) of size <italic>m</italic> drawn from <italic>G<sup>C</sup></italic> have as extreme <italic>t</italic> values (i.e. associations with the target) as observed in <italic>G</italic>.</p></sec><sec><title>EMPIRICAL COMPARISON</title><p>Genes-set analysis methods based on Model 2 and 3 rely on the assumption that gene expressions are independent. In this section, we want to quantify performance of different methods if data does not follow this assumption. In the first two experiments, we focus on the self-contained hypothesis, whereas in experiments 3 and 4, we focus on the competitive hypothesis. In experiment 1, we demonstrate the false-positive rate of different methods under varying correlation of genes in the gene set. In experiment 2, we compare the power of selected methods for the cases when only a small fraction of genes in the gene set are differentially expressed. We address the criticism formulated by some authors [<xref rid="bbt002-B4" ref-type="bibr">4</xref>] that self-contained methods may demonstrate excessive sensitivity if only a few genes in the set are associated with the target. In experiment 3, we quantify the false-positive rate of different methods under the competitive hypothesis, where many gene sets are similarly differentially expressed, but one of the gene sets contains correlated genes. In experiment 4, we compare power of different competitive methods in the setting where many gene sets are differentially expressed, but one of the gene sets is significantly more differentially expressed.</p><p>As our purpose is to compare performance of methods under known characteristics of data, we deliberately restrict this analysis to simulated data.</p><p>In experiment 1, we quantify type I error of different methods based on simple simulated data set with <italic>n</italic> = 30 samples and <italic>d</italic> = 100 or <italic>d</italic> = 1000 genes, out of which <italic>m</italic> = 40 genes constitute a gene set <italic>G</italic>. In this study, no genes in <italic>G</italic> or in <italic>G<sup>C</sup></italic> are differentially expressed, but genes in <italic>G</italic> are correlated. We generate expression for the genes in <italic>G</italic> from the multivariate normal distribution with the mean for each of the <italic>m</italic> genes equal 0 and the covariance matrix, which has diagonal elements equal 1 and non-diagonal elements equal <italic>r</italic>. Note that as variances of genes are 1, <italic>r</italic> is the correlation of genes in <italic>G</italic>. The remaining <italic>d &#x02212; m</italic> genes come from N(0,1).</p><p>In the experiment, we vary the parameter <italic>r</italic>. We repeat the experiment 500 times and observe the <italic>P</italic>-value produced by different methods. We record how many times (out of 500) each of the methods produces significant <italic>P</italic>-value (<italic>P</italic> &#x0003c; 0.05), which measures the false-positive rate of each method.</p><p>Results of this study for <italic>d</italic> = 1000 are summarized in <xref ref-type="table" rid="bbt002-T2">Table 2</xref>.
<table-wrap id="bbt002-T2" position="float"><label>Table 2:</label><caption><p>False-positive rates for the self-contained hypothesis for varying level of correlation in the gene set observed for different methods of gene set analysis</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Method</th><th colspan="5" rowspan="1">Correlation <italic>r</italic> of genes in <italic>G</italic><hr/></th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">0</th><th rowspan="1" colspan="1">0.2</th><th rowspan="1" colspan="1">0.4</th><th rowspan="1" colspan="1">0.6</th><th rowspan="1" colspan="1">0.8</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Q1</td><td rowspan="1" colspan="1">0.05</td><td rowspan="1" colspan="1">0.096</td><td rowspan="1" colspan="1">0.178</td><td rowspan="1" colspan="1">0.22</td><td rowspan="1" colspan="1">0.282</td></tr><tr><td rowspan="1" colspan="1">GSEA</td><td rowspan="1" colspan="1">0.034</td><td rowspan="1" colspan="1">0.07</td><td rowspan="1" colspan="1">0.066</td><td rowspan="1" colspan="1">0.062</td><td rowspan="1" colspan="1">0.06</td></tr><tr><td rowspan="1" colspan="1">GSA</td><td rowspan="1" colspan="1">0.056</td><td rowspan="1" colspan="1">0.072</td><td rowspan="1" colspan="1">0.07</td><td rowspan="1" colspan="1">0.086</td><td rowspan="1" colspan="1">0.096</td></tr><tr><td rowspan="1" colspan="1">GSA2</td><td rowspan="1" colspan="1">0.05</td><td rowspan="1" colspan="1">0.057</td><td rowspan="1" colspan="1">0.047</td><td rowspan="1" colspan="1">0.06</td><td rowspan="1" colspan="1">0.05</td></tr><tr><td rowspan="1" colspan="1">SAFE</td><td rowspan="1" colspan="1">0.053</td><td rowspan="1" colspan="1">0.043</td><td rowspan="1" colspan="1">0.06</td><td rowspan="1" colspan="1">0.04</td><td rowspan="1" colspan="1">0.057</td></tr><tr><td rowspan="1" colspan="1">Globaltest</td><td rowspan="1" colspan="1">0.05</td><td rowspan="1" colspan="1">0.036</td><td rowspan="1" colspan="1">0.038</td><td rowspan="1" colspan="1">0.062</td><td rowspan="1" colspan="1">0.066</td></tr><tr><td rowspan="1" colspan="1">Q2</td><td rowspan="1" colspan="1">0.054</td><td rowspan="1" colspan="1">0.034</td><td rowspan="1" colspan="1">0.046</td><td rowspan="1" colspan="1">0.044</td><td rowspan="1" colspan="1">0.05</td></tr><tr><td rowspan="1" colspan="1">ES.SC</td><td rowspan="1" colspan="1">0.048</td><td rowspan="1" colspan="1">0.052</td><td rowspan="1" colspan="1">0.054</td><td rowspan="1" colspan="1">0.052</td><td rowspan="1" colspan="1">0.054</td></tr><tr><td rowspan="1" colspan="1">ES.SC Analytic</td><td rowspan="1" colspan="1">0.044</td><td rowspan="1" colspan="1">0.13</td><td rowspan="1" colspan="1">0.318</td><td rowspan="1" colspan="1">0.556</td><td rowspan="1" colspan="1">0.822</td></tr><tr><td rowspan="1" colspan="1">PAGE</td><td rowspan="1" colspan="1">0.03</td><td rowspan="1" colspan="1">0.148</td><td rowspan="1" colspan="1">0.32</td><td rowspan="1" colspan="1">0.606</td><td rowspan="1" colspan="1">0.702</td></tr><tr><td rowspan="1" colspan="1">CATEGORY</td><td rowspan="1" colspan="1">0.066</td><td rowspan="1" colspan="1">0.482</td><td rowspan="1" colspan="1">0.632</td><td rowspan="1" colspan="1">0.682</td><td rowspan="1" colspan="1">0.772</td></tr><tr><td rowspan="1" colspan="1">PAR Wilcoxon</td><td rowspan="1" colspan="1">0.056</td><td rowspan="1" colspan="1">0.516</td><td rowspan="1" colspan="1">0.644</td><td rowspan="1" colspan="1">0.716</td><td rowspan="1" colspan="1">0.802</td></tr></tbody></table><table-wrap-foot><fn id="bbt002-TF1"><p>Methods are denoted as in <xref ref-type="table" rid="bbt002-T1">Table 1</xref>. The following specific settings of the methods were used: SAFE uses the Wilcoxon statistic; Globaltest uses the asymptotic null distribution; ES.SC uses null distribution based on permutation of samples; ES.SC Analytic uses the Kolmogorov&#x02013;Smirnov null distribution; GSA uses all genes in the data set for re-standardization; GSA2 is the modified version of GSA with the <italic>P</italic>-value based on <xref ref-type="disp-formula" rid="bbt002-M6">Equation (6)</xref>. PAR Wilcoxon is the parametric method suggested by Irizarry <italic>et al.</italic> [<xref rid="bbt002-B16" ref-type="bibr">16</xref>], see last row in <xref ref-type="table" rid="bbt002-T1">Table 1</xref>.</p></fn></table-wrap-foot></table-wrap></p><p>As the gene sets contained no differentially expressed genes, the false-positive rate of 5% was expected. It can be clearly seen that the methods based on Models 2 and 3 generate excessive number of false-positive results, with the effect increasing with growing correlation between genes in <italic>G</italic>. Hence, gene sets declared as significant by these methods may only include correlated genes, with no genes associated with the target. Type I error of the methods based on Models 1 and 4 is not affected by the correlation in the gene set. We also observe that for correlated genes, the GSA method tends to produce slightly more false-positive results than expected. This may seem surprising considering the fact that the method uses sample randomization. However, the problem can be accounted for by observing that the GSA sample permutation procedure [<xref ref-type="disp-formula" rid="bbt002-M2">Equation (2)</xref>, valid for <italic>S</italic> being the mean gene score of the mean absolute gene score) does not actually produce the empirical null distribution of the test statistic <inline-formula><inline-graphic xlink:href="bbt002i98.jpg"/></inline-formula>, which is required to estimate the <italic>P</italic>-value, but rather of the quantity <inline-formula><inline-graphic xlink:href="bbt002i99.jpg"/></inline-formula>. The same remark is true when the maxmean <inline-formula><inline-graphic xlink:href="bbt002i100.jpg"/></inline-formula> is used as the test statistic (as in our simulation studies). To confirm this, we repeated the simulation with the GSA <italic>P</italic>-value calculated according to <xref ref-type="disp-formula" rid="bbt002-M6">Equation (6)</xref>, with the test statistic taken as the mean gene score, and observed the expected Type I error of &#x0223c;5%, whereas the original Type I error for this statistic also exceeded 5%. This modified version of the GSA based on <xref ref-type="disp-formula" rid="bbt002-M6">Equation (6)</xref> is included in our simulation studies as GSA2.</p><p>We repeated the study for <italic>d</italic> = 100 and observed that Type I error decreased only for the PAGE and PAR Wilcoxon methods (e.g. the error for PAGE under correlation 0 to 0.8 decreased to 0.008, 0.052, 0.154, 0.368, 0.568, respectively). For all the other methods, Type I error is not affected by the total number of genes <italic>d</italic>.</p><p>In experiment 2, we assume that <italic>n.DE</italic> out of <italic>m</italic> genes in <italic>G</italic> is differentially expressed and correlated. We divide the samples into two groups of 15 samples and generate expression of the <italic>n.DE</italic> genes in the first group from the multivariate normal distribution with the mean 0, and in the second group with the mean equal &#x00394;. The covariance matrix for both groups has diagonal elements equal 1 and non-diagonal elements equal <italic>r</italic>. The remaining <italic>m &#x02212; n.DE</italic> genes in <italic>G</italic> and the <italic>d &#x02212; m</italic> genes in <italic>G<sup>C</sup></italic> are not correlated and not differentially expressed and come from N(0,1).</p><p>In this study, we compare the power of different methods as a function of the number of differentially expressed genes (<italic>n.DE</italic> = 2, 5, 10, 40), the effect strength (&#x00394; = 0.5, 1, 1.5) and correlation <italic>r</italic>. We measure power as the fraction of replications of the experiment, which produce <italic>P</italic>-value &#x0003c; 0.05, i.e. declare the gene set as significant.</p><p>Results are summarized in <xref ref-type="fig" rid="bbt002-F1 bbt002-F2 bbt002-F3">Figures 1&#x02013;3</xref>.
<fig id="bbt002-F1" position="float"><label>Figure 1:</label><caption><p>Power of selected methods as a function of correlation and the number of differentially expressed genes (<italic>n.DE</italic>) in the gene set. Small effect, &#x00394; = 0.5. Number of genes <italic>d</italic> = 1000.</p></caption><graphic xlink:href="bbt002f1p"/></fig>
<fig id="bbt002-F2" position="float"><label>Figure 2:</label><caption><p>Power of selected methods as a function of correlation and the number of differentially expressed genes (<italic>n.DE</italic>) in the gene set. Medium effect, &#x00394; = 1. Number of genes <italic>d</italic> = 1000.</p></caption><graphic xlink:href="bbt002f2p"/></fig>
<fig id="bbt002-F3" position="float"><label>Figure 3:</label><caption><p>Power of selected methods as a function of correlation and the number of differentially expressed genes (<italic>n.DE</italic>) in the gene set. Strong effect, &#x00394; = 1.5. Number of genes <italic>d</italic> = 1000.</p></caption><graphic xlink:href="bbt002f3p"/></fig></p><p>We focus only on the methods that use sample randomization: Globaltest, FCS.SC, ES.SC (methods based on Model 1), GSEA, SAFE (methods based on Model 4) and GSA. We do not consider methods based on gene randomization or parametric models (i.e. methods based on Models 2 and 3), as they tend to produce excessive number of false-positive results from data with only correlated but no differentially expressed genes.</p><p>It can be clearly seen that if only a small fraction of genes in the gene set is associated with the phenotype, then the methods considerably differ in power, with the Globaltest, GSEA and GSA consistently showing higher power than the remaining methods (e.g. <xref ref-type="fig" rid="bbt002-F3">Figure 3</xref>, bottom right panel). We also observe that for small effect (<xref ref-type="fig" rid="bbt002-F1">Figure 1</xref>), GSA demonstrates slightly better power than other methods, whereas for medium (<xref ref-type="fig" rid="bbt002-F2">Figure 2</xref>) and strong effects (<xref ref-type="fig" rid="bbt002-F3">Figure 3</xref>), the Globaltest outperforms other methods. Our study also confirms that the Globaltest tends to declare as significant the gene sets with few differentially expressed genes with strong effect (<xref ref-type="fig" rid="bbt002-F3">Figure 3</xref>, bottom left panel). This high power is not necessarily a desirable feature, if the purpose of analysis is to find gene sets with moderate, but consistent, effect observed over many genes. Finally, we observed sensitivity of the results to the total number of genes <italic>d</italic>. In <xref ref-type="fig" rid="bbt002-F4">Figure 4</xref>, we compare power of competitive methods for <italic>d</italic> = 1000 and <italic>d</italic> = 100 (we omit the self-contained methods, as their power is obviously not affected by <italic>d</italic>). We observe that increasing <italic>d</italic> (with <italic>m</italic> fixed) leads to higher power of competitive methods.
<fig id="bbt002-F4" position="float"><label>Figure 4:</label><caption><p>Power of sample randomization, competitive methods for different number of genes in the study <italic>d</italic> = 100 or <italic>d</italic> = 1000, as a function of correlation and the number of differentially expressed genes (<italic>n.DE</italic>) in the gene set. Medium effect, &#x00394; = 1.</p></caption><graphic xlink:href="bbt002f4p"/></fig></p><p>In experiment 3, we analyse the type I error under the competitive hypothesis. We focus here only on competitive or parametric methods that compare expression in <italic>G</italic> and in <italic>G<sup>C</sup></italic>, such as Q1, GSA, GSA2, GSEA, SAFE, PAGE and PAR Wilcoxon (<xref ref-type="table" rid="bbt002-T1">Tables 1</xref> and <xref ref-type="table" rid="bbt002-T2">2</xref>). We generated data with 30 samples divided into two groups of 15 samples, and 1000 genes divided into 50 gene sets each with 20 genes. We generated expression of all the genes from N(0,1), then in 30% randomly selected genes we added &#x00394; = 1 in the second group of samples. Hence, all the gene sets contained on average 30% (i.e. <italic>n.DE</italic> = 6) differentially expressed genes. In the first gene set (GS1), we allowed for correlation among the genes (i.e. expression in GS1 was generated from the multivariate normal distribution, as in the second experiment, with the effect size &#x00394; = 1 and <italic>n.DE</italic> = 6). In this study, we varied the correlation in GS1. We repeated the experiment 200 times and reported the fraction of replications of the experiment that produced <italic>P</italic>-value &#x0003c; 0.05 for GS1, i.e. declared the first gene set as significant in comparison with the remaining sets. This measures the type I error of the methods. Results for 30% (<italic>n.DE</italic> = 6) and 60% (<italic>n.DE</italic> = 12) differentially expressed genes in all gene sets are summarized in <xref ref-type="table" rid="bbt002-T3">Table 3</xref>. We observe that for uncorrelated genes in GS1, all the methods (with the exception of GSEA) control the type I error. However, correlated genes lead to increased type I error for the gene randomization (Q1) and parametric methods (PAGE and PAR Wilcoxon).
<table-wrap id="bbt002-T3" position="float"><label>Table 3:</label><caption><p>False-positive rates for the competitive hypothesis as a function of the average number of differentially expressed genes in all the gene sets (<italic>n.DE</italic>) and correlation in GS1</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Method</th><th rowspan="1" colspan="1"><italic>n.DE</italic></th><th colspan="5" rowspan="1">Correlation <italic>r</italic> of genes in GS1<hr/></th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">0</th><th rowspan="1" colspan="1">0.2</th><th rowspan="1" colspan="1">0.4</th><th rowspan="1" colspan="1">0.6</th><th rowspan="1" colspan="1">0.8</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Q1</td><td rowspan="7" colspan="1">6</td><td rowspan="1" colspan="1">0.005</td><td rowspan="1" colspan="1">0.01</td><td rowspan="1" colspan="1">0.055</td><td rowspan="1" colspan="1">0.035</td><td rowspan="1" colspan="1">0.095</td></tr><tr><td rowspan="1" colspan="1">GSEA</td><td rowspan="1" colspan="1">0.15</td><td rowspan="1" colspan="1">0.205</td><td rowspan="1" colspan="1">0.155</td><td rowspan="1" colspan="1">0.175</td><td rowspan="1" colspan="1">0.16</td></tr><tr><td rowspan="1" colspan="1">GSA</td><td rowspan="1" colspan="1">0.01</td><td rowspan="1" colspan="1">0.01</td><td rowspan="1" colspan="1">0.005</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.005</td></tr><tr><td rowspan="1" colspan="1">GSA2</td><td rowspan="1" colspan="1">0.01</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.005</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">SAFE</td><td rowspan="1" colspan="1">0.01</td><td rowspan="1" colspan="1">0.01</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">PAGE</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.005</td><td rowspan="1" colspan="1">0.035</td><td rowspan="1" colspan="1">0.045</td><td rowspan="1" colspan="1">0.09</td></tr><tr><td rowspan="1" colspan="1">PAR Wilcoxon</td><td rowspan="1" colspan="1">0.005</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.02</td><td rowspan="1" colspan="1">0.01</td><td rowspan="1" colspan="1">0.01</td></tr><tr><td rowspan="1" colspan="1">Q1</td><td rowspan="7" colspan="1">12</td><td rowspan="1" colspan="1">0.01</td><td rowspan="1" colspan="1">0.065</td><td rowspan="1" colspan="1">0.09</td><td rowspan="1" colspan="1">0.115</td><td rowspan="1" colspan="1">0.175</td></tr><tr><td rowspan="1" colspan="1">GSEA</td><td rowspan="1" colspan="1">0.04</td><td rowspan="1" colspan="1">0.085</td><td rowspan="1" colspan="1">0.075</td><td rowspan="1" colspan="1">0.09</td><td rowspan="1" colspan="1">0.075</td></tr><tr><td rowspan="1" colspan="1">GSA</td><td rowspan="1" colspan="1">0.02</td><td rowspan="1" colspan="1">0.02</td><td rowspan="1" colspan="1">0.005</td><td rowspan="1" colspan="1">0.03</td><td rowspan="1" colspan="1">0.005</td></tr><tr><td rowspan="1" colspan="1">GSA2</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.02</td><td rowspan="1" colspan="1">0.025</td><td rowspan="1" colspan="1">0.02</td><td rowspan="1" colspan="1">0.01</td></tr><tr><td rowspan="1" colspan="1">SAFE</td><td rowspan="1" colspan="1">0.005</td><td rowspan="1" colspan="1">0.01</td><td rowspan="1" colspan="1">0.01</td><td rowspan="1" colspan="1">0.025</td><td rowspan="1" colspan="1">0.035</td></tr><tr><td rowspan="1" colspan="1">PAGE</td><td rowspan="1" colspan="1">0.005</td><td rowspan="1" colspan="1">0.07</td><td rowspan="1" colspan="1">0.15</td><td rowspan="1" colspan="1">0.26</td><td rowspan="1" colspan="1">0.285</td></tr><tr><td rowspan="1" colspan="1">PAR Wilcoxon</td><td rowspan="1" colspan="1">0.005</td><td rowspan="1" colspan="1">0.02</td><td rowspan="1" colspan="1">0.115</td><td rowspan="1" colspan="1">0.175</td><td rowspan="1" colspan="1">0.245</td></tr></tbody></table></table-wrap></p><p>In experiment 4, we want to compare power of different methods when the data contains many differentially expressed gene sets, with some of the gene sets significantly more differentially expressed. We focus here only on the methods analysed in experiment 3. We used the same data as in experiment 3 with 30% of differentially expressed genes in the gene sets 2 through 50; however, we varied the number of differentially expressed genes in GS1 (<italic>n.DE</italic> = 6, 12, 18). We repeated the experiment 200 times and reported the fraction of replications of the experiment, which produced <italic>P</italic>-value &#x0003c; 0.05 for GS1, i.e. declared the first gene set as significant in comparison with the remaining sets (we refer to this as &#x02018;power&#x02019; of the methods). Results are summarized in <xref ref-type="fig" rid="bbt002-F5">Figure 5</xref>. We observe that for <italic>n.DE</italic> = 6, the GS1 is not regarded as significantly enriched by most of the methods, even if the differentially expressed genes are correlated. Only the GSEA tends to declare GS1 as significant (in 10&#x02013;20% replications of the experiment), as it probably measures both association with the target and enrichment. As expected, with increasing <italic>n.DE</italic>, the methods recognize GS1 as enriched; however, in our study, GSEA seems to have highest power (<xref ref-type="fig" rid="bbt002-F5">Figure 5</xref>, bottom left panel). Interestingly, if the differentially expressed genes are correlated, GSA, GSEA and SAFE seem to lose power. We observe that GSA2 [the modified version of GSA based on <xref ref-type="disp-formula" rid="bbt002-M6">Equation (6)</xref>] generally realized higher power than the original GSA. To illustrate peculiarities of some test statistics, we also demonstrated the case where the gene set of interest contains fewer genes associated with the target then the remaining gene sets (point <italic>n.DE</italic> = 0 in <xref ref-type="fig" rid="bbt002-F5">Figure 5</xref>). We observe that PAGE, SAFE and PAR Wilcoxon (proposed by Irizarry <italic>et al.</italic> [<xref rid="bbt002-B16" ref-type="bibr">16</xref>]) declare GS1 as significant, although it contains no differentially expressed genes. Clearly, these methods signal that the pattern of expression in the gene set is different than in the remaining sets, and not necessarily that the gene set is enhanced.
<fig id="bbt002-F5" position="float"><label>Figure 5:</label><caption><p>Power of methods comparing expression in GS1 with expression in the remaining gene sets as a function of the number of differentially expressed genes in GS1 (<italic>n.DE</italic>) and their correlation.</p></caption><graphic xlink:href="bbt002f5p"/></fig></p></sec><sec sec-type="conclusions"><title>CONCLUSION</title><p>In this article, we analysed the models of statistical experiment that underlie commonly used methods of gene-set analysis. We showed that only the self-contained methods and competitive methods that use sample randomization to generate the null distribution are based on the models of experiment that closely follow organization of the actual biological study. Thus, these methods produce statistically sound results, albeit under slightly different null hypotheses. Other gene-set analysis methods, those based on simplifying parametric assumptions or on gene randomization, either rely on unrealistic assumptions pertaining to distribution of genes or, additionally, compare random variables, whose biological interpretation is unclear. We must also note that popular competitive methods (such as GSEA or SAFE) do not, strictly, test the competitive null hypothesis, as formulated by Goeman <italic>et al.</italic> A significant result from these methods does not necessarily mean that the gene set of interest contains more genes associated with the phenotype than its complement, but it rather means that either the gene set or its complement are associated with the phenotype.</p><p>Although we do not want to recommend one, best method of gene set analysis, based on this work we could suggest the Globaltest, GSA or GSEA as the preferable tools for gene-set analysis studies. These methods produce biologically interpretable <italic>P</italic>-values and realize higher power than other sample-randomization methods compared in this article. We observe, however, that significant results from the Globaltest may be because of only a few genes strongly associated with the target. GSA or GSEA methods seem to be less powerful for such data, which seems to be an advantage of these methods.</p><p>Finally, we want to point that when comparing results produced by different methods or considering the application of some methods, it seems advisable to consider the actual statistical model implied by the method, as small <italic>P</italic>-values produced by gene-randomization or parametric methods do not necessarily imply that the gene set is enhanced.</p><p><boxed-text id="bbt002-BOX1" position="float"><caption><title>Key Points</title></caption><p>
<list list-type="bullet"><list-item><p>Out of the vast collection of gene-set analysis approaches, only the self-contained methods and competitive methods that use sample randomization to generate the null distribution are based on the models of experiment, which closely follow organization of the actual biological study.</p></list-item><list-item><p>Popular competitive methods (such as GSEA or SAFE) do not test the competitive null hypothesis, as formulated by Goeman <italic>et al.</italic> A significant result from these methods does not necessarily mean that the gene set of interest contains more genes associated with the phenotype than its complement, but it rather means that either the gene set or its complement are associated with the phenotype.</p></list-item><list-item><p>Competitive methods that use gene randomization can produce biologically meaningful results, although the results cannot be formulated using the concept of statistical significance or a <italic>P</italic>-value. A heuristic measure of similarity of differential expression patterns in the gene set and its complement can be used instead.</p></list-item></list>
</p></boxed-text></p></sec><sec><title>FUNDING</title><p><funding-source>National Science Centre of Poland</funding-source> (grant <award-id>N516 510239</award-id>).</p></sec></body><back><bio id="d35e36"><p><bold>Henryk Maciejewski</bold> is an assistant professor at the Institute of Computer Engineering, Control and Robotics of the Wroclaw University of Technology. His research interests are mainly in machine learning and bioinformatics.</p></bio><ref-list><title>References</title><ref id="bbt002-B1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Subramanian</surname><given-names>A</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name><name><surname>Mootha</surname><given-names>VK</given-names></name><etal/></person-group><article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title><source>Proc Natl Acad Sci USA</source><year>2005</year><volume>102</volume><issue>43</issue><fpage>15545</fpage><lpage>50</lpage><pub-id pub-id-type="pmid">16199517</pub-id></element-citation></ref><ref id="bbt002-B2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ein-Dor</surname><given-names>L</given-names></name><name><surname>Kela</surname><given-names>I</given-names></name><name><surname>Getz</surname><given-names>G</given-names></name><etal/></person-group><article-title>Outcome signature genes in breast cancer: is there a unique set?</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><issue>2</issue><fpage>171</fpage><lpage>8</lpage><pub-id pub-id-type="pmid">15308542</pub-id></element-citation></ref><ref id="bbt002-B3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ein-Dor</surname><given-names>L</given-names></name><name><surname>Yuk</surname><given-names>O</given-names></name><name><surname>Domany</surname><given-names>E</given-names></name></person-group><article-title>Thousands of samples are needed to generate a robust gene list for predicting outcome of cancer</article-title><source>Proc Natl Acad Sci USA</source><year>2006</year><volume>103</volume><issue>15</issue><fpage>5923</fpage><lpage>28</lpage><pub-id pub-id-type="pmid">16585533</pub-id></element-citation></ref><ref id="bbt002-B4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nam</surname><given-names>D</given-names></name><name><surname>Kim</surname><given-names>SY</given-names></name></person-group><article-title>Gene-set approach for expression pattern analysis</article-title><source>Brief Bioinform</source><year>2008</year><volume>9</volume><issue>3</issue><fpage>189</fpage><lpage>97</lpage><pub-id pub-id-type="pmid">18202032</pub-id></element-citation></ref><ref id="bbt002-B5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goeman</surname><given-names>JJ</given-names></name><name><surname>van de Geer</surname><given-names>SA</given-names></name><name><surname>de Kort</surname><given-names>F</given-names></name><etal/></person-group><article-title>A global test for groups of genes: testing association with clinical outcome</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><issue>1</issue><fpage>93</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">14693814</pub-id></element-citation></ref><ref id="bbt002-B6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goeman</surname><given-names>JJ</given-names></name><name><surname>Oosting</surname><given-names>J</given-names></name><name><surname>Cleton-Jansen</surname><given-names>AM</given-names></name><etal/></person-group><article-title>Testing association of a pathway with survival using gene expression data</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><issue>9</issue><fpage>1950</fpage><lpage>7</lpage><pub-id pub-id-type="pmid">15657105</pub-id></element-citation></ref><ref id="bbt002-B7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mansmann</surname><given-names>U</given-names></name><name><surname>Meister</surname><given-names>R</given-names></name></person-group><article-title>Testing differential gene expression in functional groups&#x02014;Goeman&#x02019;s global test versus an ANCOVA approach</article-title><source>Methods Inf Med</source><year>2005</year><volume>44</volume><fpage>449</fpage><lpage>53</lpage><pub-id pub-id-type="pmid">16113772</pub-id></element-citation></ref><ref id="bbt002-B8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fridley</surname><given-names>BL</given-names></name><name><surname>Jenkins</surname><given-names>GD</given-names></name><name><surname>Biernacka</surname><given-names>JM</given-names></name></person-group><article-title>Self-contained gene-set analysis of expression data: an evaluation of existing and novel methods</article-title><source>PLoS One</source><year>2010</year><volume>5</volume><issue>9</issue><fpage>e12693</fpage><pub-id pub-id-type="pmid">20862301</pub-id></element-citation></ref><ref id="bbt002-B9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Efron</surname><given-names>B</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name></person-group><article-title>On testing the significance of sets of genes</article-title><source>Ann Appl Stat</source><year>2007</year><volume>1</volume><issue>1</issue><fpage>107</fpage><lpage>29</lpage></element-citation></ref><ref id="bbt002-B10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barry</surname><given-names>WT</given-names></name><name><surname>Nobel</surname><given-names>AB</given-names></name><name><surname>Wright</surname><given-names>FA</given-names></name></person-group><article-title>Significance analysis of functional categories in gene expression studies: a structured permutation approach</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><issue>9</issue><fpage>1943</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">15647293</pub-id></element-citation></ref><ref id="bbt002-B11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newton</surname><given-names>MA</given-names></name><name><surname>Quintana</surname><given-names>FA</given-names></name><name><surname>den Boon</surname><given-names>JA</given-names></name></person-group><article-title>Random set methods identify distinct aspects of the enrichment signal in gene-set analysis</article-title><source>Ann Appl Stat</source><year>2007</year><volume>1</volume><issue>1</issue><fpage>85</fpage><lpage>106</lpage></element-citation></ref><ref id="bbt002-B12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goeman</surname><given-names>JJ</given-names></name><name><surname>Buehlmann</surname><given-names>P</given-names></name></person-group><article-title>Analyzing gene expression data in terms of gene sets: methodological issues</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><issue>8</issue><fpage>980</fpage><lpage>7</lpage><pub-id pub-id-type="pmid">17303618</pub-id></element-citation></ref><ref id="bbt002-B13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pavlidis</surname><given-names>P</given-names></name><name><surname>Lewis</surname><given-names>DP</given-names></name><name><surname>Noble</surname><given-names>WS</given-names></name></person-group><article-title>Exploring gene expression data with class scores</article-title><source>Pac Symp Biocomput</source><year>2002</year><volume>7</volume><fpage>474</fpage><lpage>85</lpage><pub-id pub-id-type="pmid">11928500</pub-id></element-citation></ref><ref id="bbt002-B14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>L</given-names></name><name><surname>Greenberg</surname><given-names>SA</given-names></name><name><surname>Kong</surname><given-names>SW</given-names></name><etal/></person-group><article-title>Discovering statistically significant pathways in expression profiling studies</article-title><source>Proc Natl Acad Sci USA</source><year>2005</year><volume>102</volume><issue>38</issue><fpage>13544</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">16174746</pub-id></element-citation></ref><ref id="bbt002-B15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>SY</given-names></name><name><surname>Volsky</surname><given-names>DJ</given-names></name></person-group><article-title>PAGE: parametric analysis of gene set enrichment</article-title><source>BMC Bioinformatics</source><year>2005</year><volume>6</volume><fpage>144</fpage><pub-id pub-id-type="pmid">15941488</pub-id></element-citation></ref><ref id="bbt002-B16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Irizarry</surname><given-names>RA</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Zhou</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Gene set enrichment analysis made simple</article-title><source>Stat Methods Med Res</source><year>2009</year><volume>18</volume><issue>6</issue><fpage>565</fpage><lpage>75</lpage><pub-id pub-id-type="pmid">20048385</pub-id></element-citation></ref><ref id="bbt002-B17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Q</given-names></name><name><surname>Dinu</surname><given-names>I</given-names></name><name><surname>Adewale</surname><given-names>AJ</given-names></name><etal/></person-group><article-title>Comparative evaluation of gene set analysis methods</article-title><source>BMC Bioinformatics</source><year>2007</year><volume>8</volume><fpage>431</fpage><pub-id pub-id-type="pmid">17988400</pub-id></element-citation></ref><ref id="bbt002-B18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>S</given-names></name><name><surname>Black</surname><given-names>MA</given-names></name></person-group><article-title>Microarray-based gene set analysis: a comparison of current methods</article-title><source>BMC Bioinformatics</source><year>2008</year><volume>9</volume><fpage>502</fpage><pub-id pub-id-type="pmid">19038052</pub-id></element-citation></ref><ref id="bbt002-B19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dinu</surname><given-names>I</given-names></name><name><surname>Liu</surname><given-names>Q</given-names></name><name><surname>Potter</surname><given-names>JD</given-names></name><etal/></person-group><article-title>A biological evaluation of six gene set analysis methods for identification of differentially expressed pathways in microarray data</article-title><source>Cancer Inform</source><year>2008</year><volume>6</volume><fpage>357</fpage><lpage>68</lpage><pub-id pub-id-type="pmid">19259416</pub-id></element-citation></ref><ref id="bbt002-B20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>MC</given-names></name><name><surname>Lin</surname><given-names>X</given-names></name></person-group><article-title>Prior biological knowledge-based approaches for the analysis of genome-wide expression profiles using gene sets and pathways</article-title><source>Stat Methods Med Res</source><year>2009</year><volume>18</volume><issue>6</issue><fpage>577</fpage><lpage>93</lpage><pub-id pub-id-type="pmid">20048386</pub-id></element-citation></ref><ref id="bbt002-B21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ackermann</surname><given-names>M</given-names></name><name><surname>Strimmer</surname><given-names>K</given-names></name></person-group><article-title>A general modular framework for gene set enrichment analysis</article-title><source>BMC Bioinformatics</source><year>2009</year><volume>10</volume><fpage>47</fpage><pub-id pub-id-type="pmid">19192285</pub-id></element-citation></ref><ref id="bbt002-B22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hung</surname><given-names>JH</given-names></name><name><surname>Yang</surname><given-names>TH</given-names></name><name><surname>Hu</surname><given-names>Z</given-names></name><etal/></person-group><article-title>Gene set enrichment analysis: performance evaluation and usage guidelines</article-title><source>Brief Bioinform</source><year>2012</year><volume>13</volume><issue>3</issue><fpage>281</fpage><lpage>91</lpage><pub-id pub-id-type="pmid">21900207</pub-id></element-citation></ref><ref id="bbt002-B23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mootha</surname><given-names>VK</given-names></name><name><surname>Lindgren</surname><given-names>CM</given-names></name><name><surname>Eriksson</surname><given-names>KF</given-names></name><etal/></person-group><article-title>PGC-1&#x003b1;-responsive genes involved in oxidative phosphorylation are coordinately downregulated in human diabetes</article-title><source>Nat Genet</source><year>2003</year><volume>34</volume><fpage>267</fpage><lpage>73</lpage><pub-id pub-id-type="pmid">12808457</pub-id></element-citation></ref><ref id="bbt002-B24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pavlidis</surname><given-names>P</given-names></name><name><surname>Qin</surname><given-names>J</given-names></name><name><surname>Arango</surname><given-names>V</given-names></name><etal/></person-group><article-title>Using the gene ontology for microarray data mining: a comparison of methods and application to age effect in human prefrontal cortex</article-title><source>Neurochem Res</source><year>2004</year><volume>29</volume><issue>6</issue><fpage>1213</fpage><lpage>22</lpage><pub-id pub-id-type="pmid">15176478</pub-id></element-citation></ref><ref id="bbt002-B25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>Y</given-names></name><name><surname>Gentleman</surname><given-names>R</given-names></name></person-group><article-title>Extensions to gene set enrichment</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><issue>3</issue><fpage>306</fpage><lpage>13</lpage><pub-id pub-id-type="pmid">17127676</pub-id></element-citation></ref><ref id="bbt002-B26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dinu</surname><given-names>I</given-names></name><name><surname>Potter</surname><given-names>JD</given-names></name><name><surname>Mueller</surname><given-names>T</given-names></name><etal/></person-group><article-title>Improving gene set analysis of microarray data by SAM-GS</article-title><source>BMC Bioinformatics</source><year>2007</year><volume>8</volume><fpage>242</fpage><pub-id pub-id-type="pmid">17612399</pub-id></element-citation></ref><ref id="bbt002-B27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kong</surname><given-names>SW</given-names></name><name><surname>Pu</surname><given-names>WT</given-names></name><name><surname>Park</surname><given-names>PJ</given-names></name></person-group><article-title>A multivariate approach for integrating genome-wide expression data and biological knowledge</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><issue>19</issue><fpage>2373</fpage><lpage>80</lpage><pub-id pub-id-type="pmid">16877751</pub-id></element-citation></ref></ref-list></back></article>