<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="en"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Res Notes</journal-id><journal-id journal-id-type="iso-abbrev">BMC Res Notes</journal-id><journal-title-group><journal-title>BMC Research Notes</journal-title></journal-title-group><issn pub-type="epub">1756-0500</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">22871049</article-id><article-id pub-id-type="pmc">3441902</article-id><article-id pub-id-type="publisher-id">1756-0500-5-419</article-id><article-id pub-id-type="doi">10.1186/1756-0500-5-419</article-id><article-categories><subj-group subj-group-type="heading"><subject>Technical Note</subject></subj-group></article-categories><title-group><article-title>Visualisation in imaging mass spectrometry using the minimum noise fraction transform</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="A1"><name><surname>Stone</surname><given-names>Glenn</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>g.stone@uws.edu.au</email></contrib><contrib contrib-type="author" id="A2"><name><surname>Clifford</surname><given-names>David</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>david.clifford@csiro.au</email></contrib><contrib contrib-type="author" id="A3"><name><surname>Gustafsson</surname><given-names>Johan OR</given-names></name><xref ref-type="aff" rid="I3">3</xref><email>ove.gustafsson@adelaide.edu.au</email></contrib><contrib contrib-type="author" id="A4"><name><surname>McColl</surname><given-names>Shaun R</given-names></name><xref ref-type="aff" rid="I3">3</xref><email>shaun.mccoll@adelaide.edu.au</email></contrib><contrib contrib-type="author" id="A5"><name><surname>Hoffmann</surname><given-names>Peter</given-names></name><xref ref-type="aff" rid="I3">3</xref><email>peter.hoffmann@adelaide.edu.au</email></contrib></contrib-group><aff id="I1"><label>1</label>School of Computing, Engineering and Mathematics, University of Western Sydney, Sydney, New South Wales, Australia</aff><aff id="I2"><label>2</label>Division of Mathematics, Informatics and Statistics, CSIRO, Brisbane, Queensland, Australia</aff><aff id="I3"><label>3</label>Adelaide Proteomics Centre, School of Molecular and Biomedical Science, The University of Adelaide, Adelaide, South Australia, Australia</aff><pub-date pub-type="collection"><year>2012</year></pub-date><pub-date pub-type="epub"><day>7</day><month>8</month><year>2012</year></pub-date><volume>5</volume><fpage>419</fpage><lpage>419</lpage><history><date date-type="received"><day>2</day><month>9</month><year>2011</year></date><date date-type="accepted"><day>25</day><month>7</month><year>2012</year></date></history><permissions><copyright-statement>Copyright &#x000a9;2012 Stone et al.; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2012</copyright-year><copyright-holder>Stone et al.; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xlink:href="http://www.biomedcentral.com/1756-0500/5/419"/><abstract><sec><title>Background</title><p>Imaging Mass Spectrometry (IMS) provides a means to measure the spatial distribution of biochemical features on the surface of a sectioned tissue sample. IMS datasets are typically huge and visualisation and subsequent analysis can be challenging. Principal component analysis (PCA) is one popular data reduction technique that has been used and we propose another; the minimum noise fraction (MNF) transform which is popular in remote sensing.</p></sec><sec><title>Findings</title><p>The MNF transform is able to extract spatially coherent information from IMS data. The MNF transform is implemented through an R-package which is available together with example data from <ext-link ext-link-type="uri" xlink:href="http://sta&#x0fb00;.scm.uws.edu.au/~glenn/&#x02216;#Software">http://sta&#x0fb00;.scm.uws.edu.au/&#x0223c;glenn/&#x02216;#Software</ext-link>.</p></sec><sec><title>Conclusions</title><p>In our example, the MNF transform was able to find additional images of interest. The extracted information forms a useful basis for subsequent analyses.</p></sec></abstract><kwd-group><kwd>Dimension reduction</kwd><kwd>MALDI imaging mass spectrometry</kwd><kwd>Image processing</kwd></kwd-group></article-meta></front><body><sec><title>Background</title><p>Imaging Mass Spectrometry (IMS) provides a means to measure the spatial distribution of drug metabolite, lipid, peptide and protein features on the surface of a sectioned tissue sample (see [<xref ref-type="bibr" rid="B1">1</xref>] and references therein). Typically, IMS methods utilise freshly frozen sections of tissue mounted onto conductive slides. These are coated with matrix followed by MALDI-ToF/ToF spectra acquisition at anywhere from hundreds to thousands of positions across a tissue, the spatial locations of which are annotated. For example, a section of coronal murine midbrain can generate more than &#x0223c;2000 spectra. Data acquisition at 0.1 GS/s over an m/z range 1000-26000 yields individual mass spectra with more than 11,000 plotted points. The resulting data set is enormous and thus difficult to process, visualise and analyse effectively.</p><p>The data can be thought of in two ways, firstly a set of mass spectra acquired at a spatial array of spots, and secondly as a <italic>stack</italic> of ion intensity maps, each map being akin to a low resolution image. Software such as Biomap and flexImaging (Bruker Daltonics) view IMS data as ion intensity maps and include features such as data normalisation and noise spectra exclusion (see Figure <xref ref-type="fig" rid="F1">1</xref>). However the choice of ion intensity maps to view is largely user driven and images are noisy. Further data analysis using external software packages is possible, for example, (ClinProTools for principal component analysis (PCA), hierarchical clustering (HC) of spectra, or spectral model generation [<xref ref-type="bibr" rid="B2">2</xref>-<xref ref-type="bibr" rid="B5">5</xref>]. Other analysis techniques used on IMS data include kriging of ion intensity maps [<xref ref-type="bibr" rid="B6">6</xref>] and supervised classification methods, for example, random forests [<xref ref-type="bibr" rid="B7">7</xref>].</p><fig id="F1" position="float"><label>Figure 1</label><caption><p><bold>Image(A)of coronal murine midbrain section, and ion intensity maps at m/z of 6719(B), 9980(C) and 14136(D).</bold> m/z are approximate, from flexImaging V2.1. Scale bar is 1 mm.</p></caption><graphic xlink:href="1756-0500-5-419-1"/></fig><p>Current methods typically use spectral features, not spatial information, to guide analysis. Hence the predominance of PCA and HC type approaches. We propose the use of the minimum noise fraction (MNF) transform [<xref ref-type="bibr" rid="B8">8</xref>] to, firstly, determine the most interesting spatial representations of IMS data, and secondly, form the basis of data reduction for subsequent analysis. The MNF transform has previously been used on hyper-spectral images of tissue samples [<xref ref-type="bibr" rid="B9">9</xref>] but this is the first use of such a technique on IMS data.</p></sec><sec><title>Findings</title><sec><title>Principal Components Analysis</title><p>Principal Components Analysis (PCA) treats the IMS data as a collection of spectra. Therefore, in PCA, the spatial structure of the spots is not relevant and so the data can be represented as a matrix <inline-formula><mml:math id="M1" name="1756-0500-5-419-i1" overflow="scroll"><mml:mi mathvariant="bold-script">&#x0d4b5;</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>ik</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math></inline-formula> where <italic>i</italic>=1,&#x02026;,<italic>n</italic> ranges over the spots on the tissue and <italic>k</italic>=1,&#x02026;,<italic>p</italic> ranges over the mass charge ratios in the mass spectrum. Let <italic>Z</italic>={<sub><italic>Z</italic><italic>k</italic></sub>} be a typical mass spectrum. PCA seeks linear combinations of intensities over the mass charge ratios that maximizes variance. That is, the first principal component is defined by a vector <italic>a</italic>={<sub><italic>a</italic><italic>k</italic></sub>} with <italic>a</italic> chosen so that Var(<sup><italic>a</italic><italic>t</italic></sup><italic>Z</italic>) is maximised. Second and subsequent principal components maximize variance subject to being uncorrelated with all previous principal components.</p><p>If <sub><italic>&#x003a3;</italic><italic>Z</italic></sub> is the covariance matrix of the mass spectra, that is, the (<sub><italic>k</italic>1</sub>,<sub><italic>k</italic>2</sub>) entry is the covariance of the ion intensity measured at the <italic>k</italic><sub>1</sub>-th m/z ratio and the ion intensity measured at the <italic>k</italic><sub>2</sub>-th m/z ratio, then the first principal component maximises <inline-formula><mml:math id="M2" name="1756-0500-5-419-i2" overflow="scroll"><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mi>a</mml:mi></mml:math></inline-formula> subject to a suitable scale constraint such as <sup><italic>a</italic><italic>t</italic></sup><italic>a</italic>=1. Generally, <sub><italic>&#x003a3;</italic><italic>Z</italic></sub>is unknown so is estimated using the sample covariance matrix <italic>S</italic><sub><italic>Z</italic></sub> given by </p><p><disp-formula id="bmcM1"><label>(1)</label><mml:math id="M3" name="1756-0500-5-419-i3" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math></disp-formula></p><p> where </p><p><disp-formula id="bmcM2"><label>(2)</label><mml:math id="M4" name="1756-0500-5-419-i4" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>It should be noted that the mass spectra are unlikely to form a set of independent observations since spatially close spectra will likely be correlated.</p></sec><sec><title>The MNF transform</title><p>PCA makes no use of the spatial structure of the observed mass spectra. The Minimum Noise Fraction transform uses a simple model to allow the spatial structure to influence the analysis. Here we modify the notation to emphasise the spatial aspect; let <italic>Z</italic>(<italic>x</italic>) be the mass spectrum at spatial location <italic>x</italic>. In our case, <italic>x</italic> will be a spot on the tissue section indexed by a horizontal and a vertical coordinate. A possible model for <italic>Z</italic>(<italic>x</italic>) is </p><p><disp-formula id="bmcM3"><label>(3)</label><mml:math id="M5" name="1756-0500-5-419-i5" overflow="scroll"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p><p> where <italic>M</italic>(<italic>x</italic>) represents the <italic>signal</italic> at <italic>x</italic> and <italic>N</italic>(<italic>x</italic>) is the <italic>noise</italic> at <italic>x</italic>.</p><p>This is to be interpreted as &#x0201c;the mass spectrum at spot <italic>x</italic> is composed of a spatial signal mass spectrum plus a noise mass spectrum&#x0201d;. We assume the signal and noise components to be independent, and the noise component to have low spatial covariance. The signal component would likely have high spatial covariance. Both components would still have a covariance between intensities at differing mass charge ratios, represented by covariance matrices <sub><italic>&#x003a3;</italic><italic>M</italic></sub> and <sub><italic>&#x003a3;</italic><italic>N</italic></sub>.</p><p>The MNF transform seeks linear combinations of intensities over the mass charge ratios that maximizes <italic>signal to noise ratio</italic> (SNR). That is, the first MNF band is defined by a vector <italic>a</italic>={<sub><italic>a</italic><italic>k</italic></sub>} with <italic>a</italic> chosen so that SNR=Var(<sup><italic>a</italic><italic>t</italic></sup><italic>M</italic>)/Var(<sup><italic>a</italic><italic>t</italic></sup><italic>N</italic>) is maximised. Replacing the variances by expressions in terms of the covariance matrices we see that; </p><p><disp-formula id="bmcM4"><label>(4)</label><mml:math id="M6" name="1756-0500-5-419-i6" overflow="scroll"><mml:mrow><mml:mtext>SNR</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>In PCA we need an estimate for <sub><italic>&#x003a3;</italic><italic>Z</italic></sub>, whereas for the MNF we need estimates of <sub><italic>&#x003a3;</italic><italic>M</italic></sub>and <sub><italic>&#x003a3;</italic><italic>N</italic></sub>. These are not as straight-forward to obtain as in PCA, since the signal <italic>M</italic> and noise <italic>N</italic> components are not directly observed. However, by noting that (by independence) <sub><italic>&#x003a3;</italic><italic>Z</italic></sub>=<sub><italic>&#x003a3;</italic><italic>M</italic></sub> + <sub><italic>&#x003a3;</italic><italic>N</italic></sub>we see that the SNR is maximised when the following ratio is maximised, </p><p><disp-formula id="bmcM5"><label>(5)</label><mml:math id="M7" name="1756-0500-5-419-i7" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>&#x003a3;</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>Thus only an estimate for <sub><italic>&#x003a3;</italic><italic>N</italic></sub> is required. In reality, only an estimate of <sub><italic>&#x003a3;</italic><italic>N</italic></sub><italic>or</italic><sub><italic>&#x003a3;</italic><italic>M</italic></sub> is required, and we find it easiest to estimate the former.</p><p>Green et al. [<xref ref-type="bibr" rid="B8">8</xref>] propose a <italic>shift difference</italic> method to estimate <sub><italic>&#x003a3;</italic><italic>N</italic></sub> and Berman et al. [<xref ref-type="bibr" rid="B9">9</xref>] propose using the covariance of residuals from a local quadratic fit. In the latter case, a quadratic function is fit to a 3&#x000d7;3 neighbourhood of each spot for each mass charge ratio, and a residual computed at the spot. This produces a set of pseudo-residual data and the sample covariance of this used as the estimate. These original applications of the MNF transform are based on hyperspectral images where the spots are very close together. Here the spots from which MS spectra are collected are somewhat separated. For this reason we have used a simpler local linear fit, based on the ideas of [<xref ref-type="bibr" rid="B10">10</xref>], which is similar to using a symmetrical set of shift differences. Using the simpler approach places less reliance on spots that are further apart. Although there is scope to investigate other approaches, preliminary work shows little difference when a quadratic signal fit is used in this case.</p><p>Each spot (except edge spots) has two horizontal and two vertical neighbours. Averaging these four values gives the prediction of a local linear fit at the central spot, from which a pseudo-residual can be derived. Since the spots are on a regular grid, this corresponds to the residual from a local linear fit to the four neighbouring spots. This procedure produces a set of pseudo-residuals (one for each spot at each mass charge ratio, subject to simple modification at edge spots) from which the sample noise covariance matrix <italic>S</italic><sub><italic>N</italic></sub> can be formed. We use this as the estimate of <sub><italic>&#x003a3;</italic><italic>N</italic></sub>.</p></sec><sec><title>Implementation</title><p>PCA corresponds to the maximisation of <inline-formula><mml:math id="M8" name="1756-0500-5-419-i8" overflow="scroll"><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mi>a</mml:mi></mml:math></inline-formula> subject to a scale constraint such as <sup><italic>a</italic><italic>t</italic></sup><italic>a</italic>=1. Lagrange multipliers can be used to show that at the maximum, <italic>a</italic> is the eigenvector of <italic>S</italic><sub><italic>Z</italic></sub> corresponding to the largest eigenvalue. Subsequent principal components are defined by eigenvectors corresponding to subsequent eigenvalues. A similar argument shows that the <italic>a</italic> which maximises the ratio </p><p><disp-formula id="bmcM6"><label>(6)</label><mml:math id="M9" name="1756-0500-5-419-i9" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mi>a</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p> satisfies </p><p><disp-formula id="bmcM7"><label>(7)</label><mml:math id="M10" name="1756-0500-5-419-i10" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>&#x003bb;</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mi>a</mml:mi></mml:mrow></mml:math></disp-formula></p><p>This is a <italic>generalised eigenproblem</italic> (see [<xref ref-type="bibr" rid="B11">11</xref>] for example).</p><p>For both PCA and MNF the uses of all mass charge ratios would produce sample covariance matrices that are extremely large, so firstly some pre-filtering is used. In PCA, this is often a peak identification method, or selection by taking all the mass charge ratios for which the intensity exceeds some threshold (in some or all spots). For the MNF transform, we use only those mass charge ratios whose SNR values exceed a threshold. This SNR corresponds to the ratio of diagonal entries in <italic>S</italic><sub><italic>Z</italic></sub> and <italic>S</italic><sub><italic>N</italic></sub>. The threshold is chosen so that the matrices are of a manageable size.</p><p>Our implementation uses the LAPACK [<xref ref-type="bibr" rid="B12">12</xref>] routines for generalised eigenproblem interfaced to the R system for statistical programming [<xref ref-type="bibr" rid="B13">13</xref>]. All aspects of this process are automated in our code. The only manual interventions required have to do with pre-filtering of the signals and the choice of the number of bands for subsequent analysis. Both of these manual interventions are required by PCA also.</p></sec><sec><title>Results</title><p>We demonstrate the method using a section of 10 <italic>&#x003bc;</italic>m coronal murine midbrain. The section was desiccated for 30 minutes followed by washing in 70% and 100% EtOH for 30 seconds each, and subsequently desiccated until use. 20 mg/mL of 2,5-dihydroxybenzoic acid in 50% MeOH and 0.2% TFA matrix was deposited using 3 phases on an ImagePrep station. Mass spectrometry analysis was carried out on an UltraFlex III MALDI-TOF/TOF machine in linear positive ion mode. ClinProT calibrants (1:20 dilution with matrix) were used to calibrate the instrument. Data acquisition used flexControl V3.3, with 300 shots taken at each spot and summed. Mass spectra were acquired in m/z range 1000&#x02013;26000 at a rate of 0.1 GS/s. Figure <xref ref-type="fig" rid="F1">1</xref> shows the image of the section (A) and flexImaging (Bruker Daltonics) generated ion intensity maps for three m/z ratios (B&#x02013;D).</p><p>The processed data consists of intensities at 11280 mass charge ratios, repeated across a grid of 2012 spots over the tissue slice. The data were first logged and then background corrected by using a 5-knot robust spline fit to estimate baseline. Pre-filtering of mass charge ratios was carried by thresholding intensities (in the case of PCA) or SNRs (in the case of MNF) so that 650 were retained. PCA and MNF transforms were computed. This means that PCA operated on the 650 mass charge ratios with the highest intensity, whereas MNF used the 650 mass charge ratios with the highest estimated signal to noise. The choice of 650 data points stems from trial and error and a pragmatic desire to use manageable covariance matrices.</p><p>Figure <xref ref-type="fig" rid="F2">2</xref> shows the first six principal component images of the data, there appears to be three images with significant spatial structure, and the remaining three appear to be noise.</p><fig id="F2" position="float"><label>Figure 2</label><caption><p>The first six principal component images of a coronal murine midbrain section.</p></caption><graphic xlink:href="1756-0500-5-419-1"/></fig><p>Figure <xref ref-type="fig" rid="F3">3</xref> shows the first six MNF bands. There are four images with clear spatial structure, so the MNF transform has been able to extract further information.</p><fig id="F3" position="float"><label>Figure 3</label><caption><p>The first six MNF transformed images of a coronal murine midbrain section.</p></caption><graphic xlink:href="1756-0500-5-419-3"/></fig></sec><sec><title>Subsequent Analysis</title><p>Deininger et al. [<xref ref-type="bibr" rid="B3">3</xref>] show the use of the principal components in hierarchical clustering, and this can also be done with the MNF bands. Hierarchical clustering is useful for identifying regions of the tissue with relatively homogenous properties. Using the PCA or MNF bands significantly reduces the computational complexity of clustering without overly reducing its usefulness.</p><p>Taking the first four MNF band images, and applying hierarchical clustering we can determine seven clusters. Figure <xref ref-type="fig" rid="F4">4</xref> shows the results. Panel A shows the spots coloured according to cluster and panel B shows the average mass spectrum for the spots in each cluster.</p><fig id="F4" position="float"><label>Figure 4</label><caption><p><bold>The results of clustering using the first four MNF bands.</bold><bold>(A)</bold> the clustering of spots (spots in the same cluster have the same colour), <bold>(B)</bold> the average (background corrected) mass spectrum for each cluster</p></caption><graphic xlink:href="1756-0500-5-419-1"/></fig><p>As with PCA, the choice of the number of MNF bands to use in subsequent analysis (such as hierarchical clustering) is somewhat ad-hoc and depends on the form of such analysis. For clustering and classification there are many methods for choosing the number of features but we regard this as a topic for further research.</p><p>In this instance the number of components chosen (six) was primarily chosen for convenience and subjective reasons. The 5th and 6th PCA plots still show some faint internal structure, whereas subsequent ones do not (not shown). So we use 6 components for both PCA and MNF for consistency.</p><p>More generally the number of PCA components <italic>can</italic> be chosen using percent total variation explained arguments. In this approach, the sum of the eigenvalues for the chosen components divided by the sum of <italic>all</italic> the eigenvalues, converted to a percentage, is considered. A threshold percent (eg. 80 or 90%) is then chosen and the number of principal components fixed at that which first exceeds the threshold. It is not so easy to apply this technique for MNF as the eigenvalues represent signal to noise ratios and as such are not additive. However, since they are signal to noise ratios, they are scale-free and can be subject to thresholds themselves ie. take all components with eigenvalue (signal-to-noise ratio) greater than a threshold. Examples of such a threshold might be one, ie. signal and noise are approximately equal.</p></sec></sec><sec sec-type="conclusions"><title>Conclusion</title><p>We have shown that the minimum noise fraction transform is a potent addition to the suite of analysis tools available for the analysis of Imaging Mass Spectrometry data. Like PCA, we have further demonstrated that the MNF bands generated can be used as summaries of the mass spectra to analyse the spatial characteristics of a tissue slice. We regard the MNF transform as providing a useful alternative to PCA in Imaging Mass Spectrometry. Its defining feature is that is uses estimates of spatial signal to noise ratio to sequentially define bands whereas PCA uses only total variation (signal plus noise).</p><p>Both PCA and MNF are computationally efficient when compared to the data acquisiton and preprocessing steps involved. In our implementation, all code was written in R and C and is therefore platform independent. However, the flexImaging provided data in a proprietary format that required the use of a Windows only proprietary tool (CompassXport). We have successfully used emulation software on Linux and Mac OS X based systems to run this tool.</p></sec><sec><title>Availability and requirements</title><p><bold>Project Name:</bold> Computing Minimum Noise Fraction Transforms of Imaging Mass Spectrometry Data;<bold>Project Home:</bold><ext-link ext-link-type="uri" xlink:href="http://sta&#x0fb00;.scm.uws.edu.au/~glenn/#Software">http://sta&#x0fb00;.scm.uws.edu.au/&#x0223c;glenn/#Software</ext-link>;<bold>Operating Systems:</bold> MNF code is in R and C and is compatible with Windows, Mac, and Linux;<bold>Programming Language:</bold> R, <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org">http://cran.r-project.org</ext-link> and C;<bold>Other Requirements:</bold> caMassClass,[<xref ref-type="bibr" rid="B14">14</xref>]; Data Acquistion and conversion software (flexImaging/CompassXport);<bold>License</bold> GPL-2;<bold>Restrictions to use by non-academics:</bold> none;</p></sec><sec><title>Availability of supporting data</title><p>The software and supporting data are available for download from the project home at <ext-link ext-link-type="uri" xlink:href="http://sta&#x0fb00;.scm.uws.edu.au/~glenn/#Software">http://sta&#x0fb00;.scm.uws.edu.au/&#x0223c;glenn/#Software</ext-link>.</p></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Author&#x02019;s contributions</title><p>GS and DC concieved the statistical approach. DC implemented the analysis. GS drafted the manuscript. JORG, SRM and PH developed the protocols, and obtained, prepared and processed the samples. All authors read and approved the final manuscript.</p></sec><sec><title>Funding</title><p>GS was employed by CSIRO when much of this work was carried out. The Adelaide Proteomics Centre was partially funded by Bioplatforms Australia and an NHMRC equipment grant.</p></sec></body><back><sec><title>Acknowledgements</title><p>The authors would like to thank Mike Buckley for providing critical feedback of an early draft of this manuscript.</p></sec><ref-list><ref id="B1"><mixed-citation publication-type="journal"><name><surname>Gustafsson</surname><given-names>J</given-names></name><name><surname>Oehler</surname><given-names>M</given-names></name><name><surname>Ruszkiewicz</surname><given-names>A</given-names></name><name><surname>McColl</surname><given-names>S</given-names></name><name><surname>Hoffmann</surname><given-names>P</given-names></name><article-title>MALDI imaging mass spectrometry (MALDI-IMS) &#x02014; Application of spatial proteomics for ovarian cancer classification and diagnosis</article-title><source>Int J Mol Sci</source><year>2011</year><volume>12</volume><fpage>773</fpage><lpage>794</lpage><pub-id pub-id-type="doi">10.3390/ijms12010773</pub-id><pub-id pub-id-type="pmid">21340013</pub-id></mixed-citation></ref><ref id="B2"><mixed-citation publication-type="journal"><name><surname>Beisinger</surname><given-names>M</given-names></name><name><surname>Paepegaey</surname><given-names>P</given-names></name><name><surname>McIntyre</surname><given-names>N</given-names></name><name><surname>Harbottle</surname><given-names>R</given-names></name><name><surname>Petersen</surname><given-names>N</given-names></name><article-title>Principal component analysis of TOF-SIMS images of organic monolayers</article-title><source>Anal Chem</source><year>2002</year><volume>74</volume><fpage>5711</fpage><lpage>5716</lpage><pub-id pub-id-type="doi">10.1021/ac020311n</pub-id><pub-id pub-id-type="pmid">12463353</pub-id></mixed-citation></ref><ref id="B3"><mixed-citation publication-type="journal"><name><surname>Deininger</surname><given-names>S</given-names></name><name><surname>Ebert</surname><given-names>M</given-names></name><name><surname>Futterer</surname><given-names>A</given-names></name><name><surname>Gerhard</surname><given-names>M</given-names></name><name><surname>Rocken</surname><given-names>C</given-names></name><article-title>MALDI imaging combined with hierarchical clustering as a new tool for the interpretation of complex human cancers</article-title><source>J Proteome Res</source><year>2008</year><volume>7</volume><fpage>5230</fpage><lpage>5236</lpage><pub-id pub-id-type="doi">10.1021/pr8005777</pub-id><pub-id pub-id-type="pmid">19367705</pub-id></mixed-citation></ref><ref id="B4"><mixed-citation publication-type="journal"><name><surname>Franck</surname><given-names>J</given-names></name><name><surname>Arafah</surname><given-names>K</given-names></name><name><surname>Elayed</surname><given-names>M</given-names></name><name><surname>Bonnel</surname><given-names>D</given-names></name><name><surname>Vergara</surname><given-names>D</given-names></name><name><surname>Jacquet</surname><given-names>A</given-names></name><name><surname>Vinatier</surname><given-names>D</given-names></name><name><surname>Wisztorski</surname><given-names>M</given-names></name><name><surname>Day</surname><given-names>R</given-names></name><name><surname>Fournier</surname><given-names>I</given-names></name><name><surname>Salzet</surname><given-names>M</given-names></name><article-title>MALDI imaging mass spectrometry</article-title><source>Mol Cell Proteomics</source><year>2009</year><volume>8.9</volume><fpage>2023</fpage><lpage>2033</lpage><pub-id pub-id-type="pmid">19451175</pub-id></mixed-citation></ref><ref id="B5"><mixed-citation publication-type="journal"><name><surname>Smentkowski</surname><given-names>V</given-names></name><name><surname>Ostrowski</surname><given-names>S</given-names></name><name><surname>Kollmer</surname><given-names>F</given-names></name><name><surname>Schnieders</surname><given-names>A</given-names></name><name><surname>Keenan</surname><given-names>M</given-names></name><name><surname>Ohlhausend</surname><given-names>J</given-names></name><name><surname>Kotulad</surname><given-names>P</given-names></name><article-title>Multivariate statistical analysis of non-mass-selected ToF-SIMS data</article-title><source>Surf Interface Anal</source><year>2005</year><volume>40</volume><fpage>1176</fpage><lpage>1182</lpage></mixed-citation></ref><ref id="B6"><mixed-citation publication-type="journal"><name><surname>Milillo</surname><given-names>T</given-names></name><name><surname>Gardella</surname><given-names>JJr</given-names></name><article-title>Spatial statistics and interpolation methods for TOF SIMS imaging</article-title><source>Appl Surf Sci</source><year>2006</year><volume>252</volume><fpage>6883</fpage><lpage>6890</lpage><pub-id pub-id-type="doi">10.1016/j.apsusc.2006.02.164</pub-id></mixed-citation></ref><ref id="B7"><mixed-citation publication-type="journal"><name><surname>Hanselmann</surname><given-names>M</given-names></name><name><surname>Kothe</surname><given-names>U</given-names></name><name><surname>Kirchner</surname><given-names>M</given-names></name><name><surname>Renard</surname><given-names>B</given-names></name><name><surname>Amstalden</surname><given-names>E</given-names></name><name><surname>Glunde</surname><given-names>K</given-names></name><name><surname>Heeren</surname><given-names>R</given-names></name><name><surname>Hamprecht</surname><given-names>F</given-names></name><article-title>Toward digital staining using imaging mass spectrometry and random forests</article-title><source>J Proteome Res</source><year>2009</year><volume>8</volume><issue>7</issue><fpage>3558</fpage><lpage>3567</lpage><pub-id pub-id-type="doi">10.1021/pr900253y</pub-id><pub-id pub-id-type="pmid">19469555</pub-id></mixed-citation></ref><ref id="B8"><mixed-citation publication-type="journal"><name><surname>Green</surname><given-names>A</given-names></name><name><surname>Berman</surname><given-names>M</given-names></name><name><surname>Switzer</surname><given-names>P</given-names></name><name><surname>Craig</surname><given-names>M</given-names></name><article-title>A transformation for ordering multispectral data in terms of image quality with implications for noise removal</article-title><source>IEEE Trans Geoscience Remote Sensing</source><year>1988</year><volume>26</volume><fpage>65</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1109/36.3001</pub-id></mixed-citation></ref><ref id="B9"><mixed-citation publication-type="journal"><name><surname>Berman</surname><given-names>M</given-names></name><name><surname>Phatak</surname><given-names>A</given-names></name><name><surname>Lagerstrom</surname><given-names>R</given-names></name><name><surname>Wood</surname><given-names>B</given-names></name><article-title>ICE: a new method for the multivariate curve resolution of hyperspectral images</article-title><source>J Chemom</source><year>2009</year><volume>23</volume><fpage>101</fpage><lpage>116</lpage><pub-id pub-id-type="doi">10.1002/cem.1198</pub-id></mixed-citation></ref><ref id="B10"><mixed-citation publication-type="journal"><name><surname>Buckley</surname><given-names>M</given-names></name><name><surname>Eagleson</surname><given-names>G</given-names></name><article-title>A graphical method for estimating the residual variance in nonparametric regression</article-title><source>Biometrika</source><year>1989</year><volume>76</volume><fpage>203</fpage><lpage>210</lpage><pub-id pub-id-type="doi">10.1093/biomet/76.2.203</pub-id></mixed-citation></ref><ref id="B11"><mixed-citation publication-type="book"><name><surname>Golub</surname><given-names>G</given-names></name><name><surname>Van</surname><given-names>Loan</given-names></name><source>Matrix Computations</source><year>1996</year><publisher-name>The Johns Hopkins University Press, Baltimore, Maryland</publisher-name></mixed-citation></ref><ref id="B12"><mixed-citation publication-type="book"><name><surname>Anderson</surname><given-names>E</given-names></name><name><surname>Bai</surname><given-names>Z</given-names></name><name><surname>Bischof</surname><given-names>C</given-names></name><name><surname>Blackford</surname><given-names>S</given-names></name><name><surname>Demmel</surname><given-names>J</given-names></name><name><surname>Dongarra</surname><given-names>J</given-names></name><name><surname>Du</surname><given-names>Croz</given-names></name><name><surname>Greenbaum</surname><given-names>A</given-names></name><name><surname>Hammarling</surname><given-names>S</given-names></name><name><surname>McKenney</surname><given-names>A</given-names></name><name><surname>Sorensen</surname><given-names>D</given-names></name><source>LAPACK Users&#x02019; Guide</source><year>1999</year><publisher-name>Society for Industrial and Applied Mathematics, Philadelphia, PA</publisher-name></mixed-citation></ref><ref id="B13"><mixed-citation publication-type="book"><collab>R Development Core Team</collab><source>R: A Language and Environment for Statistical Computing</source><year>2012</year><publisher-name>R Foundation for Statistical Computing, Vienna, Austria</publisher-name><comment><ext-link ext-link-type="uri" xlink:href="http://www.R-project.org/">http://www.R-project.org/</ext-link>. [ISBN 3-900051-07-0]</comment></mixed-citation></ref><ref id="B14"><mixed-citation publication-type="other"><name><surname>Tuszynski</surname><given-names>J</given-names></name><article-title>caMassClass: Processing &#x00026; Classification of Protein Mass Spectra (SELDI) Data</article-title><year>2010</year><comment><ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=caMassClass">http://CRAN.R-project.org/package=caMassClass</ext-link>. [R package version 1.9].</comment></mixed-citation></ref></ref-list></back></article>