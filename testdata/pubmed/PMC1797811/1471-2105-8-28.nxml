<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">17257426</article-id><article-id pub-id-type="pmc">1797811</article-id><article-id pub-id-type="publisher-id">1471-2105-8-28</article-id><article-id pub-id-type="doi">10.1186/1471-2105-8-28</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Detecting differential expression in microarray data: comparison of optimal procedures</article-title></title-group><contrib-group><contrib id="A1" equal-contrib="yes" contrib-type="author"><name><surname>Perelman</surname><given-names>Elena</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>lenaperelman@gmail.com</email></contrib><contrib id="A2" equal-contrib="yes" contrib-type="author"><name><surname>Ploner</surname><given-names>Alexander</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>alexander.ploner@ki.se</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Calza</surname><given-names>Stefano</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>calza@med.unibs.it</email></contrib><contrib id="A4" corresp="yes" contrib-type="author"><name><surname>Pawitan</surname><given-names>Yudi</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>yudi.pawitan@ki.se</email></contrib></contrib-group><aff id="I1"><label>1</label>Department of Medical Epidemiology and Biostatistics, Karolinska Institutet, 17177 Stockholm, Sweden</aff><aff id="I2"><label>2</label>Department of Biomedical Sciences and Biotechnologies, Brescia, Italy</aff><pub-date pub-type="collection"><year>2007</year></pub-date><pub-date pub-type="epub"><day>26</day><month>1</month><year>2007</year></pub-date><volume>8</volume><fpage>28</fpage><lpage>28</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/8/28"/><history><date date-type="received"><day>22</day><month>8</month><year>2006</year></date><date date-type="accepted"><day>26</day><month>1</month><year>2007</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2007 Perelman et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2007</copyright-year><copyright-holder>Perelman et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Perelman
               Elena
               
               lenaperelman@gmail.com
            </dc:author><dc:title>
            Detecting differential expression in microarray data: comparison of optimal procedures
         </dc:title><dc:date>2007</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 8(1): 28-. (2007)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2007)8:1&#x0003c;28&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Many procedures for finding differentially expressed genes in microarray data are based on classical or modified t-statistics. Due to multiple testing considerations, the false discovery rate (FDR) is the key tool for assessing the significance of these test statistics. Two recent papers have generalized two aspects: Storey et al. (2005) have introduced a likelihood ratio test statistic for two-sample situations that has desirable theoretical properties (optimal discovery procedure, ODP), but uses standard FDR assessment; Ploner et al. (2006) have introduced a multivariate local FDR that allows incorporation of standard error information, but uses the standard t-statistic (fdr2d). The relationship and relative performance of these methods in two-sample comparisons is currently unknown.</p></sec><sec sec-type="methods"><title>Methods</title><p>Using simulated and real datasets, we compare the ODP and fdr2d procedures. We also introduce a new procedure called S2d that combines the ODP test statistic with the extended FDR assessment of fdr2d.</p></sec><sec><title>Results</title><p>For both simulated and real datasets, fdr2d performs better than ODP. As expected, both methods perform better than a standard t-statistic with standard local FDR. The new procedure S2d performs as well as fdr2d on simulated data, but performs better on the real data sets.</p></sec><sec><title>Conclusion</title><p>The ODP can be improved by including the standard error information as in fdr2d. This means that the optimality enjoyed in theory by ODP does not hold for the estimated version that has to be used in practice. The new procedure S2d has a slight advantage over fdr2d, which has to be balanced against a significantly higher computational effort and a less intuititive test statistic.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>High-throughput methods in molecular biology have challenged existing data analysis methods and stimulated the development of new methods. A key example is the gene expression microarray and its use as a screening tool for detecting genes that are differentially expressed (DE) between different biological states. The need to identify a possibly very small number of regulated genes among the 10,000s of sequences found on modern microarray chips, based on tens to hundreds of biological samples, has led to a plethora of different methods. The emerging consensus in the field [<xref ref-type="bibr" rid="B1">1</xref>] suggests that a) despite ongoing research on p-value adjustments [<xref ref-type="bibr" rid="B2">2</xref>], false discovery rates (FDR, [<xref ref-type="bibr" rid="B3">3</xref>]) are more practical for dealing with the multiplicity problem, and b) classical test statistics requires modification to limit the influence of unrealistically small variance estimates. Nonetheless, many competing methods for detecting DE exist, and even attempts at validation on data sets with known mRNA composition [<xref ref-type="bibr" rid="B4">4</xref>] cannot offer definitive guidelines.</p><p>In this context, the introduction of the so-called optimal discovery procedure (ODP, [<xref ref-type="bibr" rid="B5">5</xref>]) constitutes a major conceptual achievement. Building on the Neyman-Pearson lemma for testing an individual hypothesis, the author shows that an extension of the likelihood ratio test statistic for multiple parallel hypotheses (or genes) is the optimal procedure for deciding whether any specific gene is in fact DE: for any fixed number of false positive results, ODP will identify the maximum number of true positives. The ODP establishes therefore a theoretical optimum for detecting DE against which any other method can be measured.</p><p>Unfortunately, the optimality of ODP is a strictly theoretical result that requires, for all genes, a full parametric specification of the densities under null and alternative hypothesis. In practice, even assuming normality, the gene-wise means and variances are unknown, and they become nuisance parameters in the hypothesis testing. Consequently, the authors of [<xref ref-type="bibr" rid="B6">6</xref>] have suggested an estimated version EODP, which can be implemented in practice. It is, however, not clear how EODP performs compared to the theoretical optimum, or other existing methods, except under the most benign circumstances (no correlation and equal variances between genes).</p><p>The main questions of this paper are therefore a) whether the optimality of ODP is retained by EODP, and b) whether we can improve on EODP's performance in practice. Previously, we have introduced a multidimensional extension of the FDR procedure (fdr2d) that combines standard error information with the classical t-statistic. We demonstrated that the fdr2d performs as well or better than the usual modified t-statistics, without requiring extra modeling or model assumptions [<xref ref-type="bibr" rid="B7">7</xref>]. In this paper, we show that fdr2d also outperforms EODP on simulated and real data sets. We also demonstrate how a synthesis of the EODP and fdr2d procedures can further improve the power to detect DE.</p><sec><title>The two-sample problem</title><p>We demonstrate the application of EODP and fdr2d in the common situation where we want to detect genes that are DE between two biological states. We assume <italic>n</italic><sub>1 </sub>and <italic>n</italic><sub>2 </sub>arrays for each group, each containing probes for <italic>m </italic>genes. For gene <italic>i</italic>, we observe a vector of expression values <bold>x<sub>i </sub></bold>of length <italic>n</italic><sub>1 </sub>+ <italic>n</italic><sub>2</sub>, which consists of the observations <bold>x<sub>i1 </sub></bold>in the first group, and <bold>x<sub>i2 </sub></bold>in the second group. We define the groupwise means and standard deviations as usual, and refer to the pooled standard deviation as</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-8-28-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGZbWCgaacamaaDaaaleaacqWGPbqAaeaacqaIYaGmaaGccqGH9aqpdaWcaaqaaiabcIcaOiabd6gaUnaaBaaaleaacqaIXaqmaeqaaOGaeyOeI0IaeGymaeJaeiykaKIaem4Cam3aa0baaSqaaiabdMgaPjabigdaXaqaaiabikdaYaaakiabgUcaRiabcIcaOiabd6gaUnaaBaaaleaacqaIYaGmaeqaaOGaeyOeI0IaeGymaeJaeiykaKIaem4Cam3aa0baaSqaaiabdMgaPjabikdaYaqaaiabikdaYaaaaOqaaiabd6gaUnaaBaaaleaacqaIXaqmaeqaaOGaey4kaSIaemOBa42aaSbaaSqaaiabikdaYaqabaGccqGHsislcqaIYaGmaaGaeiOla4caaa@5161@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>Furthermore, we assume that we are dealing with a random mixture of DE and nonDE genes, with a proportion <italic>&#x003c0;</italic><sub>0 </sub>of genes being nonDE.</p></sec><sec><title>ODP statistics</title><p>The theoretical ODP statistic assumes that for all <italic>i </italic>= 1, ... <italic>m </italic>genes, the density functions of the expression values under the null hypothesis of no DE, <italic>f</italic><sub><italic>i</italic></sub>, and under the alternative hypothesis of DE, <italic>g</italic><sub><italic>i</italic></sub>, are fully known in advance. For the random mixture of DE and nonDE genes outlined above, the ODP statistic for the observed expression values <bold>x<sub>i </sub></bold>of the <italic>i</italic>-the gene can then be written as</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-8-28-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mtext>ODP</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGtbWudaWgaaWcbaGaee4ta8KaeeiraqKaeeiuaafabeaakiabcIcaOGqabiab=Hha4naaBaaaleaacqWFPbqAaeqaaOGaeiykaKIaeyypa0ZaaSaaaeaadaaeWaqaaiabdEgaNnaaBaaaleaacqWGQbGAaeqaaOGaeiikaGIae8hEaG3aaSbaaSqaaiab=LgaPbqabaGccqGGPaqkaSqaaiabdQgaQjabg2da9iabigdaXaqaaiabd2gaTbqdcqGHris5aaGcbaWaaabmaeaacqWGMbGzdaWgaaWcbaGaemOAaOgabeaakiabcIcaOiab=Hha4naaBaaaleaacqWFPbqAaeqaaOGaeiykaKcaleaacqWGQbGAcqGH9aqpcqaIXaqmaeaacqWGTbqBa0GaeyyeIuoaaaGccqGGUaGlaaa@54E2@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>The procedure then rejects the null hypothesis for all genes <italic>i </italic>with <italic>S</italic><sub><italic>i </italic></sub>&#x02261; <italic>S</italic>(<bold>x<sub>i</sub></bold>) &#x02265; <italic>&#x003bb;</italic>, i.e. all genes with large <italic>S</italic><sub><italic>i </italic></sub>are declared to be DE. Using the Neyman-Pearson Lemma, it can be shown that this procedure is optimal in the sense that for any pre-specified false positive rate (which will determine <italic>&#x003bb;</italic>), the ODP will have the maximum true positive rate. This optimality property can also be expressed in terms of FDR [<xref ref-type="bibr" rid="B5">5</xref>].</p><p>Requiring full specification of all null and alternative distributions, however, is impractical. In any realistic application, only an estimated ODP statistic</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-8-28-i3" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mtext>ODP</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGtbWugaqcamaaBaaaleaacqqGpbWtcqqGebarcqqGqbauaeqaaOGaeiikaGccbeGae8hEaG3aaSbaaSqaaiab=LgaPbqabaGccqGGPaqkcqGH9aqpdaWcaaqaamaaqadabaGafm4zaCMbaKaadaWgaaWcbaGaemOAaOgabeaakiabcIcaOiab=Hha4naaBaaaleaacqWFPbqAaeqaaOGaeiykaKcaleaacqWGQbGAcqGH9aqpcqaIXaqmaeaacqWGTbqBa0GaeyyeIuoaaOqaamaaqadabaGafmOzayMbaKaadaWgaaWcbaGaemOAaOgabeaakiabcIcaOiab=Hha4naaBaaaleaacqWFPbqAaeqaaOGaeiykaKcaleaacqWGQbGAcqGH9aqpcqaIXaqmaeaacqWGTbqBa0GaeyyeIuoaaaaaaa@5424@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>is feasible, where the densities <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-8-28-i4" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGMbGzgaqcamaaBaaaleaacqWGPbqAaeqaaaaa@2F98@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-8-28-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGNbWzgaqcamaaBaaaleaacqWGPbqAaeqaaaaa@2F9A@</mml:annotation></mml:semantics></mml:math></inline-formula> are estimated from the data. In [<xref ref-type="bibr" rid="B6">6</xref>], the authors propose to assume that all genes follow a normal distribution (possibly after suitable transformation); under this assumption, only means and variances have to be estimated from the data. In our two-sample situation, this amounts to</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-8-28-i6" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mtext>ODP</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mi>&#x003c6;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>&#x003c6;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mi>&#x003c6;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGtbWugaqcamaaBaaaleaacqqGpbWtcqqGebarcqqGqbauaeqaaOGaeiikaGccbeGae8hEaG3aaSbaaSqaaiab=LgaPbqabaGccqGGPaqkdaWcaaqaamaaqadabaacciGae4NXdy2aaeWaaeaacqWF4baEdaWgaaWcbaGae8xAaKMae8xmaedabeaakiabcYha8jqb+X7aTzaajaWaaSbaaSqaaiabdQgaQjabigdaXaqabaGccqGGSaalcuGFdpWCgaqcamaaDaaaleaacqWGQbGAcqaIXaqmaeaacqaIYaGmaaaakiaawIcacaGLPaaacqGFgpGzdaqadaqaaiab=Hha4naaBaaaleaacqWFPbqAcqWFYaGmaeqaaOGaeiiFaWNaf4hVd0MbaKaadaWgaaWcbaGaemOAaOMaeGOmaidabeaakiabcYcaSiqb+n8aZzaajaWaa0baaSqaaiabdQgaQjabigdaXaqaaiabikdaYaaaaOGaayjkaiaawMcaaaWcbaGaemOAaOMaeyypa0JaeGymaedabaGaemyBa0ganiabggHiLdaakeaadaaeWaqaaiab+z8aMnaabmaabaGae8hEaG3aaSbaaSqaaiab=LgaPbqabaGccqGG8baFcuGF8oqBgaqcamaaBaaaleaacqWGQbGAaeqaaOGaeiilaWIaf43WdmNbaKaadaqhaaWcbaGaemOAaOMaeGimaadabaGaeGOmaidaaaGccaGLOaGaayzkaaaaleaacqWGQbGAcqGH9aqpcqaIXaqmaeaacqWGTbqBa0GaeyyeIuoaaaGccaWLjaGaaCzcamaabmaabaGaeGymaedacaGLOaGaayzkaaaaaa@7EE3@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>where <italic>&#x003c6;</italic>(&#x000b7;|<italic>&#x003bc;</italic>, <italic>&#x003c3;</italic><sup>2</sup>) is the joint-density for the normal distribution with mean <italic>&#x003bc; </italic>and variance <italic>&#x003c3;</italic><sup>2</sup>.</p><p>Conceptually, under the null hypothesis, we have the usual estimates <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-8-28-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacuWF8oqBgaqcamaaBaaaleaacqWGQbGAaeqaaOGaeyypa0JafmiEaGNbaebadaWgaaWcbaGaemOAaOgabeaaaaa@342C@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-8-28-i8" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacuWFdpWCgaqcamaaDaaaleaacqWGQbGAcqaIWaamaeaacqaIYaGmaaGccqGH9aqpcqWGZbWCdaqhaaWcbaGaemOAaOgabaGaeGOmaidaaaaa@36EB@</mml:annotation></mml:semantics></mml:math></inline-formula> from the combined data, and under the alternative hypothesis, the corresponding group-wise means <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-8-28-i9" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacuWF8oqBgaqcamaaBaaaleaacqWGQbGAcqaIXaqmaeqaaOGaeyypa0JafmiEaGNbaebadaWgaaWcbaGaemOAaOMaeGymaedabeaaaaa@360C@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-8-28-i10" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacuWF8oqBgaqcamaaBaaaleaacqWGQbGAcqaIYaGmaeqaaOGaeyypa0JafmiEaGNbaebadaWgaaWcbaGaemOAaOMaeGOmaidabeaaaaa@3610@</mml:annotation></mml:semantics></mml:math></inline-formula> with the pooled sample variance <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-8-28-i11" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacuWFdpWCgaqcamaaDaaaleaacqWGQbGAcqaIXaqmaeaacqaIYaGmaaGccqGH9aqpcuWGZbWCgaacamaaDaaaleaacqWGQbGAaeaacqaIYaGmaaaaaa@36FC@</mml:annotation></mml:semantics></mml:math></inline-formula>. For the practical implementation, we follow [<xref ref-type="bibr" rid="B6">6</xref>] and pre-normalize all genes to have zero mean.</p><p>The second step in applying the ODP to data is the calibration of the procedure. There is no distribution theory for the statistic, so it is not clear how to choose the threshold &#x003bb; to achieve a desired FDR level. [<xref ref-type="bibr" rid="B6">6</xref>] suggest a conventional algorithm that computes the estimated ODP statistic <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-8-28-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGtbWugaqcaaaa@2DEB@</mml:annotation></mml:semantics></mml:math></inline-formula> under random permutations of the group labels; they use the resulting null distribution of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-8-28-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGtbWugaqcaaaa@2DEB@</mml:annotation></mml:semantics></mml:math></inline-formula> to compute the q-value for each gene, which represents its global FDR (e.g. [<xref ref-type="bibr" rid="B8">8</xref>]). We follow this approach for our implementation, but use the local false discovery rate (fdr, see [<xref ref-type="bibr" rid="B9">9</xref>] and below), with essentially identical results as theirs.</p></sec><sec><title>Multidimensional local false discovery rate</title><p>FDR approaches focus on the distribution of the specific statistic <italic>Z </italic>used to test the gene-wise null hypotheses, in contrast to ODP, which is based on the distribution of the data. Given a mixture of DE and nonDE genes as described above, the density <italic>f </italic>of <italic>Z </italic>can be written as</p><p><italic>f</italic>(<italic>z</italic>) = <italic>&#x003c0;</italic><sub>0</sub><italic>f</italic><sub>0</sub>(<italic>z</italic>) + (1 - <italic>&#x003c0;</italic><sub>0</sub>)<italic>f</italic><sub>1</sub>(<italic>z</italic>), &#x000a0;&#x000a0;&#x000a0; (2)</p><p>where <italic>f</italic><sub>0 </sub>and <italic>f</italic><sub>1 </sub>are the densities of the test statistic <italic>Z </italic>for nonDE and DE genes, respectively, and <italic>&#x003c0;</italic><sub>0 </sub>the proportion of truly nonDE genes. The local fdr for any observed value <italic>z </italic>of the test statistic is then</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-8-28-i13" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mtext>fdr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mn>3</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqqGMbGzcqqGKbazcqqGYbGCcqGGOaakcqWG6bGEcqGGPaqkcqGH9aqpiiGacqWFapaCdaWgaaWcbaGaeGimaadabeaakmaalaaabaGaemOzay2aaSbaaSqaaiabicdaWaqabaGccqGGOaakcqWG6bGEcqGGPaqkaeaacqWGMbGzcqGGOaakcqWG6bGEcqGGPaqkaaGaeiilaWIaaCzcaiaaxMaadaqadaqaaiabiodaZaGaayjkaiaawMcaaaaa@46B3@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>and can be interpreted as the expected rate of false positives among genes with test statistic <italic>z</italic>, see [<xref ref-type="bibr" rid="B9">9</xref>]. Practically, the densities <italic>f </italic>can be estimated from the histograms of the test statistics computed from the real data, and <italic>f</italic><sub>0 </sub>is estimated similarly from the test statistics computed from permuted data.</p><p>Formulated as a decision procedure like ODP, we specify a test statistic <italic>Z </italic>and a desired threshold <italic>&#x003b1; </italic>for the local fdr; we then compute for each gene the value of the test statistic <italic>z</italic><sub><italic>i </italic></sub>= <italic>Z</italic>(<bold>x<sub>i</sub></bold>) and the decision criterion fdr<sub><italic>i </italic></sub>= fdr(<italic>z</italic><sub><italic>i</italic></sub>) and declare genes with fdr<sub><italic>i </italic></sub>&#x0003c;<italic>&#x003b1; </italic>to be DE.</p><p>As the more usual global FDR of a set of test statistics is just the average of their local fdr [<xref ref-type="bibr" rid="B9">9</xref>], little seems to be gained by using the local fdr. Note, however, that Equations (2) and (3) still hold if we replace the univariate test statistic <italic>Z </italic>by a vector <bold>Z </bold>of test statistics. We have recently shown that for the two-sample problem, using a bivariate test statistic and the associated two-dimensional fdr is more powerful than conventional FDR for univariate test statistics [<xref ref-type="bibr" rid="B7">7</xref>]. Specifically, the test statistic <bold>Z </bold>= (<italic>Z</italic><sub>1</sub>, <italic>Z</italic><sub>2</sub>) with</p><p><italic>Z</italic><sub>1 </sub>= <italic>t </italic>and <italic>Z</italic><sub>2 </sub>= log <italic>se</italic>, &#x000a0;&#x000a0;&#x000a0; (4)</p><p>where <italic>t </italic>is the usual t statistic, and <italic>se </italic>the standard error of the mean,</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-8-28-i14" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGZbWCcqWGLbqzcqGH9aqpcuWGZbWCgaacamaakaaabaGaeGymaeJaei4la8IaemOBa42aaSbaaSqaaiabigdaXaqabaGccqGHRaWkcqaIXaqmcqGGVaWlcqWGUbGBdaWgaaWcbaGaeGOmaidabeaaaeqaaOGaeiilaWcaaa@3C88@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>yields smaller fdr not only compared to the conventional t-statistic on its own, but also compared to a number of popular modified t-statistics [<xref ref-type="bibr" rid="B10">10</xref>-<xref ref-type="bibr" rid="B12">12</xref>].</p><p>In the following, we will use the abbreviations fdr1d and fdr2d for local fdr computed based on univariate and bivariate test statistics, respectively. Note that in practice, the fdr2d is estimated in a similar manner as the fdr1d, using two-dimensional histograms instead of one-dimensional histograms, together with a somewhat more sophisticated binomial smoothing procedure, see [<xref ref-type="bibr" rid="B7">7</xref>] for details.</p></sec><sec><title>Procedures to be evaluated</title><p>The central aim of this paper is to compare the operating characteristics of four different procedures for detecting DE on a number of real and simulated data sets:</p><p>1. t1d uses the standard t-statistic with conventional fdr1d and serves as a reference.</p><p>2. S1d uses the logarithm of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-8-28-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGtbWugaqcaaaa@2DEB@</mml:annotation></mml:semantics></mml:math></inline-formula> in (1) with fdr1d; this procedure is equivalent to the estimated version of ODP described in [<xref ref-type="bibr" rid="B6">6</xref>] and its implementation in the EDGE software.</p><p>3. t2d uses the test statistic in (4) for calculating fdr2d; this is the same procedure as described in [<xref ref-type="bibr" rid="B7">7</xref>].</p><p>4. S2d is a novel procedure that combines the logarithm of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-8-28-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGtbWugaqcaaaa@2DEB@</mml:annotation></mml:semantics></mml:math></inline-formula> and the standard error for computing fdr2d, see below.</p></sec></sec><sec><title>Results</title><sec><title>Feasibility of S2d</title><p>We first evaluate the S2d procedure, based on the bivariate test statistic</p><p><italic>Z</italic><sub>1 </sub>= log<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-8-28-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGtbWugaqcaaaa@2DEB@</mml:annotation></mml:semantics></mml:math></inline-formula> &#x000a0;&#x000a0;&#x000a0; and &#x000a0;&#x000a0;&#x000a0; <italic>Z</italic><sub>2 </sub>= log <italic>se</italic>,</p><p>with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-8-28-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGtbWugaqcaaaa@2DEB@</mml:annotation></mml:semantics></mml:math></inline-formula> defined as in (1) and <italic>se </italic>as in (4). The only practical concern is that the smoothing procedure described in [<xref ref-type="bibr" rid="B7">7</xref>] may have problems with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-8-28-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGtbWugaqcaaaa@2DEB@</mml:annotation></mml:semantics></mml:math></inline-formula>. Indeed, the reason for taking the logarithms of the test statistics is to facilitate smoothing, by avoiding crowding at the boundary values.</p><p>Figures <xref ref-type="fig" rid="F1">1(a)</xref> and <xref ref-type="fig" rid="F1">1(b)</xref> show the scatter plot of the bivariate test statistics for two real data sets described in Methods, with the estimated fdr2d overlayed as isolines. We exploit the useful fact that we can always average the fdr2d over one of the component statistics to get the fdr1d for the other component statistic:</p><fig position="float" id="F1"><label>Figure 1</label><caption><p>S2d and S1d for the BRCA and Lymphoma data sets. (a) A scatter plot of the BRCA data, with log <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-8-28-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGtbWugaqcaaaa@2DEB@</mml:annotation></mml:semantics></mml:math></inline-formula> on the horizontal axis and log <italic>se </italic>on the vertical axis. Each symbol corresponds to a gene. The isolines shown are the local fdr based on the S2d method. (b) The same as (a) for the Lymphoma data. (c) The local fdr for the BRCA data, shown as a function of log <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-8-28-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGtbWugaqcaaaa@2DEB@</mml:annotation></mml:semantics></mml:math></inline-formula> on the horizontal axis. The black line shows the local fdr computed via S1d, the red line shows the fdr based on S2d, averaged across the log standard errors as shown in (a) above. (d) The same as (c) for the Lymphoma data.</p></caption><graphic xlink:href="1471-2105-8-28-1"/></fig><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-8-28-i15" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mtext>fdr</mml:mtext><mml:mn>1</mml:mn><mml:mtext>d</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>log</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:mtext>fdr</mml:mtext><mml:mn>2</mml:mn><mml:mtext>d</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>log</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>log</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>log</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqqGMbGzcqqGKbazcqqGYbGCcqaIXaqmcqqGKbazcqGGOaakcyGGSbaBcqGGVbWBcqGGNbWzcuWGtbWugaqcaiabcMcaPiabg2da9maapeaabaGaeeOzayMaeeizaqMaeeOCaiNaeGOmaiJaeeizaqMaeiikaGIagiiBaWMaei4Ba8Maei4zaCMafm4uamLbaKaacqGGSaalcyGGSbaBcqGGVbWBcqGGNbWzcqWGZbWCcqWGLbqzcqGGPaqkcqWGKbazcyGGSbaBcqGGVbWBcqGGNbWzcqWGZbWCcqWGLbqzcqGGSaalaSqabeqaniabgUIiYdaaaa@5B36@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>see [<xref ref-type="bibr" rid="B7">7</xref>]. Figures <xref ref-type="fig" rid="F1">1(c)</xref> and <xref ref-type="fig" rid="F1">1(d)</xref> show S1d (black) overlayed with the averaged S2d (red) for both data sets, with excellent agreement. This indicates that the smoothing required for computing S2d has been successful. This is consistent with the relationship between t-statistics and log<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1471-2105-8-28-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGtbWugaqcaaaa@2DEB@</mml:annotation></mml:semantics></mml:math></inline-formula> for the data at hand (not shown, but see e.g. Figure <xref ref-type="fig" rid="F1">1</xref> in [<xref ref-type="bibr" rid="B5">5</xref>]), which is essentially linear for genes with t-statistic |<italic>t</italic>| &#x0003e; 1, suggesting that the same general smoothing procedure is applicable.</p></sec><sec><title>Performance on simulated data sets</title><p>We perform simulations with 10,000 genes per array, a proportion of truly nonDE genes <italic>&#x003c0;</italic><sub>0 </sub>= 0.8, and two independent groups with <italic>n </italic>= 7 arrays per group. We combine three different levels of variance heterogeneity between genes with two different settings for the balance between up- and down-regulation, for a total of six different simulation scenarios:</p><p>1. Variances can be 'similar' (effectively the same) across genes, 'balanced', which allows for moderate differences in variance between genes, and 'variable', which allows large differences.</p><p>2. In the 'symmetric' case, roughly 50% of the DE genes are up- and down- regulated; in the 'asymmetric' case, only about 20% of all genes are down-regulated, the rest is up-regulated.</p><p>We have included the asymmetric scenario, because this is where ODP is expected to perform better than standard methods in a theoretical setting [<xref ref-type="bibr" rid="B5">5</xref>]. All expression values are assumed to follow a normal distribution; see Methods for further details of the simulation procedure.</p><p>For each scenario, we generate 100 data sets, for a total of 10<sup>6 </sup>genes. For each procedure, the fdr values are computed by keeping track of the DE status of each gene, grouping the genes in intervals (1d) or grid cells (2d) based on their test statistic, and computing the percentage of false positives in each interval or cell.</p><p>In order to compare different fdr procedures, we summarize their results via operating characteristics (OC) curves: for each procedure, we sort the groups of genes as described above by their local fdr, and compute the corresponding global FDR as cumulative mean of the local fdrs from the smallest to the largest. This global FDR is then plotted against the cumulative percentage of genes in these intervals or grid cells. The resulting curve shows the true global FDR for a set of top-ranked genes as a function of the size of that set (as a percentage of the number of genes under study). The results for the different simulation scenarios and all four procedures are shown in Figure <xref ref-type="fig" rid="F2">2</xref>.</p><fig position="float" id="F2"><label>Figure 2</label><caption><p>Operating characteristics of the four procedures for six simulated data sets. Each curve shows the true global FDR among the top-ranked genes for a procedure on the vertical axis as a function of the percentage of genes declared DE by this procedure on the horizontal axis. See text for description of the simulation scenarios.</p></caption><graphic xlink:href="1471-2105-8-28-2"/></fig><p>There is little or no difference in relative performance between the procedures under the symmetric and asymmetric scenarios in Figure <xref ref-type="fig" rid="F2">2</xref>. It is also clear that the differences in performance are most pronounced when the variances are similar, less so when the variances are balanced, and minor when the variances are highly variable. The ranking of the different procedures is consistent through all six scenarios: as expected, t1d has the worst performance; equally as expected, S1d does clearly better than t1d. Novel findings of this paper are that a) t2d does still better than S1d, and b) S2d improves over t2d, although only marginally.</p></sec><sec><title>Performance on real datasets</title><p>We evaluate the performance of the different procedures on two real data sets:</p><p>&#x02022; The BRCA data [<xref ref-type="bibr" rid="B13">13</xref>] contains 3,170 genes and was collected from 15 patients with hereditary breast cancer, who had mutations either of the BRCA1(<italic>n </italic>= 7) or the BRCA2 gene (<italic>n </italic>= 8).</p><p>&#x02022; The Lymphoma data [<xref ref-type="bibr" rid="B14">14</xref>] contains 7,399 genes and was collected from 240 patients with diffuse large B-cell lymphoma, comprising <italic>n</italic><sub>1 </sub>= 102 survivors and <italic>n</italic><sub>2 </sub>= 138 non-survivors.</p><p>Here, the local fdr estimates are computed based on the mixture model (2). The estimate of <italic>f </italic>is computed by smoothing the histograms of the observed statistics, and similarly <italic>f</italic><sub>0 </sub>from permuted test statistics. The permuted statistics are obtained from permutations of the group labels to generate the null distribution. Technically, we also need an estimate <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" name="1471-2105-8-28-i16" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003c0;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacuWFapaCgaqcamaaBaaaleaacqaIWaamaeqaaaaa@2F9A@</mml:annotation></mml:semantics></mml:math></inline-formula> of the proportion of nonDE genes, although for the purpose of comparing the different procedures, it does not matter which estimate, as long as we use the same value for all procedures, see Methods. In fact, in comparing different FDR procedures, it is important that this parameter is set to the same value.</p><p>For each procedure, we rank the genes by their estimated fdr, and compute their estimated global FDR among the top-ranked genes as the cumulative mean of their local fdrs. The global FDR is then plotted as a function of the percentage of genes declared DE. For comparison purposes, we also include the FDR as computed by the EDGE software.</p><p>The resulting OC curves are shown in Figure <xref ref-type="fig" rid="F3">3</xref>. We get the same ranking as for the simulated data: t1d performs worst and is easily bettered by S1d; t2d performs better than S1d for the 2% most highly regulated genes, and is equivalent otherwise; S2d has a slight advantage over t2d on the BRCA data. Additionally, as a check that our implementation of ODP is correct, we are happy to see that EDGE and S1d yield virtually identical FDR curves.</p><fig position="float" id="F3"><label>Figure 3</label><caption><p>Operating characteristics of the four procedures and EDGE for the BRCA and Lymphoma data. Each curve shows the estimated global FDR among the top-ranked genes for a procedure on the vertical axis as a function of the percentage of genes declared DE by this procedure on the horizontal axis.</p></caption><graphic xlink:href="1471-2105-8-28-3"/></fig><p>We [<xref ref-type="bibr" rid="B7">7</xref>] have previously compared t2d with other procedures such as SAM [<xref ref-type="bibr" rid="B11">11</xref>], Efron's modified t [<xref ref-type="bibr" rid="B10">10</xref>], and an empirical Bayes modification of the t-statistic [<xref ref-type="bibr" rid="B12">12</xref>]. To add more comparisons, we have run two procedures by Pounds and Cheng (Splosh [<xref ref-type="bibr" rid="B15">15</xref>] and robust FDR [<xref ref-type="bibr" rid="B16">16</xref>]) for the two real data sets. We use their own software, with a little modification so that we can specify the <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" name="1471-2105-8-28-i16" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003c0;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacuWFapaCgaqcamaaBaaaleaacqaIWaamaeqaaaaa@2F9A@</mml:annotation></mml:semantics></mml:math></inline-formula> parameter to be the same as in the other procedures. The results in Figure <xref ref-type="fig" rid="F4">4</xref> show both Splosh and robust FDR to perform worse than the other procedures. For these datasets, the robust FDR estimate coincides with the standard FDR estimate.</p><fig position="float" id="F4"><label>Figure 4</label><caption><p>Operating characteristics of different procedures for the BRCA and Lymphoma data: t1d and t2d combine standard t-statistics with one- and two-dimensional local fdr as shown in Figure 3; 'Splosh' and 'robust' are the FDR procedures described in Pounds and Cheng (2004) and Pounds and Cheng (2006). The 'standard' method is described in Storey and Tibshirani (2003).</p></caption><graphic xlink:href="1471-2105-8-28-4"/></fig></sec></sec><sec><title>Discussion</title><p>The main motivation for using the FDR has been that it offers a way of dealing with multiplicity that is less restrictive and more powerful than traditional p-value adjustments. The challenge is how to explicitly exploit the multiplicity by pooling information across genes in order to make the FDR even more powerful.</p><p>In the case of t1d, the test statistic is computed gene-by-gene and does not use information shared with other genes. Moderated t-statistics [<xref ref-type="bibr" rid="B10">10</xref>-<xref ref-type="bibr" rid="B12">12</xref>], which borrow strength across genes for estimating standard errors, are more powerful than simple t-statistics. The ODP appears to be the ultimate in combining information, where to some extent all genes contribute to the statistic for each other gene. The fdr2d approach on the other hand augments the grouping of genes based on individual test statistics by sub-grouping them based on their variability. In all cases we find that when there are few instances of genes with similar variability, the performance of the different methods tends to converge towards the simple t1d (Figures <xref ref-type="fig" rid="F2">2(e)</xref> and <xref ref-type="fig" rid="F2">2(f)</xref>).</p><p>From a practical point of view, it seems that the smoothing procedure underlying our implementation of fdr2d seems to work as well for the statistic log<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" name="1471-2105-8-28-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGtbWugaqcaaaa@2DEB@</mml:annotation></mml:semantics></mml:math></inline-formula> in S2d as for the t-statistics in t2d, and arguably even better: when comparing Figures <xref ref-type="fig" rid="F1">1(c)</xref> and <xref ref-type="fig" rid="F1">1(d)</xref> in this paper with Figures <xref ref-type="fig" rid="F4">4(a)</xref> and <xref ref-type="fig" rid="F4">4(b)</xref> in [<xref ref-type="bibr" rid="B7">7</xref>], we find in the former less of a tendency to underestimate the fdr for genes with small effect sizes, as discussed in the previous paper.</p><p>At first glance, the empirical ODP statistic seems to rely on the assumption that the expression values for all genes are normally distributed. From a practical point of view, however, the empirical ODP procedure works even if the normal assumption does not hold, because it relies on the permutation algorithm. In this sense, the normal densities in (1) only represent a scoring function that exponentially downweights contributions from genes with different mean structure and/or large variability. However, the performance of the empirical ODP will depend on how precisely the normal assumption holds for the data at hand. Some loss of the optimality property in the real data applications is probably due to non-normality. But even in the simulations, the empirical ODP is not better than t2d. This can only mean that the presence of large number of nuisance parameters degrades the performance of ODP.</p></sec><sec><title>Conclusion</title><p>The estimation of the nuisance parameters required to apply the ODP in practice makes the procedure described in [<xref ref-type="bibr" rid="B6">6</xref>] no longer optimal. We have shown in this paper that the combination of a conventional t-statistic with the standard error of the mean as described in [<xref ref-type="bibr" rid="B7">7</xref>] can outperform the empirical ODP. Further improvements can be made by combining the ODP test statistic with standard error information, but the gains are comparatively small.</p><p>The ODP procedure exploits similarities in the distribution for a collection of genes, for example similarity in variance. When variances between genes are dissimilar, there is little gain by the ODP compared to the standard t-statistic. One advantage of the ODP over the modified t-statistics is that the adaption is done automatically, without calculating a model-based or heuristic fudge factor for the denominator.</p><p>The computational demand of calculating the ODP statistic is a serious practical disadvantage: each density term <italic>f</italic>(<italic>x</italic>) or <italic>g</italic>(<italic>x</italic>) requires computation across the whole dataset, so a single ODP statistic already involves substantial computations. Doing this for the whole collection of genes and for repeated permutations of the group labels is an order of magnitude more laborious than the computation required for the standard statistics.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>Simulation scenarios</title><p>Our model for simulating microarray data is based on the model described in [<xref ref-type="bibr" rid="B12">12</xref>]. We assume that the expression values for all <italic>m </italic>genes are normally distributed (possibly after suitable transformation), and that their variances <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" name="1471-2105-8-28-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGZbWCgaacamaaDaaaleaacqWGPbqAaeaacqaIYaGmaaGccqGH9aqpdaWcaaqaaiabcIcaOiabd6gaUnaaBaaaleaacqaIXaqmaeqaaOGaeyOeI0IaeGymaeJaeiykaKIaem4Cam3aa0baaSqaaiabdMgaPjabigdaXaqaaiabikdaYaaakiabgUcaRiabcIcaOiabd6gaUnaaBaaaleaacqaIYaGmaeqaaOGaeyOeI0IaeGymaeJaeiykaKIaem4Cam3aa0baaSqaaiabdMgaPjabikdaYaqaaiabikdaYaaaaOqaaiabd6gaUnaaBaaaleaacqaIXaqmaeqaaOGaey4kaSIaemOBa42aaSbaaSqaaiabikdaYaqabaGccqGHsislcqaIYaGmaaGaeiOla4caaa@5161@</mml:annotation></mml:semantics></mml:math></inline-formula><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29" name="1471-2105-8-28-i17" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemyAaKgabaGaeGOmaidaaaaa@30F0@</mml:annotation></mml:semantics></mml:math></inline-formula> vary randomly between genes, following the scaled inverse of a <italic>&#x003c7;</italic><sup>2</sup>-distribution. Values are simulated for two groups of <italic>n</italic><sub>1 </sub>and <italic>n</italic><sub>2 </sub>arrays. Each gene <italic>i </italic>= 1, ... <italic>m </italic>to is selected randomly with probability <italic>&#x003c0;</italic><sub>0 </sub>to be DE. For genes that are picked as nonDE, the mean value in both groups is set to zero; for genes that are selected as DE, the mean in the first group is set to zero, and the mean in the second group is drawn randomly from a normal distribution whose variance is proportional to the gene-specific variance <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M30" name="1471-2105-8-28-i17" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemyAaKgabaGaeGOmaidaaaaa@30F0@</mml:annotation></mml:semantics></mml:math></inline-formula>.</p><p>In detail we proceed as follows for our simulations:</p><p>1. Initialize the design with <italic>m </italic>= 10,000 genes, proportion of nonDE genes <italic>&#x003c0;</italic><sub>0 </sub>= 0.8, and two groups with <italic>n</italic><sub>1 </sub>= <italic>n</italic><sub>2 </sub>= 7.</p><p>2. For each gene <italic>i </italic>= 1, ... <italic>m</italic>, draw a gene-specific variance from</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M31" name="1471-2105-8-28-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>~</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mi>s</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003c7;</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemyAaKgabaGaeGOmaidaaOGaeiOFa43aaSaaaeaacqWGKbazdaWgaaWcbaGaeGimaadabeaakiabdohaZnaaDaaaleaacqaIWaamaeaacqaIYaGmaaaakeaacqWFhpWydaqhaaWcbaGaemizaqMaeGimaadabaGaeGOmaidaaaaakiabcYcaSaaa@3E83@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>where <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M32" name="1471-2105-8-28-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c7;</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFhpWydaqhaaWcbaGaemizaqMaeGimaadabaGaeGOmaidaaaaa@31C8@</mml:annotation></mml:semantics></mml:math></inline-formula> is a <italic>&#x003c7;</italic><sup>2</sup>-distribution with <italic>d</italic><sub>0 </sub>degrees of freedom, and <italic>d</italic><sub>0 </sub>and <italic>s</italic><sub>0 </sub>are tuning parameters as described below.</p><p>3. For each gene <italic>i </italic>= 1,... <italic>m</italic>, determine randomly with probability <italic>&#x003c0;</italic><sub>0 </sub>whether it is to be DE or not.</p><p>(a) In case of nonDE, set <italic>&#x003bc;</italic><sub>1 </sub>= <italic>&#x003bc;</italic><sub>2 </sub>= 0.</p><p>(b) In case of DE, set <italic>&#x003bc;</italic><sub>1 </sub>= 0 and draw <italic>&#x003bc;</italic><sub>2 </sub>randomly from</p><p><italic>D</italic><sub><italic>i </italic></sub>~ <italic>N</italic>(0, <italic>v</italic><sub>0</sub><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M33" name="1471-2105-8-28-i17" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemyAaKgabaGaeGOmaidaaaaa@30F0@</mml:annotation></mml:semantics></mml:math></inline-formula>),</p><p>where is <italic>v</italic><sub>0 </sub>is another tuning parameter.</p><p>i. In case of an asymmetric scenario, set the sign of <italic>&#x003bc;</italic><sub>2 </sub>to positive with probability 0.8, and to negative otherwise.</p><p>4. Simulate <italic>n</italic><sub>1 </sub>and <italic>n</italic><sub>2 </sub>values in the first and second group, respectively, following normal distributions</p><p><italic>X</italic><sub>.<italic>i</italic>1 </sub>~ <italic>N</italic>(<italic>&#x003bc;</italic><sub>1</sub>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M34" name="1471-2105-8-28-i17" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemyAaKgabaGaeGOmaidaaaaa@30F0@</mml:annotation></mml:semantics></mml:math></inline-formula>),</p><p><italic>X</italic><sub>.<italic>i</italic>2 </sub>~ <italic>N</italic>(<italic>&#x003bc;</italic><sub>2</sub>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M35" name="1471-2105-8-28-i17" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemyAaKgabaGaeGOmaidaaaaa@30F0@</mml:annotation></mml:semantics></mml:math></inline-formula>).</p><p>Following [<xref ref-type="bibr" rid="B12">12</xref>], we set the constants to <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M36" name="1471-2105-8-28-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGZbWCdaqhaaWcbaGaeGimaadabaGaeGOmaidaaaaa@3028@</mml:annotation></mml:semantics></mml:math></inline-formula> = 4 and <italic>v</italic><sub>0 </sub>= 2 in our simulations. The amount of variability of the gene-wise variances is controlled via the parameter <italic>d</italic><sub>0</sub>: the three scenarios described in the Results section correspond to <italic>d</italic><sub>0 </sub>= 1000 (similar variances across genes), <italic>d</italic><sub>0 </sub>= 12 (balanced, with moderate differences between genes), and <italic>d</italic><sub>0 </sub>= 2 (variable, with large variability in variances).</p><p>For each scenario, we then generate 100 data sets, for a total of 10<sup>6 </sup>genes. For each procedure, the true local fdr of the genes is estimated from the known DE status of each simulated gene, simply as the proportion of false positives in each histogram interval or grid cell. This means specifically that no permutation, smoothing, or estimation of <italic>&#x003c0;</italic><sub>0 </sub>is required.</p></sec><sec><title>Real data sets</title><p>The permutation and smoothing approach used for estimating the fdr values for real data has been described in detail in [<xref ref-type="bibr" rid="B9">9</xref>] and [<xref ref-type="bibr" rid="B7">7</xref>]. The estimates <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M37" name="1471-2105-8-28-i16" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003c0;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacuWFapaCgaqcamaaBaaaleaacqaIWaamaeqaaaaa@2F9A@</mml:annotation></mml:semantics></mml:math></inline-formula> for the proportion of nonDE genes are based on a mixture model for the observed distribution of t-statistics, consisting of one central and several non-central t-distributions; we have shown previously that the weight of the central t-distribution can be a less biased estimate of <italic>&#x003c0;</italic><sub>0 </sub>in the presence of genes with small effects than the usual estimate based on the distribution of p-values ([<xref ref-type="bibr" rid="B17">17</xref>]). The same estimates have been used previously in [<xref ref-type="bibr" rid="B7">7</xref>].</p><p>The BRCA data set [<xref ref-type="bibr" rid="B13">13</xref>] was collected from patients with hereditary breast cancer who had mutations either of the BRCA1(<italic>n </italic>= 7) or the BRCA2 gene (<italic>n </italic>= 8). Expression was originally reported for 3,226 genes, but following [<xref ref-type="bibr" rid="B8">8</xref>], we removed 56 extremely variable genes and analysed only the remaining 3,170 genes. For all four procedures, we used <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M38" name="1471-2105-8-28-i16" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003c0;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacuWFapaCgaqcamaaBaaaleaacqaIWaamaeqaaaaa@2F9A@</mml:annotation></mml:semantics></mml:math></inline-formula> = 0.61, and we evaluated 500 permutations of the group labels.</p><p>The Lymphoma data set [<xref ref-type="bibr" rid="B14">14</xref>] was collected from 240 patients with diffuse large B-cell lymphoma, <italic>n</italic><sub>1 </sub>= 102 of whom survived the study period, and <italic>n</italic><sub>2 </sub>= 138 of whom did not. We used all 7,399 genes reported in the original article. For all four procedures, we used <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M39" name="1471-2105-8-28-i16" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003c0;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacuWFapaCgaqcamaaBaaaleaacqaIWaamaeqaaaaa@2F9A@</mml:annotation></mml:semantics></mml:math></inline-formula> = 0.59, and we evaluated 500 permutations of the group labels.</p><p>All expression values were logged prior to analysis.</p></sec><sec><title>Software</title><p>Methods t1d and t2d are implemented in the R package OCplus, which is freely available at the Bioconductor website [<xref ref-type="bibr" rid="B18">18</xref>]. R code implementing S1d and S2d is available from the authors on request. EDGE, the official implementation of EODP described in [<xref ref-type="bibr" rid="B19">19</xref>], is available at [<xref ref-type="bibr" rid="B20">20</xref>].</p></sec></sec><sec><title>Competing interests</title><p>The author(s) declare that they have no competing interests.</p></sec><sec><title>Authors' contributions</title><p>EP wrote computer programs, ran simulations and drafted the manuscript. AP wrote computer programs, ran data analysis and co-wrote the manuscript. SC co-wrote the manuscript. YP conceived the study and drafted the manuscript. All authors read and approved the final manuscript.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>This work was partially supported by a research grant from the Swedish Cancer Foundation.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Allison</surname><given-names>DB</given-names></name><name><surname>Cui</surname><given-names>X</given-names></name><name><surname>Page</surname><given-names>GP</given-names></name><name><surname>Sabripour</surname><given-names>M</given-names></name></person-group><article-title>Microarray data analysis: from disarray to consolidation and consensus</article-title><source>Nat Rev Genet</source><year>2006</year><volume>7</volume><fpage>55</fpage><lpage>65</lpage><pub-id pub-id-type="pmid">16369572</pub-id><pub-id pub-id-type="doi">10.1038/nrg1749</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Datta</surname><given-names>S</given-names></name><name><surname>Datta</surname><given-names>S</given-names></name></person-group><article-title>Empirical Bayes screening of many p-values with applications to microarray studies</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>1987</fpage><lpage>94</lpage><pub-id pub-id-type="pmid">15691856</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bti301</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname><given-names>Y</given-names></name><name><surname>Hochberg</surname><given-names>Y</given-names></name></person-group><article-title>Controlling the false discovery rate &#x02013; A practical and powerful approach to multiple testing</article-title><source>J Roy Stat Soc B</source><year>1995</year><volume>57</volume><fpage>289</fpage><lpage>300</lpage></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Choe</surname><given-names>S</given-names></name><name><surname>Boutros</surname><given-names>M</given-names></name><name><surname>Michelson</surname><given-names>A</given-names></name><name><surname>Church</surname><given-names>G</given-names></name><name><surname>Halfon</surname><given-names>M</given-names></name></person-group><article-title>Preferred analysis methods for Affymetrix GeneChips revealed by a wholly defined control dataset</article-title><source>Genome Biology</source><year>2005</year><volume>6</volume><fpage>R16</fpage><pub-id pub-id-type="pmid">15693945</pub-id><pub-id pub-id-type="doi">10.1186/gb-2005-6-2-r16</pub-id></citation></ref><ref id="B5"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Storey</surname><given-names>JD</given-names></name></person-group><article-title>The Optimal Discovery Procedure: A New Approach to Simultaneous Significance Testing</article-title><source>UW Biostatistics Working Paper Series Working Paper 259</source><year>2005</year><ext-link ext-link-type="uri" xlink:href="http://www.bepress.com/uwbiostat/paper259"/></citation></ref><ref id="B6"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Storey</surname><given-names>JD</given-names></name><name><surname>Dai</surname><given-names>JY</given-names></name><name><surname>Leek</surname><given-names>JT</given-names></name></person-group><article-title>The Optimal Discovery Procedure for Large-Scale Significance Testing, with Applications to Comparative Microarray Experiments</article-title><source>UW Biostatistics Working Paper Series Working Paper 260</source><year>2005</year><ext-link ext-link-type="uri" xlink:href="http://www.bepress.com/uwbiostat/paper260"/></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ploner</surname><given-names>A</given-names></name><name><surname>Calza</surname><given-names>S</given-names></name><name><surname>Gusnanto</surname><given-names>A</given-names></name><name><surname>Pawitan</surname><given-names>Y</given-names></name></person-group><article-title>Multidimensional local false discovery rate for microarray studies</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>556</fpage><lpage>565</lpage><pub-id pub-id-type="pmid">16368770</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btk013</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Storey</surname><given-names>JD</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name></person-group><article-title>Statistical significance for genomewide studies</article-title><source>Proc Natl Acad Sci USA</source><year>2003</year><volume>100</volume><fpage>9440</fpage><lpage>5</lpage><pub-id pub-id-type="pmid">12883005</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1530509100</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Efron</surname><given-names>B</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Storey</surname><given-names>J</given-names></name><name><surname>Tusher</surname><given-names>V</given-names></name></person-group><article-title>Empirical Bayes Analysis of a Microarray Experiment</article-title><source>J Am Stat Soc</source><year>2001</year><volume>96</volume><fpage>1151</fpage><lpage>1160</lpage></citation></ref><ref id="B10"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Efron</surname><given-names>B</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Chu</surname><given-names>GossGV</given-names></name></person-group><article-title>Microarrays and their use in a comparative experiment</article-title><source>Technical report</source><year>2000</year><publisher-name>Stanford University</publisher-name><ext-link ext-link-type="uri" xlink:href="http://www-stat.stanford.edu/~tibs/research.html"/></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tusher</surname><given-names>V</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Chu</surname><given-names>G</given-names></name></person-group><article-title>Significance analysis of microarrays applied to the ionizing radiation response</article-title><source>PNAS</source><year>2001</year><volume>98</volume><fpage>5116</fpage><lpage>5121</lpage><pub-id pub-id-type="pmid">11309499</pub-id><pub-id pub-id-type="doi">10.1073/pnas.091062498</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Smyth</surname><given-names>G</given-names></name></person-group><article-title>Linear Models and Empirical Bayes Methods for Assessing Differential Expression in Microarray Experiments</article-title><source>Statistical Applications in Genetics and Molecular Biology</source><year>2004</year><volume>3</volume><fpage>Article 3</fpage><ext-link ext-link-type="uri" xlink:href="http://www.bepress.com/sagmb/vol3/issl/art3"/><pub-id pub-id-type="pmid">16646809</pub-id><pub-id pub-id-type="doi">10.2202/1544-6115.1027</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hedenfalk</surname><given-names>I</given-names></name><name><surname>Duggan</surname><given-names>D</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Radmacher</surname><given-names>M</given-names></name><name><surname>Bittner</surname><given-names>M</given-names></name><name><surname>Simon</surname><given-names>R</given-names></name><name><surname>Meltzer</surname><given-names>P</given-names></name><name><surname>Gusterson</surname><given-names>B</given-names></name><name><surname>Esteller</surname><given-names>M</given-names></name><name><surname>Kallioniemi</surname><given-names>OP</given-names></name><name><surname>Wilfond</surname><given-names>B</given-names></name><name><surname>Borg</surname><given-names>A</given-names></name><name><surname>Trent</surname><given-names>J</given-names></name></person-group><article-title>Gene-expression profiles in hereditary breast cancer</article-title><source>N Engl J Med</source><year>2001</year><volume>344</volume><fpage>539</fpage><lpage>48</lpage><pub-id pub-id-type="pmid">11207349</pub-id><pub-id pub-id-type="doi">10.1056/NEJM200102223440801</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rosenwald</surname><given-names>A</given-names></name><name><surname>Wright</surname><given-names>G</given-names></name><name><surname>Chan</surname><given-names>WC</given-names></name><name><surname>Connors</surname><given-names>JM</given-names></name><name><surname>Campo</surname><given-names>E</given-names></name><name><surname>Fisher</surname><given-names>RI</given-names></name><name><surname>Gascoyne</surname><given-names>RD</given-names></name><name><surname>Muller-Hermelink</surname><given-names>HK</given-names></name><name><surname>Smeland</surname><given-names>EB</given-names></name><name><surname>Giltnane</surname><given-names>JM</given-names></name><name><surname>Hurt</surname><given-names>EM</given-names></name><name><surname>Zhao</surname><given-names>H</given-names></name><name><surname>Averett</surname><given-names>L</given-names></name><name><surname>Yang</surname><given-names>L</given-names></name><name><surname>Wilson</surname><given-names>WH</given-names></name><name><surname>Jaffe</surname><given-names>ES</given-names></name><name><surname>Simon</surname><given-names>R</given-names></name><name><surname>Klausner</surname><given-names>RD</given-names></name><name><surname>Powell</surname><given-names>J</given-names></name><name><surname>Duffey</surname><given-names>PL</given-names></name><name><surname>Longo</surname><given-names>DL</given-names></name><name><surname>Greiner</surname><given-names>TC</given-names></name><name><surname>Weisenburger</surname><given-names>DD</given-names></name><name><surname>Sanger</surname><given-names>WG</given-names></name><name><surname>Dave</surname><given-names>BJ</given-names></name><name><surname>Lynch</surname><given-names>JC</given-names></name><name><surname>Vose</surname><given-names>J</given-names></name><name><surname>Armitage</surname><given-names>JO</given-names></name><name><surname>Montserrat</surname><given-names>E</given-names></name><name><surname>LApez-Guillermo</surname><given-names>A</given-names></name><name><surname>Grogan</surname><given-names>TM</given-names></name><name><surname>Miller</surname><given-names>TP</given-names></name><name><surname>LeBlanc</surname><given-names>M</given-names></name><name><surname>Ott</surname><given-names>G</given-names></name><name><surname>Kvaloy</surname><given-names>S</given-names></name><name><surname>Delabie</surname><given-names>J</given-names></name><name><surname>Holte</surname><given-names>H</given-names></name><name><surname>Krajci</surname><given-names>P</given-names></name><name><surname>Stokke</surname><given-names>T</given-names></name><name><surname>Staudt</surname><given-names>LM</given-names></name><name><surname>Project</surname><given-names>LMP</given-names></name></person-group><article-title>The use of molecular profiling to predict survival after chemotherapy for diffuse large-B-cell lymphoma</article-title><source>N Engl J Med</source><year>2002</year><volume>346</volume><fpage>1937</fpage><lpage>47</lpage><pub-id pub-id-type="pmid">12075054</pub-id><pub-id pub-id-type="doi">10.1056/NEJMoa012914</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pounds</surname><given-names>S</given-names></name><name><surname>Cheng</surname><given-names>C</given-names></name></person-group><article-title>Improving false discovery rate estimation</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>1737</fpage><lpage>45</lpage><pub-id pub-id-type="pmid">14988112</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bth160</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pounds</surname><given-names>S</given-names></name><name><surname>Cheng</surname><given-names>C</given-names></name></person-group><article-title>Robust estimation of the false discovery rate</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>1979</fpage><lpage>1987</lpage><pub-id pub-id-type="pmid">16777905</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btl328</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pawitan</surname><given-names>Y</given-names></name><name><surname>Murthy</surname><given-names>KRK</given-names></name><name><surname>Michiels</surname><given-names>S</given-names></name><name><surname>Ploner</surname><given-names>A</given-names></name></person-group><article-title>Bias in the estimation of false discovery rate in microarray studies</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>3865</fpage><lpage>3872</lpage><pub-id pub-id-type="pmid">16105901</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bti626</pub-id></citation></ref><ref id="B18"><citation citation-type="other"><article-title>Bioconductor</article-title><ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org"/></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Leek</surname><given-names>JT</given-names></name><name><surname>Monsen</surname><given-names>E</given-names></name><name><surname>Dabney</surname><given-names>AR</given-names></name><name><surname>Storey</surname><given-names>JD</given-names></name></person-group><article-title>EDGE: extraction and analysis of differential gene expression</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>507</fpage><lpage>508</lpage><pub-id pub-id-type="pmid">16357033</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btk005</pub-id></citation></ref><ref id="B20"><citation citation-type="other"><article-title>EDGE</article-title><ext-link ext-link-type="uri" xlink:href="http://www.biostat.washington.edu/software/jstorey/edge"/></citation></ref></ref-list></back></article>


