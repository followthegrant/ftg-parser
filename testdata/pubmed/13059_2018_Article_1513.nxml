<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Genome Biol</journal-id><journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id><journal-title-group><journal-title>Genome Biology</journal-title></journal-title-group><issn pub-type="ppub">1474-7596</issn><issn pub-type="epub">1474-760X</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">30241486</article-id><article-id pub-id-type="pmc">6151042</article-id><article-id pub-id-type="publisher-id">1513</article-id><article-id pub-id-type="doi">10.1186/s13059-018-1513-2</article-id><article-categories><subj-group subj-group-type="heading"><subject>Method</subject></subj-group></article-categories><title-group><article-title>BayesCCE: a Bayesian framework for estimating cell-type composition from DNA methylation without the need for methylation reference</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9017-2070</contrib-id><name><surname>Rahmani</surname><given-names>Elior</given-names></name><address><email>elior.rahmani@gmail.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Schweiger</surname><given-names>Regev</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Shenhav</surname><given-names>Liat</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Wingert</surname><given-names>Theodora</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Hofer</surname><given-names>Ira</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Gabel</surname><given-names>Eilon</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Eskin</surname><given-names>Eleazar</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Halperin</surname><given-names>Eran</given-names></name><address><email>ehalperin@cs.ucla.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff3">3</xref><xref ref-type="aff" rid="Aff4">4</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9632 6718</institution-id><institution-id institution-id-type="GRID">grid.19006.3e</institution-id><institution>Department of Computer Science, </institution><institution>University of California Los Angeles, </institution></institution-wrap>Los Angeles, CA USA </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1937 0546</institution-id><institution-id institution-id-type="GRID">grid.12136.37</institution-id><institution>Blavatnik School of Computer Science, </institution><institution>Tel Aviv University, </institution></institution-wrap>Tel Aviv, Israel </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9632 6718</institution-id><institution-id institution-id-type="GRID">grid.19006.3e</institution-id><institution>Department of Anesthesiology and Perioperative Medicine, </institution><institution>University of California Los Angeles, </institution></institution-wrap>Los Angeles, CA USA </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9632 6718</institution-id><institution-id institution-id-type="GRID">grid.19006.3e</institution-id><institution>Department of Human Genetics, </institution><institution>University of California Los Angeles, </institution></institution-wrap>Los Angeles, CA USA </aff></contrib-group><pub-date pub-type="epub"><day>21</day><month>9</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>21</day><month>9</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>19</volume><elocation-id>141</elocation-id><history><date date-type="received"><day>1</day><month>11</month><year>2017</year></date><date date-type="accepted"><day>20</day><month>8</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2018</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><p>We introduce a Bayesian semi-supervised method for estimating cell counts from DNA methylation by leveraging an easily obtainable prior knowledge on the cell-type composition distribution of the studied tissue. We show mathematically and empirically that alternative methods which attempt to infer cell counts without methylation reference only capture linear combinations of cell counts rather than provide one component per cell type. Our approach allows the construction of components such that each component corresponds to a single cell type, and provides a new opportunity to investigate cell compositions in genomic studies of tissues for which it was not possible before.</p><sec><title>Electronic supplementary material</title><p>The online version of this article (10.1186/s13059-018-1513-2) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>DNA methylation</kwd><kwd>Cell-type composition</kwd><kwd>Tissue heterogeneity</kwd><kwd>Cell counts</kwd><kwd>Bayesian model</kwd><kwd>Epigenetics</kwd><kwd>Epigenome-wide association studies</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p>DNA methylation status has become a prominent epigenetic marker in genomic studies, and genome-wide DNA methylation data have become ubiquitous in the last few years. Numerous recent studies provide evidence for the role of DNA methylation in cellular processes and in disease (e.g., in multiple sclerosis [<xref ref-type="bibr" rid="CR1">1</xref>], schizophrenia [<xref ref-type="bibr" rid="CR2">2</xref>], and type 2 diabetes [<xref ref-type="bibr" rid="CR3">3</xref>]). Thus, DNA methylation status holds great potential for better understanding the role of epigenetics, potentially leading to better clinical tools for diagnosing and treating patients.</p><p>In a typical DNA methylation study, we obtain a large matrix in which each entry corresponds to a methylation level (a number between 0 and 1) at a specific genomic position for a specific individual. This level is the fraction of the probed DNA molecules that were found to have an additional methyl group at the specific position for the specific individual. Essentially, these methylation levels represent, for each individual and for each site, the probability of a given DNA molecule to be methylated. While simple in principle, methylation data are typically complicated owing to various biological and non-biological sources of variation. Particularly, methylation patterns are known to differ between different tissues and between different cell types. As a result, when methylation levels are collected from a complex tissue (e.g., blood), the observed methylation levels collected from an individual reflect a mixture of its methylation signals coming from different cell types, weighted according to mixing proportions that depend on the individual&#x02019;s cell-type composition. Thus, it is challenging to interpret methylation signals coming from heterogeneous sources.</p><p>One notable challenge in working with heterogeneous methylation levels has been highlighted in the context of epigenome-wide association studies (EWAS), where data are typically collected from heterogeneous samples. In such studies, we typically search for rows of the methylation matrix (each corresponding to one genomic position) that are significantly correlated with a phenotype of interest across the samples in the data. In this case, unless accounted for, correlation of the phenotype of interest with the cell-type composition of the samples may lead to numerous spurious associations and potentially mask true signal [<xref ref-type="bibr" rid="CR4">4</xref>]. In addition to its importance for a correct statistical analysis, knowledge of the cell-type composition may provide novel biological insights by studying cell compositions across populations.</p><p>In principle, one can use high-resolution cell counting for obtaining knowledge about the cell composition of the samples in a study. However, unfortunately, such cell counting for a large cohort may be costly and often logistically impractical (e.g., in some tissues, such as blood, reliable cell counting can be obtained from fresh samples only). Due to the pressing need to overcome this limitation, development of computational methods for estimating cell-type composition from methylation data has become a key interest in epigenetic studies. Several such methods have been suggested in the past few years [<xref ref-type="bibr" rid="CR5">5</xref>&#x02013;<xref ref-type="bibr" rid="CR10">10</xref>], some of which aim at explicitly estimating cell-type composition, while others aim at a more specific goal of correcting methylation data for the potential cell-type composition confounder in association studies. These methods take either a supervised approach, in which reference data of methylation patterns from sorted cells (methylomes) are obtained and used for predicting cell compositions [<xref ref-type="bibr" rid="CR5">5</xref>], or an unsupervised approach (reference-free) [<xref ref-type="bibr" rid="CR6">6</xref>&#x02013;<xref ref-type="bibr" rid="CR10">10</xref>].</p><p>The main advantage of the reference-based method is that it provides direct (absolute) estimates of the cell counts, whereas, as we demonstrate here, current reference-free methods are only capable of inferring components that capture linear combinations of the cell counts. Yet, the reference-based method can only be applied when relevant reference data exist. Currently, reference data only exist for the blood [<xref ref-type="bibr" rid="CR11">11</xref>], breast [<xref ref-type="bibr" rid="CR12">12</xref>], and brain [<xref ref-type="bibr" rid="CR13">13</xref>], for a small number of individuals (e.g., six samples in the blood reference [<xref ref-type="bibr" rid="CR11">11</xref>]). Moreover, the individuals in most available data sets do not match the reference individuals in their methylation-altering factors, such as age [<xref ref-type="bibr" rid="CR14">14</xref>], gender [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>], and genetics [<xref ref-type="bibr" rid="CR17">17</xref>]. This problem was recently highlighted in a study in which the authors showed that available blood reference collected from adults failed to estimate cell proportions of newborns [<xref ref-type="bibr" rid="CR18">18</xref>]. Furthermore, in a recent work, we showed evidence from multiple data sets that a reference-free approach can provide substantially better correction for cell composition when compared with the reference-based method [<xref ref-type="bibr" rid="CR19">19</xref>]. It is therefore often the case that unsupervised methods are either the only option or a better option for the analysis of EWAS.</p><p>As opposed to the reference-based approach, although can be applied for any tissue in principle, the referencefree methods do not provide direct estimates of the cell-type proportions. Previously proposed reference-free methods allow us to infer a set of components, or general axes, which were shown to compose linear combinations of the cell-type composition [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. Another more recent reference-free method was designed to infer cell-type proportions; however, as we show here, it only provides components that compose linear combinations of the cell-type composition rather than direct estimates [<xref ref-type="bibr" rid="CR10">10</xref>]. Unlike cell proportions, while linearly correlated components are useful in linear analyses such as linear regression, they cannot be used in any nonlinear downstream analysis or for studying individual cell types (e.g., studying alterations in cell composition across conditions or populations). Cell proportions may provide novel biological insights and contribute to our understanding of disease biology, and we therefore need targeted methods that are practical and low in cost for estimating cell counts.</p><p>In an attempt to address the limitations of previous reference-free methods and to provide cell count estimates rather than linear combinations of the cell counts, we propose an alternative Bayesian strategy that utilizes prior knowledge about the cell-type composition of the studied tissue. We present a semi-supervised method, BayesCCE (Bayesian Cell Count Estimation), which encodes experimentally obtained cell count information as a prior on the distribution of the cell-type composition in the data. As we demonstrate here, the required prior is substantially easier to obtain compared with standard reference data from sorted cells. We can estimate this prior from general cell counts collected in previous studies, without the need for corresponding methylation data or any other genomic data.</p><p>We evaluate our method using four large methylation data sets and simulated data and show that our method produces a set of components that can be used as cell count estimates. We observe that each component of BayesCCE can be regarded as corresponding to scaled values of a single cell type (i.e., high absolute correlation with one cell type, but not necessarily good estimates in absolute terms). We find that BayesCCE provides a substantial improvement in correlation with the cell counts over existing reference-free methods (in some cases a 50% improvement). We also consider the case where both methylation and cell count information are available for a small subset of the individuals in the sample, or for a group of individuals from external data. Notably, existing reference-based and reference-free methods for cell-type estimation completely ignore this potential information. In contrast, our method is flexible and allows to incorporate such information. Specifically, we show that our proposed Bayesian model can leverage such additional information for imputing missing cell counts in absolute terms. Testing this scenario on both real and simulated data, we find that measuring cell counts for a small group of samples (a couple of dozens) can lead to a further significant increase in the correlation of BayesCCE&#x02019;s components with the cell counts.</p></sec><sec id="Sec2" sec-type="results"><title>Results</title><sec id="Sec3"><title>Benchmarking existing reference-free methods for capturing cell-type composition</title><p>We first demonstrate that existing reference-free methods can infer components that are correlated with the tissue composition of DNA methylation data collected from heterogeneous sources. For this experiment, as well as for the rest of the experiments in this paper, we used four large publicly available whole-blood methylation data sets: a data set by Hannum et al. [<xref ref-type="bibr" rid="CR20">20</xref>] (<italic>n</italic>=650), a data set by Liu et al. [<xref ref-type="bibr" rid="CR21">21</xref>] (<italic>n</italic>=658), and two data sets by Hannon et al. [<xref ref-type="bibr" rid="CR22">22</xref>] (<italic>n</italic>=638 and <italic>n</italic>=665; denote Hannon et al. I and Hannon et al. II, respectively). In addition, we simulated data based on a reference data set of methylation levels from sorted leukocyte cells [<xref ref-type="bibr" rid="CR11">11</xref>] (see the &#x0201c;<xref rid="Sec9" ref-type="sec">Methods</xref>&#x0201d; section). While cell counts were known for each sample in the simulated data, cell counts were not available for the real data sets. We therefore estimated the cell-type proportions of six major blood cell types (granulocytes, monocytes, and four subtypes of lymphocytes: CD4+, CD8+, B cells, and natural killer cells) based on a reference-based method [<xref ref-type="bibr" rid="CR5">5</xref>], which was shown to reasonably estimate leukocyte cell proportions from whole-blood methylation data collected from adult individuals [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]. Due to the absence of large publicly available data sets with measured cell counts, these estimates were considered as the ground truth for evaluating the performance of the different methods.</p><p>For benchmarking performance of existing methods, we considered three reference-free methods, all of which were shown to generate components that capture cell-type composition information from methylation: ReFACTor [<xref ref-type="bibr" rid="CR8">8</xref>], non-negative matrix factorization (NNMF) [<xref ref-type="bibr" rid="CR9">9</xref>], and MeDeCom [<xref ref-type="bibr" rid="CR10">10</xref>]. Although the reference-free methods can potentially allow the detection of more cell types than the set of predefined cell types in the reference-based approach, we evaluated six components of each of the reference-free methods&#x02014;six being the number of estimated cell types composing the ground truth. We found all methods to capture a large portion of the cell composition information in all data sets; particularly, we observed that ReFACTor performed considerably better than NNMF and MeDeCom in all occasions (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S1).</p><p>In spite of the fact that all three methods can capture a large portion of the cell composition variation, each component provided by these methods is a linear combination of the cell types in the data rather than an estimate of the proportions of a single cell type. As a result, as we show next, in general, these methods perform poorly when their components are considered as estimates of cell type proportions. ReFACTor was not designed for estimating cell proportions but rather for providing orthogonal principal components of the data that together capture variation in cell compositions. In contrast, NNMF and MeDeCom, which extends the underlying model in NNMF, were designed to provide estimates of cell type proportions. In addition to empirical support from the data, as we report next, we also provide a mathematical proof for the non-identifiability nature of the NMMF model, which drives solutions towards undesired linear combinations of cell-type proportions rather than direct estimates of cell-type proportions (see the &#x0201c;<xref rid="Sec9" ref-type="sec">Methods</xref>&#x0201d; section).</p></sec><sec id="Sec4"><title>BayesCCE: a Bayesian semi-supervised approach for capturing cell-type composition</title><p>Every method that has been developed so far for capturing cell composition signal from methylation can be classified as either reference-based, wherein a reference of methylation patterns of sorted cells is used, or reference-free, wherein cell composition information is inferred in an unsupervised manner. Our proposed method, BayesCCE, combines elements from the underlying models of previous reference-free methods with further assumptions. BayesCCE does not use standard reference data of sorted methylation levels, but rather it leverages relatively weak prior information about the distribution of cell-type composition in the studied tissue. This allows BayesCCE to direct the solution towards the inference of one component for each cell type that is encoded in the prior information. BayesCCE is fully described in the &#x0201c;<xref rid="Sec9" ref-type="sec">Methods</xref>&#x0201d; section.</p><p>In order to evaluate BayesCCE, we obtained prior information about the distribution of leukocyte cell-type proportions in blood using high-resolution blood cell counts that were previously measured in 595 adult individuals (see the &#x0201c;<xref rid="Sec9" ref-type="sec">Methods</xref>&#x0201d; section). In concordance with the estimated cell-type proportions used as the ground truth, we first considered the assumption of six constituting cell types in blood tissue (<italic>k</italic>=6). We applied BayesCCE on each of the four data sets and evaluated the resulted components. We observed that each time BayesCCE produced a set of six components such that each component was correlated with one of the cell types, as desired (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> and Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Tables S1 and S2). Specifically, we found the mean absolute correlation values across all six cell types to be 0.58, 0.63, 0.45, and 0.45 in the Hannum et al., Liu et al., Hannon et al. I, and Hannon et al. II data sets, respectively. We note, however, that the assignment of components into corresponding cell types could not be automatically determined by BayesCCE. In addition, in general, the BayesCCE components were not in the right scale of their corresponding cell types (i.e., each component represented the proportions of one cell type up to a multiplicative constant and addition of a constant). These symptoms are expected due to the nature of the prior information used by BayesCCE. For more details about the assignment of components into cell types and evaluation measurements, see the &#x0201c;<xref rid="Sec9" ref-type="sec">Methods</xref>&#x0201d; section.
<fig id="Fig1"><label>Fig. 1</label><caption><p>BayesCCE captures cell-type proportions in four data sets under the assumption of six constituting cell types in the blood (<italic>k</italic>=6): granulocytes, monocytes, and four subtypes of lymphocytes (CD4+, CD8+, B cells, and NK cells). The BayesCCE estimated components were linearly transformed to match their corresponding cell types in scale (see the &#x0201c;<xref rid="Sec9" ref-type="sec">Methods</xref>&#x0201d; section). For convenience of visualization, we only plot the results of 100 randomly selected samples for each data set</p></caption><graphic xlink:href="13059_2018_1513_Fig1_HTML" id="MO1"/></fig>
</p><p>We next considered a simplifying assumption of only three constituting cell types in blood tissue (<italic>k</italic>=3): granulocytes, lymphocytes, and monocytes. We applied BayesCCE on each of the four data sets and observed high correlations between the estimated components of granulocytes and the granulocyte levels (<italic>r</italic>&#x02265;0.91 in all data sets) and between the estimated components of lymphocytes and the lymphocyte levels (<italic>r</italic>&#x02265;0.87 in all data sets), yet much lower correlations for monocytes (<italic>r</italic>&#x02264;0.27 in all data sets; Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S2 and Tables S1 and S2). We note that poor performance in capturing some cell type may be partially derived by inaccuracies introduced by the reference-based estimates, which are used as the ground truth in our experiments. Notably, three recent studies, which consisted of samples for which both methylation levels and cell count measurements were available, demonstrated that while the reference-based estimates of the overall lymphocyte and granulocyte levels were found to be highly correlated with the true levels, the accuracy of estimated monocytes was found to be substantially lower [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR25">25</xref>]. This may explain the low correlations we report for monocytes in our experiments. Low correlations with some of the cell types may be driven by various reasons, such as utilizing inappropriate reference or failing to perform a good feature selection. We later provide a more detailed discussion about these issues.</p><p>For assessing the performance of BayesCCE in light of previous reference-free methods, we sub-sampled the data and generated ten data sets of 300 randomly selected samples from each one of the four data sets. In addition, we simulated ten data sets of similar size (<italic>n</italic>=300; see the &#x0201c;<xref rid="Sec9" ref-type="sec">Methods</xref>&#x0201d; section). Figure&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref> demonstrates a significant and substantial improvement in performance for BayesCCE upon existing methods under the assumption of six constituting cell types (<italic>k</italic>=6). Repeating the same set of experiments while assuming three constituting cell types (<italic>k</italic>=3) revealed similar results (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S3).
<fig id="Fig2"><label>Fig. 2</label><caption><p>The performance of existing reference-free methods and BayesCCE under the assumption of six constituting cell types in blood (<italic>k</italic>=6): granulocytes, monocytes, and four subtypes of lymphocytes (CD4+, CD8+, B cells, and NK cells). For each method, box plots show for each data set the performance across ten sub-sampled data sets (<italic>n</italic>=300), with the median indicated by a horizontal line. For each of the methods, ReFACTor, NNMF, MeDeCom, and BayesCCE, we considered a single component per cell type (see the &#x0201c;<xref rid="Sec9" ref-type="sec">Methods</xref>&#x0201d; section). Additionally, we considered the scenario of cell count imputation wherein cell counts were known for 5% of the samples (<italic>n</italic>=15; BayesCCE imp) and the scenario wherein samples from external data with both methylation levels and cell counts were used in the analysis (<italic>n</italic>=15; BayesCCE imp ext). Top panel: mean absolute correlation (MAC) across all cell types. Bottom panel: mean absolute error (MAE) across all cell types. For BayesCCE imp and BayesCCE imp ext, the MAC and MAE values were calculated while excluding the samples with assumed known cell counts</p></caption><graphic xlink:href="13059_2018_1513_Fig2_HTML" id="MO2"/></fig>
</p></sec><sec id="Sec5"><title>BayesCCE impute: cell count imputation</title><p>We next considered a scenario in which cell counts are known for a small subset of the samples in the data. This problem can be viewed as a problem of imputing missing cell count values (see &#x0201c;<xref rid="Sec9" ref-type="sec">Methods</xref>&#x0201d; section). We repeated all previous experiments, only this time we assumed that cell counts are known for randomly selected 5% of the samples in each data set. As opposed to the previous experiments, in which each one of the BayesCCE components constituted a scaled estimate of the proportions of one of the cell types, incorporating samples with known cell counts allowed BayesCCE to produce components that form absolute estimates of the cell type proportions (i.e., not scaled components, but components with low absolute error compared with the true proportions). Moreover, in contrast to previous experiments, each component was now automatically assigned to its corresponding cell type.</p><p>Under the assumption of six constituting cell types in blood tissue (<italic>k</italic>=6), we observed a substantial improvement of up to 58% in mean absolute correlation values compared with our previous experiments (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> and Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Tables S1 and S2). Specifically, we found the mean absolute correlation values across all six cell types to be 0.71, 0.66, 0.56, and 0.71 in the Hannum et al., Liu et al., Hannon et al. I, and Hannon et al. II data sets, respectively. In addition, in contrast to our previous experiments, inclusion of some cell counts resulted in low mean absolute error, which reflects a correct scale for the components. We observed similar results when assuming three constituting cell types (<italic>k</italic>=3), providing an improvement of up to 28% in correlation and a substantial decrease in absolute errors compared with the previous experiments (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S4 and Tables S1 and S2).
<fig id="Fig3"><label>Fig. 3</label><caption><p>BayesCCE captures cell-type proportions in four data sets under the assumption of six constituting cell types in blood (<italic>k</italic>=6): granulocytes, monocytes, and four subtypes of lymphocytes (CD4+, CD8+, B cells, and NK cells), and assuming known cell counts for randomly selected 5% of the samples in the data. All correlations were calculated while excluding the samples with assumed known cell counts. For convenience of visualization, we only plot the results of 100 randomly selected samples for each data set</p></caption><graphic xlink:href="13059_2018_1513_Fig3_HTML" id="MO3"/></fig>
</p><p>In the absence of cell counts for a subset of the individuals in the data, we can incorporate into the analysis the external data of samples for which both cell counts and methylation levels (from the same tissue) are available. We repeated again all previous experiments (<italic>k</italic>=3 and <italic>k</italic>=6); only this time for each data set, we added a randomly selected subset of samples from one of the other data sets (5% of the original sample size) and used both their methylation levels and cell-type proportions in the analysis. Specifically, we used randomly selected samples and corresponding estimates of cell-type proportions from the Hannon et al. I data set for the experiments in all three other data sets, and samples from the Hannon et al. II data set for the experiment with the Hannon et al. I data set. In order to pool samples from two data sets together, we considered only the intersection of CpG sites that were available for analysis in the two data sets. In addition, unlike in the previous experiments, here, we potentially introduce new batch effects into the analysis, as in each experiment the original sample is combined with external data. We therefore accounted for the new batch information by adding it as a new covariate into BayesCCE. As in the case of known cell counts for a subset of the samples, we found that the inclusion of external samples with both methylation and cell counts substantially improved the performance in terms of correlation and absolute errors (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figures S5 and S6 and Tables S1 and S2). These results clearly show that estimates can be dramatically more accurate given the measured cell counts for as few as a couple of dozens of samples in the data (or such samples from external data).</p><p>As before, for assessing performance more thoroughly, we applied BayesCCE on the same sub-sampled data sets we used before (<italic>n</italic>=300), while assuming known cell counts for a subset of the samples. In one scenario, we assumed cell counts are known for 5% of the samples in each data set (<italic>n</italic>=15), and in a second scenario, we included into the analysis methylation levels and cell-type proportions of 15 samples from external data. These experiments revealed in most cases a substantial improvement in correlation over a standard execution of BayesCCE (i.e., without inclusion of cell counts) and revealed in all cases a substantial improvement in the mean absolute error. The results are summarized in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref> for the case of six constituting cell types (<italic>k</italic>=6) and in Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S3 for the case of three constituting cell types (<italic>k</italic>=3).</p><p>We further tested the performance of BayesCCE as a function of the number of samples for which cell counts are available. Remarkably, we found that known cell counts for only a couple of dozens of the samples are needed in order to achieve the maximal improvement in performance, including more samples with known cell counts did not provide a further improvement (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>). In addition, we evaluated the performance of BayesCCE as a function of the sample size. Interestingly, while performance did not improve by increasing the sample over a few hundred of samples in the case of unknown cell counts, we found that knowledge of cell counts for as few as 15 samples in the data allowed a monotonic improvement in performance in larger sample sizes (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S7).
<fig id="Fig4"><label>Fig. 4</label><caption><p>Performance of BayesCCE as a function of the number of samples for which cell counts are known, under the assumption of six constituting cell types in blood (<italic>k</italic>=6): granulocytes, monocytes, and four subtypes of lymphocytes (CD4+, CD8+, B cells, and NK cells). Presented are the medians of the mean absolute correlation values (MAC; in blue) and the medians of the mean absolute error values (MAE; in red) across the six cell types. Error bars indicate the range of MAC and MAE values across ten different executions for each number of samples with known cell counts. In every execution, samples with known cell counts were randomly selected, and all MAC and MAE values were calculated while excluding the samples with assumed known cell counts</p></caption><graphic xlink:href="13059_2018_1513_Fig4_HTML" id="MO4"/></fig>
</p><p>Finally, we considered an alternative approach for verifying the results of BayesCCE. Although our study aims at estimating cell-type proportions without the need for reference methylation data, BayesCCE jointly learns cell-type composition and cell-type-specific mean methylation levels (methylomes). Hence, as a by-product of the BayesCCE algorithm, we also obtain cell-type-specific methylomes across the CpG sites selected by BayesCCE as part of its feature selection process (see the &#x0201c;<xref rid="Sec9" ref-type="sec">Methods</xref>&#x0201d; section). Our experiments found BayesCCE to provide one component per cell type; however, these components are not necessarily appropriately scaled, which implies that estimated cell-type-specific methylation profiles are also not necessarily calibrated. Nevertheless, in the scenario where cell counts were known even for a small subset of the individuals in the study, BayesCCE provided calibrated cell count estimates. In such cases, we therefore expect BayesCCE to provide calibrated cell-type-specific methylation profiles. Using correlation maps, for each of the four whole-blood methylation data sets we analyzed, we verified high similarity between the cell-type-specific methylomes obtained by BayesCCE to those estimated by a reference methylation data collected from sorted blood cells [<xref ref-type="bibr" rid="CR11">11</xref>] (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S8). In spite of an overall high similarity between these two approaches, the correlation patterns detected by BayesCCE did not perfectly match those estimated using the reference data. While this may demonstrate the expected accuracy limitations of BayesCCE to some extent, we also attribute these imperfect matches, at least in part, to inaccuracies introduced by the reference data set, owing to the fact that it was constructed only from a small group of individuals (<italic>n</italic>=6), which do not represent well all the individuals in other data sets in terms of methylome altering factors such as age [<xref ref-type="bibr" rid="CR14">14</xref>], gender [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>], and genetics [<xref ref-type="bibr" rid="CR17">17</xref>].</p></sec><sec id="Sec6"><title>Robustness of BayesCCE to biases introduced by the cell composition prior</title><p>BayesCCE relies on prior information about the distribution of the cell-type composition in the studied tissue. In practice, the available prior information may not always precisely reflect the cell composition distribution of the individuals in the study. For instance, in a case/control study design, cases may demonstrate altered cell compositions compared with healthy individuals. Therefore, in this scenario, a prior estimated from a healthy population (or a sick population) is expected to deviate from the actual distribution in the sample. This potential problem is clearly not limited to case/control studies, but also applies to studies with quantitative phenotypes, in case these are correlated with changes in cell composition of the studied tissue. In principle, we can address this issue by incorporating several appropriate priors and assigning different priors to different individuals in the study. However, in practice, population-specific priors may be hard to obtain, mainly owing to the fact that numerous known and unknown factors can affect cell composition.</p><p>We revisited our analysis from the previous subsections in an attempt to assess the robustness of BayesCCE to non-informative or misspecified priors. A desired behavior would allow BayesCCE to overcome a bias introduced by a prior which does not accurately represent all the individuals in the sample. Particularly, we considered three whole-blood case/control data sets, two schizopherenia data sets by Hannon et al., and a rheumatoid arthritis data set by Liu et al., all of which are expected to demonstrate differences in blood cell composition between cases and controls [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>]. In fact, in our analysis, we had an inherently misspecified prior since we learned the prior from hospital patients (outpatients), which are overall expected to represent a sick population better than a more general population. Specifically, out of the 595 individuals used for learning the prior, 64% are known to have taken at least one medication at the time of blood draw for cell counting and 24% were admitted to the hospital due to various conditions within 2 months before or after the time of their blood draw (70.4% either were admitted or took medications). We expect these conditions to be correlated with alterations in blood cell composition, and therefore, the prior information we used is expected to represent deviation from a healthy population and, as a result, to misrepresent at least the control individuals in the case/control data sets we analyzed. We further considered an additional fourth data set by Hannum et al., which was originally studied in the context of aging (age range 19&#x02013;101, mean 64.03, SD 14.73). Our prior was calculated using sample with a different distribution of ages (range 20&#x02013;88, mean 49.19, SD 16.69), thus potentially misrepresenting the cell composition distribution in the Hannum et al. data to some extent.</p><p>Remarkably, we found the cell composition estimates given by BayesCCE to effectively detect differences between populations in the data sets, in spite of using a single prior estimated from one particular population. Specifically, we found that BayesCCE correctly detected the cell types which differentiate between cases and controls and between young and older populations; notably, in some of the data sets, we found BayesCCE to demonstrate some differences between cases and controls which were not captured by the reference-based estimates (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>). For example, NK cell abundance is known to change in aging in a process known as NK cell immunosenescence [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>], and monocyte levels are known to increase in RA patients compared with healthy individuals [<xref ref-type="bibr" rid="CR30">30</xref>&#x02013;<xref ref-type="bibr" rid="CR32">32</xref>]. These differences in cell populations were detected by BayesCCE but not by the reference-based method, thus suggesting that BayesCCE could uncover signal which was undetected by the reference-based method (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>). That said, some other cell composition differences that were reported by BayesCCE but not by the reference-based method or vice versa may be the result of inaccuracies introduced by BayesCCE. Quantifying more accurately and reliably to what extent each method can detect cell composition differences would require several large data sets with known cell counts.
<fig id="Fig5"><label>Fig. 5</label><caption><p>The robustness of BayesCCE to prior misspecification and its ability to capture population-specific variability in cell-type composition, under the assumption of six constituting cell types in blood (<italic>k</italic>=6): granulocytes, monocytes, and four subtypes of lymphocytes (CD4+, CD8+, B cells, and NK cells). Left side: <italic>t</italic> test results (presented by the negative log of the Bonferroni-adjusted <italic>p</italic> values) for the difference in proportions of each cell type between cases and controls. Right side: the Dirichlet parameters of estimated cell counts stratified by cases and controls; red dashed rectangles emphasize the high similarity in the estimated case/control-specific cell composition distributions yielded by the different methods, regardless of the prior used (&#x0201c;prior&#x0201d;). Results are presented for four different data sets and using cell count estimates obtained by four approaches: the reference-based method, BayesCCE, BayesCCE with known cell counts for 5% of the samples (BayesCCE imp), and BayesCCE with 5% additional samples with both known cell counts and methylation from external data (BayesCCE imp ext). For the Hannum et al. data set, for the purpose of presentation, cases were defined as individuals with age above the median age in the study. In the evaluation of BayesCCE imp and BayesCCE imp ext, samples with assumed known cell counts were excluded before calculating <italic>p</italic> values and fitting the Dirichlet parameters</p></caption><graphic xlink:href="13059_2018_1513_Fig5_HTML" id="MO5"/></fig>
</p><p>In addition, for each data set, we estimated the distribution of white blood cells based on the BayesCCE cell count estimates, and verified the ability of BayesCCE to correctly capture two distinct distributions (cases and controls or young and older individuals), regardless of the single distribution encoded by the prior information (Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>). While BayesCCE provides one component per cell type, these components are not necessarily appropriately scaled to provide cell count estimates in absolute terms. Therefore, for the latter analysis, we considered only the scenarios in which cell counts are known for a small number of individuals.</p><p>We further evaluated the scenario in which two different population-specific prior distributions are available. Specifically, one prior for cases and another one for controls in the case/control studies, and one for young and another one for older individuals in the aging study. For the purpose of this experiment, we estimated the priors using the reference-based estimates of a subset of the individuals (5% of the sample size) that were then excluded from the rest of the analysis. Interestingly, we found the inclusion of two prior distributions to provide no clear improvement over using a single general prior (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Table S3). Thus, further confirming the robustness of BayesCCE to inaccuracies introduced by the prior information due to cell composition differences between populations.</p><p>Finally, we evaluated the effect of incorporating noisy priors on the performance of BayesCCE by considering a range of possible priors with different levels of inaccuracies, including a non-informative prior (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S9). Not surprisingly, we observed that given cell counts for a small subset of samples, BayesCCE was overall robust to prior misspecification, which did not result in a substantially reduced performance even given a non-informative prior. In the absence of known cell counts, the performance of BayesCCE was somewhat decreased, however, remained reasonable even in the scenario of a non-informative prior. Particularly, overall, BayesCCE with a non-informative prior performed better than the competing reference-free methods (ReFACTor, NNMF, and MeDeCom). We attribute this result to the combination of the constraints defined in BayesCCE with the sparse low-rank assumption it takes, which seems to handle more efficiently with the high-dimension nature of the computational problem (see the &#x0201c;<xref rid="Sec9" ref-type="sec">Methods</xref>&#x0201d; section). We note that in the presence of a non-informative prior, BayesCCE conceptually reduces to the performance of ReFACTor, and therefore, it captures the same cell composition variability in the data. Yet, owing to the additional constrains, BayesCCE allows to overcome ReFACTor in capturing a set of components such that each component corresponds to one cell type.</p></sec></sec><sec id="Sec7" sec-type="discussion"><title>Discussion</title><p>We introduce BayesCCE, a Bayesian method for estimating cell-type composition from heterogeneous methylation data without the need for methylation reference. We show mathematically and empirically the non-identifiability nature of the more straightforward reference-free NNMF approach for inferring cell counts, which tends to provide only linear combinations of the cell counts. In contrast, while we do not provide conditions for the uniqueness of a BayesCCE solution, our empirical evidence from multiple data sets clearly demonstrates the success of BayesCCE in providing desirable results of one component per cell type by leveraging readily obtainable prior information from previously collected data.</p><p>The parameters of the prior required by BayesCCE can be estimated by utilizing previous studies that collected cell counts from the tissue of interest. In our evaluation of the method, we used whole-blood methylation data, and we considered the classical definition of leukocyte cell types, which relies on cell surface markers. Considering other definitions of cell types is of potential interest; particularly, it would be interesting to examine to what extent BayesCCE and the reference-free methods can capture cell-type composition following a methylation-based definition of cell types (i.e., when defining cell types according to their methylation patterns). Since BayesCCE captures cell composition variation under the classical definition of cell types by using the most dominant components of variation in the data, the main cell types of a natural methylation-based definition are expected to be a linear combination of the cell types under the classical definition. Much like in the experiments we presented here, wherein given a prior about the distribution of the cell types BayesCCE directed the solution towards an appropriate linear transformation, we would expect BayesCCE to perform similarly in the case of a methylation-based definition of cell types (given appropriate prior information about the distribution of cell types). Nevertheless, obtaining such a definition and evaluating BayesCCE under that definition would require obtaining appropriate single cell methylation data, which is currently scarcely available. Moreover, deriving an actual meaningful definition of cell types given such data is a non-trivial problem. Therefore, until such definition and appropriate data are available, we are bounded to consider the classical definition of cell types.</p><p>Since BayesCCE requires a prior which can be estimated from previously collected cell counts without the need for any other genomic data, obtaining such as prior is relatively easy for many tissues, such as the brain [<xref ref-type="bibr" rid="CR33">33</xref>], heart [<xref ref-type="bibr" rid="CR34">34</xref>], and adipose tissue [<xref ref-type="bibr" rid="CR35">35</xref>]. Particularly, such data should be substantially easier to obtain compared to reference data from sorted cells for the corresponding tissues. Ideally, in order to learn the prior, one would want to use cell counts coming from the same population as the target population. Nevertheless, empirically, we observe that BayesCCE leverages the prior to direct the solution while still allowing enough flexibility, which makes it robust even to substantial deviations of the prior from the true underlying cell composition distribution. In fact, our results demonstrate that BayesCCE handles biases introduced by the prior remarkably well. Particularly, it allows to capture differences in cell compositions between different populations in the same study, thus providing an opportunity to study cell composition differences between different populations even in the absence of methylation reference.</p><p>Since no large data sets with measured cell counts are currently publicly available, we used a supervised method [<xref ref-type="bibr" rid="CR5">5</xref>] for obtaining cell-type proportion estimates, which were used as the ground truth in our experiments. Even though the method used for obtaining these estimates was shown to reasonably estimate leukocyte cell proportions from whole-blood methylation data in several independent studies [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>], these estimates may have introduced biases into the analysis. Particularly, any inaccuracies introduced by the reference-based method could have directly affect the results of our evaluation. Our results indicate that such inaccuracies are more likely in some particular cell types over others. Failing to accurately estimate a particular cell type may be the outcome of various reasons. Notably, utilizing inappropriate reference data or failing to select a set of informative features that mark a particular cell type may dramatically affect its estimated values. Other reasons which are not methodological may also lead to inaccuracies of the estimates. For example, two cell types with very similar methylation patterns will be hardly distinguishable. In spite of the potential pitfalls of using estimates as a baseline for evaluation, we believe that our results on several independent data sets, including simulated data, and the use of a prior estimated from a large data set of high-resolution cell counts, provide a compelling evidence for the utility of BayesCCE.</p><p>We further demonstrate that imputation of cell counts can be highly accurate when cell counts are available for some of the samples in the data. Particularly, based on our experiments, only as few as a couple of dozens of samples with known cell counts are needed in order to substantially improve performance. Moreover, in the general setup of BayesCCE, where no cell counts are known, each component corresponds to one cell type, however, not necessarily in the right scale and there is no automatic way to determine the identity of that cell type. In contrast, in the case of cell count imputation, where cell counts are known for a subset of the samples, the assignment of components into cell types is straightforward. In addition, as we showed, BayesCCE is able to reconstruct cell counts up to a small absolute error (i.e., each component is scaled to form cell proportion estimates of one particular known cell type).</p><p>We note that in our evaluation of BayesCCE, we considered only whole-blood data sets. Studying other tissues or biological conditions is clearly of interest. However, in the absence of other tissue-specific methylation references that were clearly shown to allow obtaining reasonable cell-type proportion estimates, evaluation of performance based on tissues other than the whole blood will not be reliable. We therefore opt to focus on evaluating the performance of BayesCCE using multiple large whole-blood data sets. Importantly, beyond its potential utility for complex biological scenarios in which reference data is unavailable, BayesCCE may also provide an opportunity to improve cell count estimates in whole-blood studies in scenarios where the currently available reference data is not appropriate. Notably, in a recent work, we have shown using multiple whole-blood data sets that ReFACTor outperforms the reference-based method in correcting for cell composition [<xref ref-type="bibr" rid="CR19">19</xref>]. Differences in performance between ReFACTor (upon which BayesCCE relies for obtaining a starting point that captures the cell composition variation in the data) and the reference-based method are expected to be especially large in studies where the available reference data do not represent the individuals in the study well. We argue that this is likely to typically be the case, as the current go-to whole-blood reference consists of only six individuals [<xref ref-type="bibr" rid="CR11">11</xref>], which represent a very specific and narrow population in terms of methylome altering factors, such as age [<xref ref-type="bibr" rid="CR14">14</xref>], gender [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>], and genetics [<xref ref-type="bibr" rid="CR17">17</xref>]. That said, large data sets with experimentally measured cell counts are required in order to fully investigate and demonstrate these claims.</p><p>We further note that in our benchmarking of BayesCCE with existing reference-free methods, we considered only a subset of the available methods in the literature. Other reference-free methods that have been suggested in the context of accounting for cell composition in methylation data exist; however, these do not provide explicit components, but rather only implicitly account for cell composition variability in association studies. While in principle these methods can be modified to produce components, in this work, we focused only on methods that can be readily used to provide explicit components for evaluation. We further note that several supervised and unsupervised decomposition methods have been suggested for estimating cell composition from gene expression [<xref ref-type="bibr" rid="CR36">36</xref>&#x02013;<xref ref-type="bibr" rid="CR40">40</xref>]. However, these were refined for gene expression data and, to the best of our knowledge, none of these methods takes into account prior knowledge about the cell composition distribution as in BayesCCE. It remains of interest to investigate whether BayesCCE can be adapted for estimating cell composition from gene expression without the need for purified expression profiles.</p><p>Finally, our approach is based on finding a suitable linear transformation of the components found by ReFACTor [<xref ref-type="bibr" rid="CR8">8</xref>]. It is therefore important to follow the guidelines for the application of ReFACTor, such as incorporation of methylation-altering covariates; these guidelines were recently highlighted elsewhere [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR41">41</xref>]. Since BayesCCE relies on the ReFACTor components, it is limited by their quality, and particularly, if the variability of some cell type is not captured by ReFACTor, BayesCCE will not be able to estimate that cell type well. Such a result is possible in scenarios where the variation of a particular cell type is substantially weaker than other sources of variation in the data (which are unrelated to cell-type composition); we note, however, that this potential limitation is not exclusive for ReFACTor or BayesCCE but rather a general limitation of all existing reference-free methods. BayesCCE will effectively provide the same result as ReFACTor if used for correcting for a potential cell-type composition confounder in methylation data. Since ReFACTor does not allow to infer direct cell count estimates but rather linear transformations of those, we suggest to use BayesCCE in cases in which a study of individual cell types is performed and therefore ReFACTor cannot be used. In case merely a correction for cell composition is desired, we suggest to use BayesCCE when cell counts are known for a subset of the samples, and otherwise to use ReFACTor.</p></sec><sec id="Sec8" sec-type="conclusion"><title>Conclusion</title><p>We introduce a Bayesian method for estimating cell-type composition from heterogeneous methylation data using a prior on the cell composition distribution. In contrast to previous methods, using BayesCCE, we can generate components such that each component corresponds to a single cell type. These components can allow researchers to perform types of downstream analyses that are not possible using previous reference-free methods, which essentially capture linear combinations of several cell types in each component they provide. Based on our results, showing a further substantial improvement by incorporating some cell counts into the analysis, we recommend that in future studies either the cell counts be measured for at least a couple of dozens of the samples or the external data of samples with measured cell counts be utilized.</p></sec><sec id="Sec9"><title>Methods</title><sec id="Sec10"><title>Notations and related work</title><p>Let <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$O\in \mathbb {R}^{m\times n}$\end{document}</tex-math><mml:math id="M2"><mml:mi>O</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x0211d;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq1.gif"/></alternatives></inline-formula> be an <italic>m</italic> sites by <italic>n</italic> sample matrix of DNA methylation levels coming from a heterogeneous source consisting <italic>k</italic> cell types. For methylation levels, we consider what is commonly referred to as beta-normalized methylation levels, which are defined for each sample in each site as the proportion of methylated probes out of the total number of probes. Put differently, <italic>O</italic><sub><italic>ji</italic></sub>&#x02208;[0,1] for each site <italic>j</italic> and sample <italic>i</italic>. We denote <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$M\in \mathbb {R}^{m\times k}$\end{document}</tex-math><mml:math id="M4"><mml:mi>M</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x0211d;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq2.gif"/></alternatives></inline-formula> as the cell-type-specific mean methylation levels for each site and denote a row of this matrix, corresponding to the <italic>j</italic>th site, using <italic>M</italic><sub><italic>j</italic>,&#x000b7;</sub>. Additionally, we denote <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$R\in \mathbb {R}^{n\times k}$\end{document}</tex-math><mml:math id="M6"><mml:mi>R</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x0211d;</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq3.gif"/></alternatives></inline-formula> as the cell-type proportions of the samples in the data. A common model for observed mixtures of DNA methylation is 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &#x00026;&#x00026; O_{ji} = M_{j,\cdot} R_{i}^{T} + \epsilon_{ji} \end{array} $$ \end{document}</tex-math><mml:math id="M8"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ji</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo>&#x000b7;</mml:mo></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b5;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ji</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p><p>
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &#x00026;&#x00026; \epsilon_{ji} \sim N(0,\sigma^{2}) \end{array} $$ \end{document}</tex-math><mml:math id="M10"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>&#x003b5;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ji</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>
</p><p>
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &#x00026;&#x00026; \forall i \forall h:R_{ih}\geq 0  \end{array} $$ \end{document}</tex-math><mml:math id="M12"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>&#x02200;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02200;</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ih</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>
</p><p>
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &#x00026;&#x00026; \forall i:\sum\limits_{h=1}^{k} R_{ih}=1  \end{array} $$ \end{document}</tex-math><mml:math id="M14"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>&#x02200;</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ih</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>
</p><p>
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &#x00026;&#x00026; \forall j \forall h:0\leq M_{jh}\leq 1  \end{array} $$ \end{document}</tex-math><mml:math id="M16"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>&#x02200;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02200;</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jh</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>
</p><p>where the error term <italic>&#x003b5;</italic><sub><italic>ji</italic></sub> models measurement noise and other possible unmodeled factors. The constraints in (<xref rid="Equ3" ref-type="">3</xref>) and in (<xref rid="Equ4" ref-type="">4</xref>) require the cell proportions to be positive and to sum up to one in each sample, and the constraints in (<xref rid="Equ5" ref-type="">5</xref>) require the cell-type-specific mean levels to be in the range [0,1]. This model was initially suggested for DNA methylation in the context of reference-based estimation of cell proportions by Houseman et al. [<xref ref-type="bibr" rid="CR5">5</xref>]. We are interested in estimating <italic>R</italic>. Taking a standard maximum likelihood approach for fitting the model results in the following optimization problem: 
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \hat{R},\hat{M}= \underset{R,M}{\text{argmin}} &#x00026;&#x00026; \| O- M R^{T}\|_{F}^{2}  \end{array} $$ \end{document}</tex-math><mml:math id="M18"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>argmin</mml:mtext></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder></mml:mtd><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>&#x02225;</mml:mo><mml:mi>O</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>M</mml:mi><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mo>&#x02225;</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p><p>
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \text{s.t} &#x00026;&#x00026; \forall i \forall h:R_{ih}\geq 0  \end{array} $$ \end{document}</tex-math><mml:math id="M20"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mtext>s.t</mml:mtext></mml:mtd><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>&#x02200;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02200;</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ih</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>
</p><p>
<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &#x00026;&#x00026; \forall i:\sum\limits_{h=1}^{k} R_{ih}=1  \end{array} $$ \end{document}</tex-math><mml:math id="M22"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>&#x02200;</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ih</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>
</p><p>
<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &#x00026;&#x00026; \forall j \forall h:0\leq M_{jh}\leq 1  \end{array} $$ \end{document}</tex-math><mml:math id="M24"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>&#x02200;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02200;</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jh</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>
</p><p>where <inline-formula id="IEq4"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\|\cdot \|_{F}^{2}$\end{document}</tex-math><mml:math id="M26"><mml:mo>&#x02225;</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mrow><mml:mo>&#x02225;</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq4.gif"/></alternatives></inline-formula> is the squared Frobenius norm. The reference-based method [<xref ref-type="bibr" rid="CR5">5</xref>] first obtains an estimate of <italic>M</italic> from reference methylation data collected from sorted cells of the cell types composing the studied tissue. Once an estimate of <italic>M</italic> is fixed, <italic>R</italic> can be estimated by solving a standard quadratic program.</p><p>If the matrix <italic>M</italic> is unknown, which is a reference-free version of the problem, the above formulation of the problem can be regarded as a version of non-negative matrix factorization (NNMF) problem. NNMF has been suggested in several applications in biology; notably, the problem of inference of cell-type composition from methylation data has been recently formulated as an NNMF problem [<xref ref-type="bibr" rid="CR9">9</xref>]. In order to optimize the model, the authors used an alternating optimization procedure in which <italic>M</italic> or <italic>R</italic> are optimized while the other is kept fixed. However, as demonstrated by the authors [<xref ref-type="bibr" rid="CR9">9</xref>], this solution results in the inference of a linear combination of the cell proportions <italic>R</italic>. Put differently, more than one component of the NNMF is required for explaining each cell type in the data. This was recently further highlighted and explained using geometric considerations [<xref ref-type="bibr" rid="CR10">10</xref>], which nicely showed the non-identifiable nature of the NNMF model in (<xref rid="Equ6" ref-type="">6</xref>) in case that a perfect factorization of <italic>O</italic> into <italic>M</italic>,<italic>R</italic> exists (i.e., <italic>O</italic>=<italic>M</italic><italic>R</italic><sup><italic>T</italic></sup>). However, in practice, perfect factorization never exists in real biological data. Thus, in addition to empirical evidence from several data sets on which we apply the NNMF method (see the &#x0201c;<xref rid="Sec2" ref-type="sec">Results</xref>&#x0201d; section), in the next subsection, we provide a mathematical proof for the non-identifiability of the NNMF model in (<xref rid="Equ6" ref-type="">6</xref>) under a more general case, where a perfect factorization does not necessarily exist.</p><p>In an attempt to overcome the non-identifiability of the model in (<xref rid="Equ6" ref-type="">6</xref>) and to provide cell-type proportions when reference methylation data are not available, a recent modification of the NNMF model has been suggested [<xref ref-type="bibr" rid="CR10">10</xref>]. The method, MeDeCom, solves the optimization of the NNMF model while including additional penalty term in the objective function. Derived from biological knowledge about mean methylation levels, the penalty negatively weights mean methylation levels diverging from a known bimodal behavior of methylation levels, wherein CpGs tend to be overall methylated or unmethylated [<xref ref-type="bibr" rid="CR10">10</xref>]. While the modified objective suggested in MeDeCom overcomes the non-identifiability of the NNMF model for a given weight of the penalty (<italic>&#x003bb;</italic>), it is not entirely clear how to select <italic>&#x003bb;</italic>. To circumvent this problem, the authors proposed a cross-validation procedure for the selection of <italic>&#x003bb;</italic>. However, our empirical results from four large whole-blood methylation data sets, as well as from simulated data, show sub-optimal performance for MeDeCom, similar to the solutions of the simpler NNMF model. Our results suggest that the modification introduced by MeDeCom may not effectively avoid the non-identifiability nature of the NNMF model, possibly due to insufficient prior information or inability to effectively determine an appropriate value for <italic>&#x003bb;</italic>.</p><p>Another recent reference-free method for estimating cell composition in methylation data, ReFACTor [<xref ref-type="bibr" rid="CR8">8</xref>], performs an unsupervised feature selection step followed by a principal components analysis (PCA). Similarly to the NNMF solution, ReFACTor is an unsupervised method and it only finds principal components (PCs) that form linear combinations of the cell proportions rather than directly estimates the cell proportion values [<xref ref-type="bibr" rid="CR8">8</xref>].</p></sec><sec id="Sec11"><title>Non-identifiability of the NNMF model</title><p>We hereby show by construction the non-identifiability nature of the NNMF model in (<xref rid="Equ6" ref-type="">6</xref>). For this proof, instead of the constraints in (<xref rid="Equ9" ref-type="">9</xref>), we consider a slightly modified version of the constraints: 
<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \forall j \forall h:0 &#x0003c; M_{jh} &#x0003c; 1   $$ \end{document}</tex-math><mml:math id="M28"><mml:mo>&#x02200;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02200;</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jh</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:mn>1</mml:mn></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p><p>While in theory we may have an equality (i.e., <italic>M</italic><sub><italic>jh</italic></sub>=0 or <italic>M</italic><sub><italic>jh</italic></sub>=1), in practice, such sites are typically not measured or excluded from the analysis, since they would not be demonstrating any variability.</p><sec id="d29e1581"><title><bold>Proposition 1</bold></title><p>Let <inline-formula id="IEq5"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {R},\hat {M}$\end{document}</tex-math><mml:math id="M30"><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq5.gif"/></alternatives></inline-formula> be a solution to the problem in (<xref rid="Equ6" ref-type="">6</xref>). There exist <inline-formula id="IEq6"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {R}\neq \hat {R},\tilde {M}\neq \hat {M}$\end{document}</tex-math><mml:math id="M32"><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>&#x02260;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>&#x02260;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq6.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq7"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$ \left \| O - \hat {M} \hat {R}^{T} \right \|_{F}^{2} = \left \| O - \tilde {M} \tilde {R}^{T} \right \|_{F}^{2}$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mfenced close="&#x02225;" open="&#x02225;" separators=""><mml:mrow><mml:mi>O</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="&#x02225;" open="&#x02225;" separators=""><mml:mrow><mml:mi>O</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq7.gif"/></alternatives></inline-formula> and the constraints in (<xref rid="Equ7" ref-type="">7</xref>), (<xref rid="Equ8" ref-type="">8</xref>), and (<xref rid="Equ10" ref-type="">10</xref>) are satisfied.</p></sec><sec id="d29e1732"><title><italic>Proof</italic></title><p>Let 0&#x0003c;<italic>c</italic>&#x0003c;1, define <inline-formula id="IEq8"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Q\in \mathbb {R}^{k\times k}$\end{document}</tex-math><mml:math id="M36"><mml:mi>Q</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x0211d;</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq8.gif"/></alternatives></inline-formula> to be the identity matrix up to two entries: <italic>Q</italic><sub>11</sub>=1&#x02212;<italic>c</italic>,<italic>Q</italic><sub>12</sub>=<italic>c</italic>. It follows that <italic>Q</italic><sup>&#x02212;1</sup> is also the identity matrix up to two entries: <inline-formula id="IEq9"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Q^{-1}_{11} = \frac {1}{1-c},Q^{-1}_{12} = \frac {c}{c-1}$\end{document}</tex-math><mml:math id="M38"><mml:msubsup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq9.gif"/></alternatives></inline-formula>. &#x025a1;</p><p>Denote <inline-formula id="IEq10"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {R} = \hat {R}Q$\end{document}</tex-math><mml:math id="M40"><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq10.gif"/></alternatives></inline-formula> and denote <inline-formula id="IEq11"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {M} = \hat {M} \left (Q^{-1}\right)^{T}$\end{document}</tex-math><mml:math id="M42"><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq11.gif"/></alternatives></inline-formula>, we get that 
<disp-formula id="Equa"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \| O - \tilde{M} \tilde{R}^{T} \|_{F}^{2} = \| O - \hat{M} \left(Q^{-1}\right)^{T} Q^{T} \hat{R}^{T} \|_{F}^{2} = \| O - \hat{M} \hat{R}^{T} \|_{F}^{2} $$ \end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mspace width="-12.0pt"/><mml:mo>&#x02225;</mml:mo><mml:mi>O</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mo>&#x02225;</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>&#x02225;</mml:mo><mml:mi>O</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mo>&#x02225;</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>&#x02225;</mml:mo><mml:mi>O</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mo>&#x02225;</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math><graphic xlink:href="13059_2018_1513_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> The constraints in (<xref rid="Equ7" ref-type="">7</xref>) hold since <inline-formula id="IEq12"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {R}_{ih} \geq 0$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ih</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq12.gif"/></alternatives></inline-formula> for each 1&#x02264;<italic>i</italic>&#x02264;<italic>n</italic>,1&#x02264;<italic>h</italic>&#x02264;<italic>k</italic>. The constraints in (<xref rid="Equ8" ref-type="">8</xref>) hold since for each 1&#x02264;<italic>i</italic>&#x02264;<italic>n</italic><disp-formula id="Equb"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${\begin{aligned} \sum\limits_{l=1}^{k} \tilde{R}_{il} &#x00026;= \sum\limits_{h=1}^{k}\sum\limits_{l=1}^{k} \hat{R}_{il} Q_{lh}\\ &#x00026; = (1-c)\hat{R}_{i1} + c\hat{R}_{i1} + \sum\limits_{h=2}^{k} \hat{R}_{il} = \sum\limits_{h=1}^{k} \hat{R}_{il} = 1 \end{aligned}} $$ \end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">lh</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2018_1513_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> In addition, <inline-formula id="IEq13"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {M}^{T}_{hj} \in (0,1)$\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">hj</mml:mtext></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq13.gif"/></alternatives></inline-formula> for 2&#x02264;<italic>h</italic>&#x02264;<italic>k</italic>,1&#x02264;<italic>j</italic>&#x02264;<italic>m</italic>. In order to completely satisfy the constraints in (<xref rid="Equ10" ref-type="">10</xref>), we also require these constraints to be satisfied for <italic>h</italic>=1,1&#x02264;<italic>j</italic>&#x02264;<italic>m</italic>. It is easy to see that for each <italic>j</italic> the latter is satisfied if 
<disp-formula id="Equc"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$0 &#x0003c; c &#x0003c; \text{min}\left\{ \begin{array}{c} \frac{1-\hat{M}^{T}_{1j}}{{1-\hat{M}^{T}_{2j}}}, \frac{\hat{M}^{T}_{1j}}{\hat{M}^{T}_{2j}} \end{array}\right\} $$ \end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&#x0003c;</mml:mo><mml:mi>c</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mtext>min</mml:mtext><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2018_1513_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> Therefore, we can simply select a value of <italic>c</italic> in the range 
<disp-formula id="Equd"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$0 &#x0003c; c &#x0003c; \text{min}_{j} \left\{ \text{min} \left\{ \begin{array}{c} \frac{1-\hat{M}^{T}_{1j}}{{1-\hat{M}^{T}_{2j}}}, \frac{\hat{M}^{T}_{1j}}{\hat{M}^{T}_{2j}} \end{array} \right\} \right\} $$ \end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&#x0003c;</mml:mo><mml:mi>c</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mtext>min</mml:mtext><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2018_1513_Article_Equd.gif" position="anchor"/></alternatives></disp-formula> Note that we necessarily have either 
<disp-formula id="Eque"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$0 &#x0003c; c &#x0003c; \text{min}_{j} \left\{ \text{min} \left\{ \begin{array}{c} \frac{1-\hat{M}^{T}_{1j}}{{1-\hat{M}^{T}_{2j}}}, \frac{\hat{M}^{T}_{1j}}{\hat{M}^{T}_{2j}} \end{array} \right\} \right\} &#x0003c; 1 $$ \end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&#x0003c;</mml:mo><mml:mi>c</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mtext>min</mml:mtext><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>&#x0003c;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><graphic xlink:href="13059_2018_1513_Article_Eque.gif" position="anchor"/></alternatives></disp-formula> or 
<disp-formula id="Equf"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$0 &#x0003c; c &#x0003c; \text{min}_{j} \left\{ \text{min} \left\{ \begin{array}{c} \frac{1-\hat{M}^{T}_{2j}}{{1-\hat{M}^{T}_{1j}}}, \frac{\hat{M}^{T}_{2j}}{\hat{M}^{T}_{1j}} \end{array} \right\} \right\} &#x0003c; 1 $$ \end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&#x0003c;</mml:mo><mml:mi>c</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mtext>min</mml:mtext><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>&#x0003c;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><graphic xlink:href="13059_2018_1513_Article_Equf.gif" position="anchor"/></alternatives></disp-formula> In the latter case, we can switch the positions of the first two columns in <italic>M</italic>. Equality of the minimum to 1 in both cases would mean that <italic>M</italic><sub>1</sub>=<italic>M</italic><sub>2</sub>, which would mean that the problem is non-identifiable, as the first two cell types cannot be distinguished in this scenario. As a result of the above, the constraints in (<xref rid="Equ10" ref-type="">10</xref>) can be satisfied for a range of values of <italic>c</italic>. <inline-formula id="IEq14"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\square $\end{document}</tex-math><mml:math id="M60"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq14.gif"/></alternatives></inline-formula></p></sec></sec><sec id="Sec12"><title>Model</title><p>We suggest a more detailed model by adding a prior on <italic>R</italic> and taking into account potential covariates. Specifically, we assume that 
<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ R_{i}^{T} \sim \text{Dirichlet}(\alpha_{1},...,\alpha_{k})  $$ \end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>&#x0223c;</mml:mo><mml:mtext>Dirichlet</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p><p>where <italic>&#x003b1;</italic><sub>1</sub>,...,<italic>&#x003b1;</italic><sub><italic>k</italic></sub> are assumed to be known. In practice, the parameters are estimated from external data in which cell-type proportions of the studied tissue are known. Such experimentally obtained cell-type proportions were used to test the appropriateness of the Dirichlet prior in describing cell composition distribution (data not shown). Also, we consider additional factors of variation affecting observed methylation levels, in addition to variation in cell-type composition. Specifically, denote <inline-formula id="IEq15"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X\in \mathbb {R}^{n\times p}$\end{document}</tex-math><mml:math id="M64"><mml:mi>X</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x0211d;</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq15.gif"/></alternatives></inline-formula> as a matrix of <italic>p</italic> covariates for each individual and <inline-formula id="IEq16"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S\in \mathbb {R}^{m\times p}$\end{document}</tex-math><mml:math id="M66"><mml:mi>S</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x0211d;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq16.gif"/></alternatives></inline-formula> as a matrix of corresponding effects of the <italic>p</italic> covariates on each of the <italic>m</italic> sites. As before, we are interested in estimating <italic>R</italic>, the cell-type proportions of the <italic>k</italic> cell types. Deriving a maximum likelihood-based solution for this model and repeating the constraints for completeness result in the following optimization problem: 
<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \hat{R},\hat{M},\hat{S} &#x00026;=&#x00026; \underset{R,M,S}{\text{argmin}} \frac{1}{2\sigma^{2}} \left\| O-M R^{T} -S X^{T} \right\|_{F}^{2} \\ &#x00026;&#x00026; - \sum\limits_{h=1}^{k} (\alpha_{h}-1) \sum\limits_{i=1}^{n} \log (R_{ih})  \end{array} $$ \end{document}</tex-math><mml:math id="M68"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>&#x0015c;</mml:mi></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:munder><mml:mrow><mml:mtext>argmin</mml:mtext></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mfenced close="&#x02225;" open="&#x02225;" separators=""><mml:mrow><mml:mi>O</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>M</mml:mi><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:mi>S</mml:mi><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>&#x02212;</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ih</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p><p>
<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \text{s.t } &#x00026;&#x00026; \forall i \forall h:R_{ih} \geq 0  \end{array} $$ \end{document}</tex-math><mml:math id="M70"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mtext>s.t</mml:mtext></mml:mtd><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>&#x02200;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02200;</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ih</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>
</p><p>
<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &#x00026;&#x00026; \forall i:\sum\limits_{h=1}^{k} R_{ih}=1  \end{array} $$ \end{document}</tex-math><mml:math id="M72"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>&#x02200;</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ih</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>
</p><p>
<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &#x00026;&#x00026; \forall j \forall h:0\leq M_{jh}\leq 1  \end{array} $$ \end{document}</tex-math><mml:math id="M74"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>&#x02200;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02200;</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jh</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>
</p><p>Our intuition in this model is that since the priors on <italic>R</italic> are estimated from real data, incorporating them will push the solution of the optimization to return estimates of <italic>R</italic> which are closer to the true values as opposed to a linear combination of them.</p></sec><sec id="Sec13"><title>Algorithm</title><p>Our algorithm uses ReFACTor as a starting point. Specifically, we estimate <italic>R</italic> by finding an appropriate linear transformation of the ReFACTor principal components (ReFACTor components). In principle, any of the reference-free methods we examined (ReFACTor, NNMF, and MeDeCom) could be used as the starting point for our method. However, we found that ReFACTor captures a larger portion of the cell composition variance compared with the alternatives (Additional file&#x000a0;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S1).</p><p>Applying ReFACTor on our input matrix <italic>O</italic>, we get a list of <italic>t</italic> sites that are expected to be most informative with respect to the cell composition in <italic>O</italic>. Let <inline-formula id="IEq17"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {O}\in \mathbb {R}^{t\times n}$\end{document}</tex-math><mml:math id="M76"><mml:mi>&#x000d5;</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x0211d;</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq17.gif"/></alternatives></inline-formula> be a truncated version of <italic>O</italic> containing only the <italic>t</italic> sites selected by ReFACTor. We apply PCA on <inline-formula id="IEq18"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {O}$\end{document}</tex-math><mml:math id="M78"><mml:mi>&#x000d5;</mml:mi></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq18.gif"/></alternatives></inline-formula> to get <inline-formula id="IEq19"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$L\in \mathbb {R}^{t\times d}, P\in \mathbb {R}^{n\times d}$\end{document}</tex-math><mml:math id="M80"><mml:mi>L</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x0211d;</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x0211d;</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq19.gif"/></alternatives></inline-formula>, the loadings and scores of the first <italic>d</italic> ReFACTor components. Then, we reformulate the original optimization problem in terms of linear transformations of <italic>L</italic> and <italic>P</italic> as follows: 
<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \hat{A},\hat{V},\hat{B} = \underset{A,V,B}{\text{argmin}} &#x00026;&#x00026; \frac{1}{2\sigma^{2}}\left|\left|\tilde{O} - LA V^{T}P^{T} -LBX^{T} \right|\right|_{F}^{2}  \end{array} $$ \end{document}</tex-math><mml:math id="M82"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mi>&#x000c2;</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>argmin</mml:mtext></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:munder></mml:mtd><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:mi>&#x000d5;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mtext mathvariant="italic">LA</mml:mtext><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:mtext mathvariant="italic">LB</mml:mtext><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula></p><p>
<disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &#x00026;&#x00026; - \sum\limits_{h=1}^{k} (\alpha_{h}-1) \sum\limits_{i=1}^{n}\log\left(\sum\limits_{l=1}^{d}P_{il}V_{lh}\right)  \\ \text{s.t } &#x00026;&#x00026; \forall i\forall h:\sum\limits_{l=1}^{d}P_{il}V_{lh} \geq 0  \end{array} $$ \end{document}</tex-math><mml:math id="M84"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>&#x02212;</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">lh</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:mtext>s.t</mml:mtext></mml:mtd><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>&#x02200;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02200;</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">lh</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>
</p><p>
<disp-formula id="Equ18"><label>18</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &#x00026;&#x00026; \forall i:\sum\limits_{h=1}^{k}\sum\limits_{l=1}^{d}P_{il}V_{lh}=1  \end{array} $$ \end{document}</tex-math><mml:math id="M86"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>&#x02200;</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">lh</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula>
</p><p>
<disp-formula id="Equ19"><label>19</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &#x00026;&#x00026; \forall j \forall k: 0 \leq \sum\limits_{l=1}^{d} L_{jl}A_{lh} \leq 1  \end{array} $$ \end{document}</tex-math><mml:math id="M88"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:mo>&#x02200;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02200;</mml:mo><mml:mi>k</mml:mi><mml:mo>:</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jl</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">lh</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula>
</p><p>where <inline-formula id="IEq20"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$A\in \mathbb {R}^{d\times k}$\end{document}</tex-math><mml:math id="M90"><mml:mi>A</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x0211d;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq20.gif"/></alternatives></inline-formula> is a transformation matrix such that <inline-formula id="IEq21"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {M}=LA$\end{document}</tex-math><mml:math id="M92"><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">LA</mml:mtext></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq21.gif"/></alternatives></inline-formula> (<inline-formula id="IEq22"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {M}$\end{document}</tex-math><mml:math id="M94"><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq22.gif"/></alternatives></inline-formula> being a truncated version of <italic>M</italic> with the <italic>t</italic> sites selected by ReFACTor), <inline-formula id="IEq23"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$V\in \mathbb {R}^{d\times k}$\end{document}</tex-math><mml:math id="M96"><mml:mi>V</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x0211d;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq23.gif"/></alternatives></inline-formula> is a transformation matrix such that <italic>R</italic>=<italic>P</italic><italic>V</italic>, and <inline-formula id="IEq24"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$B\in \mathbb {R}^{d\times p}$\end{document}</tex-math><mml:math id="M98"><mml:mi>B</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi>&#x0211d;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq24.gif"/></alternatives></inline-formula> is a transformation matrix such that <italic>LB</italic> corresponds to the effects of each covariate on the methylation levels in each site. The constraints in (<xref rid="Equ17" ref-type="">17</xref>) and in (<xref rid="Equ18" ref-type="">18</xref>) correspond to the constraints in (<xref rid="Equ13" ref-type="">13</xref>) and in (<xref rid="Equ14" ref-type="">14</xref>), and the constraints in (<xref rid="Equ19" ref-type="">19</xref>) correspond to the constraints in (<xref rid="Equ15" ref-type="">15</xref>).</p><p>Given <inline-formula id="IEq25"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {V}$\end{document}</tex-math><mml:math id="M100"><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq25.gif"/></alternatives></inline-formula>, we simply return <inline-formula id="IEq26"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {R}=P\hat {V}$\end{document}</tex-math><mml:math id="M102"><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq26.gif"/></alternatives></inline-formula> as the estimated cell proportions. Note that in the new formulation we are now required to learn only <italic>d</italic>(2<italic>k</italic>+<italic>p</italic>) parameters&#x02014; <italic>d</italic>,<italic>k</italic>, and <italic>p</italic> being small constants&#x02014;a dramatically decreased number of parameters compared with the original problem which requires <italic>n</italic><italic>k</italic>+<italic>m</italic>(<italic>k</italic>+<italic>p</italic>) parameters. By taking this approach, we make an assumption that <inline-formula id="IEq27"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {O}$\end{document}</tex-math><mml:math id="M104"><mml:mi>&#x000d5;</mml:mi></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq27.gif"/></alternatives></inline-formula> consists of a low-rank structure that captures the cell composition using <italic>d</italic> orthogonal vectors. While a natural value for <italic>d</italic> would be <italic>k</italic>, <italic>d</italic> is not bounded to be <italic>k</italic>. Particularly, in cases where substantial additional cell composition signal is expected to be captured by later ReFACTor components (i.e., components beyond the first <italic>k</italic>), we would expect to benefit from increasing <italic>d</italic>. Clearly, overly increasing <italic>d</italic> is expected to result in overfitting and thus a decrease in performance. Finally, taking into account covariates with potentially dominant effects in the data should alleviate the risk of introducing noise into <inline-formula id="IEq28"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {R}$\end{document}</tex-math><mml:math id="M106"><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq28.gif"/></alternatives></inline-formula> in case of mixed low-rank structure of cell composition signal and other unwanted variation in the data. We note, however, that similar to the case of correlated explaining variables in regression, considering covariates that are expected to be correlated with the cell-type composition may result in underestimation of <italic>A</italic>,<italic>V</italic> and therefore to a decrease in the quality of <inline-formula id="IEq29"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {R}$\end{document}</tex-math><mml:math id="M108"><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq29.gif"/></alternatives></inline-formula>.</p></sec><sec id="Sec14"><title>Imputing cell counts using a subset of samples with measured cell counts</title><p>In practice, we observe that each of BayesCCE&#x02019;s components corresponds to a linear transformation of one cell type rather than to an estimate of that cell type in absolute terms. That is, it still lacks the right scaling (multiplication by a constant and addition of a constant) for transforming it into cell-type proportions. Furthermore, we would like the <italic>i</italic>th BayesCCE component to correspond to the <italic>i</italic>th cell type described by the prior using the <italic>&#x003b1;</italic><sub><italic>i</italic></sub> parameter. Empirically, this is not necessarily the case, especially in scenarios where some of the <italic>&#x003b1;</italic><sub><italic>i</italic></sub> values are similar. In order to address these two caveats, we suggest incorporating measured cell counts for a subset of the samples in the data.</p><p>Assume we have <italic>n</italic><sub>0</sub> reference samples in the data with known cell counts <italic>R</italic><sup>(0)</sup> and <italic>n</italic><sub>1</sub> samples with unknown cell counts <italic>R</italic><sup>(1)</sup> (<italic>n</italic>=<italic>n</italic><sub>0</sub>+<italic>n</italic><sub>1</sub>). This problem can be regarded as an imputation problem, in which we aim at imputing cell counts for samples with unknown cell counts. We can find <inline-formula id="IEq30"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {M}$\end{document}</tex-math><mml:math id="M110"><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq30.gif"/></alternatives></inline-formula> by solving the problem in (<xref rid="Equ12" ref-type="">12</xref>) under the constraints in (<xref rid="Equ15" ref-type="">15</xref>) for the <italic>n</italic><sub>0</sub> reference samples while replacing <italic>R</italic> with <italic>R</italic><sup>(0)</sup> and keeping it fixed. Then, given <inline-formula id="IEq31"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {M}$\end{document}</tex-math><mml:math id="M112"><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq31.gif"/></alternatives></inline-formula>, we can now solve the problem in (<xref rid="Equ16" ref-type="">16</xref>), after replacing <italic>LA</italic> with <inline-formula id="IEq32"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {M}$\end{document}</tex-math><mml:math id="M114"><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq32.gif"/></alternatives></inline-formula> (i.e., we find only <italic>V</italic>,<italic>B</italic> now), under the following constraints: 
<disp-formula id="Equ20"><label>20</label><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \forall (1 \leq i \leq n_{0}) \forall h: \sum\limits_{l=1}^{d}P_{il}^{(0)}V_{lh} = R^{(0)}_{ih}  \end{array} $$ \end{document}</tex-math><mml:math id="M116"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mo>&#x02200;</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>&#x02200;</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">lh</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ih</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ20.gif" position="anchor"/></alternatives></disp-formula></p><p>
<disp-formula id="Equ21"><label>21</label><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \forall (1 \leq i \leq n_{1}) \forall h: \sum\limits_{l=1}^{d}P_{il}^{(1)}V_{lh} \geq 0  \end{array} $$ \end{document}</tex-math><mml:math id="M118"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mo>&#x02200;</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>&#x02200;</mml:mo><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">lh</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula>
</p><p>
<disp-formula id="Equ22"><label>22</label><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \forall (1 \leq i \leq n_{1}): \sum\limits_{h=1}^{k} \sum\limits_{l=1}^{d}P_{il}^{(1)}V_{lh} = 1  \end{array} $$ \end{document}</tex-math><mml:math id="M120"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mo>&#x02200;</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>:</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">lh</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1513_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula>
</p><p>where <italic>P</italic><sup>(0)</sup> contains <italic>n</italic><sub>0</sub> rows corresponding to the reference samples in <italic>P</italic> and <italic>P</italic><sup>(1)</sup> contains <italic>n</italic><sub>1</sub> rows corresponding to the remaining samples in <italic>P</italic>. In this case, both problems of estimating <italic>M</italic> and solving (<xref rid="Equ16" ref-type="">16</xref>) while keeping <inline-formula id="IEq33"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {M}$\end{document}</tex-math><mml:math id="M122"><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq33.gif"/></alternatives></inline-formula> fixed are convex&#x02014;the first problem takes the form of a standard quadratic problem and the latter results in an optimization problem of the sum of two convex terms under linear constraints. Using <inline-formula id="IEq34"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {M}$\end{document}</tex-math><mml:math id="M124"><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq34.gif"/></alternatives></inline-formula>, estimated from cell counts and corresponding methylation levels of a group of samples, and adding the constraints in (<xref rid="Equ20" ref-type="">20</xref>) are expected to direct the inference of <italic>R</italic> towards a set of components such that each one corresponds to one known cell type with a proper scale.</p><p>We note that given an estimate <inline-formula id="IEq35"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {M}$\end{document}</tex-math><mml:math id="M126"><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq35.gif"/></alternatives></inline-formula> as described above, we can also solve directly the problem in (<xref rid="Equ12" ref-type="">12</xref>) rather than the problem in (<xref rid="Equ16" ref-type="">16</xref>). This approach may be more desired in cases where <italic>P</italic> does not effectively capture the cell composition variation in the data. In the context of our study, however, it is not possible to reliably evaluate the approach of solving directly the problem in (<xref rid="Equ12" ref-type="">12</xref>), owing to the fact that the ground truth we set for evaluation is based on the same matrix <italic>M</italic>. Specifically, in this case, the cell proportions of the reference individuals are expected to recover the same matrix <italic>M</italic> that was used for computing the ground truth proportions of the non-reference individuals. As a result, the estimated proportions of the non-reference individuals will be exactly the ground truth that is used in the evaluation (up to a statistical error arising from the estimation of <italic>M</italic>), regardless of the true accuracy of the estimate <inline-formula id="IEq36"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {M}$\end{document}</tex-math><mml:math id="M128"><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq36.gif"/></alternatives></inline-formula> with respect to the true <italic>M</italic> and regardless of the true accuracy of the cell proportion estimates.</p></sec><sec id="Sec15"><title>Implementation and practical issues</title><p>We estimate <italic>&#x003c3;</italic><sup>2</sup> in (<xref rid="Equ16" ref-type="">16</xref>) as the mean squared error of predicting <inline-formula id="IEq37"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {O}$\end{document}</tex-math><mml:math id="M130"><mml:mi>&#x000d5;</mml:mi></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq37.gif"/></alternatives></inline-formula> with <italic>P</italic> and <italic>X</italic>. The <italic>&#x003b1;</italic><sub>1</sub>,...,<italic>&#x003b1;</italic><sub><italic>k</italic></sub> Dirichlet parameters of the prior can be estimated from cell counts using maximum likelihood estimators. In practice, we add a column of ones to both <italic>L</italic> and <italic>P</italic> in (<xref rid="Equ16" ref-type="">16</xref>) in order to assure feasibility of the problem&#x02014;these constant columns are used to compose the mean methylation level per site across all cell types and the mean cell proportion fraction in each cell type across all samples. In addition, we slightly relax some of the constraints in the problem to avoid problems due to numeric instability and inconsistent noise issues. First, the inequality constraints in (<xref rid="Equ17" ref-type="">17</xref>) and in (<xref rid="Equ21" ref-type="">21</xref>) are changed to require the cell proportions to be greater than <italic>&#x003b5;</italic>&#x0003e;0, as a result of the logarithm term in the objective (<italic>&#x003b5;</italic>=0.0001). In addition, we do not impose the equality constraints in (<xref rid="Equ18" ref-type="">18</xref>) and in (<xref rid="Equ22" ref-type="">22</xref>) but rather allow a small deviation from equality (5%), and given cell counts for a subset of the samples, we allow a small deviation from the equality constraints in (<xref rid="Equ20" ref-type="">20</xref>) due to expected inaccuracies of cell count measurements (1%). The last two constraints are required for assuring a feasible solution, owing to the fact that we fit <inline-formula id="IEq38"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {M},\hat {R}$\end{document}</tex-math><mml:math id="M132"><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>&#x0005e;</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2018_1513_Article_IEq38.gif"/></alternatives></inline-formula> jointly. Specifically, since the starting point for the optimization is essentially a set of principal components (given by ReFACTor), which are not guaranteed to capture only cell composition variation, in practice, obtaining linear transformations that precisely satisfy the constraints is expected to be an exception rather than the rule. We verified this empirically (data not shown), and we further observed that these relaxations eventually result in feasible solutions which typically tend to tightly concentrate around the original constraints.</p><p>We performed all the experiments in this paper using a Matlab implementation of BayesCCE. Specifically, we solved the optimization problems in BayesCCE using the <italic>fmincon</italic> function with the default interior-point algorithm, and we used the <italic>fastfit</italic> [<xref ref-type="bibr" rid="CR42">42</xref>] Matlab package for calculating maximum likelihood estimates of the Dirichlet priors. All executions of BayesCCE required less than an hour (and typically several minutes) on a 64-bit Mac OS X computer with 3.1 GHz and 16 GB of RAM. Corresponding code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/cozygene/bayescce">https://github.com/cozygene/bayescce</ext-link>.</p></sec><sec id="Sec16"><title>Evaluation of performance</title><p>The fraction of cell composition variation (<italic>R</italic><sup>2</sup>) captured by each of the reference-free methods, ReFACTor, NNMF, and MeDeCom, was computed for each cell type using a linear predictor fitted with the first <italic>k</italic> components provided by each method. In order to evaluate the performance of BayesCCE, for each component <italic>i</italic>, we calculated its absolute correlation with the <italic>i</italic>th cell type and reported the mean absolute correlation (MAC) across the <italic>k</italic> estimated cell types. While the Dirichlet prior assigns a specific parameter <italic>&#x003b1;</italic><sub><italic>h</italic></sub> for each cell type <italic>h</italic>, empirically, we observed that in the case of <italic>k</italic>=6 with no known cell counts for a subset of the samples, the <italic>i</italic>th BayesCCE component did not necessarily correspond to the <italic>i</italic>th cell type. Put differently, the labels of the <italic>k</italic> cell types had to be permuted before calculating the MAC. In this case, we considered the permutation of the labels which resulted with the highest MAC as the correct permutation. In the rest of the cases, we did not apply such permutation (all the experiments using <italic>k</italic>=3 and all the experiments using <italic>k</italic>=6 with known cell counts for a subset of the samples).</p><p>For evaluating ReFACTor, NNMF, and MeDeCom, reference-free methods which do not attribute their components to specific cell types in any scenario, we considered for each method the permutation of its components leading to the highest MAC in all experiments when compared with BayesCCE. In addition, we considered the absolute error of the estimates from the ground truth as an additional quality measurement. We calculated the mean absolute error (MAE) across the <italic>k</italic> estimated cell types. When calculating absolute errors for the ReFACTor components, we scaled each ReFACTor component to be in the range [0,1].</p></sec><sec id="Sec17"><title>Implementation and application of the reference-free and reference-based methods</title><p>We calculated the ReFACTor components for each data set using the parameters <italic>k</italic>=6 and <italic>t</italic>=500 and according to the default implementation and recommended guidelines of ReFACTor as described in the GLINT tool [<xref ref-type="bibr" rid="CR41">41</xref>] and in a recent work [<xref ref-type="bibr" rid="CR19">19</xref>], while accounting for known covariates in each data set. More specifically, in the Hannum et al. data [<xref ref-type="bibr" rid="CR20">20</xref>], we accounted for age, sex, ethnicity, and batch information; in the Liu et al. data [<xref ref-type="bibr" rid="CR21">21</xref>], we accounted for age, sex, smoking status, and batch information; and in the two Hannon et al. data sets [<xref ref-type="bibr" rid="CR22">22</xref>], we accounted for age, sex, and case/control state. We used the first six ReFACTor components (<italic>d</italic>=6) for simulated data in order to accommodate with the number of simulated cell types, and the first ten components (<italic>d</italic>=10) for real data, as real data are typically more complex and are therefore more likely to contain substantial signal in latter components.</p><p>The NNMF components were computed for each data set using the default setup of the RefFreeEWAS R package from the subset of 10,000 most variable sites in the data set, as performed in the NNMF paper by the authors [<xref ref-type="bibr" rid="CR9">9</xref>]. Similarly, the MeDeCom components were computed for each data set using the default setup of the MeDeCom R package [<xref ref-type="bibr" rid="CR10">10</xref>] from the subset of 10,000 most variable sites in the data set, as repeatedly running the method on the entire set of CpGs was revealed to be computationally prohibitive. The regularization parameter <italic>&#x003bb;</italic> was selected according to a minimum cross-validation error criterion, as instructed in the MeDeCom package.</p><p>We used the GLINT tool [<xref ref-type="bibr" rid="CR41">41</xref>] for estimating blood cell-type proportions for each one of the data sets, according to the Houseman et al. method [<xref ref-type="bibr" rid="CR5">5</xref>], using 300 highly informative methylation sites defined in a recent study [<xref ref-type="bibr" rid="CR24">24</xref>] and using reference data collected from sorted blood cells [<xref ref-type="bibr" rid="CR11">11</xref>].</p></sec><sec id="Sec18"><title>Data sets</title><p>We evaluated the performance of BayesCCE using a total of six data sets, as described below. For the real data experiments, we downloaded four publicly available Illumina 450K DNA methylation array data sets from the Gene Expression Omnibus (GEO) database: a data set by Hannum et al. (accession GSE40279) from a study of aging rate [<xref ref-type="bibr" rid="CR20">20</xref>], a data set by Liu et al. (accession GSE42861) from a recent association study of DNA methylation with rheumatoid arthritis [<xref ref-type="bibr" rid="CR21">21</xref>], and two data sets by Hannon et al. (accessions GSE80417 and GSE84727; denote Hannon et al. I and Hannon et al. II) from a recent association study of DNA methylation with schizophrenia.</p><p>We preprocessed the data according to a recently suggested normalization pipeline [<xref ref-type="bibr" rid="CR43">43</xref>]. Specifically, we retrieved and processed raw IDAT methylation files using R and the minfi R package [<xref ref-type="bibr" rid="CR44">44</xref>] as follows. We removed 65 single nucleotide polymorphism (SNP) markers and applied the Illumina background correction to all intensity values, while separately analyzing probes coming from autosomal and non-autosomal chromosomes. We used a detection <italic>p</italic> value threshold of <italic>p</italic> value &#x0003c;&#x02009;10<sup>&#x02212;16</sup> for intensity values, setting probes with <italic>p</italic> values higher than this threshold to be missing values. Based on these missing values, we excluded samples with call rates &#x0003c;&#x02009;95<italic>%</italic>. Since IDAT files were not made available for the Hannum et al. data set, we used the methylation intensity levels published by the authors.</p><p>As for data normalization, following the same suggested pipeline [<xref ref-type="bibr" rid="CR43">43</xref>], we performed a quantile normalization of the methylation intensity values, subdivided by probe type, probe sub-type, and color channel. Beta-normalized methylation levels were eventually calculated based on intensity levels (according to the recommendation by Illumina). On top of that, we excluded probes with over 10% missing values and used the &#x0201c;impute&#x0201d; R package for imputing remaining missing values. Additionally, using GLINT [<xref ref-type="bibr" rid="CR41">41</xref>], we excluded from each data set all CpGs coming from the non-autosomal chromosomes, as well as polymorphic and cross-reactive sites, as was previously suggested [<xref ref-type="bibr" rid="CR45">45</xref>].</p><p>We further removed outlier samples and samples with missing covariates. In more details, we removed six samples from the Hannum et al. data set and two samples from the Liu et al. data set, which demonstrated extreme values in their first two principal components (over four empirical standard deviations). Furthermore, we removed from the Liu et al. data set two additional remaining samples that were regarded as outliers in the original study of Liu et al., and we removed from the Hannon et al. data sets samples with missing age information. The final numbers of samples remained for analysis were <italic>n</italic>=650,<italic>n</italic>=658, <italic>n</italic>=638, and <italic>n</italic>=656, and the numbers of CpGs remained were 382,158, 376,021, 381,338, and 382,158, for the Hannum et al. data set, Liu et al. data set, and the Hannon et al. I and Hannon et al. II data sets, respectively.</p><p>For learning prior information about the distribution of blood cell-type proportions, we used electronic medical record (EMR)-based study data that were acquired via the previously published Department of Anesthesiology and Perioperative Medicine at UCLA&#x02019;s perioperative data warehouse (PDW) [<xref ref-type="bibr" rid="CR46">46</xref>]. The PDW is a structured reporting schema that contains all the relevant clinical data entered into an EMR via the use of Clarity, the relational database created by EPIC (EPIC Systems, Verona, WI) for data analytics and reporting. We used high-resolution cell count measurements from adult individuals (<italic>n</italic>=595) for fitting a Dirichlet distribution. The resulted parameters of the prior were 15.0727, 1.8439, 2.5392, 1.7934, 0.7240, and 0.7404 for granulocytes, monocytes, CD4+, CD8+, B cells, and NK cells, respectively. The parameters of the prior calculated for the case of three assumed cell types (<italic>k</italic>=3) were 7.7681, 0.9503, and 2.9876 for granulocytes, monocytes, and lymphocytes, respectively. Finally, for generating simulated data sets and for generating correlation maps of cell-type-specific methylomes, we used publicly available data of methylation reference of sorted cell types collected in six individuals from whole-blood tissue (GEO accession GSE35069) [<xref ref-type="bibr" rid="CR11">11</xref>].</p></sec><sec id="Sec19"><title>Data simulation</title><p>We simulated data following a model that was previously described in details elsewhere [<xref ref-type="bibr" rid="CR8">8</xref>]. Briefly, we used methylation levels from sorted blood cells [<xref ref-type="bibr" rid="CR11">11</xref>] and, assuming normality, estimated maximum likelihood parameters for each site in each cell type. Cell-type-specific DNA methylation data were then generated for each simulated individual from normal distributions with the estimated parameters, conditional on the range [0,1], for six cell types and for each site. Cell proportions for each individual were generated using a Dirichlet distribution with the same parameters used in the real data analysis. Eventually, observed DNA methylation levels were composed from the cell-type-specific methylation levels and cell proportions for each individual, and a random normal noise was added to every data entry to simulate technical noise (<italic>&#x003c3;</italic> = 0.01). To simulate inaccuracies of the prior, the Dirichlet parameters required by BayesCCE were learned from cell-type proportions of 50 samples generated at random from a Dirichlet distribution using the parameters learned from real data.</p></sec></sec><sec sec-type="supplementary-material"><title>Additional files</title><sec id="Sec20"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="13059_2018_1513_MOESM1_ESM.pdf"><label>Additional file 1</label><caption><p>Supplementary Tables and Figures. (PDF 1277 kb)</p></caption></media></supplementary-material>
</p><p>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="13059_2018_1513_MOESM2_ESM.docx"><label>Additional file 2</label><caption><p>Review history. (DOCX 91 kb)</p></caption></media></supplementary-material>
</p></sec></sec></body><back><ack><sec id="d29e4881"><title>Funding</title><p>This research was partially supported by the Edmond J. Safra Center for Bioinformatics at Tel Aviv University. E.H., E.R., L.S., and R.S. were supported in part by the Israel Science Foundation (grant 1425/13), and E.H., L.S., and R.S. by the United States Israel Binational Science Foundation grant 2012304. EH and ER were partially supported by the National Science Foundation (NSF) grant 1705197. E.R. and L.S. were supported by Len Blavatnik and the Blavatnik Research Foundation. R.S. was supported by the Colton Family Foundation. E.E. was supported by the National Science Foundation grants 0513612, 0731455, 0729049, 0916676, 1065276, 1302448, 1320589, and 1331176, and National Institutes of Health grants K25-HL080079, U01-DA024417, P01-HL30568, P01-HL28481, R01-GM083198, R01-ES021801, R01-MH101782, and R01-ES022282.</p></sec><sec id="d29e4886"><title>Availability of data and materials</title><p>The data sets analyzed in this study are available in the Gene Expression Omnibus (GEO) repository under the following accession IDs: GSE35069 [<xref ref-type="bibr" rid="CR11">11</xref>], GSE40279 [<xref ref-type="bibr" rid="CR20">20</xref>], GSE42861 [<xref ref-type="bibr" rid="CR21">21</xref>], GSE80417 [<xref ref-type="bibr" rid="CR22">22</xref>], and GSE84727 [<xref ref-type="bibr" rid="CR22">22</xref>]. The BayesCCE source code has been deposited in Zenodo (10.5281/zenodo.1293009) [<xref ref-type="bibr" rid="CR47">47</xref>] and is available from GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/cozygene/BayesCCE">https://github.com/cozygene/BayesCCE</ext-link>) under the GPL-3 license [<xref ref-type="bibr" rid="CR48">48</xref>].</p></sec><sec id="d29e4923"><title>Review history</title><p>The review history is included as Additional file&#x000a0;<xref rid="MOESM2" ref-type="media">2</xref>.</p></sec></ack><notes notes-type="author-contribution"><title>Authors&#x02019; contributions</title><p>ER and EH conceived and designed the project. ER performed the data analysis. RS, LS, and EE contributed expertise. TW, IH, and EG generated and contributed data. ER and EH drafted the manuscript. All authors read and approved the manuscript.</p></notes><notes notes-type="COI-statement"><sec><title>Ethics approval and consent to participate</title><p>Not applicable.</p></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Publisher&#x02019;s Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koch</surname><given-names>MW</given-names></name><name><surname>Metz</surname><given-names>LM</given-names></name><name><surname>Kovalchuk</surname><given-names>O</given-names></name></person-group><article-title>Epigenetic changes in patients with multiple sclerosis</article-title><source>Nat Rev Neurol</source><year>2013</year><volume>9</volume><issue>1</issue><fpage>35</fpage><lpage>43</lpage><pub-id pub-id-type="doi">10.1038/nrneurol.2012.226</pub-id><pub-id pub-id-type="pmid">23165337</pub-id></element-citation></ref><ref id="CR2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ikegame</surname><given-names>T</given-names></name><name><surname>Bundo</surname><given-names>M</given-names></name><name><surname>Sunaga</surname><given-names>F</given-names></name><name><surname>Asai</surname><given-names>T</given-names></name><name><surname>Nishimura</surname><given-names>F</given-names></name><name><surname>Yoshikawa</surname><given-names>A</given-names></name><name><surname>Kawamura</surname><given-names>Y</given-names></name><name><surname>Hibino</surname><given-names>H</given-names></name><name><surname>Tochigi</surname><given-names>M</given-names></name><name><surname>Kakiuchi</surname><given-names>C</given-names></name><etal/></person-group><article-title>DNA methylation analysis of BDNF gene promoters in peripheral blood cells of schizophrenia patients</article-title><source>Neurosci Res</source><year>2013</year><volume>77</volume><issue>4</issue><fpage>208</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1016/j.neures.2013.08.004</pub-id><pub-id pub-id-type="pmid">23973796</pub-id></element-citation></ref><ref id="CR3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Toperoff</surname><given-names>G</given-names></name><name><surname>Aran</surname><given-names>D</given-names></name><name><surname>Kark</surname><given-names>JD</given-names></name><name><surname>Rosenberg</surname><given-names>M</given-names></name><name><surname>Dubnikov</surname><given-names>T</given-names></name><name><surname>Nissan</surname><given-names>B</given-names></name><name><surname>Wainstein</surname><given-names>J</given-names></name><name><surname>Friedlander</surname><given-names>Y</given-names></name><name><surname>Levy-Lahad</surname><given-names>E</given-names></name><name><surname>Glaser</surname><given-names>B</given-names></name><etal/></person-group><article-title>Genome-wide survey reveals predisposing diabetes type 2-related dna methylation variations in human peripheral blood</article-title><source>Hum Mol Genet</source><year>2012</year><volume>21</volume><issue>2</issue><fpage>371</fpage><lpage>83</lpage><pub-id pub-id-type="doi">10.1093/hmg/ddr472</pub-id><pub-id pub-id-type="pmid">21994764</pub-id></element-citation></ref><ref id="CR4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaffe</surname><given-names>AE</given-names></name><name><surname>Irizarry</surname><given-names>RA</given-names></name></person-group><article-title>Accounting for cellular heterogeneity is critical in epigenome-wide association studies</article-title><source>Genome Biol</source><year>2014</year><volume>15</volume><issue>2</issue><fpage>31</fpage><pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r31</pub-id></element-citation></ref><ref id="CR5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Houseman</surname><given-names>EA</given-names></name><name><surname>Accomando</surname><given-names>WP</given-names></name><name><surname>Koestler</surname><given-names>DC</given-names></name><name><surname>Christensen</surname><given-names>BC</given-names></name><name><surname>Marsit</surname><given-names>CJ</given-names></name><name><surname>Nelson</surname><given-names>HH</given-names></name><name><surname>Wiencke</surname><given-names>JK</given-names></name><name><surname>Kelsey</surname><given-names>KT</given-names></name></person-group><article-title>DNA methylation arrays as surrogate measures of cell mixture distribution</article-title><source>BMC Bioinforma</source><year>2012</year><volume>13</volume><issue>1</issue><fpage>86</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-13-86</pub-id></element-citation></ref><ref id="CR6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Houseman</surname><given-names>EA</given-names></name><name><surname>Molitor</surname><given-names>J</given-names></name><name><surname>Marsit</surname><given-names>CJ</given-names></name></person-group><article-title>Reference-free cell mixture adjustments in analysis of DNA methylation data</article-title><source>Bioinformatics</source><year>2014</year><volume>30</volume><issue>10</issue><fpage>1431</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu029</pub-id><pub-id pub-id-type="pmid">24451622</pub-id></element-citation></ref><ref id="CR7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zou</surname><given-names>J</given-names></name><name><surname>Lippert</surname><given-names>C</given-names></name><name><surname>Heckerman</surname><given-names>D</given-names></name><name><surname>Aryee</surname><given-names>M</given-names></name><name><surname>Listgarten</surname><given-names>J</given-names></name></person-group><article-title>Epigenome-wide association studies without the need for cell-type composition</article-title><source>Nat Methods</source><year>2014</year><volume>11</volume><issue>3</issue><fpage>309</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2815</pub-id><pub-id pub-id-type="pmid">24464286</pub-id></element-citation></ref><ref id="CR8"><label>8</label><mixed-citation publication-type="other">Rahmani E, Zaitlen N, Baran Y, Eng C, Hu D, Galanter J, Oh S, Burchard EG, Eskin E, Zou J, et al. Sparse PCA corrects for cell type heterogeneity in epigenome-wide association studies. Nat Methods; 13(5):443&#x02013;5.</mixed-citation></ref><ref id="CR9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Houseman</surname><given-names>EA</given-names></name><name><surname>Kile</surname><given-names>ML</given-names></name><name><surname>Christiani</surname><given-names>DC</given-names></name><name><surname>Ince</surname><given-names>TA</given-names></name><name><surname>Kelsey</surname><given-names>KT</given-names></name><name><surname>Marsit</surname><given-names>CJ</given-names></name></person-group><article-title>Reference-free deconvolution of DNA methylation data and mediation by cell composition effects</article-title><source>BMC Bioinforma</source><year>2016</year><volume>17</volume><issue>1</issue><fpage>259</fpage><pub-id pub-id-type="doi">10.1186/s12859-016-1140-4</pub-id></element-citation></ref><ref id="CR10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lutsik</surname><given-names>P</given-names></name><name><surname>Slawski</surname><given-names>M</given-names></name><name><surname>Gasparoni</surname><given-names>G</given-names></name><name><surname>Vedeneev</surname><given-names>N</given-names></name><name><surname>Hein</surname><given-names>M</given-names></name><name><surname>Walter</surname><given-names>J</given-names></name></person-group><article-title>MeDeCom: discovery and quantification of latent components of heterogeneous methylomes</article-title><source>Genome Biol</source><year>2017</year><volume>18</volume><issue>1</issue><fpage>55</fpage><pub-id pub-id-type="doi">10.1186/s13059-017-1182-6</pub-id><pub-id pub-id-type="pmid">28340624</pub-id></element-citation></ref><ref id="CR11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reinius</surname><given-names>LE</given-names></name><name><surname>Acevedo</surname><given-names>N</given-names></name><name><surname>Joerink</surname><given-names>M</given-names></name><name><surname>Pershagen</surname><given-names>G</given-names></name><name><surname>Dahl&#x000e9;n</surname><given-names>SE</given-names></name><name><surname>Greco</surname><given-names>D</given-names></name><name><surname>S&#x000f6;derh&#x000e4;ll</surname><given-names>C</given-names></name><name><surname>Scheynius</surname><given-names>A</given-names></name><name><surname>Kere</surname><given-names>J</given-names></name></person-group><article-title>Differential DNA methylation in purified human blood cells: implications for cell lineage and studies on disease susceptibility</article-title><source>PloS ONE</source><year>2012</year><volume>7</volume><issue>7</issue><fpage>41361</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0041361</pub-id></element-citation></ref><ref id="CR12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Teschendorff</surname><given-names>AE</given-names></name><name><surname>Gao</surname><given-names>Y</given-names></name><name><surname>Jones</surname><given-names>A</given-names></name><name><surname>Ruebner</surname><given-names>M</given-names></name><name><surname>Beckmann</surname><given-names>MW</given-names></name><name><surname>Wachter</surname><given-names>DL</given-names></name><name><surname>Fasching</surname><given-names>PA</given-names></name><name><surname>Widschwendter</surname><given-names>M</given-names></name></person-group><article-title>DNA methylation outliers in normal breast tissue identify field defects that are enriched in cancer</article-title><source>Nat Commun</source><year>2016</year><volume>7</volume><fpage>10478</fpage><pub-id pub-id-type="doi">10.1038/ncomms10478</pub-id><pub-id pub-id-type="pmid">26823093</pub-id></element-citation></ref><ref id="CR13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guintivano</surname><given-names>J</given-names></name><name><surname>Aryee</surname><given-names>MJ</given-names></name><name><surname>Kaminsky</surname><given-names>ZA</given-names></name></person-group><article-title>A cell epigenotype specific model for the correction of brain cellular heterogeneity bias and its application to age, brain region and major depression</article-title><source>Epigenetics</source><year>2013</year><volume>8</volume><issue>3</issue><fpage>290</fpage><lpage>302</lpage><pub-id pub-id-type="doi">10.4161/epi.23924</pub-id><pub-id pub-id-type="pmid">23426267</pub-id></element-citation></ref><ref id="CR14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Horvath</surname><given-names>S</given-names></name></person-group><article-title>DNA methylation age of human tissues and cell types</article-title><source>Genome Biol</source><year>2013</year><volume>14</volume><issue>10</issue><fpage>115</fpage><pub-id pub-id-type="doi">10.1186/gb-2013-14-10-r115</pub-id><pub-id pub-id-type="pmid">23657273</pub-id></element-citation></ref><ref id="CR15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singmann</surname><given-names>P</given-names></name><name><surname>Shem-Tov</surname><given-names>D</given-names></name><name><surname>Wahl</surname><given-names>S</given-names></name><name><surname>Grallert</surname><given-names>H</given-names></name><name><surname>Fiorito</surname><given-names>G</given-names></name><name><surname>Shin</surname><given-names>SY</given-names></name><name><surname>Schramm</surname><given-names>K</given-names></name><name><surname>Wolf</surname><given-names>P</given-names></name><name><surname>Kunze</surname><given-names>S</given-names></name><name><surname>Baran</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Characterization of whole-genome autosomal differences of DNA methylation between men and women</article-title><source>Epigenetics chromatin</source><year>2015</year><volume>8</volume><issue>1</issue><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1186/s13072-015-0035-3</pub-id><pub-id pub-id-type="pmid">25621012</pub-id></element-citation></ref><ref id="CR16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yousefi</surname><given-names>P</given-names></name><name><surname>Huen</surname><given-names>K</given-names></name><name><surname>Dav&#x000e9;</surname><given-names>V</given-names></name><name><surname>Barcellos</surname><given-names>L</given-names></name><name><surname>Eskenazi</surname><given-names>B</given-names></name><name><surname>Holland</surname><given-names>N</given-names></name></person-group><article-title>Sex differences in DNA methylation assessed by 450 K BeadChip in newborns</article-title><source>BMC Genomics</source><year>2015</year><volume>16</volume><issue>1</issue><fpage>1</fpage><pub-id pub-id-type="doi">10.1186/s12864-015-2034-y</pub-id><pub-id pub-id-type="pmid">25553907</pub-id></element-citation></ref><ref id="CR17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rahmani</surname><given-names>E</given-names></name><name><surname>Shenhav</surname><given-names>L</given-names></name><name><surname>Schweiger</surname><given-names>R</given-names></name><name><surname>Yousefi</surname><given-names>P</given-names></name><name><surname>Huen</surname><given-names>K</given-names></name><name><surname>Eskenazi</surname><given-names>B</given-names></name><name><surname>Eng</surname><given-names>C</given-names></name><name><surname>Huntsman</surname><given-names>S</given-names></name><name><surname>Hu</surname><given-names>D</given-names></name><name><surname>Galanter</surname><given-names>J</given-names></name><etal/></person-group><article-title>Genome-wide methylation data mirror ancestry information</article-title><source>Epigenetics Chromatin</source><year>2017</year><volume>10</volume><issue>1</issue><fpage>1</fpage><pub-id pub-id-type="doi">10.1186/s13072-016-0108-y</pub-id><pub-id pub-id-type="pmid">28149326</pub-id></element-citation></ref><ref id="CR18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yousefi</surname><given-names>P</given-names></name><name><surname>Huen</surname><given-names>K</given-names></name><name><surname>Quach</surname><given-names>H</given-names></name><name><surname>Motwani</surname><given-names>G</given-names></name><name><surname>Hubbard</surname><given-names>A</given-names></name><name><surname>Eskenazi</surname><given-names>B</given-names></name><name><surname>Holland</surname><given-names>N</given-names></name></person-group><article-title>Estimation of blood cellular heterogeneity in newborns and children for epigenome-wide association studies</article-title><source>Environ Mol Mutagen</source><year>2015</year><volume>56</volume><issue>9</issue><fpage>751</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1002/em.21966</pub-id><pub-id pub-id-type="pmid">26332589</pub-id></element-citation></ref><ref id="CR19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rahmani</surname><given-names>E</given-names></name><name><surname>Zaitlen</surname><given-names>N</given-names></name><name><surname>Baran</surname><given-names>Y</given-names></name><name><surname>Eng</surname><given-names>C</given-names></name><name><surname>Hu</surname><given-names>D</given-names></name><name><surname>Galanter</surname><given-names>J</given-names></name><name><surname>Oh</surname><given-names>S</given-names></name><name><surname>Burchard</surname><given-names>E</given-names></name><name><surname>Eskin</surname><given-names>E</given-names></name><name><surname>Zou</surname><given-names>J</given-names></name><etal/></person-group><article-title>Correcting for cell-type heterogeneity in dna methylation: a comprehensive evaluation</article-title><source>Nat Methods</source><year>2017</year><volume>14</volume><issue>3</issue><fpage>218</fpage><pub-id pub-id-type="doi">10.1038/nmeth.4190</pub-id><pub-id pub-id-type="pmid">28245214</pub-id></element-citation></ref><ref id="CR20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hannum</surname><given-names>G</given-names></name><name><surname>Guinney</surname><given-names>J</given-names></name><name><surname>Zhao</surname><given-names>L</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Hughes</surname><given-names>G</given-names></name><name><surname>Sadda</surname><given-names>S</given-names></name><name><surname>Klotzle</surname><given-names>B</given-names></name><name><surname>Bibikova</surname><given-names>M</given-names></name><name><surname>Fan</surname><given-names>JB</given-names></name><name><surname>Gao</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Genome-wide methylation profiles reveal quantitative views of human aging rates</article-title><source>Mol Cell</source><year>2013</year><volume>49</volume><issue>2</issue><fpage>359</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2012.10.016</pub-id><pub-id pub-id-type="pmid">23177740</pub-id></element-citation></ref><ref id="CR21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Aryee</surname><given-names>MJ</given-names></name><name><surname>Padyukov</surname><given-names>L</given-names></name><name><surname>Fallin</surname><given-names>MD</given-names></name><name><surname>Hesselberg</surname><given-names>E</given-names></name><name><surname>Runarsson</surname><given-names>A</given-names></name><name><surname>Reinius</surname><given-names>L</given-names></name><name><surname>Acevedo</surname><given-names>N</given-names></name><name><surname>Taub</surname><given-names>M</given-names></name><name><surname>Ronninger</surname><given-names>M</given-names></name><etal/></person-group><article-title>Epigenome-wide association data implicate DNA methylation as an intermediary of genetic risk in rheumatoid arthritis</article-title><source>Nat Biotechnol</source><year>2013</year><volume>31</volume><issue>2</issue><fpage>142</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1038/nbt.2487</pub-id><pub-id pub-id-type="pmid">23334450</pub-id></element-citation></ref><ref id="CR22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hannon</surname><given-names>E</given-names></name><name><surname>Dempster</surname><given-names>E</given-names></name><name><surname>Viana</surname><given-names>J</given-names></name><name><surname>Burrage</surname><given-names>J</given-names></name><name><surname>Smith</surname><given-names>AR</given-names></name><name><surname>Macdonald</surname><given-names>R</given-names></name><name><surname>St Clair</surname><given-names>D</given-names></name><name><surname>Mustard</surname><given-names>C</given-names></name><name><surname>Breen</surname><given-names>G</given-names></name><name><surname>Therman</surname><given-names>S</given-names></name><etal/></person-group><article-title>An integrated genetic-epigenetic analysis of schizophrenia: evidence for co-localization of genetic associations and differential DNA methylation</article-title><source>Genome Biol</source><year>2016</year><volume>17</volume><issue>1</issue><fpage>176</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-1041-x</pub-id><pub-id pub-id-type="pmid">27572077</pub-id></element-citation></ref><ref id="CR23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koestler</surname><given-names>DC</given-names></name><name><surname>Christensen</surname><given-names>BC</given-names></name><name><surname>Karagas</surname><given-names>MR</given-names></name><name><surname>Marsit</surname><given-names>CJ</given-names></name><name><surname>Langevin</surname><given-names>SM</given-names></name><name><surname>Kelsey</surname><given-names>KT</given-names></name><name><surname>Wiencke</surname><given-names>JK</given-names></name><name><surname>Houseman</surname><given-names>EA</given-names></name></person-group><article-title>Blood-based profiles of DNA methylation predict the underlying distribution of cell types: a validation analysis</article-title><source>Epigenetics</source><year>2013</year><volume>8</volume><issue>8</issue><fpage>816</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.4161/epi.25430</pub-id><pub-id pub-id-type="pmid">23903776</pub-id></element-citation></ref><ref id="CR24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koestler</surname><given-names>DC</given-names></name><name><surname>Jones</surname><given-names>MJ</given-names></name><name><surname>Usset</surname><given-names>J</given-names></name><name><surname>Christensen</surname><given-names>BC</given-names></name><name><surname>Butler</surname><given-names>RA</given-names></name><name><surname>Kobor</surname><given-names>MS</given-names></name><name><surname>Wiencke</surname><given-names>JK</given-names></name><name><surname>Kelsey</surname><given-names>KT</given-names></name></person-group><article-title>Improving cell mixture deconvolution by id entifying o ptimal dna methylation l ibraries (idol)</article-title><source>BMC Bioinforma</source><year>2016</year><volume>17</volume><issue>1</issue><fpage>1</fpage><pub-id pub-id-type="doi">10.1186/s12859-016-0943-7</pub-id></element-citation></ref><ref id="CR25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cardenas</surname><given-names>A</given-names></name><name><surname>Allard</surname><given-names>C</given-names></name><name><surname>Doyon</surname><given-names>M</given-names></name><name><surname>Houseman</surname><given-names>EA</given-names></name><name><surname>Bakulski</surname><given-names>KM</given-names></name><name><surname>Perron</surname><given-names>P</given-names></name><name><surname>Bouchard</surname><given-names>L</given-names></name><name><surname>Hivert</surname><given-names>MF</given-names></name></person-group><article-title>Validation of a DNA methylation reference panel for the estimation of nucleated cells types in cord blood</article-title><source>Epigenetics</source><year>2016</year><volume>11</volume><issue>11</issue><fpage>773</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1080/15592294.2016.1233091</pub-id><pub-id pub-id-type="pmid">27668573</pub-id></element-citation></ref><ref id="CR26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lai</surname><given-names>CY</given-names></name><name><surname>Scarr</surname><given-names>E</given-names></name><name><surname>Udawela</surname><given-names>M</given-names></name><name><surname>Everall</surname><given-names>I</given-names></name><name><surname>Chen</surname><given-names>WJ</given-names></name><name><surname>Dean</surname><given-names>B</given-names></name></person-group><article-title>Biomarkers in schizophrenia: a focus on blood based diagnostics and theranostics</article-title><source>World J Psychiatry</source><year>2016</year><volume>6</volume><issue>1</issue><fpage>102</fpage><pub-id pub-id-type="doi">10.5498/wjp.v6.i1.102</pub-id><pub-id pub-id-type="pmid">27014601</pub-id></element-citation></ref><ref id="CR27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tekeo&#x0011f;lu</surname><given-names>&#x00130;</given-names></name><name><surname>G&#x000fc;rol</surname><given-names>G</given-names></name><name><surname>Harman</surname><given-names>H</given-names></name><name><surname>Karake&#x000e7;e</surname><given-names>E</given-names></name><name><surname>&#x000c7;ift&#x000e7;i</surname><given-names>&#x00130;H</given-names></name></person-group><article-title>Overlooked hematological markers of disease activity in rheumatoid arthritis</article-title><source>Int J Rheum Dis</source><year>2016</year><volume>19</volume><issue>11</issue><fpage>1078</fpage><lpage>82</lpage><pub-id pub-id-type="doi">10.1111/1756-185X.12805</pub-id><pub-id pub-id-type="pmid">26620362</pub-id></element-citation></ref><ref id="CR28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Solana</surname><given-names>R</given-names></name><name><surname>Alonso</surname><given-names>M</given-names></name><name><surname>Pena</surname><given-names>J</given-names></name></person-group><article-title>Natural killer cells in healthy aging</article-title><source>Exp Gerontol</source><year>1999</year><volume>34</volume><issue>3</issue><fpage>435</fpage><lpage>43</lpage><pub-id pub-id-type="doi">10.1016/S0531-5565(99)00008-X</pub-id><pub-id pub-id-type="pmid">10433398</pub-id></element-citation></ref><ref id="CR29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Solana</surname><given-names>R</given-names></name><name><surname>Mariani</surname><given-names>E</given-names></name></person-group><article-title>NK and NK/T cells in human senescence</article-title><source>Vaccine</source><year>2000</year><volume>18</volume><issue>16</issue><fpage>1613</fpage><lpage>20</lpage><pub-id pub-id-type="doi">10.1016/S0264-410X(99)00495-8</pub-id><pub-id pub-id-type="pmid">10689137</pub-id></element-citation></ref><ref id="CR30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kawanaka</surname><given-names>N</given-names></name><name><surname>Yamamura</surname><given-names>M</given-names></name><name><surname>Aita</surname><given-names>T</given-names></name><name><surname>Morita</surname><given-names>Y</given-names></name><name><surname>Okamoto</surname><given-names>A</given-names></name><name><surname>Kawashima</surname><given-names>M</given-names></name><name><surname>Iwahashi</surname><given-names>M</given-names></name><name><surname>Ueno</surname><given-names>A</given-names></name><name><surname>Ohmoto</surname><given-names>Y</given-names></name><name><surname>Makino</surname><given-names>H</given-names></name></person-group><article-title>Cd14+, CD16+ blood monocytes and joint inflammation in rheumatoid arthritis</article-title><source>Arthritis Rheumatol</source><year>2002</year><volume>46</volume><issue>10</issue><fpage>2578</fpage><lpage>586</lpage><pub-id pub-id-type="doi">10.1002/art.10545</pub-id></element-citation></ref><ref id="CR31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wijngaarden</surname><given-names>S</given-names></name><name><surname>Van Roon</surname><given-names>J</given-names></name><name><surname>Bijlsma</surname><given-names>J</given-names></name><name><surname>Van De Winkel</surname><given-names>J</given-names></name><name><surname>Lafeber</surname><given-names>F</given-names></name></person-group><article-title>Fc <italic>&#x003b3;</italic> receptor expression levels on monocytes are elevated in rheumatoid arthritis patients with high erythrocyte sedimentation rate who do not use anti-rheumatic drugs</article-title><source>Rheumatology</source><year>2003</year><volume>42</volume><issue>5</issue><fpage>681</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1093/rheumatology/keg174</pub-id><pub-id pub-id-type="pmid">12709546</pub-id></element-citation></ref><ref id="CR32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iwahashi</surname><given-names>M</given-names></name><name><surname>Yamamura</surname><given-names>M</given-names></name><name><surname>Aita</surname><given-names>T</given-names></name><name><surname>Okamoto</surname><given-names>A</given-names></name><name><surname>Ueno</surname><given-names>A</given-names></name><name><surname>Ogawa</surname><given-names>N</given-names></name><name><surname>Akashi</surname><given-names>S</given-names></name><name><surname>Miyake</surname><given-names>K</given-names></name><name><surname>Godowski</surname><given-names>PJ</given-names></name><name><surname>Makino</surname><given-names>H</given-names></name></person-group><article-title>Expression of Toll-like receptor 2 on CD16+ blood monocytes and synovial tissue macrophages in rheumatoid arthritis</article-title><source>Arthritis Rheumatol</source><year>2004</year><volume>50</volume><issue>5</issue><fpage>1457</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1002/art.20219</pub-id></element-citation></ref><ref id="CR33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Azevedo</surname><given-names>FA</given-names></name><name><surname>Andrade-Moraes</surname><given-names>CH</given-names></name><name><surname>Curado</surname><given-names>MR</given-names></name><name><surname>Oliveira-Pinto</surname><given-names>AV</given-names></name><name><surname>Guimar&#x000e3;es</surname><given-names>DM</given-names></name><name><surname>Szczupak</surname><given-names>D</given-names></name><name><surname>Gomes</surname><given-names>BV</given-names></name><name><surname>Alho</surname><given-names>AT</given-names></name><name><surname>Polichiso</surname><given-names>L</given-names></name><name><surname>Tampellini</surname><given-names>E</given-names></name><etal/></person-group><article-title>Automatic isotropic fractionation for large-scale quantitative cell analysis of nervous tissue</article-title><source>J Neurosci Methods</source><year>2013</year><volume>212</volume><issue>1</issue><fpage>72</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2012.09.015</pub-id><pub-id pub-id-type="pmid">23017980</pub-id></element-citation></ref><ref id="CR34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pinto</surname><given-names>AR</given-names></name><name><surname>Ilinykh</surname><given-names>A</given-names></name><name><surname>Ivey</surname><given-names>MJ</given-names></name><name><surname>Kuwabara</surname><given-names>JT</given-names></name><name><surname>D&#x02019;Antoni</surname><given-names>ML</given-names></name><name><surname>Debuque</surname><given-names>R</given-names></name><name><surname>Chandran</surname><given-names>A</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Arora</surname><given-names>K</given-names></name><name><surname>Rosenthal</surname><given-names>NA</given-names></name><etal/></person-group><article-title>Revisiting cardiac cellular composition</article-title><source>Circ Res</source><year>2016</year><volume>118</volume><issue>3</issue><fpage>400</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1161/CIRCRESAHA.115.307778</pub-id><pub-id pub-id-type="pmid">26635390</pub-id></element-citation></ref><ref id="CR35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Divoux</surname><given-names>A</given-names></name><name><surname>Tordjman</surname><given-names>J</given-names></name><name><surname>Lacasa</surname><given-names>D</given-names></name><name><surname>Veyrie</surname><given-names>N</given-names></name><name><surname>Hugol</surname><given-names>D</given-names></name><name><surname>Aissat</surname><given-names>A</given-names></name><name><surname>Basdevant</surname><given-names>A</given-names></name><name><surname>Guerre-Millo</surname><given-names>M</given-names></name><name><surname>Poitou</surname><given-names>C</given-names></name><name><surname>Zucker</surname><given-names>JD</given-names></name><etal/></person-group><article-title>Fibrosis in human adipose tissue: composition, distribution, and link with lipid metabolism and fat mass loss</article-title><source>Diabetes</source><year>2010</year><volume>59</volume><issue>11</issue><fpage>2817</fpage><lpage>825</lpage><pub-id pub-id-type="doi">10.2337/db10-0585</pub-id><pub-id pub-id-type="pmid">20713683</pub-id></element-citation></ref><ref id="CR36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>P</given-names></name><name><surname>Nakorchevskiy</surname><given-names>A</given-names></name><name><surname>Marcotte</surname><given-names>EM</given-names></name></person-group><article-title>Expression deconvolution: a reinterpretation of dna microarray data reveals dynamic changes in cell populations</article-title><source>Proc Natl Acad Sci</source><year>2003</year><volume>100</volume><issue>18</issue><fpage>10370</fpage><lpage>5</lpage><pub-id pub-id-type="doi">10.1073/pnas.1832361100</pub-id><pub-id pub-id-type="pmid">12934019</pub-id></element-citation></ref><ref id="CR37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abbas</surname><given-names>AR</given-names></name><name><surname>Wolslegel</surname><given-names>K</given-names></name><name><surname>Seshasayee</surname><given-names>D</given-names></name><name><surname>Modrusan</surname><given-names>Z</given-names></name><name><surname>Clark</surname><given-names>HF</given-names></name></person-group><article-title>Deconvolution of blood microarray data identifies cellular activation patterns in systemic lupus erythematosus</article-title><source>PloS ONE</source><year>2009</year><volume>4</volume><issue>7</issue><fpage>6098</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0006098</pub-id></element-citation></ref><ref id="CR38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuhn</surname><given-names>A</given-names></name><name><surname>Thu</surname><given-names>D</given-names></name><name><surname>Waldvogel</surname><given-names>HJ</given-names></name><name><surname>Faull</surname><given-names>RL</given-names></name><name><surname>Luthi-Carter</surname><given-names>R</given-names></name></person-group><article-title>Population-specific expression analysis (PSEA) reveals molecular changes in diseased brain</article-title><source>Nat Methods</source><year>2011</year><volume>8</volume><issue>11</issue><fpage>945</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1710</pub-id><pub-id pub-id-type="pmid">21983921</pub-id></element-citation></ref><ref id="CR39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zuckerman</surname><given-names>NS</given-names></name><name><surname>Noam</surname><given-names>Y</given-names></name><name><surname>Goldsmith</surname><given-names>AJ</given-names></name><name><surname>Lee</surname><given-names>PP</given-names></name></person-group><article-title>A self-directed method for cell-type identification and separation of gene expression microarrays</article-title><source>PLoS Comput Biol</source><year>2013</year><volume>9</volume><issue>8</issue><fpage>1003189</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003189</pub-id></element-citation></ref><ref id="CR40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steuerman</surname><given-names>Y</given-names></name><name><surname>Gat-Viks</surname><given-names>I</given-names></name></person-group><article-title>Exploiting gene-expression deconvolution to probe the genetics of the immune system</article-title><source>PLoS Comput Biol</source><year>2016</year><volume>12</volume><issue>4</issue><fpage>1004856</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004856</pub-id></element-citation></ref><ref id="CR41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rahmani</surname><given-names>E</given-names></name><name><surname>Yedidim</surname><given-names>R</given-names></name><name><surname>Shenhav</surname><given-names>L</given-names></name><name><surname>Schweiger</surname><given-names>R</given-names></name><name><surname>Weissbrod</surname><given-names>O</given-names></name><name><surname>Zaitlen</surname><given-names>N</given-names></name><name><surname>Halperin</surname><given-names>E</given-names></name></person-group><article-title>GLINT: a user-friendly toolset for the analysis of high-throughput DNA-methylation array data</article-title><source>Bioinformatics</source><year>2017</year><volume>33</volume><issue>12</issue><fpage>1870</fpage><lpage>2</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btx059</pub-id><pub-id pub-id-type="pmid">28177067</pub-id></element-citation></ref><ref id="CR42"><label>42</label><mixed-citation publication-type="other">Minka T. Estimating a Dirichlet distribution. Technical report, MIT. 2000.</mixed-citation></ref><ref id="CR43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lehne</surname><given-names>B</given-names></name><name><surname>Drong</surname><given-names>AW</given-names></name><name><surname>Loh</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Scott</surname><given-names>WR</given-names></name><name><surname>Tan</surname><given-names>ST</given-names></name><name><surname>Afzal</surname><given-names>U</given-names></name><name><surname>Scott</surname><given-names>J</given-names></name><name><surname>Jarvelin</surname><given-names>MR</given-names></name><name><surname>Elliott</surname><given-names>P</given-names></name><etal/></person-group><article-title>A coherent approach for analysis of the Illumina HumanMethylation450 BeadChip improves data quality and performance in epigenome-wide association studies</article-title><source>Genome Biol</source><year>2015</year><volume>16</volume><issue>1</issue><fpage>37</fpage><pub-id pub-id-type="doi">10.1186/s13059-015-0600-x</pub-id><pub-id pub-id-type="pmid">25853392</pub-id></element-citation></ref><ref id="CR44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aryee</surname><given-names>MJ</given-names></name><name><surname>Jaffe</surname><given-names>AE</given-names></name><name><surname>Corrada-Bravo</surname><given-names>H</given-names></name><name><surname>Ladd-Acosta</surname><given-names>C</given-names></name><name><surname>Feinberg</surname><given-names>AP</given-names></name><name><surname>Hansen</surname><given-names>KD</given-names></name><name><surname>Irizarry</surname><given-names>RA</given-names></name></person-group><article-title>Minfi: a flexible and comprehensive bioconductor package for the analysis of infinium DNA methylation microarrays</article-title><source>Bioinformatics</source><year>2014</year><volume>30</volume><issue>10</issue><fpage>1363</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu049</pub-id><pub-id pub-id-type="pmid">24478339</pub-id></element-citation></ref><ref id="CR45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>Y-a</given-names></name><name><surname>Lemire</surname><given-names>M</given-names></name><name><surname>Choufani</surname><given-names>S</given-names></name><name><surname>Butcher</surname><given-names>DT</given-names></name><name><surname>Grafodatskaya</surname><given-names>D</given-names></name><name><surname>Zanke</surname><given-names>BW</given-names></name><name><surname>Gallinger</surname><given-names>S</given-names></name><name><surname>Hudson</surname><given-names>TJ</given-names></name><name><surname>Weksberg</surname><given-names>R</given-names></name></person-group><article-title>Discovery of cross-reactive probes and polymorphic CpGs in the Illumina Infinium HumanMethylation450 microarray</article-title><source>Epigenetics</source><year>2013</year><volume>8</volume><issue>2</issue><fpage>203</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.4161/epi.23470</pub-id><pub-id pub-id-type="pmid">23314698</pub-id></element-citation></ref><ref id="CR46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hofer</surname><given-names>IS</given-names></name><name><surname>Gabel</surname><given-names>E</given-names></name><name><surname>Pfeffer</surname><given-names>M</given-names></name><name><surname>Mahbouba</surname><given-names>M</given-names></name><name><surname>Mahajan</surname><given-names>A</given-names></name></person-group><article-title>A systematic approach to creation of a perioperative data warehouse</article-title><source>Anesth Analg</source><year>2016</year><volume>122</volume><issue>6</issue><fpage>1880</fpage><lpage>4</lpage><pub-id pub-id-type="doi">10.1213/ANE.0000000000001201</pub-id><pub-id pub-id-type="pmid">27195633</pub-id></element-citation></ref><ref id="CR47"><label>47</label><mixed-citation publication-type="other">Rahmani E, Schweiger R, Shenhav L, Theodora W, Hofer I, Gabel E, Eskin E, Halperin E. BayesCCE: a Bayesian framework for estimating cell-type composition from DNA methylation without the need for methylation reference. zenodo. 2018. 10.5281/zenodo.1293009.</mixed-citation></ref><ref id="CR48"><label>48</label><mixed-citation publication-type="other">Rahmani E, Schweiger R, Shenhav L, Theodora W, Hofer I, Gabel E, Eskin E, Halperin E. BayesCCE: a Bayesian framework for estimating cell-type composition from DNA methylation without the need for methylation reference. Github repository. 2018. <ext-link ext-link-type="uri" xlink:href="https://github.com/cozygene/BayesCCE">https://github.com/cozygene/BayesCCE</ext-link>.</mixed-citation></ref></ref-list></back></article>