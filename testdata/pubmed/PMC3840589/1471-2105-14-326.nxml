<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="product-review" xml:lang="en"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id><journal-title-group><journal-title>BMC Bioinformatics</journal-title></journal-title-group><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">24246037</article-id><article-id pub-id-type="pmc">3840589</article-id><article-id pub-id-type="publisher-id">1471-2105-14-326</article-id><article-id pub-id-type="doi">10.1186/1471-2105-14-326</article-id><article-categories><subj-group subj-group-type="heading"><subject>Software</subject></subj-group></article-categories><title-group><article-title>snp-search: simple processing, manipulation and searching of SNPs from high-throughput sequencing</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="A1"><name><surname>Al-Shahib</surname><given-names>Ali</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>ali.al-shahib@phe.gov.uk</email></contrib><contrib contrib-type="author" id="A2"><name><surname>Underwood</surname><given-names>Anthony</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>anthony.underwood@phe.gov.uk</email></contrib></contrib-group><aff id="I1"><label>1</label>Applied Bioinformatics and Laboratory Informatics Unit, Microbiology Services, Public Health England, 61 Colindale Avenue, London NW9 5EQ, UK</aff><pub-date pub-type="collection"><year>2013</year></pub-date><pub-date pub-type="epub"><day>19</day><month>11</month><year>2013</year></pub-date><volume>14</volume><fpage>326</fpage><lpage>326</lpage><history><date date-type="received"><day>11</day><month>6</month><year>2013</year></date><date date-type="accepted"><day>18</day><month>11</month><year>2013</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2013 Al-Shahib and Underwood; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2013</copyright-year><copyright-holder>Al-Shahib and Underwood; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><license-p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xlink:href="http://www.biomedcentral.com/1471-2105/14/326"/><abstract><sec><title>Background</title><p>A typical bacterial pathogen genome mapping project can identify thousands of single nucleotide polymorphisms (SNP). Interpreting SNP data is complex and it is difficult to conceptualise the data contained within the large flat files that are the typical output from most SNP calling algorithms. One solution to this problem is to construct a database that can be queried using simple commands so that SNP interrogation and output is both easy and comprehensible.</p></sec><sec><title>Results</title><p>Here we present snp-search, a tool that manages SNP data and allows for manipulation and searching of SNP data. After creation of a SNP database from a VCF file, snp-search can be used to convert the selected SNP data into FASTA sequences, construct phylogenies, look for unique SNPs, and output contextual information about each SNP. The FASTA output from snp-search is particularly useful for the generation of robust phylogenetic trees that are based on SNP differences across the conserved positions in whole genomes. Queries can be designed to answer critical genomic questions such as the association of SNPs with particular phenotypes.</p></sec><sec><title>Conclusions</title><p>snp-search is a tool that manages SNP data and outputs useful information which can be used to test important biological hypotheses.</p></sec></abstract><kwd-group><kwd>Single Nucleotide Polymorphisms (SNP)</kwd><kwd>Variant Call Format (VCF)</kwd><kwd>SQL database</kwd><kwd>High-throughput Sequencing</kwd><kwd>Next Generation Sequencing (NGS)</kwd><kwd>Ruby</kwd><kwd>Phylogeny</kwd></kwd-group></article-meta></front><body><sec><title>Background</title><p>Next Generation Sequencing (NGS) technologies have facilitated large scale resequencing of genomes for the purpose of Single Nucleotide polymorphism (SNP) discovery. The thousands of discovered SNPs during such projects can cause some difficulty for biological interpretation and computational analyses.</p><p>To address this challenge, various databases and tools have been created that annotate SNPs with information derived from a reference genome and store that information within a database [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B7">7</xref>].</p><p>While these tools have excelled at the management of the SNP data, less attention has been directed towards simple processing and searching of the stored data. For example, the tool developed by Wang <italic>et al</italic> for SNP management includes limited search functions and does not allow for advanced user database querying. Some databases like that described by Dereeper <italic>et al</italic> have implemented a web tool for SNP discovery and analysis. However, it does not accept Variant Call Format (VCF) files as input and is only applicable to diploid species. Another tool is SNPpy by Mitha <italic>et al</italic> which provides a database management system that allows for SQL querying and data manipulation. The SNPpy system is dependent on a relational database (PostgreSQL) that requires considerable expertise to administer and does not accept VCF. VCF files were an initiative from the 1000 Genomes Project [<xref ref-type="bibr" rid="B8">8</xref>] and are an output produced by many SNP calling programs such as dbSNPs [<xref ref-type="bibr" rid="B9">9</xref>], Samtools mpileup [<xref ref-type="bibr" rid="B10">10</xref>] and GATK [<xref ref-type="bibr" rid="B11">11</xref>].</p><p>There is a need therefore for a tool that extracts SNPs from VCF files, stores them into a simple database and provides multiple output options for analysis. To meet such a need, we have developed snp-search, an easy to use tool for management of SNPs generated from haploid next generation sequencing data. Given a VCF file, snp-search stores the SNPs generated by the variant calling algorithm into a sqlite database. Sqlite is a relational database contained in a single file and does not require complex management software. snp-search can then be used to extract useful information from the database. For example, by running snp-search using the command line syntax, the user can extract unique SNPs for a specified set of strains; generate a SNP phylogeny and provide detailed information about each individual SNP such as if it is a synonymous or non-synonymous SNP, gene information, etc (see Table&#x000a0;<xref ref-type="table" rid="T1">1</xref>). The snp-search database schema has been purposely designed to be simple so that it is easy to interpret findings from large and complex biological queries. Therefore a simple SQL join is able to extract data that will provide the power to answer questions about variation within the core genome quickly and easily. snp-search also has the ability to filter SNPs depending on the function of genes within which the SNPs are found. Furthermore there is no file size limit and no dependence on any external tool. The sole requirements are a Unix environment, SQLite, Ruby 1.8.7 or greater and optionally FastTree 2 [<xref ref-type="bibr" rid="B12">12</xref>] for phylogenetic tree construction. As far as we are aware, there are no available tools with similar features as snp-search in the literature.</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>ST315 clade unique SNP information - typical snp-search output for &#x02013;u option</p></caption><table frame="hsides" rules="groups" border="1"><colgroup><col align="left"/><col align="left"/><col align="left"/><col align="left"/><col align="left"/><col align="left"/><col align="left"/><col align="left"/><col align="left"/><col align="left"/><col align="left"/></colgroup><thead valign="top"><tr><th align="left"><bold>Pos</bold></th><th align="left"><bold>Ref base</bold></th><th align="left"><bold>SNP</bold></th><th align="left"><bold>syn/non-syn</bold></th><th align="left"><bold>Gene annotation</bold></th><th align="left"><bold>Pseudo gene?</bold></th><th align="left"><bold>AA orig</bold></th><th align="left"><bold>AA change</bold></th><th align="left"><bold>CH?</bold></th><th align="left"><bold>CP?</bold></th><th align="left"><bold>CS?</bold></th></tr></thead><tbody valign="top"><tr><td align="left" valign="bottom">16387<hr/></td><td align="left" valign="bottom">A<hr/></td><td align="left" valign="bottom">G<hr/></td><td align="left" valign="bottom">syn<hr/></td><td align="left" valign="bottom">putative amino acid permease<hr/></td><td align="left" valign="bottom">No<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td></tr><tr><td align="left" valign="bottom">512693<hr/></td><td align="left" valign="bottom">A<hr/></td><td align="left" valign="bottom">G<hr/></td><td align="left" valign="bottom">non-syn<hr/></td><td align="left" valign="bottom">putative dipeptidase<hr/></td><td align="left" valign="bottom">No<hr/></td><td align="left" valign="bottom">T<hr/></td><td align="left" valign="bottom">A<hr/></td><td align="left" valign="bottom">No<hr/></td><td align="left" valign="bottom">Yes<hr/></td><td align="left" valign="bottom">No<hr/></td></tr><tr><td align="left" valign="bottom">924493<hr/></td><td align="left" valign="bottom">T<hr/></td><td align="left" valign="bottom">C<hr/></td><td align="left" valign="bottom">non-syn<hr/></td><td align="left" valign="bottom">putative sugar ABC transporter (ATP-binding protein)<hr/></td><td align="left" valign="bottom">No<hr/></td><td align="left" valign="bottom">S<hr/></td><td align="left" valign="bottom">P<hr/></td><td align="left" valign="bottom">No<hr/></td><td align="left" valign="bottom">Yes<hr/></td><td align="left" valign="bottom">No<hr/></td></tr><tr><td align="left" valign="bottom">1108998<hr/></td><td align="left" valign="bottom">G<hr/></td><td align="left" valign="bottom">T<hr/></td><td align="left" valign="bottom">non-syn<hr/></td><td align="left" valign="bottom">putative N-acetylglucosamine-6-phosphate isomerase<hr/></td><td align="left" valign="bottom">No<hr/></td><td align="left" valign="bottom">A<hr/></td><td align="left" valign="bottom">S<hr/></td><td align="left" valign="bottom">Yes<hr/></td><td align="left" valign="bottom">Yes<hr/></td><td align="left" valign="bottom">No<hr/></td></tr><tr><td align="left" valign="bottom">1186147<hr/></td><td align="left" valign="bottom">C<hr/></td><td align="left" valign="bottom">T<hr/></td><td align="left" valign="bottom">syn<hr/></td><td align="left" valign="bottom">putative amino acid ABC transporter (ATP-binding protein)<hr/></td><td align="left" valign="bottom">No<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td></tr><tr><td align="left" valign="bottom">1573272<hr/></td><td align="left" valign="bottom">T<hr/></td><td align="left" valign="bottom">C<hr/></td><td align="left" valign="bottom">non-syn<hr/></td><td align="left" valign="bottom">putative sucrose operon repressor<hr/></td><td align="left" valign="bottom">No<hr/></td><td align="left" valign="bottom">L<hr/></td><td align="left" valign="bottom">S<hr/></td><td align="left" valign="bottom">Yes<hr/></td><td align="left" valign="bottom">Yes<hr/></td><td align="left" valign="bottom">Yes<hr/></td></tr><tr><td align="left" valign="bottom">1817279<hr/></td><td align="left" valign="bottom">C<hr/></td><td align="left" valign="bottom">T<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td><td align="left" valign="bottom">&#x000a0;<hr/></td></tr><tr><td align="left">1868362</td><td align="left">T</td><td align="left">C</td><td align="left">&#x000a0;</td><td align="left">&#x000a0;</td><td align="left">&#x000a0;</td><td align="left">&#x000a0;</td><td align="left">&#x000a0;</td><td align="left">&#x000a0;</td><td align="left">&#x000a0;</td><td align="left">&#x000a0;</td></tr></tbody></table><table-wrap-foot><p>Last two empty cells indicate the SNP has occurred in a non-CDS region therefore having no further information. Syn: synonymous, Pos: position of SNP in reference genome, AA: Amino acid, orig: original, CH: change in hydrophobicity, CP: change in polarity, CS: change in size.</p></table-wrap-foot></table-wrap></sec><sec><title>Implementation</title><p>snp-search is written in Ruby, a popular scripting language, and uses the Ruby ActiveRecord library that maps database tables to Ruby objects. It will run on most modern Unix-based architectures and can be installed with the command <italic>gem install snp-search</italic>.</p><p>snp-search has two fundamental features:</p><fig id="F1" position="float"><label>Figure 1</label><caption><p>snp-search database schema.</p></caption><graphic xlink:href="1471-2105-14-326-1"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p><bold>Snp-search machinery.</bold> Given a genbank and a VCF file, snp-search first creates the SQLite database and populates the data into the database. The user will then have the choice of various output options. Options include producing a SNP concatenated FASTA file, generating a newick-tree format file for phylogenetic analysis and a list of SNPs (depending on query) with information for every SNP (such as if the SNP is synonymous or non-synonymous).</p></caption><graphic xlink:href="1471-2105-14-326-2"/></fig><p>1. Creation of a local SQLite database and schema</p><p>To create the database, data is sourced from two input files: reference genome (in genbank or EMBL format) and a VCF file. snp-search requires the reference genome used in the mapping process to import the features (genes, etc) and annotations into the database and requires the VCF file to populate the database tables with the SNP information.</p><p>The database schema created by snp-search is designed to facilitate construction of simple queries that will address complex biological questions. Annotations from the genbank file are populated in the <italic>annotations</italic> table which is related to the <italic>features</italic> table which contains information on the type of the feature and its nucleotide sequence. SNP positions from the VCF file are imported to the <italic>snps</italic> table which is related to the <italic>features</italic> table by the <italic>features_snps</italic> table. A SNP that has occurred in each resequenced genome is recorded as an allele in the <italic>alleles</italic> table. The strain name and description (<italic>strains t</italic>able) is related to <italic>alleles</italic> via the <italic>genotype</italic> table which contains the <italic>allele_id</italic> and <italic>strain_id.</italic> Thus queries that relate <italic>strains</italic> to <italic>snps</italic> or <italic>annotations</italic> may be easily composed. These relationships are schematised in Figure&#x000a0;<xref ref-type="fig" rid="F1">1</xref>.</p><p>2. Output requested objects from database</p><p>Once the database has been populated, snp-search provides several filtering and output options (Figure&#x000a0;<xref ref-type="fig" rid="F2">2</xref>).</p><sec><title>Output formats</title><sec><title>Concatenated FASTA file</title><p>SNPs for each sample are collected from the database and concatenated and converted to FASTA format.</p></sec><sec><title>Tab-delimited tabular file</title><p>Information for individual SNPs are provided in tab-delimited tabular format.</p></sec><sec><title>Newick-file format</title><p>snp-search uses FastTree 2 [<xref ref-type="bibr" rid="B12">12</xref>] to generate a Newick file for SNP phylogeny.</p></sec></sec><sec><title>Filtering options</title><sec><title>Filter SNPs according to the SNP Quality</title><p>A Phred-scaled score that the SNP exists at the given site (default 90).</p></sec><sec><title>Filter SNPs according to the Genotype Quality</title><p>A Phred-scaled score that the genotype is true (also known as Genotype quality score, default 30).</p></sec><sec><title>Filter SNPs according to the AD ratio</title><p>The ratio of the unfiltered count of all reads that carried that specific allele compared to other REF and ALT alleles in that site (default 0.9).</p></sec><sec><title>Ignore SNPs from feature</title><p>Ignoring particular SNP calls in features, such as phages, transposases, and insertion sequences to remove horizontally transferred DNA as a result of a recombination event.</p></sec><sec><title>Ignore SNPs in specified range</title><p>SNPs in a defined specified range will be ignored.</p></sec><sec><title>Ignore samples</title><p>Certain samples can be excluded from the SNP output.</p></sec><sec><title>Ignore non-informative SNPs</title><p>A SNP that is found in all samples is not included in the output.</p></sec></sec><sec><title>Analysis</title><sec><title>Unique SNPs for a set of strains</title><p>Given a set of defined strains as input, snp-search queries the database for unique SNPs shared by the defined strains and outputs the results in concatenated FASTA or tabular format.</p></sec><sec><title>SNP phylogeny</title><p>Concatenated FASTA files are used to generate robust phylogenetic trees that are based on SNP differences across whole core genomes.</p></sec><sec><title>SNP annotation</title><p>snp-search processes the data in the database and outputs information on each SNP. The following are the description of this output:</p><p>&#x02013; <bold>Synonymous or non-synonymous SNP.</bold> This is calculated by translating the coding sequence and report if the SNP has whether caused an amino acid change or not.</p><p>&#x02013; <bold>Function of coding region at the SNP position.</bold> This is extracted from the annotated genbank file.</p><p>&#x02013; <bold>Possible pseudogene.</bold> If a stop codon is detected in the coding region (other than the end of the sequence).</p><p>&#x02013; <bold>Original amino acid.</bold> Provide the amino acid for the SNP region in the non-mutated sequence.</p><p>&#x02013; <bold>Has amino acid has changed due to the mutation?</bold> An answer of 'yes&#x02019; will be given if there are at least one amino acid changes between the original non-mutated sequence and the mutated sequence.</p><p>&#x02013; <bold>Is there a change in hydrophobicity of the amino acid?</bold> The answer to this question is based on the pre-defined set of hydrophobic and non-hydrophobic amino acids taken from Livingstone et al.<italic>,</italic>[<xref ref-type="bibr" rid="B13">13</xref>]: hydrophobic as [I,L,V,C,A,G,M,F,Y,W,H,T] and the non-hydrophobic amino acids as [K,E,Q,D,N,S,P,B].</p><p>&#x02013; <bold>Is there a change in the polarity of the amino acid?</bold> The answer to this question is based on the pre-defined set of polarised and non-polarised amino acids taken from Hausman et al., [<xref ref-type="bibr" rid="B14">14</xref>]: polar as [R,N,D,E,Q,H,K,S,T,Y] and non-polar as [A,C,G,I,L,M,F,P,W,V].</p><p>&#x02013; <bold>Is there a change in size of the amino acid?</bold> The answer to this question is based on the pre-defined set of small or non-small set of amino acids taken from Livingstone et al.<italic>,</italic>[<xref ref-type="bibr" rid="B13">13</xref>]: small as [V,C,A,G,D,N,S,T,P] and non-small as [I,L,M,F,Y,W,H,K,R,E,Q].</p></sec><sec><title>Database query</title><p>SQLite database can be interrogated by user defined queries (requires some knowledge of SQL). To view, administer and query the database, one may download a SQL GUI tool or simply use the Unix version of sqlite3.</p></sec></sec></sec><sec><title>Results and discussions</title><sec><title>Application</title><p>The snp-search tool was used to generate a SNP database of 200 Group A <italic>Streptococcus pyogenes</italic> strains (GAS) sequenced using 50&#x000a0;bp reads on the Illumina HiSeq platform. The reads were mapped onto the MGAS315 core genome using the bowtie tool. Samtools mpileup [<xref ref-type="bibr" rid="B10">10</xref>] was used for SNP discovery. The resulting VCF file and the GenBank file from the MGAS315 reference genome were used by snp-search to generate the SNP database. snp-search <italic>-output -all_or_filtered_snps</italic> was used to generate an 'alignment&#x02019; of the concatenated SNPs from each strain in FASTA format. These SNPs represent positions found in positions conserved in all the genomes, sometimes described as the core genome.</p><p>To generate a phylogenetic tree, snp-search <italic>-tree</italic> option was used that runs the phylogenetic tree algorithm FastTree 2 to generate a maximum-likelihood (ML) phylogenetic tree of the 200 genomes based on the SNP alignment from the core genome (Figure&#x000a0;<xref ref-type="fig" rid="F3">3</xref>A). One immediate observation from this tree was a long branch composed of a few strains within one of the clades (black circles in Figure&#x000a0;<xref ref-type="fig" rid="F1">1</xref>). This raised questions as to whether certain SNPs were producing unrealistic branch lengths either due to false SNPs or because the SNPs are not caused by neutral evolution. Snp-search was re-run using the <italic>-ignore_snps_on_annotation phage,transposase,transposon,insertion</italic> which queries the SQL database to select only those SNPs not found in genes in mobile elements and likely to undergo recombination. These SNPs were used to remake a multiple alignment file which was then processed by FastTree 2 to produce a ML tree and viewed using Dendroscope [<xref ref-type="bibr" rid="B15">15</xref>]. The tree (Figure&#x000a0;<xref ref-type="fig" rid="F3">3</xref>B) shows that the unusually long branches to the strains represented by black circles are shortened so these strains group more consistently with the other strains from the nearest clade. A detailed comparison of the two phylogenies shows that the removal of SNPs in phage-related genes resulted in other more minor changes in the tree.</p><fig id="F3" position="float"><label>Figure 3</label><caption><p><bold>Maximum-Likelihood (ML) phylogenetic tree of 200 </bold><bold><italic>Streptococcus pyogenes </italic></bold><bold>genomes based on the SNP alignment from the core genome. (A)</bold> Original maximum-likelihood tree <bold>(B)</bold> Tree that shows the shortening of the unusually long branches to the strains represented by black circles. This was made by querying the SNP database generated by snp-search.</p></caption><graphic xlink:href="1471-2105-14-326-3"/></fig><p>A further 95 GAS strains were sequenced and added to the existing 200 strains. All 295 sequences were mapped to the MGAS315 reference genome, variants called and snp-search was used to generate the tree. MLST data extracted <italic>in</italic> silico showed almost all strains were differentiated into three Sequence Types (STs): ST15, ST315 and ST406 (Figure&#x000a0;<xref ref-type="fig" rid="F4">4</xref>). As shown in Figure&#x000a0;<xref ref-type="fig" rid="F4">4</xref>, ST315 and ST406 strains were confined to one clearly differentiated clonal lineage each, whereas the ST15 strains were present in five differentiated lineages. To evaluate the utility of SNPs for the assessment of genetic diversity between the different STs, we used snp-search to find the SNPs shared only within each clade.</p><fig id="F4" position="float"><label>Figure 4</label><caption><p><bold>SNP phylogeny of 295 GAS strains.</bold> snp-search was used to generate the concatenated FASTA file and FastTree was used to generate the tree. Strains are separated according to the number of SNP differences between them. snp-search was also used to output the number of unique SNPs for each distinguishable clade by providing the name of the samples for each clade.</p></caption><graphic xlink:href="1471-2105-14-326-4"/></fig><p>As shown in Figure&#x000a0;<xref ref-type="fig" rid="F4">4</xref>, ST315 clade has 7 unique SNPs, ST406 has 9 and ST15 clades has 1,13 and 33 unique SNPs. The snp-search output for ST315 clade strains is shown in Table&#x000a0;<xref ref-type="table" rid="T1">1</xref>. For each unique SNP, snp-search identifies whether it is in a coding region or not, and if it is then it reports whether the SNP is synonymous or non-synonymous. Additional information such as the gene and amino acid information is also given.</p></sec><sec><title>Commands</title><p>Snp-search is implemented as an easy-to-use command-line tool. The user does not need experience in Unix, a programming language, or SQL (but to manually query the database the user does need to know some SQL). The user can use the example test sets of plasmid samples (suitable for testing purposes as they are small samples) provided in the github repository. (<ext-link ext-link-type="uri" xlink:href="https://github.com/phe-bioinformatics/snpsearch/tree/master/test_data">https://github.com/phe-bioinformatics/snpsearch/tree/master/test_data</ext-link>) to test snp-search functionalities. Two files are provided in the example test set directory: plasmid_test_set.vcf and Reference_file_plasmid_test_set.gbk. The following are some commands that can be used when using snp-search (the required fields are in bold):</p><p>1. Create the database:</p><p><italic>snp-search </italic><bold>
<italic>-create -name_of_database</italic>
</bold> plasmid_test_set.sqlite3 <bold>
<italic>&#x02013;reference_file</italic>
</bold> Reference_file_plasmid_test_set.gbk <bold>
<italic>-vcf_file</italic>
</bold> plasmid_test_set.vcf.</p><p>2. Now that you have the database plasmid_test_set.sqlite3, you may want to query it. With a simple command it is possible to:</p><p>&#x02022; Generate a concatenated FASTA file</p><p>&#x02022; Generate a phylogenetic tree to view the evolutionary relationships between your samples</p><p>&#x02022; Ignore SNPs that occur in mobile elements</p><p>&#x02022; Ignore SNPs in between nucleotide positions 2000 and 2500</p><p>&#x02022; Ignore SNPs in samples plasmid1, plasmid4 and plasmid8</p><p>&#x02022; Remove non-informative SNPs (SNPs that are found in all samples)</p><p>&#x02022; Only select SNPs with a GQ quality cuttoff of greater than 25</p><p>&#x02022; Only select SNPs with a SNP QUAL cuttoff of greater than 90 (both GQ and QUAL are quality values derived from the VCF file)</p><p>&#x02022; <italic>snp-search </italic><bold><italic>-output -all_or_filtered_snps -name_of_database </italic></bold>plasmid_test_set.sqlite3 <italic>-fasta -cuttoff_genotype</italic> 25 <italic>-cuttoff_snp_qual</italic> 90 <italic>-remove_non_informative_snps -ignore_snps_in_range</italic> 2000..2500 <italic>-ignore_strains</italic> plasmid1,plasmid4,plasmid9 <italic>-ignore_snps_on_annotation</italic> phage,transposase,transposon,insertion <italic>-</italic><bold>
<italic>out</italic>
</bold> plasmid_SNPs_concatenated_file.fasta <italic>-tree -fasttree_path</italic> /usr/local/bin/fastTree</p><p>&#x02022; You may then use any phylogenetic tree viewing software to view your tree.</p><p>&#x02022; Further note: In addition to the concatenated FASTA file, SNP positions are provided in two formats: a simple text file and a tsv file.</p><p>3 To select SNPs that are shared only between a set of samples, example samples plasmid2, plasmid7, plasmid10, and GQ quality cuttoff of greater than 25 and SNP QUAL cuttoff of greater than 90 you may run the following command (list the sample names on separate in a file called for example 'samples.txt&#x02019;):</p><p><italic>snp-search </italic><bold>
<italic>-output -name_of_database</italic>
</bold> plasmid_test_set.sqlite3 <bold>
<italic>-unique_snps -strain</italic>
</bold> samples.txt <italic>-cuttoff_genotype 25 -cuttoff_snp_qual 90</italic><bold>
<italic>-out</italic>
</bold> unique_snps. tx.t</p><p>4 If you like to output all SNPs, with information about each SNP (e.g. if it is a synonymous or non-synonymous SNP) and with the quality cuttoff values used in the previous commands, you may run the following command:</p><p><italic>snp-search </italic><bold>
<italic>-output -name_of_database</italic>
</bold> plasmid_test_set.sqlite3 <bold>
<italic>-info</italic>
</bold><italic>-cuttoff_genotype 25 -cuttoff_snp_qual 90 </italic><bold>
<italic>-out</italic>
</bold> plasmid_info_for_my_snps. txt.</p><p>5 Furthermore, if you like to query the database, you may do so by opening the SQLite3 database generated by snp-search with sqlite3 in your Unix environment. The following is an example of a SQL query that can be performed on the snp-search database to select all snps that are associated with features annotated with a term containing the phrase 'antibiotic&#x02019;:</p><p>SELECT * FROM <italic>snps</italic> INNER JOIN <italic>features_snps</italic> ON <italic>snps.id</italic>&#x02009;=&#x02009;<italic>features_snps.snp_id</italic> INNER JOIN <italic>features</italic> ON <italic>features.id</italic>&#x02009;=&#x02009;<italic>features_snps.feature_id</italic> WHERE <italic>features.id</italic> IN (SELECT <italic>features.id</italic> FROM <italic>features</italic> WHERE <italic>id</italic> IN (SELECT DISTINCT <italic>features.id</italic> FROM <italic>features</italic> INNER JOIN <italic>annotations</italic> ON <italic>annotations.feature_id</italic>&#x02009;=&#x02009;<italic>features.id</italic> WHERE <italic>annotations.value</italic> LIKE '%antibiotic%'));</p></sec></sec><sec sec-type="conclusions"><title>Conclusions</title><p>SNP data is now commonly generated, at least for smaller genomes, by mapping whole genome sequencing reads to a reference where both known and novel SNPs can be found. To facilitate and understand these findings, we have developed snp-search, a tool that manages SNP data from high throughput haploid sequence datasets and outputs useful information which in turn can be used to test important biological hypotheses. The main advantages of snp-search are:</p><p>Parses VCF file and stores SNPs in a database</p><p>Designed simple database schema but powerful in answering complex biological queries</p><p>Provides detailed information about each SNP</p><p>Multiple SNPs filtering steps provided including filtering on the function of genes within which the SNPs are found.</p><p>Has no size limit</p><p>Only dependent on sqlite3 to build the database.</p><p>Sub-populations of SNPs can be extracted from the database to address specific biological questions, such as whether variation in specific genes is linked to phenotypic differences or does the exclusion of SNPs from horizontally transferred elements generate more reliable phylogenetic inferences.</p></sec><sec><title>Availability and requirements</title><p><bold>Project name:</bold> snp-search</p><p><bold>Project home page:</bold><ext-link ext-link-type="uri" xlink:href="https://github.com/phe-bioinformatics/snp-search">https://github.com/phe-bioinformatics/snp-search</ext-link>.</p><p><bold>Operating system(s):</bold> Unix</p><p><bold>Programming language:</bold> Ruby</p><p><bold>Other requirements:</bold> SQLite, Ruby 1.8.7 or greater and optionally FastTree 2 for phylogenetic tree construction</p><p><bold>License:</bold> GNU General Public License (GPL)</p></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Authors&#x02019; contributions</title><p>AA drafted the manuscript, AU supervised the project and edited the manuscript and AA and AU implemented the snp-search algorithm. All authors read and approved the final manuscript.</p></sec></body><back><sec><title>Acknowledgements</title><p>This report is work commissioned by the National Institute of Health Research. The views expressed in this publication are those of the author(s) and not necessarily those of the NHS, the National Institute for Health Research, or the Department of Health. We gratefully acknowledge the support of NIHR for this study. We also like to acknowledge the support of our colleagues in the bioinformatics unit including Jonathan Green, Richard Myers and Kieren Lythgow.</p></sec><ref-list><ref id="B1"><mixed-citation publication-type="journal"><name><surname>Dereeper</surname><given-names>A</given-names></name><name><surname>Nicolas</surname><given-names>S</given-names></name><name><surname>Le Cunff</surname><given-names>L</given-names></name><name><surname>Bacilieri</surname><given-names>R</given-names></name><name><surname>Doligez</surname><given-names>A</given-names></name><name><surname>Peros</surname><given-names>JP</given-names></name><name><surname>Ruiz</surname><given-names>M</given-names></name><name><surname>This</surname><given-names>P</given-names></name><article-title>SNiPlay: a web-based tool for detection, management and analysis of SNPs. Application to grapevine diversity projects</article-title><source>BMC Bioinformatics</source><year>2011</year><volume>12</volume><fpage>134</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-12-134</pub-id><pub-id pub-id-type="pmid">21545712</pub-id></mixed-citation></ref><ref id="B2"><mixed-citation publication-type="journal"><name><surname>Mu&#x000f1;iz-Fernandez</surname><given-names>F</given-names></name><name><surname>Carre&#x000f1;o-Torres</surname><given-names>A</given-names></name><name><surname>Morcillo-Suarez</surname><given-names>C</given-names></name><name><surname>Navarro</surname><given-names>A</given-names></name><article-title>Genome-wide association studies pipeline (GWASpi): a desktop application for genome-wide SNP analysis and management</article-title><source>Bioinformatics</source><year>2011</year><volume>27</volume><fpage>1871</fpage><lpage>1872</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr301</pub-id><pub-id pub-id-type="pmid">21586520</pub-id></mixed-citation></ref><ref id="B3"><mixed-citation publication-type="journal"><name><surname>Mitha</surname><given-names>F</given-names></name><name><surname>Herodotou</surname><given-names>H</given-names></name><name><surname>Borisov</surname><given-names>N</given-names></name><name><surname>Jiang</surname><given-names>C</given-names></name><name><surname>Yoder</surname><given-names>J</given-names></name><name><surname>Owzar</surname><given-names>K</given-names></name><article-title>SNPpy - database management for SNP data from Genome wide association studies</article-title><source>PLoS One</source><year>2011</year><volume>6</volume><fpage>10</fpage></mixed-citation></ref><ref id="B4"><mixed-citation publication-type="journal"><name><surname>Orro</surname><given-names>A</given-names></name><name><surname>Guffanti</surname><given-names>G</given-names></name><name><surname>Salvi</surname><given-names>E</given-names></name><name><surname>Macciardi</surname><given-names>F</given-names></name><name><surname>Milanesi</surname><given-names>L</given-names></name><article-title>SNPLims: a data management system for genome wide association studies</article-title><source>BMC Bioinformatics</source><year>2008</year><volume>26</volume><issue>Suppl 2</issue><fpage>S13</fpage><pub-id pub-id-type="pmid">18387201</pub-id></mixed-citation></ref><ref id="B5"><mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Niu</surname><given-names>T</given-names></name><name><surname>Xu</surname><given-names>X</given-names></name><article-title>SNPHunter: a bioinformatic software for single nucleotide polymorphism data acquisition and management</article-title><source>BMC Bioinformatics</source><year>2005</year><volume>6</volume><fpage>60</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-6-60</pub-id><pub-id pub-id-type="pmid">15774022</pub-id></mixed-citation></ref><ref id="B6"><mixed-citation publication-type="journal"><name><surname>Zhao</surname><given-names>LJ</given-names></name><name><surname>Li</surname><given-names>MX</given-names></name><name><surname>Guo</surname><given-names>YF</given-names></name><name><surname>Xu</surname><given-names>FH</given-names></name><name><surname>Li</surname><given-names>JL</given-names></name><name><surname>Deng</surname><given-names>HW</given-names></name><article-title>SNPP: automating large-scale SNP genotype data management</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>266</fpage><lpage>268</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bth486</pub-id><pub-id pub-id-type="pmid">15377503</pub-id></mixed-citation></ref><ref id="B7"><mixed-citation publication-type="journal"><name><surname>L&#x000f3;pez-Fern&#x000e1;ndez</surname><given-names>H</given-names></name><name><surname>Glez-Pe&#x000f1;a</surname><given-names>D</given-names></name><name><surname>Reboiro-Jato</surname><given-names>M</given-names></name><name><surname>G&#x000f3;mez-L&#x000f3;pez</surname><given-names>G</given-names></name><name><surname>Pisano</surname><given-names>DG</given-names></name><name><surname>Fdez-Riverola</surname><given-names>F</given-names></name><article-title>PileLineGUI: a desktop environment for handling genome position files in next-generation sequencing studies</article-title><source>Nucl Acids Res</source><year>2011</year><volume>39</volume><fpage>W562</fpage><lpage>6</lpage><pub-id pub-id-type="doi">10.1093/nar/gkr439</pub-id><pub-id pub-id-type="pmid">21646339</pub-id></mixed-citation></ref><ref id="B8"><mixed-citation publication-type="journal"><collab>The 1000 Genomes Project Consortium</collab><article-title>A map of human genome variation from population-scale sequencing</article-title><source>Nature</source><year>2010</year><volume>467</volume><fpage>1061</fpage><lpage>1073</lpage><pub-id pub-id-type="doi">10.1038/nature09534</pub-id><pub-id pub-id-type="pmid">20981092</pub-id></mixed-citation></ref><ref id="B9"><mixed-citation publication-type="journal"><name><surname>Sherry</surname><given-names>ST</given-names></name><name><surname>Ward</surname><given-names>M</given-names></name><name><surname>Sirotkin</surname><given-names>K</given-names></name><article-title>dbSNP-database for single nucleotide polymorphisms and other classes of minor genetic variation</article-title><source>Genome Res</source><year>1999</year><volume>9</volume><fpage>677</fpage><lpage>679</lpage><pub-id pub-id-type="pmid">10447503</pub-id></mixed-citation></ref><ref id="B10"><mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Handsaker</surname><given-names>B</given-names></name><name><surname>Wysoker</surname><given-names>A</given-names></name><name><surname>Fennell</surname><given-names>T</given-names></name><name><surname>Ruan</surname><given-names>J</given-names></name><name><surname>Homer</surname><given-names>N</given-names></name><name><surname>Marth</surname><given-names>G</given-names></name><name><surname>Abecasis</surname><given-names>G</given-names></name><article-title>Durbin R; 1000 Genome project data processing subgroup. The sequence alignment/Map format and SAMtools</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>2078</fpage><lpage>2079</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id><pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation></ref><ref id="B11"><mixed-citation publication-type="journal"><name><surname>McKenna</surname><given-names>A</given-names></name><name><surname>Hanna</surname><given-names>M</given-names></name><name><surname>Banks</surname><given-names>E</given-names></name><name><surname>Sivachenko</surname><given-names>A</given-names></name><name><surname>Cibulskis</surname><given-names>K</given-names></name><name><surname>Kernytsky</surname><given-names>A</given-names></name><name><surname>Garimella</surname><given-names>K</given-names></name><name><surname>Altshuler</surname><given-names>D</given-names></name><name><surname>Gabriel</surname><given-names>S</given-names></name><name><surname>Daly</surname><given-names>M</given-names></name><name><surname>DePristo</surname><given-names>MA</given-names></name><article-title>The genome analysis toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title><source>Genome Res</source><year>2010</year><volume>20</volume><fpage>1297</fpage><lpage>303</lpage><pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id><pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation></ref><ref id="B12"><mixed-citation publication-type="journal"><name><surname>Price</surname><given-names>MN</given-names></name><name><surname>Dehal</surname><given-names>PS</given-names></name><name><surname>Arkin</surname><given-names>AP</given-names></name><article-title>FastTree 2&#x02013;approximately maximum-likelihood trees for large alignments</article-title><source>PLoS One</source><year>2010</year><volume>10</volume><fpage>5</fpage></mixed-citation></ref><ref id="B13"><mixed-citation publication-type="journal"><name><surname>Livingstone</surname><given-names>CD</given-names></name><name><surname>Barton</surname><given-names>GJ</given-names></name><article-title>Protein sequence alignments: a strategy for the hierarchical analysis of residue conservation</article-title><source>Comp</source><year>1993</year><volume>9</volume><fpage>745</fpage><lpage>756</lpage></mixed-citation></ref><ref id="B14"><mixed-citation publication-type="book"><name><surname>Hausman</surname><given-names>RE</given-names></name><name><surname>Cooper</surname><given-names>GM</given-names></name><source>The cell: A Molecular Approach</source><year>2004</year><publisher-name>Washington, D.C: ASM Press</publisher-name><fpage>51</fpage></mixed-citation></ref><ref id="B15"><mixed-citation publication-type="other"><name><surname>Huson</surname><given-names>DH</given-names></name><name><surname>Scornavacca</surname><given-names>C</given-names></name><article-title>Dendroscope 3: an interactive tool for rooted phylogenetic trees and networks</article-title><source>Systematic Biology</source><year>2012</year></mixed-citation></ref></ref-list></back></article>